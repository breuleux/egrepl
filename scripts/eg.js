require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var $185=function(type$187){var f$190;(f$190=type$187["::check"]);;if((f$190===(void 0))){return function(value$195){return (value$195 instanceof type$187);};}else{return function(value$198){return f$190.call(type$187,value$198);};}};
var $200=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $201=function(dest$203,values$204){var k$209;(k$209=null);$207:for(k$209 in values$204){if(values$204.hasOwnProperty(k$209)){(dest$203[k$209]=values$204[k$209]);}}return dest$203;};
var $213=function($214$216){var ph$220;(ph$220=$214$216);;var $218$225;($218$225=ph$220);;var bridge$219$230;var x$234;(bridge$219$230=$218$225);if((((typeof(bridge$219$230)==="string")&&((x$234=bridge$219$230),true))||((typeof(bridge$219$230)==="number")&&((x$234=bridge$219$230),true)))){return ["value",x$234];}else{var other$241;(other$241=$218$225);return other$241["::serialize_ast"]();}};
var send$25;(send$25=function(obj$30,$28$31){var ph$35;var msg$36;var t0$38;(t0$38=$28$31);(msg$36=t0$38);(ph$35=t0$38);;var $33$42;($33$42=ph$35);;var bridge$34$47;(bridge$34$47=$33$42);if(((typeof(bridge$34$47)==="string")||(typeof(bridge$34$47)==="number"))){return obj$30[msg$36];}else{var other$55;(other$55=$33$42);return obj$30["::send"](msg$36);}});;(Array[":::project"]=function($58$60){var ph$63;var value$64;var t0$66;(t0$66=$58$60);(value$64=t0$66);(ph$63=t0$66);;var $62$70;($62$70=ph$63);;if($185(Array)($62$70)){return [true,value$64];}else{$62$70;return [true,[value$64]];}});(Array.prototype["::check"]=function(value$84){if((value$84 instanceof Array)){var i$89;(i$89=0);;$87:for(;(i$89<this.length);(i$89++)){if(($200(this,i$89)!==$200(value$84,i$89))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $201(this.slice(0),this);});(Array.prototype[":::project"]=function(value$100){if((value$100 instanceof Array)){var i$105;(i$105=0);;$103:for(;(i$105<this.length);(i$105++)){if(($200(this,i$105)!==$200(value$100,i$105))){return [true,[value$100]];}}return [true,value$100.slice(this.length)];}else{return [true,[value$100]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($213));});(RegExp.prototype["::check"]=function($115$117){var ph$120;(ph$120=$115$117);;var $119$125;($119$125=ph$120);;var value$133;if((typeof($119$125)==="string")){(value$133=$119$125);if(value$133.match(this)){return true;}else{return false;}}else{var other$138;(other$138=$119$125);return false;}});(RegExp.prototype[":::project"]=function($140$142){var ph$145;(ph$145=$140$142);;var $144$150;($144$150=ph$145);;var value$158;if((typeof($144$150)==="string")){(value$158=$144$150);var $161$163;($161$163=value$158.match(this));;var m$171;if(($161$163===null)){(m$171=$161$163);return [false,null];}else{var m$176;(m$176=$161$163);return [true,m$176];}}else{var other$180;(other$180=$144$150);return [false,null];}});(Function.prototype["::send"]=function(args$183){return this.apply(this,args$183);});
var $796=Object.keys;
var $797=function($798$800,key$801){var ph$805;(ph$805=$798$800);;var $803$810;($803$810=ph$805);;var bridge$804$815;(bridge$804$815=$803$810);if(((bridge$804$815===null)||(bridge$804$815===(void 0)))){return false;}else{var x$823;if((typeof($803$810)==="string")){(x$823=$803$810);return (key$801 in String.prototype);}else{var x$828;if((typeof($803$810)==="number")){(x$828=$803$810);return (key$801 in Number.prototype);}else{var x$833;(x$833=$803$810);return (key$801 in x$833);}}}};
var $675=function($676$678,b$679){var ph$685;var a$686;var t0$688;(t0$688=$676$678);(a$686=t0$688);(ph$685=t0$688);;var $681$692;($681$692=ph$685);;var bridge$682$697;if(($681$692===b$679)){return true;}else{(bridge$682$697=$681$692);if((function(){var bridge$683$707;(bridge$683$707=bridge$682$697);return (function(){var bridge$684$710;(bridge$684$710=bridge$683$707);return ((typeof(bridge$684$710)==="number")||(typeof(bridge$684$710)==="string"));}()||(bridge$683$707===null));}()||(bridge$682$697===(void 0)))){return false;}else{if($185(Array)($681$692)){if(((!$185(Array)(b$679))||(a$686.length!==b$679.length))){return false;}var i$721;(i$721=0);;$718:for(;(i$721<a$686.length);(i$721++)){if((!$675(a$686[i$721],b$679[i$721]))){return false;}}return true;}else{$681$692;if(((Object.getPrototypeOf(a$686)===Object.prototype)&&(Object.getPrototypeOf(b$679)===Object.prototype))){var ka$734;(ka$734=$796(a$686));;if((!$675(ka$734.sort(),$796(b$679).sort()))){return false;}var temp$743;(temp$743=ka$734);;var $length$748;($length$748=temp$743.length);;var $index$753;($index$753=0);;$735:for(;($index$753<$length$748);($index$753++)){var m$761;(m$761=temp$743[$index$753]);;var k$769;(k$769=m$761);if((!$675(a$686[k$769],b$679[k$769]))){return false;}}return true;}else{if($797($681$692,"::serialize")){$681$692["::serialize"];var $776$778;($776$778=b$679);;if($797($776$778,"::serialize")){$776$778["::serialize"];return $675(a$686["::serialize"](),b$679["::serialize"]());}else{var otherwise$790;(otherwise$790=$776$778);return false;}}else{var otherwise$794;(otherwise$794=$681$692);return false;}}}}}};
var $670=function(x$672,y$673){return (!$675(x$672,y$673));};var accum$662;var accum$666;var keynames$245;var prevent$246;var Interactor$247;(keynames$245=({8:"Backspace",9:"Tab",13:"Enter",16:"S-",17:"C-",18:"A-",27:"Esc",32:"Space",33:"PgUp",34:"PgDn",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12"}));;(prevent$246=function(event$254){event$254.preventDefault();return event$254.stopPropagation();});;(Interactor$247=function(target$261){var accum$271;var accum$277;var accum$283;var accum$289;var it$0$264;(it$0$264=function(){if((!$185(Interactor$247)(this))){return Object.create(Interactor$247.prototype);}else{return this;}}());;(it$0$264["functions"]=(target$261.interactor_functions||target$261));(it$0$264["more_functions"]=$201(((accum$271=({})),((accum$271["default"]=function(){return "default";}),accum$271)),$201(((accum$277=({})),((accum$277["stick"]=function(){return "stick";}),accum$277)),$201(((accum$283=({})),((accum$283["break"]=function(){return "break";}),accum$283)),((accum$289=({})),((accum$289["none"]=function(){return (void 0);}),accum$289))))));(it$0$264["current_bindings"]=null);(it$0$264["global_bindings"]=null);return it$0$264;});;(Interactor$247.prototype["set_bindings"]=function(new_bindings$298){var self$306;var it$0$301;(it$0$301=this);;(self$306=this);;(it$0$301["current_bindings"]=null);return (it$0$301["global_bindings"]=new_bindings$298);});(Interactor$247.prototype["execute"]=function(c$314,e$315){var f$341;var $index$374;var $length$369;var temp$364;var result$356;var cmd$420;var cmds$352;var f$347;var cmd$337;var $323$329;var self$324;var it$0$318;(it$0$318=this);;(self$324=this);;($323$329=c$314);;if((typeof($323$329)==="string")){(cmd$337=$323$329);(f$341=($200(it$0$318.functions,cmd$337)||$200(it$0$318.more_functions,cmd$337)));;return f$341(e$315);}else{if($185(Function)($323$329)){(f$347=$323$329);return f$347(it$0$318.target,e$315);}else{if($185(Array)($323$329)){(cmds$352=$323$329);(result$356=null);;(temp$364=cmds$352);;($length$369=temp$364.length);;($index$374=0);;$357:for(;($index$374<$length$369);($index$374++)){var other$416;var $393$395;var cmd$390;var m$382;(m$382=temp$364[$index$374]);;(cmd$390=m$382);(result$356=it$0$318.execute(cmd$390,e$315));($393$395=result$356);;if(($393$395==="break")){prevent$246(e$315);break $357;}else{if(($393$395==="default")){break $357;}else{if(($393$395==="ignore")){continue $357;}else{(other$416=$393$395);prevent$246(e$315);}}}}return result$356;}else{(cmd$420=$323$329);(it$0$318["current_bindings"]=cmd$420);return "break stick";}}}});(Interactor$247.prototype["process_codes"]=function(codes$426,e$427){var $index$467;var $length$462;var temp$457;var otherwise$533;var $506$514;var $505$508;var result$539;var t0$498;var $440$493;var bindings$441;var just_modifiers$442;var commands$443;var self$435;var it$0$430;(it$0$430=this);;(self$435=this);;(bindings$441=(it$0$430.current_bindings||it$0$430.global_bindings));;(just_modifiers$442=null);;(commands$443=[]);;(temp$457=codes$426);;($length$462=temp$457.length);;($index$467=0);;$444:for(;($index$467<$length$462);($index$467++)){var command$486;var code$483;var m$475;(m$475=temp$457[$index$467]);;(code$483=m$475);if($185(RegExp("^([ACS]-)+$",""))(code$483)){(just_modifiers$442=true);}(command$486=$200(bindings$441,code$483));;if($670(command$486,(void 0))){commands$443.push(command$486);}}($440$493=commands$443);;if((($440$493 instanceof Array)&&((t0$498=$440$493.length),(t0$498===0)))){($505$508=null);;$505$508;if((it$0$430.current_bindings&&it$0$430.current_bindings._eat)){if((!just_modifiers$442)){(it$0$430["current_bindings"]=null);}return prevent$246(e$427);}else{if((it$0$430.current_bindings&&it$0$430.current_bindings._browser)){if((!just_modifiers$442)){return (it$0$430["current_bindings"]=null);}}else{if((it$0$430.current_bindings&&(!just_modifiers$442))){(it$0$430["current_bindings"]=null);return it$0$430.process_codes(codes$426,e$427);}else{(otherwise$533=$505$508);return null;}}}}else{$440$493;(result$539=it$0$430.execute(commands$443,e$427));;if(($675(result$539,(void 0))||(result$539.match&&result$539.match("break")))){prevent$246(e$427);}if((((!((result$539&&result$539.match)&&result$539.match("stick")))&&it$0$430.current_bindings)&&(!it$0$430.current_bindings._stick))){return (it$0$430["current_bindings"]=null);}}});(Interactor$247.prototype["getcode"]=function(e$548){var otherwise$589;var $562$574;var $561$568;var code$563;var self$556;var it$0$551;(it$0$551=this);;(self$556=this);;(code$563=($200(keynames$245,e$548.which)||(("<"+e$548.which)+">")));;($561$568=null);;$561$568;if((e$548.shiftKey&&$670(code$563,"S-"))){return ("S-"+code$563);}else{if((e$548.altKey&&$670(code$563,"A-"))){return ("A-"+code$563);}else{if(((e$548.ctrlKey||e$548.metaKey)&&$670(code$563,"C-"))){return ("C-"+code$563);}else{(otherwise$589=$561$568);return code$563;}}}});(Interactor$247.prototype["keyup"]=function(e$594){var self$602;var it$0$597;(it$0$597=this);;(self$602=this);;return it$0$597.process_codes(["!^All",("^"+it$0$597.getcode(e$594)),"^All"],e$594);});(Interactor$247.prototype["keydown"]=function(e$609){var self$617;var it$0$612;(it$0$612=this);;(self$617=this);;return it$0$612.process_codes(["!All",it$0$612.getcode(e$609),"All"],e$609);});(Interactor$247.prototype["keypress"]=function(e$624){var key$637;var code$638;var self$632;var it$0$627;(it$0$627=this);;(self$632=this);;(key$637=e$624.which);;(code$638=("="+String.fromCharCode(key$637)));;return it$0$627.process_codes(["!=All",code$638,"=All"],e$624);});(Interactor$247.prototype["install"]=function(element$648){var self$656;var it$0$651;(it$0$651=this);;(self$656=this);;(element$648["onkeydown"]=it$0$651.keydown.bind(it$0$651));(element$648["onkeyup"]=it$0$651.keyup.bind(it$0$651));return (element$648["onkeypress"]=it$0$651.keypress.bind(it$0$651));});$201(Interactor$247,$201(((accum$662=({})),((accum$662["::name"]="Interactor"),accum$662)),((accum$666=({})),((accum$666["::egclass"]=true),accum$666))));Interactor$247;(exports["Interactor"]=Interactor$247);

},{}],"eXk3/i":[function(require,module,exports){
var $996=function(type$998){var f$1001;(f$1001=type$998["::check"]);;if((f$1001===(void 0))){return function(value$1006){return (value$1006 instanceof type$998);};}else{return function(value$1009){return f$1001.call(type$998,value$1009);};}};
var $1011=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $1012=function(dest$1014,values$1015){var k$1020;(k$1020=null);$1018:for(k$1020 in values$1015){if(values$1015.hasOwnProperty(k$1020)){(dest$1014[k$1020]=values$1015[k$1020]);}}return dest$1014;};
var $1024=function($1025$1027){var ph$1031;(ph$1031=$1025$1027);;var $1029$1036;($1029$1036=ph$1031);;var bridge$1030$1041;var x$1045;(bridge$1030$1041=$1029$1036);if((((typeof(bridge$1030$1041)==="string")&&((x$1045=bridge$1030$1041),true))||((typeof(bridge$1030$1041)==="number")&&((x$1045=bridge$1030$1041),true)))){return ["value",x$1045];}else{var other$1052;(other$1052=$1029$1036);return other$1052["::serialize_ast"]();}};
var send$836;(send$836=function(obj$841,$839$842){var ph$846;var msg$847;var t0$849;(t0$849=$839$842);(msg$847=t0$849);(ph$846=t0$849);;var $844$853;($844$853=ph$846);;var bridge$845$858;(bridge$845$858=$844$853);if(((typeof(bridge$845$858)==="string")||(typeof(bridge$845$858)==="number"))){return obj$841[msg$847];}else{var other$866;(other$866=$844$853);return obj$841["::send"](msg$847);}});;(Array[":::project"]=function($869$871){var ph$874;var value$875;var t0$877;(t0$877=$869$871);(value$875=t0$877);(ph$874=t0$877);;var $873$881;($873$881=ph$874);;if($996(Array)($873$881)){return [true,value$875];}else{$873$881;return [true,[value$875]];}});(Array.prototype["::check"]=function(value$895){if((value$895 instanceof Array)){var i$900;(i$900=0);;$898:for(;(i$900<this.length);(i$900++)){if(($1011(this,i$900)!==$1011(value$895,i$900))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $1012(this.slice(0),this);});(Array.prototype[":::project"]=function(value$911){if((value$911 instanceof Array)){var i$916;(i$916=0);;$914:for(;(i$916<this.length);(i$916++)){if(($1011(this,i$916)!==$1011(value$911,i$916))){return [true,[value$911]];}}return [true,value$911.slice(this.length)];}else{return [true,[value$911]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($1024));});(RegExp.prototype["::check"]=function($926$928){var ph$931;(ph$931=$926$928);;var $930$936;($930$936=ph$931);;var value$944;if((typeof($930$936)==="string")){(value$944=$930$936);if(value$944.match(this)){return true;}else{return false;}}else{var other$949;(other$949=$930$936);return false;}});(RegExp.prototype[":::project"]=function($951$953){var ph$956;(ph$956=$951$953);;var $955$961;($955$961=ph$956);;var value$969;if((typeof($955$961)==="string")){(value$969=$955$961);var $972$974;($972$974=value$969.match(this));;var m$982;if(($972$974===null)){(m$982=$972$974);return [false,null];}else{var m$987;(m$987=$972$974);return [true,m$987];}}else{var other$991;(other$991=$955$961);return [false,null];}});(Function.prototype["::send"]=function(args$994){return this.apply(this,args$994);});
var $2381=function(obj$2383){var results$2387;(results$2387=[]);;var k$2392;(k$2392=null);$2386:for(k$2392 in obj$2383){if(Object.prototype.hasOwnProperty.call(obj$2383,k$2392)){results$2387.push([k$2392,$1011(obj$2383,k$2392)]);}}return results$2387;};
var $2578=function(arr$2580){var results$2584;var l$2585;(results$2584=[]);;(l$2585=arr$2580.length);;var i$2593;(i$2593=0);;$2583:for(;(i$2593<l$2585);(i$2593++)){results$2584.push([i$2593,$1011(arr$2580,i$2593)]);}return results$2584;};
var $2409=function(){var $2410$2412;($2410$2412=function(tags$2416){var it$0$2419;(it$0$2419=function(){if((!$996($2410$2412)(this))){return Object.create($2410$2412.prototype);}else{return this;}}());;(it$0$2419["tags"]=tags$2416);return it$0$2419;});;($2410$2412.prototype["create"]=function(){var $2428$2430;($2428$2430=arguments);;var t0$2435;var message$2439;var args$2440;(t0$2435=$2428$2430.length);if((t0$2435>=0)){(message$2439=function(){if((0>=t0$2435)){return "";}else{return $2428$2430[0];}}());(args$2440=Array.prototype.slice.call($2428$2430,1));var it$0$2444;(it$0$2444=this);;var self$2449;(self$2449=this);;var e$2454;(e$2454=Error(message$2439));;(e$2454["::tags"]=it$0$2444.tags);(e$2454["args"]=args$2440);var temp$2462;(temp$2462=$2578(args$2440));;var $length$2467;($length$2467=temp$2462.length);;var $index$2472;($index$2472=0);;$2455:for(;($index$2472<$length$2467);($index$2472++)){var m$2480;(m$2480=temp$2462[$index$2472]);;var t0$2485;var t1$2486;var i$2490;var arg$2491;(t0$2485=m$2480);if(((t0$2485 instanceof Array)&&((t1$2486=t0$2485.length),(t1$2486===2)))){(i$2490=t0$2485[0]);(arg$2491=t0$2485[1]);(e$2454[i$2490]=arg$2491);}else{$2396(m$2480);;}}(e$2454["length"]=args$2440.length);(e$2454["name"]=["E"].concat(it$0$2444.tags).join("."));return e$2454;}else{$2396($2428$2430);}});($2410$2412.prototype["::check"]=function(e$2502){var it$0$2505;(it$0$2505=this);;var self$2510;(self$2510=this);;var tags$2515;if(((!e$2502)||(!$996(Error)(e$2502)))){return false;}(tags$2515=(e$2502["::tags"]||[]));;var temp$2524;(temp$2524=it$0$2505.tags);;var $length$2529;($length$2529=temp$2524.length);;var $index$2534;($index$2534=0);;$2516:for(;($index$2534<$length$2529);($index$2534++)){var m$2542;(m$2542=temp$2524[$index$2534]);;var tag$2550;(tag$2550=m$2542);if((tags$2515.indexOf(tag$2550)===-1)){return false;}else{false;;}}return true;});($2410$2412.prototype["::deconstruct"]=function(e$2558){var it$0$2561;(it$0$2561=this);;var self$2566;(self$2566=this);;return e$2558.args;});$1012($2410$2412,$1012(function(){var accum$2571;(accum$2571=({}));(accum$2571["::name"]="$2410");return accum$2571;}(),function(){var accum$2575;(accum$2575=({}));(accum$2575["::egclass"]=true);return accum$2575;}()));return $2410$2412;}();
var $2396=function(value$2398,url$2399,start$2400,end$2401){var err$2404;(err$2404=$2409(["match"]).create("Could not find a match for value",({"value":value$2398})));;if(url$2399){(err$2404["location"]=["location",url$2399,start$2400,end$2401]);}throw err$2404;};
var $2600=function(type$2602){return function(value$2605){var f$2608;(f$2608=type$2602[":::project"]);;if((f$2608===(void 0))){(f$2608=type$2602["::project"]);if((f$2608===(void 0))){return [true,type$2602(value$2605)];}else{var rval$2614;(rval$2614=false);;try{(rval$2614=[true,f$2608(value$2605)]);}catch(excv$2620){var e$2626;(e$2626=excv$2620);(rval$2614=[false,null]);}return rval$2614;}}else{return f$2608.call(type$2602,value$2605);}};};
var $2628=function(){var $2629$2631;($2629$2631=function($2634$2637,$2635$2638){var classes$2640;var children$2641;var t0$2643;(t0$2643=$2600(Array)($2634$2637));if(t0$2643[0]){(classes$2640=t0$2643[1]);;}else{$2396($2634$2637);}var t0$2648;(t0$2648=$2600(Array)($2635$2638));if(t0$2648[0]){(children$2641=t0$2648[1]);;}else{$2396($2635$2638);}var it$0$2653;(it$0$2653=function(){if((!$996($2629$2631)(this))){return Object.create($2629$2631.prototype);}else{return this;}}());;(it$0$2653["classes"]=classes$2640.sort());(it$0$2653["children"]=children$2641);return it$0$2653;});;$1012(function(){var accum$2661;(accum$2661=({}));(accum$2661["::check"]=function(x$2665){return ((x$2665&&x$2665.classes)&&x$2665.children);});return accum$2661;}(),$1012(function(){var accum$2668;(accum$2668=({}));(accum$2668["::deconstruct"]=function(x$2672){return [x$2672.classes,x$2672.children];});return accum$2668;}(),$1012(function(){var accum$2675;(accum$2675=({}));(accum$2675["::name"]="$2629");return accum$2675;}(),function(){var accum$2679;(accum$2679=({}));(accum$2679["::egclass"]=true);return accum$2679;}())));($2629$2631.prototype["::check"]=function(n$2685){var it$0$2688;(it$0$2688=this);;var self$2693;(self$2693=this);;var temp$2702;(temp$2702=it$0$2688.classes);;var $length$2707;($length$2707=temp$2702.length);;var $index$2712;($index$2712=0);;$2698:for(;($index$2712<$length$2707);($index$2712++)){var m$2720;(m$2720=temp$2702[$index$2712]);;var c$2728;(c$2728=m$2720);if((n$2685.classes.indexOf(c$2728)===-1)){return false;}else{false;;}}return true;});$1012($2629$2631,$1012(function(){var accum$2734;(accum$2734=({}));(accum$2734["::check"]=function(x$2738){return ((x$2738&&x$2738.classes)&&x$2738.children);});return accum$2734;}(),$1012(function(){var accum$2741;(accum$2741=({}));(accum$2741["::deconstruct"]=function(x$2745){return [x$2745.classes,x$2745.children];});return accum$2741;}(),$1012(function(){var accum$2748;(accum$2748=({}));(accum$2748["::name"]="$2629");return accum$2748;}(),function(){var accum$2752;(accum$2752=({}));(accum$2752["::egclass"]=true);return accum$2752;}()))));return $2629$2631;}();
var $2755=function($2756$2758,key$2759){var ph$2763;(ph$2763=$2756$2758);;var $2761$2768;($2761$2768=ph$2763);;var bridge$2762$2773;(bridge$2762$2773=$2761$2768);if(((bridge$2762$2773===null)||(bridge$2762$2773===(void 0)))){return false;}else{var x$2781;if((typeof($2761$2768)==="string")){(x$2781=$2761$2768);return (key$2759 in String.prototype);}else{var x$2786;if((typeof($2761$2768)==="number")){(x$2786=$2761$2768);return (key$2759 in Number.prototype);}else{var x$2791;(x$2791=$2761$2768);return (key$2759 in x$2791);}}}};
var $2914=Object.keys;
var $2793=function($2794$2796,b$2797){var ph$2803;var a$2804;var t0$2806;(t0$2806=$2794$2796);(a$2804=t0$2806);(ph$2803=t0$2806);;var $2799$2810;($2799$2810=ph$2803);;var bridge$2800$2815;if(($2799$2810===b$2797)){return true;}else{(bridge$2800$2815=$2799$2810);if((function(){var bridge$2801$2825;(bridge$2801$2825=bridge$2800$2815);return (function(){var bridge$2802$2828;(bridge$2802$2828=bridge$2801$2825);return ((typeof(bridge$2802$2828)==="number")||(typeof(bridge$2802$2828)==="string"));}()||(bridge$2801$2825===null));}()||(bridge$2800$2815===(void 0)))){return false;}else{if($996(Array)($2799$2810)){if(((!$996(Array)(b$2797))||(a$2804.length!==b$2797.length))){return false;}var i$2839;(i$2839=0);;$2836:for(;(i$2839<a$2804.length);(i$2839++)){if((!$2793(a$2804[i$2839],b$2797[i$2839]))){return false;}}return true;}else{$2799$2810;if(((Object.getPrototypeOf(a$2804)===Object.prototype)&&(Object.getPrototypeOf(b$2797)===Object.prototype))){var ka$2852;(ka$2852=$2914(a$2804));;if((!$2793(ka$2852.sort(),$2914(b$2797).sort()))){return false;}var temp$2861;(temp$2861=ka$2852);;var $length$2866;($length$2866=temp$2861.length);;var $index$2871;($index$2871=0);;$2853:for(;($index$2871<$length$2866);($index$2871++)){var m$2879;(m$2879=temp$2861[$index$2871]);;var k$2887;(k$2887=m$2879);if((!$2793(a$2804[k$2887],b$2797[k$2887]))){return false;}}return true;}else{if($2755($2799$2810,"::serialize")){$2799$2810["::serialize"];var $2894$2896;($2894$2896=b$2797);;if($2755($2894$2896,"::serialize")){$2894$2896["::serialize"];return $2793(a$2804["::serialize"](),b$2797["::serialize"]());}else{var otherwise$2908;(otherwise$2908=$2894$2896);return false;}}else{var otherwise$2912;(otherwise$2912=$2799$2810);return false;}}}}}};
var $2931=function($2932$2934){var ph$2940;var x$2941;var t0$2943;(t0$2943=$2932$2934);(x$2941=t0$2943);(ph$2940=t0$2943);;var $2936$2947;($2936$2947=ph$2940);;var bridge$2937$2952;(bridge$2937$2952=$2936$2947);if((function(){var bridge$2938$2958;(bridge$2938$2958=bridge$2937$2952);return (function(){var bridge$2939$2961;(bridge$2939$2961=bridge$2938$2958);return ((bridge$2939$2961===(void 0))||(bridge$2939$2961===null));}()||(typeof(bridge$2938$2958)==="string"));}()||(typeof(bridge$2937$2952)==="number"))){return x$2941;}else{if($2755($2936$2947,"::clone")){$2936$2947["::clone"];return x$2941["::clone"]();}else{$2936$2947;if((Object.getPrototypeOf(x$2941)===Object.prototype)){var dest$2974;(dest$2974=({}));;var k$2979;(k$2979=null);$2973:for(k$2979 in x$2941){if(Object.prototype.hasOwnProperty.call(x$2941,k$2979)){(dest$2974[k$2979]=x$2941[k$2979]);}}return dest$2974;}else{var other$2985;(other$2985=$2936$2947);throw $2409(["clone"]).create("Object cannot be cloned",({"obj":x$2941}));}}}};
var $2915=function(a$2917,b$2918){var dest$2922;(dest$2922=$2931(a$2917));;var k$2927;(k$2927=null);$2921:for(k$2927 in b$2918){if(Object.prototype.hasOwnProperty.call(b$2918,k$2927)){(dest$2922[k$2927]=b$2918[k$2927]);}}return dest$2922;};var accum$2288;var accum$2292;var kb$1062;var eg$1063;var $1058$1064;var GenSym$1065;var $1059$1066;var Location$1067;var highlight_locations$1068;var format_error$1069;var $1060$1070;var tokenize$1071;var $1061$1072;var parse$1073;var gensym$1074;var create_node$1075;var make_dom$1076;var mktable$1077;var mktable2$1078;var repr$1079;var goto_end$1080;var insert_before_caret$1081;var Repl$1082;var make_cards$1083;(kb$1062=require("./kb"));;(eg$1063=require("../lib/earl-grey"));;($1058$1064=require("../lib/util"));;(GenSym$1065=$1058$1064.GenSym);;($1059$1066=require("../lib/location"));;(Location$1067=$1059$1066.Location);;(highlight_locations$1068=$1059$1066.highlight_locations);;(format_error$1069=$1059$1066.format_error);;($1060$1070=require("../lib/lex"));;(tokenize$1071=$1060$1070.tokenize);;($1061$1072=require("../lib/parse"));;(parse$1073=$1061$1072.parse);;(gensym$1074=GenSym$1065("io_"));;(create_node$1075=function(tag$1126,kv$1127,contents$1128){var $index$1151;var $length$1146;var temp$1141;var $index$1188;var $length$1183;var temp$1178;var node$1131;(node$1131=document.createElement(tag$1126));;(temp$1141=$2381(kv$1127));;($length$1146=temp$1141.length);;($index$1151=0);;$1132:for(;($index$1151<$length$1146);($index$1151++)){var k$1169;var v$1170;var t0$1164;var t1$1165;var m$1159;(m$1159=temp$1141[$index$1151]);;(t0$1164=m$1159);if(((t0$1164 instanceof Array)&&((t1$1165=t0$1164.length),(t1$1165===2)))){(k$1169=t0$1164[0]);(v$1170=t0$1164[1]);(node$1131[k$1169]=v$1170);}else{$2396(m$1159,"/home/olivier/git/egrepl/src/repl.eg",1782,1829);;}}(temp$1178=$2600(Array)(contents$1128)[1]);;($length$1183=temp$1178.length);;($index$1188=0);;$1134:for(;($index$1188<$length$1183);($index$1188++)){var other$1210;var s$1205;var t0$1201;var m$1196;(m$1196=temp$1178[$index$1188]);;(t0$1201=m$1196);if((typeof(t0$1201)==="string")){(s$1205=t0$1201);node$1131.appendChild(document.createTextNode(s$1205));}else{(other$1210=m$1196);node$1131.appendChild(other$1210);}}return node$1131;});;(make_dom$1076=function(){var $index$1266;var $length$1261;var temp$1256;var node$1248;var $index$1333;var $length$1328;var temp$1323;var $index$1403;var $length$1398;var temp$1393;var $index$1457;var $length$1452;var temp$1447;var acc$1442;var $index$1501;var $length$1496;var temp$1491;var acc$1486;var other$1481;var $1292$1429;var tag$1293;var _classes$1294;var id$1295;var kv$1296;var sub$1297;var node$1298;var other$1521;var classes$1286;var children$1287;var args$1244;var s$1239;var $1218$1236;var t0$1234;var default_tag$1229;var $1217$1230;var t0$1225;var $1216$1220;($1216$1220=arguments);;(t0$1225=$1216$1220.length);if(((t0$1225>=1)&&(t0$1225<=2))){($1217$1230=$1216$1220[0]);(default_tag$1229=function(){if((1>=t0$1225)){return "div";}else{return $1216$1220[1];}}());(t0$1234=$1217$1230);if((typeof(t0$1234)==="string")){(s$1239=t0$1234);return document.createTextNode(s$1239);}else{if($996(Array)(t0$1234)){(args$1244=t0$1234);(node$1248=document.createElement("span"));;(temp$1256=args$1244);;($length$1261=temp$1256.length);;($index$1266=0);;$1249:for(;($index$1266<$length$1261);($index$1266++)){var arg$1282;var m$1274;(m$1274=temp$1256[$index$1266]);;(arg$1282=m$1274);node$1248.appendChild(make_dom$1076(arg$1282,default_tag$1229));}return node$1248;}else{if(($996($2628)(t0$1234)&&($2755(t0$1234,"classes")&&((classes$1286=t0$1234.classes),$2755(t0$1234,"children"))))){(children$1287=t0$1234.children);(tag$1293=default_tag$1229);;(_classes$1294=[]);;(id$1295=null);;(kv$1296=[]);;(sub$1297=[]);;(temp$1323=classes$1286);;($length$1328=temp$1323.length);;($index$1333=0);;$1299:for(;($index$1333<$length$1328);($index$1333++)){var s$1381;var m$1374;var m$1367;var k$1362;var k$1355;var v$1356;var $1301$1350;var $1302$1351;var $1303$1352;var t0$1346;var t1$1347;var t2$1348;var m$1341;(m$1341=temp$1323[$index$1333]);;(t0$1346=m$1341);if((($1302$1351=(t0$1346 instanceof Array))&&((t1$1347=t0$1346.length),((t1$1347===3)&&(t0$1346[0]==="assoc"))))){(k$1355=t0$1346[1]);(v$1356=t0$1346[2]);kv$1296.push([k$1355,v$1356]);}else{if(($1302$1351&&((t1$1347===2)&&(t0$1346[0]==="assoc")))){(k$1362=t0$1346[1]);kv$1296.push([k$1362,(void 0)]);}else{(t0$1346=$2600(RegExp("(?:^\\+((?:.*)))",""))(m$1341));if((t0$1346[0]&&((t1$1347=t0$1346[1]),((t2$1348=t1$1347.length),(t2$1348===2))))){t1$1347[0];(m$1367=t1$1347[1]);(tag$1293=m$1367);}else{(t0$1346=$2600(RegExp("(?:^#((?:.*)))",""))(m$1341));if((t0$1346[0]&&((t1$1347=t0$1346[1]),((t2$1348=t1$1347.length),(t2$1348===2))))){t1$1347[0];(m$1374=t1$1347[1]);(id$1295=m$1374);}else{(t0$1346=m$1341);if((typeof(t0$1346)==="string")){(s$1381=t0$1346);_classes$1294.push(s$1381);}else{$2396(m$1341,"/home/olivier/git/egrepl/src/repl.eg",2357,2678);;}}}}}}(node$1298=document.createElement(tag$1293));;if(id$1295){(node$1298["id"]=id$1295);}if(_classes$1294.length){(node$1298["className"]=_classes$1294.join(" "));}(temp$1393=kv$1296);;($length$1398=temp$1393.length);;($index$1403=0);;$1304:for(;($index$1403<$length$1398);($index$1403++)){var k$1421;var v$1422;var t0$1416;var t1$1417;var m$1411;(m$1411=temp$1393[$index$1403]);;(t0$1416=m$1411);if(((t0$1416 instanceof Array)&&((t1$1417=t0$1416.length),(t1$1417===2)))){(k$1421=t0$1416[0]);(v$1422=t0$1416[1]);(node$1298[k$1421]=v$1422);}else{$2396(m$1411,"/home/olivier/git/egrepl/src/repl.eg",2827,2874);;}}($1292$1429=tag$1293);;if(($1292$1429==="raw")){(acc$1442=[]);;(temp$1447=children$1287);;($length$1452=temp$1447.length);;($index$1457=0);;$1439:for(;($index$1457<$length$1452);($index$1457++)){var s$1474;var t0$1470;var m$1465;(m$1465=temp$1447[$index$1457]);;(t0$1470=m$1465);if((typeof(t0$1470)==="string")){(s$1474=t0$1470);acc$1442.push((node$1298["innerHTML"]=s$1474));}else{$2396(m$1465,"/home/olivier/git/egrepl/src/repl.eg",2901,3003);;}}acc$1442;}else{(other$1481=$1292$1429);(acc$1486=[]);;(temp$1491=children$1287);;($length$1496=temp$1491.length);;($index$1501=0);;$1483:for(;($index$1501<$length$1496);($index$1501++)){var c$1517;var m$1509;(m$1509=temp$1491[$index$1501]);;(c$1517=m$1509);acc$1486.push(node$1298.appendChild(make_dom$1076(c$1517,default_tag$1229)));}acc$1486;}return node$1298;}else{(other$1521=$1217$1230);return make_dom$1076([true,String(other$1521)][1]);}}}}else{$2396($1216$1220);}});;(mktable$1077=function(){var other$1562;var $1548$1550;var $index$1583;var $length$1578;var temp$1573;var acc$1568;var its$1545;var x$1540;var recur$1541;var t0$1536;var $1529$1531;($1529$1531=arguments);;(t0$1536=$1529$1531.length);if(((t0$1536>=1)&&(t0$1536<=2))){(x$1540=$1529$1531[0]);(recur$1541=function(){if((1>=t0$1536)){return repr$1079;}else{return $1529$1531[1];}}());(its$1545=((($1548$1550=x$1540)),function(){if($996(Array)($1548$1550)){return x$1540;}else{(other$1562=$1548$1550);return $2381(x$1540);}}()));;if(its$1545.length){return $2628(["+table","object"],(((acc$1568=[])),(((temp$1573=its$1545)),((($length$1578=temp$1573.length)),((($index$1583=0)),function(){$1565:for(;($index$1583<$length$1578);($index$1583++)){var k$1601;var v$1602;var t0$1596;var t1$1597;var m$1591;(m$1591=temp$1573[$index$1583]);;(t0$1596=m$1591);if(((t0$1596 instanceof Array)&&((t1$1597=t0$1596.length),(t1$1597===2)))){(k$1601=t0$1596[0]);(v$1602=t0$1596[1]);acc$1568.push($2628(["+tr"],[$2628(["+th"],recur$1541(k$1601,repr$1079)),$2628(["+td"],recur$1541(v$1602,repr$1079))]));}else{$2396(m$1591,"/home/olivier/git/egrepl/src/repl.eg",3297,3431);;}}}()))),acc$1568));}else{return $2628(["object","empty"],[]);}}else{$2396($1529$1531);}});;(mktable2$1078=function(){var other$1647;var $1633$1635;var $index$1668;var $length$1663;var temp$1658;var acc$1653;var its$1630;var x$1625;var recur$1626;var t0$1621;var $1614$1616;($1614$1616=arguments);;(t0$1621=$1614$1616.length);if(((t0$1621>=1)&&(t0$1621<=2))){(x$1625=$1614$1616[0]);(recur$1626=function(){if((1>=t0$1621)){return repr$1079;}else{return $1614$1616[1];}}());(its$1630=((($1633$1635=x$1625)),function(){if($996(Array)($1633$1635)){return x$1625;}else{(other$1647=$1633$1635);return $2381(x$1625);}}()));;return $2628(["+table"],(((acc$1653=[])),(((temp$1658=its$1630)),((($length$1663=temp$1658.length)),((($index$1668=0)),function(){$1650:for(;($index$1668<$length$1663);($index$1668++)){var k$1686;var v$1687;var t0$1681;var t1$1682;var m$1676;(m$1676=temp$1658[$index$1668]);;(t0$1681=m$1676);if(((t0$1681 instanceof Array)&&((t1$1682=t0$1681.length),(t1$1682===2)))){(k$1686=t0$1681[0]);(v$1687=t0$1681[1]);acc$1653.push($2628(["+tr"],[$2628(["+th"],recur$1626(k$1686,repr$1079)),$2628(["+td"],recur$1626(v$1687,repr$1079))]));}else{$2396(m$1676,"/home/olivier/git/egrepl/src/repl.eg",3561,3666);;}}}()))),acc$1653));}else{$2396($1614$1616);}});;(repr$1079=function(){var $index$1786;var $length$1781;var temp$1776;var acc$1771;var other$1832;var f$1827;var n$1806;var entries$1765;var $1701$1728;var $1702$1729;var t0$1725;var t1$1726;var x$1715;var recur$1716;var $1700$1717;var t0$1709;var t1$1710;var t2$1711;var $1699$1704;($1699$1704=arguments);;(t0$1709=$1699$1704.length);if((((t0$1709>=1)&&(t0$1709<=2))&&((t1$1710=$1699$1704[0]),((x$1715=t1$1710),(($1700$1717=t1$1710),((t2$1711=function(){if((1>=t0$1709)){return repr$1079;}else{return $1699$1704[1];}}()),$996(Function)(t2$1711))))))){(recur$1716=t2$1711);if(($1700$1717===true)){return $2628(["special","true"],"true");}else{if(($1700$1717===false)){return $2628(["special","false"],"false");}else{if(($1700$1717===null)){return $2628(["special","nil"],"null");}else{if(($1700$1717===(void 0))){return $2628(["special","nil"],"undefined");}else{if((typeof($1700$1717)==="number")){return $2628(["num"],String(x$1715));}else{if(($1700$1717==="")){return $2628(["str","empty"],[]);}else{if((typeof($1700$1717)==="string")){return $2628(["str"],x$1715);}else{(t0$1725=$1700$1717);if((($1702$1729=$996(Array)(t0$1725))&&((t1$1726=t0$1725.length),(t1$1726===0)))){return $2628(["sequence","empty"],[]);}else{if($1702$1729){(entries$1765=t0$1725);return $2628(["sequence"],(((acc$1771=[])),(((temp$1776=entries$1765)),((($length$1781=temp$1776.length)),((($index$1786=0)),function(){$1768:for(;($index$1786<$length$1781);($index$1786++)){var x$1802;var m$1794;(m$1794=temp$1776[$index$1786]);;(x$1802=m$1794);acc$1771.push(recur$1716(x$1802,repr$1079));}}()))),acc$1771));}else{if($996($2628)(t0$1725)){(n$1806=t0$1725);return n$1806;}else{$1700$1717;if(x$1715["::repr"]){return x$1715["::repr"](recur$1716);}else{if((Object.getPrototypeOf(x$1715)===Object.prototype)){return mktable$1077(x$1715);}else{if((x$1715.constructor&&x$1715.constructor["::egclass"])){return $2628(["instance"],[$2628(["classname"],x$1715.constructor["::name"]),mktable$1077(x$1715)]);}else{if(x$1715["::egclass"]){return $2628(["class"],[$2628(["classname"],("Class "+x$1715["::name"])),mktable$1077(x$1715.prototype)]);}else{(t0$1725=$1700$1717);if($996(Function)(t0$1725)){(f$1827=t0$1725);return $2628(["function"],function(){if(f$1827.name){return f$1827.name;}else{return "<anonymous>";}}());}else{(other$1832=$1700$1717);return $2628(["unknown"],other$1832.toString());}}}}}}}}}}}}}}}}else{$2396($1699$1704);}});;(goto_end$1080=function(elem$1840){var range$1843;var selection$1844;(range$1843=document.createRange());;range$1843.selectNodeContents(elem$1840);range$1843.collapse(false);(selection$1844=window.getSelection());;selection$1844.removeAllRanges();return selection$1844.addRange(range$1843);});;(insert_before_caret$1081=function(text$1855){var other$1876;var $1862$1864;var it$0$1888;var it$0$1894;var range$1883;var node$1858;var sel$1859;(node$1858=((($1862$1864=text$1855)),function(){if((typeof($1862$1864)==="string")){return document.createTextNode(text$1855);}else{(other$1876=$1862$1864);return other$1876;}}()));;(sel$1859=window.getSelection());;if(sel$1859.rangeCount){(range$1883=sel$1859.getRangeAt(0));;(it$0$1888=range$1883);;it$0$1888.collapse(false);it$0$1888.insertNode(node$1858);(range$1883=range$1883.cloneRange());(it$0$1894=range$1883);;it$0$1894.selectNodeContents(node$1858);it$0$1894.collapse(false);sel$1859.removeAllRanges();return sel$1859.addRange(range$1883);}});;(Error.prototype["::repr"]=function(){return format_error$1069(this);});(Repl$1082=function(box$1905,target$1906,input$1907,evaluator$1908){var it$0$1911;(it$0$1911=function(){if((!$996(Repl$1082)(this))){return Object.create(Repl$1082.prototype);}else{return this;}}());;(it$0$1911["url"]="<repl>");(it$0$1911["gen"]=eg$1063.Generator(true));(it$0$1911["evaluator"]=evaluator$1908);(it$0$1911["box"]=box$1905);(it$0$1911["target"]=target$1906);(it$0$1911["input"]=input$1907);(it$0$1911["multiline"]=false);(it$0$1911["interactor"]=kb$1062.Interactor(({})));it$0$1911.set_multiline(false);it$0$1911.interactor.install(it$0$1911.input);(it$0$1911["cursor"]=0);(it$0$1911["history"]=[""]);return it$0$1911;});;(Repl$1082.prototype["sink"]=function(){var self$1928;var it$0$1923;(it$0$1923=this);;(self$1928=this);;return jQuery(it$0$1923.box).scrollTop(it$0$1923.box.scrollHeight);});(Repl$1082.prototype["add_to_history"]=function(text$1935){var hl$1948;var self$1943;var it$0$1938;(it$0$1938=this);;(self$1943=this);;(hl$1948=it$0$1938.history.length);;if(((text$1935!=="")&&(!((hl$1948>1)&&$2793($1011(it$0$1938.history,(hl$1948-2)),text$1935))))){(it$0$1938.history[(hl$1948-1)]=text$1935);it$0$1938.history.push("");}return (it$0$1938["cursor"]=(it$0$1938.history.length-1));});(Repl$1082.prototype["submit"]=function(){var text$1968;var self$1963;var it$0$1958;(it$0$1958=this);;(self$1963=this);;it$0$1958.set_multiline(false);(text$1968=it$0$1958.input.textContent);;it$0$1958.process(text$1968);(it$0$1958.input["innerHTML"]="");return it$0$1958.sink();});(Repl$1082.prototype["begin_multiline"]=function(){var self$1982;var it$0$1977;(it$0$1977=this);;(self$1982=this);;it$0$1977.set_multiline(true);goto_end$1080(it$0$1977.input);insert_before_caret$1081("\n   ");return it$0$1977.sink();});(Repl$1082.prototype["set_multiline"]=function(x$1990){var accum$2029;var accum$2035;var accum$2047;var accum$2054;var accum$2061;var accum$2088;var accum$2095;var accum$2101;var accum$2108;var previous$2011;var next$2012;var common$2013;var $1998$2004;var self$1999;var it$0$1993;(it$0$1993=this);;(self$1999=this);;($1998$2004=x$1990);;(previous$2011=function(){if((it$0$1993.cursor>0)){(it$0$1993.input["textContent"]=$1011(it$0$1993.history,(--it$0$1993.cursor)));goto_end$1080(it$0$1993.input);return it$0$1993.sink();}});;(next$2012=function(){if((it$0$1993.cursor<(it$0$1993.history.length-1))){(it$0$1993.input["textContent"]=$1011(it$0$1993.history,(++it$0$1993.cursor)));goto_end$1080(it$0$1993.input);return it$0$1993.sink();}});;(common$2013=$1012(((accum$2029=({})),((accum$2029["C-l"]=function(){return jQuery(it$0$1993.target).empty();}),accum$2029)),((accum$2035=({})),((accum$2035["S-Enter"]=function(){return it$0$1993.submit();}),accum$2035))));;if(($1998$2004===false)){jQuery(it$0$1993.input).removeClass("multiline");return it$0$1993.interactor.set_bindings($2915(common$2013,$1012(((accum$2047=({})),((accum$2047["C-m"]=function(){it$0$1993.set_multiline(true);return "break";}),accum$2047)),$1012(((accum$2054=({})),((accum$2054["C-Enter"]=function(){it$0$1993.begin_multiline();return "break";}),accum$2054)),$1012(((accum$2061=({})),((accum$2061["Enter"]=function(){var other$2080;var $2066$2068;($2066$2068=it$0$1993.input.textContent);;if($996(RegExp("(=|->|%|:|with|where|each)$",""))($2066$2068)){return it$0$1993.begin_multiline();}else{(other$2080=$2066$2068);return it$0$1993.submit();}}),accum$2061)),({"Up":previous$2011,"Down":next$2012}))))));}else{if(($1998$2004===true)){jQuery(it$0$1993.input).addClass("multiline");return it$0$1993.interactor.set_bindings($2915(common$2013,$1012(((accum$2088=({})),((accum$2088["C-m"]=function(){it$0$1993.set_multiline(false);return "break";}),accum$2088)),$1012(((accum$2095=({})),((accum$2095["C-Enter"]=function(){return it$0$1993.submit();}),accum$2095)),$1012(((accum$2101=({})),((accum$2101["Enter"]=function(){insert_before_caret$1081("\n");return it$0$1993.sink();}),accum$2101)),((accum$2108=({})),((accum$2108["Tab"]=function(){return insert_before_caret$1081("   ");}),accum$2108)))))));}else{$2396($1998$2004);}}});(Repl$1082.prototype["generate"]=function(text$2118){var self$2126;var it$0$2121;(it$0$2121=this);;(self$2126=this);;return it$0$2121.gen.generate(eg$1063.Source(text$2118,it$0$2121.url));});(Repl$1082.prototype["eval"]=function(text$2133){var rval$2165;var gen$2146;var handle$2147;var self$2141;var it$0$2136;(it$0$2136=this);;(self$2141=this);;(gen$2146=function(){var g$2153;(g$2153=it$0$2136.generate(text$2133));;return ["success",it$0$2136.evaluator(g$2153)];});;(handle$2147=function(e$2161){return ["failure",e$2161];});;(rval$2165=false);;try{(rval$2165=gen$2146());}catch(excv$2171){var e$2177;(e$2177=excv$2171);(rval$2165=handle$2147(e$2177));}return rval$2165;});(Repl$1082.prototype["process"]=function(){var error$2258;var value$2253;var n$2247;var $2219$2232;var $2220$2233;var $2221$2234;var $2222$2235;var t0$2229;var t1$2230;var $2218$2224;var real_text$2208;var node$2209;var name$2210;var collapse$2211;var on$2212;var self$2203;var it$0$2198;var text$2193;var display_in$2194;var t0$2189;var $2182$2184;($2182$2184=arguments);;(t0$2189=$2182$2184.length);if(((t0$2189>=1)&&(t0$2189<=2))){(text$2193=$2182$2184[0]);(display_in$2194=function(){if((1>=t0$2189)){return true;}else{return $2182$2184[1];}}());(it$0$2198=this);;(self$2203=this);;it$0$2198.add_to_history(text$2193);(real_text$2208=(("\n"+text$2193)+"\n"));;(node$2209=make_dom$1076($2628(["io"],[function(){if(display_in$2194){return $2628(["in"],[$2628(["inbanner"],[]),$2628(["entry"],(text$2193||" "))]);}else{return "";}}(),((($2218$2224=it$0$2198.eval(real_text$2208))),($2218$2224,function(){if((text$2193&&(text$2193.trim()===""))){return "";}else{if((($2219$2232=($2218$2224 instanceof Array))&&((t0$2229=$2218$2224.length),(($2221$2234=(t0$2229===2))&&(($2222$2235=($2218$2224[0]==="success"))&&($2218$2224[1]===(void 0))))))){return "";}else{if(($2222$2235&&((t1$2230=$2218$2224[1]),$996($2628)(t1$2230)))){(n$2247=t1$2230);return $2628(["display"],[$2628(["displaybanner"],[]),$2628(["result"],n$2247)]);}else{if($2222$2235){(value$2253=$2218$2224[1]);return $2628(["out"],[$2628(["outbanner"],[]),$2628(["result"],$2628(["eg"],repr$1079(value$2253)))]);}else{if(($2221$2234&&($2218$2224[0]==="failure"))){(error$2258=$2218$2224[1]);return $2628(["err"],[$2628(["errbanner"],[]),$2628(["result"],$2628(["eg"],repr$1079(error$2258)))]);}else{$2396($2218$2224);}}}}}}()))])));;(name$2210=gensym$1074());;(node$2209["id"]=name$2210);it$0$2198.target.appendChild(node$2209);(collapse$2211=function(e$2270){var at_top$2273;e$2270.stopPropagation();(at_top$2273=$2793((it$0$2198.box.scrollTop+jQuery(it$0$2198.box).height()),it$0$2198.box.scrollHeight));;jQuery(this).toggleClass("collapsed");if(at_top$2273){return jQuery(it$0$2198.box).scrollTop(it$0$2198.box.scrollHeight);}});;(on$2212=function(sel$2282){return jQuery(((("#"+name$2210)+" ")+sel$2282));});;on$2212(".sequence").addClass("complex");on$2212(".object").addClass("complex");on$2212(".complex").click(collapse$2211);on$2212(".complex .complex .complex").addClass("collapsed");on$2212(".error_args.syntax").addClass("collapsed").click(collapse$2211);return on$2212(".traceback").addClass("collapsed").click(collapse$2211);}else{$2396($2182$2184);}});$1012(Repl$1082,$1012(((accum$2288=({})),((accum$2288["::name"]="Repl"),accum$2288)),((accum$2292=({})),((accum$2292["::egclass"]=true),accum$2292))));Repl$1082;(make_cards$1083=function(repl$2298){var clickable$2301;var clickable_row$2302;(clickable$2301=function(text$2306){var click$2309;(click$2309=function(e$2313){e$2313.preventDefault();repl$2298.process(text$2306);repl$2298.sink();return jQuery(repl$2298.input).focus();});;return $2628(["clickable",["assoc","onclick",click$2309]],text$2306);});;(clickable_row$2302=function(){var $index$2353;var $length$2348;var temp$2343;var acc$2338;var items$2332;var t0$2328;var $2321$2323;($2321$2323=arguments);;(t0$2328=$2321$2323.length);if((t0$2328>=0)){(items$2332=Array.prototype.slice.call($2321$2323,0));return $2628(["+span"],(((acc$2338=[])),(((temp$2343=items$2332)),((($length$2348=temp$2343.length)),((($index$2353=0)),function(){$2335:for(;($index$2353<$length$2348);($index$2353++)){var item$2374;var item$2369;var m$2361;(m$2361=temp$2343[$index$2353]);;(item$2369=m$2361);if(($index$2353===0)){acc$2338.push(clickable$2301(item$2369));}else{(item$2374=m$2361);acc$2338.push($2628(["+span"],[$2628(["+span","separator"],""),clickable$2301(item$2374)]));}}}()))),acc$2338));}else{$2396($2321$2323);}});;return [$2628(["card"],[$2628(["+h3"],"Keyboard controls"),mktable2$1078([[$2628(["+code"],"Up/Down"),"Navigate history"],[$2628(["+code"],"Enter/Shift-Enter"),"Evaluate an expression"],[$2628(["+code"],"Control-l"),"Clear the screen"],[$2628(["+code"],"Control-m"),"Toggle mulitline mode"]]),"Type ",clickable$2301("next")," to continue with the tutorial"]),$2628(["card"],[$2628(["+h3"],"Basics"),$2628([],["Click on boxes like ",clickable$2301("this")," to evaluate their contents."]),$2628(["+h4"],"Strings"),$2628(["+span"],clickable_row$2302("\"hello world\"",".word","\"My name is \\\"Olivier\\\"\"")),$2628(["+h4"],"Numbers"),mktable2$1078([[$2628([],"Decimal"),clickable_row$2302("1","1.4","4.93e51")],[$2628([],"Hex"),clickable_row$2302("16rFF","16r100","16rDEADBEEF","16r0.8")],[$2628([],"Binary etc."),clickable_row$2302("2r1110","3r20","36rZAZZ")]]),$2628(["+h4"],"Function calls"),mktable2$1078([[$2628([],"Call"),clickable_row$2302("alert{\"Hello!\"}","alert with \"Hello!\"")],[$2628([],"Methods"),clickable_row$2302("\"hello\".substring{1}")]]),clickable$2301("next")," => variables"]),$2628(["card"],[$2628(["+h3"],"Variables"),$2628([],["There are separate operators for declaration and assignment. ","A variable cannot be assigned to before it is declared."]),$2628(["+table"],[$2628(["+tr"],[$2628(["+td"],[$2628(["+b"],"Declare")," a variable"]),$2628(["+td"],clickable$2301("x = 1234"))]),$2628(["+tr"],[$2628(["+td"],[$2628(["+b"],"Set")," an existing variable"]),$2628(["+td"],clickable$2301("x := 999"))]),$2628(["+tr"],[$2628(["+td"],[$2628(["+b"],"Use")," your variable!"]),$2628(["+td"],clickable$2301("x + x"))])]),$2628([],["You can create blocks with their own local variables using ",$2628(["+code"],"[]"),", ",$2628(["+code"],"let")," or ",$2628(["+code"],"where")]),$2628([],clickable$2301("[a = 10, b = 90, a + b]")),$2628([],clickable$2301("let [a = 10, b = 90]: a + b")),$2628([],clickable$2301("a + b where\n   a = 10\n   b = 90")),$2628([],["Be aware that ",$2628(["+code"],"[]")," only creates a block"," when it encloses more than one expression."]),$2628([],["An indented block is completely equivalent to ","wrapping it in ",$2628(["+code"],"[]"),"s"]),clickable$2301("next")," => data structures"]),$2628(["card"],[$2628(["+h3"],"Data structures"),$2628([],["Earl Grey uses curly braces ",$2628(["+code"],"{}")," to define all data structures."]),mktable2$1078([[$2628([],"Arrays"),clickable_row$2302("{1, 2, 3}","{1, {2, 3}}","{\"hello\"}")],[$2628([],"Objects"),clickable_row$2302("{name = .Peter, age = 20}","{\"a\" => 123}")]]),$2628([],["The empty array is ",clickable$2301("{}")," and the empty object is ",clickable$2301("{=}")]),$2628(["+h4"],"Deconstruction"),$2628([],"You can extract array elements and object fields into variables directly."),$2628([],clickable$2301("{x, y} = {11, 22}")),$2628([],clickable$2301("{x, *rest, y} = {111, 222, 333, 444}")),$2628([],clickable$2301("{=> name} = {name = .Peter, age = 20}")),$2628(["+h4"],"Operations"),mktable2$1078([[$2628([],"Concatenation"),clickable$2301("{1, 2} ++ {3, 4, 5}")],[$2628([],"Object fusion"),clickable$2301("{name = .Kim} & {age = 39}")]]),clickable$2301("next")," => control structures"]),$2628(["card"],[$2628(["+h3"],"Control structures"),$2628([],[$2628(["+code"],"if")," and ",$2628(["+code"],"while")," are available."]),$2628([],clickable$2301("if [13 > 0]:\n   then: \"This number is positive!\"\n   else: \"This number is negative!\"\n")),$2628([],clickable$2301("i = 3\nwhile [i > 0]:\n   alert{i}\n   i--\n")),$2628([],["Notice that both branches of ",$2628(["+code"],"if")," must be nested."," The expression form of ",$2628(["+code"],"if")," is simply ",clickable$2301("if{1, .yes, .no}")]),clickable$2301("next")," => control structures [2]"]),$2628(["card"],[$2628(["+h3"],"Control structures [2]"),$2628([],["Earl Grey's ",$2628(["+code"],"if")," nests poorly, so if you want to ","write many clauses use ",$2628(["+code"],"match")]),$2628([],clickable$2301("x = 13\nmatch:\n   when x > 0 -> .positive\n   when x < 0 -> .negative\n   when x == 0 -> .zero\n")),$2628([],"You can also match on the variable directly!"),$2628([],clickable$2301("x = 13\nmatch x:\n   > 0 -> .positive\n   < 0 -> .negative\n   0 -> .zero\n")),$2628([],["The left hand side of the arrow is a special pattern matching"," language, whereas ",$2628(["+code"],"when")," takes a standard expression."]),clickable$2301("next")," => each"]),$2628(["card"],[$2628(["+h3"],"each"),$2628([],["A single operator serves both looping over data structures"," and list comprehensions."]),$2628([],clickable$2301("{1, 2, 3} each i -> -i")),$2628([],clickable$2301("1..10 each i -> i * i")),$2628([],clickable$2301("1..10 each i when i mod 2 == 0 -> i")),$2628([],"You can have more than one clause"),$2628([],clickable$2301("{1, 2, .hello, 4, 72, 99, {}} each\n   String? s -> {s, .string}\n   Number? i when i mod 2 == 0 -> {i, .even}\n   Number? i when i mod 2 == 1 -> {i, .odd}\n   x -> {x, .dunno}\n")),$2628([],[$2628(["+code"],"first")," and ",$2628(["+code"],"last")," are special patterns"]),$2628([],clickable$2301("acc = \"\"\n{.a, .b, .c, .d} each\n   first x -> acc += \"[\" + x\n   last x -> acc += \", \" + x + \"]\"\n   x -> acc += \", \" + x\nacc\n")),$2628([],"Be careful to put the catchall clause last."),clickable$2301("next")," => functions"]),$2628(["card"],[$2628(["+h3"],"Functions"),$2628([],["Functions are declared with ",$2628(["+code"],"=")," or ",$2628(["+code"],"->"),". For instance the following are equivalent"]),$2628([],clickable$2301("f{x, y} = [x * x + y * y] ** 0.5")),$2628([],clickable$2301("f = {x, y} -> [x * x + y * y] ** 0.5")),$2628([],"It works inside object definitions as well, of course"),$2628([],clickable$2301("{add1{x} = x + 1, add2{x} = x + 2}")),$2628([],["Pattern matching is deeply integrated in Earl Grey. ","For instance:"]),$2628([],clickable$2301("fact{match} =\n   0 or 1 -> 1\n   n -> n * fact{n - 1}\n")),clickable$2301("next")," => type checking and coercion"]),$2628(["card"],[$2628(["+h3"],"Type checking and coercion"),mktable2$1078([[$2628([],"Type checking"),clickable_row$2302("String? .hello","Number? 1","Array? .nope","R\"x$\"? .simplex")],[$2628([],"Coercion"),clickable_row$2302("String! {1, 2}","Number! \"3.14\"","Array! .yep")]]),$2628([],["Both type checking and coercion can be used in patterns."," Observe the difference in behavior of the following functions "," (try on ",clickable$2301("f{1, \"2\"}"),")"]),$2628([],clickable$2301("f{x, y} = x + y")),$2628([],clickable$2301("f{Number? x, Number? y} = x + y")),$2628([],clickable$2301("f{Number! x, Number! y} = x + y")),$2628([],["Functions naturally act as coercers: ",clickable$2301("parseInt! x = \"99\"")]),$2628(["+h4"],"Predicates"),$2628([],["You can create your own predicates with the ",$2628(["+code"],"predicate")," builtin"]),$2628([],clickable$2301("predicate! even{x} = x mod 2 == 0")),$2628([],clickable_row$2302("even? x = 1","even? x = 2")),clickable$2301("next")," => classes"]),$2628(["card"],[$2628(["+h3"],"Classes"),$2628([],["Classes are declared with the ",$2628(["+code"],"class")," macro. As a convenience, @ can be used to"," refer to fields and members of the instance."]),$2628([],clickable$2301("class Person:\n   constructor{name, age, job} =\n      @name := name\n      @age := age\n      @job := job\n   hello{} =\n      \"Hello, I am \" + @name + \", \" + @age + \", and I am a \" + @job\n")),$2628([],["The ",$2628(["+code"],"new")," keyword is optional."," I prefer to avoid it."]),$2628([],clickable$2301("Person{.Sonia, 25, .baker}")),$2628([],clickable$2301("Person{.Jack, 56, \"serial murderer\"}.hello{}")),clickable$2301("next")," => HTML generation"]),$2628(["card"],[$2628(["+h3"],"Here, let's have some fun"),$2628([],["The ",$2628(["+code"],"%")," operator creates structured data"," which is directly translated as HTML."]),$2628([],clickable_row$2302("b % .hello","i % .hello")),$2628([],"We can print out a multiplication table!"),$2628([],clickable_row$2302("table % 1..10 each i ->\n   tr % 1..10 each j ->\n      td % i * j\n"))]),$2628(["card"],[$2628(["+h3"],"The end"),$2628([],["This is the end of this humble tutorial,"," but you can keep messing around with the language,"," it's a lot of fun :)"])])];});;(exports["Repl"]=Repl$1082);(exports["Interactor"]=kb$1062.Interactor);(exports["parse"]=parse$1073);(exports["tokenize"]=tokenize$1071);(exports["Source"]=eg$1063.Source);(exports["make_cards"]=make_cards$1083);

},{"../lib/earl-grey":4,"../lib/lex":6,"../lib/location":7,"../lib/parse":9,"../lib/util":14,"./kb":1}],"repl":[function(require,module,exports){
module.exports=require('eXk3/i');
},{}],4:[function(require,module,exports){
var $185=function(type$187){var f$190;(f$190=type$187["::check"]);;if((f$190===(void 0))){return function(value$195){return (value$195 instanceof type$187);};}else{return function(value$198){return f$190.call(type$187,value$198);};}};
var $200=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $201=function(dest$203,values$204){var k$209;(k$209=null);$207:for(k$209 in values$204){if(values$204.hasOwnProperty(k$209)){(dest$203[k$209]=values$204[k$209]);}}return dest$203;};
var $213=function($214$216){var ph$220;(ph$220=$214$216);;var $218$225;($218$225=ph$220);;var bridge$219$230;var x$234;(bridge$219$230=$218$225);if((((typeof(bridge$219$230)==="string")&&((x$234=bridge$219$230),true))||((typeof(bridge$219$230)==="number")&&((x$234=bridge$219$230),true)))){return ["value",x$234];}else{var other$241;(other$241=$218$225);return other$241["::serialize_ast"]();}};
var send$25;(send$25=function(obj$30,$28$31){var ph$35;var msg$36;var t0$38;(t0$38=$28$31);(msg$36=t0$38);(ph$35=t0$38);;var $33$42;($33$42=ph$35);;var bridge$34$47;(bridge$34$47=$33$42);if(((typeof(bridge$34$47)==="string")||(typeof(bridge$34$47)==="number"))){return obj$30[msg$36];}else{var other$55;(other$55=$33$42);return obj$30["::send"](msg$36);}});;(Array[":::project"]=function($58$60){var ph$63;var value$64;var t0$66;(t0$66=$58$60);(value$64=t0$66);(ph$63=t0$66);;var $62$70;($62$70=ph$63);;if($185(Array)($62$70)){return [true,value$64];}else{$62$70;return [true,[value$64]];}});(Array.prototype["::check"]=function(value$84){if((value$84 instanceof Array)){var i$89;(i$89=0);;$87:for(;(i$89<this.length);(i$89++)){if(($200(this,i$89)!==$200(value$84,i$89))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $201(this.slice(0),this);});(Array.prototype[":::project"]=function(value$100){if((value$100 instanceof Array)){var i$105;(i$105=0);;$103:for(;(i$105<this.length);(i$105++)){if(($200(this,i$105)!==$200(value$100,i$105))){return [true,[value$100]];}}return [true,value$100.slice(this.length)];}else{return [true,[value$100]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($213));});(RegExp.prototype["::check"]=function($115$117){var ph$120;(ph$120=$115$117);;var $119$125;($119$125=ph$120);;var value$133;if((typeof($119$125)==="string")){(value$133=$119$125);if(value$133.match(this)){return true;}else{return false;}}else{var other$138;(other$138=$119$125);return false;}});(RegExp.prototype[":::project"]=function($140$142){var ph$145;(ph$145=$140$142);;var $144$150;($144$150=ph$145);;var value$158;if((typeof($144$150)==="string")){(value$158=$144$150);var $161$163;($161$163=value$158.match(this));;var m$171;if(($161$163===null)){(m$171=$161$163);return [false,null];}else{var m$176;(m$176=$161$163);return [true,m$176];}}else{var other$180;(other$180=$144$150);return [false,null];}});(Function.prototype["::send"]=function(args$183){return this.apply(this,args$183);});
var $744=function(arr$746){var results$750;var l$751;(results$750=[]);;(l$751=arr$746.length);;var i$759;(i$759=0);;$749:for(;(i$759<l$751);(i$759++)){results$750.push([i$759,$200(arr$746,i$759)]);}return results$750;};
var $575=function(){var $576$578;($576$578=function(tags$582){var it$0$585;(it$0$585=function(){if((!$185($576$578)(this))){return Object.create($576$578.prototype);}else{return this;}}());;(it$0$585["tags"]=tags$582);return it$0$585;});;($576$578.prototype["create"]=function(){var $594$596;($594$596=arguments);;var t0$601;var message$605;var args$606;(t0$601=$594$596.length);if((t0$601>=0)){(message$605=function(){if((0>=t0$601)){return "";}else{return $594$596[0];}}());(args$606=Array.prototype.slice.call($594$596,1));var it$0$610;(it$0$610=this);;var self$615;(self$615=this);;var e$620;(e$620=Error(message$605));;(e$620["::tags"]=it$0$610.tags);(e$620["args"]=args$606);var temp$628;(temp$628=$744(args$606));;var $length$633;($length$633=temp$628.length);;var $index$638;($index$638=0);;$621:for(;($index$638<$length$633);($index$638++)){var m$646;(m$646=temp$628[$index$638]);;var t0$651;var t1$652;var i$656;var arg$657;(t0$651=m$646);if(((t0$651 instanceof Array)&&((t1$652=t0$651.length),(t1$652===2)))){(i$656=t0$651[0]);(arg$657=t0$651[1]);(e$620[i$656]=arg$657);}else{$562(m$646);;}}(e$620["length"]=args$606.length);(e$620["name"]=["E"].concat(it$0$610.tags).join("."));return e$620;}else{$562($594$596);}});($576$578.prototype["::check"]=function(e$668){var it$0$671;(it$0$671=this);;var self$676;(self$676=this);;var tags$681;if(((!e$668)||(!$185(Error)(e$668)))){return false;}(tags$681=(e$668["::tags"]||[]));;var temp$690;(temp$690=it$0$671.tags);;var $length$695;($length$695=temp$690.length);;var $index$700;($index$700=0);;$682:for(;($index$700<$length$695);($index$700++)){var m$708;(m$708=temp$690[$index$700]);;var tag$716;(tag$716=m$708);if((tags$681.indexOf(tag$716)===-1)){return false;}else{false;;}}return true;});($576$578.prototype["::deconstruct"]=function(e$724){var it$0$727;(it$0$727=this);;var self$732;(self$732=this);;return e$724.args;});$201($576$578,$201(function(){var accum$737;(accum$737=({}));(accum$737["::name"]="$576");return accum$737;}(),function(){var accum$741;(accum$741=({}));(accum$741["::egclass"]=true);return accum$741;}()));return $576$578;}();
var $562=function(value$564,url$565,start$566,end$567){var err$570;(err$570=$575(["match"]).create("Could not find a match for value",({"value":value$564})));;if(url$565){(err$570["location"]=["location",url$565,start$566,end$567]);}throw err$570;};
var $766=function($767$769,key$770){var ph$774;(ph$774=$767$769);;var $772$779;($772$779=ph$774);;var bridge$773$784;(bridge$773$784=$772$779);if(((bridge$773$784===null)||(bridge$773$784===(void 0)))){return false;}else{var x$792;if((typeof($772$779)==="string")){(x$792=$772$779);return (key$770 in String.prototype);}else{var x$797;if((typeof($772$779)==="number")){(x$797=$772$779);return (key$770 in Number.prototype);}else{var x$802;(x$802=$772$779);return (key$770 in x$802);}}}};
var $804=function(obj$806){var results$810;(results$810=[]);;var k$815;(k$815=null);$809:for(k$815 in obj$806){if(Object.prototype.hasOwnProperty.call(obj$806,k$815)){results$810.push([k$815,$200(obj$806,k$815)]);}}return results$810;};var accum$554;var accum$558;var $245$252;var Source$253;var Location$254;var highlight_locations$255;var $246$256;var tokenize$257;var $247$258;var parse$259;var $248$260;var translate$261;var Translator$262;var std$263;var exp$264;var opt$265;var generate_from_ast$266;var generate$267;var Generator$268;($245$252=require("./location"));;(Source$253=$245$252.Source);;(Location$254=$245$252.Location);;(highlight_locations$255=$245$252.highlight_locations);;($246$256=require("./lex"));;(tokenize$257=$246$256.tokenize);;($247$258=require("./parse"));;(parse$259=$247$258.parse);;($248$260=require("./translate-js"));;(translate$261=$248$260.translate);;(Translator$262=$248$260.Translator);;(std$263=require("./stdenv"));;(exp$264=require("./expand"));;(opt$265=require("./opt"));;(generate_from_ast$266=function(ast$314){var ex$317;var tr$318;var rval$319;(ex$317=std$263.expand(["top"],std$263.topscope,std$263.stdenv.fork().convert(["multi",ast$314])));;(ex$317=opt$265.hoist(ex$317));(tr$318=Translator$262());;(rval$319=tr$318.translate(ex$317,"expr"));;return [tr$318.dump_store(),rval$319];});;std$263.stdenv.bind(std$263.topscope,"macro",["macro",function(context$332,scope$333,form$334,$330$335){var t0$374;var t1$375;var prep$369;var code$370;var mac$371;var mac2$372;var name$356;var sym$357;var arguments$358;var ast$359;var t0$348;var t1$349;var t2$350;var t3$351;var t4$352;var $337$343;var ph$338;(ph$338=$330$335);;($337$343=ph$338);;if((($337$343 instanceof Array)&&((t0$348=$337$343.length),((t0$348===3)&&(($337$343[0]==="data")&&((t1$349=$337$343[1]),((t1$349 instanceof Array)&&((t2$350=t1$349.length),((t2$350===3)&&((t1$349[0]==="send")&&((t3$351=t1$349[1]),((name$356=t3$351),((t3$351 instanceof Array)&&((t4$352=t3$351.length),((t4$352===2)&&(t3$351[0]==="symbol")))))))))))))))){(sym$357=t3$351[1]);(arguments$358=t1$349[2]);(ast$359=$337$343[2]);(t0$374=generate_from_ast$266(["send",["symbol","->"],["data",arguments$358,ast$359]]));if(((t0$374 instanceof Array)&&((t1$375=t0$374.length),(t1$375===2)))){(prep$369=t0$374[0]);(code$370=t0$374[1]);;}else{$562(generate_from_ast$266(["send",["symbol","->"],["data",arguments$358,ast$359]]),"/home/olivier/git/earl-grey/src/earl-grey.eg",798,848);}(mac$371=eval((prep$369+((";("+code$370)+")"))));;(mac2$372=function(c$386,s$387,f$388,e$389){var env$392;var r$393;(env$392=scope$333.expander.mkenv());;env$392.bind(scope$333,sym$357,["macro",mac2$372]);(r$393=mac$371(c$386,s$387,f$388,e$389));;return env$392.convert(r$393);});;return ["declare_raw",name$356,["macro",mac2$372]];}else{$562($337$343);}}]);std$263.stdenv.bind(std$263.topscope,"macros",["macro",function(context$406,scope$407,$403$408,$404$409){var t0$414;var t0$419;var t1$420;var t0$430;var t1$431;var $index$458;var $length$453;var temp$448;var acc$443;var prep$426;var code$427;var the_macros$428;var env$411;var body$412;(t0$414=$403$408);if($766(t0$414,"env")){(env$411=t0$414.env);;}else{$562($403$408);}(t0$419=$404$409);if(((t0$419 instanceof Array)&&((t1$420=t0$419.length),((t1$420===2)&&(t0$419[0]==="data"))))){(body$412=t0$419[1]);;}else{$562($404$409);}(t0$430=generate_from_ast$266(body$412));if(((t0$430 instanceof Array)&&((t1$431=t0$430.length),(t1$431===2)))){(prep$426=t0$430[0]);(code$427=t0$430[1]);;}else{$562(generate_from_ast$266(body$412),"/home/olivier/git/earl-grey/src/earl-grey.eg",1358,1388);}(the_macros$428=eval((((prep$426+";(")+code$427)+")")));;return ["splice"].concat((((acc$443=[])),(((temp$448=$804(the_macros$428))),((($length$453=temp$448.length)),((($index$458=0)),function(){$440:for(;($index$458<$length$453);($index$458++)){var k$476;var v$477;var t0$471;var t1$472;var m$466;(m$466=temp$448[$index$458]);;(t0$471=m$466);if(((t0$471 instanceof Array)&&((t1$472=t0$471.length),(t1$472===2)))){(k$476=t0$471[0]);(v$477=t0$471[1]);acc$443.push(["declare_raw",$201(["symbol",k$476],({"env":env$411})),["macro",v$477]]);}else{$562(m$466,"/home/olivier/git/earl-grey/src/earl-grey.eg",1458,1565);;}}}()))),acc$443));}]);(generate$267=function(source$486){return Generator$268().generate(source$486);});;(Generator$268=function(){var it$0$507;var interactive$503;var t0$499;var $492$494;($492$494=arguments);;(t0$499=$492$494.length);if(((t0$499>=0)&&(t0$499<=1))){(interactive$503=function(){if((0>=t0$499)){return false;}else{return $492$494[0];}}());(it$0$507=function(){if((!$185(Generator$268)(this))){return Object.create(Generator$268.prototype);}else{return this;}}());;(it$0$507["tr"]=Translator$262(std$263.stdprelude));(it$0$507["env"]=std$263.stdenv.fork());(it$0$507["interactive"]=interactive$503);return it$0$507;}else{$562($492$494);}});;(Generator$268.prototype["generate"]=function(source$519){var stmt$545;var t$532;var p$533;var ex$534;var rval$535;var self$527;var it$0$522;(it$0$522=this);;(self$527=this);;(t$532=tokenize$257(source$519));;(p$533=parse$259(t$532));;(ex$534=(((stmt$545=function(){if(it$0$522.interactive){return ["interactive",p$533];}else{return ["multi",p$533];}}())),std$263.expand(["top"],std$263.topscope,it$0$522.env.convert(stmt$545))));;(ex$534=opt$265.hoist(ex$534));(rval$535=it$0$522.tr.translate(ex$534,"stmt"));;return (it$0$522.tr.dump_store()+rval$535);});$201(Generator$268,$201(((accum$554=({})),((accum$554["::name"]="Generator"),accum$554)),((accum$558=({})),((accum$558["::egclass"]=true),accum$558))));Generator$268;(exports["Source"]=Source$253);(exports["Location"]=Location$254);(exports["highlight_locations"]=highlight_locations$255);(exports["tokenize"]=tokenize$257);(exports["parse"]=parse$259);(exports["Generator"]=Generator$268);(exports["generate"]=generate$267);

},{"./expand":5,"./lex":6,"./location":7,"./opt":8,"./parse":9,"./stdenv":12,"./translate-js":13}],5:[function(require,module,exports){
var $980=function(type$982){var f$985;(f$985=type$982["::check"]);;if((f$985===(void 0))){return function(value$990){return (value$990 instanceof type$982);};}else{return function(value$993){return f$985.call(type$982,value$993);};}};
var $995=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $996=function(dest$998,values$999){var k$1004;(k$1004=null);$1002:for(k$1004 in values$999){if(values$999.hasOwnProperty(k$1004)){(dest$998[k$1004]=values$999[k$1004]);}}return dest$998;};
var $1008=function($1009$1011){var ph$1015;(ph$1015=$1009$1011);;var $1013$1020;($1013$1020=ph$1015);;var bridge$1014$1025;var x$1029;(bridge$1014$1025=$1013$1020);if((((typeof(bridge$1014$1025)==="string")&&((x$1029=bridge$1014$1025),true))||((typeof(bridge$1014$1025)==="number")&&((x$1029=bridge$1014$1025),true)))){return ["value",x$1029];}else{var other$1036;(other$1036=$1013$1020);return other$1036["::serialize_ast"]();}};
var send$820;(send$820=function(obj$825,$823$826){var ph$830;var msg$831;var t0$833;(t0$833=$823$826);(msg$831=t0$833);(ph$830=t0$833);;var $828$837;($828$837=ph$830);;var bridge$829$842;(bridge$829$842=$828$837);if(((typeof(bridge$829$842)==="string")||(typeof(bridge$829$842)==="number"))){return obj$825[msg$831];}else{var other$850;(other$850=$828$837);return obj$825["::send"](msg$831);}});;(Array[":::project"]=function($853$855){var ph$858;var value$859;var t0$861;(t0$861=$853$855);(value$859=t0$861);(ph$858=t0$861);;var $857$865;($857$865=ph$858);;if($980(Array)($857$865)){return [true,value$859];}else{$857$865;return [true,[value$859]];}});(Array.prototype["::check"]=function(value$879){if((value$879 instanceof Array)){var i$884;(i$884=0);;$882:for(;(i$884<this.length);(i$884++)){if(($995(this,i$884)!==$995(value$879,i$884))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $996(this.slice(0),this);});(Array.prototype[":::project"]=function(value$895){if((value$895 instanceof Array)){var i$900;(i$900=0);;$898:for(;(i$900<this.length);(i$900++)){if(($995(this,i$900)!==$995(value$895,i$900))){return [true,[value$895]];}}return [true,value$895.slice(this.length)];}else{return [true,[value$895]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($1008));});(RegExp.prototype["::check"]=function($910$912){var ph$915;(ph$915=$910$912);;var $914$920;($914$920=ph$915);;var value$928;if((typeof($914$920)==="string")){(value$928=$914$920);if(value$928.match(this)){return true;}else{return false;}}else{var other$933;(other$933=$914$920);return false;}});(RegExp.prototype[":::project"]=function($935$937){var ph$940;(ph$940=$935$937);;var $939$945;($939$945=ph$940);;var value$953;if((typeof($939$945)==="string")){(value$953=$939$945);var $956$958;($956$958=value$953.match(this));;var m$966;if(($956$958===null)){(m$966=$956$958);return [false,null];}else{var m$971;(m$971=$956$958);return [true,m$971];}}else{var other$975;(other$975=$939$945);return [false,null];}});(Function.prototype["::send"]=function(args$978){return this.apply(this,args$978);});
var $3254=function(arr$3256){var results$3260;var l$3261;(results$3260=[]);;(l$3261=arr$3256.length);;var i$3269;(i$3269=0);;$3259:for(;(i$3269<l$3261);(i$3269++)){results$3260.push([i$3269,$995(arr$3256,i$3269)]);}return results$3260;};
var $3085=function(){var $3086$3088;($3086$3088=function(tags$3092){var it$0$3095;(it$0$3095=function(){if((!$980($3086$3088)(this))){return Object.create($3086$3088.prototype);}else{return this;}}());;(it$0$3095["tags"]=tags$3092);return it$0$3095;});;($3086$3088.prototype["create"]=function(){var $3104$3106;($3104$3106=arguments);;var t0$3111;var message$3115;var args$3116;(t0$3111=$3104$3106.length);if((t0$3111>=0)){(message$3115=function(){if((0>=t0$3111)){return "";}else{return $3104$3106[0];}}());(args$3116=Array.prototype.slice.call($3104$3106,1));var it$0$3120;(it$0$3120=this);;var self$3125;(self$3125=this);;var e$3130;(e$3130=Error(message$3115));;(e$3130["::tags"]=it$0$3120.tags);(e$3130["args"]=args$3116);var temp$3138;(temp$3138=$3254(args$3116));;var $length$3143;($length$3143=temp$3138.length);;var $index$3148;($index$3148=0);;$3131:for(;($index$3148<$length$3143);($index$3148++)){var m$3156;(m$3156=temp$3138[$index$3148]);;var t0$3161;var t1$3162;var i$3166;var arg$3167;(t0$3161=m$3156);if(((t0$3161 instanceof Array)&&((t1$3162=t0$3161.length),(t1$3162===2)))){(i$3166=t0$3161[0]);(arg$3167=t0$3161[1]);(e$3130[i$3166]=arg$3167);}else{$3072(m$3156);;}}(e$3130["length"]=args$3116.length);(e$3130["name"]=["E"].concat(it$0$3120.tags).join("."));return e$3130;}else{$3072($3104$3106);}});($3086$3088.prototype["::check"]=function(e$3178){var it$0$3181;(it$0$3181=this);;var self$3186;(self$3186=this);;var tags$3191;if(((!e$3178)||(!$980(Error)(e$3178)))){return false;}(tags$3191=(e$3178["::tags"]||[]));;var temp$3200;(temp$3200=it$0$3181.tags);;var $length$3205;($length$3205=temp$3200.length);;var $index$3210;($index$3210=0);;$3192:for(;($index$3210<$length$3205);($index$3210++)){var m$3218;(m$3218=temp$3200[$index$3210]);;var tag$3226;(tag$3226=m$3218);if((tags$3191.indexOf(tag$3226)===-1)){return false;}else{false;;}}return true;});($3086$3088.prototype["::deconstruct"]=function(e$3234){var it$0$3237;(it$0$3237=this);;var self$3242;(self$3242=this);;return e$3234.args;});$996($3086$3088,$996(function(){var accum$3247;(accum$3247=({}));(accum$3247["::name"]="$3086");return accum$3247;}(),function(){var accum$3251;(accum$3251=({}));(accum$3251["::egclass"]=true);return accum$3251;}()));return $3086$3088;}();
var $3072=function(value$3074,url$3075,start$3076,end$3077){var err$3080;(err$3080=$3085(["match"]).create("Could not find a match for value",({"value":value$3074})));;if(url$3075){(err$3080["location"]=["location",url$3075,start$3076,end$3077]);}throw err$3080;};
var $3276=function($3277$3279,key$3280){var ph$3284;(ph$3284=$3277$3279);;var $3282$3289;($3282$3289=ph$3284);;var bridge$3283$3294;(bridge$3283$3294=$3282$3289);if(((bridge$3283$3294===null)||(bridge$3283$3294===(void 0)))){return false;}else{var x$3302;if((typeof($3282$3289)==="string")){(x$3302=$3282$3289);return (key$3280 in String.prototype);}else{var x$3307;if((typeof($3282$3289)==="number")){(x$3307=$3282$3289);return (key$3280 in Number.prototype);}else{var x$3312;(x$3312=$3282$3289);return (key$3280 in x$3312);}}}};
var $3314=function(obj$3316){var results$3320;(results$3320=[]);;var k$3325;(k$3325=null);$3319:for(k$3325 in obj$3316){if(Object.prototype.hasOwnProperty.call(obj$3316,k$3325)){results$3320.push([k$3325,$995(obj$3316,k$3325)]);}}return results$3320;};
var $3329=function(type$3331){return function(value$3334){var f$3337;(f$3337=type$3331[":::project"]);;if((f$3337===(void 0))){(f$3337=type$3331["::project"]);if((f$3337===(void 0))){return [true,type$3331(value$3334)];}else{var rval$3343;(rval$3343=false);;try{(rval$3343=[true,f$3337(value$3334)]);}catch(excv$3349){var e$3355;(e$3355=excv$3349);(rval$3343=[false,null]);}return rval$3343;}}else{return f$3337.call(type$3331,value$3334);}};};var accum$1263;var accum$1267;var accum$1556;var accum$1560;var accum$2953;var accum$2957;var $1040$1044;var __lt____gt__$1045;var $1041$1046;var __lt____lt____colon__$1047;var util$1048;var classify$1049;var neighbours$1050;var GenSym$1051;var gensym$1052;var uuid$1053;var $1043$1054;var PatternParser$1055;var PatternProcessor$1056;var Scope$1057;var Env$1058;var track_location$1059;var Expander$1060;var mac1$1061;var __chk_ncache$1062;var __chk_scache$1063;var checker_db$1064;($1040$1044=require("./pp"));;(__lt____gt__$1045=$1040$1044["<>"]);;($1041$1046=require("./location"));;(__lt____lt____colon__$1047=$1041$1046["<<:"]);;(util$1048=require("./util"));;(classify$1049=util$1048.classify);;(neighbours$1050=util$1048.neighbours);;(GenSym$1051=util$1048.GenSym);;(gensym$1052=util$1048.gensym);;(uuid$1053=util$1048.uuid);;($1043$1054=require("./pattern"));;(PatternParser$1055=$1043$1054.PatternParser);;(PatternProcessor$1056=$1043$1054.PatternProcessor);;(Scope$1057=function(){var it$0$1124;var parent$1118;var name$1119;var expander$1120;var t0$1114;var $1107$1109;($1107$1109=arguments);;(t0$1114=$1107$1109.length);if(((t0$1114>=0)&&(t0$1114<=3))){(parent$1118=function(){if((0>=t0$1114)){return null;}else{return $1107$1109[0];}}());(name$1119=function(){if((1>=t0$1114)){return null;}else{return $1107$1109[1];}}());(expander$1120=function(){if((2>=t0$1114)){return null;}else{return $1107$1109[2];}}());(it$0$1124=function(){if((!$980(Scope$1057)(this))){return Object.create(Scope$1057.prototype);}else{return this;}}());;(it$0$1124["name"]=(name$1119||gensym$1052("scope")));(it$0$1124["parent"]=parent$1118);(it$0$1124["options"]=({}));(it$0$1124["expander"]=(expander$1120||parent$1118.expander));return it$0$1124;}else{$3072($1107$1109);}});;(Scope$1057.prototype["getopt"]=function(opt$1136){var otherwise$1168;var $1145$1157;var $1144$1151;var self$1146;var it$0$1139;(it$0$1139=this);;(self$1146=this);;($1144$1151=null);;$1144$1151;if(Object.prototype.hasOwnProperty.call(it$0$1139.options,opt$1136)){return $995(it$0$1139.options,opt$1136);}else{if((it$0$1139.parent===null)){return (void 0);}else{(otherwise$1168=$1144$1151);return it$0$1139.parent.getopt(opt$1136);}}});(Scope$1057.prototype["setopt"]=function(opt$1173,value$1174){var self$1182;var it$0$1177;(it$0$1177=this);;(self$1182=this);;return (it$0$1177.options[opt$1173]=value$1174);});(Scope$1057.prototype["gensym"]=function(){var self$1196;var it$0$1191;(it$0$1191=this);;(self$1196=this);;return it$0$1191.expander.gensym();});(Scope$1057.prototype["step"]=function(context$1203,expr$1204){var self$1212;var it$0$1207;(it$0$1207=this);;(self$1212=this);;return it$0$1207.expander.step(context$1203,it$0$1207,expr$1204);});(Scope$1057.prototype["step_all"]=function(context$1219,exprs$1220){var self$1228;var it$0$1223;(it$0$1223=this);;(self$1228=this);;return it$0$1223.expander.step_all(context$1219,it$0$1223,exprs$1220);});(Scope$1057.prototype["expand"]=function(context$1235,expr$1236){var self$1244;var it$0$1239;(it$0$1239=this);;(self$1244=this);;return it$0$1239.expander.expand(context$1235,it$0$1239,expr$1236);});(Scope$1057.prototype["toString"]=function(){var self$1258;var it$0$1253;(it$0$1253=this);;(self$1258=this);;return (("Scope{"+it$0$1253.name)+"}");});$996(Scope$1057,$996(((accum$1263=({})),((accum$1263["::name"]="Scope"),accum$1263)),((accum$1267=({})),((accum$1267["::egclass"]=true),accum$1267))));Scope$1057;(Env$1058=function(){var it$0$1275;(it$0$1275=function(){if((!$980(Env$1058)(this))){return Object.create(Env$1058.prototype);}else{return this;}}());;(it$0$1275["scopes"]=({}));return it$0$1275;});;(Env$1058.prototype["resolve"]=function(scope$1284,name$1285){var scope_data$1298;var self$1293;var it$0$1288;(it$0$1288=this);;(self$1293=this);;if((scope$1284===null)){return (void 0);}(scope_data$1298=$995(it$0$1288.scopes,scope$1284.name));;if((scope_data$1298&&Object.prototype.hasOwnProperty.call(scope_data$1298,name$1285))){return $995(scope_data$1298,name$1285);}else{return it$0$1288.resolve(scope$1284.parent,name$1285);}});(Env$1058.prototype["bind"]=function(scope$1306,name$1307,value$1308){var self$1316;var it$0$1311;(it$0$1311=this);;(self$1316=this);;if((!$995(it$0$1311.scopes,scope$1306.name))){(it$0$1311.scopes[scope$1306.name]=({}));}return ($995(it$0$1311.scopes,scope$1306.name)[name$1307]=value$1308);});(Env$1058.prototype["convert"]=function(expr$1325){var x$1369;var x$1374;var bridge$1337$1366;var x$1379;var bridge$1336$1363;var x$1384;var bridge$1335$1360;var x$1389;var $index$1416;var $length$1411;var temp$1406;var other$1436;var type$1396;var args$1397;var e$1353;var bridge$1334$1348;var t0$1349;var $1333$1343;var self$1338;var it$0$1328;(it$0$1328=this);;(self$1338=this);;($1333$1343=expr$1325);;if($3276($1333$1343,"env")){(e$1353=$1333$1343.env);return expr$1325;}else{(bridge$1334$1348=$1333$1343);if((((bridge$1335$1360=bridge$1334$1348),(((bridge$1336$1363=bridge$1335$1360),(((bridge$1337$1366=bridge$1336$1363),((((x$1369=bridge$1337$1366)),((x$1369 instanceof Array)&&(x$1369[0]==="symbol")))||(((x$1374=bridge$1337$1366)),((x$1374 instanceof Array)&&(x$1374[0]==="value")))))||(((x$1379=bridge$1336$1363)),((x$1379 instanceof Array)&&(x$1379[0]==="variable")))))||(((x$1384=bridge$1335$1360)),((x$1384 instanceof Array)&&(x$1384[0]==="macro")))))||(((x$1389=bridge$1334$1348)),((x$1389 instanceof Array)&&(x$1389[0]==="void"))))){return $996(expr$1325,({"env":it$0$1328}));}else{if((($1333$1343 instanceof Array)&&((t0$1349=$1333$1343.length),(t0$1349>=1)))){(type$1396=$1333$1343[0]);(args$1397=Array.prototype.slice.call($1333$1343,1));(temp$1406=args$1397);;($length$1411=temp$1406.length);;($index$1416=0);;$1402:for(;($index$1416<$length$1411);($index$1416++)){var arg$1432;var m$1424;(m$1424=temp$1406[$index$1416]);;(arg$1432=m$1424);it$0$1328.convert(arg$1432);}return $996(expr$1325,({"env":it$0$1328}));}else{(other$1436=$1333$1343);return $996(expr$1325,({"env":it$0$1328}));}}}});(Env$1058.prototype["fork"]=function(){var $index$1471;var $length$1466;var temp$1461;var e$1453;var self$1448;var it$0$1443;(it$0$1443=this);;(self$1448=this);;(e$1453=Env$1058());;(temp$1461=$3314(it$0$1443.scopes));;($length$1466=temp$1461.length);;($index$1471=0);;$1454:for(;($index$1471<$length$1466);($index$1471++)){var $index$1512;var $length$1507;var temp$1502;var acc$1497;var scope$1489;var bindings$1490;var t0$1484;var t1$1485;var m$1479;(m$1479=temp$1461[$index$1471]);;(t0$1484=m$1479);if(((t0$1484 instanceof Array)&&((t1$1485=t0$1484.length),(t1$1485===2)))){(scope$1489=t0$1484[0]);(bindings$1490=t0$1484[1]);(acc$1497=[]);;(temp$1502=$3314(bindings$1490));;($length$1507=temp$1502.length);;($index$1512=0);;$1494:for(;($index$1512<$length$1507);($index$1512++)){var k$1530;var v$1531;var t0$1525;var t1$1526;var m$1520;(m$1520=temp$1502[$index$1512]);;(t0$1525=m$1520);if(((t0$1525 instanceof Array)&&((t1$1526=t0$1525.length),(t1$1526===2)))){(k$1530=t0$1525[0]);(v$1531=t0$1525[1]);acc$1497.push((function(){if((!$995(e$1453.scopes,scope$1489))){return (e$1453.scopes[scope$1489]=({}));}}(),($995(e$1453.scopes,scope$1489)[k$1530]=v$1531)));}else{$3072(m$1520,"/home/olivier/git/earl-grey/src/expand.eg",2010,2169);;}}acc$1497;}else{$3072(m$1479,"/home/olivier/git/earl-grey/src/expand.eg",1970,2169);;}}return e$1453;});(Env$1058.prototype["toString"]=function(){var self$1551;var it$0$1546;(it$0$1546=this);;(self$1551=this);;return "Env{...}";});$996(Env$1058,$996(((accum$1556=({})),((accum$1556["::name"]="Env"),accum$1556)),((accum$1560=({})),((accum$1560["::egclass"]=true),accum$1560))));Env$1058;(track_location$1059=function(f$1566){var f2$1569;(f2$1569=function(context$1573,scope$1574,expr$1575){var rval$1583;var other$1615;var v$1609;var t0$1605;var $1578$1600;var rval$1579;(rval$1579=(((rval$1583=false)),(function(){try{(rval$1583=f$1566(context$1573,scope$1574,expr$1575));}catch(excv$1589){var e$1595;(e$1595=excv$1589);(rval$1583=(__lt____lt____colon__$1047(e$1595,expr$1575),function(){throw e$1595;}()));}}(),rval$1583)));;($1578$1600=rval$1579);;if((($1578$1600 instanceof Array)&&((t0$1605=$1578$1600.length),((t0$1605===2)&&($1578$1600[0]==="bounce"))))){(v$1609=$1578$1600[1]);return f2$1569(context$1573,scope$1574,__lt____lt____colon__$1047(v$1609,expr$1575));}else{(other$1615=$1578$1600);return __lt____lt____colon__$1047(other$1615,expr$1575);}});;return f2$1569;});;(Expander$1060=function(env_factory$1622,generic_nodes$1623){var it$0$1626;(it$0$1626=function(){if((!$980(Expander$1060)(this))){return Object.create(Expander$1060.prototype);}else{return this;}}());;(it$0$1626["gensym"]=gensym$1052);(it$0$1626["mkenv"]=env_factory$1622);(it$0$1626["generic_nodes"]=generic_nodes$1623);return it$0$1626;});;(Expander$1060.prototype["run_macro"]=function(m$1636,context$1637,scope$1638,form$1639,arg$1640){var rval$1657;var rval$1653;var self$1648;var it$0$1643;(it$0$1643=this);;(self$1648=this);;(rval$1653=(((rval$1657=false)),(function(){try{(rval$1657=m$1636(context$1637,scope$1638,form$1639,arg$1640));}catch(excv$1663){var msg$1696;var msg$1791;var find$1705;var err$1706;var other$1702;var $1683$1685;var e$1680;var e$1798;var value$1673;var t0$1666;var t1$1667;var t2$1668;var t3$1669;(t0$1666=excv$1663);if(($980($3085(["match"]))(t0$1666)&&($3276(t0$1666,"args")&&((t1$1667=t0$1666.args),((t1$1667 instanceof Array)&&((t2$1668=t1$1667.length),((t2$1668===1)&&((t3$1669=t1$1667[0]),$3276(t3$1669,"value"))))))))){(value$1673=t3$1669.value);(rval$1657=(((e$1680=((($1683$1685=value$1673)),function(){if(($1683$1685===context$1637)){(msg$1696="The macro cannot be found in this context.");;return $3085(["syntax","context"]).create(msg$1696,({"context":context$1637,"form":form$1639}));}else{(other$1702=$1683$1685);(find$1705=function($1709$1711){var t0$1717;var msg$1733;var $index$1759;var $length$1754;var temp$1749;var other$1784;var type$1739;var xs$1740;var t0$1726;var $1713$1721;var ph$1714;var arg$1715;(t0$1717=$1709$1711);(arg$1715=t0$1717);(ph$1714=t0$1717);;($1713$1721=ph$1714);;if(($1713$1721===value$1673)){(msg$1733="The macro could not match its argument (or part of it).");;return $3085(["syntax","argument"]).create(msg$1733,({"context":context$1637,"argument":arg$1715,"form":form$1639}));}else{if((($1713$1721 instanceof Array)&&((t0$1726=$1713$1721.length),(t0$1726>=1)))){(type$1739=$1713$1721[0]);(xs$1740=Array.prototype.slice.call($1713$1721,1));(temp$1749=xs$1740);;($length$1754=temp$1749.length);;($index$1759=0);;$1745:for(;($index$1759<$length$1754);($index$1759++)){var x$1776;var t0$1772;var m$1767;(m$1767=temp$1749[$index$1759]);;(t0$1772=$3329(find$1705)(m$1767));if(t0$1772[0]){(x$1776=t0$1772[1]);if(x$1776){return x$1776;}}else{$3072(m$1767,"/home/olivier/git/earl-grey/src/expand.eg",3447,3532);;}}return false;}else{(other$1784=$1713$1721);return false;}}});;(err$1706=find$1705(arg$1640));;if(err$1706){return err$1706;}else{(msg$1791="The macro failed because it failed to match some value, probably one that it generated itself.");;return $3085(["syntax","failure"]).create(msg$1791,({"form":form$1639,"value":value$1673}));}}}()))),function(){throw e$1680;}()));}else{(e$1798=excv$1663);(rval$1657=function(){throw e$1798;}());}}}(),rval$1657)));;return it$0$1643.mkenv().convert(rval$1653);});(Expander$1060.prototype["step"]=function(context$1804,scope$1805,expr$1806){var helper$1819;var self$1814;var it$0$1809;(it$0$1809=this);;(self$1814=this);;(helper$1819=track_location$1059(function(context$1824,scope$1825,$1822$1826){var t0$1835;var other$1875;var env$1870;var $1860$1862;var other$1908;var t0$1899;var $1892$1894;var other$1912;var m$1888;var t0$1884;var $1856$1879;var env$1857;var other$1935;var t0$1926;var $1919$1921;var other$1960;var m$1954;var t0$1950;var $1943$1945;var other$1969;var x$1964;var f$1939;var arg$1940;var m$1916;var s$1851;var $1829$1846;var $1830$1847;var $1831$1848;var t0$1844;var $1828$1839;var ph$1832;var expr$1833;(t0$1835=$1822$1826);(expr$1833=t0$1835);(ph$1832=t0$1835);;($1828$1839=ph$1832);;if((($1829$1846=($1828$1839 instanceof Array))&&((t0$1844=$1828$1839.length),(($1831$1848=(t0$1844===2))&&($1828$1839[0]==="symbol"))))){(s$1851=$1828$1839[1]);(env$1857=((($1860$1862=expr$1833)),function(){if($3276($1860$1862,"env")){(env$1870=$1860$1862.env);return expr$1833.env;}else{(other$1875=$1860$1862);throw $3085(["syntax","no_env"]).create("No environment was found to resolve",({"symbol":expr$1833}));}}()));;($1856$1879=env$1857.resolve(scope$1825,s$1851));;if((($1856$1879 instanceof Array)&&((t0$1884=$1856$1879.length),((t0$1884===2)&&($1856$1879[0]==="macro"))))){(m$1888=$1856$1879[1]);($1892$1894=context$1824);;if((($1892$1894 instanceof Array)&&((t0$1899=$1892$1894.length),((t0$1899===2)&&(($1892$1894[0]==="expr")&&($1892$1894[1]==="head")))))){return ["macro",m$1888];}else{(other$1908=$1892$1894);return ["bounce",it$0$1809.run_macro(m$1888,context$1824,scope$1825,expr$1833,__lt____lt____colon__$1047(["void"],expr$1833))];}}else{(other$1912=$1856$1879);return expr$1833;}}else{if(($1831$1848&&($1828$1839[0]==="macro"))){(m$1916=$1828$1839[1]);($1919$1921=context$1824);;if((($1919$1921 instanceof Array)&&((t0$1926=$1919$1921.length),((t0$1926===2)&&(($1919$1921[0]==="expr")&&($1919$1921[1]==="head")))))){return expr$1833;}else{(other$1935=$1919$1921);return ["bounce",it$0$1809.run_macro(m$1916,context$1824,scope$1825,expr$1833,__lt____lt____colon__$1047(["void"],expr$1833))];}}else{if(($1829$1846&&((t0$1844===3)&&($1828$1839[0]==="send")))){(f$1939=$1828$1839[1]);(arg$1940=$1828$1839[2]);($1943$1945=helper$1819(["expr","head"],scope$1825,f$1939));;if((($1943$1945 instanceof Array)&&((t0$1950=$1943$1945.length),((t0$1950===2)&&($1943$1945[0]==="macro"))))){(m$1954=$1943$1945[1]);return ["bounce",it$0$1809.run_macro(m$1954,context$1824,scope$1825,expr$1833,arg$1940)];}else{(other$1960=$1943$1945);return expr$1833;}}else{if(($1829$1846&&((t0$1844===2)&&($1828$1839[0]==="nostep")))){(x$1964=$1828$1839[1]);return x$1964;}else{(other$1969=$1828$1839);return expr$1833;}}}}}));;return helper$1819(context$1804,scope$1805,expr$1806);});(Expander$1060.prototype["step_all"]=function(context$1976,scope$1977,$1974$1978){var t0$1982;var t1$1983;var pre$1999;var bulk$2000;var post$2001;var self$1994;var it$0$1989;var stmts$1980;(t0$1982=$1974$1978);if(((t0$1982 instanceof Array)&&((t1$1983=t0$1982.length),(t1$1983>=0)))){(stmts$1980=Array.prototype.slice.call(t0$1982,0));;}else{$3072($1974$1978);}(it$0$1989=this);;(self$1994=this);;(pre$1999=[]);;(bulk$2000=[]);;(post$2001=[]);;$2011:while(stmts$1980.length){var x$2057;var m$2052;var stmt$2047;var stmt$2042;var prepend$2036;var $2016$2031;var $2017$2032;var $2018$2033;var t0$2029;var $2015$2024;var current$2019;(current$2019=stmts$1980.shift());;($2015$2024=it$0$1989.step(context$1976,scope$1977,current$2019));;if((($2016$2031=($2015$2024 instanceof Array))&&((t0$2029=$2015$2024.length),((t0$2029>=1)&&($2015$2024[0]==="splice"))))){(prepend$2036=Array.prototype.slice.call($2015$2024,1));(stmts$1980=prepend$2036.concat(stmts$1980));}else{if(($2016$2031&&(($2018$2033=(t0$2029===2))&&($2015$2024[0]==="float")))){(stmt$2042=$2015$2024[1]);(pre$1999=pre$1999.concat(it$0$1989.step_all(context$1976,scope$1977,[stmt$2042])));}else{if(($2018$2033&&($2015$2024[0]==="sink"))){(stmt$2047=$2015$2024[1]);(post$2001=post$2001.concat(it$0$1989.step_all(context$1976,scope$1977,[stmt$2047])));}else{if(($2018$2033&&($2015$2024[0]==="multimacro"))){(m$2052=$2015$2024[1]);(stmts$1980=m$2052(context$1976,scope$1977,current$2019,stmts$1980));}else{(x$2057=$2015$2024);bulk$2000.push(x$2057);}}}}}return pre$1999.concat(bulk$2000).concat(post$2001);});(Expander$1060.prototype["expand"]=function(context$2062,scope$2063,expr$2064){var helper$2077;var self$2072;var it$0$2067;(it$0$2067=this);;(self$2072=this);;(helper$2077=track_location$1059(function(context$2081,scope$2082,expr$2083){var t0$2114;var other$2131;var $2111$2119;var env$2112;var $index$2178;var $length$2173;var temp$2168;var acc$2163;var newargs$2157;var $index$2224;var $length$2219;var temp$2214;var acc$2209;var newargs$2203;var t0$2268;var newscope$2262;var env$2263;var $index$2330;var $length$2325;var temp$2320;var acc$2315;var $index$2440;var $length$2435;var temp$2430;var acc$2425;var t0$2304;var newscope$2288;var stepscope$2289;var changes$2290;var newargs$2291;var vars$2292;var exp$2293;var $index$2708;var $length$2703;var temp$2698;var other$2782;var t0$2765;var $2758$2760;var is_obj$2619;var obj$2620;var arr$2621;var arr_parts$2622;var obj_parts$2623;var new_arr_part$2624;var new_obj_part$2625;var r$2626;var $index$2825;var $length$2820;var temp$2815;var acc$2810;var newscope$2802;var s$2885;var newscope$2894;var name$2881;var t0$2877;var $index$2929;var $length$2924;var temp$2919;var acc$2914;var other$2949;var type$2905;var args$2906;var tag$2898;var body$2899;var x$2872;var $2087$2873;var bindings$2797;var body$2798;var target$2791;var value$2792;var args$2615;var args$2284;var args$2279;var args$2274;var variable$2252;var s$2253;var value$2254;var body$2255;var args$2199;var args$2153;var f$2147;var arg$2148;var s$2106;var $2088$2101;var $2089$2102;var $2090$2103;var t0$2097;var t1$2098;var t2$2099;var $2086$2092;(expr$2083=it$0$2067.step(context$2081,scope$2082,expr$2083));($2086$2092=expr$2083);;if((($2088$2101=($2086$2092 instanceof Array))&&((t0$2097=$2086$2092.length),(($2090$2103=(t0$2097===2))&&($2086$2092[0]==="symbol"))))){(s$2106=$2086$2092[1]);(t0$2114=expr$2083);if($3276(t0$2114,"env")){(env$2112=t0$2114.env);;}else{$3072(expr$2083,"/home/olivier/git/earl-grey/src/expand.eg",7765,7769);}($2111$2119=env$2112.resolve(scope$2082,s$2106));;if(($2111$2119===(void 0))){throw $3085(["syntax","undeclared"]).create(("Undeclared variable: "+s$2106),({"node":expr$2083}));}else{(other$2131=$2111$2119);return ["bounce",other$2131];}}else{if(($2090$2103&&($2086$2092[0]==="value"))){$2086$2092[1];return expr$2083;}else{if(($2090$2103&&($2086$2092[0]==="variable"))){$2086$2092[1];return expr$2083;}else{if(($2088$2101&&((t0$2097===1)&&($2086$2092[0]==="void")))){return expr$2083;}else{if(($2088$2101&&((t0$2097===3)&&($2086$2092[0]==="send")))){(f$2147=$2086$2092[1]);(arg$2148=$2086$2092[2]);return ["send",helper$2077(["expr","head"],scope$2082,f$2147),helper$2077(["expr","tail"],scope$2082,arg$2148)];}else{if(($2088$2101&&(($2090$2103=(t0$2097>=1))&&($2086$2092[0]==="array")))){(args$2153=Array.prototype.slice.call($2086$2092,1));(newargs$2157=(((acc$2163=[])),(((temp$2168=it$0$2067.step_all(["expr","array"],scope$2082,args$2153))),((($length$2173=temp$2168.length)),((($index$2178=0)),function(){$2160:for(;($index$2178<$length$2173);($index$2178++)){var arg$2194;var m$2186;(m$2186=temp$2168[$index$2178]);;(arg$2194=m$2186);acc$2163.push(helper$2077(["expr","expr"],scope$2082,arg$2194));}}()))),acc$2163));;return ["array"].concat(newargs$2157);}else{if(($2090$2103&&($2086$2092[0]==="object"))){(args$2199=Array.prototype.slice.call($2086$2092,1));(newargs$2203=(((acc$2209=[])),(((temp$2214=it$0$2067.step_all(["expr","object"],scope$2082,args$2199))),((($length$2219=temp$2214.length)),((($index$2224=0)),function(){$2206:for(;($index$2224<$length$2219);($index$2224++)){var k$2242;var v$2243;var t0$2237;var t1$2238;var m$2232;(m$2232=temp$2214[$index$2224]);;(t0$2237=m$2232);if(((t0$2237 instanceof Array)&&((t1$2238=t0$2237.length),((t1$2238===3)&&(t0$2237[0]==="array"))))){(k$2242=t0$2237[1]);(v$2243=t0$2237[2]);acc$2209.push(["array",helper$2077(["expr","expr"],scope$2082,k$2242),helper$2077(["expr","expr"],scope$2082,v$2243)]);}else{$3072(m$2232,"/home/olivier/git/earl-grey/src/expand.eg",8608,8797);;}}}()))),acc$2209));;return ["object"].concat(newargs$2203);}else{if(($2088$2101&&((t0$2097===4)&&(($2086$2092[0]==="bind")&&((t1$2098=$2086$2092[1]),((variable$2252=t1$2098),((t1$2098 instanceof Array)&&((t2$2099=t1$2098.length),((t2$2099===2)&&(t1$2098[0]==="symbol")))))))))){(s$2253=t1$2098[1]);(value$2254=$2086$2092[2]);(body$2255=$2086$2092[3]);(newscope$2262=Scope$1057(scope$2082));;(t0$2268=variable$2252);if($3276(t0$2268,"env")){(env$2263=t0$2268.env);;}else{$3072(variable$2252,"/home/olivier/git/earl-grey/src/expand.eg",8940,8948);}env$2263.bind(newscope$2262,s$2253,value$2254);return helper$2077(context$2081,newscope$2262,body$2255);}else{if(($2088$2101&&(($2090$2103=(t0$2097>=1))&&($2086$2092[0]==="splice")))){(args$2274=Array.prototype.slice.call($2086$2092,1));return ["bounce",$996(["multi"].concat(args$2274),({"override_scope":true}))];}else{if(($2090$2103&&($2086$2092[0]==="interactive"))){(args$2279=Array.prototype.slice.call($2086$2092,1));return ["bounce",$996(["multi"].concat(args$2279),({"override_scope":true,"all_mutable":true}))];}else{if(($2090$2103&&($2086$2092[0]==="multi"))){(args$2284=Array.prototype.slice.call($2086$2092,1));(newscope$2288=function(){if(expr$2083.override_scope){return scope$2082;}else{return Scope$1057(scope$2082);}}());;(stepscope$2289=function(){if(expr$2083.nonrecursive){return scope$2082;}else{return newscope$2288;}}());;(changes$2290=false);;(t0$2304=classify$1049("newargs","vars",(((acc$2315=[])),(((temp$2320=it$0$2067.step_all(["expr","multi"],stepscope$2289,args$2284))),((($length$2325=temp$2320.length)),((($index$2330=0)),function(){$2306:for(;($index$2330<$length$2325);($index$2330++)){var t0$2375;var env$2373;var t0$2393;var env$2390;var v$2391;var other$2411;var v$2402;var value$2403;var variable$2381;var s$2382;var value$2383;var variable$2364;var s$2365;var value$2366;var opt$2356;var value$2357;var $2308$2348;var $2309$2349;var $2310$2350;var $2311$2351;var $2312$2352;var $2313$2353;var t0$2343;var t1$2344;var t2$2345;var t3$2346;var m$2338;(m$2338=temp$2320[$index$2330]);;(t0$2343=m$2338);if((($2309$2349=(t0$2343 instanceof Array))&&((t1$2344=t0$2343.length),(($2311$2351=(t1$2344===3))&&(t0$2343[0]==="option"))))){(opt$2356=t0$2343[1]);(value$2357=t0$2343[2]);acc$2315.push((newscope$2288.setopt(opt$2356,value$2357),["ignore"]));}else{if(($2311$2351&&((t0$2343[0]==="declare_raw")&&((t2$2345=t0$2343[1]),((variable$2364=t2$2345),((t2$2345 instanceof Array)&&((t3$2346=t2$2345.length),((t3$2346===2)&&(t2$2345[0]==="symbol"))))))))){(s$2365=t2$2345[1]);(value$2366=t0$2343[2]);acc$2315.push((((t0$2375=variable$2364),function(){if($3276(t0$2375,"env")){(env$2373=t0$2375.env);}else{return $3072(variable$2364,"/home/olivier/git/earl-grey/src/expand.eg",9890,9898);}}()),env$2373.bind(newscope$2288,s$2365,value$2366),(changes$2290=true),["ignore"]));}else{if(($2309$2349&&(($2311$2351=((t1$2344>=2)&&(t1$2344<=3)))&&(($2312$2352=(t0$2343[0]==="declare"))&&((t2$2345=t0$2343[1]),((variable$2381=t2$2345),((t2$2345 instanceof Array)&&((t3$2346=t2$2345.length),((t3$2346===2)&&(t2$2345[0]==="symbol")))))))))){(s$2382=t2$2345[1]);(value$2383=function(){if((2>=t1$2344)){return null;}else{return t0$2343[2];}}());acc$2315.push((((t0$2393=variable$2381),function(){if($3276(t0$2393,"env")){(env$2390=t0$2393.env);}else{return $3072(variable$2381,"/home/olivier/git/earl-grey/src/expand.eg",10135,10143);}}()),((v$2391=__lt____lt____colon__$1047(["variable",it$0$2067.gensym(s$2382)],variable$2381))),$996(v$2391,({"mutable":(expr$2083.all_mutable||variable$2381.mutable)})),env$2390.bind(newscope$2288,s$2382,v$2391),(changes$2290=true),function(){if(value$2383){return ["splice",["newargs",["assign",v$2391,value$2383]],["vars",v$2391]];}else{return ["vars",v$2391];}}()));}else{if(($2312$2352&&((v$2402=t2$2345),((t2$2345 instanceof Array)&&((t3$2346=t2$2345.length),((t3$2346===2)&&(t2$2345[0]==="variable"))))))){t2$2345[1];(value$2403=function(){if((2>=t1$2344)){return null;}else{return t0$2343[2];}}());acc$2315.push(((changes$2290=true),function(){if(value$2403){return ["splice",["newargs",["assign",v$2402,value$2403]],["vars",v$2402]];}else{return ["vars",v$2402];}}()));}else{(other$2411=m$2338);acc$2315.push(["newargs",other$2411]);}}}}}}()))),acc$2315)));if(($3276(t0$2304,"newargs")&&((newargs$2291=t0$2304.newargs),$3276(t0$2304,"vars")))){(vars$2292=t0$2304.vars);;}else{$3072(classify$1049("newargs","vars",(((acc$2425=[])),(((temp$2430=it$0$2067.step_all(["expr","multi"],stepscope$2289,args$2284))),((($length$2435=temp$2430.length)),((($index$2440=0)),function(){$2416:for(;($index$2440<$length$2435);($index$2440++)){var t0$2485;var env$2483;var t0$2503;var env$2500;var v$2501;var other$2521;var v$2512;var value$2513;var variable$2491;var s$2492;var value$2493;var variable$2474;var s$2475;var value$2476;var opt$2466;var value$2467;var $2418$2458;var $2419$2459;var $2420$2460;var $2421$2461;var $2422$2462;var $2423$2463;var t0$2453;var t1$2454;var t2$2455;var t3$2456;var m$2448;(m$2448=temp$2430[$index$2440]);;(t0$2453=m$2448);if((($2419$2459=(t0$2453 instanceof Array))&&((t1$2454=t0$2453.length),(($2421$2461=(t1$2454===3))&&(t0$2453[0]==="option"))))){(opt$2466=t0$2453[1]);(value$2467=t0$2453[2]);acc$2425.push((newscope$2288.setopt(opt$2466,value$2467),["ignore"]));}else{if(($2421$2461&&((t0$2453[0]==="declare_raw")&&((t2$2455=t0$2453[1]),((variable$2474=t2$2455),((t2$2455 instanceof Array)&&((t3$2456=t2$2455.length),((t3$2456===2)&&(t2$2455[0]==="symbol"))))))))){(s$2475=t2$2455[1]);(value$2476=t0$2453[2]);acc$2425.push((((t0$2485=variable$2474),function(){if($3276(t0$2485,"env")){(env$2483=t0$2485.env);}else{return $3072(variable$2474,"/home/olivier/git/earl-grey/src/expand.eg",9890,9898);}}()),env$2483.bind(newscope$2288,s$2475,value$2476),(changes$2290=true),["ignore"]));}else{if(($2419$2459&&(($2421$2461=((t1$2454>=2)&&(t1$2454<=3)))&&(($2422$2462=(t0$2453[0]==="declare"))&&((t2$2455=t0$2453[1]),((variable$2491=t2$2455),((t2$2455 instanceof Array)&&((t3$2456=t2$2455.length),((t3$2456===2)&&(t2$2455[0]==="symbol")))))))))){(s$2492=t2$2455[1]);(value$2493=function(){if((2>=t1$2454)){return null;}else{return t0$2453[2];}}());acc$2425.push((((t0$2503=variable$2491),function(){if($3276(t0$2503,"env")){(env$2500=t0$2503.env);}else{return $3072(variable$2491,"/home/olivier/git/earl-grey/src/expand.eg",10135,10143);}}()),((v$2501=__lt____lt____colon__$1047(["variable",it$0$2067.gensym(s$2492)],variable$2491))),$996(v$2501,({"mutable":(expr$2083.all_mutable||variable$2491.mutable)})),env$2500.bind(newscope$2288,s$2492,v$2501),(changes$2290=true),function(){if(value$2493){return ["splice",["newargs",["assign",v$2501,value$2493]],["vars",v$2501]];}else{return ["vars",v$2501];}}()));}else{if(($2422$2462&&((v$2512=t2$2455),((t2$2455 instanceof Array)&&((t3$2456=t2$2455.length),((t3$2456===2)&&(t2$2455[0]==="variable"))))))){t2$2455[1];(value$2513=function(){if((2>=t1$2454)){return null;}else{return t0$2453[2];}}());acc$2425.push(((changes$2290=true),function(){if(value$2513){return ["splice",["newargs",["assign",v$2512,value$2513]],["vars",v$2512]];}else{return ["vars",v$2512];}}()));}else{(other$2521=m$2448);acc$2425.push(["newargs",other$2521]);}}}}}}()))),acc$2425)),"/home/olivier/git/earl-grey/src/expand.eg",9562,11161);}(exp$2293=function(s$2526){var $index$2552;var $length$2547;var temp$2542;var acc$2537;var $index$2594;var $length$2589;var temp$2584;var acc$2579;var stepped$2529;(stepped$2529=(((acc$2537=[])),(((temp$2542=$3254(newargs$2291))),((($length$2547=temp$2542.length)),((($index$2552=0)),function(){$2534:for(;($index$2552<$length$2547);($index$2552++)){var i$2570;var arg$2571;var t0$2565;var t1$2566;var m$2560;(m$2560=temp$2542[$index$2552]);;(t0$2565=m$2560);if(((t0$2565 instanceof Array)&&((t1$2566=t0$2565.length),(t1$2566===2)))){(i$2570=t0$2565[0]);(arg$2571=t0$2565[1]);acc$2537.push(it$0$2067.step(["expr",function(){if((i$2570===(newargs$2291.length-1))){return "expr";}else{return "ignore";}}()],s$2526,arg$2571));}else{$3072(m$2560,"/home/olivier/git/earl-grey/src/expand.eg",11383,11560);;}}}()))),acc$2537));;(acc$2579=[]);;(temp$2584=stepped$2529);;($length$2589=temp$2584.length);;($index$2594=0);;$2530:for(;($index$2594<$length$2589);($index$2594++)){var arg$2610;var m$2602;(m$2602=temp$2584[$index$2594]);;(arg$2610=m$2602);acc$2579.push(helper$2077(["expr","expr"],s$2526,arg$2610));}return acc$2579;});;if(changes$2290){return ["scope",vars$2292,["multi"].concat(exp$2293(newscope$2288))];}else{return ["multi"].concat(exp$2293(scope$2082));}}else{if(($2090$2103&&($2086$2092[0]==="data"))){(args$2615=Array.prototype.slice.call($2086$2092,1));(is_obj$2619=false);;(obj$2620=["object"]);;(arr$2621=["array"]);;(arr_parts$2622=[]);;(obj_parts$2623=[]);;(new_arr_part$2624=function(){var other$2668;var t0$2659;var $2652$2654;($2652$2654=arr$2621);;if((($2652$2654 instanceof Array)&&((t0$2659=$2652$2654.length),((t0$2659===1)&&($2652$2654[0]==="array"))))){return false;}else{(other$2668=$2652$2654);arr_parts$2622.push(arr$2621);return (arr$2621=["array"]);}});;(new_obj_part$2625=function(){var other$2692;var t0$2683;var $2676$2678;($2676$2678=obj$2620);;if((($2676$2678 instanceof Array)&&((t0$2683=$2676$2678.length),((t0$2683===1)&&($2676$2678[0]==="object"))))){return false;}else{(other$2692=$2676$2678);obj_parts$2623.push(obj$2620);return (obj$2620=["object"]);}});;(temp$2698=it$0$2067.step_all(["expr","data"],scope$2082,args$2615));;($length$2703=temp$2698.length);;($index$2708=0);;$2627:for(;($index$2708<$length$2703);($index$2708++)){var other$2754;var expr$2748;var expr$2742;var k$2735;var v$2736;var $2629$2724;var $2630$2725;var $2631$2726;var $2632$2727;var t0$2721;var t1$2722;var m$2716;(m$2716=temp$2698[$index$2708]);;(t0$2721=m$2716);if((($2630$2725=(t0$2721 instanceof Array))&&((t1$2722=t0$2721.length),((t1$2722===1)&&(t0$2721[0]==="assoc"))))){(is_obj$2619=true);}else{if(($2630$2725&&((t1$2722===3)&&(t0$2721[0]==="assoc")))){(k$2735=t0$2721[1]);(v$2736=t0$2721[2]);(is_obj$2619=true);obj$2620.push(["array",k$2735,v$2736]);}else{if(($2630$2725&&(($2632$2727=(t1$2722===2))&&(t0$2721[0]==="dynsplice")))){(expr$2742=t0$2721[1]);new_arr_part$2624();arr_parts$2622.push(expr$2742);}else{if(($2632$2727&&(t0$2721[0]==="objsplice"))){(expr$2748=t0$2721[1]);(is_obj$2619=true);new_obj_part$2625();obj_parts$2623.push(expr$2748);}else{(other$2754=m$2716);arr$2621.push(other$2754);}}}}}new_arr_part$2624();new_obj_part$2625();(r$2626=((($2758$2760=arr_parts$2622)),function(){if((($2758$2760 instanceof Array)&&((t0$2765=$2758$2760.length),((t0$2765===0)&&is_obj$2619)))){return util$1048.construct(obj_parts$2623,function(x$2773,rest$2774){return ["send",["symbol","&:"],["data",x$2773,rest$2774]];},["object"]);}else{$2758$2760;if(is_obj$2619){throw $3085(["syntax","array","object"]).create("Cannot mix array and object notations.");}else{(other$2782=$2758$2760);return util$1048.construct(arr_parts$2622.reverse(),function(x$2785,rest$2786){return ["send",["send",rest$2786,["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",x$2785]];},["array"]);}}}()));;return helper$2077(context$2081,scope$2082,it$0$2067.mkenv().convert(r$2626));}else{if(($2088$2101&&(($2090$2103=(t0$2097===3))&&($2086$2092[0]==="assign")))){(target$2791=$2086$2092[1]);(value$2792=$2086$2092[2]);return ["assign",helper$2077(["expr","expr"],scope$2082,target$2791),helper$2077(["expr","expr"],scope$2082,value$2792)];}else{if(($2090$2103&&($2086$2092[0]==="lambda"))){(bindings$2797=$2086$2092[1]);(body$2798=$2086$2092[2]);(newscope$2802=Scope$1057(scope$2082));;return ["lambda",(((acc$2810=[])),(((temp$2815=bindings$2797)),((($length$2820=temp$2815.length)),((($index$2825=0)),function(){$2806:for(;($index$2825<$length$2820);($index$2825++)){var v$2851;var x$2861;var other$2868;var v$2858;var b$2844;var env$2845;var $2808$2841;var t0$2838;var t1$2839;var m$2833;(m$2833=temp$2815[$index$2825]);;(t0$2838=m$2833);if(((t0$2838 instanceof Array)&&((t1$2839=t0$2838.length),((t1$2839===2)&&((t0$2838[0]==="symbol")&&((b$2844=t0$2838[1]),$3276(t0$2838,"env"))))))){(env$2845=t0$2838.env);acc$2810.push((((v$2851=["variable",it$0$2067.gensym(b$2844)])),(env$2845.bind(newscope$2802,b$2844,v$2851),v$2851)));}else{if((((x$2861=t0$2838)),((x$2861 instanceof Array)&&(x$2861[0]==="variable")))){(v$2858=t0$2838);acc$2810.push(v$2858);}else{(other$2868=m$2833);acc$2810.push(function(){throw $3085(["syntax","lambda","binding"]).create("Not a valid binding.",({"node":other$2868}));}());}}}}()))),acc$2810),helper$2077(["expr","expr"],newscope$2802,body$2798)];}else{if(($2090$2103&&($2086$2092[0]==="use"))){($2087$2873=$2086$2092[1]);(x$2872=$2086$2092[2]);(t0$2877=$2087$2873);if((typeof(t0$2877)==="string")){(name$2881=t0$2877);(s$2885=scope$2082);;$2889:while(s$2885){if((s$2885.name.slice(0,(name$2881.length+1))===(name$2881+"/"))){break $2889;}else{(s$2885=s$2885.parent);}}if(s$2885){return helper$2077(context$2081,s$2885,x$2872);}else{throw $3085(["syntax","noscope"]).create(("Could not find a scope tagged: "+name$2881));}}else{(newscope$2894=$2087$2873);return helper$2077(context$2081,newscope$2894,x$2872);}}else{if(($2090$2103&&(($2086$2092[0]==="tagscope")&&((t1$2098=$2086$2092[1]),(typeof(t1$2098)==="string"))))){(tag$2898=t1$2098);(body$2899=$2086$2092[2]);return helper$2077(context$2081,Scope$1057(scope$2082,it$0$2067.gensym((tag$2898+"/"))),body$2899);}else{if(($2088$2101&&((t0$2097>=1)&&((type$2905=$2086$2092[0]),((args$2906=Array.prototype.slice.call($2086$2092,1)),(it$0$2067.generic_nodes.indexOf(type$2905)!==-1)))))){return [type$2905].concat((((acc$2914=[])),(((temp$2919=args$2906)),((($length$2924=temp$2919.length)),((($index$2929=0)),function(){$2911:for(;($index$2929<$length$2924);($index$2929++)){var arg$2945;var m$2937;(m$2937=temp$2919[$index$2929]);;(arg$2945=m$2937);acc$2914.push(helper$2077(["expr","expr"],scope$2082,arg$2945));}}()))),acc$2914));}else{(other$2949=$2086$2092);throw $3085(["syntax","illegal_node"]).create("An illegal node was found.",({"node":other$2949,"context":context$2081}));}}}}}}}}}}}}}}}}}}));;return helper$2077(context$2062,scope$2063,expr$2064);});$996(Expander$1060,$996(((accum$2953=({})),((accum$2953["::name"]="Expander"),accum$2953)),((accum$2957=({})),((accum$2957["::egclass"]=true),accum$2957))));Expander$1060;(mac1$1061=function(f$2963){return ["macro",function(context$2967,scope$2968,form$2969,$2965$2970){var t0$2974;var t1$2975;var expr$2972;(t0$2974=$2965$2970);if(((t0$2974 instanceof Array)&&((t1$2975=t0$2974.length),((t1$2975===2)&&(t0$2974[0]==="data"))))){(expr$2972=t0$2974[1]);;}else{$3072($2965$2970);}return f$2963(expr$2972);}];});;(__chk_ncache$1062=({}));;(__chk_scache$1063=({}));;(checker_db$1064=function($2989$2991){var v$3027;var v$3040;var s$3036;var n$3023;var $2993$2999;var ph$2994;(ph$2994=$2989$2991);;($2993$2999=ph$2994);;if(($2993$2999===null)){return checker_db$1064.null;}else{if(($2993$2999===(void 0))){return checker_db$1064.undefined;}else{if(($2993$2999===true)){return checker_db$1064.true;}else{if(($2993$2999===false)){return checker_db$1064.false;}else{if((typeof($2993$2999)==="number")){(n$3023=$2993$2999);if($995(__chk_ncache$1062,n$3023)){return $995(__chk_ncache$1062,n$3023);}else{(v$3027=mac1$1061(function(x$3031){return ["send",["symbol","==="],["data",x$3031,["value",n$3023]]];}));;(__chk_ncache$1062[n$3023]=v$3027);return v$3027;}}else{if((typeof($2993$2999)==="string")){(s$3036=$2993$2999);if(Object.prototype.hasOwnProperty.call(__chk_scache$1063,s$3036)){return $995(__chk_scache$1063,s$3036);}else{(v$3040=mac1$1061(function(x$3044){return ["send",["symbol","==="],["data",x$3044,["value",s$3036]]];}));;(__chk_scache$1063[s$3036]=v$3040);return v$3040;}}else{$3072($2993$2999);}}}}}}});;$996(checker_db$1064,({"String":mac1$1061(function(x$3051){return ["send",["symbol","==="],["data",["send",["symbol","typeof"],["data",x$3051]],["value","string"]]];}),"Number":mac1$1061(function(x$3054){return ["send",["symbol","==="],["data",["send",["symbol","typeof"],["data",x$3054]],["value","number"]]];}),"Array":mac1$1061(function(x$3057){return ["send",["symbol","instanceof"],["data",x$3057,["symbol","Array"]]];}),"true":mac1$1061(function(x$3060){return x$3060;}),"false":mac1$1061(function(x$3063){return ["send",["symbol","not"],["data",["void"],x$3063]];}),"null":mac1$1061(function(x$3066){return ["send",["symbol","==="],["data",x$3066,["value",null]]];}),"undefined":mac1$1061(function(x$3069){return ["send",["symbol","==="],["data",x$3069,["value",(void 0)]]];})}));(exports["Env"]=Env$1058);(exports["Scope"]=Scope$1057);(exports["track_location"]=track_location$1059);(exports["Expander"]=Expander$1060);(exports["GenSym"]=GenSym$1051);(exports["gensym"]=gensym$1052);(exports["mac1"]=mac1$1061);(exports["checker_db"]=checker_db$1064);

},{"./location":7,"./pattern":10,"./pp":11,"./util":14}],6:[function(require,module,exports){
var $3518=function(type$3520){var f$3523;(f$3523=type$3520["::check"]);;if((f$3523===(void 0))){return function(value$3528){return (value$3528 instanceof type$3520);};}else{return function(value$3531){return f$3523.call(type$3520,value$3531);};}};
var $3533=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $3534=function(dest$3536,values$3537){var k$3542;(k$3542=null);$3540:for(k$3542 in values$3537){if(values$3537.hasOwnProperty(k$3542)){(dest$3536[k$3542]=values$3537[k$3542]);}}return dest$3536;};
var $3546=function($3547$3549){var ph$3553;(ph$3553=$3547$3549);;var $3551$3558;($3551$3558=ph$3553);;var bridge$3552$3563;var x$3567;(bridge$3552$3563=$3551$3558);if((((typeof(bridge$3552$3563)==="string")&&((x$3567=bridge$3552$3563),true))||((typeof(bridge$3552$3563)==="number")&&((x$3567=bridge$3552$3563),true)))){return ["value",x$3567];}else{var other$3574;(other$3574=$3551$3558);return other$3574["::serialize_ast"]();}};
var send$3358;(send$3358=function(obj$3363,$3361$3364){var ph$3368;var msg$3369;var t0$3371;(t0$3371=$3361$3364);(msg$3369=t0$3371);(ph$3368=t0$3371);;var $3366$3375;($3366$3375=ph$3368);;var bridge$3367$3380;(bridge$3367$3380=$3366$3375);if(((typeof(bridge$3367$3380)==="string")||(typeof(bridge$3367$3380)==="number"))){return obj$3363[msg$3369];}else{var other$3388;(other$3388=$3366$3375);return obj$3363["::send"](msg$3369);}});;(Array[":::project"]=function($3391$3393){var ph$3396;var value$3397;var t0$3399;(t0$3399=$3391$3393);(value$3397=t0$3399);(ph$3396=t0$3399);;var $3395$3403;($3395$3403=ph$3396);;if($3518(Array)($3395$3403)){return [true,value$3397];}else{$3395$3403;return [true,[value$3397]];}});(Array.prototype["::check"]=function(value$3417){if((value$3417 instanceof Array)){var i$3422;(i$3422=0);;$3420:for(;(i$3422<this.length);(i$3422++)){if(($3533(this,i$3422)!==$3533(value$3417,i$3422))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $3534(this.slice(0),this);});(Array.prototype[":::project"]=function(value$3433){if((value$3433 instanceof Array)){var i$3438;(i$3438=0);;$3436:for(;(i$3438<this.length);(i$3438++)){if(($3533(this,i$3438)!==$3533(value$3433,i$3438))){return [true,[value$3433]];}}return [true,value$3433.slice(this.length)];}else{return [true,[value$3433]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($3546));});(RegExp.prototype["::check"]=function($3448$3450){var ph$3453;(ph$3453=$3448$3450);;var $3452$3458;($3452$3458=ph$3453);;var value$3466;if((typeof($3452$3458)==="string")){(value$3466=$3452$3458);if(value$3466.match(this)){return true;}else{return false;}}else{var other$3471;(other$3471=$3452$3458);return false;}});(RegExp.prototype[":::project"]=function($3473$3475){var ph$3478;(ph$3478=$3473$3475);;var $3477$3483;($3477$3483=ph$3478);;var value$3491;if((typeof($3477$3483)==="string")){(value$3491=$3477$3483);var $3494$3496;($3494$3496=value$3491.match(this));;var m$3504;if(($3494$3496===null)){(m$3504=$3494$3496);return [false,null];}else{var m$3509;(m$3509=$3494$3496);return [true,m$3509];}}else{var other$3513;(other$3513=$3477$3483);return [false,null];}});(Function.prototype["::send"]=function(args$3516){return this.apply(this,args$3516);});
var $4891=function(arr$4893){var results$4897;var l$4898;(results$4897=[]);;(l$4898=arr$4893.length);;var i$4906;(i$4906=0);;$4896:for(;(i$4906<l$4898);(i$4906++)){results$4897.push([i$4906,$3533(arr$4893,i$4906)]);}return results$4897;};
var $4722=function(){var $4723$4725;($4723$4725=function(tags$4729){var it$0$4732;(it$0$4732=function(){if((!$3518($4723$4725)(this))){return Object.create($4723$4725.prototype);}else{return this;}}());;(it$0$4732["tags"]=tags$4729);return it$0$4732;});;($4723$4725.prototype["create"]=function(){var $4741$4743;($4741$4743=arguments);;var t0$4748;var message$4752;var args$4753;(t0$4748=$4741$4743.length);if((t0$4748>=0)){(message$4752=function(){if((0>=t0$4748)){return "";}else{return $4741$4743[0];}}());(args$4753=Array.prototype.slice.call($4741$4743,1));var it$0$4757;(it$0$4757=this);;var self$4762;(self$4762=this);;var e$4767;(e$4767=Error(message$4752));;(e$4767["::tags"]=it$0$4757.tags);(e$4767["args"]=args$4753);var temp$4775;(temp$4775=$4891(args$4753));;var $length$4780;($length$4780=temp$4775.length);;var $index$4785;($index$4785=0);;$4768:for(;($index$4785<$length$4780);($index$4785++)){var m$4793;(m$4793=temp$4775[$index$4785]);;var t0$4798;var t1$4799;var i$4803;var arg$4804;(t0$4798=m$4793);if(((t0$4798 instanceof Array)&&((t1$4799=t0$4798.length),(t1$4799===2)))){(i$4803=t0$4798[0]);(arg$4804=t0$4798[1]);(e$4767[i$4803]=arg$4804);}else{$4709(m$4793);;}}(e$4767["length"]=args$4753.length);(e$4767["name"]=["E"].concat(it$0$4757.tags).join("."));return e$4767;}else{$4709($4741$4743);}});($4723$4725.prototype["::check"]=function(e$4815){var it$0$4818;(it$0$4818=this);;var self$4823;(self$4823=this);;var tags$4828;if(((!e$4815)||(!$3518(Error)(e$4815)))){return false;}(tags$4828=(e$4815["::tags"]||[]));;var temp$4837;(temp$4837=it$0$4818.tags);;var $length$4842;($length$4842=temp$4837.length);;var $index$4847;($index$4847=0);;$4829:for(;($index$4847<$length$4842);($index$4847++)){var m$4855;(m$4855=temp$4837[$index$4847]);;var tag$4863;(tag$4863=m$4855);if((tags$4828.indexOf(tag$4863)===-1)){return false;}else{false;;}}return true;});($4723$4725.prototype["::deconstruct"]=function(e$4871){var it$0$4874;(it$0$4874=this);;var self$4879;(self$4879=this);;return e$4871.args;});$3534($4723$4725,$3534(function(){var accum$4884;(accum$4884=({}));(accum$4884["::name"]="$4723");return accum$4884;}(),function(){var accum$4888;(accum$4888=({}));(accum$4888["::egclass"]=true);return accum$4888;}()));return $4723$4725;}();
var $4709=function(value$4711,url$4712,start$4713,end$4714){var err$4717;(err$4717=$4722(["match"]).create("Could not find a match for value",({"value":value$4711})));;if(url$4712){(err$4717["location"]=["location",url$4712,start$4713,end$4714]);}throw err$4717;};
var $4985=function($4986$4988,key$4989){var ph$4993;(ph$4993=$4986$4988);;var $4991$4998;($4991$4998=ph$4993);;var bridge$4992$5003;(bridge$4992$5003=$4991$4998);if(((bridge$4992$5003===null)||(bridge$4992$5003===(void 0)))){return false;}else{var x$5011;if((typeof($4991$4998)==="string")){(x$5011=$4991$4998);return (key$4989 in String.prototype);}else{var x$5016;if((typeof($4991$4998)==="number")){(x$5016=$4991$4998);return (key$4989 in Number.prototype);}else{var x$5021;(x$5021=$4991$4998);return (key$4989 in x$5021);}}}};
var $4929=function($4930$4932){var ph$4938;var x$4939;var t0$4941;(t0$4941=$4930$4932);(x$4939=t0$4941);(ph$4938=t0$4941);;var $4934$4945;($4934$4945=ph$4938);;var bridge$4935$4950;(bridge$4935$4950=$4934$4945);if((function(){var bridge$4936$4956;(bridge$4936$4956=bridge$4935$4950);return (function(){var bridge$4937$4959;(bridge$4937$4959=bridge$4936$4956);return ((bridge$4937$4959===(void 0))||(bridge$4937$4959===null));}()||(typeof(bridge$4936$4956)==="string"));}()||(typeof(bridge$4935$4950)==="number"))){return x$4939;}else{if($4985($4934$4945,"::clone")){$4934$4945["::clone"];return x$4939["::clone"]();}else{$4934$4945;if((Object.getPrototypeOf(x$4939)===Object.prototype)){var dest$4972;(dest$4972=({}));;var k$4977;(k$4977=null);$4971:for(k$4977 in x$4939){if(Object.prototype.hasOwnProperty.call(x$4939,k$4977)){(dest$4972[k$4977]=x$4939[k$4977]);}}return dest$4972;}else{var other$4983;(other$4983=$4934$4945);throw $4722(["clone"]).create("Object cannot be cloned",({"obj":x$4939}));}}}};
var $4913=function(a$4915,b$4916){var dest$4920;(dest$4920=$4929(a$4915));;var k$4925;(k$4925=null);$4919:for(k$4925 in b$4916){if(Object.prototype.hasOwnProperty.call(b$4916,k$4925)){(dest$4920[k$4925]=b$4916[k$4925]);}}return dest$4920;};var id$3608;var id_f$3609;var numr$3610;var numr_f$3611;var num$3612;var num_f$3613;var str$3614;var str_f$3615;var op$3616;var op2$3617;var op3$3618;var op4$3619;var op_f$3620;var indent$3621;var indent_f$3622;var cmnt$3623;var cmnt_f$3624;var unkn$3625;var unkn_f$3626;var $3578$3579;var Location$3580;var __lt____lt____colon__$3581;var special_ops$3582;var regexps$3583;var ws_re$3584;var eol_re$3585;var produce$3586;var indent_tracker$3587;var process_indent$3588;var disambiguate_fixity$3589;var alternate_operators$3590;var fill_locations$3591;var tokenize$3592;($3578$3579=require("./location"));;(Location$3580=$3578$3579.Location);;(__lt____lt____colon__$3581=$3578$3579["<<:"]);;(special_ops$3582=({"(":"PFX","[":"PFX","{":"PFX",")":"SFX","]":"SFX","}":"SFX",",":"IFX",".":"PFX","'":"PFX","not":"PFX"}));;(regexps$3583=(((id$3608=RegExp("(?:^[a-zA-Z$_](?:[a-zA-Z$_0-9]*))",""))),((id_f$3609=function(m$3633){return ["ID",m$3633[0]];})),((numr$3610=RegExp("(?:^((?:\\d+))[rR]((?:[A-Za-z0-9_]+))(?:(?:\\.((?:[A-Za-z0-9_]+)))?))",""))),((numr_f$3611=function(m$3642){var t0$3650;var t1$3651;var radix$3645;var intp$3646;var frac$3647;var value$3648;(t0$3650=m$3642);if(((t0$3650 instanceof Array)&&((t1$3651=t0$3650.length),(t1$3651===4)))){t0$3650[0];(radix$3645=t0$3650[1]);(intp$3646=t0$3650[2]);(frac$3647=t0$3650[3]);;}else{$4709(m$3642,"/home/olivier/git/earl-grey/src/lex.eg",993,994);}(value$3648=parseInt(intp$3646.replace(RegExp("_","g"),""),radix$3645));;if(frac$3647){(frac$3647=frac$3647.replace(RegExp("_","g"),""));(value$3648=(value$3648+(parseInt(frac$3647,radix$3645)/Math.pow(radix$3645,frac$3647.length))));}return ["ID","NUM",value$3648];})),((num$3612=RegExp("(?:^((?:[0-9_]+))(?:(?:\\.((?:\\d+)))?)(?:(?:[eE]((?:[+-]?)(?:[0-9_]+)))?))",""))),((num_f$3613=function(m$3667){return ["NUM",parseFloat(m$3667[0].replace(RegExp("_","g"),""))];})),((str$3614=RegExp("(?:^\"((?:(?:(?:\\\\\\\\|\\\\\")|[^\"])*))\")",""))),((str_f$3615=function(m$3676){var repl$3679;var r$3680;(repl$3679=({"\\\"":"\"","\\\\":"\\","\\n":"\n"}));;(r$3680=m$3676[1].replace(RegExp("((?:(?:\\\\\"|\\\\\\\\)|\\\\n))","g"),function(m$3687){return $3533(repl$3679,m$3687);}));;return ["STR",r$3680];})),((op$3616=RegExp("(?:^(?:[+\\-*/~\\^<>=%&|?!@#.:']+))",""))),((op2$3617=RegExp("(?:^[\\[\\{\\}\\],])",""))),((op3$3618=RegExp("(?:^(?:(?:(?:(?:(?:(?:(?:(?:(?:with|where)|when)|and)|not)|or)|in)|mod)|each)|as)(?:(?:[+\\-*/~\\^<>=%&|?!@#.:']+)|\\b))",""))),((op4$3619=RegExp("(?:^`((?:[A-Za-z0-9_]+))`)",""))),((op_f$3620=function(m$3706,column$3707){var fixity$3733;var otherwise$3739;var $3711$3723;var $3710$3717;var op$3712;(op$3712=(m$3706[1]||m$3706[0]));;($3710$3717=null);;$3710$3717;if((op$3712==="|")){return ["INDENT",(column$3707-1)];}else{if((op$3712 in special_ops$3582)){(fixity$3733=$3533(special_ops$3582,op$3712));;return ["OP",fixity$3733,op$3712];}else{(otherwise$3739=$3710$3717);return ["OP","?FX",op$3712];}}})),((indent$3621=RegExp("(?:^(?:(?:\n \\*;(?:[^\n]*))*)(?:(?:\n((?: *)))+))",""))),((indent_f$3622=function(m$3748){var ilen$3751;(ilen$3751=m$3748[1].length);;return ["INDENT",ilen$3751];})),((cmnt$3623=RegExp("(?:^;(?:[^\n]*))",""))),((cmnt_f$3624=function(m$3762){return ["IGNORE"];})),((unkn$3625=RegExp("(?:^.)",""))),((unkn_f$3626=function(m$3771){return ["ILLEGAL",m$3771[0]];})),[[op3$3618,op_f$3620],[id$3608,id_f$3609],[numr$3610,numr_f$3611],[num$3612,num_f$3613],[str$3614,str_f$3615],[op$3616,op_f$3620],[op2$3617,op_f$3620],[op4$3619,op_f$3620],[indent$3621,indent_f$3622],[cmnt$3623,cmnt_f$3624],[unkn$3625,unkn_f$3626]]));;(ws_re$3584=RegExp("(?:^(?: *)(?:(?:\n(?: *)\\\\(?: *))*))",""));;(eol_re$3585=RegExp("(?:^(?: *)(?:\n|$))",""));;(produce$3586=function(src$3784){var text$3787;var results$3788;var wsb$3789;var pos$3790;var column$3791;(text$3787=src$3784.text);;(results$3788=[]);;(wsb$3789=text$3787.match(ws_re$3584)[0].length);;(text$3787=text$3787.slice(wsb$3789));(pos$3790=wsb$3789);;(column$3791=0);;$3807:while(text$3787){var i$3812;(i$3812=0);;$3810:for(;(i$3812<regexps$3583.length);(++i$3812)){var t0$3824;var t1$3825;var splits$3848;var skip$3834;var endpos$3835;var wsa$3836;var eol$3837;var bwsb$3838;var bwsa$3839;var token$3840;var re$3820;var fn$3821;var m$3822;(t0$3824=$3533(regexps$3583,i$3812));if(((t0$3824 instanceof Array)&&((t1$3825=t0$3824.length),(t1$3825===2)))){(re$3820=t0$3824[0]);(fn$3821=t0$3824[1]);;}else{$4709($3533(regexps$3583,i$3812),"/home/olivier/git/earl-grey/src/lex.eg",3333,3353);}(m$3822=text$3787.match(re$3820));;if(m$3822){(skip$3834=m$3822[0].length);;(endpos$3835=(pos$3790+skip$3834));;(column$3791=(((splits$3848=m$3822[0].split("\n"))),function(){if((splits$3848.length>1)){return $3533(splits$3848,(splits$3848.length-1)).length;}else{return (column$3791+skip$3834);}}()));(text$3787=text$3787.slice(skip$3834));(wsa$3836=text$3787.match(ws_re$3584)[0].length);;(eol$3837=(text$3787.match(eol_re$3585)&&true));;(bwsb$3838=(wsb$3789>0));;(bwsa$3839=function(){if(eol$3837){return bwsb$3838;}else{return (wsa$3836>0);}}());;(token$3840=fn$3821(m$3822,column$3791));;(token$3840["wsb"]=bwsb$3838);(token$3840["wsa"]=bwsa$3839);(token$3840["location"]=Location$3580(src$3784,pos$3790,endpos$3835));results$3788.push(token$3840);(text$3787=text$3787.slice(wsa$3836));(column$3791=(column$3791+wsa$3836));(wsb$3789=wsa$3836);(pos$3790=(endpos$3835+wsa$3836));break $3810;}}}return results$3788;});;(indent_tracker$3587=function(){var curr$3874;var stack$3875;var stacks$3876;(curr$3874=0);;(stack$3875=[]);;(stacks$3876=[stack$3875]);;return function($3873$3887){var t0$3900;var rval$3946;var $index$3998;var $length$3993;var temp$3988;var acc$3983;var rval$3977;var other$4018;var fixity$3971;var fixity$3963;var stuff$3958;var new_indent$3920;var $3890$3921;var $3893$3914;var $3894$3915;var $3895$3916;var $3896$3917;var t0$3909;var t1$3910;var bridge$3891$3911;var bridge$3892$3912;var $3889$3904;var ph$3897;var token$3898;(t0$3900=$3873$3887);(token$3898=t0$3900);(ph$3897=t0$3900);;($3889$3904=ph$3897);;if((($3893$3914=($3889$3904 instanceof Array))&&((t0$3909=$3889$3904.length),((t0$3909===2)&&($3889$3904[0]==="INDENT"))))){(t1$3910=$3889$3904[1]);(new_indent$3920=t1$3910);($3890$3921=t1$3910);$3890$3921;if((curr$3874===false)){(curr$3874=new_indent$3920);return [$4913(["OP","IFX",","],({"wsb":true,"wsa":true}))];}else{if(($3890$3921>curr$3874)){$3533(stack$3875.push(curr$3874),(curr$3874=new_indent$3920));return [$4913(["OP","PFX","["],({"wsb":true,"wsa":true}))];}else{if(($3890$3921===curr$3874)){return [$4913(["OP","IFX",","],({"wsb":true,"wsa":true}))];}else{if(($3890$3921<curr$3874)){(rval$3946=[]);;$3950:while(((stack$3875.length>0)&&(new_indent$3920<curr$3874))){(curr$3874=stack$3875.pop());rval$3946.push($4913(["OP","SFX","]"],({"wsb":true,"wsa":true})));}rval$3946.push($4913(["OP","IFX",","],({"wsb":true,"wsa":true})));return rval$3946;}else{$4709($3890$3921,"/home/olivier/git/earl-grey/src/lex.eg",4686,4702);}}}}}else{if(($3893$3914&&((t0$3909>=1)&&($3889$3904[0]==="ID")))){(stuff$3958=Array.prototype.slice.call($3889$3904,1));return [token$3898];}else{if(($3893$3914&&(($3895$3916=(t0$3909===3))&&(($3896$3917=($3889$3904[0]==="OP"))&&((fixity$3963=$3889$3904[1]),((bridge$3891$3911=$3889$3904[2]),((bridge$3891$3911==="[")||(bridge$3891$3911==="{")))))))){stack$3875.push(curr$3874);stacks$3876.push(stack$3875);(stack$3875=[]);(curr$3874=false);return [token$3898];}else{if(($3896$3917&&((fixity$3971=$3889$3904[1]),((bridge$3892$3912=$3889$3904[2]),((bridge$3892$3912==="]")||(bridge$3892$3912==="}")))))){(rval$3977=(((acc$3983=[])),(((temp$3988=stack$3875)),((($length$3993=temp$3988.length)),((($index$3998=0)),function(){$3980:for(;($index$3998<$length$3993);($index$3998++)){var m$4006;(m$4006=temp$3988[$index$3998]);;m$4006;acc$3983.push($4913(["OP","SFX","]"],({"wsb":true,"wsa":true})));}}()))),acc$3983));;(stack$3875=stacks$3876.pop());(curr$3874=stack$3875.pop());rval$3977.push(token$3898);return rval$3977;}else{(other$4018=$3889$3904);return [token$3898];}}}}};});;(process_indent$3588=function(stream$4024){var $index$4049;var $length$4044;var temp$4039;var tracker$4027;var results$4028;(tracker$4027=indent_tracker$3587());;(results$4028=[]);;(temp$4039=stream$4024);;($length$4044=temp$4039.length);;($index$4049=0);;$4029:for(;($index$4049<$length$4044);($index$4049++)){var token$4065;var m$4057;(m$4057=temp$4039[$index$4049]);;(token$4065=m$4057);(results$4028=results$4028.concat(tracker$4027(token$4065)));}return results$4028;});;(disambiguate_fixity$3589=function(stream$4071){var $index$4395;var $length$4390;var temp$4385;var __lt____lt____lt____colon__$4074;var collapse_operators$4075;var buffer$4076;var pfx$4077;var collapse$4078;var results$4079;(__lt____lt____lt____colon__$4074=function(a$4087,b$4088){(a$4087["wsb"]=b$4088.wsb);(a$4087["wsa"]=b$4088.wsa);return __lt____lt____colon__$3581(a$4087,b$4088);});;(collapse_operators$4075=function(){var msg$4163;var longer$4160;var token$4149;var fixity$4150;var name$4151;var t0$4143;var t1$4144;var t2$4145;var $4136$4138;var $index$4189;var $length$4184;var temp$4179;var acc$4174;var $index$4237;var $length$4232;var temp$4227;var acc$4222;var t0$4276;var t1$4277;var t2$4278;var t3$4279;var t0$4303;var t0$4306;var t0$4342;var t0$4345;var t1$4346;var t2$4347;var bridge$4329$4336;var $4328$4331;var t$4325;var results$4320;var $4268$4296;var $4269$4297;var $4270$4298;var bridge$4267$4293;var t0$4294;var $4266$4288;var first$4271;var fixity$4272;var name$4273;var rest$4274;var n$4124;var $4097$4119;var $4098$4120;var $4099$4121;var $4100$4122;var t0$4116;var t1$4117;var buffer$4111;var $4096$4112;var t0$4107;var $4095$4102;($4095$4102=arguments);;(t0$4107=$4095$4102.length);if((t0$4107>=1)){(buffer$4111=$4095$4102[0]);($4096$4112=Array.prototype.slice.call($4095$4102,1));(n$4124=buffer$4111.length);;$4096$4112;if((!buffer$4111.length)){return [];}else{(t0$4116=$4096$4112);(t1$4117=t0$4116.length);if((($4099$4121=(t1$4117===2))&&(($4100$4122=t0$4116[0])&&t0$4116[1]))){($4136$4138=buffer$4111);;if((($4136$4138 instanceof Array)&&((t0$4143=$4136$4138.length),((t0$4143===1)&&((t1$4144=$4136$4138[0]),((token$4149=t1$4144),((t1$4144 instanceof Array)&&((t2$4145=t1$4144.length),((t2$4145===3)&&(t1$4144[0]==="OP")))))))))){(fixity$4150=t1$4144[1]);(name$4151=t1$4144[2]);return [__lt____lt____lt____colon__$4074(["ID",name$4151],token$4149)];}else{(longer$4160=$4136$4138);(msg$4163="Too many consecutive operators were found here.");;throw $4722(["syntax","nullary"]).create(msg$4163,({"operators":buffer$4111}));}}else{if($4100$4122){t0$4116[1];(acc$4174=[]);;(temp$4179=buffer$4111);;($length$4184=temp$4179.length);;($index$4189=0);;$4171:for(;($index$4189<$length$4184);($index$4189++)){var token$4207;var name$4208;var t0$4202;var t1$4203;var m$4197;(m$4197=temp$4179[$index$4189]);;(t0$4202=m$4197);(token$4207=t0$4202);if(((t0$4202 instanceof Array)&&((t1$4203=t0$4202.length),((t1$4203===3)&&(t0$4202[0]==="OP"))))){t0$4202[1];(name$4208=t0$4202[2]);acc$4174.push(__lt____lt____lt____colon__$4074(["OP","PFX",name$4208],token$4207));}else{$4709(m$4197,"/home/olivier/git/earl-grey/src/lex.eg",6914,7008);;}}return acc$4174;}else{if(($4099$4121&&(t0$4116[0],t0$4116[1]))){(acc$4222=[]);;(temp$4227=buffer$4111);;($length$4232=temp$4227.length);;($index$4237=0);;$4219:for(;($index$4237<$length$4232);($index$4237++)){var token$4255;var name$4256;var t0$4250;var t1$4251;var m$4245;(m$4245=temp$4227[$index$4237]);;(t0$4250=m$4245);(token$4255=t0$4250);if(((t0$4250 instanceof Array)&&((t1$4251=t0$4250.length),((t1$4251===3)&&(t0$4250[0]==="OP"))))){t0$4250[1];(name$4256=t0$4250[2]);acc$4222.push(__lt____lt____lt____colon__$4074(["OP","SFX",name$4256],token$4255));}else{$4709(m$4245,"/home/olivier/git/earl-grey/src/lex.eg",7021,7115);;}}return acc$4222;}else{$4096$4112;(t0$4276=buffer$4111);if(((t0$4276 instanceof Array)&&((t1$4277=t0$4276.length),((t1$4277>=1)&&((t2$4278=t0$4276[0]),((first$4271=t2$4278),((t2$4278 instanceof Array)&&((t3$4279=t2$4278.length),((t3$4279===3)&&(t2$4278[0]==="OP")))))))))){(fixity$4272=t2$4278[1]);(name$4273=t2$4278[2]);(rest$4274=Array.prototype.slice.call(t0$4276,1));;}else{$4709(buffer$4111,"/home/olivier/git/earl-grey/src/lex.eg",7168,7174);}($4266$4288=[first$4271.wsb,first$4271.wsa]);;(bridge$4267$4293=$4266$4288);if((((bridge$4267$4293 instanceof Array)&&((t0$4303=bridge$4267$4293.length),((t0$4303===2)&&((!bridge$4267$4293[0])&&(!bridge$4267$4293[1])))))||((bridge$4267$4293 instanceof Array)&&((t0$4306=bridge$4267$4293.length),((t0$4306===2)&&(bridge$4267$4293[0]&&bridge$4267$4293[1])))))){return [__lt____lt____lt____colon__$4074(["OP","IFX",name$4273],first$4271)].concat(collapse_operators$4075(rest$4274,true,false));}else{if((($4268$4296=($4266$4288 instanceof Array))&&((t0$4294=$4266$4288.length),(($4270$4298=(t0$4294===2))&&$4266$4288[0])))){$4266$4288[1];return [__lt____lt____lt____colon__$4074(["OP","PFX",name$4273],first$4271)].concat(collapse_operators$4075(rest$4274,true,false));}else{if(($4270$4298&&($4266$4288[0],$4266$4288[1]))){(results$4320=collapse_operators$4075(rest$4274,false,false));;(t$4325=((($4328$4331=results$4320)),((bridge$4329$4336=$4328$4331),function(){if((((bridge$4329$4336 instanceof Array)&&((t0$4342=bridge$4329$4336.length),(t0$4342===0)))||((bridge$4329$4336 instanceof Array)&&((t0$4345=bridge$4329$4336.length),((t0$4345>=1)&&((t1$4346=bridge$4329$4336[0]),((t1$4346 instanceof Array)&&((t2$4347=t1$4346.length),((t2$4347>=2)&&((t1$4346[0]==="OP")&&((t1$4346[1]==="PFX")&&(Array.prototype.slice.call(t1$4346,2),(Array.prototype.slice.call(bridge$4329$4336,1),true))))))))))))){return ["OP","IFX",name$4273];}else{$4328$4331;return ["OP","SFX",name$4273];}}())));;return [__lt____lt____lt____colon__$4074(t$4325,first$4271)].concat(results$4320);}else{$4709($4266$4288);}}}}}}}}else{$4709($4095$4102);}});;(buffer$4076=[]);;(pfx$4077=true);;(collapse$4078=function(sfx$4372){var rval$4375;(rval$4375=collapse_operators$4075(buffer$4076,pfx$4077,sfx$4372));;(buffer$4076=[]);return rval$4375;});;(results$4079=[]);;(temp$4385=stream$4071);;($length$4390=temp$4385.length);;($index$4395=0);;$4080:for(;($index$4395<$length$4390);($index$4395++)){var other$4451;var name$4421;var $4083$4422;var t0$4416;var t1$4417;var token$4412;var $4082$4413;var t0$4408;var m$4403;(m$4403=temp$4385[$index$4395]);;(t0$4408=m$4403);(token$4412=t0$4408);($4082$4413=t0$4408);(t0$4416=$4082$4413);if(((t0$4416 instanceof Array)&&((t1$4417=t0$4416.length),((t1$4417===3)&&(t0$4416[0]==="OP"))))){($4083$4422=t0$4416[1]);(name$4421=t0$4416[2]);if(($4083$4422==="?FX")){buffer$4076.push(token$4412);}else{if(($4083$4422==="IFX")){(results$4079=results$4079.concat(collapse$4078(true)));results$4079.push(token$4412);(pfx$4077=true);}else{if(($4083$4422==="PFX")){(results$4079=results$4079.concat(collapse$4078(false)));results$4079.push(token$4412);(pfx$4077=true);}else{if(($4083$4422==="SFX")){(results$4079=results$4079.concat(collapse$4078(true)));results$4079.push(token$4412);(pfx$4077=false);}else{$4709($4083$4422,"/home/olivier/git/earl-grey/src/lex.eg",7969,7974);;}}}}}else{(other$4451=$4082$4413);(results$4079=results$4079.concat(collapse$4078(false)));results$4079.push(token$4412);(pfx$4077=false);}}return results$4079.concat(collapse$4078(true));});;(alternate_operators$3590=function(stream$4458){var $index$4491;var $length$4486;var temp$4481;var W$4461;var last_op$4462;var results$4463;(W$4461=function(x$4470){if(x$4470){return "wide";}else{return "short";}});;(last_op$4462=true);;(results$4463=[]);;(temp$4481=stream$4458);;($length$4486=temp$4481.length);;($index$4491=0);;$4464:for(;($index$4491<$length$4486);($index$4491++)){var x$4519;var $4532$4535;var x$4563;var token$4570;var fixity$4526;var name$4527;var t0$4512;var t1$4513;var token$4508;var $4466$4509;var t0$4504;var m$4499;(m$4499=temp$4481[$index$4491]);;(t0$4504=m$4499);(token$4508=t0$4504);($4466$4509=t0$4504);if((((x$4519=$4466$4509)),((x$4519 instanceof Array)&&(x$4519[0]==="IGNORE")))){null;}else{(t0$4512=$4466$4509);if(((t0$4512 instanceof Array)&&((t1$4513=t0$4512.length),((t1$4513===3)&&(t0$4512[0]==="OP"))))){(fixity$4526=t0$4512[1]);(name$4527=t0$4512[2]);if(last_op$4462){results$4463.push(["VOID"]);}($4532$4535=fixity$4526);;if(($4532$4535==="IFX")){results$4463.push(__lt____lt____colon__$3581(["IFX",W$4461((token$4508.wsa||token$4508.wsb)),name$4527],token$4508));(last_op$4462=true);}else{if(($4532$4535==="PFX")){if((!last_op$4462)){results$4463.push(["IFX",W$4461(token$4508.wsb),"WHITE"],["VOID"]);}results$4463.push(__lt____lt____colon__$3581(["PFX",W$4461(token$4508.wsa),name$4527],token$4508));(last_op$4462=true);}else{if(($4532$4535==="SFX")){results$4463.push(__lt____lt____colon__$3581(["SFX",W$4461(token$4508.wsb),name$4527],token$4508),["VOID"]);(last_op$4462=false);}else{$4709($4532$4535);;}}}}else{if((((x$4563=$4466$4509)),((x$4563 instanceof Array)&&(x$4563[0]==="ILLEGAL")))){throw $4722(["syntax","illegal"]).create("unknown character",({"chr":token$4508}));}else{(token$4570=$4466$4509);if((!last_op$4462)){results$4463.push(["IFX",W$4461(token$4570.wsb),"WHITE"]);}results$4463.push(token$4570);(last_op$4462=false);}}}}if(last_op$4462){results$4463.push(["VOID"]);}return results$4463;});;(fill_locations$3591=function(source$4579,stream$4580){var $index$4650;var $length$4645;var temp$4640;var to_fill$4583;var start$4584;var fill$4585;(to_fill$4583=[]);;(start$4584=0);;(fill$4585=function(end$4597){var $index$4614;var $length$4609;var temp$4604;(temp$4604=to_fill$4583);;($length$4609=temp$4604.length);;($index$4614=0);;$4600:for(;($index$4614<$length$4609);($index$4614++)){var token$4635;var token$4630;var m$4622;(m$4622=temp$4604[$index$4614]);;(token$4630=m$4622);if(($index$4614===0)){(token$4630["location"]=Location$3580(source$4579,start$4584,end$4597));}else{(token$4635=m$4622);(token$4635["location"]=Location$3580(source$4579,end$4597,end$4597));}}return (to_fill$4583=[]);});;(temp$4640=stream$4580);;($length$4645=temp$4640.length);;($index$4650=0);;$4586:for(;($index$4650<$length$4645);($index$4650++)){var other$4674;var location$4667;var t0$4663;var m$4658;(m$4658=temp$4640[$index$4650]);;(t0$4663=m$4658);if(($4985(t0$4663,"location")&&((location$4667=t0$4663.location),location$4667))){fill$4585(location$4667.start);(start$4584=location$4667.end);}else{(other$4674=m$4658);to_fill$4583.push(other$4674);}}fill$4585(source$4579.text.length);return stream$4580;});;(tokenize$3592=function(src$4680){var it$0$4703;var it$0$4698;var it$0$4693;var it$0$4688;var it$0$4683;(it$0$4683=src$4680);;(it$0$4688=produce$3586(it$0$4683));;(it$0$4693=process_indent$3588(it$0$4688));;(it$0$4698=disambiguate_fixity$3589(it$0$4693));;(it$0$4703=alternate_operators$3590(it$0$4698));;return fill_locations$3591(src$4680,it$0$4703);});;(exports["tokenize"]=tokenize$3592);

},{"./location":7}],7:[function(require,module,exports){
var $5184=function(type$5186){var f$5189;(f$5189=type$5186["::check"]);;if((f$5189===(void 0))){return function(value$5194){return (value$5194 instanceof type$5186);};}else{return function(value$5197){return f$5189.call(type$5186,value$5197);};}};
var $5199=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $5200=function(dest$5202,values$5203){var k$5208;(k$5208=null);$5206:for(k$5208 in values$5203){if(values$5203.hasOwnProperty(k$5208)){(dest$5202[k$5208]=values$5203[k$5208]);}}return dest$5202;};
var $5212=function($5213$5215){var ph$5219;(ph$5219=$5213$5215);;var $5217$5224;($5217$5224=ph$5219);;var bridge$5218$5229;var x$5233;(bridge$5218$5229=$5217$5224);if((((typeof(bridge$5218$5229)==="string")&&((x$5233=bridge$5218$5229),true))||((typeof(bridge$5218$5229)==="number")&&((x$5233=bridge$5218$5229),true)))){return ["value",x$5233];}else{var other$5240;(other$5240=$5217$5224);return other$5240["::serialize_ast"]();}};
var send$5024;(send$5024=function(obj$5029,$5027$5030){var ph$5034;var msg$5035;var t0$5037;(t0$5037=$5027$5030);(msg$5035=t0$5037);(ph$5034=t0$5037);;var $5032$5041;($5032$5041=ph$5034);;var bridge$5033$5046;(bridge$5033$5046=$5032$5041);if(((typeof(bridge$5033$5046)==="string")||(typeof(bridge$5033$5046)==="number"))){return obj$5029[msg$5035];}else{var other$5054;(other$5054=$5032$5041);return obj$5029["::send"](msg$5035);}});;(Array[":::project"]=function($5057$5059){var ph$5062;var value$5063;var t0$5065;(t0$5065=$5057$5059);(value$5063=t0$5065);(ph$5062=t0$5065);;var $5061$5069;($5061$5069=ph$5062);;if($5184(Array)($5061$5069)){return [true,value$5063];}else{$5061$5069;return [true,[value$5063]];}});(Array.prototype["::check"]=function(value$5083){if((value$5083 instanceof Array)){var i$5088;(i$5088=0);;$5086:for(;(i$5088<this.length);(i$5088++)){if(($5199(this,i$5088)!==$5199(value$5083,i$5088))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $5200(this.slice(0),this);});(Array.prototype[":::project"]=function(value$5099){if((value$5099 instanceof Array)){var i$5104;(i$5104=0);;$5102:for(;(i$5104<this.length);(i$5104++)){if(($5199(this,i$5104)!==$5199(value$5099,i$5104))){return [true,[value$5099]];}}return [true,value$5099.slice(this.length)];}else{return [true,[value$5099]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($5212));});(RegExp.prototype["::check"]=function($5114$5116){var ph$5119;(ph$5119=$5114$5116);;var $5118$5124;($5118$5124=ph$5119);;var value$5132;if((typeof($5118$5124)==="string")){(value$5132=$5118$5124);if(value$5132.match(this)){return true;}else{return false;}}else{var other$5137;(other$5137=$5118$5124);return false;}});(RegExp.prototype[":::project"]=function($5139$5141){var ph$5144;(ph$5144=$5139$5141);;var $5143$5149;($5143$5149=ph$5144);;var value$5157;if((typeof($5143$5149)==="string")){(value$5157=$5143$5149);var $5160$5162;($5160$5162=value$5157.match(this));;var m$5170;if(($5160$5162===null)){(m$5170=$5160$5162);return [false,null];}else{var m$5175;(m$5175=$5160$5162);return [true,m$5175];}}else{var other$5179;(other$5179=$5143$5149);return [false,null];}});(Function.prototype["::send"]=function(args$5182){return this.apply(this,args$5182);});
var $6956=function(arr$6958){var results$6962;var l$6963;(results$6962=[]);;(l$6963=arr$6958.length);;var i$6971;(i$6971=0);;$6961:for(;(i$6971<l$6963);(i$6971++)){results$6962.push([i$6971,$5199(arr$6958,i$6971)]);}return results$6962;};
var $6787=function(){var $6788$6790;($6788$6790=function(tags$6794){var it$0$6797;(it$0$6797=function(){if((!$5184($6788$6790)(this))){return Object.create($6788$6790.prototype);}else{return this;}}());;(it$0$6797["tags"]=tags$6794);return it$0$6797;});;($6788$6790.prototype["create"]=function(){var $6806$6808;($6806$6808=arguments);;var t0$6813;var message$6817;var args$6818;(t0$6813=$6806$6808.length);if((t0$6813>=0)){(message$6817=function(){if((0>=t0$6813)){return "";}else{return $6806$6808[0];}}());(args$6818=Array.prototype.slice.call($6806$6808,1));var it$0$6822;(it$0$6822=this);;var self$6827;(self$6827=this);;var e$6832;(e$6832=Error(message$6817));;(e$6832["::tags"]=it$0$6822.tags);(e$6832["args"]=args$6818);var temp$6840;(temp$6840=$6956(args$6818));;var $length$6845;($length$6845=temp$6840.length);;var $index$6850;($index$6850=0);;$6833:for(;($index$6850<$length$6845);($index$6850++)){var m$6858;(m$6858=temp$6840[$index$6850]);;var t0$6863;var t1$6864;var i$6868;var arg$6869;(t0$6863=m$6858);if(((t0$6863 instanceof Array)&&((t1$6864=t0$6863.length),(t1$6864===2)))){(i$6868=t0$6863[0]);(arg$6869=t0$6863[1]);(e$6832[i$6868]=arg$6869);}else{$6774(m$6858);;}}(e$6832["length"]=args$6818.length);(e$6832["name"]=["E"].concat(it$0$6822.tags).join("."));return e$6832;}else{$6774($6806$6808);}});($6788$6790.prototype["::check"]=function(e$6880){var it$0$6883;(it$0$6883=this);;var self$6888;(self$6888=this);;var tags$6893;if(((!e$6880)||(!$5184(Error)(e$6880)))){return false;}(tags$6893=(e$6880["::tags"]||[]));;var temp$6902;(temp$6902=it$0$6883.tags);;var $length$6907;($length$6907=temp$6902.length);;var $index$6912;($index$6912=0);;$6894:for(;($index$6912<$length$6907);($index$6912++)){var m$6920;(m$6920=temp$6902[$index$6912]);;var tag$6928;(tag$6928=m$6920);if((tags$6893.indexOf(tag$6928)===-1)){return false;}else{false;;}}return true;});($6788$6790.prototype["::deconstruct"]=function(e$6936){var it$0$6939;(it$0$6939=this);;var self$6944;(self$6944=this);;return e$6936.args;});$5200($6788$6790,$5200(function(){var accum$6949;(accum$6949=({}));(accum$6949["::name"]="$6788");return accum$6949;}(),function(){var accum$6953;(accum$6953=({}));(accum$6953["::egclass"]=true);return accum$6953;}()));return $6788$6790;}();
var $6774=function(value$6776,url$6777,start$6778,end$6779){var err$6782;(err$6782=$6787(["match"]).create("Could not find a match for value",({"value":value$6776})));;if(url$6777){(err$6782["location"]=["location",url$6777,start$6778,end$6779]);}throw err$6782;};
var $7105=function(type$7107){return function(value$7110){var f$7113;(f$7113=type$7107[":::project"]);;if((f$7113===(void 0))){(f$7113=type$7107["::project"]);if((f$7113===(void 0))){return [true,type$7107(value$7110)];}else{var rval$7119;(rval$7119=false);;try{(rval$7119=[true,f$7113(value$7110)]);}catch(excv$7125){var e$7131;(e$7131=excv$7125);(rval$7119=[false,null]);}return rval$7119;}}else{return f$7113.call(type$7107,value$7110);}};};
var $6978=function(){var $6979$6981;($6979$6981=function($6984$6987,$6985$6988){var classes$6990;var children$6991;var t0$6993;(t0$6993=$7105(Array)($6984$6987));if(t0$6993[0]){(classes$6990=t0$6993[1]);;}else{$6774($6984$6987);}var t0$6998;(t0$6998=$7105(Array)($6985$6988));if(t0$6998[0]){(children$6991=t0$6998[1]);;}else{$6774($6985$6988);}var it$0$7003;(it$0$7003=function(){if((!$5184($6979$6981)(this))){return Object.create($6979$6981.prototype);}else{return this;}}());;(it$0$7003["classes"]=classes$6990.sort());(it$0$7003["children"]=children$6991);return it$0$7003;});;$5200(function(){var accum$7011;(accum$7011=({}));(accum$7011["::check"]=function(x$7015){return ((x$7015&&x$7015.classes)&&x$7015.children);});return accum$7011;}(),$5200(function(){var accum$7018;(accum$7018=({}));(accum$7018["::deconstruct"]=function(x$7022){return [x$7022.classes,x$7022.children];});return accum$7018;}(),$5200(function(){var accum$7025;(accum$7025=({}));(accum$7025["::name"]="$6979");return accum$7025;}(),function(){var accum$7029;(accum$7029=({}));(accum$7029["::egclass"]=true);return accum$7029;}())));($6979$6981.prototype["::check"]=function(n$7035){var it$0$7038;(it$0$7038=this);;var self$7043;(self$7043=this);;var temp$7052;(temp$7052=it$0$7038.classes);;var $length$7057;($length$7057=temp$7052.length);;var $index$7062;($index$7062=0);;$7048:for(;($index$7062<$length$7057);($index$7062++)){var m$7070;(m$7070=temp$7052[$index$7062]);;var c$7078;(c$7078=m$7070);if((n$7035.classes.indexOf(c$7078)===-1)){return false;}else{false;;}}return true;});$5200($6979$6981,$5200(function(){var accum$7084;(accum$7084=({}));(accum$7084["::check"]=function(x$7088){return ((x$7088&&x$7088.classes)&&x$7088.children);});return accum$7084;}(),$5200(function(){var accum$7091;(accum$7091=({}));(accum$7091["::deconstruct"]=function(x$7095){return [x$7095.classes,x$7095.children];});return accum$7091;}(),$5200(function(){var accum$7098;(accum$7098=({}));(accum$7098["::name"]="$6979");return accum$7098;}(),function(){var accum$7102;(accum$7102=({}));(accum$7102["::egclass"]=true);return accum$7102;}()))));return $6979$6981;}();
var $7133=function(from$7135,to$7136){var rval$7140;(rval$7140=[]);;var i$7145;(i$7145=from$7135);;$7139:for(;(i$7145<=to$7136);(i$7145++)){rval$7140.push(i$7145);}return rval$7140;};
var $7152=function(obj$7154){var results$7158;(results$7158=[]);;var k$7163;(k$7163=null);$7157:for(k$7163 in obj$7154){if(Object.prototype.hasOwnProperty.call(obj$7154,k$7163)){results$7158.push([k$7163,$5199(obj$7154,k$7163)]);}}return results$7158;};
var $7167=function($7168$7170,key$7171){var ph$7175;(ph$7175=$7168$7170);;var $7173$7180;($7173$7180=ph$7175);;var bridge$7174$7185;(bridge$7174$7185=$7173$7180);if(((bridge$7174$7185===null)||(bridge$7174$7185===(void 0)))){return false;}else{var x$7193;if((typeof($7173$7180)==="string")){(x$7193=$7173$7180);return (key$7171 in String.prototype);}else{var x$7198;if((typeof($7173$7180)==="number")){(x$7198=$7173$7180);return (key$7171 in Number.prototype);}else{var x$7203;(x$7203=$7173$7180);return (key$7171 in x$7203);}}}};var accum$5390;var accum$5394;var accum$5620;var accum$5624;var $5244$5246;var binsearch$5247;var $5245$5248;var __lt____gt__$5249;var repr$5250;var fs$5251;var Source$5252;var Location$5253;var highlight$5254;var highlight_lines$5255;var clamp$5256;var morsel$5257;var highlight_locations$5258;var highlight_locations_same_source$5259;var merge_locations$5260;var __lt____lt____colon__$5261;var __plus____plus____colon__$5262;var format_error$5263;var display_error$5264;($5244$5246=require("./util"));;(binsearch$5247=$5244$5246.binsearch);;($5245$5248=require("./pp"));;(__lt____gt__$5249=$5245$5248["<>"]);;(repr$5250=$5245$5248.repr);;(fs$5251=require("fs"));;(Source$5252=function(){var $index$5326;var $length$5321;var temp$5316;var curr$5308;var it$0$5302;var text$5297;var url$5298;var t0$5293;var $5286$5288;($5286$5288=arguments);;(t0$5293=$5286$5288.length);if(((t0$5293>=1)&&(t0$5293<=2))){(text$5297=$5286$5288[0]);(url$5298=function(){if((1>=t0$5293)){return false;}else{return $5286$5288[1];}}());(it$0$5302=function(){if((!$5184(Source$5252)(this))){return Object.create(Source$5252.prototype);}else{return this;}}());;(it$0$5302["text"]=text$5297);(it$0$5302["url"]=url$5298);(it$0$5302["counts"]=[]);(curr$5308=0);;(temp$5316=text$5297.split("\n"));;($length$5321=temp$5316.length);;($index$5326=0);;$5309:for(;($index$5326<$length$5321);($index$5326++)){var line$5342;var m$5334;(m$5334=temp$5316[$index$5326]);;(line$5342=m$5334);it$0$5302.counts.push(curr$5308);(curr$5308=(curr$5308+(line$5342.length+1)));}it$0$5302.counts.push(curr$5308);(it$0$5302["nlines"]=(it$0$5302.counts.length-1));return it$0$5302;}else{$6774($5286$5288);}});;(Source$5252.prototype["linecol"]=function(pos$5351){var line$5364;var col$5365;var self$5359;var it$0$5354;(it$0$5354=this);;(self$5359=this);;(line$5364=binsearch$5247(it$0$5354.counts,pos$5351));;(col$5365=(pos$5351-$5199(it$0$5354.counts,(line$5364-1))));;return [line$5364,col$5365];});(Source$5252.prototype["highlight_lines"]=function(l1$5375,l2$5376,spans$5377){var self$5385;var it$0$5380;(it$0$5380=this);;(self$5385=this);;return highlight_lines$5255(it$0$5380.text,it$0$5380.counts,[(l1$5375-1),(l2$5376-1)],spans$5377);});$5200(Source$5252,$5200(((accum$5390=({})),((accum$5390["::name"]="Source"),accum$5390)),((accum$5394=({})),((accum$5394["::egclass"]=true),accum$5394))));Source$5252;(Location$5253=function(source$5400,start$5401,end$5402){var it$0$5405;(it$0$5405=function(){if((!$5184(Location$5253)(this))){return Object.create(Location$5253.prototype);}else{return this;}}());;(it$0$5405["source"]=(source$5400||Source$5252("",null)));(it$0$5405["start"]=start$5401);(it$0$5405["end"]=end$5402);return it$0$5405;});;(Location$5253.prototype["text"]=function(){var self$5422;var it$0$5417;(it$0$5417=this);;(self$5422=this);;return it$0$5417.source.text.slice(it$0$5417.start,it$0$5417.end);});(Location$5253.prototype["linerange"]=function(){var l2$5471;var t0$5462;var t1$5463;var l1$5454;var $5437$5455;var t0$5448;var t1$5449;var t2$5450;var $5436$5443;var self$5438;var it$0$5431;(it$0$5431=this);;(self$5438=this);;($5436$5443=it$0$5431.linecol());;if((($5436$5443 instanceof Array)&&((t0$5448=$5436$5443.length),((t0$5448===2)&&((t1$5449=$5436$5443[0]),((t1$5449 instanceof Array)&&((t2$5450=t1$5449.length),(t2$5450===2)))))))){(l1$5454=t1$5449[0]);t1$5449[1];($5437$5455=$5436$5443[1]);if(($5437$5455===null)){return [l1$5454,l1$5454];}else{(t0$5462=$5437$5455);if(((t0$5462 instanceof Array)&&((t1$5463=t0$5462.length),(t1$5463===2)))){(l2$5471=t0$5462[0]);t0$5462[1];return [l1$5454,l2$5471];}else{$6774($5437$5455,"/home/olivier/git/earl-grey/src/location.eg",975,980);}}}else{$6774($5436$5443);}});(Location$5253.prototype["linecol"]=function(){var start$5494;var end$5495;var self$5489;var it$0$5484;(it$0$5484=this);;(self$5489=this);;(start$5494=it$0$5484.source.linecol(it$0$5484.start));;(end$5495=function(){if((it$0$5484.start===it$0$5484.end)){return null;}else{return it$0$5484.source.linecol((it$0$5484.end-1));}}());;return [start$5494,end$5495];});(Location$5253.prototype["ref"]=function(){var otherwise$5583;var $5564$5572;var $5563$5566;var l2$5555;var c2$5556;var t0$5544;var t1$5545;var t2$5546;var t3$5547;var l1$5532;var c1$5533;var $5513$5534;var t0$5524;var t1$5525;var t2$5526;var t3$5527;var t4$5528;var $5512$5519;var self$5514;var it$0$5507;(it$0$5507=this);;(self$5514=this);;($5512$5519=it$0$5507.linecol());;if((($5512$5519 instanceof Array)&&((t0$5524=$5512$5519.length),((t0$5524===2)&&((t1$5525=$5512$5519[0]),((t1$5525 instanceof Array)&&((t2$5526=t1$5525.length),((t2$5526===2)&&((t3$5527=[true,String(t1$5525[0])]),(t3$5527[0]&&((l1$5532=t3$5527[1]),((t4$5528=[true,String(t1$5525[1])]),t4$5528[0])))))))))))){(c1$5533=t4$5528[1]);($5513$5534=$5512$5519[1]);if(($5513$5534===null)){return ((l1$5532+":")+c1$5533);}else{(t0$5544=$5513$5534);if(((t0$5544 instanceof Array)&&((t1$5545=t0$5544.length),((t1$5545===2)&&((t2$5546=[true,String(t0$5544[0])]),(t2$5546[0]&&((l2$5555=t2$5546[1]),((t3$5547=[true,String(t0$5544[1])]),t3$5547[0])))))))){(c2$5556=t3$5547[1]);($5563$5566=null);;$5563$5566;if(((l1$5532===l2$5555)&&(c1$5533===c2$5556))){return ((l1$5532+":")+c1$5533);}else{if((l1$5532===l2$5555)){return ((((l1$5532+":")+c1$5533)+"-")+c2$5556);}else{(otherwise$5583=$5563$5566);return ((((((l1$5532+":")+c1$5533)+"-")+l1$5532)+":")+c2$5556);}}}else{$6774($5513$5534,"/home/olivier/git/earl-grey/src/location.eg",1317,1322);}}}else{$6774($5512$5519);}});(Location$5253.prototype["highlight"]=function(){var self$5613;var it$0$5608;var cls$5603;var context$5604;var t0$5599;var $5592$5594;($5592$5594=arguments);;(t0$5599=$5592$5594.length);if(((t0$5599>=0)&&(t0$5599<=2))){(cls$5603=function(){if((0>=t0$5599)){return "hl1";}else{return $5592$5594[0];}}());(context$5604=function(){if((1>=t0$5599)){return 0;}else{return $5592$5594[1];}}());(it$0$5608=this);;(self$5613=this);;return highlight_locations$5258([[it$0$5608,cls$5603]],context$5604);}else{$6774($5592$5594);}});$5200(Location$5253,$5200(((accum$5620=({})),((accum$5620["::name"]="Location"),accum$5620)),((accum$5624=({})),((accum$5624["::egclass"]=true),accum$5624))));Location$5253;(highlight$5254=function(){var $index$5664;var $length$5659;var temp$5654;var acc$5649;var text$5641;var spans$5642;var offset$5643;var t0$5637;var $5630$5632;($5630$5632=arguments);;(t0$5637=$5630$5632.length);if(((t0$5637>=2)&&(t0$5637<=3))){(text$5641=$5630$5632[0]);(spans$5642=$5630$5632[1]);(offset$5643=function(){if((2>=t0$5637)){return 0;}else{return $5630$5632[2];}}());return $6978([],(((acc$5649=[])),(((temp$5654=morsel$5257(spans$5642))),((($length$5659=temp$5654.length)),((($index$5664=0)),function(){$5646:for(;($index$5664<$length$5659);($index$5664++)){var xstart$5689;var xend$5690;var start$5682;var end$5683;var attributes$5684;var t0$5677;var t1$5678;var m$5672;(m$5672=temp$5654[$index$5664]);;(t0$5677=m$5672);if(((t0$5677 instanceof Array)&&((t1$5678=t0$5677.length),(t1$5678===3)))){(start$5682=t0$5677[0]);(end$5683=t0$5677[1]);(attributes$5684=t0$5677[2]);acc$5649.push((((xstart$5689=Math.max((start$5682-offset$5643),0))),((xend$5690=Math.min((end$5683-offset$5643),text$5641.length))),$6978(attributes$5684.slice(0,1),[text$5641.slice(xstart$5689,xend$5690)])));}else{$6774(m$5672,"/home/olivier/git/earl-grey/src/location.eg",1864,2076);;}}}()))),acc$5649));}else{$6774($5630$5632);}});;(highlight_lines$5255=function(text$5706,linelocs$5707,$5704$5708,spans$5709){var t0$5714;var t1$5715;var $index$5738;var $length$5733;var temp$5728;var acc$5723;var l1$5711;var l2$5712;(t0$5714=$5704$5708);if(((t0$5714 instanceof Array)&&((t1$5715=t0$5714.length),(t1$5715===2)))){(l1$5711=t0$5714[0]);(l2$5712=t0$5714[1]);;}else{$6774($5704$5708);}return $6978(["+span"],(((acc$5723=[])),(((temp$5728=$7133(l1$5711,l2$5712))),((($length$5733=temp$5728.length)),((($index$5738=0)),function(){$5720:for(;($index$5738<$length$5733);($index$5738++)){var start$5757;var end$5758;var lineno$5754;var m$5746;(m$5746=temp$5728[$index$5738]);;(lineno$5754=m$5746);acc$5723.push((((start$5757=$5199(linelocs$5707,lineno$5754))),((end$5758=$5199(linelocs$5707,(lineno$5754+1)))),$6978(["+span"],[$6978(["lineno"],(lineno$5754+1)),$6978(["source"],highlight$5254(text$5706,[[start$5757,end$5758,[]]].concat(clamp$5256(spans$5709,start$5757,end$5758))))])));}}()))),acc$5723));});;(clamp$5256=function(spans$5769,bot$5770,top$5771){var $index$5791;var $length$5786;var temp$5781;var acc$5776;(acc$5776=[]);;(temp$5781=spans$5769);;($length$5786=temp$5781.length);;($index$5791=0);;$5773:for(;($index$5791<$length$5786);($index$5791++)){var start$5809;var end$5810;var attr$5811;var t0$5804;var t1$5805;var m$5799;(m$5799=temp$5781[$index$5791]);;(t0$5804=m$5799);if(((t0$5804 instanceof Array)&&((t1$5805=t0$5804.length),((t1$5805===3)&&((start$5809=t0$5804[0]),((end$5810=t0$5804[1]),((attr$5811=t0$5804[2]),((end$5810>=bot$5770)&&(start$5809<=top$5771))))))))){acc$5776.push([Math.max(start$5809,bot$5770),Math.min(end$5810,top$5771),attr$5811]);}else{false;;}}return acc$5776;});;(morsel$5257=function(spans$5824){var jump$5827;var jumptill$5828;var process_elements$5829;var thespans$5830;(jump$5827=function(active$5834,bot$5835,top$5836){var $index$5864;var $length$5859;var temp$5854;var acc$5849;var $index$5904;var $length$5899;var temp$5894;var e$5839;var attributes$5840;(e$5839=$5199(Math.min,[top$5836].concat((((acc$5849=[])),(((temp$5854=active$5834)),((($length$5859=temp$5854.length)),((($index$5864=0)),function(){$5846:for(;($index$5864<$length$5859);($index$5864++)){var x$5882;var t0$5877;var t1$5878;var m$5872;(m$5872=temp$5854[$index$5864]);;(t0$5877=m$5872);if(((t0$5877 instanceof Array)&&((t1$5878=t0$5877.length),(t1$5878===3)))){t0$5877[0];(x$5882=t0$5877[1]);t0$5877[2];acc$5849.push(x$5882);}else{$6774(m$5872,"/home/olivier/git/earl-grey/src/location.eg",3399,3442);;}}}()))),acc$5849))));;(attributes$5840=[]);;(temp$5894=active$5834);;($length$5899=temp$5894.length);;($index$5904=0);;$5841:for(;($index$5904<$length$5899);($index$5904++)){var X$5922;var t0$5917;var t1$5918;var m$5912;(m$5912=temp$5894[$index$5904]);;(t0$5917=m$5912);if(((t0$5917 instanceof Array)&&((t1$5918=t0$5917.length),(t1$5918===3)))){t0$5917[0];t0$5917[1];(X$5922=t0$5917[2]);(attributes$5840=attributes$5840.concat(X$5922));}else{$6774(m$5912,"/home/olivier/git/earl-grey/src/location.eg",3464,3505);;}}return [e$5839,[bot$5835,e$5839,attributes$5840]];});;(jumptill$5828=function(active$5932,bot$5933,top$5934){var t0$5943;var t1$5944;var $index$5969;var $length$5964;var temp$5959;var acc$5954;var t0$6000;var t1$6001;var newbot$5937;var span$5938;var newactive$5939;var spans$5940;var remainder$5941;if((bot$5933===top$5934)){return [[],active$5932];}else{(t0$5943=jump$5827(active$5932,bot$5933,top$5934));if(((t0$5943 instanceof Array)&&((t1$5944=t0$5943.length),(t1$5944===2)))){(newbot$5937=t0$5943[0]);(span$5938=t0$5943[1]);;}else{$6774(jump$5827(active$5932,bot$5933,top$5934),"/home/olivier/git/earl-grey/src/location.eg",3741,3775);}(newactive$5939=(((acc$5954=[])),(((temp$5959=active$5932)),((($length$5964=temp$5959.length)),((($index$5969=0)),function(){$5951:for(;($index$5969<$length$5964);($index$5969++)){var x$5987;var e$5988;var attr$5989;var t0$5982;var t1$5983;var m$5977;(m$5977=temp$5959[$index$5969]);;(t0$5982=m$5977);(x$5987=t0$5982);if(((t0$5982 instanceof Array)&&((t1$5983=t0$5982.length),((t1$5983===3)&&(t0$5982[0],((e$5988=t0$5982[1]),((attr$5989=t0$5982[2]),(e$5988>newbot$5937)))))))){acc$5954.push(x$5987);}else{false;;}}}()))),acc$5954));;(t0$6000=jumptill$5828(newactive$5939,newbot$5937,top$5934));if(((t0$6000 instanceof Array)&&((t1$6001=t0$6000.length),(t1$6001===2)))){(spans$5940=t0$6000[0]);(remainder$5941=t0$6000[1]);;}else{$6774(jumptill$5828(newactive$5939,newbot$5937,top$5934),"/home/olivier/git/earl-grey/src/location.eg",3890,3934);}return [[span$5938].concat(spans$5940),remainder$5941];}});;(process_elements$5829=function(start$6010,active$6011,rem$6012){var $index$6077;var $length$6072;var temp$6067;var acc$6062;var t0$6106;var t1$6107;var top$6054;var bot$6055;var spans$6056;var t0$6134;var t1$6135;var spans$6131;var newactive$6132;var start$6114;var active$6115;var next$6116;var target$6117;var end$6118;var attr$6119;var rest$6120;var start$6045;var active$6046;var $6015$6030;var $6016$6031;var $6017$6032;var t0$6024;var t1$6025;var t2$6026;var t3$6027;var t4$6028;var $6014$6019;($6014$6019=[start$6010,active$6011,rem$6012]);;if((($6015$6030=($6014$6019 instanceof Array))&&((t0$6024=$6014$6019.length),(($6017$6032=(t0$6024===3))&&($6014$6019[0],((t1$6025=$6014$6019[1]),((t1$6025 instanceof Array)&&((t2$6026=t1$6025.length),((t2$6026===0)&&((t3$6027=$6014$6019[2]),((t3$6027 instanceof Array)&&((t4$6028=t3$6027.length),(t4$6028===0))))))))))))){return [];}else{if(($6017$6032&&((start$6045=$6014$6019[0]),((active$6046=$6014$6019[1]),((t1$6025=$6014$6019[2]),((t1$6025 instanceof Array)&&((t2$6026=t1$6025.length),(t2$6026===0)))))))){(top$6054=$5199(Math.max,(((acc$6062=[])),(((temp$6067=active$6046)),((($length$6072=temp$6067.length)),((($index$6077=0)),function(){$6059:for(;($index$6077<$length$6072);($index$6077++)){var e$6095;var t0$6090;var t1$6091;var m$6085;(m$6085=temp$6067[$index$6077]);;(t0$6090=m$6085);if(((t0$6090 instanceof Array)&&((t1$6091=t0$6090.length),(t1$6091===3)))){t0$6090[0];(e$6095=t0$6090[1]);t0$6090[2];acc$6062.push(e$6095);}else{$6774(m$6085,"/home/olivier/git/earl-grey/src/location.eg",4119,4157);;}}}()))),acc$6062)));;(bot$6055=Math.min(start$6045,top$6054));;(t0$6106=jumptill$5828(active$6046,start$6045,top$6054));if(((t0$6106 instanceof Array)&&((t1$6107=t0$6106.length),(t1$6107===2)))){(spans$6056=t0$6106[0]);t0$6106[1];;}else{$6774(jumptill$5828(active$6046,start$6045,top$6054),"/home/olivier/git/earl-grey/src/location.eg",4210,4248);}return spans$6056;}else{if(($6017$6032&&((start$6114=$6014$6019[0]),((active$6115=$6014$6019[1]),((t1$6025=$6014$6019[2]),((t1$6025 instanceof Array)&&((t2$6026=t1$6025.length),((t2$6026>=1)&&((t3$6027=t1$6025[0]),((next$6116=t3$6027),((t3$6027 instanceof Array)&&((t4$6028=t3$6027.length),(t4$6028===3))))))))))))){(target$6117=t3$6027[0]);(end$6118=t3$6027[1]);(attr$6119=t3$6027[2]);(rest$6120=Array.prototype.slice.call(t1$6025,1));(t0$6134=jumptill$5828(active$6115,start$6114,target$6117));if(((t0$6134 instanceof Array)&&((t1$6135=t0$6134.length),(t1$6135===2)))){(spans$6131=t0$6134[0]);(newactive$6132=t0$6134[1]);;}else{$6774(jumptill$5828(active$6115,start$6114,target$6117),"/home/olivier/git/earl-grey/src/location.eg",4352,4393);}return spans$6131.concat(process_elements$5829(target$6117,[next$6116].concat(newactive$6132),rest$6120));}else{$6774($6014$6019);}}}});;(thespans$5830=spans$5824.sort(function($6145$6148,$6146$6149){var t0$6156;var t1$6157;var t0$6163;var t1$6164;var s1$6151;var e1$6152;var s2$6153;var e2$6154;(t0$6156=$6145$6148);if(((t0$6156 instanceof Array)&&((t1$6157=t0$6156.length),(t1$6157===3)))){(s1$6151=t0$6156[0]);(e1$6152=t0$6156[1]);t0$6156[2];;}else{$6774($6145$6148);}(t0$6163=$6146$6149);if(((t0$6163 instanceof Array)&&((t1$6164=t0$6163.length),(t1$6164===3)))){(s2$6153=t0$6163[0]);(e2$6154=t0$6163[1]);t0$6163[2];;}else{$6774($6146$6149);}if((s1$6151===s2$6153)){return (e1$6152-e2$6154);}else{return (s1$6151-s2$6153);}}));;return process_elements$5829(thespans$5830[0][0],[],thespans$5830);});;(highlight_locations$5258=function(){var $index$6208;var $length$6203;var temp$6198;var $index$6257;var $length$6252;var temp$6247;var acc$6242;var srcs$6190;var locations$6185;var context$6186;var t0$6181;var $6174$6176;($6174$6176=arguments);;(t0$6181=$6174$6176.length);if(((t0$6181>=1)&&(t0$6181<=2))){(locations$6185=$6174$6176[0]);(context$6186=function(){if((1>=t0$6181)){return 0;}else{return $6174$6176[1];}}());(srcs$6190=({}));;(temp$6198=locations$6185);;($length$6203=temp$6198.length);;($index$6208=0);;$6191:for(;($index$6208<$length$6203);($index$6208++)){var key$6232;var loc$6226;var cls$6227;var t0$6221;var t1$6222;var m$6216;(m$6216=temp$6198[$index$6208]);;(t0$6221=m$6216);if(((t0$6221 instanceof Array)&&((t1$6222=t0$6221.length),(t1$6222===2)))){(loc$6226=t0$6221[0]);(cls$6227=t0$6221[1]);(key$6232=String((loc$6226.source&&loc$6226.source.url)));;if((!$5199(srcs$6190,key$6232))){(srcs$6190[key$6232]=[]);}$5199(srcs$6190,key$6232).push([loc$6226,cls$6227]);}else{$6774(m$6216,"/home/olivier/git/earl-grey/src/location.eg",4739,4909);;}}return $6978(["+div"],(((acc$6242=[])),(((temp$6247=$7152(srcs$6190))),((($length$6252=temp$6247.length)),((($index$6257=0)),function(){$6239:for(;($index$6257<$length$6252);($index$6257++)){var locs$6275;var t0$6270;var t1$6271;var m$6265;(m$6265=temp$6247[$index$6257]);;(t0$6270=m$6265);if(((t0$6270 instanceof Array)&&((t1$6271=t0$6270.length),(t1$6271===2)))){t0$6270[0];(locs$6275=t0$6270[1]);acc$6242.push(highlight_locations_same_source$5259(locs$6275,context$6186));}else{$6774(m$6265,"/home/olivier/git/earl-grey/src/location.eg",4914,5008);;}}}()))),acc$6242));}else{$6774($6174$6176);}});;(highlight_locations_same_source$5259=function(){var $index$6329;var $length$6324;var temp$6319;var acc$6314;var t0$6359;var t1$6360;var $index$6389;var $length$6384;var temp$6379;var acc$6374;var $index$6432;var $length$6427;var temp$6422;var acc$6417;var loc$6303;var src$6304;var l1$6305;var l2$6306;var first$6307;var last$6308;var locations$6298;var context$6299;var t0$6294;var $6287$6289;($6287$6289=arguments);;(t0$6294=$6287$6289.length);if(((t0$6294>=1)&&(t0$6294<=2))){(locations$6298=$6287$6289[0]);(context$6299=function(){if((1>=t0$6294)){return 0;}else{return $6287$6289[1];}}());(loc$6303=merge_locations$5260((((acc$6314=[])),(((temp$6319=locations$6298)),((($length$6324=temp$6319.length)),((($index$6329=0)),function(){$6311:for(;($index$6329<$length$6324);($index$6329++)){var x$6347;var cls$6348;var t0$6342;var t1$6343;var m$6337;(m$6337=temp$6319[$index$6329]);;(t0$6342=m$6337);if(((t0$6342 instanceof Array)&&((t1$6343=t0$6342.length),(t1$6343===2)))){(x$6347=t0$6342[0]);(cls$6348=t0$6342[1]);acc$6314.push(x$6347);}else{$6774(m$6337,"/home/olivier/git/earl-grey/src/location.eg",5091,5119);;}}}()))),acc$6314)));;(src$6304=loc$6303.source);;(t0$6359=loc$6303.linerange());if(((t0$6359 instanceof Array)&&((t1$6360=t0$6359.length),(t1$6360===2)))){(l1$6305=t0$6359[0]);(l2$6306=t0$6359[1]);;}else{$6774(loc$6303.linerange(),"/home/olivier/git/earl-grey/src/location.eg",5155,5174);}(first$6307=Math.max(1,(l1$6305-context$6299)));;(last$6308=Math.min(src$6304.nlines,(l2$6306+context$6299)));;return $6978(["+div","location"],[$6978(["+div","source"],[$6978(["sourcefile"],(src$6304.url||"???")),(((acc$6374=[])),(((temp$6379=locations$6298)),((($length$6384=temp$6379.length)),((($index$6389=0)),function(){$6371:for(;($index$6389<$length$6384);($index$6389++)){var loc$6407;var cls$6408;var t0$6402;var t1$6403;var m$6397;(m$6397=temp$6379[$index$6389]);;(t0$6402=m$6397);if(((t0$6402 instanceof Array)&&((t1$6403=t0$6402.length),(t1$6403===2)))){(loc$6407=t0$6402[0]);(cls$6408=t0$6402[1]);acc$6374.push($6978([cls$6408,"sourcepos"],loc$6407.ref()));}else{$6774(m$6397,"/home/olivier/git/earl-grey/src/location.eg",5339,5409);;}}}()))),acc$6374)]),src$6304.highlight_lines(first$6307,last$6308,(((acc$6417=[])),(((temp$6422=locations$6298)),((($length$6427=temp$6422.length)),((($index$6432=0)),function(){$6414:for(;($index$6432<$length$6427);($index$6432++)){var loc$6450;var cls$6451;var t0$6445;var t1$6446;var m$6440;(m$6440=temp$6422[$index$6432]);;(t0$6445=m$6440);if(((t0$6445 instanceof Array)&&((t1$6446=t0$6445.length),(t1$6446===2)))){(loc$6450=t0$6445[0]);(cls$6451=t0$6445[1]);acc$6417.push([loc$6450.start,loc$6450.end,[cls$6451]]);}else{$6774(m$6440,"/home/olivier/git/earl-grey/src/location.eg",5464,5522);;}}}()))),acc$6417))]);}else{$6774($6287$6289);}});;(merge_locations$5260=function($6462$6464){var $index$6521;var $length$6516;var temp$6511;var acc$6506;var $index$6560;var $length$6555;var temp$6550;var acc$6545;var start$6499;var end$6500;var locs$6495;var loc$6490;var $6467$6481;var $6468$6482;var t0$6479;var $6466$6474;var ph$6469;(ph$6469=$6462$6464);;($6466$6474=ph$6469);;if((($6467$6481=($6466$6474 instanceof Array))&&((t0$6479=$6466$6474.length),(t0$6479===0)))){return Location$5253(null,0,0);}else{if(($6467$6481&&(t0$6479===1))){(loc$6490=$6466$6474[0]);return loc$6490;}else{if(($6467$6481&&(t0$6479>=0))){(locs$6495=Array.prototype.slice.call($6466$6474,0));(start$6499=$5199(Math.min,(((acc$6506=[])),(((temp$6511=locs$6495)),((($length$6516=temp$6511.length)),((($index$6521=0)),function(){$6503:for(;($index$6521<$length$6516);($index$6521++)){var loc$6537;var m$6529;(m$6529=temp$6511[$index$6521]);;(loc$6537=m$6529);acc$6506.push(loc$6537.start);}}()))),acc$6506)));;(end$6500=$5199(Math.max,(((acc$6545=[])),(((temp$6550=locs$6495)),((($length$6555=temp$6550.length)),((($index$6560=0)),function(){$6542:for(;($index$6560<$length$6555);($index$6560++)){var loc$6576;var m$6568;(m$6568=temp$6550[$index$6560]);;(loc$6576=m$6568);acc$6545.push(loc$6576.end);}}()))),acc$6545)));;return Location$5253(locs$6495[0].source,start$6499,end$6500);}else{$6774($6466$6474);}}}});;(__lt____lt____colon__$5261=function(x$6585,y$6586){if((!$5184(Location$5253)(x$6585.location))){(x$6585["location"]=function(){if(((!y$6586)||$5184(Location$5253)(y$6586))){return y$6586;}else{return y$6586.location;}}());}return x$6585;});;(__plus____plus____colon__$5262=function(x$6594,y$6595){var rval$6599;(x$6594=function(){if(((!x$6594)||$5184(Location$5253)(x$6594))){return x$6594;}else{return x$6594.location;}}());(y$6595=function(){if(((!y$6595)||$5184(Location$5253)(y$6595))){return y$6595;}else{return y$6595.location;}}());(rval$6599=false);;try{(rval$6599=merge_locations$5260([x$6594,y$6595]));}catch(excv$6605){var e$6611;(e$6611=excv$6605);(rval$6599=(void 0));}return rval$6599;});;(format_error$5263=function(){var $index$6687;var $length$6682;var temp$6677;var acc$6672;var hls$6662;var locs$6663;var rval$6740;var loc$6756;var data$6736;var other$6762;var url$6729;var start$6730;var end$6731;var loc$6723;var args$6656;var fmt_args$6647;var $6619$6643;var $6620$6644;var $6621$6645;var t0$6639;var t1$6640;var t2$6641;var e$6633;var context$6634;var $6618$6635;var t0$6628;var t1$6629;var $6617$6623;($6617$6623=arguments);;(t0$6628=$6617$6623.length);if(((t0$6628>=1)&&(t0$6628<=2))){(t1$6629=$6617$6623[0]);(e$6633=t1$6629);($6618$6635=t1$6629);(context$6634=function(){if((1>=t0$6628)){return 0;}else{return $6617$6623[1];}}());(fmt_args$6647=function(e$6651){if((e$6651.args&&e$6651.args.length)){return $6978(["error_args"],repr$5250(e$6651.args));}else{return "";}});;(t0$6639=$6618$6635);if(($5184($6787(["syntax"]))(t0$6639)&&($7167(t0$6639,"args")&&((t1$6640=t0$6639.args),((t1$6640 instanceof Array)&&((t2$6641=t1$6640.length),(t2$6641===1))))))){(args$6656=t1$6640[0]);(hls$6662=["hl1","hl2","hl3","hl4"]);;(locs$6663=(((acc$6672=[])),(((temp$6677=$6956($7152(args$6656)))),((($length$6682=temp$6677.length)),((($index$6687=0)),function(){$6669:for(;($index$6687<$length$6682);($index$6687++)){var i$6707;var key$6708;var arg$6709;var t0$6700;var t1$6701;var t2$6702;var t3$6703;var m$6695;(m$6695=temp$6677[$index$6687]);;(t0$6700=m$6695);if(((t0$6700 instanceof Array)&&((t1$6701=t0$6700.length),((t1$6701===2)&&((i$6707=t0$6700[0]),((t2$6702=t0$6700[1]),((t2$6702 instanceof Array)&&((t3$6703=t2$6702.length),((t3$6703===2)&&((key$6708=t2$6702[0]),((arg$6709=t2$6702[1]),(arg$6709&&arg$6709.location)))))))))))){acc$6672.push([arg$6709.location,$5199(hls$6662,(i$6707%4))]);}else{false;;}}}()))),acc$6672));;return $6978(["+div"],[$6978(["error"],[$6978(["error_type"],e$6633.name),$6978(["error_message"],e$6633.message)]),$6978(["error_args","syntax"],repr$5250(args$6656)),highlight_locations$5258(locs$6663,context$6634)]);}else{if((($6620$6644=$7167(t0$6639,"location"))&&((t1$6640=t0$6639.location),$5184(Location$5253)(t1$6640)))){(loc$6723=t1$6640);return $6978(["+div"],[$6978(["error"],[$6978(["error_type"],e$6633.name),$6978(["error_message"],e$6633.message)]),fmt_args$6647(e$6633),highlight_locations$5258([[loc$6723,"hl1"]],context$6634),$6978(["traceback"],(e$6633.stack||""))]);}else{if(($6620$6644&&((t1$6640 instanceof Array)&&((t2$6641=t1$6640.length),((t2$6641===4)&&(t1$6640[0]==="location")))))){(url$6729=t1$6640[1]);(start$6730=t1$6640[2]);(end$6731=t1$6640[3]);(data$6736=(((rval$6740=false)),(function(){try{(rval$6740=fs$5251.readFileSync(url$6729,"utf8"));}catch(excv$6746){var e$6752;(e$6752=excv$6746);(rval$6740=null);}}(),rval$6740)));;if(data$6736){(loc$6756=Location$5253(Source$5252(data$6736,url$6729),start$6730,end$6731));;return $6978(["+div"],[$6978(["error"],[$6978(["error_type"],e$6633.name),$6978(["error_message"],e$6633.message)]),fmt_args$6647(e$6633),highlight_locations$5258([[loc$6756,"hl1"]],context$6634),$6978(["traceback"],($6978([],e$6633.stack)||""))]);}else{return $6978(["+div"],[$6978(["error"],[$6978(["error_type"],e$6633.name),$6978(["error_message"],e$6633.message)]),fmt_args$6647(e$6633),$6978(["traceback"],($6978([],e$6633.stack)||e$6633))]);}}else{(other$6762=$6618$6635);return $6978(["+div"],[$6978(["error"],[$6978(["error_type"],e$6633.name),$6978(["error_message"],e$6633.message)]),fmt_args$6647(e$6633),$6978(["traceback"],$6978([],e$6633.stack))]);}}}}else{$6774($6617$6623);}});;(display_error$5264=function(e$6770){return __lt____gt__$5249(null,format_error$5263(e$6770));});;(exports["Source"]=Source$5252);(exports["Location"]=Location$5253);(exports["highlight"]=highlight$5254);(exports["highlight_locations"]=highlight_locations$5258);(exports["merge_locations"]=merge_locations$5260);(exports["<<:"]=__lt____lt____colon__$5261);(exports["++:"]=__plus____plus____colon__$5262);(exports["format_error"]=format_error$5263);(exports["display_error"]=display_error$5264);

},{"./pp":11,"./util":14,"fs":15}],8:[function(require,module,exports){
var $7366=function(type$7368){var f$7371;(f$7371=type$7368["::check"]);;if((f$7371===(void 0))){return function(value$7376){return (value$7376 instanceof type$7368);};}else{return function(value$7379){return f$7371.call(type$7368,value$7379);};}};
var $7381=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $7382=function(dest$7384,values$7385){var k$7390;(k$7390=null);$7388:for(k$7390 in values$7385){if(values$7385.hasOwnProperty(k$7390)){(dest$7384[k$7390]=values$7385[k$7390]);}}return dest$7384;};
var $7394=function($7395$7397){var ph$7401;(ph$7401=$7395$7397);;var $7399$7406;($7399$7406=ph$7401);;var bridge$7400$7411;var x$7415;(bridge$7400$7411=$7399$7406);if((((typeof(bridge$7400$7411)==="string")&&((x$7415=bridge$7400$7411),true))||((typeof(bridge$7400$7411)==="number")&&((x$7415=bridge$7400$7411),true)))){return ["value",x$7415];}else{var other$7422;(other$7422=$7399$7406);return other$7422["::serialize_ast"]();}};
var send$7206;(send$7206=function(obj$7211,$7209$7212){var ph$7216;var msg$7217;var t0$7219;(t0$7219=$7209$7212);(msg$7217=t0$7219);(ph$7216=t0$7219);;var $7214$7223;($7214$7223=ph$7216);;var bridge$7215$7228;(bridge$7215$7228=$7214$7223);if(((typeof(bridge$7215$7228)==="string")||(typeof(bridge$7215$7228)==="number"))){return obj$7211[msg$7217];}else{var other$7236;(other$7236=$7214$7223);return obj$7211["::send"](msg$7217);}});;(Array[":::project"]=function($7239$7241){var ph$7244;var value$7245;var t0$7247;(t0$7247=$7239$7241);(value$7245=t0$7247);(ph$7244=t0$7247);;var $7243$7251;($7243$7251=ph$7244);;if($7366(Array)($7243$7251)){return [true,value$7245];}else{$7243$7251;return [true,[value$7245]];}});(Array.prototype["::check"]=function(value$7265){if((value$7265 instanceof Array)){var i$7270;(i$7270=0);;$7268:for(;(i$7270<this.length);(i$7270++)){if(($7381(this,i$7270)!==$7381(value$7265,i$7270))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $7382(this.slice(0),this);});(Array.prototype[":::project"]=function(value$7281){if((value$7281 instanceof Array)){var i$7286;(i$7286=0);;$7284:for(;(i$7286<this.length);(i$7286++)){if(($7381(this,i$7286)!==$7381(value$7281,i$7286))){return [true,[value$7281]];}}return [true,value$7281.slice(this.length)];}else{return [true,[value$7281]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($7394));});(RegExp.prototype["::check"]=function($7296$7298){var ph$7301;(ph$7301=$7296$7298);;var $7300$7306;($7300$7306=ph$7301);;var value$7314;if((typeof($7300$7306)==="string")){(value$7314=$7300$7306);if(value$7314.match(this)){return true;}else{return false;}}else{var other$7319;(other$7319=$7300$7306);return false;}});(RegExp.prototype[":::project"]=function($7321$7323){var ph$7326;(ph$7326=$7321$7323);;var $7325$7331;($7325$7331=ph$7326);;var value$7339;if((typeof($7325$7331)==="string")){(value$7339=$7325$7331);var $7342$7344;($7342$7344=value$7339.match(this));;var m$7352;if(($7342$7344===null)){(m$7352=$7342$7344);return [false,null];}else{var m$7357;(m$7357=$7342$7344);return [true,m$7357];}}else{var other$7361;(other$7361=$7325$7331);return [false,null];}});(Function.prototype["::send"]=function(args$7364){return this.apply(this,args$7364);});
var $7865=function(arr$7867){var results$7871;var l$7872;(results$7871=[]);;(l$7872=arr$7867.length);;var i$7880;(i$7880=0);;$7870:for(;(i$7880<l$7872);(i$7880++)){results$7871.push([i$7880,$7381(arr$7867,i$7880)]);}return results$7871;};
var $7696=function(){var $7697$7699;($7697$7699=function(tags$7703){var it$0$7706;(it$0$7706=function(){if((!$7366($7697$7699)(this))){return Object.create($7697$7699.prototype);}else{return this;}}());;(it$0$7706["tags"]=tags$7703);return it$0$7706;});;($7697$7699.prototype["create"]=function(){var $7715$7717;($7715$7717=arguments);;var t0$7722;var message$7726;var args$7727;(t0$7722=$7715$7717.length);if((t0$7722>=0)){(message$7726=function(){if((0>=t0$7722)){return "";}else{return $7715$7717[0];}}());(args$7727=Array.prototype.slice.call($7715$7717,1));var it$0$7731;(it$0$7731=this);;var self$7736;(self$7736=this);;var e$7741;(e$7741=Error(message$7726));;(e$7741["::tags"]=it$0$7731.tags);(e$7741["args"]=args$7727);var temp$7749;(temp$7749=$7865(args$7727));;var $length$7754;($length$7754=temp$7749.length);;var $index$7759;($index$7759=0);;$7742:for(;($index$7759<$length$7754);($index$7759++)){var m$7767;(m$7767=temp$7749[$index$7759]);;var t0$7772;var t1$7773;var i$7777;var arg$7778;(t0$7772=m$7767);if(((t0$7772 instanceof Array)&&((t1$7773=t0$7772.length),(t1$7773===2)))){(i$7777=t0$7772[0]);(arg$7778=t0$7772[1]);(e$7741[i$7777]=arg$7778);}else{$7683(m$7767);;}}(e$7741["length"]=args$7727.length);(e$7741["name"]=["E"].concat(it$0$7731.tags).join("."));return e$7741;}else{$7683($7715$7717);}});($7697$7699.prototype["::check"]=function(e$7789){var it$0$7792;(it$0$7792=this);;var self$7797;(self$7797=this);;var tags$7802;if(((!e$7789)||(!$7366(Error)(e$7789)))){return false;}(tags$7802=(e$7789["::tags"]||[]));;var temp$7811;(temp$7811=it$0$7792.tags);;var $length$7816;($length$7816=temp$7811.length);;var $index$7821;($index$7821=0);;$7803:for(;($index$7821<$length$7816);($index$7821++)){var m$7829;(m$7829=temp$7811[$index$7821]);;var tag$7837;(tag$7837=m$7829);if((tags$7802.indexOf(tag$7837)===-1)){return false;}else{false;;}}return true;});($7697$7699.prototype["::deconstruct"]=function(e$7845){var it$0$7848;(it$0$7848=this);;var self$7853;(self$7853=this);;return e$7845.args;});$7382($7697$7699,$7382(function(){var accum$7858;(accum$7858=({}));(accum$7858["::name"]="$7697");return accum$7858;}(),function(){var accum$7862;(accum$7862=({}));(accum$7862["::egclass"]=true);return accum$7862;}()));return $7697$7699;}();
var $7683=function(value$7685,url$7686,start$7687,end$7688){var err$7691;(err$7691=$7696(["match"]).create("Could not find a match for value",({"value":value$7685})));;if(url$7686){(err$7691["location"]=["location",url$7686,start$7687,end$7688]);}throw err$7691;};var hoist$7426;var hoistable$7427;var not_hoistable$7428;var hoist_helper$7429;(hoist$7426=function(expr$7433){var t0$7439;var t1$7440;var b$7436;var inner$7437;(t0$7439=hoist_helper$7429(expr$7433));if(((t0$7439 instanceof Array)&&((t1$7440=t0$7439.length),(t1$7440===2)))){(b$7436=t0$7439[0]);(inner$7437=t0$7439[1]);;}else{$7683(hoist_helper$7429(expr$7433),"/home/olivier/git/earl-grey/src/opt.eg",50,72);}return ["scope",inner$7437,b$7436];});;(hoistable$7427=["send","array","object","multi","if","assign","js_break","js_continue","js_return","js_delete","js_throw","js_try","js_new"]);;(not_hoistable$7428=["void","js_while","js_for","js_for_in","js_label"]);;(hoist_helper$7429=function($7454$7456){var t0$7467;var x$7489;var x$7494;var bridge$7460$7486;var x$7499;var t0$7515;var t1$7516;var newbody$7512;var inner$7513;var t0$7531;var t1$7532;var newbody$7528;var inner$7529;var $index$7571;var $length$7566;var temp$7561;var acc$7556;var accum$7546;var newargs$7547;var $index$7630;var $length$7625;var temp$7620;var acc$7615;var newargs$7609;var other$7679;var type$7602;var args$7603;var type$7539;var args$7540;var vars$7523;var body$7524;var vars$7506;var body$7507;var $7461$7479;var $7462$7480;var $7463$7481;var bridge$7459$7476;var t0$7477;var $7458$7471;var ph$7464;var expr$7465;(t0$7467=$7454$7456);(expr$7465=t0$7467);(ph$7464=t0$7467);;($7458$7471=ph$7464);;(bridge$7459$7476=$7458$7471);if((((bridge$7460$7486=bridge$7459$7476),((((x$7489=bridge$7460$7486)),((x$7489 instanceof Array)&&(x$7489[0]==="symbol")))||(((x$7494=bridge$7460$7486)),((x$7494 instanceof Array)&&(x$7494[0]==="value")))))||(((x$7499=bridge$7459$7476)),((x$7499 instanceof Array)&&(x$7499[0]==="variable"))))){return [expr$7465,[]];}else{if((($7461$7479=($7458$7471 instanceof Array))&&((t0$7477=$7458$7471.length),(($7463$7481=(t0$7477===3))&&($7458$7471[0]==="scope"))))){(vars$7506=$7458$7471[1]);(body$7507=$7458$7471[2]);(t0$7515=hoist_helper$7429(body$7507));if(((t0$7515 instanceof Array)&&((t1$7516=t0$7515.length),(t1$7516===2)))){(newbody$7512=t0$7515[0]);(inner$7513=t0$7515[1]);;}else{$7683(hoist_helper$7429(body$7507),"/home/olivier/git/earl-grey/src/opt.eg",447,472);}return [newbody$7512,inner$7513.concat(vars$7506)];}else{if(($7463$7481&&($7458$7471[0]==="lambda"))){(vars$7523=$7458$7471[1]);(body$7524=$7458$7471[2]);(t0$7531=hoist_helper$7429(body$7524));if(((t0$7531 instanceof Array)&&((t1$7532=t0$7531.length),(t1$7532===2)))){(newbody$7528=t0$7531[0]);(inner$7529=t0$7531[1]);;}else{$7683(hoist_helper$7429(body$7524),"/home/olivier/git/earl-grey/src/opt.eg",581,606);}return [["lambda",vars$7523,["scope",inner$7529,newbody$7528]],[]];}else{if(($7461$7479&&(($7463$7481=(t0$7477>=1))&&((type$7539=$7458$7471[0]),((args$7540=Array.prototype.slice.call($7458$7471,1)),(hoistable$7427.indexOf(type$7539)!==-1)))))){(accum$7546=[]);;(newargs$7547=(((acc$7556=[])),(((temp$7561=args$7540)),((($length$7566=temp$7561.length)),((($index$7571=0)),function(){$7553:for(;($index$7571<$length$7566);($index$7571++)){var t0$7593;var t1$7594;var b$7590;var inner$7591;var arg$7587;var m$7579;(m$7579=temp$7561[$index$7571]);;(arg$7587=m$7579);acc$7556.push((((t0$7593=hoist_helper$7429(arg$7587)),function(){if(((t0$7593 instanceof Array)&&((t1$7594=t0$7593.length),(t1$7594===2)))){(b$7590=t0$7593[0]);(inner$7591=t0$7593[1]);}else{return $7683(hoist_helper$7429(arg$7587),"/home/olivier/git/earl-grey/src/opt.eg",779,806);}}()),(accum$7546=accum$7546.concat(inner$7591)),b$7590));}}()))),acc$7556));;return [[type$7539].concat(newargs$7547),accum$7546];}else{if(($7463$7481&&((type$7602=$7458$7471[0]),((args$7603=Array.prototype.slice.call($7458$7471,1)),(not_hoistable$7428.indexOf(type$7602)!==-1))))){(newargs$7609=(((acc$7615=[])),(((temp$7620=args$7603)),((($length$7625=temp$7620.length)),((($index$7630=0)),function(){$7612:for(;($index$7630<$length$7625);($index$7630++)){var t0$7653;var t1$7654;var other$7674;var t0$7665;var $7649$7660;var b$7650;var inner$7651;var arg$7646;var m$7638;(m$7638=temp$7620[$index$7630]);;(arg$7646=m$7638);acc$7615.push((((t0$7653=hoist_helper$7429(arg$7646)),function(){if(((t0$7653 instanceof Array)&&((t1$7654=t0$7653.length),(t1$7654===2)))){(b$7650=t0$7653[0]);(inner$7651=t0$7653[1]);}else{return $7683(hoist_helper$7429(arg$7646),"/home/olivier/git/earl-grey/src/opt.eg",981,1008);}}()),((($7649$7660=inner$7651)),function(){if((($7649$7660 instanceof Array)&&((t0$7665=$7649$7660.length),(t0$7665===0)))){return b$7650;}else{(other$7674=$7649$7660);return ["scope",inner$7651,b$7650];}}())));}}()))),acc$7615));;return [[type$7602].concat(newargs$7609),[]];}else{(other$7679=$7458$7471);throw $7696(["syntax","illegal"]).create("Illegal node -- this should not happen.",({"node":other$7679}));}}}}}});;(exports["hoist"]=hoist$7426);

},{}],9:[function(require,module,exports){
var $8048=function(type$8050){var f$8053;(f$8053=type$8050["::check"]);;if((f$8053===(void 0))){return function(value$8058){return (value$8058 instanceof type$8050);};}else{return function(value$8061){return f$8053.call(type$8050,value$8061);};}};
var $8063=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $8064=function(dest$8066,values$8067){var k$8072;(k$8072=null);$8070:for(k$8072 in values$8067){if(values$8067.hasOwnProperty(k$8072)){(dest$8066[k$8072]=values$8067[k$8072]);}}return dest$8066;};
var $8076=function($8077$8079){var ph$8083;(ph$8083=$8077$8079);;var $8081$8088;($8081$8088=ph$8083);;var bridge$8082$8093;var x$8097;(bridge$8082$8093=$8081$8088);if((((typeof(bridge$8082$8093)==="string")&&((x$8097=bridge$8082$8093),true))||((typeof(bridge$8082$8093)==="number")&&((x$8097=bridge$8082$8093),true)))){return ["value",x$8097];}else{var other$8104;(other$8104=$8081$8088);return other$8104["::serialize_ast"]();}};
var send$7888;(send$7888=function(obj$7893,$7891$7894){var ph$7898;var msg$7899;var t0$7901;(t0$7901=$7891$7894);(msg$7899=t0$7901);(ph$7898=t0$7901);;var $7896$7905;($7896$7905=ph$7898);;var bridge$7897$7910;(bridge$7897$7910=$7896$7905);if(((typeof(bridge$7897$7910)==="string")||(typeof(bridge$7897$7910)==="number"))){return obj$7893[msg$7899];}else{var other$7918;(other$7918=$7896$7905);return obj$7893["::send"](msg$7899);}});;(Array[":::project"]=function($7921$7923){var ph$7926;var value$7927;var t0$7929;(t0$7929=$7921$7923);(value$7927=t0$7929);(ph$7926=t0$7929);;var $7925$7933;($7925$7933=ph$7926);;if($8048(Array)($7925$7933)){return [true,value$7927];}else{$7925$7933;return [true,[value$7927]];}});(Array.prototype["::check"]=function(value$7947){if((value$7947 instanceof Array)){var i$7952;(i$7952=0);;$7950:for(;(i$7952<this.length);(i$7952++)){if(($8063(this,i$7952)!==$8063(value$7947,i$7952))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $8064(this.slice(0),this);});(Array.prototype[":::project"]=function(value$7963){if((value$7963 instanceof Array)){var i$7968;(i$7968=0);;$7966:for(;(i$7968<this.length);(i$7968++)){if(($8063(this,i$7968)!==$8063(value$7963,i$7968))){return [true,[value$7963]];}}return [true,value$7963.slice(this.length)];}else{return [true,[value$7963]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($8076));});(RegExp.prototype["::check"]=function($7978$7980){var ph$7983;(ph$7983=$7978$7980);;var $7982$7988;($7982$7988=ph$7983);;var value$7996;if((typeof($7982$7988)==="string")){(value$7996=$7982$7988);if(value$7996.match(this)){return true;}else{return false;}}else{var other$8001;(other$8001=$7982$7988);return false;}});(RegExp.prototype[":::project"]=function($8003$8005){var ph$8008;(ph$8008=$8003$8005);;var $8007$8013;($8007$8013=ph$8008);;var value$8021;if((typeof($8007$8013)==="string")){(value$8021=$8007$8013);var $8024$8026;($8024$8026=value$8021.match(this));;var m$8034;if(($8024$8026===null)){(m$8034=$8024$8026);return [false,null];}else{var m$8039;(m$8039=$8024$8026);return [true,m$8039];}}else{var other$8043;(other$8043=$8007$8013);return [false,null];}});(Function.prototype["::send"]=function(args$8046){return this.apply(this,args$8046);});
var $10111=function(arr$10113){var results$10117;var l$10118;(results$10117=[]);;(l$10118=arr$10113.length);;var i$10126;(i$10126=0);;$10116:for(;(i$10126<l$10118);(i$10126++)){results$10117.push([i$10126,$8063(arr$10113,i$10126)]);}return results$10117;};
var $9942=function(){var $9943$9945;($9943$9945=function(tags$9949){var it$0$9952;(it$0$9952=function(){if((!$8048($9943$9945)(this))){return Object.create($9943$9945.prototype);}else{return this;}}());;(it$0$9952["tags"]=tags$9949);return it$0$9952;});;($9943$9945.prototype["create"]=function(){var $9961$9963;($9961$9963=arguments);;var t0$9968;var message$9972;var args$9973;(t0$9968=$9961$9963.length);if((t0$9968>=0)){(message$9972=function(){if((0>=t0$9968)){return "";}else{return $9961$9963[0];}}());(args$9973=Array.prototype.slice.call($9961$9963,1));var it$0$9977;(it$0$9977=this);;var self$9982;(self$9982=this);;var e$9987;(e$9987=Error(message$9972));;(e$9987["::tags"]=it$0$9977.tags);(e$9987["args"]=args$9973);var temp$9995;(temp$9995=$10111(args$9973));;var $length$10000;($length$10000=temp$9995.length);;var $index$10005;($index$10005=0);;$9988:for(;($index$10005<$length$10000);($index$10005++)){var m$10013;(m$10013=temp$9995[$index$10005]);;var t0$10018;var t1$10019;var i$10023;var arg$10024;(t0$10018=m$10013);if(((t0$10018 instanceof Array)&&((t1$10019=t0$10018.length),(t1$10019===2)))){(i$10023=t0$10018[0]);(arg$10024=t0$10018[1]);(e$9987[i$10023]=arg$10024);}else{$9929(m$10013);;}}(e$9987["length"]=args$9973.length);(e$9987["name"]=["E"].concat(it$0$9977.tags).join("."));return e$9987;}else{$9929($9961$9963);}});($9943$9945.prototype["::check"]=function(e$10035){var it$0$10038;(it$0$10038=this);;var self$10043;(self$10043=this);;var tags$10048;if(((!e$10035)||(!$8048(Error)(e$10035)))){return false;}(tags$10048=(e$10035["::tags"]||[]));;var temp$10057;(temp$10057=it$0$10038.tags);;var $length$10062;($length$10062=temp$10057.length);;var $index$10067;($index$10067=0);;$10049:for(;($index$10067<$length$10062);($index$10067++)){var m$10075;(m$10075=temp$10057[$index$10067]);;var tag$10083;(tag$10083=m$10075);if((tags$10048.indexOf(tag$10083)===-1)){return false;}else{false;;}}return true;});($9943$9945.prototype["::deconstruct"]=function(e$10091){var it$0$10094;(it$0$10094=this);;var self$10099;(self$10099=this);;return e$10091.args;});$8064($9943$9945,$8064(function(){var accum$10104;(accum$10104=({}));(accum$10104["::name"]="$9943");return accum$10104;}(),function(){var accum$10108;(accum$10108=({}));(accum$10108["::egclass"]=true);return accum$10108;}()));return $9943$9945;}();
var $9929=function(value$9931,url$9932,start$9933,end$9934){var err$9937;(err$9937=$9942(["match"]).create("Could not find a match for value",({"value":value$9931})));;if(url$9932){(err$9937["location"]=["location",url$9932,start$9933,end$9934]);}throw err$9937;};
var $10133=function(obj$10135){var results$10139;(results$10139=[]);;var k$10144;(k$10144=null);$10138:for(k$10144 in obj$10135){if(Object.prototype.hasOwnProperty.call(obj$10135,k$10144)){results$10139.push([k$10144,$8063(obj$10135,k$10144)]);}}return results$10139;};
var $10148=function(arrays$10150){var results$10153;(results$10153=[]);;var temp$10161;(temp$10161=arrays$10150);;var $length$10166;($length$10166=temp$10161.length);;var $index$10171;($index$10171=0);;$10154:for(;($index$10171<$length$10166);($index$10171++)){var m$10179;(m$10179=temp$10161[$index$10171]);;var a$10187;(a$10187=m$10179);(results$10153=results$10153.concat(a$10187));}return results$10153;};
var $10189=function(type$10191){return function(value$10194){var f$10197;(f$10197=type$10191[":::project"]);;if((f$10197===(void 0))){(f$10197=type$10191["::project"]);if((f$10197===(void 0))){return [true,type$10191(value$10194)];}else{var rval$10203;(rval$10203=false);;try{(rval$10203=[true,f$10197(value$10194)]);}catch(excv$10209){var e$10215;(e$10215=excv$10209);(rval$10203=[false,null]);}return rval$10203;}}else{return f$10197.call(type$10191,value$10194);}};};var accum$8524;var accum$8528;var accum$8710;var accum$9057;var accum$9061;var accum$9225;var accum$9229;var accum$9233;var accum$9237;var accum$9241;var accum$9248;var accum$9252;var accum$9256;var accum$9260;var accum$9264;var eg_groups$9070;var eg_prio$9071;var $8108$8109;var __lt____lt____colon__$8110;var __plus____plus____colon__$8111;var transform$8112;var OperatorGroups$8113;var parse_op_description$8114;var eg_groups$8115;var SimplePriority$8116;var MAX$8117;var eg_order$8118;var DONE$8119;var NONE$8120;var LEFT$8121;var RIGHT$8122;var BOTH$8123;var oparse$8124;var finalize$8125;var parse$8126;($8108$8109=require("./location"));;(__lt____lt____colon__$8110=$8108$8109["<<:"]);;(__plus____plus____colon__$8111=$8108$8109["++:"]);;(transform$8112=function(expr$8139,cb$8140){var rval$8154;var tr$8143;var result$8144;(tr$8143=function(x$8148){return transform$8112(x$8148,cb$8140);});;(result$8144=(((rval$8154=false)),(function(){try{(rval$8154=cb$8140.call(tr$8143,expr$8139));}catch(excv$8160){var name$8200;var args$8201;var v$8195;var s$8190;var $8169$8180;var $8170$8181;var $8171$8182;var t0$8178;var $8168$8173;var e$8166;(e$8166=excv$8160);(rval$8154=((($8168$8173=expr$8139)),function(){if((($8169$8180=($8168$8173 instanceof Array))&&((t0$8178=$8168$8173.length),((t0$8178===1)&&($8168$8173[0]==="void"))))){return ["void"];}else{if(($8169$8180&&(($8171$8182=(t0$8178===2))&&($8168$8173[0]==="symbol")))){(s$8190=$8168$8173[1]);return expr$8139;}else{if(($8171$8182&&($8168$8173[0]==="value"))){(v$8195=$8168$8173[1]);return expr$8139;}else{if(($8169$8180&&(t0$8178>=1))){(name$8200=$8168$8173[0]);(args$8201=Array.prototype.slice.call($8168$8173,1));return [name$8200].concat(args$8201.map(tr$8143));}else{$9929($8168$8173);}}}}}()));}}(),rval$8154)));;return __lt____lt____colon__$8110(result$8144,expr$8139);});;(OperatorGroups$8113=function(groups$8211){var $index$8244;var $length$8239;var temp$8234;var acc$8229;var $index$8286;var $length$8281;var temp$8276;var acc$8271;var $index$8363;var $length$8358;var temp$8353;var acc$8348;var itg$8220;var it$0$8214;(it$0$8214=function(){if((!$8048(OperatorGroups$8113)(this))){return Object.create(OperatorGroups$8113.prototype);}else{return this;}}());;(itg$8220=$10133(groups$8211));;(it$0$8214["gnames"]=(((acc$8229=[])),(((temp$8234=itg$8220)),((($length$8239=temp$8234.length)),((($index$8244=0)),function(){$8226:for(;($index$8244<$length$8239);($index$8244++)){var name$8262;var t0$8257;var t1$8258;var m$8252;(m$8252=temp$8234[$index$8244]);;(t0$8257=m$8252);if(((t0$8257 instanceof Array)&&((t1$8258=t0$8257.length),(t1$8258===2)))){(name$8262=t0$8257[0]);t0$8257[1];acc$8229.push(name$8262);}else{$9929(m$8252,"/home/olivier/git/earl-grey/src/parse.eg",504,530);;}}}()))),acc$8229));(it$0$8214["groups"]=(((acc$8271=[])),(((temp$8276=itg$8220)),((($length$8281=temp$8276.length)),((($index$8286=0)),function(){$8268:for(;($index$8286<$length$8281);($index$8286++)){var $index$8327;var $length$8322;var temp$8317;var acc$8312;var name$8304;var descrs$8305;var t0$8299;var t1$8300;var m$8294;(m$8294=temp$8276[$index$8286]);;(t0$8299=m$8294);if(((t0$8299 instanceof Array)&&((t1$8300=t0$8299.length),(t1$8300===2)))){(name$8304=t0$8299[0]);(descrs$8305=t0$8299[1]);acc$8271.push($10148((((acc$8312=[])),(((temp$8317=descrs$8305)),((($length$8322=temp$8317.length)),((($index$8327=0)),function(){$8309:for(;($index$8327<$length$8322);($index$8327++)){var descr$8343;var m$8335;(m$8335=temp$8317[$index$8327]);;(descr$8343=m$8335);acc$8312.push(parse_op_description$8114(descr$8343));}}()))),acc$8312)));}else{$9929(m$8294,"/home/olivier/git/earl-grey/src/parse.eg",548,645);;}}}()))),acc$8271));(it$0$8214["fns"]=[]);(it$0$8214["to_gid"]=({"IFX":({"wide":({}),"short":({})}),"PFX":({"wide":({}),"short":({})}),"SFX":({"wide":({}),"short":({})})}));(acc$8348=[]);;(temp$8353=$10111(it$0$8214.groups));;($length$8358=temp$8353.length);;($index$8363=0);;$8221:for(;($index$8363<$length$8358);($index$8363++)){var $index$8404;var $length$8399;var temp$8394;var acc$8389;var i$8381;var group$8382;var t0$8376;var t1$8377;var m$8371;(m$8371=temp$8353[$index$8363]);;(t0$8376=m$8371);if(((t0$8376 instanceof Array)&&((t1$8377=t0$8376.length),(t1$8377===2)))){(i$8381=t0$8376[0]);(group$8382=t0$8376[1]);acc$8348.push((((acc$8389=[])),(((temp$8394=group$8382)),((($length$8399=temp$8394.length)),((($index$8404=0)),function(){$8386:for(;($index$8404<$length$8399);($index$8404++)){var f$8430;var fixity$8422;var width$8423;var name$8424;var t0$8417;var t1$8418;var m$8412;(m$8412=temp$8394[$index$8404]);;(t0$8417=m$8412);if(((t0$8417 instanceof Array)&&((t1$8418=t0$8417.length),(t1$8418===3)))){(fixity$8422=t0$8417[0]);(width$8423=t0$8417[1]);(name$8424=t0$8417[2]);acc$8389.push(($8063($8063(it$0$8214.to_gid,fixity$8422),width$8423)[name$8424]=i$8381));}else{(f$8430=m$8412);acc$8389.push(it$0$8214.fns.push([f$8430,i$8381]));}}}()))),acc$8389));}else{$9929(m$8371,"/home/olivier/git/earl-grey/src/parse.eg",812,1014);;}}acc$8348;return it$0$8214;});;(OperatorGroups$8113.prototype["get_name"]=function(o$8438){var self$8446;var it$0$8441;(it$0$8441=this);;(self$8446=this);;return $8063(it$0$8441.gnames,it$0$8441.get(o$8438));});(OperatorGroups$8113.prototype["get"]=function($8452$8454){var t0$8461;var t1$8462;var $index$8497;var $length$8492;var temp$8487;var attempt$8478;var self$8473;var it$0$8468;var o$8456;var fixity$8457;var width$8458;var name$8459;(t0$8461=$8452$8454);(o$8456=t0$8461);if(((t0$8461 instanceof Array)&&((t1$8462=t0$8461.length),(t1$8462===3)))){(fixity$8457=t0$8461[0]);(width$8458=t0$8461[1]);(name$8459=t0$8461[2]);;}else{$9929($8452$8454);}(it$0$8468=this);;(self$8473=this);;(attempt$8478=$8063($8063($8063(it$0$8468.to_gid,fixity$8457),width$8458),name$8459));;if((attempt$8478===(void 0))){(temp$8487=it$0$8468.fns);;($length$8492=temp$8487.length);;($index$8497=0);;$8483:for(;($index$8497<$length$8492);($index$8497++)){var f$8515;var i$8516;var t0$8510;var t1$8511;var m$8505;(m$8505=temp$8487[$index$8497]);;(t0$8510=m$8505);if(((t0$8510 instanceof Array)&&((t1$8511=t0$8510.length),(t1$8511===2)))){(f$8515=t0$8510[0]);(i$8516=t0$8510[1]);if(f$8515(o$8456)){return i$8516;}}else{$9929(m$8505,"/home/olivier/git/earl-grey/src/parse.eg",1193,1276);;}}throw $9942(["syntax","unknown_operator"]).create(("Unknown operator: "+[true,String(o$8456)][1]),({"operator":o$8456}));}else{return attempt$8478;}});$8064(OperatorGroups$8113,$8064(((accum$8524=({})),((accum$8524["::name"]="OperatorGroups"),accum$8524)),((accum$8528=({})),((accum$8528["::egclass"]=true),accum$8528))));OperatorGroups$8113;(parse_op_description$8114=function($8533$8535){var otherwise$8600;var $8581$8589;var $8580$8583;var otherwise$8625;var $8606$8614;var $8605$8608;var t0$8577;var t1$8578;var fixity$8574;var short$8575;var other$8629;var x$8564;var w1$8565;var op$8566;var w2$8567;var y$8568;var f$8559;var rx$8553;var t0$8548;var t1$8549;var t2$8550;var $8537$8543;var ph$8538;(ph$8538=$8533$8535);;($8537$8543=ph$8538);;(rx$8553=RegExp("(?:^((?:X?))((?:[ _]?))((?:[^ _Y]*))((?:[ _]?))((?:Y?))$)",""));;if($8048(Function)($8537$8543)){(f$8559=$8537$8543);return f$8559;}else{(t0$8548=$10189(rx$8553)($8537$8543));if((t0$8548[0]&&((t1$8549=t0$8548[1]),((t2$8550=t1$8549.length),(t2$8550===6))))){t1$8549[0];(x$8564=t1$8549[1]);(w1$8565=t1$8549[2]);(op$8566=t1$8549[3]);(w2$8567=t1$8549[4]);(y$8568=t1$8549[5]);(t0$8577=((($8580$8583=null)),($8580$8583,function(){if((x$8564==="")){return ["PFX",(w2$8567==="")];}else{if((y$8568==="")){return ["SFX",(w1$8565==="")];}else{(otherwise$8600=$8580$8583);return ["IFX",((w1$8565==="")||(w2$8567===""))];}}}())));if(((t0$8577 instanceof Array)&&((t1$8578=t0$8577.length),(t1$8578===2)))){(fixity$8574=t0$8577[0]);(short$8575=t0$8577[1]);;}else{$9929(((($8605$8608=null)),($8605$8608,function(){if((x$8564==="")){return ["PFX",(w2$8567==="")];}else{if((y$8568==="")){return ["SFX",(w1$8565==="")];}else{(otherwise$8625=$8605$8608);return ["IFX",((w1$8565==="")||(w2$8567===""))];}}}())),"/home/olivier/git/earl-grey/src/parse.eg",1647,1865);}if(((w1$8565==="_")||(w2$8567==="_"))){return [[fixity$8574,"short",op$8566],[fixity$8574,"wide",op$8566]];}else{return [[fixity$8574,function(){if(short$8575){return "short";}else{return "wide";}}(),op$8566]];}}else{(other$8629=$8537$8543);throw $9942(["invalid_op_description"]).create(("Invalid operator description: "+other$8629));}}});;(eg_groups$8115=OperatorGroups$8113($8064(({"tokenpfx":[".Y","#Y","@Y"],"sjuxt":["XWHITEY"],"ifx":[function($8634$8636){var t0$8649;var $8638$8644;var ph$8639;(ph$8639=$8634$8636);;($8638$8644=ph$8639);;if((($8638$8644 instanceof Array)&&((t0$8649=$8638$8644.length),((t0$8649===3)&&(($8638$8644[0]==="IFX")&&($8638$8644[1]==="short")))))){$8638$8644[2];return true;}else{$8638$8644;return false;}}],"pfx":[function($8659$8661){var t0$8674;var $8663$8669;var ph$8664;(ph$8664=$8659$8661);;($8663$8669=ph$8664);;if((($8663$8669 instanceof Array)&&((t0$8674=$8663$8669.length),((t0$8674===3)&&(($8663$8669[0]==="PFX")&&($8663$8669[1]==="short")))))){$8663$8669[2];return true;}else{$8663$8669;return false;}}],"sfx":[function($8684$8686){var t0$8699;var $8688$8694;var ph$8689;(ph$8689=$8684$8686);;($8688$8694=ph$8689);;if((($8688$8694 instanceof Array)&&((t0$8699=$8688$8694.length),((t0$8699===3)&&(($8688$8694[0]==="SFX")&&($8688$8694[1]==="short")))))){$8688$8694[2];return true;}else{$8688$8694;return false;}}],"pow":["X ** Y"],"mul":["X * Y","X / Y","X // Y","X mod Y","+ Y","- Y"],"add":["X + Y","X - Y"],"cmp":["X < Y","X <= Y","X == Y","X > Y","X >= Y","X != Y"],"cat":["X ++ Y"],"union":["X & Y"],"range":["X .. Y","X ..",".. Y"],"in":["X in Y"],"wjuxt":["X WHITE Y"],"colon":["X_:_Y"],"and":"X and Y","or":"X or Y","not":"not Y"}),$8064(((accum$8710=({})),((accum$8710["with"]=["X with Y"]),accum$8710)),({"decl":["X -> Y","X = Y","X := Y","X => Y","X where Y","X when Y","X each Y"],"brack":["X_,_Y","(_Y","[_Y","{_Y","X_)","X_]","X_}"],"custom":[function(x$8714){return true;}]})))));;(SimplePriority$8116=function(groups$8720,priorities$8721){var $index$8756;var $length$8751;var temp$8746;var acc$8741;var _i$8730;var tracks$8731;var it$0$8724;(it$0$8724=function(){if((!$8048(SimplePriority$8116)(this))){return Object.create(SimplePriority$8116.prototype);}else{return this;}}());;(it$0$8724["groups"]=groups$8720);(_i$8730=0);;(tracks$8731=({}));;(it$0$8724["prio"]=(((acc$8741=[])),(((temp$8746=groups$8720.gnames)),((($length$8751=temp$8746.length)),((($index$8756=0)),function(){$8738:for(;($index$8756<$length$8751);($index$8756++)){var t0$8782;var t1$8783;var t2$8784;var t3$8785;var t4$8786;var t5$8787;var t6$8788;var t7$8789;var $index$8824;var $length$8819;var temp$8814;var acc$8809;var $index$8910;var $length$8905;var temp$8900;var acc$8895;var t0$8803;var t1$8804;var ltracks$8775;var lp$8776;var rtracks$8777;var rp$8778;var lt$8779;var rt$8780;var name$8772;var m$8764;(m$8764=temp$8746[$index$8756]);;(name$8772=m$8764);acc$8741.push((((t0$8782=$8063(priorities$8721,name$8772)),function(){if(((t0$8782 instanceof Array)&&((t1$8783=t0$8782.length),((t1$8783===2)&&((t2$8784=t0$8782[0]),((t2$8784 instanceof Array)&&((t3$8785=t2$8784.length),((t3$8785===2)&&((t4$8786=$10189(Array)(t2$8784[0])),(t4$8786[0]&&((ltracks$8775=t4$8786[1]),((lp$8776=t2$8784[1]),((t5$8787=t0$8782[1]),((t5$8787 instanceof Array)&&((t6$8788=t5$8787.length),((t6$8788===2)&&((t7$8789=$10189(Array)(t5$8787[0])),t7$8789[0]))))))))))))))))){(rtracks$8777=t7$8789[1]);(rp$8778=t5$8787[1]);}else{return $9929($8063(priorities$8721,name$8772),"/home/olivier/git/earl-grey/src/parse.eg",3552,3578);}}()),((t0$8803=(((acc$8809=[])),(((temp$8814=[ltracks$8775,rtracks$8777])),((($length$8819=temp$8814.length)),((($index$8824=0)),function(){$8806:for(;($index$8824<$length$8819);($index$8824++)){var $index$8861;var $length$8856;var temp$8851;var rval$8843;var tr$8840;var m$8832;(m$8832=temp$8814[$index$8824]);;(tr$8840=m$8832);acc$8809.push((((rval$8843=0)),(((temp$8851=tr$8840)),((($length$8856=temp$8851.length)),((($index$8861=0)),function(){$8844:for(;($index$8861<$length$8856);($index$8861++)){var t$8887;var t$8881;var m$8869;(m$8869=temp$8851[$index$8861]);;if((m$8869==="all")){(rval$8843=(Math.pow(2,31)-1));}else{(t$8881=m$8869);if((!$8063(tracks$8731,t$8881))){(rval$8843=(rval$8843|Math.pow(2,_i$8730)));(tracks$8731[t$8881]=(_i$8730++));}else{(t$8887=m$8869);(rval$8843=(rval$8843|Math.pow(2,$8063(tracks$8731,t$8887))));}}}}()))),rval$8843));}}()))),acc$8809)),function(){if(((t0$8803 instanceof Array)&&((t1$8804=t0$8803.length),(t1$8804===2)))){(lt$8779=t0$8803[0]);(rt$8780=t0$8803[1]);}else{return $9929((((acc$8895=[])),(((temp$8900=[ltracks$8775,rtracks$8777])),((($length$8905=temp$8900.length)),((($index$8910=0)),function(){$8892:for(;($index$8910<$length$8905);($index$8910++)){var $index$8947;var $length$8942;var temp$8937;var rval$8929;var tr$8926;var m$8918;(m$8918=temp$8900[$index$8910]);;(tr$8926=m$8918);acc$8895.push((((rval$8929=0)),(((temp$8937=tr$8926)),((($length$8942=temp$8937.length)),((($index$8947=0)),function(){$8930:for(;($index$8947<$length$8942);($index$8947++)){var t$8973;var t$8967;var m$8955;(m$8955=temp$8937[$index$8947]);;if((m$8955==="all")){(rval$8929=(Math.pow(2,31)-1));}else{(t$8967=m$8955);if((!$8063(tracks$8731,t$8967))){(rval$8929=(rval$8929|Math.pow(2,_i$8730)));(tracks$8731[t$8967]=(_i$8730++));}else{(t$8973=m$8955);(rval$8929=(rval$8929|Math.pow(2,$8063(tracks$8731,t$8973))));}}}}()))),rval$8929));}}()))),acc$8895),"/home/olivier/git/earl-grey/src/parse.eg",3588,3909);}}()),[[lt$8779,lp$8776],[rt$8780,rp$8778]]));}}()))),acc$8741));return it$0$8724;});;(SimplePriority$8116.prototype["compare"]=function(op1$8979,op2$8980){var t0$9008;var t1$9009;var t2$9010;var t3$9011;var t0$9020;var t1$9021;var t2$9022;var t3$9023;var $8994$9037;var $8993$9031;var i1$8995;var i2$8996;var code1$8997;var ord1$8998;var code2$8999;var ord2$9000;var self$8988;var it$0$8983;(it$0$8983=this);;(self$8988=this);;(i1$8995=it$0$8983.groups.get(op1$8979));;(i2$8996=it$0$8983.groups.get(op2$8980));;(t0$9008=$8063(it$0$8983.prio,i1$8995));if(((t0$9008 instanceof Array)&&((t1$9009=t0$9008.length),((t1$9009===2)&&(t0$9008[0],((t2$9010=t0$9008[1]),((t2$9010 instanceof Array)&&((t3$9011=t2$9010.length),(t3$9011===2))))))))){(code1$8997=t2$9010[0]);(ord1$8998=t2$9010[1]);;}else{$9929($8063(it$0$8983.prio,i1$8995),"/home/olivier/git/earl-grey/src/parse.eg",4036,4053);}(t0$9020=$8063(it$0$8983.prio,i2$8996));if(((t0$9020 instanceof Array)&&((t1$9021=t0$9020.length),((t1$9021===2)&&((t2$9022=t0$9020[0]),((t2$9022 instanceof Array)&&((t3$9023=t2$9022.length),(t3$9023===2)))))))){(code2$8999=t2$9022[0]);(ord2$9000=t2$9022[1]);t0$9020[1];;}else{$9929($8063(it$0$8983.prio,i2$8996),"/home/olivier/git/earl-grey/src/parse.eg",4073,4090);}($8993$9031=null);;$8993$9031;if(((code1$8997&code2$8999)===0)){throw $9942(["syntax","order"]).create("Cannot mix operators in the given order",({"left":op1$8979,"right":op2$8980}));}else{if((ord1$8998>ord2$9000)){return LEFT$8121;}else{if((ord1$8998<ord2$9000)){return RIGHT$8122;}else{if((ord1$8998===ord2$9000)){return BOTH$8123;}else{$9929($8993$9031);}}}}});$8064(SimplePriority$8116,$8064(((accum$9057=({})),((accum$9057["::name"]="SimplePriority"),accum$9057)),((accum$9061=({})),((accum$9061["::egclass"]=true),accum$9061))));SimplePriority$8116;(MAX$8117=(1/0));;(eg_order$8118=(((eg_groups$9070=OperatorGroups$8113($8064(({"sh_ifx":[function($9074$9076){var t0$9089;var $9078$9084;var ph$9079;(ph$9079=$9074$9076);;($9078$9084=ph$9079);;if((($9078$9084 instanceof Array)&&((t0$9089=$9078$9084.length),((t0$9089===3)&&(($9078$9084[0]==="IFX")&&($9078$9084[1]==="short")))))){$9078$9084[2];return true;}else{$9078$9084;return false;}}],"sh_pfx":[function($9099$9101){var t0$9114;var $9103$9109;var ph$9104;(ph$9104=$9099$9101);;($9103$9109=ph$9104);;if((($9103$9109 instanceof Array)&&((t0$9114=$9103$9109.length),((t0$9114===3)&&(($9103$9109[0]==="PFX")&&($9103$9109[1]==="short")))))){$9103$9109[2];return true;}else{$9103$9109;return false;}}],"sh_sfx":[function($9124$9126){var t0$9139;var $9128$9134;var ph$9129;(ph$9129=$9124$9126);;($9128$9134=ph$9129);;if((($9128$9134 instanceof Array)&&((t0$9139=$9128$9134.length),((t0$9139===3)&&(($9128$9134[0]==="SFX")&&($9128$9134[1]==="short")))))){$9128$9134[2];return true;}else{$9128$9134;return false;}}],"wi_ifx":[function($9149$9151){var t0$9164;var $9153$9159;var ph$9154;(ph$9154=$9149$9151);;($9153$9159=ph$9154);;if((($9153$9159 instanceof Array)&&((t0$9164=$9153$9159.length),((t0$9164===3)&&(($9153$9159[0]==="IFX")&&($9153$9159[1]==="wide")))))){$9153$9159[2];return true;}else{$9153$9159;return false;}}],"wi_pfx":[function($9174$9176){var t0$9189;var $9178$9184;var ph$9179;(ph$9179=$9174$9176);;($9178$9184=ph$9179);;if((($9178$9184 instanceof Array)&&((t0$9189=$9178$9184.length),((t0$9189===3)&&(($9178$9184[0]==="PFX")&&($9178$9184[1]==="wide")))))){$9178$9184[2];return true;}else{$9178$9184;return false;}}],"wi_sfx":[function($9199$9201){var t0$9214;var $9203$9209;var ph$9204;(ph$9204=$9199$9201);;($9203$9209=ph$9204);;if((($9203$9209 instanceof Array)&&((t0$9214=$9203$9209.length),((t0$9214===3)&&(($9203$9209[0]==="SFX")&&($9203$9209[1]==="wide")))))){$9203$9209[2];return true;}else{$9203$9209;return false;}}],"comma":["X_,_Y"],"obrack":["(_Y","[_Y","{_Y"],"cbrack":["X_)","X_]","X_}"]}),$8064(((accum$9225=({})),((accum$9225["with"]=["X with Y"]),accum$9225)),$8064(({"lowprio":["X each Y","X each? Y","X where Y","X !! Y","X -> Y","X => Y","X = Y","X := Y","X += Y","X -= Y","X *= Y","X /= Y","X <<= Y","X >>= Y","X >>>= Y","X ++= Y","X ?= Y","X or= Y","X and= Y","X each= Y","X % Y"]}),$8064(((accum$9229=({})),((accum$9229["when"]=["X when Y"]),accum$9229)),$8064(((accum$9233=({})),((accum$9233["or"]=["X or Y"]),accum$9233)),$8064(((accum$9237=({})),((accum$9237["and"]=["X and Y"]),accum$9237)),$8064(((accum$9241=({})),((accum$9241["not"]=["not Y"]),accum$9241)),({"cmp":["X == Y","X != Y","X >= Y","X <= Y","X > Y","X < Y"],"binxor":["X ^. Y"],"binor":["X |. Y"],"binand":["X &. Y"],"shift":["X << Y","X >> Y","X >>> Y"],"add":["X + Y","X - Y"],"mul":["X * Y","X / Y","X // Y","X mod Y"],"exp":["X ** Y"],"sjuxt":["XWHITEY"],"wjuxt":["X WHITE Y"],"colon":["X_:_Y"],"pfx":["._Y","#_Y","@_Y"],"when2":["when Y"],"pp":["<> Y"],"pipe":["X |> Y"]}))))))))))),((eg_prio$9071=$8064(({"comma":[["all",1],["all",1]],"obrack":[["all",MAX$8117],["all",1]],"cbrack":[["all",1],["all",MAX$8117]]}),$8064(((accum$9248=({})),((accum$9248["with"]=[["all",1999],["all",10]]),accum$9248)),$8064(({"lowprio":[["all",11],["all",10]]}),$8064(((accum$9252=({})),((accum$9252["when"]=[["all",100],["all",101]]),accum$9252)),$8064(((accum$9256=({})),((accum$9256["or"]=[["all",110],["all",111]]),accum$9256)),$8064(((accum$9260=({})),((accum$9260["and"]=[["all",120],["all",121]]),accum$9260)),$8064(((accum$9264=({})),((accum$9264["not"]=[["all",MAX$8117],["all",131]]),accum$9264)),({"cmp":[["all",200],["all",201]],"binxor":[["all",400],["all",401]],"binor":[["all",410],["all",411]],"binand":[["all",420],["all",421]],"shift":[["arith",500],["arith",501]],"add":[["arith",550],["arith",551]],"mul":[["arith",560],["arith",561]],"exp":[["arith",571],["arith",570]],"wjuxt":[["all",13],["all",12]],"colon":[["all",12],["all",10]],"sjuxt":[["all",2000],["all",2001]],"pfx":[["all",MAX$8117],["all",3000]],"pp":[["all",MAX$8117],["all",5]],"when2":[["all",MAX$8117],["all",101]],"pipe":[["pipe",550],["pipe",551]],"sh_ifx":[["all",1800],["all",1801]],"sh_pfx":[["all",MAX$8117],["all",1901]],"sh_sfx":[["all",1900],["all",MAX$8117]],"wi_ifx":[["customl",900],["customr",901]],"wi_pfx":[["all",MAX$8117],["all",901]],"wi_sfx":[["all",900],["all",MAX$8117]]})))))))))),SimplePriority$8116(eg_groups$9070,eg_prio$9071)));;(DONE$8119=-1);;(NONE$8120=0);;(LEFT$8121=1);;(RIGHT$8122=2);;(BOTH$8123=3);;(oparse$8124=function(next$9287,order$9288,finalize$9289){var between$9292;var right_op$9293;var stack$9294;var left_op$9295;var current$9296;(between$9292=finalize$9289(next$9287()));;(right_op$9293=next$9287());;(stack$9294=[]);;(left_op$9295=null);;(current$9296=null);;$9297:while(true){var v$9337;var other$9353;var $9316$9322;var o$9317;(o$9317=function(){if(((!left_op$9295)&&(!right_op$9293))){return DONE$8119;}else{return ((((!left_op$9295)&&RIGHT$8122)||((!right_op$9293)&&LEFT$8121))||order$9288(left_op$9295,right_op$9293));}}());;($9316$9322=o$9317);;if(($9316$9322===DONE$8119)){return between$9292;}else{if(($9316$9322===LEFT$8121)){current$9296.push(between$9292);(between$9292=finalize$9289(current$9296));(v$9337=stack$9294.pop());;(left_op$9295=v$9337[0]);(current$9296=v$9337[1]);}else{if(($9316$9322===RIGHT$8122)){stack$9294.push([left_op$9295,current$9296]);(left_op$9295=right_op$9293);(current$9296=[[right_op$9293],between$9292]);(between$9292=finalize$9289(next$9287()));(right_op$9293=next$9287());}else{if(($9316$9322===BOTH$8123)){current$9296[0].push(right_op$9293);current$9296.push(between$9292);(left_op$9295=right_op$9293);(between$9292=finalize$9289(next$9287()));(right_op$9293=next$9287());}else{(other$9353=$9316$9322);throw $9942(["should_never_happen"]).create("undefined priority",({"left":left_op$9295,"right":right_op$9293}));}}}}}});;(finalize$8125=function($9358$9360){var t0$9369;var $index$9446;var $length$9441;var temp$9436;var $index$9476;var $length$9471;var temp$9466;var $index$9515;var $length$9510;var temp$9505;var acc$9500;var other$9743;var args$9738;var f$9726;var orig_args$9727;var args$9728;var $9701$9713;var $9702$9714;var t0$9709;var t1$9710;var t2$9711;var $9700$9704;var inserted$9596;var result$9597;var f$9754;var other$9813;var x$9806;var $9787$9797;var $9788$9798;var t0$9795;var $9786$9790;var result$9751;var f$9821;var oloc$9888;var abloc$9889;var oabloc$9890;var rval$9891;var a$9883;var b$9884;var $9413$9868;var $9414$9869;var $9415$9870;var $9416$9871;var t0$9861;var t1$9862;var t2$9863;var t3$9864;var t4$9865;var t5$9866;var other$9908;var $9412$9857;var target$9582;var _b$9583;var body$9584;var f$9574;var body$9575;var f$9562;var arg$9563;var body$9564;var $9417$9553;var $9418$9554;var $9419$9555;var $9420$9556;var $9421$9557;var $9422$9558;var $9423$9559;var t0$9542;var t1$9543;var t2$9544;var t3$9545;var t4$9546;var t5$9547;var t6$9548;var t7$9549;var t8$9550;var bridge$9411$9551;var $9410$9537;var sumloc$9424;var orig_ops$9425;var op$9426;var other$9912;var ops$9405;var args$9406;var value$9396;var value$9391;var value$9385;var $9363$9380;var $9364$9381;var $9365$9382;var t0$9378;var $9362$9373;var ph$9366;var token$9367;(t0$9369=$9358$9360);(token$9367=t0$9369);(ph$9366=t0$9369);;($9362$9373=ph$9366);;if((($9363$9380=($9362$9373 instanceof Array))&&((t0$9378=$9362$9373.length),(($9365$9382=(t0$9378===2))&&($9362$9373[0]==="ID"))))){(value$9385=$9362$9373[1]);return __lt____lt____colon__$8110(["symbol",value$9385],token$9367);}else{if(($9365$9382&&($9362$9373[0]==="NUM"))){(value$9391=$9362$9373[1]);return __lt____lt____colon__$8110(["value",value$9391],token$9367);}else{if(($9365$9382&&($9362$9373[0]==="STR"))){(value$9396=$9362$9373[1]);return __lt____lt____colon__$8110(["value",value$9396],token$9367);}else{if(($9363$9380&&((t0$9378===1)&&($9362$9373[0]==="VOID")))){return __lt____lt____colon__$8110(["void"],token$9367);}else{if(($9363$9380&&(t0$9378>=1))){(ops$9405=$9362$9373[0]);(args$9406=Array.prototype.slice.call($9362$9373,1));(sumloc$9424=ops$9405[0].location);;(temp$9436=ops$9405.slice(1));;($length$9441=temp$9436.length);;($index$9446=0);;$9427:for(;($index$9446<$length$9441);($index$9446++)){var op$9462;var m$9454;(m$9454=temp$9436[$index$9446]);;(op$9462=m$9454);(sumloc$9424=__plus____plus____colon__$8111(sumloc$9424,op$9462));}(temp$9466=args$9406);;($length$9471=temp$9466.length);;($index$9476=0);;$9429:for(;($index$9476<$length$9471);($index$9476++)){var arg$9492;var m$9484;(m$9484=temp$9466[$index$9476]);;(arg$9492=m$9484);(sumloc$9424=__plus____plus____colon__$8111(sumloc$9424,arg$9492));}(orig_ops$9425=ops$9405);;(ops$9405=(((acc$9500=[])),(((temp$9505=ops$9405)),((($length$9510=temp$9505.length)),((($index$9515=0)),function(){$9497:for(;($index$9515<$length$9510);($index$9515++)){var o$9531;var m$9523;(m$9523=temp$9505[$index$9515]);;(o$9531=m$9523);acc$9500.push(o$9531[2]);}}()))),acc$9500));(op$9426=ops$9405[0]);;($9410$9537=[ops$9405,args$9406]);;if((($9417$9553=($9410$9537 instanceof Array))&&((t0$9542=$9410$9537.length),(($9419$9555=(t0$9542===2))&&((t1$9543=$9410$9537[0]),(($9421$9557=(t1$9543 instanceof Array))&&((t2$9544=t1$9543.length),((t2$9544===2)&&((t1$9543[0]==="WHITE")&&((t1$9543[1]===":")&&((t3$9545=$9410$9537[1]),((t3$9545 instanceof Array)&&((t4$9546=t3$9545.length),(t4$9546===3)))))))))))))){(f$9562=t3$9545[0]);(arg$9563=t3$9545[1]);(body$9564=t3$9545[2]);return __lt____lt____colon__$8110(["send",f$9562,__lt____lt____colon__$8110(["data",arg$9563,body$9564],__plus____plus____colon__$8111(arg$9563,body$9564))],sumloc$9424);}else{if(($9421$9557&&(($9423$9559=(t2$9544===1))&&((t1$9543[0]===":")&&((t3$9545=$9410$9537[1]),((t3$9545 instanceof Array)&&((t4$9546=t3$9545.length),(t4$9546===2)))))))){(f$9574=t3$9545[0]);(body$9575=t3$9545[1]);return __lt____lt____colon__$8110(["send",f$9574,__lt____lt____colon__$8110(["data",body$9575],body$9575)],sumloc$9424);}else{if(($9423$9559&&((t1$9543[0]==="with")&&((t3$9545=$9410$9537[1]),((t3$9545 instanceof Array)&&((t4$9546=t3$9545.length),((t4$9546===2)&&((target$9582=t3$9545[0]),((t5$9547=t3$9545[1]),((_b$9583=t5$9547),((t6$9548=$10189(["multi"])(t5$9547)),(t6$9548[0]&&((t7$9549=t6$9548[1]),((t8$9550=t7$9549.length),(t8$9550>=0))))))))))))))){(body$9584=Array.prototype.slice.call(t7$9549,0));(inserted$9596=false);;(result$9597=transform$8112(target$9582,function($9603$9605){var t0$9611;var $index$9671;var $length$9666;var temp$9661;var tr$9649;var res$9650;var args$9644;var x$9632;var f$9633;var a$9634;var b$9635;var t0$9620;var t1$9621;var t2$9622;var $9607$9615;var ph$9608;var expr$9609;(t0$9611=$9603$9605);(expr$9609=t0$9611);(ph$9608=t0$9611);;($9607$9615=ph$9608);;if((($9607$9615 instanceof Array)&&((t0$9620=$9607$9615.length),((t0$9620===2)&&(($9607$9615[0]==="symbol")&&($9607$9615[1]==="...")))))){(inserted$9596=true);return __lt____lt____colon__$8110(["multi"].concat(body$9584),_b$9583);}else{(x$9632=$9607$9615);if((x$9632.fromop&&(($9607$9615 instanceof Array)&&((t0$9620=$9607$9615.length),((t0$9620===3)&&(($9607$9615[0]==="send")&&((f$9633=$9607$9615[1]),((t1$9621=$9607$9615[2]),((t1$9621 instanceof Array)&&((t2$9622=t1$9621.length),((t2$9622===3)&&(t1$9621[0]==="data")))))))))))){(a$9634=t1$9621[1]);(b$9635=t1$9621[2]);return ["send",this(f$9633),__lt____lt____colon__$8110(["data",this(a$9634),this(b$9635)],__plus____plus____colon__$8111(a$9634,b$9635))];}else{if((($9607$9615 instanceof Array)&&((t0$9620=$9607$9615.length),((t0$9620>=1)&&($9607$9615[0]==="data"))))){(args$9644=Array.prototype.slice.call($9607$9615,1));(tr$9649=this);;(res$9650=["data"]);;(temp$9661=args$9644);;($length$9666=temp$9661.length);;($index$9671=0);;$9651:for(;($index$9671<$length$9666);($index$9671++)){var other$9695;var t0$9684;var t1$9685;var m$9679;(m$9679=temp$9661[$index$9671]);;(t0$9684=m$9679);if(((t0$9684 instanceof Array)&&((t1$9685=t0$9684.length),((t1$9685===2)&&((t0$9684[0]==="symbol")&&(t0$9684[1]==="...")))))){(inserted$9596=true);(res$9650=res$9650.concat(body$9584));}else{(other$9695=m$9679);res$9650.push(__lt____lt____colon__$8110(tr$9649(other$9695),other$9695));}}return __lt____lt____colon__$8110(res$9650,expr$9609);}else{$9929($9607$9615);}}}}));;if((!inserted$9596)){($9700$9704=target$9582);;if((($9700$9704 instanceof Array)&&((t0$9709=$9700$9704.length),((t0$9709===1)&&($9700$9704[0]==="void"))))){return __lt____lt____colon__$8110(["data"].concat(body$9584),sumloc$9424);}else{$9700$9704;if(target$9582.fromop){return __lt____lt____colon__$8110(["send",target$9582,__lt____lt____colon__$8110(["data"].concat(body$9584),_b$9583)],sumloc$9424);}else{if((($9701$9713=($9700$9704 instanceof Array))&&((t0$9709=$9700$9704.length),((t0$9709===3)&&(($9700$9704[0]==="send")&&((f$9726=$9700$9704[1]),((t1$9710=$9700$9704[2]),((orig_args$9727=t1$9710),((t1$9710 instanceof Array)&&((t2$9711=t1$9710.length),((t2$9711>=1)&&(t1$9710[0]==="data")))))))))))){(args$9728=Array.prototype.slice.call(t1$9710,1));return __lt____lt____colon__$8110(["send",f$9726,__lt____lt____colon__$8110(["data"].concat(args$9728).concat(body$9584),__plus____plus____colon__$8111(orig_args$9727,_b$9583))],sumloc$9424);}else{if(($9701$9713&&((t0$9709>=1)&&($9700$9704[0]==="data")))){(args$9738=Array.prototype.slice.call($9700$9704,1));return __lt____lt____colon__$8110(target$9582.concat(body$9584),sumloc$9424);}else{(other$9743=$9700$9704);return __lt____lt____colon__$8110(["send",target$9582,__lt____lt____colon__$8110(["data"].concat(body$9584),_b$9583)],sumloc$9424);}}}}}else{return __lt____lt____colon__$8110(result$9597,sumloc$9424);}}else{if(($9421$9557&&(($9423$9559=(t2$9544>=1))&&((bridge$9411$9551=t1$9543[0]),((bridge$9411$9551==="[")||(bridge$9411$9551===",")))))){Array.prototype.slice.call(t1$9543,1);$9410$9537[1];if((op$9426==="[")){(args$9406=args$9406.slice(1,-1));}(args$9406=(((f$9754=function($9757$9759){var other$9781;var t0$9772;var $9761$9767;var ph$9762;(ph$9762=$9757$9759);;($9761$9767=ph$9762);;if((($9761$9767 instanceof Array)&&((t0$9772=$9761$9767.length),((t0$9772===1)&&($9761$9767[0]==="void"))))){return false;}else{(other$9781=$9761$9767);return true;}})),args$9406.filter(f$9754)));(result$9751=((($9786$9790=args$9406)),function(){if((($9787$9797=($9786$9790 instanceof Array))&&((t0$9795=$9786$9790.length),(t0$9795===0)))){return ["value",(void 0)];}else{if(($9787$9797&&(t0$9795===1))){(x$9806=$9786$9790[0]);if(((!isNaN(sumloc$9424.start))&&(!isNaN(sumloc$9424.end)))){(x$9806["location"]=sumloc$9424);}return x$9806;}else{(other$9813=$9786$9790);return ["multi"].concat(args$9406);}}}()));;return __lt____lt____colon__$8110(result$9751,sumloc$9424);}else{if(($9423$9559&&(t1$9543[0]==="{"))){Array.prototype.slice.call(t1$9543,1);$9410$9537[1];(f$9821=function($9824$9826){var other$9848;var t0$9839;var $9828$9834;var ph$9829;(ph$9829=$9824$9826);;($9828$9834=ph$9829);;if((($9828$9834 instanceof Array)&&((t0$9839=$9828$9834.length),((t0$9839===1)&&($9828$9834[0]==="void"))))){return false;}else{(other$9848=$9828$9834);return true;}});;return __lt____lt____colon__$8110(["data"].concat(args$9406.slice(1,-1).filter(f$9821)),sumloc$9424);}else{if(($9421$9557&&(($9423$9559=(t2$9544===1))&&(t1$9543[0]==="WHITE")))){$9410$9537[1];return __lt____lt____colon__$8110(["send"].concat(args$9406),sumloc$9424);}else{if($9423$9559){t1$9543[0];($9412$9857=$9410$9537[1]);(t0$9861=$9412$9857);if((($9414$9869=(t0$9861 instanceof Array))&&((t1$9862=t0$9861.length),(($9416$9871=(t1$9862===2))&&((t2$9863=t0$9861[0]),((t2$9863 instanceof Array)&&((t3$9864=t2$9863.length),((t3$9864===1)&&((t2$9863[0]==="void")&&((t4$9865=t0$9861[1]),((t4$9865 instanceof Array)&&((t5$9866=t4$9865.length),((t5$9866===1)&&(t4$9865[0]==="void")))))))))))))){return __lt____lt____colon__$8110(["symbol",op$9426],orig_ops$9425[0]);}else{if($9416$9871){(a$9883=t0$9861[0]);(b$9884=t0$9861[1]);(oloc$9888=orig_ops$9425[0].location);;(abloc$9889=__plus____plus____colon__$8111(a$9883,b$9884));;(oabloc$9890=__plus____plus____colon__$8111(orig_ops$9425[0],abloc$9889));;(rval$9891=__lt____lt____colon__$8110(["send",__lt____lt____colon__$8110(["symbol",op$9426],oloc$9888),__lt____lt____colon__$8110(["data",a$9883,b$9884],abloc$9889)],__plus____plus____colon__$8111(oloc$9888,abloc$9889)));;(rval$9891["fromop"]=true);return rval$9891;}else{$9929($9412$9857,"/home/olivier/git/earl-grey/src/parse.eg",17040,17045);}}}else{(other$9908=$9410$9537);throw $9942(["should_never_happen"]).create("unknown node",({"node":token$9367}));}}}}}}}}else{(other$9912=$9362$9373);throw $9942(["should_never_happen"]).create("unknown node (B)",({"node":token$9367}));}}}}}});;(parse$8126=function(tokens$9918){var next$9921;(next$9921=function(){return tokens$9918.shift();});;return oparse$8124(next$9921,eg_order$8118.compare.bind(eg_order$8118),finalize$8125);});;(exports["parse"]=parse$8126);(exports["oparse"]=oparse$8124);(exports["finalize"]=finalize$8125);(exports["DONE"]=DONE$8119);(exports["NONE"]=NONE$8120);(exports["LEFT"]=LEFT$8121);(exports["RIGHT"]=RIGHT$8122);(exports["BOTH"]=BOTH$8123);

},{"./location":7}],10:[function(require,module,exports){
var $10378=function(type$10380){var f$10383;(f$10383=type$10380["::check"]);;if((f$10383===(void 0))){return function(value$10388){return (value$10388 instanceof type$10380);};}else{return function(value$10391){return f$10383.call(type$10380,value$10391);};}};
var $10393=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $10394=function(dest$10396,values$10397){var k$10402;(k$10402=null);$10400:for(k$10402 in values$10397){if(values$10397.hasOwnProperty(k$10402)){(dest$10396[k$10402]=values$10397[k$10402]);}}return dest$10396;};
var $10406=function($10407$10409){var ph$10413;(ph$10413=$10407$10409);;var $10411$10418;($10411$10418=ph$10413);;var bridge$10412$10423;var x$10427;(bridge$10412$10423=$10411$10418);if((((typeof(bridge$10412$10423)==="string")&&((x$10427=bridge$10412$10423),true))||((typeof(bridge$10412$10423)==="number")&&((x$10427=bridge$10412$10423),true)))){return ["value",x$10427];}else{var other$10434;(other$10434=$10411$10418);return other$10434["::serialize_ast"]();}};
var send$10218;(send$10218=function(obj$10223,$10221$10224){var ph$10228;var msg$10229;var t0$10231;(t0$10231=$10221$10224);(msg$10229=t0$10231);(ph$10228=t0$10231);;var $10226$10235;($10226$10235=ph$10228);;var bridge$10227$10240;(bridge$10227$10240=$10226$10235);if(((typeof(bridge$10227$10240)==="string")||(typeof(bridge$10227$10240)==="number"))){return obj$10223[msg$10229];}else{var other$10248;(other$10248=$10226$10235);return obj$10223["::send"](msg$10229);}});;(Array[":::project"]=function($10251$10253){var ph$10256;var value$10257;var t0$10259;(t0$10259=$10251$10253);(value$10257=t0$10259);(ph$10256=t0$10259);;var $10255$10263;($10255$10263=ph$10256);;if($10378(Array)($10255$10263)){return [true,value$10257];}else{$10255$10263;return [true,[value$10257]];}});(Array.prototype["::check"]=function(value$10277){if((value$10277 instanceof Array)){var i$10282;(i$10282=0);;$10280:for(;(i$10282<this.length);(i$10282++)){if(($10393(this,i$10282)!==$10393(value$10277,i$10282))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $10394(this.slice(0),this);});(Array.prototype[":::project"]=function(value$10293){if((value$10293 instanceof Array)){var i$10298;(i$10298=0);;$10296:for(;(i$10298<this.length);(i$10298++)){if(($10393(this,i$10298)!==$10393(value$10293,i$10298))){return [true,[value$10293]];}}return [true,value$10293.slice(this.length)];}else{return [true,[value$10293]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($10406));});(RegExp.prototype["::check"]=function($10308$10310){var ph$10313;(ph$10313=$10308$10310);;var $10312$10318;($10312$10318=ph$10313);;var value$10326;if((typeof($10312$10318)==="string")){(value$10326=$10312$10318);if(value$10326.match(this)){return true;}else{return false;}}else{var other$10331;(other$10331=$10312$10318);return false;}});(RegExp.prototype[":::project"]=function($10333$10335){var ph$10338;(ph$10338=$10333$10335);;var $10337$10343;($10337$10343=ph$10338);;var value$10351;if((typeof($10337$10343)==="string")){(value$10351=$10337$10343);var $10354$10356;($10354$10356=value$10351.match(this));;var m$10364;if(($10354$10356===null)){(m$10364=$10354$10356);return [false,null];}else{var m$10369;(m$10369=$10354$10356);return [true,m$10369];}}else{var other$10373;(other$10373=$10337$10343);return [false,null];}});(Function.prototype["::send"]=function(args$10376){return this.apply(this,args$10376);});
var $13382=function(arr$13384){var results$13388;var l$13389;(results$13388=[]);;(l$13389=arr$13384.length);;var i$13397;(i$13397=0);;$13387:for(;(i$13397<l$13389);(i$13397++)){results$13388.push([i$13397,$10393(arr$13384,i$13397)]);}return results$13388;};
var $13404=function(value$13406,url$13407,start$13408,end$13409){var err$13412;(err$13412=$13213(["match"]).create("Could not find a match for value",({"value":value$13406})));;if(url$13407){(err$13412["location"]=["location",url$13407,start$13408,end$13409]);}throw err$13412;};
var $13213=function(){var $13214$13216;($13214$13216=function(tags$13220){var it$0$13223;(it$0$13223=function(){if((!$10378($13214$13216)(this))){return Object.create($13214$13216.prototype);}else{return this;}}());;(it$0$13223["tags"]=tags$13220);return it$0$13223;});;($13214$13216.prototype["create"]=function(){var $13232$13234;($13232$13234=arguments);;var t0$13239;var message$13243;var args$13244;(t0$13239=$13232$13234.length);if((t0$13239>=0)){(message$13243=function(){if((0>=t0$13239)){return "";}else{return $13232$13234[0];}}());(args$13244=Array.prototype.slice.call($13232$13234,1));var it$0$13248;(it$0$13248=this);;var self$13253;(self$13253=this);;var e$13258;(e$13258=Error(message$13243));;(e$13258["::tags"]=it$0$13248.tags);(e$13258["args"]=args$13244);var temp$13266;(temp$13266=$13382(args$13244));;var $length$13271;($length$13271=temp$13266.length);;var $index$13276;($index$13276=0);;$13259:for(;($index$13276<$length$13271);($index$13276++)){var m$13284;(m$13284=temp$13266[$index$13276]);;var t0$13289;var t1$13290;var i$13294;var arg$13295;(t0$13289=m$13284);if(((t0$13289 instanceof Array)&&((t1$13290=t0$13289.length),(t1$13290===2)))){(i$13294=t0$13289[0]);(arg$13295=t0$13289[1]);(e$13258[i$13294]=arg$13295);}else{$13404(m$13284);;}}(e$13258["length"]=args$13244.length);(e$13258["name"]=["E"].concat(it$0$13248.tags).join("."));return e$13258;}else{$13404($13232$13234);}});($13214$13216.prototype["::check"]=function(e$13306){var it$0$13309;(it$0$13309=this);;var self$13314;(self$13314=this);;var tags$13319;if(((!e$13306)||(!$10378(Error)(e$13306)))){return false;}(tags$13319=(e$13306["::tags"]||[]));;var temp$13328;(temp$13328=it$0$13309.tags);;var $length$13333;($length$13333=temp$13328.length);;var $index$13338;($index$13338=0);;$13320:for(;($index$13338<$length$13333);($index$13338++)){var m$13346;(m$13346=temp$13328[$index$13338]);;var tag$13354;(tag$13354=m$13346);if((tags$13319.indexOf(tag$13354)===-1)){return false;}else{false;;}}return true;});($13214$13216.prototype["::deconstruct"]=function(e$13362){var it$0$13365;(it$0$13365=this);;var self$13370;(self$13370=this);;return e$13362.args;});$10394($13214$13216,$10394(function(){var accum$13375;(accum$13375=({}));(accum$13375["::name"]="$13214");return accum$13375;}(),function(){var accum$13379;(accum$13379=({}));(accum$13379["::egclass"]=true);return accum$13379;}()));return $13214$13216;}();
var $13489=function($13490$13492,key$13493){var ph$13497;(ph$13497=$13490$13492);;var $13495$13502;($13495$13502=ph$13497);;var bridge$13496$13507;(bridge$13496$13507=$13495$13502);if(((bridge$13496$13507===null)||(bridge$13496$13507===(void 0)))){return false;}else{var x$13515;if((typeof($13495$13502)==="string")){(x$13515=$13495$13502);return (key$13493 in String.prototype);}else{var x$13520;if((typeof($13495$13502)==="number")){(x$13520=$13495$13502);return (key$13493 in Number.prototype);}else{var x$13525;(x$13525=$13495$13502);return (key$13493 in x$13525);}}}};
var $13433=function($13434$13436){var ph$13442;var x$13443;var t0$13445;(t0$13445=$13434$13436);(x$13443=t0$13445);(ph$13442=t0$13445);;var $13438$13449;($13438$13449=ph$13442);;var bridge$13439$13454;(bridge$13439$13454=$13438$13449);if((function(){var bridge$13440$13460;(bridge$13440$13460=bridge$13439$13454);return (function(){var bridge$13441$13463;(bridge$13441$13463=bridge$13440$13460);return ((bridge$13441$13463===(void 0))||(bridge$13441$13463===null));}()||(typeof(bridge$13440$13460)==="string"));}()||(typeof(bridge$13439$13454)==="number"))){return x$13443;}else{if($13489($13438$13449,"::clone")){$13438$13449["::clone"];return x$13443["::clone"]();}else{$13438$13449;if((Object.getPrototypeOf(x$13443)===Object.prototype)){var dest$13476;(dest$13476=({}));;var k$13481;(k$13481=null);$13475:for(k$13481 in x$13443){if(Object.prototype.hasOwnProperty.call(x$13443,k$13481)){(dest$13476[k$13481]=x$13443[k$13481]);}}return dest$13476;}else{var other$13487;(other$13487=$13438$13449);throw $13213(["clone"]).create("Object cannot be cloned",({"obj":x$13443}));}}}};
var $13417=function(a$13419,b$13420){var dest$13424;(dest$13424=$13433(a$13419));;var k$13429;(k$13429=null);$13423:for(k$13429 in b$13420){if(Object.prototype.hasOwnProperty.call(b$13420,k$13429)){(dest$13424[k$13429]=b$13420[k$13429]);}}return dest$13424;};
var $13527=Object.keys;
var $13528=function(type$13530){return function(value$13533){var f$13536;(f$13536=type$13530[":::project"]);;if((f$13536===(void 0))){(f$13536=type$13530["::project"]);if((f$13536===(void 0))){return [true,type$13530(value$13533)];}else{var rval$13542;(rval$13542=false);;try{(rval$13542=[true,f$13536(value$13533)]);}catch(excv$13548){var e$13554;(e$13554=excv$13548);(rval$13542=[false,null]);}return rval$13542;}}else{return f$13536.call(type$13530,value$13533);}};};
var $13556=function(xs$13558,ys$13559){var acc$13564;(acc$13564=[]);;var temp$13569;(temp$13569=$13382(xs$13558));;var $length$13574;($length$13574=temp$13569.length);;var $index$13579;($index$13579=0);;$13561:for(;($index$13579<$length$13574);($index$13579++)){var m$13587;(m$13587=temp$13569[$index$13579]);;var t0$13592;var t1$13593;var i$13597;var x$13598;(t0$13592=m$13587);if(((t0$13592 instanceof Array)&&((t1$13593=t0$13592.length),(t1$13593===2)))){(i$13597=t0$13592[0]);(x$13598=t0$13592[1]);acc$13564.push([x$13598,$10393(ys$13559,i$13597)]);}else{$13404(m$13587);;}}return acc$13564;};
var $13604=function(from$13606,to$13607){var rval$13611;(rval$13611=[]);;var i$13616;(i$13616=from$13606);;$13610:for(;(i$13616<=to$13607);(i$13616++)){rval$13611.push(i$13616);}return rval$13611;};var accum$11151;var accum$11155;var accum$11757;var accum$11761;var $10438$10442;var __lt____gt__$10443;var $10439$10444;var __lt____lt____colon__$10445;var util$10446;var GenSym$10447;var gensym$10448;var neighbours$10449;var classify$10450;var classify_contiguous$10451;var identity$10452;var $10441$10453;var checker_db$10454;var PatternParser$10455;var PatternProcessor$10456;var assemble_conditions$10457;var assemble_pattern$10458;var inject_below_uses$10459;var parse_pattern$10460;var checkall$10461;var same_block$10462;var parse_clauses$10463;var opt_clauses$10464;var weave_clauses$10465;($10438$10442=require("./pp"));;(__lt____gt__$10443=$10438$10442["<>"]);;($10439$10444=require("./location"));;(__lt____lt____colon__$10445=$10439$10444["<<:"]);;(util$10446=require("./util"));;(GenSym$10447=util$10446.GenSym);;(gensym$10448=util$10446.gensym);;(neighbours$10449=util$10446.neighbours);;(classify$10450=util$10446.classify);;(classify_contiguous$10451=util$10446.classify_contiguous);;(identity$10452=util$10446.identity);;($10441$10453=require("./expand"));;(checker_db$10454=$10441$10453.checker_db);;(PatternParser$10455=function(scope$10508,pattern$10509,opt$10510){var it$0$10513;(it$0$10513=function(){if((!$10378(PatternParser$10455)(this))){return Object.create(PatternParser$10455.prototype);}else{return this;}}());;(it$0$10513["opt"]=opt$10510);(it$0$10513["arguments"]=[]);(it$0$10513["vars"]=[]);(it$0$10513["specials"]=({}));(it$0$10513["pattern"]=it$0$10513.expand(scope$10508,pattern$10509,(opt$10510.tags||({})),true,it$0$10513.opt.indexable));return it$0$10513;});;(PatternParser$10455.prototype["parse_specs"]=function(scope$10523,specs$10524,tags$10525){var $index$10571;var $length$10566;var temp$10561;var acc$10556;var rest$10538;var has_defaults$10539;var rval$10540;var self$10533;var it$0$10528;(it$0$10528=this);;(self$10533=this);;(rest$10538=(void 0));;(has_defaults$10539=false);;(rval$10540=classify$10450("fw","bw","keys","defaults",(((acc$10556=[])),(((temp$10561=scope$10523.step_all(["pattern"],specs$10524))),((($length$10566=temp$10561.length)),((($index$10571=0)),function(){$10549:for(;($index$10571<$length$10566);($index$10571++)){var v$10623;var v$10618;var variable$10611;var value$10612;var key$10605;var subp$10606;var key$10600;var variable$10593;var $10551$10587;var $10552$10588;var $10553$10589;var $10554$10590;var t0$10584;var t1$10585;var m$10579;(m$10579=temp$10561[$index$10571]);;(t0$10584=m$10579);if((($10552$10588=(t0$10584 instanceof Array))&&((t1$10585=t0$10584.length),(($10554$10590=(t1$10585===2))&&(t0$10584[0]==="dynsplice"))))){(variable$10593=t0$10584[1]);acc$10556.push(((rest$10538=it$0$10528.expand(scope$10523,variable$10593,tags$10525)),["ignore"]));}else{if(($10554$10590&&(t0$10584[0]==="assoc"))){(key$10600=t0$10584[1]);acc$10556.push(["keys",[key$10600,it$0$10528.expand(scope$10523,key$10600,tags$10525)]]);}else{if(($10552$10588&&(($10554$10590=(t1$10585===3))&&(t0$10584[0]==="assoc")))){(key$10605=t0$10584[1]);(subp$10606=t0$10584[2]);acc$10556.push(["keys",[key$10605,it$0$10528.expand(scope$10523,subp$10606,tags$10525)]]);}else{if(($10554$10590&&(t0$10584[0]==="default"))){(variable$10611=t0$10584[1]);(value$10612=t0$10584[2]);acc$10556.push(((has_defaults$10539=true),function(){if(rest$10538){throw $13213(["syntax","pattern"]).create("No default arguments after rest arg.");}else{return ["defaults",[it$0$10528.expand(scope$10523,variable$10611,tags$10525),value$10612]];}}()));}else{(v$10618=m$10579);if(((rest$10538===(void 0))&&(!has_defaults$10539))){acc$10556.push(["fw",it$0$10528.expand(scope$10523,v$10618,tags$10525)]);}else{(v$10623=m$10579);acc$10556.push(["bw",it$0$10528.expand(scope$10523,v$10623,tags$10525)]);}}}}}}}()))),acc$10556)));;(rval$10540["rest"]=rest$10538);return rval$10540;});(PatternParser$10455.prototype["expand"]=function(){var x$10689;var x$10698;var x$10714;var x$10719;var variable$10725;var variable$10737;var x$10772;var msg$10779;var msg$10794;var $index$10827;var $length$10822;var temp$10817;var acc$10812;var $index$10931;var $length$10926;var temp$10921;var acc$10916;var $index$10962;var $length$10957;var temp$10952;var t0$11023;var t1$11024;var t2$11025;var $index$11053;var $length$11048;var temp$11043;var acc$11038;var patts$11032;var canon$10851;var normalize$10852;var pps$10853;var vars$10854;var patt$11112;var msg$11133;var other$11130;var keys$11118;var fw$11100;var bw$11101;var defaults$11102;var rest$11103;var $11079$11097;var t0$11090;var t1$11091;var t2$11092;var t3$11093;var t4$11094;var t5$11095;var $11078$11085;var specs$11080;var other$11145;var mode$11139;var subp$11140;var args$11074;var xs$10847;var xs$10806;var x$10800;var f$10785;var arg$10786;var f$10766;var arguments$10767;var checker$10760;var subp$10761;var projector$10754;var subp$10755;var condition$10748;var subp$10749;var v$10743;var v$10731;var type$10705;var $10667$10681;var $10668$10682;var $10669$10683;var $10670$10684;var t0$10677;var bridge$10666$10678;var t1$10679;var $10665$10672;var expr$10658;var rval$10659;var self$10653;var it$0$10648;var scope$10640;var pattern$10641;var tags$10642;var toplevel$10643;var checked$10644;var t0$10636;var $10629$10631;($10629$10631=arguments);;(t0$10636=$10629$10631.length);if(((t0$10636>=3)&&(t0$10636<=5))){(scope$10640=$10629$10631[0]);(pattern$10641=$10629$10631[1]);(tags$10642=$10629$10631[2]);(toplevel$10643=function(){if((3>=t0$10636)){return false;}else{return $10629$10631[3];}}());(checked$10644=function(){if((4>=t0$10636)){return false;}else{return $10629$10631[4];}}());(it$0$10648=this);;(self$10653=this);;(expr$10658=scope$10640.step(["pattern"],pattern$10641));;(rval$10659=((($10665$10672=expr$10658)),function(){if((((x$10689=$10665$10672)),((x$10689 instanceof Array)&&(x$10689[0]==="void")))){return ["check",checker_db$10454.null,["ignore"]];}else{if((((x$10698=$10665$10672)),((x$10698 instanceof Array)&&(x$10698[0]==="ignore")))){return expr$10658;}else{if((($10665$10672 instanceof Array)&&((t0$10677=$10665$10672.length),((t0$10677===2)&&($10665$10672[0]==="special"))))){(type$10705=$10665$10672[1]);(it$0$10648.specials[type$10705]=true);return expr$10658;}else{(bridge$10666$10678=$10665$10672);if(((((x$10714=bridge$10666$10678)),((x$10714 instanceof Array)&&(x$10714[0]==="symbol")))||(((x$10719=bridge$10666$10678)),((x$10719 instanceof Array)&&(x$10719[0]==="variable"))))){(variable$10725=$13417(expr$10658,tags$10642));;it$0$10648.vars.push(variable$10725);return ["assign",variable$10725];}else{if((($10667$10681=($10665$10672 instanceof Array))&&((t0$10677=$10665$10672.length),(($10669$10683=(t0$10677===2))&&(($10670$10684=($10665$10672[0]==="value"))&&((v$10731=$10665$10672[1]),it$0$10648.opt.strings_as_variables)))))){(variable$10737=__lt____lt____colon__$10445($13417(["symbol",v$10731],tags$10642),expr$10658));;it$0$10648.vars.push(variable$10737);return ["assign",variable$10737];}else{if($10670$10684){(v$10743=$10665$10672[1]);return ["check",checker_db$10454(v$10743),["ignore"]];}else{if(($10667$10681&&(($10669$10683=(t0$10677===3))&&($10665$10672[0]==="test")))){(condition$10748=$10665$10672[1]);(subp$10749=$10665$10672[2]);return ["test",condition$10748,it$0$10648.expand(scope$10640,subp$10749,tags$10642,toplevel$10643,false)];}else{if(($10669$10683&&($10665$10672[0]==="project"))){(projector$10754=$10665$10672[1]);(subp$10755=$10665$10672[2]);return ["project",projector$10754,it$0$10648.expand(scope$10640,subp$10755,tags$10642,toplevel$10643,true)];}else{if(($10669$10683&&($10665$10672[0]==="check"))){(checker$10760=$10665$10672[1]);(subp$10761=$10665$10672[2]);return ["check",checker$10760,it$0$10648.expand(scope$10640,subp$10761,tags$10642,toplevel$10643,true)];}else{if(($10669$10683&&(($10670$10684=($10665$10672[0]==="send"))&&((f$10766=$10665$10672[1]),((t1$10679=$10665$10672[2]),(((x$10772=t1$10679)),((x$10772 instanceof Array)&&(x$10772[0]==="data")))))))){(arguments$10767=t1$10679);if(toplevel$10643){it$0$10648.arguments.unshift(arguments$10767);return it$0$10648.expand(scope$10640,f$10766,tags$10642,true,false);}else{(msg$10779="Function arguments can only be declared as a top level pattern.");;throw $13213(["syntax","pattern"]).create(msg$10779,({"node":expr$10658,"arg":arguments$10767}));}}else{if($10670$10684){(f$10785=$10665$10672[1]);(arg$10786=$10665$10672[2]);return ["assign",expr$10658];}else{$10665$10672;if((!it$0$10648.opt.allow_nested)){(msg$10794="Nested patterns are not allowed here.");;throw $13213(["syntax","pattern"]).create(msg$10794,({"node":expr$10658}));}else{if((($10667$10681=($10665$10672 instanceof Array))&&((t0$10677=$10665$10672.length),((t0$10677===2)&&($10665$10672[0]==="neg"))))){(x$10800=$10665$10672[1]);return ["neg",it$0$10648.expand(scope$10640,x$10800,tags$10642)];}else{if(($10667$10681&&(($10669$10683=(t0$10677>=1))&&($10665$10672[0]==="all")))){(xs$10806=Array.prototype.slice.call($10665$10672,1));return ["all"].concat((((acc$10812=[])),(((temp$10817=xs$10806)),((($length$10822=temp$10817.length)),((($index$10827=0)),function(){$10809:for(;($index$10827<$length$10822);($index$10827++)){var x$10843;var m$10835;(m$10835=temp$10817[$index$10827]);;(x$10843=m$10835);acc$10812.push(it$0$10648.expand(scope$10640,x$10843,tags$10642));}}()))),acc$10812));}else{if(($10669$10683&&($10665$10672[0]==="any"))){(xs$10847=Array.prototype.slice.call($10665$10672,1));(canon$10851=function(all$10860){return all$10860.sort().join(",");});;(normalize$10852=function(vars$10866){var $index$10886;var $length$10881;var temp$10876;var acc$10871;return canon$10851((((acc$10871=[])),(((temp$10876=vars$10866)),((($length$10881=temp$10876.length)),((($index$10886=0)),function(){$10868:for(;($index$10886<$length$10881);($index$10886++)){var v$10904;var t0$10899;var t1$10900;var m$10894;(m$10894=temp$10876[$index$10886]);;(t0$10899=m$10894);if(((t0$10899 instanceof Array)&&((t1$10900=t0$10899.length),((t1$10900===2)&&(t0$10899[0]==="symbol"))))){(v$10904=t0$10899[1]);acc$10871.push(v$10904);}else{$13404(m$10894,"/home/olivier/git/earl-grey/src/pattern.eg",3853,3910);;}}}()))),acc$10871));});;(pps$10853=(((acc$10916=[])),(((temp$10921=xs$10847)),((($length$10926=temp$10921.length)),((($index$10931=0)),function(){$10913:for(;($index$10931<$length$10926);($index$10931++)){var x$10947;var m$10939;(m$10939=temp$10921[$index$10931]);;(x$10947=m$10939);acc$10916.push(PatternParser$10455(scope$10640,x$10947,$13417(it$0$10648.opt,({"tags":tags$10642}))));}}()))),acc$10916));;(temp$10952=neighbours$10449(pps$10853));;($length$10957=temp$10952.length);;($index$10962=0);;$10855:for(;($index$10962<$length$10957);($index$10962++)){var $index$11000;var $length$10995;var temp$10990;var pp1$10980;var pp2$10981;var t0$10975;var t1$10976;var m$10970;(m$10970=temp$10952[$index$10962]);;(t0$10975=m$10970);if(((t0$10975 instanceof Array)&&((t1$10976=t0$10975.length),(t1$10976===2)))){(pp1$10980=t0$10975[0]);(pp2$10981=t0$10975[1]);(temp$10990=pps$10853);;($length$10995=temp$10990.length);;($index$11000=0);;$10986:for(;($index$11000<$length$10995);($index$11000++)){var pp$11016;var m$11008;(m$11008=temp$10990[$index$11000]);;(pp$11016=m$11008);normalize$10852(pp$11016.vars);}if((normalize$10852(pp1$10980.vars)!==normalize$10852(pp2$10981.vars))){throw $13213(["syntax","pattern"]).create("Both branches of 'or' must contain the same variables",({"vars1":__lt____lt____colon__$10445(pp1$10980.vars.sort(),pp1$10980.pattern),"vars2":__lt____lt____colon__$10445(pp2$10981.vars.sort(),pp2$10981.pattern)}));}if((canon$10851($13527(pp1$10980.specials))!==canon$10851($13527(pp2$10981.specials)))){throw $13213(["syntax","pattern"]).create("Both branches of 'or' must contain the same special tokens",({"special1":__lt____lt____colon__$10445($13527(pp1$10980.specials).sort(),pp1$10980.pattern),"special2":__lt____lt____colon__$10445($13527(pp2$10981.specials).sort(),pp2$10981.pattern)}));}}else{$13404(m$10970,"/home/olivier/git/earl-grey/src/pattern.eg",4002,4799);;}}(t0$11023=pps$10853);if(((t0$11023 instanceof Array)&&((t1$11024=t0$11023.length),((t1$11024>=1)&&((t2$11025=t0$11023[0]),$13489(t2$11025,"vars")))))){(vars$10854=t2$11025.vars);Array.prototype.slice.call(t0$11023,1);;}else{$13404(pps$10853,"/home/olivier/git/earl-grey/src/pattern.eg",4816,4819);}(it$0$10648["vars"]=it$0$10648.vars.concat(vars$10854));(patts$11032=(((acc$11038=[])),(((temp$11043=pps$10853)),((($length$11048=temp$11043.length)),((($index$11053=0)),function(){$11035:for(;($index$11053<$length$11048);($index$11053++)){var pp$11069;var m$11061;(m$11061=temp$11043[$index$11053]);;(pp$11069=m$11061);acc$11038.push(pp$11069.pattern);}}()))),acc$11038));;return ["any"].concat(patts$11032);}else{if(($10669$10683&&($10665$10672[0]==="data"))){(args$11074=Array.prototype.slice.call($10665$10672,1));(specs$11080=it$0$10648.parse_specs(scope$10640,args$11074,tags$10642));;($11078$11085=specs$11080);;if((($11079$11097=$13489($11078$11085,"keys"))&&((t0$11090=$11078$11085.keys),((t0$11090 instanceof Array)&&((t1$11091=t0$11090.length),((t1$11091===0)&&($13489($11078$11085,"fw")&&((fw$11100=$11078$11085.fw),($13489($11078$11085,"bw")&&((bw$11101=$11078$11085.bw),($13489($11078$11085,"defaults")&&((defaults$11102=$11078$11085.defaults),$13489($11078$11085,"rest"))))))))))))){(rest$11103=$11078$11085.rest);(patt$11112=__lt____lt____colon__$10445(["array_pattern",fw$11100,bw$11101,defaults$11102,rest$11103],pattern$10641));;if(checked$10644){return patt$11112;}else{return ["check",checker_db$10454.Array,patt$11112];}}else{if(($11079$11097&&((keys$11118=$11078$11085.keys),($13489($11078$11085,"fw")&&((t0$11090=$11078$11085.fw),((t0$11090 instanceof Array)&&((t1$11091=t0$11090.length),((t1$11091===0)&&($13489($11078$11085,"bw")&&((t2$11092=$11078$11085.bw),((t2$11092 instanceof Array)&&((t3$11093=t2$11092.length),((t3$11093===0)&&($13489($11078$11085,"defaults")&&((t4$11094=$11078$11085.defaults),((t4$11094 instanceof Array)&&((t5$11095=t4$11094.length),((t5$11095===0)&&($13489($11078$11085,"rest")&&($11078$11085.rest===(void 0))))))))))))))))))))){return ["object_pattern"].concat(keys$11118);}else{(other$11130=$11078$11085);(msg$11133="Pattern must be an array or an object.");;throw $13213(["syntax","pattern"]).create(msg$11133,({"node":expr$10658,"specs":specs$11080}));}}}else{if(($10667$10681&&((t0$10677===3)&&($10665$10672[0]==="mode")))){(mode$11139=$10665$10672[1]);(subp$11140=$10665$10672[2]);return it$0$10648.expand(scope$10640,subp$11140,$13417(tags$10642,({"declare_mode":mode$11139})),toplevel$10643,checked$10644);}else{(other$11145=$10665$10672);throw $13213(["syntax","pattern"]).create("Illegal pattern",({"node":other$11145}));}}}}}}}}}}}}}}}}}}()));;return (it$0$10648.opt.wrap_pattern||identity$10452)(__lt____lt____colon__$10445(rval$10659,pattern$10641),toplevel$10643);}else{$13404($10629$10631);}});$10394(PatternParser$10455,$10394(((accum$11151=({})),((accum$11151["::name"]="PatternParser"),accum$11151)),((accum$11155=({})),((accum$11155["::egclass"]=true),accum$11155))));PatternParser$10455;(PatternProcessor$10456=function(){var it$0$11163;(it$0$11163=function(){if((!$10378(PatternProcessor$10456)(this))){return Object.create(PatternProcessor$10456.prototype);}else{return this;}}());;(it$0$11163["temps"]=[]);(it$0$11163["parts"]=[]);(it$0$11163["gen"]=GenSym$10447("t"));return it$0$11163;});;(PatternProcessor$10456.prototype["do"]=function(part$11173){var self$11181;var it$0$11176;(it$0$11176=this);;(self$11181=this);;return it$0$11176.parts.push(["do",part$11173]);});(PatternProcessor$10456.prototype["check"]=function(){var self$11209;var it$0$11204;var part$11199;var tags$11200;var t0$11195;var $11188$11190;($11188$11190=arguments);;(t0$11195=$11188$11190.length);if(((t0$11195>=1)&&(t0$11195<=2))){(part$11199=$11188$11190[0]);(tags$11200=function(){if((1>=t0$11195)){return ({});}else{return $11188$11190[1];}}());(it$0$11204=this);;(self$11209=this);;return it$0$11204.parts.push($13417(["check",part$11199],tags$11200));}else{$13404($11188$11190);}});(PatternProcessor$10456.prototype["temp"]=function(){var x$11257;var x$11262;var init$11269;var bridge$11240$11251;var $11239$11246;var self$11241;var it$0$11234;var x$11229;var v$11230;var t0$11225;var $11218$11220;($11218$11220=arguments);;(t0$11225=$11218$11220.length);if(((t0$11225>=1)&&(t0$11225<=2))){(x$11229=$11218$11220[0]);(v$11230=function(){if((1>=t0$11225)){return null;}else{return $11218$11220[1];}}());(it$0$11234=this);;(self$11241=this);;($11239$11246=x$11229);;(bridge$11240$11251=$11239$11246);if((((((x$11257=bridge$11240$11251)),((x$11257 instanceof Array)&&(x$11257[0]==="variable")))||(((x$11262=bridge$11240$11251)),((x$11262 instanceof Array)&&(x$11262[0]==="symbol"))))&&($13489($11239$11246,"single_assignment")&&($11239$11246.single_assignment&&(!v$11230))))){return x$11229;}else{(init$11269=$11239$11246);(v$11230=(v$11230||["symbol",it$0$11234.gen()]));(v$11230["single_assignment"]=true);it$0$11234.temps.push(v$11230);it$0$11234.do(["send",["symbol",":="],["data",v$11230,init$11269]]);return v$11230;}}else{$13404($11218$11220);}});(PatternProcessor$10456.prototype["process"]=function(pattern$11277,rhs$11278,fns$11279){var x$11316;var x$11345;var t$11357;var t$11368;var pp$11378;var $index$11406;var $length$11401;var temp$11396;var t$11388;var $index$11464;var $length$11459;var temp$11454;var acc$11449;var fn$11435;var parts$11436;var t$11430;var $index$11516;var $length$11511;var temp$11506;var acc$11501;var t$11494;var otherwise$11615;var $11597$11599;var $index$11629;var $length$11624;var temp$11619;var $index$11666;var $length$11661;var temp$11656;var end$11708;var pos$11703;var $index$11728;var $length$11723;var temp$11718;var acc$11713;var nfw$11555;var nbw$11556;var ndflt$11557;var extract_length$11558;var check_length$11559;var lo$11560;var hi$11561;var t$11562;var len$11563;var fw$11548;var bw$11549;var dflt$11550;var rest$11551;var subp$11490;var xs$11426;var xs$11384;var patt$11374;var projector$11363;var subp$11364;var checker$11352;var subp$11353;var checker$11341;var condition$11334;var subp$11335;var kind$11329;var sym$11323;var $11296$11308;var $11297$11309;var $11298$11310;var $11299$11311;var t0$11306;var $11295$11301;var rval$11292;var self$11287;var it$0$11282;(it$0$11282=this);;(self$11287=this);;(rval$11292=((($11295$11301=pattern$11277)),function(){if((((x$11316=$11295$11301)),((x$11316 instanceof Array)&&(x$11316[0]==="ignore")))){return it$0$11282.do(rhs$11278);}else{if((($11296$11308=($11295$11301 instanceof Array))&&((t0$11306=$11295$11301.length),(($11298$11310=(t0$11306===2))&&($11295$11301[0]==="assign"))))){(sym$11323=$11295$11301[1]);return it$0$11282.parts.push(fns$11279.assign(sym$11323,rhs$11278));}else{if(($11298$11310&&($11295$11301[0]==="special"))){(kind$11329=$11295$11301[1]);return it$0$11282.process(fns$11279.special(pattern$11277,rhs$11278),rhs$11278,fns$11279);}else{if(($11296$11308&&(($11298$11310=(t0$11306===3))&&($11295$11301[0]==="test")))){(condition$11334=$11295$11301[1]);(subp$11335=$11295$11301[2]);it$0$11282.process(subp$11335,rhs$11278,fns$11279);return it$0$11282.check(condition$11334,({"test":true}));}else{if(($11298$11310&&(($11299$11311=($11295$11301[0]==="check"))&&((checker$11341=$11295$11301[1]),(((x$11345=$11295$11301[2])),((x$11345 instanceof Array)&&(x$11345[0]==="ignore"))))))){return it$0$11282.check(["send",checker$11341,["data",rhs$11278]]);}else{if($11299$11311){(checker$11352=$11295$11301[1]);(subp$11353=$11295$11301[2]);(t$11357=it$0$11282.temp(rhs$11278));;it$0$11282.check(["send",checker$11352,["data",t$11357]]);return it$0$11282.process(subp$11353,t$11357,fns$11279);}else{if(($11298$11310&&($11295$11301[0]==="project"))){(projector$11363=$11295$11301[1]);(subp$11364=$11295$11301[2]);(t$11368=it$0$11282.temp(["send",projector$11363,["data",rhs$11278]]));;it$0$11282.check(["send",t$11368,["value",0]]);return it$0$11282.process(subp$11364,["send",t$11368,["value",1]],fns$11279);}else{if(($11296$11308&&((t0$11306===2)&&($11295$11301[0]==="neg")))){(patt$11374=$11295$11301[1]);return it$0$11282.check(["send",["symbol","not"],["data",["void"],(((pp$11378=PatternProcessor$10456())),pp$11378.process(patt$11374,rhs$11278,fns$11279),assemble_conditions$10457(pp$11378))]]);}else{if(($11296$11308&&(($11298$11310=(t0$11306>=1))&&($11295$11301[0]==="all")))){(xs$11384=Array.prototype.slice.call($11295$11301,1));(t$11388=it$0$11282.temp(rhs$11278));;(temp$11396=xs$11384);;($length$11401=temp$11396.length);;($index$11406=0);;$11389:for(;($index$11406<$length$11401);($index$11406++)){var x$11422;var m$11414;(m$11414=temp$11396[$index$11406]);;(x$11422=m$11414);it$0$11282.process(x$11422,t$11388,fns$11279);}return null;}else{if(($11298$11310&&($11295$11301[0]==="any"))){(xs$11426=Array.prototype.slice.call($11295$11301,1));(t$11430=it$0$11282.temp(rhs$11278,["symbol",gensym$10448("bridge")]));;return it$0$11282.check((((fn$11435=function(x$11440,rest$11441){return ["send",["symbol","or"],["data",x$11440,rest$11441]];})),((parts$11436=(((acc$11449=[])),(((temp$11454=xs$11426)),((($length$11459=temp$11454.length)),((($index$11464=0)),function(){$11446:for(;($index$11464<$length$11459);($index$11464++)){var pp$11483;var x$11480;var m$11472;(m$11472=temp$11454[$index$11464]);;(x$11480=m$11472);acc$11449.push((((pp$11483=PatternProcessor$10456())),pp$11483.process(x$11480,t$11430,fns$11279),assemble_conditions$10457(pp$11483)));}}()))),acc$11449))),util$10446.construct(parts$11436,fn$11435,["symbol","false"])));}else{if(($11298$11310&&($11295$11301[0]==="object_pattern"))){(subp$11490=Array.prototype.slice.call($11295$11301,1));(t$11494=it$0$11282.temp(rhs$11278));;(acc$11501=[]);;(temp$11506=subp$11490);;($length$11511=temp$11506.length);;($index$11516=0);;$11495:for(;($index$11516<$length$11511);($index$11516++)){var k$11536;var v$11537;var t0$11529;var t1$11530;var t2$11531;var t3$11532;var m$11524;(m$11524=temp$11506[$index$11516]);;(t0$11529=m$11524);if(((t0$11529 instanceof Array)&&((t1$11530=t0$11529.length),((t1$11530===2)&&((t2$11531=t0$11529[0]),((t2$11531 instanceof Array)&&((t3$11532=t2$11531.length),((t3$11532===2)&&(t2$11531[0]==="value"))))))))){(k$11536=t2$11531[1]);(v$11537=t0$11529[1]);acc$11501.push((it$0$11282.check(["send",["symbol","___hasprop"],["data",t$11494,["value",k$11536]]]),it$0$11282.process(v$11537,["send",t$11494,["value",k$11536]],fns$11279)));}else{$13404(m$11524,"/home/olivier/git/earl-grey/src/pattern.eg",8142,8274);;}}return acc$11501;}else{if(($11296$11308&&((t0$11306===5)&&($11295$11301[0]==="array_pattern")))){(fw$11548=$11295$11301[1]);(bw$11549=$11295$11301[2]);(dflt$11550=$11295$11301[3]);(rest$11551=$11295$11301[4]);(nfw$11555=fw$11548.length);;(nbw$11556=bw$11549.length);;(ndflt$11557=dflt$11550.length);;(extract_length$11558=true);;(check_length$11559=true);;(lo$11560=(nfw$11555+nbw$11556));;(hi$11561=(lo$11560+ndflt$11557));;(t$11562=it$0$11282.temp(rhs$11278));;(len$11563=it$0$11282.temp(["send",t$11562,["send",["symbol","."],["data",["void"],["symbol","length"]]]]));;it$0$11282.check(((($11597$11599=rest$11551)),function(){if($11597$11599){return ["send",["symbol",">="],["data",len$11563,["value",lo$11560]]];}else{$11597$11599;if((lo$11560===hi$11561)){return ["send",["symbol","==="],["data",len$11563,["value",lo$11560]]];}else{(otherwise$11615=$11597$11599);return ["send",["symbol","and"],["data",["send",["symbol",">="],["data",len$11563,["value",lo$11560]]],["send",["symbol","<="],["data",len$11563,["value",hi$11561]]]]];}}}()));(temp$11619=$13382(fw$11548));;($length$11624=temp$11619.length);;($index$11629=0);;$11564:for(;($index$11629<$length$11624);($index$11629++)){var i$11647;var m$11648;var t0$11642;var t1$11643;var m$11637;(m$11637=temp$11619[$index$11629]);;(t0$11642=m$11637);if(((t0$11642 instanceof Array)&&((t1$11643=t0$11642.length),(t1$11643===2)))){(i$11647=t0$11642[0]);(m$11648=t0$11642[1]);it$0$11282.process(m$11648,["send",t$11562,["value",i$11647]],fns$11279);}else{$13404(m$11637,"/home/olivier/git/earl-grey/src/pattern.eg",9006,9092);;}}(temp$11656=$13382(dflt$11550));;($length$11661=temp$11656.length);;($index$11666=0);;$11566:for(;($index$11666<$length$11661);($index$11666++)){var idx$11696;var i$11686;var patt$11687;var value$11688;var t0$11679;var t1$11680;var t2$11681;var t3$11682;var m$11674;(m$11674=temp$11656[$index$11666]);;(t0$11679=m$11674);if(((t0$11679 instanceof Array)&&((t1$11680=t0$11679.length),((t1$11680===2)&&((i$11686=t0$11679[0]),((t2$11681=t0$11679[1]),((t2$11681 instanceof Array)&&((t3$11682=t2$11681.length),(t3$11682===2))))))))){(patt$11687=t2$11681[0]);(value$11688=t2$11681[1]);(idx$11696=(i$11686+nfw$11555));;it$0$11282.process(patt$11687,["send",["symbol","if"],["data",["send",["symbol",">="],["data",["value",(idx$11696+nbw$11556)],len$11563]],value$11688,["send",t$11562,["value",idx$11696]]]],fns$11279);}else{$13404(m$11674,"/home/olivier/git/earl-grey/src/pattern.eg",9092,9261);;}}if((rest$11551!==(void 0))){(pos$11703=(nfw$11555+ndflt$11557));;(end$11708=function(){if((nbw$11556>0)){return [["value",(-nbw$11556)]];}else{return [];}}());;it$0$11282.process(rest$11551,["send",["send",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","slice"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",t$11562,["value",pos$11703]].concat(end$11708)],fns$11279);}else{[];}(acc$11713=[]);;(temp$11718=$13382(bw$11549));;($length$11723=temp$11718.length);;($index$11728=0);;$11568:for(;($index$11728<$length$11723);($index$11728++)){var i$11746;var m$11747;var t0$11741;var t1$11742;var m$11736;(m$11736=temp$11718[$index$11728]);;(t0$11741=m$11736);if(((t0$11741 instanceof Array)&&((t1$11742=t0$11741.length),(t1$11742===2)))){(i$11746=t0$11741[0]);(m$11747=t0$11741[1]);acc$11713.push(it$0$11282.process(m$11747,["send",["symbol","___js_fetch"],["data",t$11562,["send",["symbol","-"],["data",len$11563,["value",(nbw$11556-i$11746)]]]]],fns$11279));}else{$13404(m$11736,"/home/olivier/git/earl-grey/src/pattern.eg",9712,9863);;}}return acc$11713;}else{$13404($11295$11301);}}}}}}}}}}}}}()));;return rval$11292;});$10394(PatternProcessor$10456,$10394(((accum$11757=({})),((accum$11757["::name"]="PatternProcessor"),accum$11757)),((accum$11761=({})),((accum$11761["::egclass"]=true),accum$11761))));PatternProcessor$10456;(assemble_conditions$10457=function(pp$11767){var $index$11849;var $length$11844;var temp$11839;var acc$11834;var decls$11828;var construct$11770;(construct$11770=function($11773$11775){var x$11818;var rest$11819;var x$11811;var x$11803;var rest$11804;var $11778$11794;var $11779$11795;var t0$11790;var t1$11791;var t2$11792;var $11777$11785;var ph$11780;(ph$11780=$11773$11775);;($11777$11785=ph$11780);;if((($11778$11794=($11777$11785 instanceof Array))&&((t0$11790=$11777$11785.length),(t0$11790===0)))){return ["value",true];}else{if(($11778$11794&&((t0$11790>=1)&&((t1$11791=$11777$11785[0]),((t1$11791 instanceof Array)&&((t2$11792=t1$11791.length),((t2$11792===2)&&(t1$11791[0]==="do")))))))){(x$11803=t1$11791[1]);(rest$11804=Array.prototype.slice.call($11777$11785,1));return ["multi",x$11803,construct$11770(rest$11804)];}else{if(($11778$11794&&((t0$11790===1)&&((t1$11791=$11777$11785[0]),((t1$11791 instanceof Array)&&((t2$11792=t1$11791.length),((t2$11792===2)&&(t1$11791[0]==="check")))))))){(x$11811=t1$11791[1]);return x$11811;}else{if(($11778$11794&&((t0$11790>=1)&&((t1$11791=$11777$11785[0]),((t1$11791 instanceof Array)&&((t2$11792=t1$11791.length),((t2$11792===2)&&(t1$11791[0]==="check")))))))){(x$11818=t1$11791[1]);(rest$11819=Array.prototype.slice.call($11777$11785,1));return ["send",["symbol","and"],["data",x$11818,construct$11770(rest$11819)]];}else{$13404($11777$11785);}}}}});;if(pp$11767.temps.length){(decls$11828=(((acc$11834=[])),(((temp$11839=pp$11767.temps)),((($length$11844=temp$11839.length)),((($index$11849=0)),function(){$11831:for(;($index$11849<$length$11844);($index$11849++)){var t$11865;var m$11857;(m$11857=temp$11839[$index$11849]);;(t$11865=m$11857);acc$11834.push(["declare",t$11865]);}}()))),acc$11834));;return ["multi"].concat(decls$11828).concat([construct$11770(pp$11767.parts)]);}else{return construct$11770(pp$11767.parts);}});;(assemble_pattern$10458=function(){var $index$11919;var $length$11914;var temp$11909;var $index$11968;var $length$11963;var temp$11958;var test$12061;var lead$11889;var trail$11890;var construct$11891;var parts$11883;var t$11884;var f$11885;var t0$11879;var $11872$11874;($11872$11874=arguments);;(t0$11879=$11872$11874.length);if(((t0$11879>=2)&&(t0$11879<=3))){(parts$11883=$11872$11874[0]);(t$11884=$11872$11874[1]);(f$11885=function(){if((2>=t0$11879)){return null;}else{return $11872$11874[2];}}());(lead$11889=[]);;(temp$11909=parts$11883.slice(0));;($length$11914=temp$11909.length);;($index$11919=0);;$11892:for(;($index$11919<$length$11914);($index$11919++)){var x$11948;var x$11941;var $11894$11935;var $11895$11936;var $11896$11937;var $11897$11938;var t0$11932;var t1$11933;var m$11927;(m$11927=temp$11909[$index$11919]);;(t0$11932=m$11927);if((($11895$11936=(t0$11932 instanceof Array))&&((t1$11933=t0$11932.length),(($11897$11938=(t1$11933===2))&&(t0$11932[0]==="do"))))){(x$11941=t0$11932[1]);lead$11889.push(x$11941);parts$11883.shift();}else{if(($11897$11938&&(t0$11932[0]==="check"))){(x$11948=t0$11932[1]);break $11892;}else{$13404(m$11927,"/home/olivier/git/earl-grey/src/pattern.eg",10324,10434);;}}}(trail$11890=[]);;(temp$11958=parts$11883.slice(0).reverse());;($length$11963=temp$11958.length);;($index$11968=0);;$11898:for(;($index$11968<$length$11963);($index$11968++)){var x$11997;var x$11990;var $11900$11984;var $11901$11985;var $11902$11986;var $11903$11987;var t0$11981;var t1$11982;var m$11976;(m$11976=temp$11958[$index$11968]);;(t0$11981=m$11976);if((($11901$11985=(t0$11981 instanceof Array))&&((t1$11982=t0$11981.length),(($11903$11987=(t1$11982===2))&&(t0$11981[0]==="do"))))){(x$11990=t0$11981[1]);trail$11890.unshift(x$11990);parts$11883.pop();}else{if(($11903$11987&&(t0$11981[0]==="check"))){(x$11997=t0$11981[1]);break $11898;}else{$13404(m$11976,"/home/olivier/git/earl-grey/src/pattern.eg",10448,10570);;}}}(construct$11891=function($12004$12006){var other$12057;var x$12049;var rest$12050;var x$12042;var x$12034;var rest$12035;var $12009$12025;var $12010$12026;var t0$12021;var t1$12022;var t2$12023;var $12008$12016;var ph$12011;(ph$12011=$12004$12006);;($12008$12016=ph$12011);;if((($12009$12025=($12008$12016 instanceof Array))&&((t0$12021=$12008$12016.length),(t0$12021===0)))){return ["value",true];}else{if(($12009$12025&&((t0$12021>=1)&&((t1$12022=$12008$12016[0]),((t1$12022 instanceof Array)&&((t2$12023=t1$12022.length),((t2$12023===2)&&(t1$12022[0]==="do")))))))){(x$12034=t1$12022[1]);(rest$12035=Array.prototype.slice.call($12008$12016,1));return ["multi",x$12034,construct$11891(rest$12035)];}else{if(($12009$12025&&((t0$12021===1)&&((t1$12022=$12008$12016[0]),((t1$12022 instanceof Array)&&((t2$12023=t1$12022.length),((t2$12023===2)&&(t1$12022[0]==="check")))))))){(x$12042=t1$12022[1]);return x$12042;}else{if(($12009$12025&&((t0$12021>=1)&&((t1$12022=$12008$12016[0]),((t1$12022 instanceof Array)&&((t2$12023=t1$12022.length),((t2$12023===2)&&(t1$12022[0]==="check")))))))){(x$12049=t1$12022[1]);(rest$12050=Array.prototype.slice.call($12008$12016,1));return ["send",["symbol","and"],["data",x$12049,construct$11891(rest$12050)]];}else{(other$12057=$12008$12016);throw $13213(["oops"]).create("?!?",other$12057);}}}}});;if(parts$11883.length){(test$12061=construct$11891(parts$11883));;return ["multi"].concat(lead$11889).concat([function(){if(f$11885){return ["send",["symbol","if"],["data",test$12061,["multi"].concat(trail$11890).concat([t$11884]),f$11885]];}else{return ["send",["symbol","if"],["data",test$12061,["multi"].concat(trail$11890).concat([t$11884])]];}}()]);}else{return ["multi"].concat(lead$11889).concat(trail$11890).concat([t$11884]);}}else{$13404($11872$11874);}});;(inject_below_uses$10459=function($12070$12072,fn$12073){var other$12097;var scope$12090;var x$12091;var t0$12086;var $12075$12081;var ph$12076;(ph$12076=$12070$12072);;($12075$12081=ph$12076);;if((($12075$12081 instanceof Array)&&((t0$12086=$12075$12081.length),((t0$12086===3)&&($12075$12081[0]==="use"))))){(scope$12090=$12075$12081[1]);(x$12091=$12075$12081[2]);return ["use",scope$12090,inject_below_uses$10459(x$12091,fn$12073)];}else{(other$12097=$12075$12081);return fn$12073(other$12097);}});;(parse_pattern$10460=function(scope$12103,pattern$12104,rhs$12105,opt$12106){var t0$12117;var $index$12156;var $length$12151;var temp$12146;var acc$12141;var parse$12109;var target$12110;var proc$12111;(parse$12109=PatternParser$10455(scope$12103,pattern$12104,opt$12106));;if(((!opt$12106.allow_arguments)&&parse$12109.arguments.length)){throw $13213(["syntax","pattern","arguments"]).create("Arguments cannot be declared in this pattern",({"args":parse$12109.arguments[0]}));}(t0$12117=$13528((opt$12106.wrap_target||identity$10452))(function(){if(parse$12109.arguments.length){return inject_below_uses$10459(rhs$12105,function(x$12120){return util$10446.construct(parse$12109.arguments.concat([x$12120]),function(args$12123,rest$12124){return ["send",["symbol","->"],["data",args$12123,rest$12124]];});});}else{return rhs$12105;}}()));if(t0$12117[0]){(target$12110=t0$12117[1]);;}else{$13404(function(){if(parse$12109.arguments.length){return inject_below_uses$10459(rhs$12105,function(x$12129){return util$10446.construct(parse$12109.arguments.concat([x$12129]),function(args$12132,rest$12133){return ["send",["symbol","->"],["data",args$12132,rest$12133]];});});}else{return rhs$12105;}}(),"/home/olivier/git/earl-grey/src/pattern.eg",11963,12396);}(proc$12111=PatternProcessor$10456());;proc$12111.process(parse$12109.pattern,target$12110,opt$12106);if(opt$12106.finalize){return ["splice"].concat(opt$12106.declare(scope$12103,parse$12109.vars)).concat([["multi"].concat((((acc$12141=[])),(((temp$12146=proc$12111.temps)),((($length$12151=temp$12146.length)),((($index$12156=0)),function(){$12138:for(;($index$12156<$length$12151);($index$12156++)){var t$12172;var m$12164;(m$12164=temp$12146[$index$12156]);;(t$12172=m$12164);acc$12141.push(["declare",t$12172]);}}()))),acc$12141)).concat([assemble_pattern$10458(proc$12111.parts,opt$12106.success(target$12110),opt$12106.failure(target$12110))])]);}else{return [parse$12109.vars,proc$12111.temps,proc$12111.parts];}});;(checkall$10461=["send","data","multi","assign","void","check","do"]);;(same_block$10462=function($12180$12182,ban1$12183,ban2$12184){var $index$12285;var $length$12280;var temp$12275;var other$12306;var type1$12258;var args1$12259;var type2$12260;var args2$12261;var m1$12249;var m2$12250;var v1$12240;var v2$12241;var s1$12231;var s2$12232;var v1$12219;var v2$12220;var $12187$12210;var $12188$12211;var $12189$12212;var $12190$12213;var $12191$12214;var $12192$12215;var $12193$12216;var t0$12204;var t1$12205;var t2$12206;var t3$12207;var t4$12208;var $12186$12199;var ph$12194;(ph$12194=$12180$12182);;($12186$12199=ph$12194);;if((($12187$12210=($12186$12199 instanceof Array))&&((t0$12204=$12186$12199.length),(($12189$12212=(t0$12204===2))&&((t1$12205=$12186$12199[0]),(($12191$12214=(t1$12205 instanceof Array))&&((t2$12206=t1$12205.length),(($12193$12216=(t2$12206===2))&&((t1$12205[0]==="variable")&&((v1$12219=t1$12205[1]),((t3$12207=$12186$12199[1]),((t3$12207 instanceof Array)&&((t4$12208=t3$12207.length),((t4$12208===2)&&(t3$12207[0]==="variable"))))))))))))))){(v2$12220=t3$12207[1]);return (v1$12219===v2$12220);}else{if(($12193$12216&&((t1$12205[0]==="symbol")&&((s1$12231=t1$12205[1]),((t3$12207=$12186$12199[1]),((t3$12207 instanceof Array)&&((t4$12208=t3$12207.length),((t4$12208===2)&&(t3$12207[0]==="symbol"))))))))){(s2$12232=t3$12207[1]);return (((!$10393(ban1$12183,s1$12231))&&(!$10393(ban2$12184,s2$12232)))&&(s1$12231===s2$12232));}else{if(($12193$12216&&((t1$12205[0]==="value")&&((v1$12240=t1$12205[1]),((t3$12207=$12186$12199[1]),((t3$12207 instanceof Array)&&((t4$12208=t3$12207.length),((t4$12208===2)&&(t3$12207[0]==="value"))))))))){(v2$12241=t3$12207[1]);return (v1$12240===v2$12241);}else{if(($12193$12216&&((t1$12205[0]==="macro")&&((m1$12249=t1$12205[1]),((t3$12207=$12186$12199[1]),((t3$12207 instanceof Array)&&((t4$12208=t3$12207.length),((t4$12208===2)&&(t3$12207[0]==="macro"))))))))){(m2$12250=t3$12207[1]);return (m1$12249===m2$12250);}else{if(($12191$12214&&((t2$12206>=1)&&((type1$12258=t1$12205[0]),((args1$12259=Array.prototype.slice.call(t1$12205,1)),((t3$12207=$12186$12199[1]),((t3$12207 instanceof Array)&&((t4$12208=t3$12207.length),((t4$12208>=1)&&((type2$12260=t3$12207[0]),((args2$12261=Array.prototype.slice.call(t3$12207,1)),(checkall$10461.indexOf(type1$12258)!==-1)))))))))))){if(((type1$12258===type2$12260)&&(args1$12259.length===args2$12261.length))){(temp$12275=$13556(args1$12259,args2$12261));;($length$12280=temp$12275.length);;($index$12285=0);;$12271:for(;($index$12285<$length$12280);($index$12285++)){var pair$12301;var m$12293;(m$12293=temp$12275[$index$12285]);;(pair$12301=m$12293);if((!same_block$10462(pair$12301,ban1$12183,ban2$12184))){return false;}}return true;}else{return false;}}else{(other$12306=$12186$12199);return false;}}}}}});;(parse_clauses$10463=function(scope$12312,target$12313,stmts$12314,opt$12315){var $index$12345;var $length$12340;var temp$12335;var acc$12330;var $index$12521;var $length$12516;var temp$12511;var acc$12506;var $index$12568;var $length$12563;var temp$12558;var acc$12553;var decls$12547;var all_temps$12318;var the_parts$12319;var unique_temps$12320;(all_temps$12318=[]);;(the_parts$12319=(((acc$12330=[])),(((temp$12335=scope$12312.step_all(["clause"],stmts$12314))),((($length$12340=temp$12335.length)),((($index$12345=0)),function(){$12326:for(;($index$12345<$length$12340);($index$12345++)){var accum$12420;var accum$12431;var t0$12416;var t1$12417;var $index$12454;var $length$12449;var temp$12444;var bod$12481;var placeholder$12370;var special_fn$12371;var vars$12372;var temps$12373;var blocks$12374;var vars2$12375;var x$12490;var other$12497;var b$12487;var pattern$12364;var body$12365;var $12328$12361;var t0$12358;var t1$12359;var m$12353;(m$12353=temp$12335[$index$12345]);;(t0$12358=m$12353);if(((t0$12358 instanceof Array)&&((t1$12359=t0$12358.length),((t1$12359===3)&&(t0$12358[0]==="clause"))))){(pattern$12364=t0$12358[1]);(body$12365=t0$12358[2]);acc$12330.push((((placeholder$12370=(void 0))),((special_fn$12371=function($12383$12385,value$12386){var t0$12392;var t1$12393;var other$12412;var $12388$12399;var ph$12389;var expr$12390;(t0$12392=$12383$12385);if(((t0$12392 instanceof Array)&&((t1$12393=t0$12392.length),((t1$12393===2)&&(t0$12392[0]==="special"))))){(ph$12389=t0$12392[1]);(expr$12390=t0$12392);;}else{$13404($12383$12385);}($12388$12399=ph$12389);;if(($12388$12399==="match")){(placeholder$12370=__lt____lt____colon__$10445(["symbol",scope$12312.gensym("ph")],expr$12390));return ["assign",placeholder$12370];}else{(other$12412=$12388$12399);throw $13213(["syntax","pattern","special"]).create("Special token cannot be used here",({"special":expr$12390}));}})),((t0$12416=parse_pattern$10460(scope$12312,pattern$12364,target$12313,$13417(opt$12315,$10394(({"allow_arguments":false,"allow_nested":true,"special":special_fn$12371}),$10394(((accum$12420=({})),((accum$12420["assign"]=function(v$12424,value$12425){return ["do",__lt____lt____colon__$10445(["assign",v$12424,value$12425],v$12424)];}),accum$12420)),({"finalize":false})))))),function(){if(((t0$12416 instanceof Array)&&((t1$12417=t0$12416.length),(t1$12417===3)))){(vars$12372=t0$12416[0]);(temps$12373=t0$12416[1]);(blocks$12374=t0$12416[2]);}else{return $13404(parse_pattern$10460(scope$12312,pattern$12364,target$12313,$13417(opt$12315,$10394(({"allow_arguments":false,"allow_nested":true,"special":special_fn$12371}),$10394(((accum$12431=({})),((accum$12431["assign"]=function(v$12435,value$12436){return ["do",__lt____lt____colon__$10445(["assign",v$12435,value$12436],v$12435)];}),accum$12431)),({"finalize":false}))))),"/home/olivier/git/earl-grey/src/pattern.eg",14023,14370);}}()),(all_temps$12318=all_temps$12318.concat(temps$12373)),function(){if(placeholder$12370){return vars$12372.push(placeholder$12370);}}(),((vars2$12375=({}))),(((temp$12444=vars$12372)),((($length$12449=temp$12444.length)),((($index$12454=0)),function(){$12376:for(;($index$12454<$length$12449);($index$12454++)){var other$12478;var xxx$12472;var t0$12467;var t1$12468;var m$12462;(m$12462=temp$12444[$index$12454]);;(t0$12467=m$12462);if(((t0$12467 instanceof Array)&&((t1$12468=t0$12467.length),((t1$12468===2)&&(t0$12467[0]==="symbol"))))){(xxx$12472=t0$12467[1]);(vars2$12375[xxx$12472]=true);}else{(other$12478=m$12462);throw $13213(["syntax","unexpected"]).create();}}}()))),(((bod$12481=function(){if(placeholder$12370){return parse_clauses$10463(scope$12312,placeholder$12370,$13528(["multi"])(body$12365)[1],opt$12315);}else{if(opt$12315.wrap){return opt$12315.wrap(body$12365);}else{return body$12365;}}}())),["clause",vars$12372,vars2$12375,blocks$12374,bod$12481])));}else{if((((x$12490=t0$12358)),((x$12490 instanceof Array)&&(x$12490[0]==="block")))){(b$12487=t0$12358);acc$12330.push(b$12487);}else{(other$12497=m$12353);acc$12330.push(function(){throw $13213(["syntax","clause"]).create("Illegal clause",({"clause":other$12497}));}());}}}}()))),acc$12330));;if(opt$12315.fallback){the_parts$12319.push(["block",opt$12315.fallback(target$12313)]);}(unique_temps$12320=$13527(util$10446.mkset((((acc$12506=[])),(((temp$12511=all_temps$12318)),((($length$12516=temp$12511.length)),((($index$12521=0)),function(){$12503:for(;($index$12521<$length$12516);($index$12521++)){var t$12539;var t0$12534;var t1$12535;var m$12529;(m$12529=temp$12511[$index$12521]);;(t0$12534=m$12529);if(((t0$12534 instanceof Array)&&((t1$12535=t0$12534.length),((t1$12535===2)&&(t0$12534[0]==="symbol"))))){(t$12539=t0$12534[1]);acc$12506.push(t$12539);}else{$13404(m$12529,"/home/olivier/git/earl-grey/src/pattern.eg",15180,15210);;}}}()))),acc$12506))));;(decls$12547=(((acc$12553=[])),(((temp$12558=unique_temps$12320)),((($length$12563=temp$12558.length)),((($index$12568=0)),function(){$12550:for(;($index$12568<$length$12563);($index$12568++)){var t$12584;var m$12576;(m$12576=temp$12558[$index$12568]);;(t$12584=m$12576);acc$12553.push(["declare",["symbol",t$12584]]);}}()))),acc$12553));;return ["multi"].concat(decls$12547).concat([weave_clauses$10465(the_parts$12319)]);});;(opt_clauses$10464=function(clauses$12591){var $index$12620;var $length$12615;var temp$12610;var acc$12605;var $index$12755;var $length$12750;var temp$12745;var acc$12740;var $index$12800;var $length$12795;var temp$12790;var acc$12785;var $index$12844;var $length$12839;var temp$12834;var acc$12829;var shares$12594;var max$12595;var temps$12596;var shared_last$12597;var idx_last$12598;var new_clauses$12599;(shares$12594=(((acc$12605=[])),(((temp$12610=$13382(clauses$12591.slice(1)))),((($length$12615=temp$12610.length)),((($index$12620=0)),function(){$12602:for(;($index$12620<$length$12615);($index$12620++)){var t0$12659;var t1$12660;var $index$12683;var $length$12678;var temp$12673;var varsd0$12652;var blocks0$12653;var share$12654;var idx$12655;var i$12640;var vars$12641;var varsd$12642;var blocks$12643;var body$12644;var t0$12633;var t1$12634;var t2$12635;var t3$12636;var m$12628;(m$12628=temp$12610[$index$12620]);;(t0$12633=m$12628);if(((t0$12633 instanceof Array)&&((t1$12634=t0$12633.length),((t1$12634===2)&&((i$12640=t0$12633[0]),((t2$12635=t0$12633[1]),((t2$12635 instanceof Array)&&((t3$12636=t2$12635.length),((t3$12636===5)&&(t2$12635[0]==="clause")))))))))){(vars$12641=t2$12635[1]);(varsd$12642=t2$12635[2]);(blocks$12643=t2$12635[3]);(body$12644=t2$12635[4]);acc$12605.push((((t0$12659=$10393(clauses$12591,i$12640)),function(){if(((t0$12659 instanceof Array)&&((t1$12660=t0$12659.length),((t1$12660===5)&&(t0$12659[0]==="clause"))))){t0$12659[1];(varsd0$12652=t0$12659[2]);(blocks0$12653=t0$12659[3]);t0$12659[4];}else{return $13404($10393(clauses$12591,i$12640),"/home/olivier/git/earl-grey/src/pattern.eg",15483,15503);}}()),((share$12654=0)),((idx$12655=0)),(((temp$12673=blocks$12643)),((($length$12678=temp$12673.length)),((($index$12683=0)),function(){$12656:for(;($index$12683<$length$12678);($index$12683++)){var x$12714;var x$12723;var other$12730;var $12702$12704;var b$12699;var m$12691;(m$12691=temp$12673[$index$12683]);;(b$12699=m$12691);if(same_block$10462([$10393(blocks0$12653,share$12654),b$12699],varsd0$12652,varsd$12642)){(share$12654++);($12702$12704=b$12699);;if((((x$12714=$12702$12704)),((x$12714 instanceof Array)&&(x$12714[0]==="do")))){null;}else{if((((x$12723=$12702$12704)),((x$12723 instanceof Array)&&(x$12723[0]==="check")))){(idx$12655=share$12654);}else{(other$12730=$12702$12704);__lt____gt__$10443(null,other$12730);}}}else{break $12656;}}}()))),[share$12654,idx$12655]));}else{$13404(m$12628,"/home/olivier/git/earl-grey/src/pattern.eg",15359,15880);;}}}()))),acc$12605));;(max$12595=$10393(Math.max,(((acc$12740=[])),(((temp$12745=shares$12594)),((($length$12750=temp$12745.length)),((($index$12755=0)),function(){$12737:for(;($index$12755<$length$12750);($index$12755++)){var x$12773;var t0$12768;var t1$12769;var m$12763;(m$12763=temp$12745[$index$12755]);;(t0$12768=m$12763);if(((t0$12768 instanceof Array)&&((t1$12769=t0$12768.length),(t1$12769===2)))){(x$12773=t0$12768[0]);t0$12768[1];acc$12740.push(x$12773);}else{$13404(m$12763,"/home/olivier/git/earl-grey/src/pattern.eg",15894,15923);;}}}()))),acc$12740)));;shares$12594.push([0,0]);(temps$12596=(((acc$12785=[])),(((temp$12790=$13604(1,max$12595))),((($length$12795=temp$12790.length)),((($index$12800=0)),function(){$12782:for(;($index$12800<$length$12795);($index$12800++)){var m$12808;(m$12808=temp$12790[$index$12800]);;m$12808;acc$12785.push(["symbol",gensym$10448()]);}}()))),acc$12785));;(shared_last$12597=0);;(idx_last$12598=0);;(new_clauses$12599=(((acc$12829=[])),(((temp$12834=$13382(clauses$12591))),((($length$12839=temp$12834.length)),((($index$12844=0)),function(){$12826:for(;($index$12844<$length$12839);($index$12844++)){var t0$12882;var t1$12883;var $index$12918;var $length$12913;var temp$12908;var acc$12903;var rest$12967;var newblocks$12963;var share$12876;var idx$12877;var shared$12878;var n_to_share$12879;var to_share$12880;var other$12974;var i$12864;var vars$12865;var varsd$12866;var blocks$12867;var body$12868;var t0$12857;var t1$12858;var t2$12859;var t3$12860;var m$12852;(m$12852=temp$12834[$index$12844]);;(t0$12857=m$12852);if(((t0$12857 instanceof Array)&&((t1$12858=t0$12857.length),((t1$12858===2)&&((i$12864=t0$12857[0]),((t2$12859=t0$12857[1]),((t2$12859 instanceof Array)&&((t3$12860=t2$12859.length),((t3$12860===5)&&(t2$12859[0]==="clause")))))))))){(vars$12865=t2$12859[1]);(varsd$12866=t2$12859[2]);(blocks$12867=t2$12859[3]);(body$12868=t2$12859[4]);acc$12829.push((((t0$12882=$10393(shares$12594,i$12864)),function(){if(((t0$12882 instanceof Array)&&((t1$12883=t0$12882.length),(t1$12883===2)))){(share$12876=t0$12882[0]);(idx$12877=t0$12882[1]);}else{return $13404($10393(shares$12594,i$12864),"/home/olivier/git/earl-grey/src/pattern.eg",16144,16163);}}()),((shared$12878=function(){if(idx_last$12598){return [["check",$10393(temps$12596,(idx_last$12598-1))]];}else{return [];}}())),((n_to_share$12879=Math.max(shared_last$12597,share$12876))),((to_share$12880=(((acc$12903=[])),(((temp$12908=$13382(blocks$12867.slice(shared_last$12597,n_to_share$12879)))),((($length$12913=temp$12908.length)),((($index$12918=0)),function(){$12896:for(;($index$12918<$length$12913);($index$12918++)){var j$12952;var x$12953;var j$12942;var x$12943;var $12898$12936;var $12899$12937;var $12900$12938;var $12901$12939;var t0$12931;var t1$12932;var t2$12933;var t3$12934;var m$12926;(m$12926=temp$12908[$index$12918]);;(t0$12931=m$12926);if((($12899$12937=(t0$12931 instanceof Array))&&((t1$12932=t0$12931.length),(($12901$12939=(t1$12932===2))&&((j$12942=t0$12931[0]),((t2$12933=t0$12931[1]),((t2$12933 instanceof Array)&&((t3$12934=t2$12933.length),((t3$12934===2)&&(t2$12933[0]==="check")))))))))){(x$12943=t2$12933[1]);acc$12903.push(["check",["assign",$10393(temps$12596,(shared_last$12597+j$12942)),x$12943]]);}else{if(($12901$12939&&((j$12952=t0$12931[0]),((t2$12933=t0$12931[1]),((t2$12933 instanceof Array)&&((t3$12934=t2$12933.length),((t3$12934===2)&&(t2$12933[0]==="do")))))))){(x$12953=t2$12933[1]);acc$12903.push(["do",x$12953]);}else{$13404(m$12926,"/home/olivier/git/earl-grey/src/pattern.eg",16292,16463);;}}}}()))),acc$12903))),(shared_last$12597=share$12876),(idx_last$12598=idx$12877),(((newblocks$12963=(((rest$12967=blocks$12867.slice(n_to_share$12879))),shared$12878.concat(to_share$12880).concat(rest$12967)))),["clause",vars$12865,varsd$12866,newblocks$12963,body$12868])));}else{(other$12974=m$12852);acc$12829.push(function(){throw $13213(["oops"]).create("what",({"value":other$12974}));}());}}}()))),acc$12829));;return [temps$12596,new_clauses$12599];});;(weave_clauses$10465=function(parts$12981){var $index$13027;var $length$13022;var temp$13017;var $index$13193;var $length$13188;var temp$13183;var acc$13178;var groups$12984;var reassemble$12985;var new_temps$12986;var helper$12987;(groups$12984=classify_contiguous$10451(parts$12981,function($12996$12998){var t0$13002;var t1$13003;var cls$13000;(t0$13002=$12996$12998);if(((t0$13002 instanceof Array)&&((t1$13003=t0$13002.length),(t1$13003>=1)))){(cls$13000=t0$13002[0]);Array.prototype.slice.call(t0$13002,1);;}else{$13404($12996$12998);}return cls$13000;}));;(reassemble$12985=[]);;(new_temps$12986=[]);;(temp$13017=groups$12984);;($length$13022=temp$13017.length);;($index$13027=0);;$12988:for(;($index$13027<$length$13022);($index$13027++)){var t0$13057;var t1$13058;var ts$13054;var new_clauses$13055;var elems$13065;var elems$13049;var $12990$13043;var $12991$13044;var $12992$13045;var $12993$13046;var t0$13040;var t1$13041;var m$13035;(m$13035=temp$13017[$index$13027]);;(t0$13040=m$13035);if((($12991$13044=(t0$13040 instanceof Array))&&((t1$13041=t0$13040.length),(($12993$13046=(t1$13041>=1))&&(t0$13040[0]==="clause"))))){(elems$13049=Array.prototype.slice.call(t0$13040,1));(t0$13057=opt_clauses$10464(elems$13049));if(((t0$13057 instanceof Array)&&((t1$13058=t0$13057.length),(t1$13058===2)))){(ts$13054=t0$13057[0]);(new_clauses$13055=t0$13057[1]);;}else{$13404(opt_clauses$10464(elems$13049),"/home/olivier/git/earl-grey/src/pattern.eg",16958,16986);}(new_temps$12986=new_temps$12986.concat(ts$13054));(reassemble$12985=reassemble$12985.concat(new_clauses$13055));}else{if(($12993$13046&&(t0$13040[0]==="block"))){(elems$13065=Array.prototype.slice.call(t0$13040,1));(reassemble$12985=reassemble$12985.concat(elems$13065));}else{$13404(m$13035,"/home/olivier/git/earl-grey/src/pattern.eg",16892,17097);;}}}(helper$12987=function($13072$13074){var $index$13153;var $length$13148;var temp$13143;var acc$13138;var decls$13132;var vars$13124;var varsd$13125;var blocks$13126;var body$13127;var rest$13128;var body$13113;var rest$13114;var $13077$13100;var $13078$13101;var $13079$13102;var $13080$13103;var $13081$13104;var $13082$13105;var t0$13093;var t1$13094;var t2$13095;var t3$13096;var t4$13097;var t5$13098;var $13076$13088;var ph$13083;(ph$13083=$13072$13074);;($13076$13088=ph$13083);;if((($13077$13100=($13076$13088 instanceof Array))&&((t0$13093=$13076$13088.length),(t0$13093===0)))){return ["multi"];}else{if(($13077$13100&&(($13079$13102=(t0$13093>=1))&&((t1$13094=$13076$13088[0]),(($13081$13104=(t1$13094 instanceof Array))&&((t2$13095=t1$13094.length),((t2$13095===2)&&((t1$13094[0]==="block")&&((t3$13096=$13528(["multi"])(t1$13094[1])),(t3$13096[0]&&((t4$13097=t3$13096[1]),((t5$13098=t4$13097.length),(t5$13098>=0))))))))))))){(body$13113=Array.prototype.slice.call(t4$13097,0));(rest$13114=Array.prototype.slice.call($13076$13088,1));return ["multi"].concat(body$13113).concat([helper$12987(rest$13114)]);}else{if(($13081$13104&&((t2$13095===5)&&(t1$13094[0]==="clause")))){(vars$13124=t1$13094[1]);(varsd$13125=t1$13094[2]);(blocks$13126=t1$13094[3]);(body$13127=t1$13094[4]);(rest$13128=Array.prototype.slice.call($13076$13088,1));(decls$13132=(((acc$13138=[])),(((temp$13143=vars$13124)),((($length$13148=temp$13143.length)),((($index$13153=0)),function(){$13135:for(;($index$13153<$length$13148);($index$13153++)){var v$13169;var m$13161;(m$13161=temp$13143[$index$13153]);;(v$13169=m$13161);acc$13138.push(["declare",v$13169]);}}()))),acc$13138));;return ["tagscope","back",["multi"].concat(decls$13132).concat([assemble_pattern$10458(blocks$13126,body$13127,["use","back",helper$12987(rest$13128)])])];}else{$13404($13076$13088);}}}});;return ["multi"].concat((((acc$13178=[])),(((temp$13183=new_temps$12986)),((($length$13188=temp$13183.length)),((($index$13193=0)),function(){$13175:for(;($index$13193<$length$13188);($index$13193++)){var t$13209;var m$13201;(m$13201=temp$13183[$index$13193]);;(t$13209=m$13201);acc$13178.push(["declare",t$13209]);}}()))),acc$13178)).concat([helper$12987(reassemble$12985)]);});;(exports["PatternParser"]=PatternParser$10455);(exports["PatternProcessor"]=PatternProcessor$10456);(exports["parse_clauses"]=parse_clauses$10463);(exports["parse_pattern"]=parse_pattern$10460);

},{"./expand":5,"./location":7,"./pp":11,"./util":14}],11:[function(require,module,exports){
var $13784=function(type$13786){var f$13789;(f$13789=type$13786["::check"]);;if((f$13789===(void 0))){return function(value$13794){return (value$13794 instanceof type$13786);};}else{return function(value$13797){return f$13789.call(type$13786,value$13797);};}};
var $13799=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $13800=function(dest$13802,values$13803){var k$13808;(k$13808=null);$13806:for(k$13808 in values$13803){if(values$13803.hasOwnProperty(k$13808)){(dest$13802[k$13808]=values$13803[k$13808]);}}return dest$13802;};
var $13812=function($13813$13815){var ph$13819;(ph$13819=$13813$13815);;var $13817$13824;($13817$13824=ph$13819);;var bridge$13818$13829;var x$13833;(bridge$13818$13829=$13817$13824);if((((typeof(bridge$13818$13829)==="string")&&((x$13833=bridge$13818$13829),true))||((typeof(bridge$13818$13829)==="number")&&((x$13833=bridge$13818$13829),true)))){return ["value",x$13833];}else{var other$13840;(other$13840=$13817$13824);return other$13840["::serialize_ast"]();}};
var send$13624;(send$13624=function(obj$13629,$13627$13630){var ph$13634;var msg$13635;var t0$13637;(t0$13637=$13627$13630);(msg$13635=t0$13637);(ph$13634=t0$13637);;var $13632$13641;($13632$13641=ph$13634);;var bridge$13633$13646;(bridge$13633$13646=$13632$13641);if(((typeof(bridge$13633$13646)==="string")||(typeof(bridge$13633$13646)==="number"))){return obj$13629[msg$13635];}else{var other$13654;(other$13654=$13632$13641);return obj$13629["::send"](msg$13635);}});;(Array[":::project"]=function($13657$13659){var ph$13662;var value$13663;var t0$13665;(t0$13665=$13657$13659);(value$13663=t0$13665);(ph$13662=t0$13665);;var $13661$13669;($13661$13669=ph$13662);;if($13784(Array)($13661$13669)){return [true,value$13663];}else{$13661$13669;return [true,[value$13663]];}});(Array.prototype["::check"]=function(value$13683){if((value$13683 instanceof Array)){var i$13688;(i$13688=0);;$13686:for(;(i$13688<this.length);(i$13688++)){if(($13799(this,i$13688)!==$13799(value$13683,i$13688))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $13800(this.slice(0),this);});(Array.prototype[":::project"]=function(value$13699){if((value$13699 instanceof Array)){var i$13704;(i$13704=0);;$13702:for(;(i$13704<this.length);(i$13704++)){if(($13799(this,i$13704)!==$13799(value$13699,i$13704))){return [true,[value$13699]];}}return [true,value$13699.slice(this.length)];}else{return [true,[value$13699]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($13812));});(RegExp.prototype["::check"]=function($13714$13716){var ph$13719;(ph$13719=$13714$13716);;var $13718$13724;($13718$13724=ph$13719);;var value$13732;if((typeof($13718$13724)==="string")){(value$13732=$13718$13724);if(value$13732.match(this)){return true;}else{return false;}}else{var other$13737;(other$13737=$13718$13724);return false;}});(RegExp.prototype[":::project"]=function($13739$13741){var ph$13744;(ph$13744=$13739$13741);;var $13743$13749;($13743$13749=ph$13744);;var value$13757;if((typeof($13743$13749)==="string")){(value$13757=$13743$13749);var $13760$13762;($13760$13762=value$13757.match(this));;var m$13770;if(($13760$13762===null)){(m$13770=$13760$13762);return [false,null];}else{var m$13775;(m$13775=$13760$13762);return [true,m$13775];}}else{var other$13779;(other$13779=$13743$13749);return [false,null];}});(Function.prototype["::send"]=function(args$13782){return this.apply(this,args$13782);});
var $14564=function(type$14566){return function(value$14569){var f$14572;(f$14572=type$14566[":::project"]);;if((f$14572===(void 0))){(f$14572=type$14566["::project"]);if((f$14572===(void 0))){return [true,type$14566(value$14569)];}else{var rval$14578;(rval$14578=false);;try{(rval$14578=[true,f$14572(value$14569)]);}catch(excv$14584){var e$14590;(e$14590=excv$14584);(rval$14578=[false,null]);}return rval$14578;}}else{return f$14572.call(type$14566,value$14569);}};};
var $14774=function(arr$14776){var results$14780;var l$14781;(results$14780=[]);;(l$14781=arr$14776.length);;var i$14789;(i$14789=0);;$14779:for(;(i$14789<l$14781);(i$14789++)){results$14780.push([i$14789,$13799(arr$14776,i$14789)]);}return results$14780;};
var $14605=function(){var $14606$14608;($14606$14608=function(tags$14612){var it$0$14615;(it$0$14615=function(){if((!$13784($14606$14608)(this))){return Object.create($14606$14608.prototype);}else{return this;}}());;(it$0$14615["tags"]=tags$14612);return it$0$14615;});;($14606$14608.prototype["create"]=function(){var $14624$14626;($14624$14626=arguments);;var t0$14631;var message$14635;var args$14636;(t0$14631=$14624$14626.length);if((t0$14631>=0)){(message$14635=function(){if((0>=t0$14631)){return "";}else{return $14624$14626[0];}}());(args$14636=Array.prototype.slice.call($14624$14626,1));var it$0$14640;(it$0$14640=this);;var self$14645;(self$14645=this);;var e$14650;(e$14650=Error(message$14635));;(e$14650["::tags"]=it$0$14640.tags);(e$14650["args"]=args$14636);var temp$14658;(temp$14658=$14774(args$14636));;var $length$14663;($length$14663=temp$14658.length);;var $index$14668;($index$14668=0);;$14651:for(;($index$14668<$length$14663);($index$14668++)){var m$14676;(m$14676=temp$14658[$index$14668]);;var t0$14681;var t1$14682;var i$14686;var arg$14687;(t0$14681=m$14676);if(((t0$14681 instanceof Array)&&((t1$14682=t0$14681.length),(t1$14682===2)))){(i$14686=t0$14681[0]);(arg$14687=t0$14681[1]);(e$14650[i$14686]=arg$14687);}else{$14592(m$14676);;}}(e$14650["length"]=args$14636.length);(e$14650["name"]=["E"].concat(it$0$14640.tags).join("."));return e$14650;}else{$14592($14624$14626);}});($14606$14608.prototype["::check"]=function(e$14698){var it$0$14701;(it$0$14701=this);;var self$14706;(self$14706=this);;var tags$14711;if(((!e$14698)||(!$13784(Error)(e$14698)))){return false;}(tags$14711=(e$14698["::tags"]||[]));;var temp$14720;(temp$14720=it$0$14701.tags);;var $length$14725;($length$14725=temp$14720.length);;var $index$14730;($index$14730=0);;$14712:for(;($index$14730<$length$14725);($index$14730++)){var m$14738;(m$14738=temp$14720[$index$14730]);;var tag$14746;(tag$14746=m$14738);if((tags$14711.indexOf(tag$14746)===-1)){return false;}else{false;;}}return true;});($14606$14608.prototype["::deconstruct"]=function(e$14754){var it$0$14757;(it$0$14757=this);;var self$14762;(self$14762=this);;return e$14754.args;});$13800($14606$14608,$13800(function(){var accum$14767;(accum$14767=({}));(accum$14767["::name"]="$14606");return accum$14767;}(),function(){var accum$14771;(accum$14771=({}));(accum$14771["::egclass"]=true);return accum$14771;}()));return $14606$14608;}();
var $14592=function(value$14594,url$14595,start$14596,end$14597){var err$14600;(err$14600=$14605(["match"]).create("Could not find a match for value",({"value":value$14594})));;if(url$14595){(err$14600["location"]=["location",url$14595,start$14596,end$14597]);}throw err$14600;};
var $14437=function(){var $14438$14440;($14438$14440=function($14443$14446,$14444$14447){var classes$14449;var children$14450;var t0$14452;(t0$14452=$14564(Array)($14443$14446));if(t0$14452[0]){(classes$14449=t0$14452[1]);;}else{$14592($14443$14446);}var t0$14457;(t0$14457=$14564(Array)($14444$14447));if(t0$14457[0]){(children$14450=t0$14457[1]);;}else{$14592($14444$14447);}var it$0$14462;(it$0$14462=function(){if((!$13784($14438$14440)(this))){return Object.create($14438$14440.prototype);}else{return this;}}());;(it$0$14462["classes"]=classes$14449.sort());(it$0$14462["children"]=children$14450);return it$0$14462;});;$13800(function(){var accum$14470;(accum$14470=({}));(accum$14470["::check"]=function(x$14474){return ((x$14474&&x$14474.classes)&&x$14474.children);});return accum$14470;}(),$13800(function(){var accum$14477;(accum$14477=({}));(accum$14477["::deconstruct"]=function(x$14481){return [x$14481.classes,x$14481.children];});return accum$14477;}(),$13800(function(){var accum$14484;(accum$14484=({}));(accum$14484["::name"]="$14438");return accum$14484;}(),function(){var accum$14488;(accum$14488=({}));(accum$14488["::egclass"]=true);return accum$14488;}())));($14438$14440.prototype["::check"]=function(n$14494){var it$0$14497;(it$0$14497=this);;var self$14502;(self$14502=this);;var temp$14511;(temp$14511=it$0$14497.classes);;var $length$14516;($length$14516=temp$14511.length);;var $index$14521;($index$14521=0);;$14507:for(;($index$14521<$length$14516);($index$14521++)){var m$14529;(m$14529=temp$14511[$index$14521]);;var c$14537;(c$14537=m$14529);if((n$14494.classes.indexOf(c$14537)===-1)){return false;}else{false;;}}return true;});$13800($14438$14440,$13800(function(){var accum$14543;(accum$14543=({}));(accum$14543["::check"]=function(x$14547){return ((x$14547&&x$14547.classes)&&x$14547.children);});return accum$14543;}(),$13800(function(){var accum$14550;(accum$14550=({}));(accum$14550["::deconstruct"]=function(x$14554){return [x$14554.classes,x$14554.children];});return accum$14550;}(),$13800(function(){var accum$14557;(accum$14557=({}));(accum$14557["::name"]="$14438");return accum$14557;}(),function(){var accum$14561;(accum$14561=({}));(accum$14561["::egclass"]=true);return accum$14561;}()))));return $14438$14440;}();
var $14796=function(obj$14798){var results$14802;(results$14802=[]);;var k$14807;(k$14807=null);$14801:for(k$14807 in obj$14798){if(Object.prototype.hasOwnProperty.call(obj$14798,k$14807)){results$14802.push([k$14807,$13799(obj$14798,k$14807)]);}}return results$14802;};
var $14811=function($14812$14814,key$14815){var ph$14819;(ph$14819=$14812$14814);;var $14817$14824;($14817$14824=ph$14819);;var bridge$14818$14829;(bridge$14818$14829=$14817$14824);if(((bridge$14818$14829===null)||(bridge$14818$14829===(void 0)))){return false;}else{var x$14837;if((typeof($14817$14824)==="string")){(x$14837=$14817$14824);return (key$14815 in String.prototype);}else{var x$14842;if((typeof($14817$14824)==="number")){(x$14842=$14817$14824);return (key$14815 in Number.prototype);}else{var x$14847;(x$14847=$14817$14824);return (key$14815 in x$14847);}}}};var pr_terminus$13844;var pr$13845;var __lt____gt__$13846;var repr$13847;var escape_html$13848;var quotify$13849;var HTML$13850;(pr_terminus$13844=function(node$13854){var r$13857;var pre$13858;var post$13859;(r$13857=HTML$13850(node$13854,"span"));;(pre$13858=(String.fromCharCode(27)+"[?0;7y+h <div class=\"ug\">"));;(post$13859=("</div>"+String.fromCharCode(7)));;return console.log(((pre$13858+r$13857)+post$13859));});;(pr$13845=function($13872$13874,r$13875){var x$13896;var n$13891;var $13877$13883;var ph$13878;(ph$13878=$13872$13874);;($13877$13883=ph$13878);;if($13784($14437)($13877$13883)){(n$13891=$13877$13883);return pr_terminus$13844(n$13891);}else{(x$13896=$13877$13883);return pr_terminus$13844((r$13875||repr$13847)(x$13896));}});;(__lt____gt__$13846=function($13901$13903,x$13904){if(($13901$13903===null)){;}else{$14592($13901$13903);}return pr$13845(x$13904);});;(repr$13847=function(){var $index$13989;var $length$13984;var temp$13979;var acc$13974;var $index$14033;var $length$14028;var temp$14023;var acc$14018;var other$14060;var entries$13968;var $13916$13941;var t0$13939;var x$13929;var recur$13930;var $13915$13931;var t0$13923;var t1$13924;var t2$13925;var $13914$13918;($13914$13918=arguments);;(t0$13923=$13914$13918.length);if((((t0$13923>=1)&&(t0$13923<=2))&&((t1$13924=$13914$13918[0]),((x$13929=t1$13924),(($13915$13931=t1$13924),((t2$13925=function(){if((1>=t0$13923)){return repr$13847;}else{return $13914$13918[1];}}()),$13784(Function)(t2$13925))))))){(recur$13930=t2$13925);if(($13915$13931===true)){return $14437(["special","true"],"true");}else{if(($13915$13931===false)){return $14437(["special","false"],"false");}else{if(($13915$13931===null)){return $14437(["special","nil"],"null");}else{if(($13915$13931===(void 0))){return $14437(["special","nil"],"undefined");}else{if((typeof($13915$13931)==="number")){return $14437(["num"],String(x$13929));}else{if((typeof($13915$13931)==="string")){return $14437(["str"],x$13929);}else{(t0$13939=$13915$13931);if($13784(Array)(t0$13939)){(entries$13968=t0$13939);return $14437(["sequence"],(((acc$13974=[])),(((temp$13979=entries$13968)),((($length$13984=temp$13979.length)),((($index$13989=0)),function(){$13971:for(;($index$13989<$length$13984);($index$13989++)){var x$14005;var m$13997;(m$13997=temp$13979[$index$13989]);;(x$14005=m$13997);acc$13974.push(recur$13930(x$14005,repr$13847));}}()))),acc$13974));}else{$13915$13931;if(x$13929["::repr"]){return x$13929["::repr"](recur$13930);}else{if((Object.getPrototypeOf(x$13929)===Object.prototype)){return $14437(["+table","object"],(((acc$14018=[])),(((temp$14023=$14796(x$13929))),((($length$14028=temp$14023.length)),((($index$14033=0)),function(){$14015:for(;($index$14033<$length$14028);($index$14033++)){var k$14051;var v$14052;var t0$14046;var t1$14047;var m$14041;(m$14041=temp$14023[$index$14033]);;(t0$14046=m$14041);if(((t0$14046 instanceof Array)&&((t1$14047=t0$14046.length),(t1$14047===2)))){(k$14051=t0$14046[0]);(v$14052=t0$14046[1]);acc$14018.push($14437(["+tr"],[$14437(["+th"],recur$13930(k$14051,repr$13847)),$14437(["+td"],recur$13930(v$14052,repr$13847))]));}else{$14592(m$14041,"/home/olivier/git/earl-grey/src/pp.eg",959,1289);;}}}()))),acc$14018));}else{(other$14060=$13915$13931);return $14437(["unknown"],other$14060.toString());}}}}}}}}}}else{$14592($13914$13918);}});;(escape_html$13848=function($14067$14069){var t0$14073;var repl$14078;var s$14071;(t0$14073=[true,String($14067$14069)]);if(t0$14073[0]){(s$14071=t0$14073[1]);;}else{$14592($14067$14069);}(repl$14078=({"&":"&amp;","<":"&lt;",">":"&gt;"}));;return s$14071.replace(RegExp("[&<>]","g"),function(x$14083){return $13799(repl$14078,x$14083);});});;(quotify$13849=function($14088$14090){var t0$14094;var s$14092;(t0$14094=[true,String($14088$14090)]);if(t0$14094[0]){(s$14092=t0$14094[1]);;}else{$14592($14088$14090);}return s$14092.replace(RegExp("[\"\\\\]","g"),function(x$14099){return ("\\"+x$14099);});});;(HTML$13850=function($14104$14106,default_tag$14107){var $index$14150;var $length$14145;var temp$14140;var acc$14135;var $index$14215;var $length$14210;var temp$14205;var $index$14292;var $length$14287;var temp$14282;var acc$14277;var $index$14347;var $length$14342;var temp$14337;var acc$14332;var $index$14393;var $length$14388;var temp$14383;var acc$14378;var other$14373;var $14317$14319;var x$14427;var other$14424;var $14176$14412;var tag$14177;var _classes$14178;var id$14179;var kv$14180;var sub$14181;var accum$14182;var other$14433;var classes$14170;var children$14171;var children$14128;var s$14123;var $14109$14115;var ph$14110;(ph$14110=$14104$14106);;($14109$14115=ph$14110);;if((typeof($14109$14115)==="string")){(s$14123=$14109$14115);return escape_html$13848(s$14123);}else{if($13784(Array)($14109$14115)){(children$14128=$14109$14115);return (((acc$14135=[])),(((temp$14140=children$14128)),((($length$14145=temp$14140.length)),((($index$14150=0)),function(){$14132:for(;($index$14150<$length$14145);($index$14150++)){var child$14166;var m$14158;(m$14158=temp$14140[$index$14150]);;(child$14166=m$14158);acc$14135.push(HTML$13850(child$14166,default_tag$14107));}}()))),acc$14135).join("");}else{if(($13784($14437)($14109$14115)&&($14811($14109$14115,"classes")&&((classes$14170=$14109$14115.classes),$14811($14109$14115,"children"))))){(children$14171=$14109$14115.children);(tag$14177=(default_tag$14107||"span"));;(_classes$14178=[]);;(id$14179=null);;(kv$14180=[]);;(sub$14181=[]);;(temp$14205=classes$14170);;($length$14210=temp$14205.length);;($index$14215=0);;$14183:for(;($index$14215<$length$14210);($index$14215++)){var s$14263;var m$14256;var m$14249;var k$14244;var k$14237;var v$14238;var $14185$14232;var $14186$14233;var $14187$14234;var t0$14228;var t1$14229;var t2$14230;var m$14223;(m$14223=temp$14205[$index$14215]);;(t0$14228=m$14223);if((($14186$14233=(t0$14228 instanceof Array))&&((t1$14229=t0$14228.length),((t1$14229===3)&&(t0$14228[0]==="assoc"))))){(k$14237=t0$14228[1]);(v$14238=t0$14228[2]);kv$14180.push([k$14237,v$14238]);}else{if(($14186$14233&&((t1$14229===2)&&(t0$14228[0]==="assoc")))){(k$14244=t0$14228[1]);kv$14180.push([k$14244,(void 0)]);}else{(t0$14228=$14564(RegExp("(?:^\\+((?:.*)))",""))(m$14223));if((t0$14228[0]&&((t1$14229=t0$14228[1]),((t2$14230=t1$14229.length),(t2$14230===2))))){t1$14229[0];(m$14249=t1$14229[1]);(tag$14177=m$14249);}else{(t0$14228=$14564(RegExp("(?:^#((?:.*)))",""))(m$14223));if((t0$14228[0]&&((t1$14229=t0$14228[1]),((t2$14230=t1$14229.length),(t2$14230===2))))){t1$14229[0];(m$14256=t1$14229[1]);(id$14179=m$14256);}else{(t0$14228=m$14223);if((typeof(t0$14228)==="string")){(s$14263=t0$14228);_classes$14178.push(s$14263);}else{$14592(m$14223,"/home/olivier/git/earl-grey/src/pp.eg",1860,2181);;}}}}}}(accum$14182=function(){if((tag$14177==="raw")){return [];}else{return ["<",tag$14177];}}());;if(id$14179){(accum$14182=accum$14182.concat(" id=\"",id$14179,"\""));}if(_classes$14178.length){(accum$14182=accum$14182.concat(" class=\"",quotify$13849(_classes$14178.join(" ")),"\""));}if(kv$14180){(acc$14277=[]);;(temp$14282=kv$14180);;($length$14287=temp$14282.length);;($index$14292=0);;$14274:for(;($index$14292<$length$14287);($index$14292++)){var k$14310;var v$14311;var t0$14305;var t1$14306;var m$14300;(m$14300=temp$14282[$index$14292]);;(t0$14305=m$14300);if(((t0$14305 instanceof Array)&&((t1$14306=t0$14305.length),(t1$14306===2)))){(k$14310=t0$14305[0]);(v$14311=t0$14305[1]);acc$14277.push((accum$14182=accum$14182.concat(function(){if((v$14311!==null)){return [" ",k$14310,"=\"",quotify$13849(v$14311),"\""];}else{return [" ",k$14310];}}())));}else{$14592(m$14300,"/home/olivier/git/earl-grey/src/pp.eg",2435,2632);;}}acc$14277;}(children$14171=((($14317$14319=tag$14177)),function(){if(($14317$14319==="raw")){(acc$14332=[]);;(temp$14337=children$14171);;($length$14342=temp$14337.length);;($index$14347=0);;$14329:for(;($index$14347<$length$14342);($index$14347++)){var c$14369;var s$14364;var t0$14360;var m$14355;(m$14355=temp$14337[$index$14347]);;(t0$14360=m$14355);if((typeof(t0$14360)==="string")){(s$14364=t0$14360);acc$14332.push(s$14364);}else{(c$14369=m$14355);acc$14332.push(HTML$13850(c$14369,default_tag$14107));}}return acc$14332;}else{(other$14373=$14317$14319);(acc$14378=[]);;(temp$14383=children$14171);;($length$14388=temp$14383.length);;($index$14393=0);;$14375:for(;($index$14393<$length$14388);($index$14393++)){var c$14409;var m$14401;(m$14401=temp$14383[$index$14393]);;(c$14409=m$14401);acc$14378.push(HTML$13850(c$14409,default_tag$14107));}return acc$14378;}}()));($14176$14412=tag$14177);;if(($14176$14412==="raw")){return accum$14182.concat(children$14171).join("");}else{(other$14424=$14176$14412);(x$14427=[">"].concat(children$14171).concat(["</",tag$14177,">"]));;return accum$14182.concat(x$14427).join("");}}else{(other$14433=$14109$14115);return HTML$13850([true,String(other$14433)][1],default_tag$14107);}}}});;(exports["pr_terminus"]=pr_terminus$13844);(exports["pr"]=pr$13845);(exports["<>"]=__lt____gt__$13846);(exports["repr"]=repr$13847);

},{}],12:[function(require,module,exports){
var $16074=function(type$16076){var f$16079;(f$16079=type$16076["::check"]);;if((f$16079===(void 0))){return function(value$16084){return (value$16084 instanceof type$16076);};}else{return function(value$16087){return f$16079.call(type$16076,value$16087);};}};
var $16089=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $16090=function(dest$16092,values$16093){var k$16098;(k$16098=null);$16096:for(k$16098 in values$16093){if(values$16093.hasOwnProperty(k$16098)){(dest$16092[k$16098]=values$16093[k$16098]);}}return dest$16092;};
var $16102=function($16103$16105){var ph$16109;(ph$16109=$16103$16105);;var $16107$16114;($16107$16114=ph$16109);;var bridge$16108$16119;var x$16123;(bridge$16108$16119=$16107$16114);if((((typeof(bridge$16108$16119)==="string")&&((x$16123=bridge$16108$16119),true))||((typeof(bridge$16108$16119)==="number")&&((x$16123=bridge$16108$16119),true)))){return ["value",x$16123];}else{var other$16130;(other$16130=$16107$16114);return other$16130["::serialize_ast"]();}};
var send$15914;(send$15914=function(obj$15919,$15917$15920){var ph$15924;var msg$15925;var t0$15927;(t0$15927=$15917$15920);(msg$15925=t0$15927);(ph$15924=t0$15927);;var $15922$15931;($15922$15931=ph$15924);;var bridge$15923$15936;(bridge$15923$15936=$15922$15931);if(((typeof(bridge$15923$15936)==="string")||(typeof(bridge$15923$15936)==="number"))){return obj$15919[msg$15925];}else{var other$15944;(other$15944=$15922$15931);return obj$15919["::send"](msg$15925);}});;(Array[":::project"]=function($15947$15949){var ph$15952;var value$15953;var t0$15955;(t0$15955=$15947$15949);(value$15953=t0$15955);(ph$15952=t0$15955);;var $15951$15959;($15951$15959=ph$15952);;if($16074(Array)($15951$15959)){return [true,value$15953];}else{$15951$15959;return [true,[value$15953]];}});(Array.prototype["::check"]=function(value$15973){if((value$15973 instanceof Array)){var i$15978;(i$15978=0);;$15976:for(;(i$15978<this.length);(i$15978++)){if(($16089(this,i$15978)!==$16089(value$15973,i$15978))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $16090(this.slice(0),this);});(Array.prototype[":::project"]=function(value$15989){if((value$15989 instanceof Array)){var i$15994;(i$15994=0);;$15992:for(;(i$15994<this.length);(i$15994++)){if(($16089(this,i$15994)!==$16089(value$15989,i$15994))){return [true,[value$15989]];}}return [true,value$15989.slice(this.length)];}else{return [true,[value$15989]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($16102));});(RegExp.prototype["::check"]=function($16004$16006){var ph$16009;(ph$16009=$16004$16006);;var $16008$16014;($16008$16014=ph$16009);;var value$16022;if((typeof($16008$16014)==="string")){(value$16022=$16008$16014);if(value$16022.match(this)){return true;}else{return false;}}else{var other$16027;(other$16027=$16008$16014);return false;}});(RegExp.prototype[":::project"]=function($16029$16031){var ph$16034;(ph$16034=$16029$16031);;var $16033$16039;($16033$16039=ph$16034);;var value$16047;if((typeof($16033$16039)==="string")){(value$16047=$16033$16039);var $16050$16052;($16050$16052=value$16047.match(this));;var m$16060;if(($16050$16052===null)){(m$16060=$16050$16052);return [false,null];}else{var m$16065;(m$16065=$16050$16052);return [true,m$16065];}}else{var other$16069;(other$16069=$16033$16039);return [false,null];}});(Function.prototype["::send"]=function(args$16072){return this.apply(this,args$16072);});
var $22703=function($22704$22706,key$22707){var ph$22711;(ph$22711=$22704$22706);;var $22709$22716;($22709$22716=ph$22711);;var bridge$22710$22721;(bridge$22710$22721=$22709$22716);if(((bridge$22710$22721===null)||(bridge$22710$22721===(void 0)))){return false;}else{var x$22729;if((typeof($22709$22716)==="string")){(x$22729=$22709$22716);return (key$22707 in String.prototype);}else{var x$22734;if((typeof($22709$22716)==="number")){(x$22734=$22709$22716);return (key$22707 in Number.prototype);}else{var x$22739;(x$22739=$22709$22716);return (key$22707 in x$22739);}}}};
var $22910=function(arr$22912){var results$22916;var l$22917;(results$22916=[]);;(l$22917=arr$22912.length);;var i$22925;(i$22925=0);;$22915:for(;(i$22925<l$22917);(i$22925++)){results$22916.push([i$22925,$16089(arr$22912,i$22925)]);}return results$22916;};
var $22932=function(value$22934,url$22935,start$22936,end$22937){var err$22940;(err$22940=$22741(["match"]).create("Could not find a match for value",({"value":value$22934})));;if(url$22935){(err$22940["location"]=["location",url$22935,start$22936,end$22937]);}throw err$22940;};
var $22741=function(){var $22742$22744;($22742$22744=function(tags$22748){var it$0$22751;(it$0$22751=function(){if((!$16074($22742$22744)(this))){return Object.create($22742$22744.prototype);}else{return this;}}());;(it$0$22751["tags"]=tags$22748);return it$0$22751;});;($22742$22744.prototype["create"]=function(){var $22760$22762;($22760$22762=arguments);;var t0$22767;var message$22771;var args$22772;(t0$22767=$22760$22762.length);if((t0$22767>=0)){(message$22771=function(){if((0>=t0$22767)){return "";}else{return $22760$22762[0];}}());(args$22772=Array.prototype.slice.call($22760$22762,1));var it$0$22776;(it$0$22776=this);;var self$22781;(self$22781=this);;var e$22786;(e$22786=Error(message$22771));;(e$22786["::tags"]=it$0$22776.tags);(e$22786["args"]=args$22772);var temp$22794;(temp$22794=$22910(args$22772));;var $length$22799;($length$22799=temp$22794.length);;var $index$22804;($index$22804=0);;$22787:for(;($index$22804<$length$22799);($index$22804++)){var m$22812;(m$22812=temp$22794[$index$22804]);;var t0$22817;var t1$22818;var i$22822;var arg$22823;(t0$22817=m$22812);if(((t0$22817 instanceof Array)&&((t1$22818=t0$22817.length),(t1$22818===2)))){(i$22822=t0$22817[0]);(arg$22823=t0$22817[1]);(e$22786[i$22822]=arg$22823);}else{$22932(m$22812);;}}(e$22786["length"]=args$22772.length);(e$22786["name"]=["E"].concat(it$0$22776.tags).join("."));return e$22786;}else{$22932($22760$22762);}});($22742$22744.prototype["::check"]=function(e$22834){var it$0$22837;(it$0$22837=this);;var self$22842;(self$22842=this);;var tags$22847;if(((!e$22834)||(!$16074(Error)(e$22834)))){return false;}(tags$22847=(e$22834["::tags"]||[]));;var temp$22856;(temp$22856=it$0$22837.tags);;var $length$22861;($length$22861=temp$22856.length);;var $index$22866;($index$22866=0);;$22848:for(;($index$22866<$length$22861);($index$22866++)){var m$22874;(m$22874=temp$22856[$index$22866]);;var tag$22882;(tag$22882=m$22874);if((tags$22847.indexOf(tag$22882)===-1)){return false;}else{false;;}}return true;});($22742$22744.prototype["::deconstruct"]=function(e$22890){var it$0$22893;(it$0$22893=this);;var self$22898;(self$22898=this);;return e$22890.args;});$16090($22742$22744,$16090(function(){var accum$22903;(accum$22903=({}));(accum$22903["::name"]="$22742");return accum$22903;}(),function(){var accum$22907;(accum$22907=({}));(accum$22907["::egclass"]=true);return accum$22907;}()));return $22742$22744;}();
var $22961=function($22962$22964){var ph$22970;var x$22971;var t0$22973;(t0$22973=$22962$22964);(x$22971=t0$22973);(ph$22970=t0$22973);;var $22966$22977;($22966$22977=ph$22970);;var bridge$22967$22982;(bridge$22967$22982=$22966$22977);if((function(){var bridge$22968$22988;(bridge$22968$22988=bridge$22967$22982);return (function(){var bridge$22969$22991;(bridge$22969$22991=bridge$22968$22988);return ((bridge$22969$22991===(void 0))||(bridge$22969$22991===null));}()||(typeof(bridge$22968$22988)==="string"));}()||(typeof(bridge$22967$22982)==="number"))){return x$22971;}else{if($22703($22966$22977,"::clone")){$22966$22977["::clone"];return x$22971["::clone"]();}else{$22966$22977;if((Object.getPrototypeOf(x$22971)===Object.prototype)){var dest$23004;(dest$23004=({}));;var k$23009;(k$23009=null);$23003:for(k$23009 in x$22971){if(Object.prototype.hasOwnProperty.call(x$22971,k$23009)){(dest$23004[k$23009]=x$22971[k$23009]);}}return dest$23004;}else{var other$23015;(other$23015=$22966$22977);throw $22741(["clone"]).create("Object cannot be cloned",({"obj":x$22971}));}}}};
var $22945=function(a$22947,b$22948){var dest$22952;(dest$22952=$22961(a$22947));;var k$22957;(k$22957=null);$22951:for(k$22957 in b$22948){if(Object.prototype.hasOwnProperty.call(b$22948,k$22957)){(dest$22952[k$22957]=b$22948[k$22957]);}}return dest$22952;};
var $23017=function(type$23019){return function(value$23022){var f$23025;(f$23025=type$23019[":::project"]);;if((f$23025===(void 0))){(f$23025=type$23019["::project"]);if((f$23025===(void 0))){return [true,type$23019(value$23022)];}else{var rval$23031;(rval$23031=false);;try{(rval$23031=[true,f$23025(value$23022)]);}catch(excv$23037){var e$23043;(e$23043=excv$23037);(rval$23031=[false,null]);}return rval$23031;}}else{return f$23025.call(type$23019,value$23022);}};};
var $23045=function(obj$23047){var results$23051;(results$23051=[]);;var k$23056;(k$23056=null);$23050:for(k$23056 in obj$23047){if(Object.prototype.hasOwnProperty.call(obj$23047,k$23056)){results$23051.push([k$23056,$16089(obj$23047,k$23056)]);}}return results$23051;};
var $23060=function(xs$23062,ys$23063){var acc$23068;(acc$23068=[]);;var temp$23073;(temp$23073=$22910(xs$23062));;var $length$23078;($length$23078=temp$23073.length);;var $index$23083;($index$23083=0);;$23065:for(;($index$23083<$length$23078);($index$23083++)){var m$23091;(m$23091=temp$23073[$index$23083]);;var t0$23096;var t1$23097;var i$23101;var x$23102;(t0$23096=m$23091);if(((t0$23096 instanceof Array)&&((t1$23097=t0$23096.length),(t1$23097===2)))){(i$23101=t0$23096[0]);(x$23102=t0$23096[1]);acc$23068.push([x$23102,$16089(ys$23063,i$23101)]);}else{$22932(m$23091);;}}return acc$23068;};var accum$16285;var accum$16289;var $index$16326;var $length$16321;var temp$16316;var accum$16910;var accum$16919;var accum$17014;var accum$17025;var accum$17032;var accum$17061;var accum$17069;var accum$17080;var accum$17326;var accum$17380;var accum$17444;var accum$17506;var accum$17526;var accum$17598;var accum$17682;var accum$17710;var accum$17760;var accum$17807;var accum$17854;var accum$17892;var accum$17998;var accum$18105;var accum$18234;var accum$18254;var accum$18658;var accum$18794;var accum$18885;var t0$18957;var accum$18955;var t0$19103;var accum$19101;var t0$19157;var accum$19155;var t0$19299;var accum$19297;var t0$19539;var accum$19537;var accum$19699;var accum$19834;var accum$19854;var accum$19874;var t0$19988;var accum$19986;var accum$20146;var t0$20168;var accum$20166;var t0$20184;var accum$20182;var t0$20200;var accum$20198;var t0$20216;var accum$20214;var accum$20230;var accum$20255;var accum$20497;var accum$20719;var accum$20857;var accum$21050;var accum$21149;var accum$21498;var accum$21697;var $index$21772;var $length$21767;var temp$17322;var accum$22549;var accum$22553;var mac$22563;var $index$22674;var $length$22669;var temp$22664;var $16134$16139;var __lt____gt__$16140;var $16135$16141;var __lt____lt____colon__$16142;var util$16143;var neighbours$16144;var uuid$16145;var $16137$16146;var PatternParser$16147;var PatternProcessor$16148;var parse_pattern$16149;var parse_clauses$16150;var mt$16151;var Expander$16152;var Scope$16153;var Env$16154;var nullenv$16155;var mac1$16156;var checker_db$16157;var generic_nodes$16158;var Embedded$16159;var stdenv$16160;var mkstdenv$16161;var expander$16162;var expand$16163;var topscope$16164;var embed_location$16165;var error_embed_location$16166;var match_error$16167;var drop_ctx$16168;var expr_mac$16169;var overridable$16170;var protected_value$16171;var setup_label$16172;var break_mac$16173;var continue_mac$16174;var var_operator$16175;var accum_flags$16176;var pattern_constructors$16177;var disregard_specials$16178;var pattern_handlers$16179;var build_loop$16180;var partial_pattern$16181;var make_assigner$16182;var blocktest_wrap$16183;var blocktest_mac$16184;var qqstruct$16185;var qq$16186;var RegexBuilder$16187;var build_regexp$16188;var errf_macro$16189;var stdprelude$16190;($16134$16139=require("./pp"));;(__lt____gt__$16140=$16134$16139["<>"]);;($16135$16141=require("./location"));;(__lt____lt____colon__$16142=$16135$16141["<<:"]);;(util$16143=require("./util"));;(neighbours$16144=util$16143.neighbours);;(uuid$16145=util$16143.uuid);;($16137$16146=require("./pattern"));;(PatternParser$16147=$16137$16146.PatternParser);;(PatternProcessor$16148=$16137$16146.PatternProcessor);;(parse_pattern$16149=$16137$16146.parse_pattern);;(parse_clauses$16150=$16137$16146.parse_clauses);;(mt$16151=require("./expand"));;(Expander$16152=mt$16151.Expander);;(Scope$16153=mt$16151.Scope);;(Env$16154=mt$16151.Env);;(nullenv$16155=mt$16151.nullenv);;(mac1$16156=mt$16151["mac1"]);;(checker_db$16157=mt$16151.checker_db);;(generic_nodes$16158=["if","js_while","js_for","js_for_in","js_label","js_break","js_continue","js_return","js_delete","js_throw","js_try","js_new"]);;(Embedded$16159=function(code$16260){var it$0$16263;(it$0$16263=function(){if((!$16074(Embedded$16159)(this))){return Object.create(Embedded$16159.prototype);}else{return this;}}());;(it$0$16263["code"]=mkstdenv$16161().convert(code$16260));(it$0$16263["::id"]=uuid$16145());return it$0$16263;});;(Embedded$16159.prototype["::serialize_ast"]=function(){var self$16280;var it$0$16275;(it$0$16275=this);;(self$16280=this);;return expand$16163(["top"],topscope$16164,it$0$16275.code);});$16090(Embedded$16159,$16090(((accum$16285=({})),((accum$16285["::name"]="Embedded"),accum$16285)),((accum$16289=({})),((accum$16289["::egclass"]=true),accum$16289))));Embedded$16159;(stdenv$16160=Env$16154());;(mkstdenv$16161=function(){var e$16300;(e$16300=Env$16154());;(e$16300.scopes["top"]=stdenv$16160.scopes.top);return e$16300;});;(expander$16162=Expander$16152(mkstdenv$16161,generic_nodes$16158));;(expand$16163=expander$16162.expand.bind(expander$16162));;(topscope$16164=Scope$16153(null,"top",expander$16162));;(temp$16316=["+","-","*","/","mod","&.","|.","^.","and","or","not","===","!==","<",">","<=",">=","<<",">>",">>>","in","instanceof","--","++","true","false","null","undefined","typeof","String","Array","Number","Boolean","Object","RegExp","Function","Date","parseInt","parseFloat","Math","Error","TypeError","ReferenceError","console","process","eval","setTimeout","clearTimeout","___js_fetch","___node","arguments","this","exports"]);;($length$16321=temp$16316.length);;($index$16326=0);;$16191:for(;($index$16326<$length$16321);($index$16326++)){var k$16342;var m$16334;(m$16334=temp$16316[$index$16326]);;(k$16342=m$16334);stdenv$16160.bind(topscope$16164,k$16342,["variable",k$16342]);}(embed_location$16165=function($16346$16348){var other$16377;var url$16366;var start$16367;var end$16368;var t0$16361;var t1$16362;var $16350$16356;var ph$16351;(ph$16351=$16346$16348);;($16350$16356=ph$16351);;if(($22703($16350$16356,"location")&&((t0$16361=$16350$16356.location),($22703(t0$16361,"source")&&((t1$16362=t0$16361.source),($22703(t1$16362,"url")&&((url$16366=t1$16362.url),($22703(t0$16361,"start")&&((start$16367=t0$16361.start),$22703(t0$16361,"end")))))))))){(end$16368=t0$16361.end);return ["send",["send",["symbol","#"],["data",["void"],["symbol","location"]]],["data",["value",url$16366],["value",start$16367],["value",end$16368]]];}else{(other$16377=$16350$16356);return ["send",["send",["symbol","#"],["data",["void"],["symbol","location"]]],["data",["symbol","null"],["value",0],["value",0]]];}});;(error_embed_location$16166=function(error$16383,target$16384){return ["send",["symbol","throw"],["send",["symbol","&:"],["data",error$16383,["data",["send",["symbol","="],["data",["symbol","location"],embed_location$16165(target$16384)]]]]]];});;(match_error$16167=function($16389$16391){var t0$16397;var other$16422;var url$16411;var start$16412;var end$16413;var t0$16406;var t1$16407;var $16393$16401;var ph$16394;var target$16395;(t0$16397=$16389$16391);(target$16395=t0$16397);(ph$16394=t0$16397);;($16393$16401=ph$16394);;if(($22703($16393$16401,"location")&&((t0$16406=$16393$16401.location),($22703(t0$16406,"source")&&((t1$16407=t0$16406.source),($22703(t1$16407,"url")&&((url$16411=t1$16407.url),($22703(t0$16406,"start")&&((start$16412=t0$16406.start),$22703(t0$16406,"end")))))))))){(end$16413=t0$16406.end);return ["send",["symbol","___match_error"],["data",target$16395,["value",url$16411],["value",start$16412],["value",end$16413]]];}else{(other$16422=$16393$16401);return ["send",["symbol","___match_error"],["data",other$16422]];}});;(drop_ctx$16168=function(f$16428){return function(context$16431,scope$16432,form$16433,arg$16434){var rval$16437;(rval$16437=false);;try{(rval$16437=f$16428(context$16431,scope$16432,form$16433,arg$16434));}catch(excv$16443){var t0$16460;var e$16465;var t0$16446;var t1$16447;var t2$16448;var t3$16449;var t4$16450;(t0$16446=excv$16443);if(($16074($22741(["match"]))(t0$16446)&&($22703(t0$16446,"args")&&((t1$16447=t0$16446.args),((t1$16447 instanceof Array)&&((t2$16448=t1$16447.length),((t2$16448===1)&&((t3$16449=t1$16447[0]),($22703(t3$16449,"value")&&((t4$16450=t3$16449.value),((t4$16450===context$16431)&&(!((t4$16450 instanceof Array)&&((t0$16460=t4$16450.length),((t0$16460===2)&&((t4$16450[0]==="expr")&&(t4$16450[1]==="expr"))))))))))))))))){(rval$16437=["nostep",form$16433]);}else{(e$16465=excv$16443);(rval$16437=function(){throw e$16465;}());}}return rval$16437;};});;(expr_mac$16169=function(f$16471){return function($16473$16475,scope$16476,form$16477,arg$16478){var t0$16498;var t0$16501;var otherwise$16506;var bridge$16481$16492;var $16480$16487;var ph$16482;(ph$16482=$16473$16475);;($16480$16487=ph$16482);;(bridge$16481$16492=$16480$16487);if((((bridge$16481$16492 instanceof Array)&&((t0$16498=bridge$16481$16492.length),((t0$16498===2)&&((bridge$16481$16492[0]==="expr")&&(bridge$16481$16492[1]==="expr")))))||((bridge$16481$16492 instanceof Array)&&((t0$16501=bridge$16481$16492.length),((t0$16501===2)&&((bridge$16481$16492[0]==="expr")&&(bridge$16481$16492[1]==="head"))))))){return f$16471(scope$16476,form$16477,arg$16478);}else{(otherwise$16506=$16480$16487);return ["nostep",form$16477];}};});;(overridable$16170=function(f$16512){return function($16514$16516,scope$16517,form$16518,arg$16519){var t0$16525;var x$16540;var other$16552;var t0$16534;var $16521$16529;var ph$16522;var context$16523;(t0$16525=$16514$16516);(context$16523=t0$16525);(ph$16522=t0$16525);;($16521$16529=ph$16522);;if((((x$16540=$16521$16529)),((x$16540 instanceof Array)&&(x$16540[0]==="pattern")))){return ["nostep",form$16518];}else{if((($16521$16529 instanceof Array)&&((t0$16534=$16521$16529.length),((t0$16534===2)&&(($16521$16529[0]==="expr")&&($16521$16529[1]==="multi")))))){return ["nostep",form$16518];}else{(other$16552=$16521$16529);return f$16512(context$16523,scope$16517,form$16518,arg$16519);}}};});;(protected_value$16171=function(name$16558,value$16559){return function($16561$16563,scope$16564,form$16565,arg$16566){var x$16584;var other$16609;var t0$16600;var $16593$16595;var other$16591;var $16568$16574;var ph$16569;(ph$16569=$16561$16563);;($16568$16574=ph$16569);;if((((x$16584=$16568$16574)),((x$16584 instanceof Array)&&(x$16584[0]==="pattern")))){throw $22741(["syntax","pattern"]).create((("'"+name$16558)+"' is not a valid pattern and cannot be redeclared"));}else{(other$16591=$16568$16574);($16593$16595=arg$16566);;if((($16593$16595 instanceof Array)&&((t0$16600=$16593$16595.length),((t0$16600===1)&&($16593$16595[0]==="void"))))){return ["value",value$16559];}else{(other$16609=$16593$16595);return ["send",["value",value$16559],arg$16566];}}};});;(setup_label$16172=function(label$16615,env$16616,body$16617){return ["bind",$22945(["symbol","break"],({"env":env$16616})),["macro",break_mac$16173(label$16615)],["bind",$22945(["symbol","continue"],({"env":env$16616})),["macro",continue_mac$16174(label$16615)],["js_label",["value",label$16615],body$16617]]];});;(break_mac$16173=function(default_label$16623){return overridable$16170(function(context$16627,scope$16628,form$16629,$16625$16630){var t0$16640;var v$16671;var v$16666;var $16633$16651;var $16634$16652;var $16635$16653;var $16636$16654;var t0$16649;var $16632$16644;var ph$16637;var expr$16638;(t0$16640=$16625$16630);(expr$16638=t0$16640);(ph$16637=t0$16640);;($16632$16644=ph$16637);;if((($16633$16651=($16632$16644 instanceof Array))&&((t0$16649=$16632$16644.length),(($16635$16653=(t0$16649===1))&&(($16636$16654=($16632$16644[0]==="void"))&&default_label$16623))))){return ["js_break",["value",default_label$16623]];}else{if($16636$16654){return ["js_break"];}else{if(($16633$16651&&(($16635$16653=(t0$16649===2))&&($16632$16644[0]==="value")))){(v$16666=$16632$16644[1]);return ["js_break",expr$16638];}else{if(($16635$16653&&($16632$16644[0]==="symbol"))){(v$16671=$16632$16644[1]);return ["js_break",["value",v$16671]];}else{$22932($16632$16644);}}}}});});;(continue_mac$16174=function(default_label$16680){return overridable$16170(function(context$16684,scope$16685,form$16686,$16682$16687){var t0$16697;var v$16728;var v$16723;var $16690$16708;var $16691$16709;var $16692$16710;var $16693$16711;var t0$16706;var $16689$16701;var ph$16694;var expr$16695;(t0$16697=$16682$16687);(expr$16695=t0$16697);(ph$16694=t0$16697);;($16689$16701=ph$16694);;if((($16690$16708=($16689$16701 instanceof Array))&&((t0$16706=$16689$16701.length),(($16692$16710=(t0$16706===1))&&(($16693$16711=($16689$16701[0]==="void"))&&default_label$16680))))){return ["js_continue",["value",default_label$16680]];}else{if($16693$16711){return ["js_continue"];}else{if(($16690$16708&&(($16692$16710=(t0$16706===2))&&($16689$16701[0]==="value")))){(v$16723=$16689$16701[1]);return ["js_continue",expr$16695];}else{if(($16692$16710&&($16689$16701[0]==="symbol"))){(v$16728=$16689$16701[1]);return ["js_continue",["value",v$16728]];}else{$22932($16689$16701);}}}}});});;(var_operator$16175=function(name$16737){return function(context$16740,scope$16741,form$16742,expr$16743){var t0$16753;var x$16780;var other$16797;var s$16791;var t0$16786;var t1$16787;var $16747$16777;var $16748$16768;var $16749$16769;var t0$16766;var $16746$16761;var env$16750;var sym$16751;(t0$16753=form$16742);if($22703(t0$16753,"env")){(env$16750=t0$16753.env);;}else{$22932(form$16742,"/home/olivier/git/earl-grey/src/stdenv.eg",3522,3526);}(sym$16751=$22945(["symbol",name$16737],({"env":env$16750})));;($16746$16761=expr$16743);;if((($16748$16768=($16746$16761 instanceof Array))&&((t0$16766=$16746$16761.length),((t0$16766===1)&&($16746$16761[0]==="void"))))){return sym$16751;}else{if(($16748$16768&&((t0$16766===3)&&(($16746$16761[0]==="data")&&(((x$16780=$16746$16761[1])),((x$16780 instanceof Array)&&(x$16780[0]==="void"))))))){($16747$16777=$16746$16761[2]);(t0$16786=$16747$16777);if(((t0$16786 instanceof Array)&&((t1$16787=t0$16786.length),((t1$16787===2)&&(t0$16786[0]==="symbol"))))){(s$16791=t0$16786[1]);return ["send",sym$16751,["value",s$16791]];}else{(other$16797=$16747$16777);return ["send",sym$16751,other$16797];}}else{$22932($16746$16761);}}};});;(accum_flags$16176=function(){var make$16821;var mac$16816;var also_values$16817;var t0$16812;var $16805$16807;($16805$16807=arguments);;(t0$16812=$16805$16807.length);if(((t0$16812>=1)&&(t0$16812<=2))){(mac$16816=$16805$16807[0]);(also_values$16817=function(){if((1>=t0$16812)){return true;}else{return $16805$16807[1];}}());(make$16821=function(flags$16825){return function(context$16829,scope$16830,form$16831,$16827$16832){var other$16881;var flag$16868;var flag$16861;var $16835$16857;var $16836$16858;var t0$16847;var t1$16848;var t2$16849;var t3$16850;var t4$16851;var t5$16852;var t6$16853;var t7$16854;var t8$16855;var $16834$16842;var ph$16837;(ph$16837=$16827$16832);;($16834$16842=ph$16837);;if((($16835$16857=($16834$16842 instanceof Array))&&((t0$16847=$16834$16842.length),((t0$16847===2)&&(($16834$16842[0]==="value")&&((flag$16861=$16834$16842[1]),also_values$16817)))))){return ["macro",make$16821(flags$16825.concat([flag$16861]))];}else{if(($16835$16857&&((t0$16847===3)&&(($16834$16842[0]==="send")&&((t1$16848=$16834$16842[1]),((t1$16848 instanceof Array)&&((t2$16849=t1$16848.length),((t2$16849===2)&&((t1$16848[0]==="symbol")&&((t1$16848[1]===".")&&((t3$16850=$16834$16842[2]),((t3$16850 instanceof Array)&&((t4$16851=t3$16850.length),((t4$16851===3)&&((t3$16850[0]==="data")&&((t5$16852=t3$16850[1]),((t5$16852 instanceof Array)&&((t6$16853=t5$16852.length),((t6$16853===1)&&((t5$16852[0]==="void")&&((t7$16854=t3$16850[2]),((t7$16854 instanceof Array)&&((t8$16855=t7$16854.length),((t8$16855===2)&&(t7$16854[0]==="symbol"))))))))))))))))))))))))){(flag$16868=t7$16854[1]);return ["macro",make$16821(flags$16825.concat([flag$16868]))];}else{(other$16881=$16834$16842);return mac$16816(context$16829,scope$16830,form$16831,other$16881,flags$16825);}}};});;return make$16821([]);}else{$22932($16805$16807);}});;(pattern_constructors$16177=({}));;(disregard_specials$16178=function($16892$16894,value$16895){var t0$16900;var t1$16901;var kind$16897;var expr$16898;(t0$16900=$16892$16894);if(((t0$16900 instanceof Array)&&((t1$16901=t0$16900.length),((t1$16901===2)&&(t0$16900[0]==="special"))))){(kind$16897=t0$16900[1]);(expr$16898=t0$16900);;}else{$22932($16892$16894);}throw $22741(["syntax","pattern","special"]).create("Special token cannot be used here",({"special":expr$16898}));});;(pattern_handlers$16179=({"declare_variables":$16090(({"allow_nested":true,"allow_arguments":true,"special":disregard_specials$16178}),$16090(((accum$16910=({})),((accum$16910["assign"]=function(v$16914,value$16915,tags$16916){return ["do",__lt____lt____colon__$16142(["assign",v$16914,value$16915],v$16914)];}),accum$16910)),$16090(({"finalize":true,"tags":({"declare_mode":"unqualified"})}),$16090(((accum$16919=({})),((accum$16919["declare"]=function(scope$16923,vars$16924){var $index$16944;var $length$16939;var temp$16934;var acc$16929;(acc$16929=[]);;(temp$16934=vars$16924);;($length$16939=temp$16934.length);;($index$16944=0);;$16926:for(;($index$16944<$length$16939);($index$16944++)){var msg$17007;var other$17004;var $16986$16988;var $16962$16964;var v$16960;var m$16952;(m$16952=temp$16934[$index$16944]);;(v$16960=m$16952);acc$16929.push(((($16962$16964=v$16960.declare_mode)),function(){if(($16962$16964==="set")){return ["splice"];}else{if(($16962$16964==="let")){return ["declare",$22945(v$16960,({"mutable":false}))];}else{if(($16962$16964==="var")){return ["declare",$22945(v$16960,({"mutable":true}))];}else{if(($16962$16964==="unqualified")){($16986$16988=v$16960.env.resolve(scope$16923,v$16960[1]));;if(($16986$16988===(void 0))){return ["declare",$22945(v$16960,({"mutable":false}))];}else{if(($22703($16986$16988,"mutable")&&$16986$16988.mutable)){return ["splice"];}else{(other$17004=$16986$16988);(msg$17007="Variable was declared read-only. Declare with 'var' to make it mutable.");;throw $22741(["syntax","redeclaring"]).create(msg$17007,({"variable":v$16960}));}}}else{$22932($16962$16964);}}}}}()));}return acc$16929;}),accum$16919)),$16090(((accum$17014=({})),((accum$17014["success"]=function($17017$17019){$17017$17019;;return ["multi"];}),accum$17014)),((accum$17025=({})),((accum$17025["failure"]=function(target$17029){return match_error$16167(target$17029);}),accum$17025))))))),"build_object":$16090(({"strings_as_variables":true,"allow_nested":true,"allow_arguments":true,"special":disregard_specials$16178}),$16090(((accum$17032=({})),((accum$17032["assign"]=function($17035$17039,value$17040,$17037$17041){var t0$17048;var t0$17052;var bridge$17036$17045;var v$17043;(bridge$17036$17045=$17035$17039);if((((bridge$17036$17045 instanceof Array)&&((t0$17048=bridge$17036$17045.length),((t0$17048===2)&&((bridge$17036$17045[0]==="symbol")&&((v$17043=bridge$17036$17045[1]),true)))))||((bridge$17036$17045 instanceof Array)&&((t0$17052=bridge$17036$17045.length),((t0$17052===2)&&((bridge$17036$17045[0]==="value")&&((v$17043=bridge$17036$17045[1]),true))))))){;}else{$22932($17035$17039);}$17037$17041;;return ["do",__lt____lt____colon__$16142(["assign",["send",["symbol","accum"],["value",v$17043]],value$17040],v$17043)];}),accum$17032)),$16090(({"finalize":true}),$16090(((accum$17061=({})),((accum$17061["declare"]=function(scope$17065,vars$17066){return [["declare",["symbol","accum"],["data",["symbol","="]]]];}),accum$17061)),$16090(((accum$17069=({})),((accum$17069["success"]=function($17072$17074){$17072$17074;;return ["symbol","accum"];}),accum$17069)),((accum$17080=({})),((accum$17080["failure"]=function(target$17084){return match_error$16167(target$17084);}),accum$17080)))))))}));;(build_loop$16180=function(scope$17090,env$17091,form$17092,li$17093,clauses$17094,wrap$17095,pre$17096,post$17097,opt$17098){var t0$17118;var t0$17155;var accum$17198;var lbl$17101;var i$17102;var len$17103;var first_mac$17104;var last_mac$17105;var newscope$17106;var m$17107;(lbl$17101=function(){if(env$17091){return $22945(["value",scope$17090.gensym()],({"env":env$17091}));}else{return ["value",scope$17090.gensym()];}}());;(i$17102=$22945(["symbol","$index"],({"env":env$17091})));;(len$17103=$22945(["symbol","$length"],({"env":env$17091})));;(t0$17118=$23017(drop_ctx$16168)(function($17120$17122,scope$17123,form$17124,subp$17125){var x$17130;if((((x$17130=$17120$17122)),((x$17130 instanceof Array)&&(x$17130[0]==="pattern")))){;}else{$22932($17120$17122);}return ["test",["send",["symbol","==="],["data",i$17102,["value",0]]],subp$17125];}));if(t0$17118[0]){(first_mac$17104=t0$17118[1]);;}else{$22932(function($17138$17140,scope$17141,form$17142,subp$17143){var x$17148;if((((x$17148=$17138$17140)),((x$17148 instanceof Array)&&(x$17148[0]==="pattern")))){;}else{$22932($17138$17140);}return ["test",["send",["symbol","==="],["data",i$17102,["value",0]]],subp$17143];});}(t0$17155=$23017(drop_ctx$16168)(function($17157$17159,scope$17160,form$17161,subp$17162){var x$17167;if((((x$17167=$17157$17159)),((x$17167 instanceof Array)&&(x$17167[0]==="pattern")))){;}else{$22932($17157$17159);}return ["test",["send",["symbol","==="],["data",i$17102,["send",["symbol","-"],["data",len$17103,["value",1]]]]],subp$17162];}));if(t0$17155[0]){(last_mac$17105=t0$17155[1]);;}else{$22932(function($17175$17177,scope$17178,form$17179,subp$17180){var x$17185;if((((x$17185=$17175$17177)),((x$17185 instanceof Array)&&(x$17185[0]==="pattern")))){;}else{$22932($17175$17177);}return ["test",["send",["symbol","==="],["data",i$17102,["send",["symbol","-"],["data",len$17103,["value",1]]]]],subp$17180];});}(newscope$17106=Scope$16153(scope$17090));;env$17091.bind(newscope$17106,"first",["macro",first_mac$17104]);env$17091.bind(newscope$17106,"last",["macro",last_mac$17105]);(m$17107=__lt____lt____colon__$16142(["symbol","m"],form$17092));;return ["multi",pre$17096,["send",["symbol","let"],["data",["multi",["send",["symbol","="],["data",["symbol","temp"],li$17093]],["send",["symbol","="],["data",len$17103,["send",["symbol","temp"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]]],["send",["send",["symbol","for"],lbl$17101],["data",["multi",["send",["symbol","="],["data",["send",["symbol","let"],i$17102],["value",0]]],["send",["symbol","<"],["data",i$17102,len$17103]],["send",["symbol","++"],["data",i$17102,["void"]]]],["multi",["send",["symbol","="],["data",m$17107,["send",["symbol","___js_fetch"],["data",["symbol","temp"],i$17102]]]],parse_clauses$16150(newscope$17106,m$17107,clauses$17094,$22945(opt$17098,((accum$17198=({})),((accum$17198["wrap"]=function(x$17202){return wrap$17095(x$17202,i$17102);}),accum$17198))))]]]]],post$17097];});;(partial_pattern$16181=function(operator$17208){var x$17226;var $17214$17216;var op$17211;(op$17211=((($17214$17216=operator$17208)),function(){if((((x$17226=$17214$17216)),((x$17226 instanceof Array)&&(x$17226[0]==="symbol")))){return operator$17208;}else{if((typeof($17214$17216)==="string")){return ["variable",operator$17208];}else{$22932($17214$17216);}}}()));;return function(context$17239,scope$17240,form$17241,expr$17242){var x$17269;var m$17279;var other$17295;var val$17265;var $17245$17260;var $17246$17261;var $17247$17262;var t0$17254;var t1$17255;var t2$17256;var t3$17257;var t4$17258;var $17244$17249;($17244$17249=[context$17239,expr$17242]);;if((($17245$17260=($17244$17249 instanceof Array))&&((t0$17254=$17244$17249.length),(($17247$17262=(t0$17254===2))&&((((x$17269=$17244$17249[0])),((x$17269 instanceof Array)&&(x$17269[0]==="pattern")))&&((t1$17255=$17244$17249[1]),((t1$17255 instanceof Array)&&((t2$17256=t1$17255.length),((t2$17256===3)&&((t1$17255[0]==="data")&&((t3$17257=t1$17255[1]),((t3$17257 instanceof Array)&&((t4$17258=t3$17257.length),((t4$17258===1)&&(t3$17257[0]==="void"))))))))))))))){(val$17265=t1$17255[2]);(m$17279=mac1$16156(function(x$17283){return ["send",op$17211,["data",x$17283,val$17265]];}));;return ["check",m$17279,["ignore"]];}else{if(($17247$17262&&($17244$17249[0],((t1$17255=$17244$17249[1]),((t1$17255 instanceof Array)&&((t2$17256=t1$17255.length),((t2$17256===1)&&(t1$17255[0]==="void")))))))){return op$17211;}else{(other$17295=$17244$17249);return ["send",op$17211,expr$17242];}}};});;(make_assigner$16182=function(op$17301){return function(context$17305,scope$17306,form$17307,$17303$17308){var t0$17313;var t1$17314;var a$17310;var b$17311;(t0$17313=$17303$17308);if(((t0$17313 instanceof Array)&&((t1$17314=t0$17313.length),((t1$17314===3)&&(t0$17313[0]==="data"))))){(a$17310=t0$17313[1]);(b$17311=t0$17313[2]);;}else{$22932($17303$17308);}return ["assign",a$17310,["send",["symbol",op$17301],["data",a$17310,b$17311]]];};});;(temp$17322=$23045($16090(({"true":protected_value$16171("true",true),"false":protected_value$16171("false",false),"null":protected_value$16171("null",null),"undefined":protected_value$16171("undefined",(void 0)),"===":partial_pattern$16181("==="),"!==":partial_pattern$16181("!=="),"==":partial_pattern$16181(["symbol","___equal"]),"!=":partial_pattern$16181(["symbol","___nequal"]),"<=":partial_pattern$16181("<="),">=":partial_pattern$16181(">="),"<":partial_pattern$16181("<"),">":partial_pattern$16181(">")}),$16090(((accum$17326=({})),((accum$17326["-"]=function(context$17331,scope$17332,form$17333,$17329$17334){var t0$17342;var other$17377;var n$17362;var $17337$17358;var $17338$17359;var t0$17351;var t1$17352;var t2$17353;var t3$17354;var t4$17355;var t5$17356;var $17336$17346;var ph$17339;var expr$17340;(t0$17342=$17329$17334);(expr$17340=t0$17342);(ph$17339=t0$17342);;($17336$17346=ph$17339);;if((($17337$17358=($17336$17346 instanceof Array))&&((t0$17351=$17336$17346.length),((t0$17351===3)&&(($17336$17346[0]==="data")&&((t1$17352=$17336$17346[1]),((t1$17352 instanceof Array)&&((t2$17353=t1$17352.length),((t2$17353===1)&&((t1$17352[0]==="void")&&((t3$17354=$17336$17346[2]),((t3$17354 instanceof Array)&&((t4$17355=t3$17354.length),((t4$17355===2)&&((t3$17354[0]==="value")&&((t5$17356=t3$17354[1]),(typeof(t5$17356)==="number"))))))))))))))))){(n$17362=t5$17356);return ["value",(-n$17362)];}else{if(($17337$17358&&((t0$17351===1)&&($17336$17346[0]==="void")))){return ["variable","-"];}else{(other$17377=$17336$17346);return ["send",["variable","-"],expr$17340];}}}),accum$17326)),$16090(((accum$17380=({})),((accum$17380["++"]=function(context$17385,scope$17386,form$17387,$17383$17388){var other$17441;var x$17431;var y$17432;var x$17423;var x$17415;var $17391$17409;var $17392$17410;var $17393$17411;var $17394$17412;var t0$17405;var t1$17406;var t2$17407;var $17390$17400;var ph$17395;(ph$17395=$17383$17388);;($17390$17400=ph$17395);;if((($17391$17409=($17390$17400 instanceof Array))&&((t0$17405=$17390$17400.length),(($17393$17411=(t0$17405===3))&&(($17394$17412=($17390$17400[0]==="data"))&&((t1$17406=$17390$17400[1]),((t1$17406 instanceof Array)&&((t2$17407=t1$17406.length),((t2$17407===1)&&(t1$17406[0]==="void")))))))))){(x$17415=$17390$17400[2]);return ["send",["variable","++"],["data",["void"],x$17415]];}else{if(($17394$17412&&((x$17423=$17390$17400[1]),((t1$17406=$17390$17400[2]),((t1$17406 instanceof Array)&&((t2$17407=t1$17406.length),((t2$17407===1)&&(t1$17406[0]==="void")))))))){return ["send",["variable","++"],["data",x$17423,["void"]]];}else{if($17394$17412){(x$17431=$17390$17400[1]);(y$17432=$17390$17400[2]);return ["send",["send",x$17431,["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",y$17432]];}else{if(($17391$17409&&((t0$17405===1)&&($17390$17400[0]==="void")))){return ["send",["symbol","->"],["data",["data",["symbol","x"],["symbol","y"]],["send",["send",["symbol","x"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",["symbol","y"]]]]];}else{(other$17441=$17390$17400);return ["send",["symbol","___build_array"],["data",other$17441]];}}}}}),accum$17380)),$16090(((accum$17444=({})),((accum$17444[".."]=function(context$17449,scope$17450,form$17451,$17447$17452){var x$17495;var y$17496;var x$17487;var x$17479;var $17455$17473;var $17456$17474;var $17457$17475;var $17458$17476;var t0$17469;var t1$17470;var t2$17471;var $17454$17464;var ph$17459;(ph$17459=$17447$17452);;($17454$17464=ph$17459);;if((($17455$17473=($17454$17464 instanceof Array))&&((t0$17469=$17454$17464.length),(($17457$17475=(t0$17469===3))&&(($17458$17476=($17454$17464[0]==="data"))&&((t1$17470=$17454$17464[1]),((t1$17470 instanceof Array)&&((t2$17471=t1$17470.length),((t2$17471===1)&&(t1$17470[0]==="void")))))))))){(x$17479=$17454$17464[2]);return ["send",["symbol","range"],["data",["value",1],x$17479]];}else{if(($17458$17476&&((x$17487=$17454$17464[1]),((t1$17470=$17454$17464[2]),((t1$17470 instanceof Array)&&((t2$17471=t1$17470.length),((t2$17471===1)&&(t1$17470[0]==="void")))))))){return ["send",["symbol","range"],["data",x$17487]];}else{if($17458$17476){(x$17495=$17454$17464[1]);(y$17496=$17454$17464[2]);return ["send",["symbol","range"],["data",x$17495,y$17496]];}else{if(($17455$17473&&((t0$17469===1)&&($17454$17464[0]==="void")))){return ["symbol","range"];}else{$22932($17454$17464);}}}}}),accum$17444)),$16090(((accum$17506=({})),((accum$17506["//"]=function(context$17511,scope$17512,form$17513,$17509$17514){var t0$17519;var t1$17520;var a$17516;var b$17517;(t0$17519=$17509$17514);if(((t0$17519 instanceof Array)&&((t1$17520=t0$17519.length),((t1$17520===3)&&(t0$17519[0]==="data"))))){(a$17516=t0$17519[1]);(b$17517=t0$17519[2]);;}else{$22932($17509$17514);}return ["send",["send",["symbol","Math"],["send",["symbol","."],["data",["void"],["symbol","floor"]]]],["data",["send",["symbol","/"],["data",a$17516,b$17517]]]];}),accum$17506)),$16090(((accum$17526=({})),((accum$17526["*"]=function(context$17530,scope$17531,form$17532,expr$17533){var x$17561;var x$17574;var t0$17579;var other$17595;var val$17570;var $17537$17553;var $17538$17554;var $17539$17555;var t0$17546;var t1$17547;var t2$17548;var bridge$17536$17549;var t3$17550;var t4$17551;var $17535$17541;($17535$17541=[context$17530,expr$17533]);;if((($17537$17553=($17535$17541 instanceof Array))&&((t0$17546=$17535$17541.length),(($17539$17555=(t0$17546===2))&&((((x$17561=$17535$17541[0])),((x$17561 instanceof Array)&&(x$17561[0]==="pattern")))&&((t1$17547=$17535$17541[1]),((t1$17547 instanceof Array)&&((t2$17548=t1$17547.length),((t2$17548===1)&&(t1$17547[0]==="void")))))))))){return ["dynsplice",["ignore"]];}else{if(($17539$17555&&((bridge$17536$17549=$17535$17541[0]),(((((x$17574=bridge$17536$17549)),((x$17574 instanceof Array)&&(x$17574[0]==="pattern")))||((bridge$17536$17549 instanceof Array)&&((t0$17579=bridge$17536$17549.length),((t0$17579===2)&&((bridge$17536$17549[0]==="expr")&&(bridge$17536$17549[1]==="data"))))))&&((t1$17547=$17535$17541[1]),((t1$17547 instanceof Array)&&((t2$17548=t1$17547.length),((t2$17548===3)&&((t1$17547[0]==="data")&&((t3$17550=t1$17547[1]),((t3$17550 instanceof Array)&&((t4$17551=t3$17550.length),((t4$17551===1)&&(t3$17550[0]==="void")))))))))))))){(val$17570=t1$17547[2]);return ["dynsplice",val$17570];}else{if(($17539$17555&&($17535$17541[0],((t1$17547=$17535$17541[1]),((t1$17547 instanceof Array)&&((t2$17548=t1$17547.length),((t2$17548===1)&&(t1$17547[0]==="void")))))))){return ["variable","*"];}else{(other$17595=$17535$17541);return ["send",["variable","*"],expr$17533];}}}}),accum$17526)),$16090(((accum$17598=({})),((accum$17598["**"]=function(context$17602,scope$17603,form$17604,expr$17605){var x$17641;var x$17654;var t0$17659;var a$17675;var b$17676;var val$17650;var $17609$17629;var $17610$17630;var $17611$17631;var $17612$17632;var $17613$17633;var $17614$17634;var $17615$17635;var t0$17622;var t1$17623;var t2$17624;var bridge$17608$17625;var t3$17626;var t4$17627;var $17607$17617;($17607$17617=[context$17602,expr$17605]);;if((($17609$17629=($17607$17617 instanceof Array))&&((t0$17622=$17607$17617.length),(($17611$17631=(t0$17622===2))&&((((x$17641=$17607$17617[0])),((x$17641 instanceof Array)&&(x$17641[0]==="pattern")))&&((t1$17623=$17607$17617[1]),((t1$17623 instanceof Array)&&((t2$17624=t1$17623.length),((t2$17624===1)&&(t1$17623[0]==="void")))))))))){return ["objsplice",["ignore"]];}else{if(($17611$17631&&((bridge$17608$17625=$17607$17617[0]),(((((x$17654=bridge$17608$17625)),((x$17654 instanceof Array)&&(x$17654[0]==="pattern")))||((bridge$17608$17625 instanceof Array)&&((t0$17659=bridge$17608$17625.length),((t0$17659===2)&&((bridge$17608$17625[0]==="expr")&&(bridge$17608$17625[1]==="data"))))))&&((t1$17623=$17607$17617[1]),((t1$17623 instanceof Array)&&((t2$17624=t1$17623.length),((t2$17624===3)&&((t1$17623[0]==="data")&&((t3$17626=t1$17623[1]),((t3$17626 instanceof Array)&&((t4$17627=t3$17626.length),((t4$17627===1)&&(t3$17626[0]==="void")))))))))))))){(val$17650=t1$17623[2]);return ["objsplice",val$17650];}else{if(($17611$17631&&($17607$17617[0],((t1$17623=$17607$17617[1]),(($17614$17634=(t1$17623 instanceof Array))&&((t2$17624=t1$17623.length),((t2$17624===1)&&(t1$17623[0]==="void")))))))){return ["send",["symbol","Math"],["send",["symbol","."],["data",["void"],["symbol","pow"]]]];}else{if(($17614$17634&&((t2$17624===3)&&(t1$17623[0]==="data")))){(a$17675=t1$17623[1]);(b$17676=t1$17623[2]);return ["send",["send",["symbol","Math"],["send",["symbol","."],["data",["void"],["symbol","pow"]]]],["data",a$17675,b$17676]];}else{$22932($17607$17617);}}}}}),accum$17598)),$16090(((accum$17682=({})),((accum$17682["_"]=function($17685$17688,scope$17689,form$17690,$17686$17691){var x$17696;var t0$17703;var t1$17704;if((((x$17696=$17685$17688)),((x$17696 instanceof Array)&&(x$17696[0]==="pattern")))){;}else{$22932($17685$17688);}(t0$17703=$17686$17691);if(((t0$17703 instanceof Array)&&((t1$17704=t0$17703.length),((t1$17704===1)&&(t0$17703[0]==="void"))))){;}else{$22932($17686$17691);}return ["ignore"];}),accum$17682)),$16090(((accum$17710=({})),((accum$17710["not"]=function($17713$17716,scope$17717,form$17718,$17714$17719){var t0$17729;var t1$17730;var t2$17731;var t3$17732;var x$17750;var other$17757;var $17721$17740;var ph$17722;var rhs$17723;var arg$17724;(ph$17722=$17713$17716);;(t0$17729=$17714$17719);if(((t0$17729 instanceof Array)&&((t1$17730=t0$17729.length),((t1$17730===3)&&((t0$17729[0]==="data")&&((t2$17731=t0$17729[1]),((t2$17731 instanceof Array)&&((t3$17732=t2$17731.length),((t3$17732===1)&&(t2$17731[0]==="void")))))))))){(rhs$17723=t0$17729[2]);(arg$17724=t0$17729);;}else{$22932($17714$17719);}($17721$17740=ph$17722);;if((((x$17750=$17721$17740)),((x$17750 instanceof Array)&&(x$17750[0]==="pattern")))){return ["neg",rhs$17723];}else{(other$17757=$17721$17740);return ["send",["variable","not"],arg$17724];}}),accum$17710)),$16090(((accum$17760=({})),((accum$17760["and"]=function($17763$17766,scope$17767,form$17768,$17764$17769){var t0$17780;var t1$17781;var x$17797;var other$17804;var $17771$17787;var ph$17772;var lhs$17773;var rhs$17774;var arg$17775;(ph$17772=$17763$17766);;(t0$17780=$17764$17769);if(((t0$17780 instanceof Array)&&((t1$17781=t0$17780.length),((t1$17781===3)&&(t0$17780[0]==="data"))))){(lhs$17773=t0$17780[1]);(rhs$17774=t0$17780[2]);(arg$17775=t0$17780);;}else{$22932($17764$17769);}($17771$17787=ph$17772);;if((((x$17797=$17771$17787)),((x$17797 instanceof Array)&&(x$17797[0]==="pattern")))){return ["all",lhs$17773,rhs$17774];}else{(other$17804=$17771$17787);return ["send",["variable","and"],arg$17775];}}),accum$17760)),$16090(((accum$17807=({})),((accum$17807["or"]=function($17810$17813,scope$17814,form$17815,$17811$17816){var t0$17827;var t1$17828;var x$17844;var other$17851;var $17818$17834;var ph$17819;var lhs$17820;var rhs$17821;var arg$17822;(ph$17819=$17810$17813);;(t0$17827=$17811$17816);if(((t0$17827 instanceof Array)&&((t1$17828=t0$17827.length),((t1$17828===3)&&(t0$17827[0]==="data"))))){(lhs$17820=t0$17827[1]);(rhs$17821=t0$17827[2]);(arg$17822=t0$17827);;}else{$22932($17811$17816);}($17818$17834=ph$17819);;if((((x$17844=$17818$17834)),((x$17844 instanceof Array)&&(x$17844[0]==="pattern")))){return ["any",lhs$17820,rhs$17821];}else{(other$17851=$17818$17834);return ["send",["variable","or"],arg$17822];}}),accum$17807)),$16090(((accum$17854=({})),((accum$17854["when"]=function(context$17859,scope$17860,form$17861,$17857$17862){var t0$17868;var t1$17869;var other$17889;var t0$17880;var $17864$17875;var ph$17865;var condition$17866;(t0$17868=$17857$17862);if(((t0$17868 instanceof Array)&&((t1$17869=t0$17868.length),((t1$17869===3)&&(t0$17868[0]==="data"))))){(ph$17865=t0$17868[1]);(condition$17866=t0$17868[2]);;}else{$22932($17857$17862);}($17864$17875=ph$17865);;if((($17864$17875 instanceof Array)&&((t0$17880=$17864$17875.length),((t0$17880===1)&&($17864$17875[0]==="void"))))){return ["test",condition$17866,["ignore"]];}else{(other$17889=$17864$17875);return ["test",condition$17866,other$17889];}}),accum$17854)),$16090(((accum$17892=({})),((accum$17892["."]=function(context$17897,scope$17898,form$17899,$17895$17900){var t0$17904;var t1$17905;var t2$17906;var t3$17907;var f$17915;var expr$17902;(t0$17904=$17895$17900);if(((t0$17904 instanceof Array)&&((t1$17905=t0$17904.length),((t1$17905===3)&&((t0$17904[0]==="data")&&((t2$17906=t0$17904[1]),((t2$17906 instanceof Array)&&((t3$17907=t2$17906.length),((t3$17907===1)&&(t2$17906[0]==="void")))))))))){(expr$17902=t0$17904[2]);;}else{$22932($17895$17900);}(f$17915=function($17918$17920){var t0$17942;var t0$17946;var $index$17974;var $length$17969;var temp$17964;var acc$17959;var other$17994;var args$17952;var x$17939;var bridge$17923$17934;var t0$17935;var $17922$17929;var ph$17924;(ph$17924=$17918$17920);;($17922$17929=ph$17924);;(bridge$17923$17934=$17922$17929);if((((bridge$17923$17934 instanceof Array)&&((t0$17942=bridge$17923$17934.length),((t0$17942===2)&&((bridge$17923$17934[0]==="symbol")&&((x$17939=bridge$17923$17934[1]),true)))))||((bridge$17923$17934 instanceof Array)&&((t0$17946=bridge$17923$17934.length),((t0$17946===2)&&((bridge$17923$17934[0]==="value")&&((x$17939=bridge$17923$17934[1]),true))))))){return ["value",x$17939];}else{if((($17922$17929 instanceof Array)&&((t0$17935=$17922$17929.length),((t0$17935>=1)&&($17922$17929[0]==="data"))))){(args$17952=Array.prototype.slice.call($17922$17929,1));return ["data"].concat((((acc$17959=[])),(((temp$17964=args$17952)),((($length$17969=temp$17964.length)),((($index$17974=0)),function(){$17956:for(;($index$17974<$length$17969);($index$17974++)){var arg$17990;var m$17982;(m$17982=temp$17964[$index$17974]);;(arg$17990=m$17982);acc$17959.push(f$17915(arg$17990));}}()))),acc$17959));}else{(other$17994=$17922$17929);throw $22741(["syntax","dot"]).create("Argument to '.' must be a symbol or an array",({"argument":other$17994}));}}});;return f$17915(expr$17902);}),accum$17892)),$16090(((accum$17998=({})),((accum$17998["="]=function(context$18002,scope$18003,form$18004,expr$18005){var t0$18033;var t1$18034;var lhs$18030;var rhs$18031;var lhs$18077;var rhs$18078;var s$18069;var rhs$18070;var $18044$18058;var $18045$18059;var $18046$18060;var $18047$18061;var t0$18054;var t1$18055;var t2$18056;var $18043$18049;var x$18087;var t0$18096;var t1$18097;var lhs$18093;var rhs$18094;var $18008$18020;var $18009$18021;var $18010$18022;var $18011$18023;var t0$18018;var $18007$18013;($18007$18013=context$18002);;if((($18008$18020=($18007$18013 instanceof Array))&&((t0$18018=$18007$18013.length),(($18010$18022=(t0$18018===2))&&(($18011$18023=($18007$18013[0]==="expr"))&&($18007$18013[1]==="multi")))))){(t0$18033=expr$18005);if(((t0$18033 instanceof Array)&&((t1$18034=t0$18033.length),((t1$18034===3)&&(t0$18033[0]==="data"))))){(lhs$18030=t0$18033[1]);(rhs$18031=t0$18033[2]);;}else{$22932(expr$18005,"/home/olivier/git/earl-grey/src/stdenv.eg",11197,11201);}return parse_pattern$16149(scope$18003,lhs$18030,__lt____lt____colon__$16142(["use",scope$18003,rhs$18031],rhs$18031),pattern_handlers$16179.declare_variables);}else{if(($18011$18023&&($18007$18013[1]==="data"))){($18043$18049=expr$18005);;if((($18044$18058=($18043$18049 instanceof Array))&&((t0$18054=$18043$18049.length),((t0$18054===1)&&($18043$18049[0]==="void"))))){return ["assoc"];}else{if(($18044$18058&&(($18046$18060=(t0$18054===3))&&(($18047$18061=($18043$18049[0]==="data"))&&((t1$18055=$18043$18049[1]),((t1$18055 instanceof Array)&&((t2$18056=t1$18055.length),((t2$18056===2)&&(t1$18055[0]==="symbol"))))))))){(s$18069=t1$18055[1]);(rhs$18070=$18043$18049[2]);return ["assoc",["value",s$18069],rhs$18070];}else{if($18047$18061){(lhs$18077=$18043$18049[1]);(rhs$18078=$18043$18049[2]);return ["objsplice",["multi",parse_pattern$16149(scope$18003,lhs$18077,__lt____lt____colon__$16142(["use",scope$18003,rhs$18078],rhs$18078),pattern_handlers$16179.build_object)]];}else{$22932($18043$18049);}}}}else{if((((x$18087=$18007$18013)),((x$18087 instanceof Array)&&(x$18087[0]==="pattern")))){(t0$18096=expr$18005);if(((t0$18096 instanceof Array)&&((t1$18097=t0$18096.length),((t1$18097===3)&&(t0$18096[0]==="data"))))){(lhs$18093=t0$18096[1]);(rhs$18094=t0$18096[2]);;}else{$22932(expr$18005,"/home/olivier/git/earl-grey/src/stdenv.eg",11834,11838);}return ["default",lhs$18093,rhs$18094];}else{$22932($18007$18013);}}}}),accum$17998)),$16090(((accum$18105=({})),((accum$18105["=>"]=function($18108$18112,scope$18113,$18109$18114,$18110$18115){var t0$18126;var t0$18131;var t1$18132;var x$18148;var x$18178;var t0$18184;var t0$18188;var t0$18199;var t0$18203;var k$18194;var rhs$18195;var k$18174;var $18156$18169;var $18157$18170;var $18158$18171;var t0$18165;var bridge$18154$18166;var bridge$18155$18167;var $18153$18160;var x$18213;var t0$18221;var t1$18222;var t2$18223;var stmts$18219;var other$18231;var $18117$18138;var ph$18118;var env$18119;var lhs$18120;var rhs$18121;(ph$18118=$18108$18112);;(t0$18126=$18109$18114);if($22703(t0$18126,"env")){(env$18119=t0$18126.env);;}else{$22932($18109$18114);}(t0$18131=$18110$18115);if(((t0$18131 instanceof Array)&&((t1$18132=t0$18131.length),((t1$18132===3)&&(t0$18131[0]==="data"))))){(lhs$18120=t0$18131[1]);(rhs$18121=t0$18131[2]);;}else{$22932($18110$18115);}($18117$18138=ph$18118);;if((((x$18148=$18117$18138)),((x$18148 instanceof Array)&&(x$18148[0]==="pattern")))){($18153$18160=[lhs$18120,rhs$18121]);;if((($18156$18169=($18153$18160 instanceof Array))&&((t0$18165=$18153$18160.length),(($18158$18171=(t0$18165===2))&&((((x$18178=$18153$18160[0])),((x$18178 instanceof Array)&&(x$18178[0]==="void")))&&((bridge$18154$18166=$18153$18160[1]),(((bridge$18154$18166 instanceof Array)&&((t0$18184=bridge$18154$18166.length),((t0$18184===2)&&((bridge$18154$18166[0]==="symbol")&&((k$18174=bridge$18154$18166[1]),true)))))||((bridge$18154$18166 instanceof Array)&&((t0$18188=bridge$18154$18166.length),((t0$18188===2)&&((bridge$18154$18166[0]==="value")&&((k$18174=bridge$18154$18166[1]),true)))))))))))){return ["assoc",["value",k$18174],$22945(__lt____lt____colon__$16142(["symbol",k$18174],rhs$18121),({"env":env$18119}))];}else{if(($18158$18171&&((bridge$18155$18167=$18153$18160[0]),(((bridge$18155$18167 instanceof Array)&&((t0$18199=bridge$18155$18167.length),((t0$18199===2)&&((bridge$18155$18167[0]==="symbol")&&((k$18194=bridge$18155$18167[1]),true)))))||((bridge$18155$18167 instanceof Array)&&((t0$18203=bridge$18155$18167.length),((t0$18203===2)&&((bridge$18155$18167[0]==="value")&&((k$18194=bridge$18155$18167[1]),true))))))))){(rhs$18195=$18153$18160[1]);return ["assoc",["value",k$18194],rhs$18195];}else{$22932($18153$18160);}}}else{if((((x$18213=$18117$18138)),((x$18213 instanceof Array)&&(x$18213[0]==="test")))){(t0$18221=$23017(["multi"])(rhs$18121));if((t0$18221[0]&&((t1$18222=t0$18221[1]),((t2$18223=t1$18222.length),(t2$18223>=0))))){(stmts$18219=Array.prototype.slice.call(t1$18222,0));;}else{$22932(rhs$18121,"/home/olivier/git/earl-grey/src/stdenv.eg",12321,12324);}return ["blocktest",lhs$18120,stmts$18219];}else{(other$18231=$18117$18138);return ["assoc",lhs$18120,rhs$18121];}}}),accum$18105)),$16090(((accum$18234=({})),((accum$18234[":="]=function(context$18239,scope$18240,form$18241,$18237$18242){var t0$18247;var t1$18248;var lhs$18244;var rhs$18245;(t0$18247=$18237$18242);if(((t0$18247 instanceof Array)&&((t1$18248=t0$18247.length),((t1$18248===3)&&(t0$18247[0]==="data"))))){(lhs$18244=t0$18247[1]);(rhs$18245=t0$18247[2]);;}else{$22932($18237$18242);}return ["assign",lhs$18244,rhs$18245];}),accum$18234)),$16090(({"+=":make_assigner$16182("+"),"-=":make_assigner$16182("-"),"*=":make_assigner$16182("*"),"/=":make_assigner$16182("/"),"<<=":make_assigner$16182("<<"),">>=":make_assigner$16182(">>"),">>>=":make_assigner$16182(">>>"),"++=":make_assigner$16182("++"),"?=":make_assigner$16182("match"),"or=":make_assigner$16182("or"),"and=":make_assigner$16182("and"),"each=":make_assigner$16182("each")}),$16090(((accum$18254=({})),((accum$18254["->"]=function($18257$18259,scope$18260,form$18261,expr$18262){var x$18280;var t0$18289;var t1$18290;var lhs$18286;var rhs$18287;var $index$18394;var $length$18389;var temp$18384;var acc$18379;var decls$18368;var newargs$18369;var body$18485;var a$18480;var other$18477;var fw$18358;var t0$18350;var t1$18351;var t2$18352;var t3$18353;var t4$18354;var $18339$18345;var pp$18340;var other$18497;var args$18491;var rhs$18492;var args$18330;var arg$18331;var rhs$18332;var $18300$18319;var $18301$18320;var $18302$18321;var $18303$18322;var $18304$18323;var $18305$18324;var $18306$18325;var $18307$18326;var $18308$18327;var t0$18315;var t1$18316;var t2$18317;var $18299$18310;var other$18297;var $18264$18270;var ph$18265;(ph$18265=$18257$18259);;($18264$18270=ph$18265);;if((((x$18280=$18264$18270)),((x$18280 instanceof Array)&&(x$18280[0]==="clause")))){(t0$18289=expr$18262);if(((t0$18289 instanceof Array)&&((t1$18290=t0$18289.length),((t1$18290===3)&&(t0$18289[0]==="data"))))){(lhs$18286=t0$18289[1]);(rhs$18287=t0$18289[2]);;}else{$22932(expr$18262,"/home/olivier/git/earl-grey/src/stdenv.eg",12941,12945);}return ["clause",lhs$18286,rhs$18287];}else{(other$18297=$18264$18270);($18299$18310=expr$18262);;if((($18300$18319=($18299$18310 instanceof Array))&&((t0$18315=$18299$18310.length),(($18302$18321=(t0$18315===3))&&(($18303$18322=($18299$18310[0]==="data"))&&((t1$18316=$18299$18310[1]),(($18305$18324=(t1$18316 instanceof Array))&&((t2$18317=t1$18316.length),(($18307$18326=(t2$18317>=1))&&($18308$18327=(t1$18316[0]==="data"))))))))))){(args$18330=Array.prototype.slice.call(t1$18316,1));(arg$18331=t1$18316);(rhs$18332=$18299$18310[2]);(pp$18340=PatternParser$16147(scope$18260,arg$18331,({"indexable":true,"allow_nested":true})));;($18339$18345=pp$18340.pattern);;if((($18339$18345 instanceof Array)&&((t0$18350=$18339$18345.length),((t0$18350===5)&&(($18339$18345[0]==="array_pattern")&&((fw$18358=$18339$18345[1]),((t1$18351=$18339$18345[2]),((t1$18351 instanceof Array)&&((t2$18352=t1$18351.length),((t2$18352===0)&&((t3$18353=$18339$18345[3]),((t3$18353 instanceof Array)&&((t4$18354=t3$18353.length),((t4$18354===0)&&($18339$18345[4]===(void 0)))))))))))))))){(decls$18368=function(){if(pp$18340.specials.match){return [["declare",["symbol","ph"]]];}else{return [];}}());;(newargs$18369=(((acc$18379=[])),(((temp$18384=$23060(fw$18358,args$18330))),((($length$18389=temp$18384.length)),((($index$18394=0)),function(){$18375:for(;($index$18394<$length$18389);($index$18394++)){var newv$18438;var other$18435;var expr$18425;var v$18426;var t0$18418;var t1$18419;var t2$18420;var t3$18421;var arg$18412;var $18377$18413;var t0$18407;var t1$18408;var m$18402;(m$18402=temp$18384[$index$18394]);;(t0$18407=m$18402);if(((t0$18407 instanceof Array)&&((t1$18408=t0$18407.length),(t1$18408===2)))){($18377$18413=t0$18407[0]);(arg$18412=t0$18407[1]);(t0$18418=$18377$18413);if(((t0$18418 instanceof Array)&&((t1$18419=t0$18418.length),((t1$18419===2)&&((t0$18418[0]==="assign")&&((t2$18420=t0$18418[1]),((expr$18425=t2$18420),((t2$18420 instanceof Array)&&((t3$18421=t2$18420.length),((t3$18421===2)&&(t2$18420[0]==="symbol"))))))))))){(v$18426=t2$18420[1]);acc$18379.push(expr$18425);}else{(other$18435=$18377$18413);acc$18379.push((((newv$18438=$22945(["symbol",scope$18260.gensym("temp")],({"env":stdenv$16160})))),decls$18368.push(parse_pattern$16149(scope$18260,arg$18412,newv$18438,$22945(pattern_handlers$16179.declare_variables,({"tags":({"declare_mode":"let"}),"special":function($18442$18444,value$18445){var t0$18451;var t1$18452;var other$18470;var $18447$18458;var ph$18448;var expr$18449;(t0$18451=$18442$18444);if(((t0$18451 instanceof Array)&&((t1$18452=t0$18451.length),((t1$18452===2)&&(t0$18451[0]==="special"))))){(ph$18448=t0$18451[1]);(expr$18449=t0$18451);;}else{$22932($18442$18444);}($18447$18458=ph$18448);;if(($18447$18458==="match")){return ["assign",["symbol","ph"]];}else{(other$18470=$18447$18458);throw $22741(["syntax","pattern","special"]).create("Special token cannot be used here",({"special":expr$18449}));}}})))),newv$18438));}}else{$22932(m$18402,"/home/olivier/git/earl-grey/src/stdenv.eg",13417,14444);;}}}()))),acc$18379));;return ["lambda",newargs$18369,["multi"].concat(decls$18368).concat([function(){if(pp$18340.specials.match){return ["send",["symbol","match"],["data",["symbol","ph"],rhs$18332]];}else{return rhs$18332;}}()])];}else{(other$18477=$18339$18345);(a$18480=__lt____lt____colon__$16142(["symbol","arguments"],arg$18331));;(body$18485=["send",["send",["symbol","match"],["send",["symbol","."],["data",["void"],["symbol","indexable"]]]],["data",a$18480,["send",["symbol","->"],["data",arg$18331,rhs$18332]]]]);;return ["lambda",[],body$18485];}}else{if($18308$18327){(args$18491=Array.prototype.slice.call(t1$18316,1));(rhs$18492=$18299$18310[2]);return ["lambda",args$18491,rhs$18492];}else{(other$18497=$18299$18310);throw $22741(["syntax","lambda"]).create("Bad lambda syntax",({"node":other$18497}));}}}}),accum$18254)),$16090(({"match":accum_flags$16176(function($18499$18501,scope$18502,form$18503,expr$18504,flags$18505){var x$18523;var other$18544;var t0$18535;var $18528$18530;var v$18592;var b$18593;var b$18583;var $18566$18579;var $18567$18580;var t0$18574;var t1$18575;var t2$18576;var t3$18577;var $18565$18569;var v$18632;var b$18633;var b$18623;var $18606$18619;var $18607$18620;var t0$18614;var t1$18615;var t2$18616;var t3$18617;var $18605$18609;var t0$18562;var t1$18563;var accum$18647;var mbody$18643;var opt$18551;var to_match$18552;var value$18553;var body$18554;var other$18548;var $18507$18513;var ph$18508;(ph$18508=$18499$18501);;($18507$18513=ph$18508);;if((((x$18523=$18507$18513)),((x$18523 instanceof Array)&&(x$18523[0]==="pattern")))){($18528$18530=expr$18504);;if((($18528$18530 instanceof Array)&&((t0$18535=$18528$18530.length),((t0$18535===1)&&($18528$18530[0]==="void"))))){return ["special","match"];}else{(other$18544=$18528$18530);return ["all",__lt____lt____colon__$16142(other$18544,expr$18504),__lt____lt____colon__$16142(["special","match"],form$18503)];}}else{(other$18548=$18507$18513);(opt$18551=util$16143.mkset(flags$18505));;(to_match$18552=$22945(["symbol",scope$18502.gensym("m")],({"single_assignment":true})));;(t0$18562=((($18565$18569=expr$18504)),function(){if((($18566$18579=($18565$18569 instanceof Array))&&((t0$18574=$18565$18569.length),((t0$18574===2)&&(($18565$18569[0]==="data")&&((t1$18575=$23017(["multi"])($18565$18569[1])),(t1$18575[0]&&((t2$18576=t1$18575[1]),((t3$18577=t2$18576.length),(t3$18577>=0)))))))))){(b$18583=Array.prototype.slice.call(t2$18576,0));return [["value",null],b$18583];}else{if(($18566$18579&&((t0$18574===3)&&(($18565$18569[0]==="data")&&((v$18592=$18565$18569[1]),((t1$18575=$23017(["multi"])($18565$18569[2])),(t1$18575[0]&&((t2$18576=t1$18575[1]),((t3$18577=t2$18576.length),(t3$18577>=0)))))))))){(b$18593=Array.prototype.slice.call(t2$18576,0));return [v$18592,b$18593];}else{$22932($18565$18569);}}}()));if(((t0$18562 instanceof Array)&&((t1$18563=t0$18562.length),(t1$18563===2)))){(value$18553=t0$18562[0]);(body$18554=t0$18562[1]);;}else{$22932(((($18605$18609=expr$18504)),function(){if((($18606$18619=($18605$18609 instanceof Array))&&((t0$18614=$18605$18609.length),((t0$18614===2)&&(($18605$18609[0]==="data")&&((t1$18615=$23017(["multi"])($18605$18609[1])),(t1$18615[0]&&((t2$18616=t1$18615[1]),((t3$18617=t2$18616.length),(t3$18617>=0)))))))))){(b$18623=Array.prototype.slice.call(t2$18616,0));return [["value",null],b$18623];}else{if(($18606$18619&&((t0$18614===3)&&(($18605$18609[0]==="data")&&((v$18632=$18605$18609[1]),((t1$18615=$23017(["multi"])($18605$18609[2])),(t1$18615[0]&&((t2$18616=t1$18615[1]),((t3$18617=t2$18616.length),(t3$18617>=0)))))))))){(b$18633=Array.prototype.slice.call(t2$18616,0));return [v$18632,b$18633];}else{$22932($18605$18609);}}}()),"/home/olivier/git/earl-grey/src/stdenv.eg",15379,15498);}(mbody$18643=parse_clauses$16150(scope$18502,to_match$18552,body$18554,$22945(opt$18551,$16090(((accum$18647=({})),((accum$18647["fallback"]=function(target$18651){return match_error$16167(target$18651);}),accum$18647)),({"wrap":function(x$18654){return x$18654;}})))));;return ["send",["symbol","let"],["data",["send",["symbol","="],["data",to_match$18552,value$18553]],mbody$18643]];}})}),$16090(((accum$18658=({})),((accum$18658["each"]=function($18661$18665,scope$18666,$18662$18667,$18663$18668){var t0$18684;var t0$18689;var t1$18690;var t2$18691;var t3$18692;var t4$18693;var x$18769;var other$18788;var ends_with_test$18715;var _build_loop$18716;var $18671$18710;var $18672$18711;var $18673$18712;var $18674$18713;var t0$18708;var $18670$18703;var ph$18675;var form$18676;var env$18677;var li$18678;var clauses$18679;(ph$18675=$18661$18665);;(t0$18684=$18662$18667);(form$18676=t0$18684);if($22703(t0$18684,"env")){(env$18677=t0$18684.env);;}else{$22932($18662$18667);}(t0$18689=$18663$18668);if(((t0$18689 instanceof Array)&&((t1$18690=t0$18689.length),((t1$18690===3)&&((t0$18689[0]==="data")&&((li$18678=t0$18689[1]),((t2$18691=$23017(["multi"])(t0$18689[2])),(t2$18691[0]&&((t3$18692=t2$18691[1]),((t4$18693=t3$18692.length),(t4$18693>=0))))))))))){(clauses$18679=Array.prototype.slice.call(t3$18692,0));;}else{$22932($18663$18668);}($18670$18703=ph$18675);;(ends_with_test$18715=false);;(_build_loop$18716=function(wrap$18723,pre$18724,post$18725){var accum$18728;var accum$18758;return build_loop$16180(scope$18666,env$18677,form$18676,li$18678,clauses$18679,wrap$18723,pre$18724,post$18725,$16090(((accum$18728=({})),((accum$18728["wrap_pattern"]=function(x$18732,toplevel$18733){var x$18748;var other$18755;var $18736$18738;(ends_with_test$18715=((($18736$18738=x$18732)),function(){if((((x$18748=$18736$18738)),((x$18748 instanceof Array)&&(x$18748[0]==="test")))){return toplevel$18733;}else{(other$18755=$18736$18738);return false;}}()));return x$18732;}),accum$18728)),((accum$18758=({})),((accum$18758["fallback"]=function(target$18762){if(ends_with_test$18715){return ["symbol","false"];}else{return match_error$16167(target$18762);}}),accum$18758))));});;if((((x$18769=$18670$18703)),((x$18769 instanceof Array)&&(x$18769[0]==="test")))){return $22945(["test_factory",li$18678,clauses$18679],({"env":env$18677}));}else{if((($18671$18710=($18670$18703 instanceof Array))&&((t0$18708=$18670$18703.length),(($18673$18712=(t0$18708===2))&&(($18674$18713=($18670$18703[0]==="expr"))&&($18670$18703[1]==="multi")))))){return ["nostep",form$18676];}else{if(($18674$18713&&($18670$18703[1]==="ignore"))){return _build_loop$18716(function(x$18784){return x$18784;},["splice"],["splice"]);}else{(other$18788=$18670$18703);return _build_loop$18716(function(x$18791){return ["send",["send",["symbol","acc"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",x$18791]];},["send",["symbol","="],["data",["symbol","acc"],["data"]]],["symbol","acc"]);}}}}),accum$18658)),$16090(((accum$18794=({})),((accum$18794["each?"]=function($18797$18801,scope$18802,$18798$18803,$18799$18804){var t0$18820;var t0$18825;var t1$18826;var t2$18827;var t3$18828;var t4$18829;var x$18854;var other$18876;var $18807$18846;var $18808$18847;var $18809$18848;var $18810$18849;var t0$18844;var $18806$18839;var ph$18811;var form$18812;var env$18813;var li$18814;var clauses$18815;(ph$18811=$18797$18801);;(t0$18820=$18798$18803);(form$18812=t0$18820);if($22703(t0$18820,"env")){(env$18813=t0$18820.env);;}else{$22932($18798$18803);}(t0$18825=$18799$18804);if(((t0$18825 instanceof Array)&&((t1$18826=t0$18825.length),((t1$18826===3)&&((t0$18825[0]==="data")&&((li$18814=t0$18825[1]),((t2$18827=$23017(["multi"])(t0$18825[2])),(t2$18827[0]&&((t3$18828=t2$18827[1]),((t4$18829=t3$18828.length),(t4$18829>=0))))))))))){(clauses$18815=Array.prototype.slice.call(t3$18828,0));;}else{$22932($18799$18804);}($18806$18839=ph$18811);;if((((x$18854=$18806$18839)),((x$18854 instanceof Array)&&(x$18854[0]==="test")))){return $22945(["test_factory",li$18814,clauses$18815],({"env":env$18813}));}else{if((($18807$18846=($18806$18839 instanceof Array))&&((t0$18844=$18806$18839.length),(($18809$18848=(t0$18844===2))&&(($18810$18849=($18806$18839[0]==="expr"))&&($18806$18839[1]==="multi")))))){return ["nostep",form$18812];}else{if(($18810$18849&&($18806$18839[1]==="ignore"))){return build_loop$16180(scope$18802,env$18813,form$18812,li$18814,clauses$18815,function(x$18869){return x$18869;},["splice"],["splice"],({"fallback":function(target$18872){return ["symbol","false"];}}));}else{(other$18876=$18806$18839);return build_loop$16180(scope$18802,env$18813,form$18812,li$18814,clauses$18815,function(x$18879){return ["send",["send",["symbol","acc"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",x$18879]];},["send",["symbol","="],["data",["symbol","acc"],["data"]]],["symbol","acc"],({"fallback":function(target$18882){return ["symbol","false"];}}));}}}}),accum$18794)),$16090(((accum$18885=({})),((accum$18885["!!"]=function($18888$18891,scope$18892,form$18893,$18889$18894){var t0$18908;var t1$18909;var t2$18910;var t3$18911;var t4$18912;var other$18948;var $18897$18929;var $18898$18930;var $18899$18931;var $18900$18932;var t0$18927;var $18896$18922;var ph$18901;var expr$18902;var clauses$18903;(ph$18901=$18888$18891);;(t0$18908=$18889$18894);if(((t0$18908 instanceof Array)&&((t1$18909=t0$18908.length),((t1$18909===3)&&((t0$18908[0]==="data")&&((expr$18902=t0$18908[1]),((t2$18910=$23017(["multi"])(t0$18908[2])),(t2$18910[0]&&((t3$18911=t2$18910[1]),((t4$18912=t3$18911.length),(t4$18912>=0))))))))))){(clauses$18903=Array.prototype.slice.call(t3$18911,0));;}else{$22932($18889$18894);}($18896$18922=ph$18901);;if((($18897$18929=($18896$18922 instanceof Array))&&((t0$18927=$18896$18922.length),(($18899$18931=(t0$18927===2))&&(($18900$18932=($18896$18922[0]==="expr"))&&($18896$18922[1]==="multi")))))){return ["nostep",form$18893];}else{if(($18900$18932&&($18896$18922[1]==="ignore"))){clauses$18903.push(mkstdenv$16161().convert(["send",["symbol","->"],["data",["symbol","e"],["send",["symbol","throw"],["symbol","e"]]]]));return ["js_try",expr$18902,["send",["symbol","->"],["data",["data",["symbol","excv"]],parse_clauses$16150(scope$18892,["symbol","excv"],clauses$18903,({"wrap":function(x$18944){return x$18944;}}))]],["void"]];}else{(other$18948=$18896$18922);clauses$18903.push(mkstdenv$16161().convert(["send",["symbol","->"],["data",["symbol","e"],["send",["symbol","throw"],["symbol","e"]]]]));return ["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","rval"],["symbol","false"]]],["multi",["js_try",["send",["symbol",":="],["data",["symbol","rval"],expr$18902]],["send",["symbol","->"],["data",["data",["symbol","excv"]],parse_clauses$16150(scope$18892,["symbol","excv"],clauses$18903,({"wrap":function(x$18952){return ["send",["symbol",":="],["data",["symbol","rval"],x$18952]];}}))]],["void"]],["symbol","rval"]]]];}}}),accum$18885)),$16090(({"@":var_operator$16175(expander$16162.gensym("it"))}),$16090(((accum$18955=({})),((t0$18957=$23017(expr_mac$16169)(function(scope$18961,form$18962,$18959$18963){var t0$18969;var t1$18970;var t2$18971;var t3$18972;var t4$18973;var t5$18974;var it$18986;var construct$18987;var defn$18965;var env$18966;var body$18967;(t0$18969=$18959$18963);if(((t0$18969 instanceof Array)&&((t1$18970=t0$18969.length),((t1$18970===3)&&((t0$18969[0]==="data")&&((t2$18971=t0$18969[1]),((defn$18965=t2$18971),($22703(t2$18971,"env")&&((env$18966=t2$18971.env),((t3$18972=$23017(["multi"])(t0$18969[2])),(t3$18972[0]&&((t4$18973=t3$18972[1]),((t5$18974=t4$18973.length),(t5$18974>=0)))))))))))))){(body$18967=Array.prototype.slice.call(t4$18973,0));;}else{$22932($18959$18963);}(it$18986=$22945(["symbol","@"],({"env":env$18966})));;(construct$18987=function($18993$18995){var x$19022;var rest$19023;var x$19016;var $18998$19012;var $18999$19013;var t0$19010;var $18997$19005;var ph$19000;(ph$19000=$18993$18995);;($18997$19005=ph$19000);;if((($18998$19012=($18997$19005 instanceof Array))&&((t0$19010=$18997$19005.length),(t0$19010===1)))){(x$19016=$18997$19005[0]);return x$19016;}else{if(($18998$19012&&(t0$19010>=1))){(x$19022=$18997$19005[0]);(rest$19023=Array.prototype.slice.call($18997$19005,1));return ["send",["symbol","let"],["data",["send",["symbol","="],["data",it$18986,x$19022]],construct$18987(rest$19023)]];}else{$22932($18997$19005);}}});;return construct$18987([defn$18965].concat(body$18967));})),function(){if(t0$18957[0]){(accum$18955["chain"]=t0$18957[1]);return accum$18955;}else{return $22932(function(scope$19032,form$19033,$19030$19034){var t0$19040;var t1$19041;var t2$19042;var t3$19043;var t4$19044;var t5$19045;var it$19057;var construct$19058;var defn$19036;var env$19037;var body$19038;(t0$19040=$19030$19034);if(((t0$19040 instanceof Array)&&((t1$19041=t0$19040.length),((t1$19041===3)&&((t0$19040[0]==="data")&&((t2$19042=t0$19040[1]),((defn$19036=t2$19042),($22703(t2$19042,"env")&&((env$19037=t2$19042.env),((t3$19043=$23017(["multi"])(t0$19040[2])),(t3$19043[0]&&((t4$19044=t3$19043[1]),((t5$19045=t4$19044.length),(t5$19045>=0)))))))))))))){(body$19038=Array.prototype.slice.call(t4$19044,0));;}else{$22932($19030$19034);}(it$19057=$22945(["symbol","@"],({"env":env$19037})));;(construct$19058=function($19064$19066){var x$19093;var rest$19094;var x$19087;var $19069$19083;var $19070$19084;var t0$19081;var $19068$19076;var ph$19071;(ph$19071=$19064$19066);;($19068$19076=ph$19071);;if((($19069$19083=($19068$19076 instanceof Array))&&((t0$19081=$19068$19076.length),(t0$19081===1)))){(x$19087=$19068$19076[0]);return x$19087;}else{if(($19069$19083&&(t0$19081>=1))){(x$19093=$19068$19076[0]);(rest$19094=Array.prototype.slice.call($19068$19076,1));return ["send",["symbol","let"],["data",["send",["symbol","="],["data",it$19057,x$19093]],construct$19058(rest$19094)]];}else{$22932($19068$19076);}}});;return construct$19058([defn$19036].concat(body$19038));});}}())),$16090(((accum$19101=({})),((t0$19103=$23017(expr_mac$16169)(function(scope$19107,form$19108,$19105$19109){var t0$19115;var t1$19116;var t2$19117;var it$19125;var defn$19111;var env$19112;var body$19113;(t0$19115=$19105$19109);if(((t0$19115 instanceof Array)&&((t1$19116=t0$19115.length),((t1$19116===3)&&((t0$19115[0]==="data")&&((t2$19117=t0$19115[1]),((defn$19111=t2$19117),$22703(t2$19117,"env")))))))){(env$19112=t2$19117.env);(body$19113=t0$19115[2]);;}else{$22932($19105$19109);}(it$19125=$22945(["symbol","@"],({"env":env$19112})));;return ["send",["symbol","let"],["data",["send",["symbol","="],["data",it$19125,defn$19111]],body$19113]];})),function(){if(t0$19103[0]){(accum$19101["using"]=t0$19103[1]);return accum$19101;}else{return $22932(function(scope$19132,form$19133,$19130$19134){var t0$19140;var t1$19141;var t2$19142;var it$19150;var defn$19136;var env$19137;var body$19138;(t0$19140=$19130$19134);if(((t0$19140 instanceof Array)&&((t1$19141=t0$19140.length),((t1$19141===3)&&((t0$19140[0]==="data")&&((t2$19142=t0$19140[1]),((defn$19136=t2$19142),$22703(t2$19142,"env")))))))){(env$19137=t2$19142.env);(body$19138=t0$19140[2]);;}else{$22932($19130$19134);}(it$19150=$22945(["symbol","@"],({"env":env$19137})));;return ["send",["symbol","let"],["data",["send",["symbol","="],["data",it$19150,defn$19136]],body$19138]];});}}())),$16090(((accum$19155=({})),((t0$19157=$23017(overridable$16170)(function($19159$19162,scope$19163,form$19164,$19160$19165){var t0$19174;var t1$19175;var x$19191;var x$19200;var t0$19208;var t1$19209;var t2$19210;var stmts$19206;var x$19220;var $19167$19181;var ph$19168;var body$19169;(ph$19168=$19159$19162);;(t0$19174=$19160$19165);if(((t0$19174 instanceof Array)&&((t1$19175=t0$19174.length),((t1$19175===2)&&(t0$19174[0]==="data"))))){(body$19169=t0$19174[1]);;}else{$22932($19160$19165);}($19167$19181=ph$19168);;if((((x$19191=$19167$19181)),((x$19191 instanceof Array)&&(x$19191[0]==="clause")))){return ["block",body$19169];}else{if((((x$19200=$19167$19181)),((x$19200 instanceof Array)&&(x$19200[0]==="test")))){(t0$19208=$23017(["multi"])(body$19169));if((t0$19208[0]&&((t1$19209=t0$19208[1]),((t2$19210=t1$19209.length),(t2$19210>=0))))){(stmts$19206=Array.prototype.slice.call(t1$19209,0));;}else{$22932(body$19169,"/home/olivier/git/earl-grey/src/stdenv.eg",19851,19855);}return ["do",["splice"].concat(stmts$19206)];}else{if((((x$19220=$19167$19181)),((x$19220 instanceof Array)&&(x$19220[0]==="expr")))){return ["multi",body$19169];}else{$22932($19167$19181);}}}})),function(){if(t0$19157[0]){(accum$19155["do"]=t0$19157[1]);return accum$19155;}else{return $22932(function($19228$19231,scope$19232,form$19233,$19229$19234){var t0$19243;var t1$19244;var x$19260;var x$19269;var t0$19277;var t1$19278;var t2$19279;var stmts$19275;var x$19289;var $19236$19250;var ph$19237;var body$19238;(ph$19237=$19228$19231);;(t0$19243=$19229$19234);if(((t0$19243 instanceof Array)&&((t1$19244=t0$19243.length),((t1$19244===2)&&(t0$19243[0]==="data"))))){(body$19238=t0$19243[1]);;}else{$22932($19229$19234);}($19236$19250=ph$19237);;if((((x$19260=$19236$19250)),((x$19260 instanceof Array)&&(x$19260[0]==="clause")))){return ["block",body$19238];}else{if((((x$19269=$19236$19250)),((x$19269 instanceof Array)&&(x$19269[0]==="test")))){(t0$19277=$23017(["multi"])(body$19238));if((t0$19277[0]&&((t1$19278=t0$19277[1]),((t2$19279=t1$19278.length),(t2$19279>=0))))){(stmts$19275=Array.prototype.slice.call(t1$19278,0));;}else{$22932(body$19238,"/home/olivier/git/earl-grey/src/stdenv.eg",19851,19855);}return ["do",["splice"].concat(stmts$19275)];}else{if((((x$19289=$19236$19250)),((x$19289 instanceof Array)&&(x$19289[0]==="expr")))){return ["multi",body$19238];}else{$22932($19236$19250);}}}});}}())),$16090(((accum$19297=({})),((t0$19299=$23017(expr_mac$16169)(function(scope$19303,form$19304,$19301$19305){var other$19414;var s1$19401;var b$19402;var a$19382;var b$19383;var a$19370;var $19309$19365;var $19310$19366;var $19311$19367;var t0$19350;var t1$19351;var t2$19352;var t3$19353;var t4$19354;var t5$19355;var t6$19356;var t7$19357;var t8$19358;var t9$19359;var t10$19360;var t11$19361;var t12$19362;var t13$19363;var test$19341;var $19308$19342;var test$19333;var a$19334;var b$19335;var $19312$19329;var $19313$19330;var t0$19324;var t1$19325;var t2$19326;var t3$19327;var $19307$19319;var ph$19314;(ph$19314=$19301$19305);;($19307$19319=ph$19314);;if((($19312$19329=($19307$19319 instanceof Array))&&((t0$19324=$19307$19319.length),((t0$19324===4)&&($19307$19319[0]==="data"))))){(test$19333=$19307$19319[1]);(a$19334=$19307$19319[2]);(b$19335=$19307$19319[3]);return ["if",test$19333,a$19334,b$19335];}else{if(($19312$19329&&((t0$19324===3)&&(($19307$19319[0]==="data")&&((test$19341=$19307$19319[1]),((t1$19325=$23017(["multi"])($19307$19319[2])),(t1$19325[0]&&((t2$19326=t1$19325[1]),((t3$19327=t2$19326.length),(t3$19327>=0)))))))))){($19308$19342=Array.prototype.slice.call(t2$19326,0));(t0$19350=$19308$19342);if((($19310$19366=(t0$19350 instanceof Array))&&((t1$19351=t0$19350.length),((t1$19351===1)&&((t2$19352=t0$19350[0]),((t2$19352 instanceof Array)&&((t3$19353=t2$19352.length),((t3$19353===3)&&((t2$19352[0]==="send")&&((t4$19354=t2$19352[1]),((t4$19354 instanceof Array)&&((t5$19355=t4$19354.length),((t5$19355===2)&&((t4$19354[0]==="symbol")&&((t4$19354[1]==="then")&&((t6$19356=t2$19352[2]),((t6$19356 instanceof Array)&&((t7$19357=t6$19356.length),((t7$19357===2)&&(t6$19356[0]==="data")))))))))))))))))))){(a$19370=t6$19356[1]);return ["if",test$19341,a$19370,["value",(void 0)]];}else{if(($19310$19366&&((t1$19351===2)&&((t2$19352=t0$19350[0]),((t2$19352 instanceof Array)&&((t3$19353=t2$19352.length),((t3$19353===3)&&((t2$19352[0]==="send")&&((t4$19354=t2$19352[1]),((t4$19354 instanceof Array)&&((t5$19355=t4$19354.length),((t5$19355===2)&&((t4$19354[0]==="symbol")&&((t4$19354[1]==="then")&&((t6$19356=t2$19352[2]),((t6$19356 instanceof Array)&&((t7$19357=t6$19356.length),((t7$19357===2)&&((t6$19356[0]==="data")&&((a$19382=t6$19356[1]),((t8$19358=t0$19350[1]),((t8$19358 instanceof Array)&&((t9$19359=t8$19358.length),((t9$19359===3)&&((t8$19358[0]==="send")&&((t10$19360=t8$19358[1]),((t10$19360 instanceof Array)&&((t11$19361=t10$19360.length),((t11$19361===2)&&((t10$19360[0]==="symbol")&&((t10$19360[1]==="else")&&((t12$19362=t8$19358[2]),((t12$19362 instanceof Array)&&((t13$19363=t12$19362.length),((t13$19363===2)&&(t12$19362[0]==="data")))))))))))))))))))))))))))))))))))){(b$19383=t12$19362[1]);return ["if",test$19341,a$19382,b$19383];}else{if(($19310$19366&&((t1$19351>=1)&&((s1$19401=Array.prototype.slice.call(t0$19350,0,-1)),((t2$19352=t0$19350[(t1$19351-1)]),((t2$19352 instanceof Array)&&((t3$19353=t2$19352.length),((t3$19353===3)&&((t2$19352[0]==="send")&&((t4$19354=t2$19352[1]),((t4$19354 instanceof Array)&&((t5$19355=t4$19354.length),((t5$19355===2)&&((t4$19354[0]==="symbol")&&((t4$19354[1]==="else")&&((t6$19356=t2$19352[2]),((t6$19356 instanceof Array)&&((t7$19357=t6$19356.length),((t7$19357===2)&&(t6$19356[0]==="data")))))))))))))))))))){(b$19402=t6$19356[1]);return ["if",test$19341,["multi"].concat(s1$19401),b$19402];}else{(other$19414=$19308$19342);return ["if",test$19341,["multi"].concat(other$19414),["value",(void 0)]];}}}}else{$22932($19307$19319);}}})),function(){if(t0$19299[0]){(accum$19297["if"]=t0$19299[1]);return accum$19297;}else{return $22932(function(scope$19421,form$19422,$19419$19423){var other$19532;var s1$19519;var b$19520;var a$19500;var b$19501;var a$19488;var $19427$19483;var $19428$19484;var $19429$19485;var t0$19468;var t1$19469;var t2$19470;var t3$19471;var t4$19472;var t5$19473;var t6$19474;var t7$19475;var t8$19476;var t9$19477;var t10$19478;var t11$19479;var t12$19480;var t13$19481;var test$19459;var $19426$19460;var test$19451;var a$19452;var b$19453;var $19430$19447;var $19431$19448;var t0$19442;var t1$19443;var t2$19444;var t3$19445;var $19425$19437;var ph$19432;(ph$19432=$19419$19423);;($19425$19437=ph$19432);;if((($19430$19447=($19425$19437 instanceof Array))&&((t0$19442=$19425$19437.length),((t0$19442===4)&&($19425$19437[0]==="data"))))){(test$19451=$19425$19437[1]);(a$19452=$19425$19437[2]);(b$19453=$19425$19437[3]);return ["if",test$19451,a$19452,b$19453];}else{if(($19430$19447&&((t0$19442===3)&&(($19425$19437[0]==="data")&&((test$19459=$19425$19437[1]),((t1$19443=$23017(["multi"])($19425$19437[2])),(t1$19443[0]&&((t2$19444=t1$19443[1]),((t3$19445=t2$19444.length),(t3$19445>=0)))))))))){($19426$19460=Array.prototype.slice.call(t2$19444,0));(t0$19468=$19426$19460);if((($19428$19484=(t0$19468 instanceof Array))&&((t1$19469=t0$19468.length),((t1$19469===1)&&((t2$19470=t0$19468[0]),((t2$19470 instanceof Array)&&((t3$19471=t2$19470.length),((t3$19471===3)&&((t2$19470[0]==="send")&&((t4$19472=t2$19470[1]),((t4$19472 instanceof Array)&&((t5$19473=t4$19472.length),((t5$19473===2)&&((t4$19472[0]==="symbol")&&((t4$19472[1]==="then")&&((t6$19474=t2$19470[2]),((t6$19474 instanceof Array)&&((t7$19475=t6$19474.length),((t7$19475===2)&&(t6$19474[0]==="data")))))))))))))))))))){(a$19488=t6$19474[1]);return ["if",test$19459,a$19488,["value",(void 0)]];}else{if(($19428$19484&&((t1$19469===2)&&((t2$19470=t0$19468[0]),((t2$19470 instanceof Array)&&((t3$19471=t2$19470.length),((t3$19471===3)&&((t2$19470[0]==="send")&&((t4$19472=t2$19470[1]),((t4$19472 instanceof Array)&&((t5$19473=t4$19472.length),((t5$19473===2)&&((t4$19472[0]==="symbol")&&((t4$19472[1]==="then")&&((t6$19474=t2$19470[2]),((t6$19474 instanceof Array)&&((t7$19475=t6$19474.length),((t7$19475===2)&&((t6$19474[0]==="data")&&((a$19500=t6$19474[1]),((t8$19476=t0$19468[1]),((t8$19476 instanceof Array)&&((t9$19477=t8$19476.length),((t9$19477===3)&&((t8$19476[0]==="send")&&((t10$19478=t8$19476[1]),((t10$19478 instanceof Array)&&((t11$19479=t10$19478.length),((t11$19479===2)&&((t10$19478[0]==="symbol")&&((t10$19478[1]==="else")&&((t12$19480=t8$19476[2]),((t12$19480 instanceof Array)&&((t13$19481=t12$19480.length),((t13$19481===2)&&(t12$19480[0]==="data")))))))))))))))))))))))))))))))))))){(b$19501=t12$19480[1]);return ["if",test$19459,a$19500,b$19501];}else{if(($19428$19484&&((t1$19469>=1)&&((s1$19519=Array.prototype.slice.call(t0$19468,0,-1)),((t2$19470=t0$19468[(t1$19469-1)]),((t2$19470 instanceof Array)&&((t3$19471=t2$19470.length),((t3$19471===3)&&((t2$19470[0]==="send")&&((t4$19472=t2$19470[1]),((t4$19472 instanceof Array)&&((t5$19473=t4$19472.length),((t5$19473===2)&&((t4$19472[0]==="symbol")&&((t4$19472[1]==="else")&&((t6$19474=t2$19470[2]),((t6$19474 instanceof Array)&&((t7$19475=t6$19474.length),((t7$19475===2)&&(t6$19474[0]==="data")))))))))))))))))))){(b$19520=t6$19474[1]);return ["if",test$19459,["multi"].concat(s1$19519),b$19520];}else{(other$19532=$19426$19460);return ["if",test$19459,["multi"].concat(other$19532),["value",(void 0)]];}}}}else{$22932($19425$19437);}}});}}())),$16090(((accum$19537=({})),((t0$19539=$23017(expr_mac$16169)(function(scope$19543,form$19544,$19541$19545){var t0$19552;var t0$19570;var t1$19571;var t2$19572;var t3$19573;var t4$19574;var t5$19575;var t6$19576;var t7$19577;var t8$19578;var t0$19590;var test$19612;var body$19613;var label$19567;var bridge$19548$19562;var t0$19563;var $19547$19557;var ph$19549;var env$19550;(t0$19552=$19541$19545);if($22703(t0$19552,"env")){(env$19550=t0$19552.env);(ph$19549=t0$19552);;}else{$22932($19541$19545);}($19547$19557=ph$19549);;(bridge$19548$19562=$19547$19557);if((((bridge$19548$19562 instanceof Array)&&((t0$19570=bridge$19548$19562.length),((t0$19570===3)&&((bridge$19548$19562[0]==="send")&&((t1$19571=bridge$19548$19562[1]),((t1$19571 instanceof Array)&&((t2$19572=t1$19571.length),((t2$19572===2)&&((t1$19571[0]==="symbol")&&((t1$19571[1]===".")&&((t3$19573=bridge$19548$19562[2]),((t3$19573 instanceof Array)&&((t4$19574=t3$19573.length),((t4$19574===3)&&((t3$19573[0]==="data")&&((t5$19575=t3$19573[1]),((t5$19575 instanceof Array)&&((t6$19576=t5$19575.length),((t6$19576===1)&&((t5$19575[0]==="void")&&((t7$19577=t3$19573[2]),((t7$19577 instanceof Array)&&((t8$19578=t7$19577.length),((t8$19578===2)&&((t7$19577[0]==="symbol")&&((label$19567=t7$19577[1]),true))))))))))))))))))))))))))||((bridge$19548$19562 instanceof Array)&&((t0$19590=bridge$19548$19562.length),((t0$19590===2)&&((bridge$19548$19562[0]==="value")&&((label$19567=bridge$19548$19562[1]),true))))))){return ["macro",function(context$19596,scope$19597,form$19598,$19594$19599){var t0$19604;var t1$19605;var test$19601;var body$19602;(t0$19604=$19594$19599);if(((t0$19604 instanceof Array)&&((t1$19605=t0$19604.length),((t1$19605===3)&&(t0$19604[0]==="data"))))){(test$19601=t0$19604[1]);(body$19602=t0$19604[2]);;}else{$22932($19594$19599);}return setup_label$16172(label$19567,env$19550,["js_while",test$19601,body$19602]);}];}else{if((($19547$19557 instanceof Array)&&((t0$19563=$19547$19557.length),((t0$19563===3)&&($19547$19557[0]==="data"))))){(test$19612=$19547$19557[1]);(body$19613=$19547$19557[2]);return setup_label$16172(scope$19543.gensym(),env$19550,["js_while",test$19612,body$19613]);}else{$22932($19547$19557);}}})),function(){if(t0$19539[0]){(accum$19537["while"]=t0$19539[1]);return accum$19537;}else{return $22932(function(scope$19622,form$19623,$19620$19624){var t0$19631;var t0$19649;var t1$19650;var t2$19651;var t3$19652;var t4$19653;var t5$19654;var t6$19655;var t7$19656;var t8$19657;var t0$19669;var test$19691;var body$19692;var label$19646;var bridge$19627$19641;var t0$19642;var $19626$19636;var ph$19628;var env$19629;(t0$19631=$19620$19624);if($22703(t0$19631,"env")){(env$19629=t0$19631.env);(ph$19628=t0$19631);;}else{$22932($19620$19624);}($19626$19636=ph$19628);;(bridge$19627$19641=$19626$19636);if((((bridge$19627$19641 instanceof Array)&&((t0$19649=bridge$19627$19641.length),((t0$19649===3)&&((bridge$19627$19641[0]==="send")&&((t1$19650=bridge$19627$19641[1]),((t1$19650 instanceof Array)&&((t2$19651=t1$19650.length),((t2$19651===2)&&((t1$19650[0]==="symbol")&&((t1$19650[1]===".")&&((t3$19652=bridge$19627$19641[2]),((t3$19652 instanceof Array)&&((t4$19653=t3$19652.length),((t4$19653===3)&&((t3$19652[0]==="data")&&((t5$19654=t3$19652[1]),((t5$19654 instanceof Array)&&((t6$19655=t5$19654.length),((t6$19655===1)&&((t5$19654[0]==="void")&&((t7$19656=t3$19652[2]),((t7$19656 instanceof Array)&&((t8$19657=t7$19656.length),((t8$19657===2)&&((t7$19656[0]==="symbol")&&((label$19646=t7$19656[1]),true))))))))))))))))))))))))))||((bridge$19627$19641 instanceof Array)&&((t0$19669=bridge$19627$19641.length),((t0$19669===2)&&((bridge$19627$19641[0]==="value")&&((label$19646=bridge$19627$19641[1]),true))))))){return ["macro",function(context$19675,scope$19676,form$19677,$19673$19678){var t0$19683;var t1$19684;var test$19680;var body$19681;(t0$19683=$19673$19678);if(((t0$19683 instanceof Array)&&((t1$19684=t0$19683.length),((t1$19684===3)&&(t0$19683[0]==="data"))))){(test$19680=t0$19683[1]);(body$19681=t0$19683[2]);;}else{$22932($19673$19678);}return setup_label$16172(label$19646,env$19629,["js_while",test$19680,body$19681]);}];}else{if((($19626$19636 instanceof Array)&&((t0$19642=$19626$19636.length),((t0$19642===3)&&($19626$19636[0]==="data"))))){(test$19691=$19626$19636[1]);(body$19692=$19626$19636[2]);return setup_label$16172(scope$19622.gensym(),env$19629,["js_while",test$19691,body$19692]);}else{$22932($19626$19636);}}});}}())),$16090(((accum$19699=({})),((accum$19699["for"]=function(context$19704,scope$19705,form$19706,$19702$19707){var t0$19714;var t0$19784;var t1$19785;var t2$19786;var t3$19787;var t4$19788;var t5$19789;var t6$19790;var t7$19791;var t8$19792;var t0$19804;var spec$19826;var body$19827;var label$19781;var setup_for$19727;var bridge$19710$19723;var t0$19724;var $19709$19718;var ph$19711;var expr$19712;(t0$19714=$19702$19707);(expr$19712=t0$19714);(ph$19711=t0$19714);;($19709$19718=ph$19711);;(setup_for$19727=function(label$19732,env$19733,$19730$19734,body$19735){var a$19768;var b$19769;var a$19760;var b$19761;var c$19762;var $19738$19756;var $19739$19757;var t0$19750;var t1$19751;var t2$19752;var t3$19753;var t4$19754;var $19737$19745;var ph$19740;(ph$19740=$19730$19734);;($19737$19745=ph$19740);;if((($19738$19756=($19737$19745 instanceof Array))&&((t0$19750=$19737$19745.length),((t0$19750===4)&&($19737$19745[0]==="multi"))))){(a$19760=$19737$19745[1]);(b$19761=$19737$19745[2]);(c$19762=$19737$19745[3]);return ["multi",a$19760,setup_label$16172(label$19732,env$19733,["js_for",["multi"],b$19761,c$19762,body$19735])];}else{if(($19738$19756&&((t0$19750===3)&&(($19737$19745[0]==="send")&&((t1$19751=$19737$19745[1]),((t1$19751 instanceof Array)&&((t2$19752=t1$19751.length),((t2$19752===2)&&((t1$19751[0]==="symbol")&&((t1$19751[1]==="in")&&((t3$19753=$19737$19745[2]),((t3$19753 instanceof Array)&&((t4$19754=t3$19753.length),((t4$19754===3)&&(t3$19753[0]==="data"))))))))))))))){(a$19768=t3$19753[1]);(b$19769=t3$19753[2]);return ["multi",["declare",a$19768,["value",null]],setup_label$16172(label$19732,env$19733,["js_for_in",a$19768,b$19769,body$19735])];}else{$22932($19737$19745);}}});;(bridge$19710$19723=$19709$19718);if((((bridge$19710$19723 instanceof Array)&&((t0$19784=bridge$19710$19723.length),((t0$19784===3)&&((bridge$19710$19723[0]==="send")&&((t1$19785=bridge$19710$19723[1]),((t1$19785 instanceof Array)&&((t2$19786=t1$19785.length),((t2$19786===2)&&((t1$19785[0]==="symbol")&&((t1$19785[1]===".")&&((t3$19787=bridge$19710$19723[2]),((t3$19787 instanceof Array)&&((t4$19788=t3$19787.length),((t4$19788===3)&&((t3$19787[0]==="data")&&((t5$19789=t3$19787[1]),((t5$19789 instanceof Array)&&((t6$19790=t5$19789.length),((t6$19790===1)&&((t5$19789[0]==="void")&&((t7$19791=t3$19787[2]),((t7$19791 instanceof Array)&&((t8$19792=t7$19791.length),((t8$19792===2)&&((t7$19791[0]==="symbol")&&((label$19781=t7$19791[1]),true))))))))))))))))))))))))))||((bridge$19710$19723 instanceof Array)&&((t0$19804=bridge$19710$19723.length),((t0$19804===2)&&((bridge$19710$19723[0]==="value")&&((label$19781=bridge$19710$19723[1]),true))))))){return ["macro",function(context$19810,scope$19811,form$19812,$19808$19813){var t0$19818;var t1$19819;var spec$19815;var body$19816;(t0$19818=$19808$19813);if(((t0$19818 instanceof Array)&&((t1$19819=t0$19818.length),((t1$19819===3)&&(t0$19818[0]==="data"))))){(spec$19815=t0$19818[1]);(body$19816=t0$19818[2]);;}else{$22932($19808$19813);}return setup_for$19727(label$19781,expr$19712.env,spec$19815,body$19816);}];}else{if((($19709$19718 instanceof Array)&&((t0$19724=$19709$19718.length),((t0$19724===3)&&($19709$19718[0]==="data"))))){(spec$19826=$19709$19718[1]);(body$19827=$19709$19718[2]);return setup_for$19727(scope$19705.gensym(),form$19706.env,spec$19826,body$19827);}else{$22932($19709$19718);}}}),accum$19699)),$16090(((accum$19834=({})),((accum$19834["var"]=function($19837$19839,scope$19840,form$19841,argument$19842){var x$19847;if((((x$19847=$19837$19839)),((x$19847 instanceof Array)&&(x$19847[0]==="pattern")))){;}else{$22932($19837$19839);}return ["mode","var",argument$19842];}),accum$19834)),$16090(((accum$19854=({})),((accum$19854["set"]=function($19857$19859,scope$19860,form$19861,argument$19862){var x$19867;if((((x$19867=$19857$19859)),((x$19867 instanceof Array)&&(x$19867[0]==="pattern")))){;}else{$22932($19857$19859);}return ["mode","set",argument$19862];}),accum$19854)),$16090(((accum$19874=({})),((accum$19874["let"]=function($19877$19879,scope$19880,form$19881,argument$19882){var x$19900;var construct$19932;var bindings$19923;var body$19924;var t0$19916;var t1$19917;var t2$19918;var t3$19919;var $19909$19911;var other$19907;var $19884$19890;var ph$19885;(ph$19885=$19877$19879);;($19884$19890=ph$19885);;if((((x$19900=$19884$19890)),((x$19900 instanceof Array)&&(x$19900[0]==="pattern")))){return ["mode","let",argument$19882];}else{(other$19907=$19884$19890);($19909$19911=argument$19882);;if((($19909$19911 instanceof Array)&&((t0$19916=$19909$19911.length),((t0$19916===3)&&(($19909$19911[0]==="data")&&((t1$19917=$23017(["multi"])($19909$19911[1])),(t1$19917[0]&&((t2$19918=t1$19917[1]),((t3$19919=t2$19918.length),(t3$19919>=0)))))))))){(bindings$19923=Array.prototype.slice.call(t2$19918,0));(body$19924=$19909$19911[2]);(construct$19932=function($19935$19937){var bind$19969;var val$19970;var xs$19971;var $19940$19960;var $19941$19961;var t0$19952;var t1$19953;var t2$19954;var t3$19955;var t4$19956;var t5$19957;var t6$19958;var $19939$19947;var ph$19942;(ph$19942=$19935$19937);;($19939$19947=ph$19942);;if((($19940$19960=($19939$19947 instanceof Array))&&((t0$19952=$19939$19947.length),(t0$19952===0)))){return body$19924;}else{if(($19940$19960&&((t0$19952>=1)&&((t1$19953=$19939$19947[0]),((t1$19953 instanceof Array)&&((t2$19954=t1$19953.length),((t2$19954===3)&&((t1$19953[0]==="send")&&((t3$19955=t1$19953[1]),((t3$19955 instanceof Array)&&((t4$19956=t3$19955.length),((t4$19956===2)&&((t3$19955[0]==="symbol")&&((t3$19955[1]==="=")&&((t5$19957=t1$19953[2]),((t5$19957 instanceof Array)&&((t6$19958=t5$19957.length),((t6$19958===3)&&(t5$19957[0]==="data"))))))))))))))))))){(bind$19969=t5$19957[1]);(val$19970=t5$19957[2]);(xs$19971=Array.prototype.slice.call($19939$19947,1));return $22945(["multi",["send",["symbol","="],["data",["send",["symbol","let"],bind$19969],val$19970]],construct$19932(xs$19971)],({"nonrecursive":true}));}else{$22932($19939$19947);}}});;return construct$19932(bindings$19923);}else{$22932($19909$19911);}}}),accum$19874)),$16090(((accum$19986=({})),((t0$19988=$23017(expr_mac$16169)(function(scope$19992,form$19993,$19990$19994){var t0$19999;var t1$20000;var t2$20001;var t3$20002;var t4$20003;var $index$20033;var $length$20028;var temp$20023;var acc$20018;var let_bindings$20012;var bindings$19996;var body$19997;(t0$19999=$19990$19994);if(((t0$19999 instanceof Array)&&((t1$20000=t0$19999.length),((t1$20000===3)&&((t0$19999[0]==="data")&&((t2$20001=$23017(["multi"])(t0$19999[1])),(t2$20001[0]&&((t3$20002=t2$20001[1]),((t4$20003=t3$20002.length),(t4$20003>=0)))))))))){(bindings$19996=Array.prototype.slice.call(t3$20002,0));(body$19997=t0$19999[2]);;}else{$22932($19990$19994);}(let_bindings$20012=(((acc$20018=[])),(((temp$20023=bindings$19996)),((($length$20028=temp$20023.length)),((($index$20033=0)),function(){$20015:for(;($index$20033<$length$20028);($index$20033++)){var b$20055;var v$20056;var t0$20046;var t1$20047;var t2$20048;var t3$20049;var t4$20050;var t5$20051;var m$20041;(m$20041=temp$20023[$index$20033]);;(t0$20046=m$20041);if(((t0$20046 instanceof Array)&&((t1$20047=t0$20046.length),((t1$20047===3)&&((t0$20046[0]==="send")&&((t2$20048=t0$20046[1]),((t2$20048 instanceof Array)&&((t3$20049=t2$20048.length),((t3$20049===2)&&((t2$20048[0]==="symbol")&&((t2$20048[1]==="=")&&((t4$20050=t0$20046[2]),((t4$20050 instanceof Array)&&((t5$20051=t4$20050.length),((t5$20051===3)&&(t4$20050[0]==="data")))))))))))))))){(b$20055=t4$20050[1]);(v$20056=t4$20050[2]);acc$20018.push(["send",["symbol","="],["data",["send",["symbol","let"],b$20055],v$20056]]);}else{$22932(m$20041,"/home/olivier/git/earl-grey/src/stdenv.eg",22463,22510);;}}}()))),acc$20018));;return ["multi"].concat(let_bindings$20012).concat([body$19997]);})),function(){if(t0$19988[0]){(accum$19986["letrec"]=t0$19988[1]);return accum$19986;}else{return $22932(function(scope$20070,form$20071,$20068$20072){var t0$20077;var t1$20078;var t2$20079;var t3$20080;var t4$20081;var $index$20111;var $length$20106;var temp$20101;var acc$20096;var let_bindings$20090;var bindings$20074;var body$20075;(t0$20077=$20068$20072);if(((t0$20077 instanceof Array)&&((t1$20078=t0$20077.length),((t1$20078===3)&&((t0$20077[0]==="data")&&((t2$20079=$23017(["multi"])(t0$20077[1])),(t2$20079[0]&&((t3$20080=t2$20079[1]),((t4$20081=t3$20080.length),(t4$20081>=0)))))))))){(bindings$20074=Array.prototype.slice.call(t3$20080,0));(body$20075=t0$20077[2]);;}else{$22932($20068$20072);}(let_bindings$20090=(((acc$20096=[])),(((temp$20101=bindings$20074)),((($length$20106=temp$20101.length)),((($index$20111=0)),function(){$20093:for(;($index$20111<$length$20106);($index$20111++)){var b$20133;var v$20134;var t0$20124;var t1$20125;var t2$20126;var t3$20127;var t4$20128;var t5$20129;var m$20119;(m$20119=temp$20101[$index$20111]);;(t0$20124=m$20119);if(((t0$20124 instanceof Array)&&((t1$20125=t0$20124.length),((t1$20125===3)&&((t0$20124[0]==="send")&&((t2$20126=t0$20124[1]),((t2$20126 instanceof Array)&&((t3$20127=t2$20126.length),((t3$20127===2)&&((t2$20126[0]==="symbol")&&((t2$20126[1]==="=")&&((t4$20128=t0$20124[2]),((t4$20128 instanceof Array)&&((t5$20129=t4$20128.length),((t5$20129===3)&&(t4$20128[0]==="data")))))))))))))))){(b$20133=t4$20128[1]);(v$20134=t4$20128[2]);acc$20096.push(["send",["symbol","="],["data",["send",["symbol","let"],b$20133],v$20134]]);}else{$22932(m$20119,"/home/olivier/git/earl-grey/src/stdenv.eg",22463,22510);;}}}()))),acc$20096));;return ["multi"].concat(let_bindings$20090).concat([body$20075]);});}}())),$16090(((accum$20146=({})),((accum$20146["where"]=function(context$20151,scope$20152,form$20153,$20149$20154){var t0$20159;var t1$20160;var body$20156;var bindings$20157;(t0$20159=$20149$20154);if(((t0$20159 instanceof Array)&&((t1$20160=t0$20159.length),((t1$20160===3)&&(t0$20159[0]==="data"))))){(body$20156=t0$20159[1]);(bindings$20157=t0$20159[2]);;}else{$22932($20149$20154);}return ["send",["symbol","letrec"],["data",bindings$20157,body$20156]];}),accum$20146)),$16090(({"break":break_mac$16173(null),"continue":continue_mac$16174(null)}),$16090(((accum$20166=({})),((t0$20168=$23017(expr_mac$16169)(function(scope$20171,form$20172,arg$20173){return ["js_throw",arg$20173];})),function(){if(t0$20168[0]){(accum$20166["throw"]=t0$20168[1]);return accum$20166;}else{return $22932(function(scope$20177,form$20178,arg$20179){return ["js_throw",arg$20179];});}}())),$16090(((accum$20182=({})),((t0$20184=$23017(expr_mac$16169)(function(scope$20187,form$20188,arg$20189){return ["js_return",arg$20189];})),function(){if(t0$20184[0]){(accum$20182["return"]=t0$20184[1]);return accum$20182;}else{return $22932(function(scope$20193,form$20194,arg$20195){return ["js_return",arg$20195];});}}())),$16090(((accum$20198=({})),((t0$20200=$23017(expr_mac$16169)(function(scope$20203,form$20204,arg$20205){return ["js_new",arg$20205];})),function(){if(t0$20200[0]){(accum$20198["new"]=t0$20200[1]);return accum$20198;}else{return $22932(function(scope$20209,form$20210,arg$20211){return ["js_new",arg$20211];});}}())),$16090(((accum$20214=({})),((t0$20216=$23017(expr_mac$16169)(function(scope$20219,form$20220,arg$20221){return ["js_delete",arg$20221];})),function(){if(t0$20216[0]){(accum$20214["delete"]=t0$20216[1]);return accum$20214;}else{return $22932(function(scope$20225,form$20226,arg$20227){return ["js_delete",arg$20227];});}}())),$16090(((accum$20230=({})),((accum$20230["splice"]=function(context$20235,scope$20236,form$20237,$20233$20238){var t0$20242;var t1$20243;var t2$20244;var t3$20245;var t4$20246;var stmts$20240;(t0$20242=$20233$20238);if(((t0$20242 instanceof Array)&&((t1$20243=t0$20242.length),((t1$20243===2)&&((t0$20242[0]==="data")&&((t2$20244=$23017(["multi"])(t0$20242[1])),(t2$20244[0]&&((t3$20245=t2$20244[1]),((t4$20246=t3$20245.length),(t4$20246>=0)))))))))){(stmts$20240=Array.prototype.slice.call(t3$20245,0));;}else{$22932($20233$20238);}return ["splice"].concat(stmts$20240);}),accum$20230)),$16090(((accum$20255=({})),((accum$20255["?"]=function(context$20260,scope$20261,form$20262,$20258$20263){var other$20345;var $20302$20314;var $20303$20315;var $20304$20316;var $20305$20317;var t0$20312;var $20301$20307;var checker$20298;var other$20453;var $20410$20422;var $20411$20423;var $20412$20424;var $20413$20425;var t0$20420;var $20409$20415;var x$20467;var other$20488;var t0$20479;var $20472$20474;var other$20492;var $20405$20457;var checker$20406;var chk$20400;var target$20401;var expr$20290;var $20266$20284;var $20267$20285;var $20268$20286;var $20269$20287;var t0$20280;var t1$20281;var t2$20282;var $20265$20275;var ph$20270;(ph$20270=$20258$20263);;($20265$20275=ph$20270);;if((($20266$20284=($20265$20275 instanceof Array))&&((t0$20280=$20265$20275.length),(($20268$20286=(t0$20280===3))&&(($20269$20287=($20265$20275[0]==="data"))&&((expr$20290=$20265$20275[1]),((t1$20281=$20265$20275[2]),((t1$20281 instanceof Array)&&((t2$20282=t1$20281.length),((t2$20282===1)&&(t1$20281[0]==="void"))))))))))){(checker$20298=((($20301$20307=expr$20290)),function(){if((($20302$20314=($20301$20307 instanceof Array))&&((t0$20312=$20301$20307.length),(($20304$20316=(t0$20312===2))&&(($20305$20317=($20301$20307[0]==="symbol"))&&($20301$20307[1]==="String")))))){return checker_db$16157.String;}else{if(($20305$20317&&($20301$20307[1]==="Number"))){return checker_db$16157.Number;}else{if(($20305$20317&&($20301$20307[1]==="true"))){return checker_db$16157.true;}else{if(($20305$20317&&($20301$20307[1]==="false"))){return checker_db$16157.false;}else{if(($20305$20317&&($20301$20307[1]==="null"))){return checker_db$16157.null;}else{if(($20305$20317&&($20301$20307[1]==="undefined"))){return checker_db$16157.undefined;}else{(other$20345=$20301$20307);return ["send",["symbol","___checker"],["data",expr$20290]];}}}}}}}()));;return ["macro",function($20348$20350,env$20351,form$20352,expr$20353){var x$20371;var other$20392;var t0$20383;var $20376$20378;var other$20396;var $20355$20361;var ph$20356;(ph$20356=$20348$20350);;($20355$20361=ph$20356);;if((((x$20371=$20355$20361)),((x$20371 instanceof Array)&&(x$20371[0]==="pattern")))){($20376$20378=expr$20353);;if((($20376$20378 instanceof Array)&&((t0$20383=$20376$20378.length),((t0$20383===1)&&($20376$20378[0]==="void"))))){return ["check",checker$20298,["ignore"]];}else{(other$20392=$20376$20378);return ["check",checker$20298,expr$20353];}}else{(other$20396=$20355$20361);return ["send",checker$20298,["data",expr$20353]];}}];}else{if($20269$20287){(chk$20400=$20265$20275[1]);(target$20401=$20265$20275[2]);(checker$20406=((($20409$20415=chk$20400)),function(){if((($20410$20422=($20409$20415 instanceof Array))&&((t0$20420=$20409$20415.length),(($20412$20424=(t0$20420===2))&&(($20413$20425=($20409$20415[0]==="symbol"))&&($20409$20415[1]==="String")))))){return checker_db$16157.String;}else{if(($20413$20425&&($20409$20415[1]==="Number"))){return checker_db$16157.Number;}else{if(($20413$20425&&($20409$20415[1]==="true"))){return checker_db$16157.true;}else{if(($20413$20425&&($20409$20415[1]==="false"))){return checker_db$16157.false;}else{if(($20413$20425&&($20409$20415[1]==="null"))){return checker_db$16157.null;}else{if(($20413$20425&&($20409$20415[1]==="undefined"))){return checker_db$16157.undefined;}else{(other$20453=$20409$20415);return ["send",["symbol","___checker"],["data",chk$20400]];}}}}}}}()));;($20405$20457=context$20260);;if((((x$20467=$20405$20457)),((x$20467 instanceof Array)&&(x$20467[0]==="pattern")))){($20472$20474=target$20401);;if((($20472$20474 instanceof Array)&&((t0$20479=$20472$20474.length),((t0$20479===1)&&($20472$20474[0]==="void"))))){return ["check",checker$20406,["ignore"]];}else{(other$20488=$20472$20474);return ["check",checker$20406,target$20401];}}else{(other$20492=$20405$20457);return ["send",checker$20406,["data",target$20401]];}}else{$22932($20265$20275);}}}),accum$20255)),$16090(((accum$20497=({})),((accum$20497["!"]=function(context$20502,scope$20503,form$20504,$20500$20505){var other$20577;var $20544$20556;var $20545$20557;var $20546$20558;var $20547$20559;var t0$20554;var $20543$20549;var projector$20540;var other$20675;var $20642$20654;var $20643$20655;var $20644$20656;var $20645$20657;var t0$20652;var $20641$20647;var x$20689;var other$20710;var t0$20701;var $20694$20696;var other$20714;var $20637$20679;var projector$20638;var prj$20632;var target$20633;var expr$20532;var $20508$20526;var $20509$20527;var $20510$20528;var $20511$20529;var t0$20522;var t1$20523;var t2$20524;var $20507$20517;var ph$20512;(ph$20512=$20500$20505);;($20507$20517=ph$20512);;if((($20508$20526=($20507$20517 instanceof Array))&&((t0$20522=$20507$20517.length),(($20510$20528=(t0$20522===3))&&(($20511$20529=($20507$20517[0]==="data"))&&((expr$20532=$20507$20517[1]),((t1$20523=$20507$20517[2]),((t1$20523 instanceof Array)&&((t2$20524=t1$20523.length),((t2$20524===1)&&(t1$20523[0]==="void"))))))))))){(projector$20540=((($20543$20549=expr$20532)),function(){if((($20544$20556=($20543$20549 instanceof Array))&&((t0$20554=$20543$20549.length),(($20546$20558=(t0$20554===2))&&(($20547$20559=($20543$20549[0]==="symbol"))&&($20543$20549[1]==="String")))))){return mac1$16156(function(x$20566){return ["data",["symbol","true"],["send",["symbol","String"],["data",x$20566]]];});}else{if(($20547$20559&&($20543$20549[1]==="Number"))){return mac1$16156(function(x$20573){return ["data",["symbol","true"],["send",["symbol","parseFloat"],["data",x$20573]]];});}else{(other$20577=$20543$20549);return ["send",["symbol","___projector"],["data",expr$20532]];}}}()));;return ["macro",function($20580$20582,env$20583,form$20584,expr$20585){var x$20603;var other$20624;var t0$20615;var $20608$20610;var other$20628;var $20587$20593;var ph$20588;(ph$20588=$20580$20582);;($20587$20593=ph$20588);;if((((x$20603=$20587$20593)),((x$20603 instanceof Array)&&(x$20603[0]==="pattern")))){($20608$20610=expr$20585);;if((($20608$20610 instanceof Array)&&((t0$20615=$20608$20610.length),((t0$20615===1)&&($20608$20610[0]==="void"))))){return ["project",projector$20540,["ignore"]];}else{(other$20624=$20608$20610);return ["project",projector$20540,expr$20585];}}else{(other$20628=$20587$20593);return ["send",["send",projector$20540,["data",expr$20585]],["value",1]];}}];}else{if($20511$20529){(prj$20632=$20507$20517[1]);(target$20633=$20507$20517[2]);(projector$20638=((($20641$20647=prj$20632)),function(){if((($20642$20654=($20641$20647 instanceof Array))&&((t0$20652=$20641$20647.length),(($20644$20656=(t0$20652===2))&&(($20645$20657=($20641$20647[0]==="symbol"))&&($20641$20647[1]==="String")))))){return mac1$16156(function(x$20664){return ["data",["symbol","true"],["send",["symbol","String"],["data",x$20664]]];});}else{if(($20645$20657&&($20641$20647[1]==="Number"))){return mac1$16156(function(x$20671){return ["data",["symbol","true"],["send",["symbol","parseFloat"],["data",x$20671]]];});}else{(other$20675=$20641$20647);return ["send",["symbol","___projector"],["data",prj$20632]];}}}()));;($20637$20679=context$20502);;if((((x$20689=$20637$20679)),((x$20689 instanceof Array)&&(x$20689[0]==="pattern")))){($20694$20696=target$20633);;if((($20694$20696 instanceof Array)&&((t0$20701=$20694$20696.length),((t0$20701===1)&&($20694$20696[0]==="void"))))){return ["project",projector$20638,["ignore"]];}else{(other$20710=$20694$20696);return ["project",projector$20638,target$20633];}}else{(other$20714=$20637$20679);return ["send",["send",projector$20638,["data",target$20633]],["value",1]];}}else{$22932($20507$20517);}}}),accum$20497)),$16090(((accum$20719=({})),((accum$20719["#"]=function(context$20724,scope$20725,form$20726,$20722$20727){var t0$20731;var t1$20732;var t2$20733;var t3$20734;var t4$20735;var t5$20736;var f$20747;var tag$20729;(t0$20731=$20722$20727);if(((t0$20731 instanceof Array)&&((t1$20732=t0$20731.length),((t1$20732===3)&&((t0$20731[0]==="data")&&((t2$20733=t0$20731[1]),((t2$20733 instanceof Array)&&((t3$20734=t2$20733.length),((t3$20734===1)&&((t2$20733[0]==="void")&&((t4$20735=t0$20731[2]),((t4$20735 instanceof Array)&&((t5$20736=t4$20735.length),((t5$20736===2)&&(t4$20735[0]==="symbol"))))))))))))))){(tag$20729=t4$20735[1]);;}else{$22932($20722$20727);}(tag$20729=["value",tag$20729]);(f$20747=function($20750$20752,scope$20753,form$20754,expr$20755){var x$20773;var other$20823;var subp$20813;var $20780$20809;var $20781$20810;var t0$20807;var $20779$20802;var checker_mac$20782;var other$20853;var args$20848;var $20829$20839;var $20830$20840;var t0$20837;var $20828$20832;var $20757$20763;var ph$20758;(ph$20758=$20750$20752);;($20757$20763=ph$20758);;if((((x$20773=$20757$20763)),((x$20773 instanceof Array)&&(x$20773[0]==="pattern")))){(checker_mac$20782=["macro",function(context$20787,scope$20788,form$20789,$20785$20790){var t0$20794;var t1$20795;var expr$20792;(t0$20794=$20785$20790);if(((t0$20794 instanceof Array)&&((t1$20795=t0$20794.length),((t1$20795===2)&&(t0$20794[0]==="data"))))){(expr$20792=t0$20794[1]);;}else{$22932($20785$20790);}return ["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","x"],expr$20792]],["send",["symbol","and"],["data",["send",["symbol","instanceof"],["data",["symbol","x"],["symbol","Array"]]],["send",["symbol","==="],["data",["send",["symbol","x"],["value",0]],tag$20729]]]]]];}]);;($20779$20802=expr$20755);;if((($20780$20809=($20779$20802 instanceof Array))&&((t0$20807=$20779$20802.length),((t0$20807>=1)&&($20779$20802[0]==="data"))))){(subp$20813=Array.prototype.slice.call($20779$20802,1));return ["data",tag$20729].concat(subp$20813);}else{if(($20780$20809&&((t0$20807===1)&&($20779$20802[0]==="void")))){return ["check",checker_mac$20782,["ignore"]];}else{(other$20823=$20779$20802);return ["check",checker_mac$20782,expr$20755];}}}else{$20757$20763;($20828$20832=expr$20755);;if((($20829$20839=($20828$20832 instanceof Array))&&((t0$20837=$20828$20832.length),((t0$20837===1)&&($20828$20832[0]==="void"))))){return ["data",tag$20729];}else{if(($20829$20839&&((t0$20837>=1)&&($20828$20832[0]==="data")))){(args$20848=Array.prototype.slice.call($20828$20832,1));return ["data",tag$20729].concat(args$20848);}else{(other$20853=$20828$20832);return ["send",["data",tag$20729],other$20853];}}}});;return ["macro",f$20747];}),accum$20719)),$16090(((accum$20857=({})),((accum$20857["require"]=function(context$20862,scope$20863,form$20864,$20860$20865){var t0$20869;var t1$20870;var req$20876;var stmts$20877;var topfetch$20878;var produce$20879;var expr$20867;(t0$20869=$20860$20865);if(((t0$20869 instanceof Array)&&((t1$20870=t0$20869.length),((t1$20870===2)&&(t0$20869[0]==="data"))))){(expr$20867=t0$20869[1]);;}else{$22932($20860$20865);}(req$20876=["variable","require"]);;(stmts$20877=[]);;(topfetch$20878=function(pkg$20889,v$20890){stmts$20877.push(["send",["symbol","="],["data",v$20890,["send",req$20876,["data",pkg$20889]]]]);return v$20890;});;(produce$20879=function($20896$20898,fetch$20899){var t0$20915;var t0$20959;var t0$20963;var $index$20982;var $length$20977;var temp$20972;var pkgv$21037;var pkg$21030;var subp$21031;var pkg$21014;var s$21015;var name$21002;var subp$20956;var s$20950;var s$20944;var $20903$20933;var $20904$20934;var $20905$20935;var $20906$20936;var $20907$20937;var $20908$20938;var $20909$20939;var $20910$20940;var $20911$20941;var t0$20924;var t1$20925;var bridge$20902$20926;var t2$20927;var t3$20928;var t4$20929;var t5$20930;var t6$20931;var $20901$20919;var ph$20912;var expr$20913;(t0$20915=$20896$20898);(expr$20913=t0$20915);(ph$20912=t0$20915);;($20901$20919=ph$20912);;if((($20903$20933=($20901$20919 instanceof Array))&&((t0$20924=$20901$20919.length),(($20905$20935=(t0$20924===2))&&($20901$20919[0]==="symbol"))))){(s$20944=$20901$20919[1]);return fetch$20899(["value",s$20944],expr$20913);}else{if(($20905$20935&&(($20901$20919[0]==="value")&&((t1$20925=$20901$20919[1]),(typeof(t1$20925)==="string"))))){(s$20950=t1$20925);return fetch$20899(expr$20913,["symbol",scope$20863.gensym()]);}else{(bridge$20902$20926=$20901$20919);if((((bridge$20902$20926 instanceof Array)&&((t0$20959=bridge$20902$20926.length),((t0$20959>=1)&&((bridge$20902$20926[0]==="multi")&&((subp$20956=Array.prototype.slice.call(bridge$20902$20926,1)),true)))))||((bridge$20902$20926 instanceof Array)&&((t0$20963=bridge$20902$20926.length),((t0$20963>=1)&&((bridge$20902$20926[0]==="data")&&((subp$20956=Array.prototype.slice.call(bridge$20902$20926,1)),true))))))){(temp$20972=subp$20956);;($length$20977=temp$20972.length);;($index$20982=0);;$20968:for(;($index$20982<$length$20977);($index$20982++)){var p$20998;var m$20990;(m$20990=temp$20972[$index$20982]);;(p$20998=m$20990);produce$20879(p$20998,fetch$20899);}return null;}else{if((($20903$20933=($20901$20919 instanceof Array))&&((t0$20924=$20901$20919.length),(($20905$20935=(t0$20924===3))&&(($20906$20936=($20901$20919[0]==="send"))&&((t1$20925=$20901$20919[1]),(($20908$20938=(t1$20925 instanceof Array))&&((t2$20927=t1$20925.length),(($20910$20940=(t2$20927===2))&&(($20911$20941=(t1$20925[0]==="symbol"))&&((t1$20925[1]==="^")&&((t3$20928=$20901$20919[2]),((t3$20928 instanceof Array)&&((t4$20929=t3$20928.length),((t4$20929===3)&&((t3$20928[0]==="data")&&((t5$20930=t3$20928[1]),((t5$20930 instanceof Array)&&((t6$20931=t5$20930.length),((t6$20931===1)&&(t5$20930[0]==="void"))))))))))))))))))))){(name$21002=t3$20928[2]);return fetch$20899(name$21002,["symbol",scope$20863.gensym()]);}else{if(($20911$20941&&((t1$20925[1]==="as")&&((t3$20928=$20901$20919[2]),((t3$20928 instanceof Array)&&((t4$20929=t3$20928.length),((t4$20929===3)&&(t3$20928[0]==="data")))))))){(pkg$21014=t3$20928[1]);(s$21015=t3$20928[2]);return produce$20879(pkg$21014,function(the_pkg$21022,$21020$21023){$21020$21023;;return fetch$20899(the_pkg$21022,s$21015);});}else{if(($20911$20941&&((t1$20925[1]==="->")&&((t3$20928=$20901$20919[2]),((t3$20928 instanceof Array)&&((t4$20929=t3$20928.length),((t4$20929===3)&&(t3$20928[0]==="data")))))))){(pkg$21030=t3$20928[1]);(subp$21031=t3$20928[2]);(pkgv$21037=produce$20879(pkg$21030,fetch$20899));;return produce$20879(subp$21031,function(pkg$21042,v$21043){stmts$20877.push(["send",["symbol","="],["data",v$21043,["send",pkgv$21037,pkg$21042]]]);return v$21043;});}else{$22932($20901$20919);}}}}}}});;produce$20879(expr$20867,topfetch$20878);return ["splice"].concat(stmts$20877);}),accum$20857)),$16090(((accum$21050=({})),((accum$21050["provide"]=function(context$21055,scope$21056,form$21057,$21053$21058){var t0$21062;var t1$21063;var t2$21064;var t3$21065;var t4$21066;var $index$21094;var $length$21089;var temp$21084;var acc$21079;var expr$21060;(t0$21062=$21053$21058);if(((t0$21062 instanceof Array)&&((t1$21063=t0$21062.length),((t1$21063===2)&&((t0$21062[0]==="data")&&((t2$21064=$23017(["multi"])(t0$21062[1])),(t2$21064[0]&&((t3$21065=t2$21064[1]),((t4$21066=t3$21065.length),(t4$21066>=0)))))))))){(expr$21060=Array.prototype.slice.call(t3$21065,0));;}else{$22932($21053$21058);}return ["sink",["multi"].concat((((acc$21079=[])),(((temp$21084=expr$21060)),((($length$21089=temp$21084.length)),((($index$21094=0)),function(){$21074:for(;($index$21094<$length$21089);($index$21094++)){var t0$21136;var t0$21140;var other$21146;var s$21125;var name$21126;var s$21118;var name$21119;var $21077$21115;var t0$21107;var t1$21108;var t2$21109;var t3$21110;var t4$21111;var t5$21112;var bridge$21076$21113;var m$21102;(m$21102=temp$21084[$index$21094]);;(t0$21107=m$21102);(s$21118=t0$21107);if(((t0$21107 instanceof Array)&&((t1$21108=t0$21107.length),((t1$21108===2)&&(t0$21107[0]==="symbol"))))){(name$21119=t0$21107[1]);acc$21079.push(["send",["symbol",":="],["data",["send",["symbol","exports"],["value",name$21119]],s$21118]]);}else{if(((t0$21107 instanceof Array)&&((t1$21108=t0$21107.length),((t1$21108===3)&&((t0$21107[0]==="send")&&((t2$21109=t0$21107[1]),((t2$21109 instanceof Array)&&((t3$21110=t2$21109.length),((t3$21110===2)&&((t2$21109[0]==="symbol")&&((t2$21109[1]==="as")&&((t4$21111=t0$21107[2]),((t4$21111 instanceof Array)&&((t5$21112=t4$21111.length),((t5$21112===3)&&((t4$21111[0]==="data")&&((s$21125=t4$21111[1]),((bridge$21076$21113=t4$21111[2]),(((bridge$21076$21113 instanceof Array)&&((t0$21136=bridge$21076$21113.length),((t0$21136===2)&&((bridge$21076$21113[0]==="symbol")&&((name$21126=bridge$21076$21113[1]),true)))))||((bridge$21076$21113 instanceof Array)&&((t0$21140=bridge$21076$21113.length),((t0$21140===2)&&((bridge$21076$21113[0]==="value")&&((name$21126=bridge$21076$21113[1]),true)))))))))))))))))))))))){acc$21079.push(["send",["symbol",":="],["data",["send",["symbol","exports"],["value",name$21126]],s$21125]]);}else{(other$21146=m$21102);acc$21079.push(function(){throw $22741(["syntax","provide"]).create("Each clause of provide must be 'sym' or 'sym as name'");}());}}}}()))),acc$21079))];}),accum$21050)),$16090(((accum$21149=({})),((accum$21149["class"]=function(context$21154,scope$21155,$21152$21156,expr$21157){var t0$21161;var stmts$21489;var name$21478;var stmts$21479;var $21167$21474;var $21168$21475;var t0$21469;var t1$21470;var t2$21471;var t3$21472;var $21166$21464;var helper$21169;var env$21159;(t0$21161=$21152$21156);if($22703(t0$21161,"env")){(env$21159=t0$21161.env);;}else{$22932($21152$21156);}(helper$21169=function(name$21173,stmts$21174){var $index$21212;var $length$21207;var temp$21202;var acc$21197;var t0$21418;var t1$21419;var t0$21428;var env2$21425;var it$21426;var t0$21436;var t1$21437;var other$21460;var t0$21451;var $21177$21446;var statics$21178;var ctor$21179;var new_stmts$21180;var ctor_args$21181;var ctor_body$21182;var name_str$21183;var node$21184;(statics$21178=["data",["symbol","="]]);;(ctor$21179=[["data"],$22945(["multi"],({"env":env$21159}))]);;(new_stmts$21180=(((acc$21197=[])),(((temp$21202=stmts$21174)),((($length$21207=temp$21202.length)),((($index$21212=0)),function(){$21193:for(;($index$21212<$length$21207);($index$21212++)){var t0$21255;var t1$21256;var t2$21257;var t3$21258;var t4$21259;var t5$21260;var t6$21261;var t7$21262;var t8$21263;var t0$21276;var t1$21277;var t2$21278;var t3$21279;var t4$21280;var t5$21281;var t6$21282;var t7$21283;var t8$21284;var t9$21285;var t10$21286;var t11$21287;var t12$21288;var accum$21318;var accum$21342;var accum$21349;var accum$21404;var lhs$21308;var rhs$21309;var args$21251;var body$21252;var methods$21238;var t0$21225;var t1$21226;var t2$21227;var t3$21228;var t4$21229;var t5$21230;var t6$21231;var t7$21232;var t8$21233;var bridge$21195$21234;var m$21220;(m$21220=temp$21202[$index$21212]);;(t0$21225=m$21220);if(((t0$21225 instanceof Array)&&((t1$21226=t0$21225.length),((t1$21226===3)&&((t0$21225[0]==="send")&&((t2$21227=t0$21225[1]),((t2$21227 instanceof Array)&&((t3$21228=t2$21227.length),((t3$21228===2)&&((t2$21227[0]==="symbol")&&((t2$21227[1]==="static")&&((t4$21229=t0$21225[2]),((t4$21229 instanceof Array)&&((t5$21230=t4$21229.length),((t5$21230===2)&&((t4$21229[0]==="data")&&((t6$21231=$23017(["multi"])(t4$21229[1])),(t6$21231[0]&&((t7$21232=t6$21231[1]),((t8$21233=t7$21232.length),(t8$21233>=0))))))))))))))))))))){(methods$21238=Array.prototype.slice.call(t7$21232,0));acc$21197.push((statics$21178=statics$21178.concat(methods$21238)));}else{(bridge$21195$21234=m$21220);if((((bridge$21195$21234 instanceof Array)&&((t0$21255=bridge$21195$21234.length),((t0$21255===3)&&((bridge$21195$21234[0]==="send")&&((t1$21256=bridge$21195$21234[1]),((t1$21256 instanceof Array)&&((t2$21257=t1$21256.length),((t2$21257===2)&&((t1$21256[0]==="symbol")&&((t1$21256[1]==="=")&&((t3$21258=bridge$21195$21234[2]),((t3$21258 instanceof Array)&&((t4$21259=t3$21258.length),((t4$21259===3)&&((t3$21258[0]==="data")&&((t5$21260=t3$21258[1]),((t5$21260 instanceof Array)&&((t6$21261=t5$21260.length),((t6$21261===3)&&((t5$21260[0]==="send")&&((t7$21262=t5$21260[1]),((t7$21262 instanceof Array)&&((t8$21263=t7$21262.length),((t8$21263===2)&&((t7$21262[0]==="symbol")&&((t7$21262[1]==="constructor")&&((args$21251=t5$21260[2]),((body$21252=t3$21258[2]),true))))))))))))))))))))))))))))||((bridge$21195$21234 instanceof Array)&&((t0$21276=bridge$21195$21234.length),((t0$21276===3)&&((bridge$21195$21234[0]==="send")&&((t1$21277=bridge$21195$21234[1]),((t1$21277 instanceof Array)&&((t2$21278=t1$21277.length),((t2$21278===2)&&((t1$21277[0]==="symbol")&&((t1$21277[1]==="=")&&((t3$21279=bridge$21195$21234[2]),((t3$21279 instanceof Array)&&((t4$21280=t3$21279.length),((t4$21280===3)&&((t3$21279[0]==="data")&&((t5$21281=t3$21279[1]),((t5$21281 instanceof Array)&&((t6$21282=t5$21281.length),((t6$21282===2)&&((t5$21281[0]==="symbol")&&((t5$21281[1]==="constructor")&&((t7$21283=t3$21279[2]),((t7$21283 instanceof Array)&&((t8$21284=t7$21283.length),((t8$21284===3)&&((t7$21283[0]==="send")&&((t9$21285=t7$21283[1]),((t9$21285 instanceof Array)&&((t10$21286=t9$21285.length),((t10$21286===2)&&((t9$21285[0]==="symbol")&&((t9$21285[1]==="->")&&((t11$21287=t7$21283[2]),((t11$21287 instanceof Array)&&((t12$21288=t11$21287.length),((t12$21288===3)&&((t11$21287[0]==="data")&&((args$21251=t11$21287[1]),((body$21252=t11$21287[2]),true))))))))))))))))))))))))))))))))))))))))){acc$21197.push(((ctor$21179=[args$21251,body$21252]),["splice"]));}else{(t0$21225=m$21220);if(((t0$21225 instanceof Array)&&((t1$21226=t0$21225.length),((t1$21226===3)&&((t0$21225[0]==="send")&&((t2$21227=t0$21225[1]),((t2$21227 instanceof Array)&&((t3$21228=t2$21227.length),((t3$21228===2)&&((t2$21227[0]==="symbol")&&((t2$21227[1]==="=")&&((t4$21229=t0$21225[2]),((t4$21229 instanceof Array)&&((t5$21230=t4$21229.length),((t5$21230===3)&&(t4$21229[0]==="data")))))))))))))))){(lhs$21308=t4$21229[1]);(rhs$21309=t4$21229[2]);acc$21197.push(parse_pattern$16149(scope$21155,lhs$21308,rhs$21309,$22945(pattern_handlers$16179.build_object,$16090(({"allow_nested":false}),$16090(((accum$21318=({})),((accum$21318["assign"]=function($21321$21324,value$21325){var t0$21332;var t0$21336;var bridge$21322$21329;var v$21327;(bridge$21322$21329=$21321$21324);if((((bridge$21322$21329 instanceof Array)&&((t0$21332=bridge$21322$21329.length),((t0$21332===2)&&((bridge$21322$21329[0]==="symbol")&&((v$21327=bridge$21322$21329[1]),true)))))||((bridge$21322$21329 instanceof Array)&&((t0$21336=bridge$21322$21329.length),((t0$21336===2)&&((bridge$21322$21329[0]==="value")&&((v$21327=bridge$21322$21329[1]),true))))))){;}else{$22932($21321$21324);}return ["do",__lt____lt____colon__$16142(["assign",["send",["send",name$21173,["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value",v$21327]],value$21325],v$21327)];}),accum$21318)),$16090(((accum$21342=({})),((accum$21342["declare"]=function(vars$21346){return [];}),accum$21342)),$16090(((accum$21349=({})),((accum$21349["wrap_target"]=function($21352$21354){var t0$21389;var other_env$21385;var it$21386;var it2$21387;var other$21401;var args$21375;var body$21376;var t0$21367;var t1$21368;var t2$21369;var t3$21370;var t4$21371;var $21356$21362;var ph$21357;(ph$21357=$21352$21354);;($21356$21362=ph$21357);;if((($21356$21362 instanceof Array)&&((t0$21367=$21356$21362.length),((t0$21367===3)&&(($21356$21362[0]==="send")&&((t1$21368=$21356$21362[1]),((t1$21368 instanceof Array)&&((t2$21369=t1$21368.length),((t2$21369===2)&&((t1$21368[0]==="symbol")&&((t1$21368[1]==="->")&&((t3$21370=$21356$21362[2]),((t3$21370 instanceof Array)&&((t4$21371=t3$21370.length),((t4$21371===3)&&(t3$21370[0]==="data")))))))))))))))){(args$21375=t3$21370[1]);(body$21376=t3$21370[2]);(t0$21389=body$21376);if($22703(t0$21389,"env")){(other_env$21385=t0$21389.env);;}else{$22932(body$21376,"/home/olivier/git/earl-grey/src/stdenv.eg",28579,28583);}(it$21386=$22945(["symbol","@"],({"env":other_env$21385})));;(it2$21387=$22945(["symbol","self"],({"env":other_env$21385})));;return ["send",["symbol","->"],["data",args$21375,["send",["symbol","let"],["data",["multi",["send",["symbol","="],["data",it$21386,["symbol","this"]]],["send",["symbol","="],["data",it2$21387,["symbol","this"]]]],body$21376]]]];}else{(other$21401=$21356$21362);return other$21401;}}),accum$21349)),((accum$21404=({})),((accum$21404["success"]=function($21407$21409){$21407$21409;;return ["splice"];}),accum$21404)))))))));}else{$22932(m$21220,"/home/olivier/git/earl-grey/src/stdenv.eg",27848,29002);;}}}}}()))),acc$21197));;(t0$21418=ctor$21179);if(((t0$21418 instanceof Array)&&((t1$21419=t0$21418.length),(t1$21419===2)))){(ctor_args$21181=t0$21418[0]);(ctor_body$21182=t0$21418[1]);;}else{$22932(ctor$21179,"/home/olivier/git/earl-grey/src/stdenv.eg",29027,29031);}(ctor_body$21182=(((t0$21428=ctor_body$21182),function(){if($22703(t0$21428,"env")){(env2$21425=t0$21428.env);}else{return $22932(ctor_body$21182,"/home/olivier/git/earl-grey/src/stdenv.eg",29082,29091);}}()),((it$21426=$22945(["symbol","@"],({"env":env2$21425})))),["send",["symbol","let"],["data",["send",["symbol","="],["data",it$21426,["send",["symbol","if"],["data",["send",["symbol","not"],["data",["void"],["send",["symbol","?"],["data",name$21173,["symbol","this"]]]]],["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","create"]]]],["data",["send",name$21173,["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]],["symbol","this"]]]]],["multi",ctor_body$21182,it$21426]]]));(t0$21436=name$21173);if(((t0$21436 instanceof Array)&&((t1$21437=t0$21436.length),((t1$21437===2)&&(t0$21436[0]==="symbol"))))){(name_str$21183=t0$21436[1]);;}else{$22932(name$21173,"/home/olivier/git/earl-grey/src/stdenv.eg",29307,29311);}statics$21178.push(["send",["symbol","="],["data",["value","::name"],["value",name_str$21183]]]);statics$21178.push(["send",["symbol","="],["data",["value","::egclass"],["symbol","true"]]]);(node$21184=["splice",["send",["symbol","="],["data",name$21173,["send",["symbol","->"],["data",ctor_args$21181,ctor_body$21182]]]]].concat(new_stmts$21180).concat([["send",["symbol","&:"],["data",name$21173,statics$21178]],name$21173]));;($21177$21446=context$21154);;if((($21177$21446 instanceof Array)&&((t0$21451=$21177$21446.length),((t0$21451===2)&&(($21177$21446[0]==="expr")&&($21177$21446[1]==="multi")))))){return node$21184;}else{(other$21460=$21177$21446);return ["multi",node$21184];}});;($21166$21464=expr$21157);;if((($21167$21474=($21166$21464 instanceof Array))&&((t0$21469=$21166$21464.length),((t0$21469===3)&&(($21166$21464[0]==="data")&&((name$21478=$21166$21464[1]),((t1$21470=$23017(["multi"])($21166$21464[2])),(t1$21470[0]&&((t2$21471=t1$21470[1]),((t3$21472=t2$21471.length),(t3$21472>=0))))))))))){(stmts$21479=Array.prototype.slice.call(t2$21471,0));return helper$21169(name$21478,stmts$21479);}else{if(($21167$21474&&((t0$21469===2)&&(($21166$21464[0]==="data")&&((t1$21470=$23017(["multi"])($21166$21464[1])),(t1$21470[0]&&((t2$21471=t1$21470[1]),((t3$21472=t2$21471.length),(t3$21472>=0))))))))){(stmts$21489=Array.prototype.slice.call(t2$21471,0));return helper$21169(["symbol",scope$21155.gensym()],stmts$21489);}else{$22932($21166$21464);}}}),accum$21149)),$16090(((accum$21498=({})),((accum$21498["%"]=function(context$21503,scope$21504,form$21505,$21501$21506){var t0$21511;var t1$21512;var x$21694;var args$21689;var $21670$21680;var $21671$21681;var t0$21678;var $21669$21673;var tags$21518;var parse$21519;var descr$21508;var contents$21509;(t0$21511=$21501$21506);if(((t0$21511 instanceof Array)&&((t1$21512=t0$21511.length),((t1$21512===3)&&(t0$21511[0]==="data"))))){(descr$21508=t0$21511[1]);(contents$21509=t0$21511[2]);;}else{$22932($21501$21506);}(tags$21518=["data"]);;(parse$21519=function($21525$21527){var t0$21546;var t0$21603;var t0$21607;var t0$21621;var t0$21625;var t0$21638;var t0$21642;var t0$21658;var t0$21662;var args$21655;var expr$21648;var rest$21649;var prop$21631;var value$21632;var x$21613;var x$21593;var x$21588;var s$21583;var $21534$21567;var $21535$21568;var $21536$21569;var $21537$21570;var $21538$21571;var $21539$21572;var $21540$21573;var $21541$21574;var $21542$21575;var t0$21555;var t1$21556;var t2$21557;var t3$21558;var t4$21559;var t5$21560;var t6$21561;var bridge$21530$21562;var bridge$21531$21563;var bridge$21532$21564;var bridge$21533$21565;var $21529$21550;var ph$21543;var toparse$21544;(t0$21546=$21525$21527);(toparse$21544=t0$21546);(ph$21543=t0$21546);;($21529$21550=ph$21543);;if((($21534$21567=($21529$21550 instanceof Array))&&((t0$21555=$21529$21550.length),((t0$21555===1)&&($21529$21550[0]==="void"))))){return null;}else{if(($21534$21567&&(($21536$21569=(t0$21555===2))&&($21529$21550[0]==="symbol")))){(s$21583=$21529$21550[1]);return tags$21518.push(["value",("+"+s$21583)]);}else{if(($21536$21569&&($21529$21550[0]==="value"))){(x$21588=$21529$21550[1]);return tags$21518.push(["value",("+"+x$21588)]);}else{if(($21534$21567&&(($21536$21569=(t0$21555===3))&&(($21537$21570=($21529$21550[0]==="send"))&&((t1$21556=$21529$21550[1]),(($21539$21572=(t1$21556 instanceof Array))&&((t2$21557=t1$21556.length),(($21541$21574=(t2$21557===2))&&(($21542$21575=(t1$21556[0]==="symbol"))&&((t1$21556[1]===".")&&((t3$21558=$21529$21550[2]),((t3$21558 instanceof Array)&&((t4$21559=t3$21558.length),((t4$21559===3)&&((t3$21558[0]==="data")&&((t5$21560=t3$21558[1]),((t5$21560 instanceof Array)&&((t6$21561=t5$21560.length),((t6$21561===1)&&((t5$21560[0]==="void")&&((bridge$21530$21562=t3$21558[2]),(((bridge$21530$21562 instanceof Array)&&((t0$21603=bridge$21530$21562.length),((t0$21603===2)&&((bridge$21530$21562[0]==="symbol")&&((x$21593=bridge$21530$21562[1]),true)))))||((bridge$21530$21562 instanceof Array)&&((t0$21607=bridge$21530$21562.length),((t0$21607===2)&&((bridge$21530$21562[0]==="value")&&((x$21593=bridge$21530$21562[1]),true))))))))))))))))))))))))))){return tags$21518.push(["value",x$21593]);}else{if(($21542$21575&&((t1$21556[1]==="#")&&((t3$21558=$21529$21550[2]),((t3$21558 instanceof Array)&&((t4$21559=t3$21558.length),((t4$21559===3)&&((t3$21558[0]==="data")&&((t5$21560=t3$21558[1]),((t5$21560 instanceof Array)&&((t6$21561=t5$21560.length),((t6$21561===1)&&((t5$21560[0]==="void")&&((bridge$21531$21563=t3$21558[2]),(((bridge$21531$21563 instanceof Array)&&((t0$21621=bridge$21531$21563.length),((t0$21621===2)&&((bridge$21531$21563[0]==="symbol")&&((x$21613=bridge$21531$21563[1]),true)))))||((bridge$21531$21563 instanceof Array)&&((t0$21625=bridge$21531$21563.length),((t0$21625===2)&&((bridge$21531$21563[0]==="value")&&((x$21613=bridge$21531$21563[1]),true)))))))))))))))))))){return tags$21518.push(["value",("#"+x$21613)]);}else{if(($21542$21575&&((t1$21556[1]==="=")&&((t3$21558=$21529$21550[2]),((t3$21558 instanceof Array)&&((t4$21559=t3$21558.length),((t4$21559===3)&&((t3$21558[0]==="data")&&((bridge$21532$21564=t3$21558[1]),(((bridge$21532$21564 instanceof Array)&&((t0$21638=bridge$21532$21564.length),((t0$21638===2)&&((bridge$21532$21564[0]==="symbol")&&((prop$21631=bridge$21532$21564[1]),true)))))||((bridge$21532$21564 instanceof Array)&&((t0$21642=bridge$21532$21564.length),((t0$21642===2)&&((bridge$21532$21564[0]==="value")&&((prop$21631=bridge$21532$21564[1]),true))))))))))))))){(value$21632=t3$21558[2]);return tags$21518.push(["send",["send",["symbol","#"],["data",["void"],["symbol","assoc"]]],["data",["value",prop$21631],value$21632]]);}else{if($21537$21570){(expr$21648=$21529$21550[1]);(rest$21649=$21529$21550[2]);parse$21519(expr$21648);return parse$21519(rest$21649);}else{(bridge$21533$21565=$21529$21550);if((((bridge$21533$21565 instanceof Array)&&((t0$21658=bridge$21533$21565.length),((t0$21658>=1)&&((bridge$21533$21565[0]==="multi")&&((args$21655=Array.prototype.slice.call(bridge$21533$21565,1)),true)))))||((bridge$21533$21565 instanceof Array)&&((t0$21662=bridge$21533$21565.length),((t0$21662>=1)&&((bridge$21533$21565[0]==="data")&&((args$21655=Array.prototype.slice.call(bridge$21533$21565,1)),true))))))){return args$21655.forEach(parse$21519);}else{$22932($21529$21550);}}}}}}}}});;parse$21519(descr$21508);(contents$21509=((($21669$21673=contents$21509)),function(){if((($21670$21680=($21669$21673 instanceof Array))&&((t0$21678=$21669$21673.length),((t0$21678===1)&&($21669$21673[0]==="void"))))){return ["data"];}else{if(($21670$21680&&((t0$21678>=1)&&($21669$21673[0]==="multi")))){(args$21689=Array.prototype.slice.call($21669$21673,1));return ["data"].concat(args$21689);}else{(x$21694=$21669$21673);return x$21694;}}}()));return ["send",["symbol","Node"],["data",tags$21518,contents$21509]];}),accum$21498)),((accum$21697=({})),((accum$21697["globals"]=function(context$21702,scope$21703,form$21704,$21700$21705){var t0$21709;var t1$21710;var t2$21711;var t3$21712;var t4$21713;var $index$21740;var $length$21735;var temp$21730;var acc$21725;var vars$21707;(t0$21709=$21700$21705);if(((t0$21709 instanceof Array)&&((t1$21710=t0$21709.length),((t1$21710===2)&&((t0$21709[0]==="data")&&((t2$21711=$23017(["multi"])(t0$21709[1])),(t2$21711[0]&&((t3$21712=t2$21711[1]),((t4$21713=t3$21712.length),(t4$21713>=0)))))))))){(vars$21707=Array.prototype.slice.call(t3$21712,0));;}else{$22932($21700$21705);}return ["splice"].concat((((acc$21725=[])),(((temp$21730=vars$21707)),((($length$21735=temp$21730.length)),((($index$21740=0)),function(){$21722:for(;($index$21740<$length$21735);($index$21740++)){var variable$21758;var s$21759;var t0$21753;var t1$21754;var m$21748;(m$21748=temp$21730[$index$21740]);;(t0$21753=m$21748);(variable$21758=t0$21753);if(((t0$21753 instanceof Array)&&((t1$21754=t0$21753.length),((t1$21754===2)&&(t0$21753[0]==="symbol"))))){(s$21759=t0$21753[1]);acc$21725.push(["declare_raw",variable$21758,["variable",s$21759]]);}else{$22932(m$21748,"/home/olivier/git/earl-grey/src/stdenv.eg",30951,31038);;}}}()))),acc$21725));}),accum$21697)))))))))))))))))))))))))))))))))))))))))))))))))));;($length$21767=temp$17322.length);;($index$21772=0);;$16193:for(;($index$21772<$length$21767);($index$21772++)){var k$21790;var v$21791;var t0$21785;var t1$21786;var m$21780;(m$21780=temp$17322[$index$21772]);;(t0$21785=m$21780);if(((t0$21785 instanceof Array)&&((t1$21786=t0$21785.length),(t1$21786===2)))){(k$21790=t0$21785[0]);(v$21791=t0$21785[1]);stdenv$16160.bind(topscope$16164,k$21790,["macro",v$21791]);}else{$22932(m$21780,"/home/olivier/git/earl-grey/src/stdenv.eg",8112,8178);;}}(blocktest_wrap$16183=function(expr$21800){return ["multi",["send",["symbol","="],["data",["symbol","value"],["send",["symbol","!!"],["data",["multi",["send",["symbol","match"],["data",expr$21800,["multi",["send",["symbol","->"],["data",["send",["symbol","?"],["data",["symbol","true"],["symbol","x"]]],["send",["send",["symbol","#"],["data",["void"],["symbol","success"]]],["data",["symbol","x"]]]]],["send",["symbol","->"],["data",["send",["symbol","?"],["data",["symbol","false"],["symbol","x"]]],["send",["send",["symbol","#"],["data",["void"],["symbol","failure"]]],["data",["symbol","x"]]]]]]]]],["send",["symbol","->"],["data",["symbol","e"],["send",["send",["symbol","#"],["data",["void"],["symbol","error"]]],["data",["symbol","e"]]]]]]]]],["send",["send",["symbol","acc"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",["send",["send",["symbol","#"],["data",["void"],["symbol","test_result"]]],["data",["symbol","label"],["symbol","value"]]]]]];});;(blocktest_mac$16184=function(scope$21806,tests$21807){var $index$21843;var $length$21838;var temp$21833;var acc$21828;var exptests$21810;var n$21811;var stmts$21812;(exptests$21810=$22910(scope$21806.step_all(["test"],tests$21807)));;(n$21811=exptests$21810.length);;(stmts$21812=(((acc$21828=[])),(((temp$21833=exptests$21810)),((($length$21838=temp$21833.length)),((($index$21843=0)),function(){$21821:for(;($index$21843<$length$21838);($index$21843++)){var wrap$21899;var fall$21900;var lbl$21921;var i$21916;var expr$21917;var i$21887;var elements$21888;var clauses$21889;var env$21890;var i$21877;var more_labels$21878;var more_tests$21879;var i$21867;var stmt$21868;var $21823$21861;var $21824$21862;var $21825$21863;var $21826$21864;var t0$21856;var t1$21857;var t2$21858;var t3$21859;var m$21851;(m$21851=temp$21833[$index$21843]);;(t0$21856=m$21851);if((($21824$21862=(t0$21856 instanceof Array))&&((t1$21857=t0$21856.length),(($21826$21864=(t1$21857===2))&&((i$21867=t0$21856[0]),((t2$21858=t0$21856[1]),((t2$21858 instanceof Array)&&((t3$21859=t2$21858.length),((t3$21859===2)&&(t2$21858[0]==="do")))))))))){(stmt$21868=t2$21858[1]);acc$21828.push(stmt$21868);}else{if(($21826$21864&&((i$21877=t0$21856[0]),((t2$21858=t0$21856[1]),((t2$21858 instanceof Array)&&((t3$21859=t2$21858.length),((t3$21859===3)&&(t2$21858[0]==="blocktest")))))))){(more_labels$21878=t2$21858[1]);(more_tests$21879=t2$21858[2]);acc$21828.push(["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","label"],["send",["send",["symbol","label"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",["send",["symbol","!"],["data",["symbol","Array"],more_labels$21878]]]]]],["send",["symbol",":="],["data",["symbol","acc"],["send",["send",["symbol","acc"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",blocktest_mac$16184(scope$21806,more_tests$21879)]]]]]]);}else{if(($21826$21864&&((i$21887=t0$21856[0]),((t2$21858=t0$21856[1]),((t2$21858 instanceof Array)&&((t3$21859=t2$21858.length),((t3$21859===3)&&((t2$21858[0]==="test_factory")&&((elements$21888=t2$21858[1]),((clauses$21889=t2$21858[2]),$22703(t2$21858,"env"))))))))))){(env$21890=t2$21858.env);acc$21828.push((((wrap$21899=function(expr$21904,index$21905){return ["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","label"],["send",["send",["symbol","label"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",["data",index$21905]]]]],blocktest_wrap$16183(expr$21904)]];})),((fall$21900=function(target$21911){return match_error$16167(target$21911);})),build_loop$16180(scope$21806,env$21890,["void"],elements$21888,clauses$21889,wrap$21899,["splice"],["splice"],({"fallback":fall$21900}))));}else{if($21826$21864){(i$21916=t0$21856[0]);(expr$21917=t0$21856[1]);acc$21828.push((((lbl$21921=function(){if((n$21811===1)){return ["data"];}else{return ["data",["value",i$21916]];}}())),["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","label"],["send",["send",["symbol","label"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",lbl$21921]]]],blocktest_wrap$16183(expr$21917)]]));}else{$22932(m$21851,"/home/olivier/git/earl-grey/src/stdenv.eg",31375,32181);;}}}}}}()))),acc$21828));;return ["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","acc"],["data"]]],["send",["symbol","!!"],["data",["multi"].concat(stmts$21812).concat([["symbol","acc"]]),["send",["symbol","->"],["data",["symbol","e"],["send",["send",["symbol","acc"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",["data",["send",["send",["symbol","#"],["data",["void"],["symbol","error"]]],["data",["symbol","label"],["symbol","e"]]]]]]]]]]]];});;stdenv$16160.bind(topscope$16164,"blocktest",["macro",function(context$21931,scope$21932,form$21933,$21929$21934){var t0$21941;var t1$21942;var labels$21971;var tests$21972;var tests$21962;var $21937$21958;var $21938$21959;var t0$21953;var t1$21954;var t2$21955;var t3$21956;var $21936$21948;var args$21939;(t0$21941=$21929$21934);if(((t0$21941 instanceof Array)&&((t1$21942=t0$21941.length),((t1$21942>=1)&&(t0$21941[0]==="data"))))){(args$21939=Array.prototype.slice.call(t0$21941,1));;}else{$22932($21929$21934);}($21936$21948=args$21939);;if((($21937$21958=($21936$21948 instanceof Array))&&((t0$21953=$21936$21948.length),((t0$21953===1)&&((t1$21954=$23017(["multi"])($21936$21948[0])),(t1$21954[0]&&((t2$21955=t1$21954[1]),((t3$21956=t2$21955.length),(t3$21956>=0))))))))){(tests$21962=Array.prototype.slice.call(t2$21955,0));return ["multi",["send",["symbol","="],["data",["symbol","label"],["data"]]],blocktest_mac$16184(scope$21932,tests$21962)];}else{if(($21937$21958&&((t0$21953===2)&&((labels$21971=$21936$21948[0]),((t1$21954=$23017(["multi"])($21936$21948[1])),(t1$21954[0]&&((t2$21955=t1$21954[1]),((t3$21956=t2$21955.length),(t3$21956>=0))))))))){(tests$21972=Array.prototype.slice.call(t2$21955,0));return ["multi",["send",["symbol","="],["data",["symbol","label"],["send",["symbol","!"],["data",["symbol","Array"],labels$21971]]]],blocktest_mac$16184(scope$21932,tests$21972)];}else{$22932($21936$21948);}}}]);(qqstruct$16185=function(name$21984,args$21985){return ["data",["value",name$21984]].concat(args$21985);});;(qq$16186=function($21990$21992){var t0$22007;var $index$22101;var $length$22096;var temp$22091;var acc$22086;var name$22079;var args$22080;var insert$22070;var insert$22061;var insert$22050;var v$22045;var s$22035;var $21995$22024;var $21996$22025;var $21997$22026;var $21998$22027;var $21999$22028;var $22000$22029;var $22001$22030;var $22002$22031;var $22003$22032;var t0$22016;var t1$22017;var t2$22018;var t3$22019;var t4$22020;var t5$22021;var t6$22022;var $21994$22011;var ph$22004;var expr$22005;(t0$22007=$21990$21992);(expr$22005=t0$22007);(ph$22004=t0$22007);;($21994$22011=ph$22004);;if((($21995$22024=($21994$22011 instanceof Array))&&((t0$22016=$21994$22011.length),((t0$22016===2)&&($21994$22011[0]==="symbol"))))){(s$22035=$21994$22011[1]);return qqstruct$16185("symbol",[["value",s$22035]]);}else{if(($21995$22024&&((t0$22016===1)&&($21994$22011[0]==="void")))){return qqstruct$16185("void",[]);}else{if(($21995$22024&&((t0$22016===2)&&($21994$22011[0]==="value")))){(v$22045=$21994$22011[1]);return qqstruct$16185("value",[expr$22005]);}else{if(($21995$22024&&(($21997$22026=(t0$22016===3))&&(($21998$22027=($21994$22011[0]==="send"))&&((t1$22017=$21994$22011[1]),(($22000$22029=(t1$22017 instanceof Array))&&((t2$22018=t1$22017.length),(($22002$22031=(t2$22018===2))&&(($22003$22032=(t1$22017[0]==="symbol"))&&((t1$22017[1]==="^")&&((t3$22019=$21994$22011[2]),((t3$22019 instanceof Array)&&((t4$22020=t3$22019.length),((t4$22020===3)&&((t3$22019[0]==="data")&&((t5$22021=t3$22019[1]),((t5$22021 instanceof Array)&&((t6$22022=t5$22021.length),((t6$22022===1)&&(t5$22021[0]==="void")))))))))))))))))))){(insert$22050=t3$22019[2]);return insert$22050;}else{if(($22003$22032&&((t1$22017[1]==="^=")&&((t3$22019=$21994$22011[2]),((t3$22019 instanceof Array)&&((t4$22020=t3$22019.length),((t4$22020===3)&&((t3$22019[0]==="data")&&((t5$22021=t3$22019[1]),((t5$22021 instanceof Array)&&((t6$22022=t5$22021.length),((t6$22022===1)&&(t5$22021[0]==="void"))))))))))))){(insert$22061=t3$22019[2]);return qqstruct$16185("value",[insert$22061]);}else{if(($22003$22032&&((t1$22017[1]==="^*")&&((t3$22019=$21994$22011[2]),((t3$22019 instanceof Array)&&((t4$22020=t3$22019.length),((t4$22020===3)&&((t3$22019[0]==="data")&&((t5$22021=t3$22019[1]),((t5$22021 instanceof Array)&&((t6$22022=t5$22021.length),((t6$22022===1)&&(t5$22021[0]==="void"))))))))))))){(insert$22070=t3$22019[2]);return ["send",["symbol","*"],["data",["void"],insert$22070]];}else{if(($21995$22024&&(t0$22016>=1))){(name$22079=$21994$22011[0]);(args$22080=Array.prototype.slice.call($21994$22011,1));return qqstruct$16185(name$22079,(((acc$22086=[])),(((temp$22091=args$22080)),((($length$22096=temp$22091.length)),((($index$22101=0)),function(){$22083:for(;($index$22101<$length$22096);($index$22101++)){var arg$22117;var m$22109;(m$22109=temp$22091[$index$22101]);;(arg$22117=m$22109);acc$22086.push(qq$16186(arg$22117));}}()))),acc$22086));}else{$22932($21994$22011);}}}}}}}});;stdenv$16160.bind(topscope$16164,"'",["macro",function(context$22124,scope$22125,form$22126,$22122$22127){var t0$22131;var t1$22132;var t2$22133;var t3$22134;var expr$22129;(t0$22131=$22122$22127);if(((t0$22131 instanceof Array)&&((t1$22132=t0$22131.length),((t1$22132===3)&&((t0$22131[0]==="data")&&((t2$22133=t0$22131[1]),((t2$22133 instanceof Array)&&((t3$22134=t2$22133.length),((t3$22134===1)&&(t2$22133[0]==="void")))))))))){(expr$22129=t0$22131[2]);;}else{$22932($22122$22127);}return qq$16186(expr$22129);}]);(RegexBuilder$16187=function(){var it$0$22146;(it$0$22146=function(){if((!$16074(RegexBuilder$16187)(this))){return Object.create(RegexBuilder$16187.prototype);}else{return this;}}());;;return it$0$22146;});;(RegexBuilder$16187.prototype["wrap"]=function(x$22156){var self$22164;var it$0$22159;(it$0$22159=this);;(self$22164=this);;return (("(?:"+x$22156)+")");});(RegexBuilder$16187.prototype["quote"]=function(x$22171){var self$22179;var it$0$22174;(it$0$22174=this);;(self$22179=this);;return x$22171.replace(RegExp("([.?*+\\^$\\[\\]\\(\\)\\{\\}|\\\\])","g"),"\\$1");});(RegexBuilder$16187.prototype["quote_charset"]=function(x$22186){var self$22194;var it$0$22189;(it$0$22189=this);;(self$22194=this);;return x$22186.replace(RegExp("([\\[\\]\\(\\)\\{\\}\\^])","g"),"\\$1");});(RegexBuilder$16187.prototype["build"]=function(expr$22201){var t0$22348;var t1$22349;var t0$22360;var t1$22361;var t0$22372;var t1$22373;var t0$22385;var t1$22386;var t0$22392;var t1$22393;var x$22399;var v$22383;var t0$22410;var t1$22411;var t0$22417;var t1$22418;var t2$22419;var t3$22420;var t4$22421;var t5$22422;var t6$22423;var t7$22424;var t8$22425;var t9$22426;var x$22440;var v$22408;var $index$22477;var $length$22472;var temp$22467;var acc$22462;var $index$22526;var $length$22521;var temp$22516;var acc$22511;var other$22546;var args$22497;var args$22448;var a$22324;var b$22325;var $22211$22326;var s$22315;var x$22310;var $22210$22248;var $22212$22237;var $22213$22238;var $22214$22239;var $22215$22240;var $22216$22241;var $22217$22242;var $22218$22243;var $22219$22244;var $22220$22245;var t0$22231;var t1$22232;var t2$22233;var t3$22234;var t4$22235;var $22209$22226;var self$22221;var it$0$22204;(it$0$22204=this);;(self$22221=this);;($22209$22226=expr$22201);;if((($22212$22237=($22209$22226 instanceof Array))&&((t0$22231=$22209$22226.length),(($22214$22239=(t0$22231===2))&&($22209$22226[0]==="symbol"))))){($22210$22248=$22209$22226[1]);if(($22210$22248==="any")){return ".";}else{if(($22210$22248==="start")){return "^";}else{if(($22210$22248==="end")){return "$";}else{if(($22210$22248==="alpha")){return "\\a";}else{if(($22210$22248==="digit")){return "\\d";}else{if(($22210$22248==="word")){return "\\w";}else{if(($22210$22248==="space")){return "\\s";}else{if(($22210$22248==="boundary")){return "\\b";}else{if(($22210$22248==="a")){return "\\a";}else{if(($22210$22248==="d")){return "\\d";}else{if(($22210$22248==="w")){return "\\w";}else{if(($22210$22248==="s")){return "\\s";}else{if(($22210$22248==="b")){return "\\b";}else{$22932($22210$22248,"/home/olivier/git/earl-grey/src/stdenv.eg",33475,33480);}}}}}}}}}}}}}}else{if(($22214$22239&&($22209$22226[0]==="value"))){(x$22310=$22209$22226[1]);return it$0$22204.quote(x$22310);}else{if(($22212$22237&&(($22214$22239=(t0$22231===3))&&(($22215$22240=($22209$22226[0]==="send"))&&((t1$22232=$22209$22226[1]),(($22217$22242=(t1$22232 instanceof Array))&&((t2$22233=t1$22232.length),(($22219$22244=(t2$22233===2))&&(($22220$22245=(t1$22232[0]==="symbol"))&&((t1$22232[1]==="raw")&&((t3$22234=$22209$22226[2]),((t3$22234 instanceof Array)&&((t4$22235=t3$22234.length),((t4$22235===2)&&(t3$22234[0]==="value"))))))))))))))){(s$22315=t3$22234[1]);return s$22315;}else{if(($22220$22245&&(($22211$22326=t1$22232[1]),((t3$22234=$22209$22226[2]),((t3$22234 instanceof Array)&&((t4$22235=t3$22234.length),((t4$22235===3)&&(t3$22234[0]==="data")))))))){(a$22324=t3$22234[1]);(b$22325=t3$22234[2]);if(($22211$22326==="||")){return it$0$22204.wrap(((it$0$22204.build(a$22324)+"|")+it$0$22204.build(b$22325)));}else{if(($22211$22326==="or")){return it$0$22204.wrap(((it$0$22204.build(a$22324)+"|")+it$0$22204.build(b$22325)));}else{if(($22211$22326==="*")){(t0$22348=a$22324);if(((t0$22348 instanceof Array)&&((t1$22349=t0$22348.length),((t1$22349===1)&&(t0$22348[0]==="void"))))){;}else{$22932(a$22324,"/home/olivier/git/earl-grey/src/stdenv.eg",34147,34148);}return it$0$22204.wrap((it$0$22204.build(b$22325)+"*"));}else{if(($22211$22326==="+")){(t0$22360=a$22324);if(((t0$22360 instanceof Array)&&((t1$22361=t0$22360.length),((t1$22361===1)&&(t0$22360[0]==="void"))))){;}else{$22932(a$22324,"/home/olivier/git/earl-grey/src/stdenv.eg",34231,34232);}return it$0$22204.wrap((it$0$22204.build(b$22325)+"+"));}else{if(($22211$22326==="?")){(t0$22372=a$22324);if(((t0$22372 instanceof Array)&&((t1$22373=t0$22372.length),((t1$22373===1)&&(t0$22372[0]==="void"))))){;}else{$22932(a$22324,"/home/olivier/git/earl-grey/src/stdenv.eg",34315,34316);}return it$0$22204.wrap((it$0$22204.build(b$22325)+"?"));}else{if(($22211$22326==="in")){(t0$22385=a$22324);if(((t0$22385 instanceof Array)&&((t1$22386=t0$22385.length),((t1$22386===1)&&(t0$22385[0]==="void"))))){;}else{$22932(a$22324,"/home/olivier/git/earl-grey/src/stdenv.eg",34400,34401);}(t0$22392=b$22325);if(((t0$22392 instanceof Array)&&((t1$22393=t0$22392.length),((t1$22393===2)&&(t0$22392[0]==="value"))))){(v$22383=t0$22392[1]);;}else{$22932(b$22325,"/home/olivier/git/earl-grey/src/stdenv.eg",34429,34430);}(x$22399=it$0$22204.quote_charset(v$22383));;return (("["+x$22399)+"]");}else{if(($22211$22326==="not")){(t0$22410=a$22324);if(((t0$22410 instanceof Array)&&((t1$22411=t0$22410.length),((t1$22411===1)&&(t0$22410[0]==="void"))))){;}else{$22932(a$22324,"/home/olivier/git/earl-grey/src/stdenv.eg",34554,34555);}(t0$22417=b$22325);if(((t0$22417 instanceof Array)&&((t1$22418=t0$22417.length),((t1$22418===3)&&((t0$22417[0]==="send")&&((t2$22419=t0$22417[1]),((t2$22419 instanceof Array)&&((t3$22420=t2$22419.length),((t3$22420===2)&&((t2$22419[0]==="symbol")&&((t2$22419[1]==="in")&&((t4$22421=t0$22417[2]),((t4$22421 instanceof Array)&&((t5$22422=t4$22421.length),((t5$22422===3)&&((t4$22421[0]==="data")&&((t6$22423=t4$22421[1]),((t6$22423 instanceof Array)&&((t7$22424=t6$22423.length),((t7$22424===1)&&((t6$22423[0]==="void")&&((t8$22425=t4$22421[2]),((t8$22425 instanceof Array)&&((t9$22426=t8$22425.length),((t9$22426===2)&&(t8$22425[0]==="value")))))))))))))))))))))))))){(v$22408=t8$22425[1]);;}else{$22932(b$22325,"/home/olivier/git/earl-grey/src/stdenv.eg",34621,34622);}(x$22440=it$0$22204.quote_charset(v$22408));;return (("[^"+x$22440)+"]");}else{$22932($22211$22326,"/home/olivier/git/earl-grey/src/stdenv.eg",33939,33944);}}}}}}}}else{if(($22212$22237&&(($22214$22239=(t0$22231>=1))&&($22209$22226[0]==="data")))){(args$22448=Array.prototype.slice.call($22209$22226,1));return (("("+(((acc$22462=[])),(((temp$22467=args$22448)),((($length$22472=temp$22467.length)),((($index$22477=0)),function(){$22459:for(;($index$22477<$length$22472);($index$22477++)){var arg$22493;var m$22485;(m$22485=temp$22467[$index$22477]);;(arg$22493=m$22485);acc$22462.push(it$0$22204.build(arg$22493));}}()))),acc$22462).join(""))+")");}else{if(($22214$22239&&($22209$22226[0]==="multi"))){(args$22497=Array.prototype.slice.call($22209$22226,1));return (("(?:"+(((acc$22511=[])),(((temp$22516=args$22497)),((($length$22521=temp$22516.length)),((($index$22526=0)),function(){$22508:for(;($index$22526<$length$22521);($index$22526++)){var arg$22542;var m$22534;(m$22534=temp$22516[$index$22526]);;(arg$22542=m$22534);acc$22511.push(it$0$22204.build(arg$22542));}}()))),acc$22511).join(""))+")");}else{(other$22546=$22209$22226);return $22741(["syntax","regexp"]).create("Illegal regular expression",({"expr":expr$22201}));}}}}}}});$16090(RegexBuilder$16187,$16090(((accum$22549=({})),((accum$22549["::name"]="RegexBuilder"),accum$22549)),((accum$22553=({})),((accum$22553["::egclass"]=true),accum$22553))));RegexBuilder$16187;(build_regexp$16188=function(x$22559){return RegexBuilder$16187().build(x$22559);});;(mac$22563=function(context$22568,scope$22569,form$22570,$22566$22571,flags$22572){var arg$22606;var v$22599;var $22575$22595;var $22576$22596;var t0$22587;var t1$22588;var t2$22589;var t3$22590;var t4$22591;var t5$22592;var t6$22593;var $22574$22582;var ph$22577;(ph$22577=$22566$22571);;($22574$22582=ph$22577);;if((($22575$22595=($22574$22582 instanceof Array))&&((t0$22587=$22574$22582.length),((t0$22587===2)&&(($22574$22582[0]==="value")&&((t1$22588=$22574$22582[1]),(typeof(t1$22588)==="string"))))))){(v$22599=t1$22588);return ["send",["symbol","RegExp"],["data",["value",v$22599],["value",flags$22572.join("")]]];}else{if(($22575$22595&&((t0$22587===3)&&(($22574$22582[0]==="send")&&((t1$22588=$22574$22582[1]),((t1$22588 instanceof Array)&&((t2$22589=t1$22588.length),((t2$22589===2)&&((t1$22588[0]==="symbol")&&((t1$22588[1]==="'")&&((t3$22590=$22574$22582[2]),((t3$22590 instanceof Array)&&((t4$22591=t3$22590.length),((t4$22591===3)&&((t3$22590[0]==="data")&&((t5$22592=t3$22590[1]),((t5$22592 instanceof Array)&&((t6$22593=t5$22592.length),((t6$22593===1)&&(t5$22592[0]==="void")))))))))))))))))))){(arg$22606=t3$22590[2]);return ["send",["symbol","RegExp"],["data",["value",build_regexp$16188(arg$22606)],["value",flags$22572.join("")]]];}else{$22932($22574$22582);}}});;stdenv$16160.bind(topscope$16164,"R",["macro",accum_flags$16176(mac$22563,false)]);(errf_macro$16189=function(tags$22621){return function(context$22625,scope$22626,form$22627,$22623$22628){var other$22659;var args$22654;var $22631$22645;var $22632$22646;var t0$22643;var $22630$22638;var ph$22633;(ph$22633=$22623$22628);;($22630$22638=ph$22633);;if((($22631$22645=($22630$22638 instanceof Array))&&((t0$22643=$22630$22638.length),((t0$22643===1)&&($22630$22638[0]==="void"))))){return ["send",["symbol","ErrorFactory"],["data",["data"].concat(tags$22621)]];}else{if(($22631$22645&&((t0$22643>=1)&&($22630$22638[0]==="data")))){(args$22654=Array.prototype.slice.call($22630$22638,1));return ["send",["send",["send",["symbol","ErrorFactory"],["data",["data"].concat(tags$22621)]],["send",["symbol","."],["data",["void"],["symbol","create"]]]],["data"].concat(args$22654)];}else{(other$22659=$22630$22638);return ["macro",errf_macro$16189(tags$22621.concat([other$22659]))];}}};});;stdenv$16160.bind(topscope$16164,"E",["macro",errf_macro$16189([])]);(temp$22664=$23045(({"___build_array":Embedded$16159(["send",["symbol","->"],["data",["data",["symbol","arrays"]],["multi",["send",["symbol","="],["data",["symbol","results"],["data"]]],["send",["symbol","each"],["data",["symbol","arrays"],["send",["symbol","->"],["data",["symbol","a"],["send",["symbol",":="],["data",["symbol","results"],["send",["send",["symbol","results"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",["symbol","a"]]]]]]]]],["symbol","results"]]]]),"object":Embedded$16159(["send",["symbol","->"],["data",["data",["symbol","pairs"]],["multi",["send",["symbol","="],["data",["symbol","rval"],["data",["symbol","="]]]],["send",["symbol","each"],["data",["symbol","pairs"],["send",["symbol","->"],["data",["data",["symbol","k"],["symbol","v"]],["send",["symbol",":="],["data",["send",["symbol","rval"],["symbol","k"]],["symbol","v"]]]]]]],["symbol","rval"]]]]),"items":Embedded$16159(["send",["symbol","->"],["data",["data",["symbol","obj"]],["multi",["send",["symbol","="],["data",["symbol","results"],["data"]]],["send",["symbol","for"],["data",["send",["symbol","in"],["data",["symbol","k"],["symbol","obj"]]],["send",["symbol","if"],["data",["send",["send",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","hasOwnProperty"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","obj"],["symbol","k"]]],["send",["send",["symbol","results"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",["data",["symbol","k"],["send",["symbol","obj"],["symbol","k"]]]]]]]]],["symbol","results"]]]]),"keys":Embedded$16159(["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","keys"]]]]),"enumerate":Embedded$16159(["send",["symbol","->"],["data",["data",["symbol","arr"]],["multi",["send",["symbol","="],["data",["symbol","results"],["data"]]],["send",["symbol","="],["data",["symbol","l"],["send",["symbol","arr"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]],["send",["symbol","for"],["data",["multi",["send",["symbol","="],["data",["symbol","i"],["value",0]]],["send",["symbol","<"],["data",["symbol","i"],["symbol","l"]]],["send",["symbol","++"],["data",["symbol","i"],["void"]]]],["send",["send",["symbol","results"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",["data",["symbol","i"],["send",["symbol","arr"],["symbol","i"]]]]]]],["symbol","results"]]]]),"zip":Embedded$16159(["send",["symbol","->"],["data",["data",["symbol","xs"],["symbol","ys"]],["send",["symbol","each"],["data",["send",["symbol","enumerate"],["data",["symbol","xs"]]],["send",["symbol","->"],["data",["data",["symbol","i"],["symbol","x"]],["data",["symbol","x"],["send",["symbol","ys"],["symbol","i"]]]]]]]]]),"predicate":Embedded$16159(["send",["symbol","->"],["data",["data",["symbol","f"]],["multi",["send",["symbol",":="],["data",["send",["symbol","f"],["value","::check"]],["symbol","f"]]],["symbol","f"]]]]),"___nequal":Embedded$16159(["send",["symbol","->"],["data",["data",["symbol","x"],["symbol","y"]],["send",["symbol","not"],["data",["void"],["send",["symbol","=="],["data",["symbol","x"],["symbol","y"]]]]]]]),"___equal":Embedded$16159(["send",["symbol","->"],["data",["data",["send",["symbol","match"],["symbol","a"]],["symbol","b"]],["multi",["send",["symbol","->"],["data",["send",["symbol","==="],["data",["void"],["symbol","b"]]],["symbol","true"]]],["send",["symbol","->"],["data",["send",["symbol","or"],["data",["send",["symbol","or"],["data",["send",["symbol","or"],["data",["send",["symbol","?"],["data",["symbol","Number"],["void"]]],["send",["symbol","?"],["data",["symbol","String"],["void"]]]]],["send",["symbol","?"],["data",["symbol","null"],["void"]]]]],["send",["symbol","?"],["data",["symbol","undefined"],["void"]]]]],["symbol","false"]]],["send",["symbol","->"],["data",["send",["symbol","?"],["data",["symbol","Array"],["void"]]],["multi",["send",["symbol","if"],["data",["send",["symbol","or"],["data",["send",["symbol","not"],["data",["void"],["send",["symbol","?"],["data",["symbol","Array"],["symbol","b"]]]]],["send",["symbol","!=="],["data",["send",["symbol","a"],["send",["symbol","."],["data",["void"],["symbol","length"]]]],["send",["symbol","b"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]]]],["send",["symbol","return"],["symbol","false"]]]],["send",["symbol","for"],["data",["multi",["send",["symbol","="],["data",["symbol","i"],["value",0]]],["send",["symbol","<"],["data",["symbol","i"],["send",["symbol","a"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]],["send",["symbol","++"],["data",["symbol","i"],["void"]]]],["send",["symbol","if"],["data",["send",["symbol","not"],["data",["void"],["send",["symbol","=="],["data",["send",["symbol","___js_fetch"],["data",["symbol","a"],["symbol","i"]]],["send",["symbol","___js_fetch"],["data",["symbol","b"],["symbol","i"]]]]]]],["send",["symbol","return"],["symbol","false"]]]]]],["symbol","true"]]]],["send",["symbol","->"],["data",["send",["symbol","when"],["data",["void"],["send",["symbol","and"],["data",["send",["symbol","==="],["data",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","getPrototypeOf"]]]],["data",["symbol","a"]]],["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]],["send",["symbol","==="],["data",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","getPrototypeOf"]]]],["data",["symbol","b"]]],["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]]]]]],["multi",["send",["symbol","="],["data",["symbol","ka"],["send",["symbol","keys"],["data",["symbol","a"]]]]],["send",["symbol","if"],["data",["send",["symbol","not"],["data",["void"],["send",["symbol","=="],["data",["send",["send",["symbol","ka"],["send",["symbol","."],["data",["void"],["symbol","sort"]]]],["data"]],["send",["send",["send",["symbol","keys"],["data",["symbol","b"]]],["send",["symbol","."],["data",["void"],["symbol","sort"]]]],["data"]]]]]],["send",["symbol","return"],["symbol","false"]]]],["send",["symbol","each"],["data",["symbol","ka"],["send",["symbol","->"],["data",["symbol","k"],["send",["symbol","if"],["data",["send",["symbol","not"],["data",["void"],["send",["symbol","=="],["data",["send",["symbol","___js_fetch"],["data",["symbol","a"],["symbol","k"]]],["send",["symbol","___js_fetch"],["data",["symbol","b"],["symbol","k"]]]]]]],["send",["symbol","return"],["symbol","false"]]]]]]]],["symbol","true"]]]],["send",["symbol","->"],["data",["data",["send",["symbol","=>"],["data",["value","::serialize"],["symbol","_"]]]],["send",["symbol","match"],["data",["symbol","b"],["multi",["send",["symbol","->"],["data",["data",["send",["symbol","=>"],["data",["value","::serialize"],["symbol","_"]]]],["send",["symbol","=="],["data",["send",["send",["symbol","a"],["value","::serialize"]],["data"]],["send",["send",["symbol","b"],["value","::serialize"]],["data"]]]]]],["send",["symbol","->"],["data",["symbol","otherwise"],["symbol","false"]]]]]]]],["send",["symbol","->"],["data",["symbol","otherwise"],["symbol","false"]]]]]]),"&:":Embedded$16159(["send",["symbol","->"],["data",["data",["symbol","dest"],["symbol","values"]],["multi",["send",["symbol","for"],["data",["send",["symbol","in"],["data",["symbol","k"],["symbol","values"]]],["send",["symbol","if"],["data",["send",["send",["symbol","values"],["send",["symbol","."],["data",["void"],["symbol","hasOwnProperty"]]]],["data",["symbol","k"]]],["send",["symbol",":="],["data",["send",["symbol","dest"],["symbol","k"]],["send",["symbol","___js_fetch"],["data",["symbol","values"],["symbol","k"]]]]]]]]],["symbol","dest"]]]]),"&":Embedded$16159(["send",["symbol","->"],["data",["data",["symbol","a"],["symbol","b"]],["multi",["send",["symbol","="],["data",["symbol","dest"],["send",["symbol","clone"],["data",["symbol","a"]]]]],["send",["symbol","for"],["data",["send",["symbol","in"],["data",["symbol","k"],["symbol","b"]]],["send",["symbol","if"],["data",["send",["send",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","hasOwnProperty"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","b"],["symbol","k"]]],["send",["symbol",":="],["data",["send",["symbol","dest"],["symbol","k"]],["send",["symbol","___js_fetch"],["data",["symbol","b"],["symbol","k"]]]]]]]]],["symbol","dest"]]]]),"&+":Embedded$16159(["send",["symbol","->"],["data",["data",["symbol","a"],["symbol","b"]],["multi",["send",["symbol","="],["data",["symbol","dest"],["send",["symbol","clone"],["data",["symbol","a"]]]]],["send",["symbol","for"],["data",["send",["symbol","in"],["data",["symbol","k"],["symbol","b"]]],["send",["symbol","if"],["data",["send",["send",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","hasOwnProperty"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","b"],["symbol","k"]]],["send",["symbol",":="],["data",["send",["symbol","dest"],["symbol","k"]],["send",["symbol","___js_fetch"],["data",["symbol","b"],["symbol","k"]]]]]]]]],["symbol","dest"]]]]),"|>":Embedded$16159(["send",["symbol","->"],["data",["data",["symbol","f"],["symbol","g"]],["send",["symbol","->"],["data",["data",["symbol","x"]],["send",["symbol","g"],["data",["send",["symbol","f"],["data",["symbol","x"]]]]]]]]]),"clone":Embedded$16159(["send",["symbol","->"],["data",["data",["send",["symbol","match"],["symbol","x"]]],["multi",["send",["symbol","->"],["data",["send",["symbol","or"],["data",["send",["symbol","or"],["data",["send",["symbol","or"],["data",["send",["symbol","?"],["data",["symbol","undefined"],["void"]]],["send",["symbol","?"],["data",["symbol","null"],["void"]]]]],["send",["symbol","?"],["data",["symbol","String"],["void"]]]]],["send",["symbol","?"],["data",["symbol","Number"],["void"]]]]],["symbol","x"]]],["send",["symbol","->"],["data",["data",["send",["symbol","=>"],["data",["value","::clone"],["symbol","_"]]]],["send",["send",["symbol","x"],["value","::clone"]],["data"]]]],["send",["symbol","->"],["data",["send",["symbol","when"],["data",["void"],["send",["symbol","==="],["data",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","getPrototypeOf"]]]],["data",["symbol","x"]]],["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]]]],["multi",["send",["symbol","="],["data",["symbol","dest"],["data",["symbol","="]]]],["send",["symbol","for"],["data",["send",["symbol","in"],["data",["symbol","k"],["symbol","x"]]],["send",["symbol","if"],["data",["send",["send",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","hasOwnProperty"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","x"],["symbol","k"]]],["send",["symbol",":="],["data",["send",["symbol","dest"],["symbol","k"]],["send",["symbol","___js_fetch"],["data",["symbol","x"],["symbol","k"]]]]]]]]],["symbol","dest"]]]],["send",["symbol","->"],["data",["symbol","other"],["send",["symbol","throw"],["send",["send",["symbol","E"],["send",["symbol","."],["data",["void"],["symbol","clone"]]]],["data",["value","Object cannot be cloned"],["data",["send",["symbol","="],["data",["symbol","obj"],["symbol","x"]]]]]]]]]]]]),"___checker":Embedded$16159(["send",["symbol","->"],["data",["data",["symbol","type"]],["multi",["send",["symbol","="],["data",["symbol","f"],["send",["symbol","type"],["value","::check"]]]],["send",["symbol","if"],["data",["send",["symbol","==="],["data",["symbol","f"],["symbol","undefined"]]],["multi",["send",["symbol","then"],["data",["send",["symbol","->"],["data",["data",["symbol","value"]],["send",["symbol","instanceof"],["data",["symbol","value"],["symbol","type"]]]]]]],["send",["symbol","else"],["data",["send",["symbol","->"],["data",["data",["symbol","value"]],["send",["send",["symbol","f"],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","type"],["symbol","value"]]]]]]]]]]]]]),"___projector":Embedded$16159(["send",["symbol","->"],["data",["data",["symbol","type"]],["send",["symbol","->"],["data",["data",["symbol","value"]],["multi",["send",["symbol","="],["data",["symbol","f"],["send",["symbol","type"],["value",":::project"]]]],["send",["symbol","if"],["data",["send",["symbol","==="],["data",["symbol","f"],["symbol","undefined"]]],["multi",["send",["symbol","then"],["data",["multi",["send",["symbol",":="],["data",["symbol","f"],["send",["symbol","type"],["value","::project"]]]],["send",["symbol","if"],["data",["send",["symbol","==="],["data",["symbol","f"],["symbol","undefined"]]],["multi",["send",["symbol","then"],["data",["data",["symbol","true"],["send",["symbol","type"],["data",["symbol","value"]]]]]],["send",["symbol","else"],["data",["send",["symbol","!!"],["data",["data",["symbol","true"],["send",["symbol","f"],["data",["symbol","value"]]]],["send",["symbol","->"],["data",["symbol","e"],["data",["symbol","false"],["symbol","null"]]]]]]]]]]]]]],["send",["symbol","else"],["data",["send",["send",["symbol","f"],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","type"],["symbol","value"]]]]]]]]]]]]]),"___hasprop":Embedded$16159(["send",["symbol","->"],["data",["data",["symbol","match"],["symbol","key"]],["multi",["send",["symbol","->"],["data",["send",["symbol","or"],["data",["send",["symbol","?"],["data",["symbol","null"],["void"]]],["send",["symbol","?"],["data",["symbol","undefined"],["void"]]]]],["symbol","false"]]],["send",["symbol","->"],["data",["send",["symbol","?"],["data",["symbol","String"],["symbol","x"]]],["send",["symbol","in"],["data",["symbol","key"],["send",["symbol","String"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]]]],["send",["symbol","->"],["data",["send",["symbol","?"],["data",["symbol","Number"],["symbol","x"]]],["send",["symbol","in"],["data",["symbol","key"],["send",["symbol","Number"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]]]],["send",["symbol","->"],["data",["symbol","x"],["send",["symbol","in"],["data",["symbol","key"],["symbol","x"]]]]]]]]),"range":Embedded$16159(["send",["symbol","->"],["data",["data",["symbol","from"],["symbol","to"]],["multi",["send",["symbol","="],["data",["symbol","rval"],["data"]]],["send",["symbol","for"],["data",["multi",["send",["symbol","="],["data",["symbol","i"],["symbol","from"]]],["send",["symbol","<="],["data",["symbol","i"],["symbol","to"]]],["send",["symbol","++"],["data",["symbol","i"],["void"]]]],["send",["send",["symbol","rval"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",["symbol","i"]]]]],["symbol","rval"]]]]),"___serialize_ast":Embedded$16159(["send",["symbol","->"],["data",["data",["symbol","match"]],["multi",["send",["symbol","->"],["data",["send",["symbol","or"],["data",["send",["symbol","?"],["data",["symbol","String"],["symbol","x"]]],["send",["symbol","?"],["data",["symbol","Number"],["symbol","x"]]]]],["send",["send",["symbol","#"],["data",["void"],["symbol","value"]]],["data",["symbol","x"]]]]],["send",["symbol","->"],["data",["symbol","other"],["send",["send",["symbol","other"],["value","::serialize_ast"]],["data"]]]]]]]),"___match_error":Embedded$16159(["send",["symbol","->"],["data",["data",["symbol","value"],["symbol","url"],["symbol","start"],["symbol","end"]],["multi",["send",["symbol","="],["data",["symbol","err"],["send",["send",["symbol","E"],["send",["symbol","."],["data",["void"],["symbol","match"]]]],["data",["value","Could not find a match for value"],["data",["send",["symbol","="],["data",["symbol","value"],["symbol","value"]]]]]]]],["send",["symbol","if"],["data",["symbol","url"],["send",["symbol",":="],["data",["send",["symbol","err"],["send",["symbol","."],["data",["void"],["symbol","location"]]]],["send",["send",["symbol","#"],["data",["void"],["symbol","location"]]],["data",["symbol","url"],["symbol","start"],["symbol","end"]]]]]]],["send",["symbol","throw"],["symbol","err"]]]]]),"ErrorFactory":Embedded$16159(["send",["symbol","class"],["data",["multi",["send",["symbol","="],["data",["send",["symbol","constructor"],["data",["symbol","tags"]]],["send",["symbol",":="],["data",["send",["symbol","@"],["data",["void"],["symbol","tags"]]],["symbol","tags"]]]]],["send",["symbol","="],["data",["send",["symbol","create"],["data",["send",["symbol","="],["data",["symbol","message"],["value",""]]],["send",["symbol","*"],["data",["void"],["symbol","args"]]]]],["multi",["send",["symbol","="],["data",["symbol","e"],["send",["symbol","Error"],["data",["symbol","message"]]]]],["send",["symbol",":="],["data",["send",["symbol","e"],["value","::tags"]],["send",["symbol","@"],["data",["void"],["symbol","tags"]]]]],["send",["symbol",":="],["data",["send",["symbol","e"],["send",["symbol","."],["data",["void"],["symbol","args"]]]],["symbol","args"]]],["send",["symbol","each"],["data",["send",["symbol","enumerate"],["data",["symbol","args"]]],["send",["symbol","->"],["data",["data",["symbol","i"],["symbol","arg"]],["send",["symbol",":="],["data",["send",["symbol","e"],["symbol","i"]],["symbol","arg"]]]]]]],["send",["symbol",":="],["data",["send",["symbol","e"],["send",["symbol","."],["data",["void"],["symbol","length"]]]],["send",["symbol","args"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]],["send",["symbol",":="],["data",["send",["symbol","e"],["send",["symbol","."],["data",["void"],["symbol","name"]]]],["send",["send",["send",["symbol","++"],["data",["data",["send",["symbol","."],["data",["void"],["symbol","E"]]]],["send",["symbol","@"],["data",["void"],["symbol","tags"]]]]],["send",["symbol","."],["data",["void"],["symbol","join"]]]],["data",["value","."]]]]],["symbol","e"]]]],["send",["symbol","="],["data",["send",["value","::check"],["data",["symbol","e"]]],["multi",["send",["symbol","if"],["data",["send",["symbol","or"],["data",["send",["symbol","not"],["data",["void"],["symbol","e"]]],["send",["symbol","not"],["data",["void"],["send",["symbol","?"],["data",["symbol","Error"],["symbol","e"]]]]]]],["send",["symbol","return"],["symbol","false"]]]],["send",["symbol","="],["data",["symbol","tags"],["send",["symbol","or"],["data",["send",["symbol","e"],["value","::tags"]],["data"]]]]],["send",["symbol","each?"],["data",["send",["symbol","@"],["data",["void"],["symbol","tags"]]],["send",["symbol","->"],["data",["send",["symbol","when"],["data",["symbol","tag"],["send",["symbol","==="],["data",["send",["send",["symbol","tags"],["send",["symbol","."],["data",["void"],["symbol","indexOf"]]]],["data",["symbol","tag"]]],["send",["symbol","-"],["data",["void"],["value",1]]]]]]],["send",["symbol","return"],["symbol","false"]]]]]],["symbol","true"]]]],["send",["symbol","="],["data",["send",["value","::deconstruct"],["data",["symbol","e"]]],["send",["symbol","e"],["send",["symbol","."],["data",["void"],["symbol","args"]]]]]]]]]),"Node":Embedded$16159(["send",["symbol","class"],["data",["multi",["send",["symbol","static"],["data",["multi",["send",["symbol","="],["data",["send",["value","::check"],["data",["symbol","x"]]],["send",["symbol","and"],["data",["send",["symbol","and"],["data",["symbol","x"],["send",["symbol","x"],["send",["symbol","."],["data",["void"],["symbol","classes"]]]]]],["send",["symbol","x"],["send",["symbol","."],["data",["void"],["symbol","children"]]]]]]]],["send",["symbol","="],["data",["send",["value","::deconstruct"],["data",["symbol","x"]]],["data",["send",["symbol","x"],["send",["symbol","."],["data",["void"],["symbol","classes"]]]],["send",["symbol","x"],["send",["symbol","."],["data",["void"],["symbol","children"]]]]]]]]]],["send",["symbol","="],["data",["send",["symbol","constructor"],["data",["send",["symbol","!"],["data",["symbol","Array"],["symbol","classes"]]],["send",["symbol","!"],["data",["symbol","Array"],["symbol","children"]]]]],["multi",["send",["symbol",":="],["data",["send",["symbol","@"],["data",["void"],["symbol","classes"]]],["send",["send",["symbol","classes"],["send",["symbol","."],["data",["void"],["symbol","sort"]]]],["data"]]]],["send",["symbol",":="],["data",["send",["symbol","@"],["data",["void"],["symbol","children"]]],["symbol","children"]]]]]],["send",["symbol","="],["data",["send",["value","::check"],["data",["symbol","n"]]],["multi",["send",["symbol","each?"],["data",["send",["symbol","@"],["data",["void"],["symbol","classes"]]],["send",["symbol","->"],["data",["send",["symbol","when"],["data",["symbol","c"],["send",["symbol","==="],["data",["send",["send",["send",["symbol","n"],["send",["symbol","."],["data",["void"],["symbol","classes"]]]],["send",["symbol","."],["data",["void"],["symbol","indexOf"]]]],["data",["symbol","c"]]],["send",["symbol","-"],["data",["void"],["value",1]]]]]]],["send",["symbol","return"],["symbol","false"]]]]]],["symbol","true"]]]]]]])})));;($length$22669=temp$22664.length);;($index$22674=0);;$16195:for(;($index$22674<$length$22669);($index$22674++)){var k$22692;var v$22693;var t0$22687;var t1$22688;var m$22682;(m$22682=temp$22664[$index$22674]);;(t0$22687=m$22682);if(((t0$22687 instanceof Array)&&((t1$22688=t0$22687.length),(t1$22688===2)))){(k$22692=t0$22687[0]);(v$22693=t0$22687[1]);stdenv$16160.bind(topscope$16164,k$22692,["value",v$22693]);}else{$22932(m$22682,"/home/olivier/git/earl-grey/src/stdenv.eg",35706,35772);;}}(stdprelude$16190=Embedded$16159(["multi",["send",["symbol","="],["data",["send",["symbol","send"],["data",["symbol","obj"],["send",["symbol","match"],["symbol","msg"]]]],["multi",["send",["symbol","->"],["data",["send",["symbol","or"],["data",["send",["symbol","?"],["data",["symbol","String"],["void"]]],["send",["symbol","?"],["data",["symbol","Number"],["void"]]]]],["send",["symbol","___js_fetch"],["data",["symbol","obj"],["symbol","msg"]]]]],["send",["symbol","->"],["data",["symbol","other"],["send",["send",["symbol","obj"],["value","::send"]],["data",["symbol","msg"]]]]]]]],["send",["symbol",":="],["data",["send",["symbol","Array"],["value",":::project"]],["send",["symbol","->"],["data",["data",["send",["symbol","match"],["symbol","value"]]],["multi",["send",["symbol","->"],["data",["send",["symbol","?"],["data",["symbol","Array"],["void"]]],["data",["symbol","true"],["symbol","value"]]]],["send",["symbol","->"],["data",["symbol","_"],["data",["symbol","true"],["data",["symbol","value"]]]]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value","::check"]],["send",["symbol","->"],["data",["data",["symbol","value"]],["send",["symbol","if"],["data",["send",["symbol","instanceof"],["data",["symbol","value"],["symbol","Array"]]],["multi",["send",["symbol","then"],["data",["multi",["send",["symbol","for"],["data",["multi",["send",["symbol","="],["data",["symbol","i"],["value",0]]],["send",["symbol","<"],["data",["symbol","i"],["send",["symbol","this"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]],["send",["symbol","++"],["data",["symbol","i"],["void"]]]],["send",["symbol","if"],["data",["send",["symbol","!=="],["data",["send",["symbol","this"],["symbol","i"]],["send",["symbol","value"],["symbol","i"]]]],["send",["symbol","return"],["symbol","false"]]]]]],["symbol","true"]]]],["send",["symbol","else"],["data",["symbol","false"]]]]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value","::clone"]],["send",["symbol","->"],["data",["data"],["send",["symbol","&:"],["data",["send",["send",["symbol","this"],["send",["symbol","."],["data",["void"],["symbol","slice"]]]],["data",["value",0]]],["symbol","this"]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value",":::project"]],["send",["symbol","->"],["data",["data",["symbol","value"]],["send",["symbol","if"],["data",["send",["symbol","instanceof"],["data",["symbol","value"],["symbol","Array"]]],["multi",["send",["symbol","then"],["data",["multi",["send",["symbol","for"],["data",["multi",["send",["symbol","="],["data",["symbol","i"],["value",0]]],["send",["symbol","<"],["data",["symbol","i"],["send",["symbol","this"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]],["send",["symbol","++"],["data",["symbol","i"],["void"]]]],["send",["symbol","if"],["data",["send",["symbol","!=="],["data",["send",["symbol","this"],["symbol","i"]],["send",["symbol","value"],["symbol","i"]]]],["send",["symbol","return"],["data",["symbol","true"],["data",["symbol","value"]]]]]]]],["data",["symbol","true"],["send",["send",["symbol","value"],["send",["symbol","."],["data",["void"],["symbol","slice"]]]],["data",["send",["symbol","this"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]]]]]],["send",["symbol","else"],["data",["data",["symbol","true"],["data",["symbol","value"]]]]]]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value","::serialize_ast"]],["send",["symbol","->"],["data",["data"],["send",["send",["symbol","#"],["data",["void"],["symbol","array"]]],["data",["send",["symbol","*"],["data",["void"],["send",["send",["symbol","this"],["send",["symbol","."],["data",["void"],["symbol","map"]]]],["data",["symbol","___serialize_ast"]]]]]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","RegExp"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value","::check"]],["send",["symbol","->"],["data",["data",["symbol","match"]],["multi",["send",["symbol","->"],["data",["send",["symbol","?"],["data",["symbol","String"],["symbol","value"]]],["send",["symbol","if"],["data",["send",["send",["symbol","value"],["send",["symbol","."],["data",["void"],["symbol","match"]]]],["data",["symbol","this"]]],["symbol","true"],["symbol","false"]]]]],["send",["symbol","->"],["data",["symbol","other"],["symbol","false"]]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","RegExp"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value",":::project"]],["send",["symbol","->"],["data",["data",["symbol","match"]],["multi",["send",["symbol","->"],["data",["send",["symbol","?"],["data",["symbol","String"],["symbol","value"]]],["send",["symbol","match"],["data",["send",["send",["symbol","value"],["send",["symbol","."],["data",["void"],["symbol","match"]]]],["data",["symbol","this"]]],["multi",["send",["symbol","->"],["data",["send",["symbol","?"],["data",["symbol","null"],["symbol","m"]]],["data",["symbol","false"],["symbol","null"]]]],["send",["symbol","->"],["data",["symbol","m"],["data",["symbol","true"],["symbol","m"]]]]]]]]],["send",["symbol","->"],["data",["symbol","other"],["data",["symbol","false"],["symbol","null"]]]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","Function"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value","::send"]],["send",["symbol","->"],["data",["data",["symbol","args"]],["send",["send",["symbol","this"],["send",["symbol","."],["data",["void"],["symbol","apply"]]]],["data",["symbol","this"],["symbol","args"]]]]]]]]));;(expander$16162["utils"]=({"var_operator":var_operator$16175}));(exports["topscope"]=topscope$16164);(exports["stdenv"]=stdenv$16160);(exports["expander"]=expander$16162);(exports["expand"]=expand$16163);(exports["stdprelude"]=stdprelude$16190);

},{"./expand":5,"./location":7,"./pattern":10,"./pp":11,"./util":14}],13:[function(require,module,exports){
var $23269=function(type$23271){var f$23274;(f$23274=type$23271["::check"]);;if((f$23274===(void 0))){return function(value$23279){return (value$23279 instanceof type$23271);};}else{return function(value$23282){return f$23274.call(type$23271,value$23282);};}};
var $23284=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $23285=function(dest$23287,values$23288){var k$23293;(k$23293=null);$23291:for(k$23293 in values$23288){if(values$23288.hasOwnProperty(k$23293)){(dest$23287[k$23293]=values$23288[k$23293]);}}return dest$23287;};
var $23297=function($23298$23300){var ph$23304;(ph$23304=$23298$23300);;var $23302$23309;($23302$23309=ph$23304);;var bridge$23303$23314;var x$23318;(bridge$23303$23314=$23302$23309);if((((typeof(bridge$23303$23314)==="string")&&((x$23318=bridge$23303$23314),true))||((typeof(bridge$23303$23314)==="number")&&((x$23318=bridge$23303$23314),true)))){return ["value",x$23318];}else{var other$23325;(other$23325=$23302$23309);return other$23325["::serialize_ast"]();}};
var send$23109;(send$23109=function(obj$23114,$23112$23115){var ph$23119;var msg$23120;var t0$23122;(t0$23122=$23112$23115);(msg$23120=t0$23122);(ph$23119=t0$23122);;var $23117$23126;($23117$23126=ph$23119);;var bridge$23118$23131;(bridge$23118$23131=$23117$23126);if(((typeof(bridge$23118$23131)==="string")||(typeof(bridge$23118$23131)==="number"))){return obj$23114[msg$23120];}else{var other$23139;(other$23139=$23117$23126);return obj$23114["::send"](msg$23120);}});;(Array[":::project"]=function($23142$23144){var ph$23147;var value$23148;var t0$23150;(t0$23150=$23142$23144);(value$23148=t0$23150);(ph$23147=t0$23150);;var $23146$23154;($23146$23154=ph$23147);;if($23269(Array)($23146$23154)){return [true,value$23148];}else{$23146$23154;return [true,[value$23148]];}});(Array.prototype["::check"]=function(value$23168){if((value$23168 instanceof Array)){var i$23173;(i$23173=0);;$23171:for(;(i$23173<this.length);(i$23173++)){if(($23284(this,i$23173)!==$23284(value$23168,i$23173))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $23285(this.slice(0),this);});(Array.prototype[":::project"]=function(value$23184){if((value$23184 instanceof Array)){var i$23189;(i$23189=0);;$23187:for(;(i$23189<this.length);(i$23189++)){if(($23284(this,i$23189)!==$23284(value$23184,i$23189))){return [true,[value$23184]];}}return [true,value$23184.slice(this.length)];}else{return [true,[value$23184]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($23297));});(RegExp.prototype["::check"]=function($23199$23201){var ph$23204;(ph$23204=$23199$23201);;var $23203$23209;($23203$23209=ph$23204);;var value$23217;if((typeof($23203$23209)==="string")){(value$23217=$23203$23209);if(value$23217.match(this)){return true;}else{return false;}}else{var other$23222;(other$23222=$23203$23209);return false;}});(RegExp.prototype[":::project"]=function($23224$23226){var ph$23229;(ph$23229=$23224$23226);;var $23228$23234;($23228$23234=ph$23229);;var value$23242;if((typeof($23228$23234)==="string")){(value$23242=$23228$23234);var $23245$23247;($23245$23247=value$23242.match(this));;var m$23255;if(($23245$23247===null)){(m$23255=$23245$23247);return [false,null];}else{var m$23260;(m$23260=$23245$23247);return [true,m$23260];}}else{var other$23264;(other$23264=$23228$23234);return [false,null];}});(Function.prototype["::send"]=function(args$23267){return this.apply(this,args$23267);});
var $25037=function(arr$25039){var results$25043;var l$25044;(results$25043=[]);;(l$25044=arr$25039.length);;var i$25052;(i$25052=0);;$25042:for(;(i$25052<l$25044);(i$25052++)){results$25043.push([i$25052,$23284(arr$25039,i$25052)]);}return results$25043;};
var $24868=function(){var $24869$24871;($24869$24871=function(tags$24875){var it$0$24878;(it$0$24878=function(){if((!$23269($24869$24871)(this))){return Object.create($24869$24871.prototype);}else{return this;}}());;(it$0$24878["tags"]=tags$24875);return it$0$24878;});;($24869$24871.prototype["create"]=function(){var $24887$24889;($24887$24889=arguments);;var t0$24894;var message$24898;var args$24899;(t0$24894=$24887$24889.length);if((t0$24894>=0)){(message$24898=function(){if((0>=t0$24894)){return "";}else{return $24887$24889[0];}}());(args$24899=Array.prototype.slice.call($24887$24889,1));var it$0$24903;(it$0$24903=this);;var self$24908;(self$24908=this);;var e$24913;(e$24913=Error(message$24898));;(e$24913["::tags"]=it$0$24903.tags);(e$24913["args"]=args$24899);var temp$24921;(temp$24921=$25037(args$24899));;var $length$24926;($length$24926=temp$24921.length);;var $index$24931;($index$24931=0);;$24914:for(;($index$24931<$length$24926);($index$24931++)){var m$24939;(m$24939=temp$24921[$index$24931]);;var t0$24944;var t1$24945;var i$24949;var arg$24950;(t0$24944=m$24939);if(((t0$24944 instanceof Array)&&((t1$24945=t0$24944.length),(t1$24945===2)))){(i$24949=t0$24944[0]);(arg$24950=t0$24944[1]);(e$24913[i$24949]=arg$24950);}else{$24855(m$24939);;}}(e$24913["length"]=args$24899.length);(e$24913["name"]=["E"].concat(it$0$24903.tags).join("."));return e$24913;}else{$24855($24887$24889);}});($24869$24871.prototype["::check"]=function(e$24961){var it$0$24964;(it$0$24964=this);;var self$24969;(self$24969=this);;var tags$24974;if(((!e$24961)||(!$23269(Error)(e$24961)))){return false;}(tags$24974=(e$24961["::tags"]||[]));;var temp$24983;(temp$24983=it$0$24964.tags);;var $length$24988;($length$24988=temp$24983.length);;var $index$24993;($index$24993=0);;$24975:for(;($index$24993<$length$24988);($index$24993++)){var m$25001;(m$25001=temp$24983[$index$24993]);;var tag$25009;(tag$25009=m$25001);if((tags$24974.indexOf(tag$25009)===-1)){return false;}else{false;;}}return true;});($24869$24871.prototype["::deconstruct"]=function(e$25017){var it$0$25020;(it$0$25020=this);;var self$25025;(self$25025=this);;return e$25017.args;});$23285($24869$24871,$23285(function(){var accum$25030;(accum$25030=({}));(accum$25030["::name"]="$24869");return accum$25030;}(),function(){var accum$25034;(accum$25034=({}));(accum$25034["::egclass"]=true);return accum$25034;}()));return $24869$24871;}();
var $24855=function(value$24857,url$24858,start$24859,end$24860){var err$24863;(err$24863=$24868(["match"]).create("Could not find a match for value",({"value":value$24857})));;if(url$24858){(err$24863["location"]=["location",url$24858,start$24859,end$24860]);}throw err$24863;};
var $25059=function(type$25061){return function(value$25064){var f$25067;(f$25067=type$25061[":::project"]);;if((f$25067===(void 0))){(f$25067=type$25061["::project"]);if((f$25067===(void 0))){return [true,type$25061(value$25064)];}else{var rval$25073;(rval$25073=false);;try{(rval$25073=[true,f$25067(value$25064)]);}catch(excv$25079){var e$25085;(e$25085=excv$25079);(rval$25073=[false,null]);}return rval$25073;}}else{return f$25067.call(type$25061,value$25064);}};};
var $25087=function($25088$25090,key$25091){var ph$25095;(ph$25095=$25088$25090);;var $25093$25100;($25093$25100=ph$25095);;var bridge$25094$25105;(bridge$25094$25105=$25093$25100);if(((bridge$25094$25105===null)||(bridge$25094$25105===(void 0)))){return false;}else{var x$25113;if((typeof($25093$25100)==="string")){(x$25113=$25093$25100);return (key$25091 in String.prototype);}else{var x$25118;if((typeof($25093$25100)==="number")){(x$25118=$25093$25100);return (key$25091 in Number.prototype);}else{var x$25123;(x$25123=$25093$25100);return (key$25091 in x$25123);}}}};var accum$24831;var accum$24835;var $23329$23331;var gensym$23332;var $23330$23333;var __lt____gt__$23334;var js_op_table2$23335;var js_op_table$23336;var Translator$23337;var translate$23338;($23329$23331=require("./util"));;(gensym$23332=$23329$23331.gensym);;($23330$23333=require("./pp"));;(__lt____gt__$23334=$23330$23333["<>"]);;(js_op_table2$23335=({"+":"+","-":"-","*":"*","/":"/","mod":"%","&.":"&","|.":"|","^.":"^","~":"~","and":"&&","or":"||","not":"!","==":"===","!=":"!==","===":"===","!==":"!==","<":"<",">":">","<=":"<=",">=":">=","<<":"<<",">>":">>",">>>":">>>","in":" in ","instanceof":" instanceof ","++":"++","--":"--"}));;(js_op_table$23336=({"___plus":"+","___minus":"-","___times":"*","___div":"/","___mod":"%","___binxor":"^","___binand":"&","___binor":"|","___binnot":"~","___and":"&&","___or":"||","___not":"!","___is":"===","___isnt":"!==","___eq":"===","___neq":"!==","___lt":"<","___gt":">","___lte":"<=","___gte":">=","___shl":"<<","___shr":">>","___shr2":">>>","___in":" in ","___instanceof":" instanceof ","___plusplus":"++","___minusminus":"--"}));;(Translator$23337=function(){var it$0$23375;var prelude$23371;var t0$23367;var $23360$23362;($23360$23362=arguments);;(t0$23367=$23360$23362.length);if(((t0$23367>=0)&&(t0$23367<=1))){(prelude$23371=function(){if((0>=t0$23367)){return null;}else{return $23360$23362[0];}}());(it$0$23375=function(){if((!$23269(Translator$23337)(this))){return Object.create(Translator$23337.prototype);}else{return this;}}());;(it$0$23375["cache"]=({}));(it$0$23375["prepend"]=[]);if(prelude$23371){it$0$23375.prepend.push(it$0$23375.translate($23297(prelude$23371),"stmt"));}return it$0$23375;}else{$24855($23360$23362);}});;(Translator$23337.prototype["register_value"]=function(v$23388,id$23389){var temp$23414;var name$23420;var $23397$23403;var self$23398;var it$0$23392;(it$0$23392=this);;(self$23398=this);;($23397$23403=$23284(it$0$23392.cache,id$23389));;if(($23397$23403===(void 0))){(temp$23414=["symbol",gensym$23332()]);;(it$0$23392.cache[id$23389]=temp$23414);it$0$23392.prepend.push(it$0$23392.translate(["declare",temp$23414,$23297(v$23388)],"stmt"));return temp$23414;}else{(name$23420=$23397$23403);return name$23420;}});(Translator$23337.prototype["register_raw"]=function(raw$23425,id$23426){var temp$23451;var name$23457;var $23434$23440;var self$23435;var it$0$23429;(it$0$23429=this);;(self$23435=this);;($23434$23440=$23284(it$0$23429.cache,id$23426));;if(($23434$23440===(void 0))){(temp$23451=["symbol",gensym$23332()]);;(it$0$23429.cache[id$23426]=temp$23451);it$0$23429.prepend.push(it$0$23429.translate(["declare",temp$23451,["raw",raw$23425]],"stmt"));return temp$23451;}else{(name$23457=$23434$23440);return name$23457;}});(Translator$23337.prototype["dump_store"]=function(){var rval$23474;var self$23469;var it$0$23464;(it$0$23464=this);;(self$23469=this);;(rval$23474=it$0$23464.prepend.join("\n"));;(it$0$23464["prepend"]=[]);return rval$23474;});(Translator$23337.prototype["mangle"]=function(name$23481){var i$23504;var tr$23495;var r$23496;var self$23489;var it$0$23484;(it$0$23484=this);;(self$23489=this);;(tr$23495=({"+":"__plus__","-":"__minus__","*":"__asterisk__","/":"__slash__","%":"__percent__","^":"__caret__","#":"__hash__","&":"__amp__","|":"__pipe__","@":"__at__","!":"__bang__","?":"__qmark__","=":"__equal__","<":"__lt__",">":"__gt__","~":"__tilde__",".":"__dot__",":":"__colon__"}));;(r$23496=[]);;(i$23504=0);;$23494:for(;(i$23504<name$23481.length);(++i$23504)){var c$23512;(c$23512=$23284(name$23481,i$23504));;r$23496.push(($23284(tr$23495,c$23512)||c$23512));}return r$23496.join("");});(Translator$23337.prototype["body"]=function(orig$23519,mode$23520){var t0$23537;var t1$23538;var t2$23539;var x$23563;var stmts$23572;var ret$23573;var other$23586;var $23533$23552;var b$23534;var trst$23535;var self$23528;var it$0$23523;(it$0$23523=this);;(self$23528=this);;(t0$23537=$25059(["multi"])(orig$23519));if((t0$23537[0]&&((t1$23538=t0$23537[1]),((t2$23539=t1$23538.length),(t2$23539>=0))))){(b$23534=Array.prototype.slice.call(t1$23538,0));;}else{$24855(orig$23519,"/home/olivier/git/earl-grey/src/translate-js.eg",3258,3262);}(trst$23535=function(stmt$23548){return it$0$23523.translate(stmt$23548,"stmt");});;($23533$23552=mode$23520);;if(($23533$23552==="expr")){(x$23563=["send",["lambda",[],orig$23519],["array"]]);;return it$0$23523.translate(x$23563,mode$23520);}else{if(($23533$23552==="return")){(stmts$23572=b$23534.slice(0,-1));;(ret$23573=$23284(b$23534,(b$23534.length-1)));;return (stmts$23572.map(trst$23535).join("")+it$0$23523.translate(ret$23573,"return"));}else{if(($23533$23552==="stmt")){return b$23534.map(trst$23535).join("");}else{(other$23586=$23533$23552);throw $24868(["syntax","mode"]).create("Unknown mode",({"mode":mode$23520}));}}}});(Translator$23337.prototype["expr"]=function(x$23591,mode$23592){var other$23626;var $23600$23606;var self$23601;var it$0$23595;(it$0$23595=this);;(self$23601=this);;($23600$23606=mode$23592);;if(($23600$23606==="expr")){return x$23591;}else{if(($23600$23606==="stmt")){return (x$23591+";");}else{if(($23600$23606==="return")){return (("return "+x$23591)+";");}else{(other$23626=$23600$23606);throw "OopsI";}}}});(Translator$23337.prototype["op"]=function(op$23631,a$23632,b$23633){var $23650$23663;var $23651$23664;var $23652$23665;var t0$23659;var t1$23660;var t2$23661;var $23649$23654;var e$23646;var self$23641;var it$0$23636;(it$0$23636=this);;(self$23641=this);;(e$23646=((($23649$23654=[a$23632,b$23633])),function(){if((($23650$23663=($23649$23654 instanceof Array))&&((t0$23659=$23649$23654.length),(($23652$23665=(t0$23659===2))&&((t1$23660=$23649$23654[0]),((t1$23660 instanceof Array)&&((t2$23661=t1$23660.length),((t2$23661===1)&&(t1$23660[0]==="void"))))))))){$23649$23654[1];return (op$23631+it$0$23636.translate(b$23633,"expr"));}else{if(($23652$23665&&($23649$23654[0],((t1$23660=$23649$23654[1]),((t1$23660 instanceof Array)&&((t2$23661=t1$23660.length),((t2$23661===1)&&(t1$23660[0]==="void")))))))){return (it$0$23636.translate(a$23632,"expr")+op$23631);}else{$23649$23654;return ((it$0$23636.translate(a$23632,"expr")+op$23631)+it$0$23636.translate(b$23633,"expr"));}}}()));;return (("("+e$23646)+")");});(Translator$23337.prototype["translate"]=function(expr$23687,mode$23688){var repl$23763;var it$0$23794;var it$0$23789;var it$0$23784;var it$0$23779;var bridge$23749$23805;var bridge$23748$23802;var other$23816;var id$23810;var bridge$23747$23756;var $23746$23751;var r$23743;var t0$23835;var t0$23838;var trf$23844;var trmsg$23845;var trf$23876;var trmsg$23877;var trf$23889;var trmsg$23890;var otherwise$23886;var $23863$23865;var x$23933;var x$23927;var $23911$23922;var $23912$23923;var $23913$23924;var t0$23920;var $23910$23915;var $index$23966;var $length$23961;var temp$23956;var acc$23951;var trf$23941;var trargs$23942;var op$23907;var code$23998;var code$24006;var t0$23994;var t1$23995;var trf$24011;var trmsg$24012;var codevar$23992;var f$24029;var r$24025;var f$24083;var f$24115;var v$24110;var all_strings$24043;var r$24044;var $index$24175;var $length$24170;var temp$24165;var acc$24160;var a$24149;var b$24150;var a$24224;var b$24225;var other$24221;var $24207$24209;var a$24256;var b$24257;var c$24258;var other$24253;var $24239$24241;var a$24295;var other$24292;var bridge$24277$24284;var $24276$24279;var a$24324;var b$24325;var other$24321;var bridge$24306$24313;var $24305$24308;var a$24342;var b$24343;var c$24344;var a$24361;var b$24362;var $index$24451;var $length$24446;var temp$24441;var acc$24436;var $index$24488;var $length$24483;var temp$24478;var acc$24473;var xs$24430;var $24380$24420;var $24379$24414;var isdecl$24381;var $index$24550;var $length$24545;var temp$24540;var acc$24535;var decls$24529;var f$24579;var r$24575;var other$24662;var $24648$24650;var a$24687;var b$24688;var other$24684;var $24670$24672;var a$24720;var b$24721;var c$24722;var d$24723;var other$24717;var $24703$24705;var a$24760;var b$24761;var c$24762;var other$24757;var $24743$24745;var t0$24785;var t0$24789;var a$24813;var b$24814;var other$24810;var $24796$24798;var other$24828;var x$24823;var attempt$24774;var v$24775;var body$24776;var x$24738;var y$24739;var body$24740;var x$24697;var y$24698;var z$24699;var body$24700;var test$24666;var body$24667;var label$24642;var body$24643;var value$24637;var value$24632;var value$24627;var label$24620;var label$24613;var value$24608;var args$24571;var vars$24524;var body$24525;var s$24519;var args$24514;var args$24375;var lhs$24356;var rhs$24357;var obj$24334;var msg$24335;var rhs$24336;var binding$24301;var value$24302;var binding$24270;var test$24234;var pos$24235;var neg$24236;var test$24199;var pos$24200;var bindings$24144;var body$24145;var args$24039;var args$24021;var f$23987;var msg$23988;var f$23899;var args$23900;var f$23854;var msg$23855;var s$23856;var f$23830;var msg$23831;var f$23821;var v$23739;var s$23729;var $23699$23723;var $23700$23724;var $23701$23725;var $23702$23726;var t0$23713;var t1$23714;var t2$23715;var t3$23716;var t4$23717;var bridge$23697$23718;var bridge$23698$23719;var t5$23720;var t6$23721;var $23696$23708;var self$23703;var it$0$23691;(it$0$23691=this);;(self$23703=this);;($23696$23708=expr$23687);;if((($23699$23723=($23696$23708 instanceof Array))&&((t0$23713=$23696$23708.length),((t0$23713===2)&&($23696$23708[0]==="symbol"))))){(s$23729=$23696$23708[1]);return it$0$23691.expr(it$0$23691.mangle(s$23729),mode$23688);}else{if(($23699$23723&&((t0$23713===1)&&($23696$23708[0]==="void")))){return it$0$23691.expr("null",mode$23688);}else{if(($23699$23723&&((t0$23713===2)&&($23696$23708[0]==="value")))){(v$23739=$23696$23708[1]);(r$23743=((($23746$23751=v$23739)),function(){if((typeof($23746$23751)==="string")){(repl$23763=({"\"":"\\\"","\n":"\\n","\\":"\\\\"}));;(v$23739=v$23739.replace(RegExp("((?:(?:\"|\\\\)|\n))","g"),function(m$23768){return $23284(repl$23763,m$23768);}));return (("\""+v$23739)+"\"");}else{if(($23746$23751===(void 0))){return "(void 0)";}else{if($23269(RegExp)($23746$23751)){(it$0$23779=String(v$23739));;(it$0$23784=it$0$23779.slice(1,-1));;(it$0$23789=it$0$23784.replace(RegExp("/","g"),"\\/"));;(it$0$23794=it$0$23789.replace(RegExp("\n","g"),"\\n"));;return "/".concat(it$0$23794).concat("/");}else{(bridge$23747$23756=$23746$23751);if((((bridge$23748$23802=bridge$23747$23756),(((bridge$23749$23805=bridge$23748$23802),((typeof(bridge$23749$23805)==="number")||(bridge$23749$23805===true)))||(bridge$23748$23802===false)))||(bridge$23747$23756===null))){return String(v$23739);}else{if(($25087($23746$23751,"::id")&&((id$23810=$23746$23751["::id"]),id$23810))){return it$0$23691.translate(it$0$23691.register_value(v$23739,id$23810),mode$23688);}else{(other$23816=$23746$23751);throw $24868(["cannot_serialize"]).create("Cannot serialize value",({"value":v$23739}));}}}}}}()));;return it$0$23691.expr(r$23743,mode$23688);}else{if(($23699$23723&&(($23701$23725=(t0$23713===3))&&(($23702$23726=($23696$23708[0]==="send"))&&((t1$23714=$23696$23708[1]),((t1$23714 instanceof Array)&&((t2$23715=t1$23714.length),((t2$23715===2)&&((t1$23714[0]==="variable")&&((t1$23714[1]==="___node")&&((t3$23716=$23696$23708[2]),((t3$23716 instanceof Array)&&((t4$23717=t3$23716.length),((t4$23717===2)&&(t3$23716[0]==="value"))))))))))))))){(f$23821=t3$23716[1]);return f$23821;}else{if(($23702$23726&&((bridge$23697$23718=$23696$23708[1]),((((bridge$23697$23718 instanceof Array)&&((t0$23835=bridge$23697$23718.length),((t0$23835===2)&&((bridge$23697$23718[0]==="symbol")&&(bridge$23697$23718[1]==="___js_fetch")))))||((bridge$23697$23718 instanceof Array)&&((t0$23838=bridge$23697$23718.length),((t0$23838===2)&&((bridge$23697$23718[0]==="variable")&&(bridge$23697$23718[1]==="___js_fetch"))))))&&((t1$23714=$23696$23708[2]),((t1$23714 instanceof Array)&&((t2$23715=t1$23714.length),((t2$23715===3)&&(t1$23714[0]==="array"))))))))){(f$23830=t1$23714[1]);(msg$23831=t1$23714[2]);(trf$23844=it$0$23691.translate(f$23830,"expr"));;(trmsg$23845=it$0$23691.translate(msg$23831,"expr"));;return it$0$23691.expr((((trf$23844+"[")+trmsg$23845)+"]"),mode$23688);}else{if(($23702$23726&&((f$23854=$23696$23708[1]),((t1$23714=$23696$23708[2]),((msg$23855=t1$23714),((t1$23714 instanceof Array)&&((t2$23715=t1$23714.length),((t2$23715===2)&&(t1$23714[0]==="value"))))))))){(s$23856=t1$23714[1]);($23863$23865=null);;$23863$23865;if(((typeof(s$23856)==="string")&&s$23856.match(RegExp("(?:^(?:[a-zA-Z_$]+)$)","")))){(trf$23876=it$0$23691.translate(f$23854,"expr"));;(trmsg$23877=it$0$23691.translate(["symbol",s$23856],"expr"));;return it$0$23691.expr(((trf$23876+".")+trmsg$23877),mode$23688);}else{(otherwise$23886=$23863$23865);(trf$23889=it$0$23691.translate(f$23854,"expr"));;(trmsg$23890=it$0$23691.translate(msg$23855,"expr"));;return it$0$23691.expr((((trf$23889+"[")+trmsg$23890)+"]"),mode$23688);}}else{if(($23702$23726&&((f$23899=$23696$23708[1]),((t1$23714=$23696$23708[2]),((t1$23714 instanceof Array)&&((t2$23715=t1$23714.length),((t2$23715>=1)&&(t1$23714[0]==="array")))))))){(args$23900=Array.prototype.slice.call(t1$23714,1));(op$23907=((($23910$23915=f$23899)),function(){if((($23911$23922=($23910$23915 instanceof Array))&&((t0$23920=$23910$23915.length),(($23913$23924=(t0$23920===2))&&($23910$23915[0]==="symbol"))))){(x$23927=$23910$23915[1]);return $23284(js_op_table$23336,x$23927);}else{if(($23913$23924&&($23910$23915[0]==="variable"))){(x$23933=$23910$23915[1]);return $23284(js_op_table2$23335,x$23933);}else{$23910$23915;return null;}}}()));;if(op$23907){return it$0$23691.expr(it$0$23691.op(op$23907,args$23900[0],args$23900[1]),mode$23688);}else{(trf$23941=it$0$23691.translate(f$23899,"expr"));;(trargs$23942=(((acc$23951=[])),(((temp$23956=args$23900)),((($length$23961=temp$23956.length)),((($index$23966=0)),function(){$23948:for(;($index$23966<$length$23961);($index$23966++)){var x$23982;var m$23974;(m$23974=temp$23956[$index$23966]);;(x$23982=m$23974);acc$23951.push(it$0$23691.translate(x$23982,"expr"));}}()))),acc$23951));;return it$0$23691.expr((((trf$23941+"(")+trargs$23942.join(","))+")"),mode$23688);}}else{if($23702$23726){(f$23987=$23696$23708[1]);(msg$23988=$23696$23708[2]);(t0$23994=(((code$23998="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$23691.register_raw(code$23998,"~send")));if(((t0$23994 instanceof Array)&&((t1$23995=t0$23994.length),((t1$23995===2)&&(t0$23994[0]==="symbol"))))){(codevar$23992=t0$23994[1]);;}else{$24855((((code$24006="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$23691.register_raw(code$24006,"~send")),"/home/olivier/git/earl-grey/src/translate-js.eg",6890,7100);}(trf$24011=it$0$23691.translate(f$23987,"expr"));;(trmsg$24012=it$0$23691.translate(msg$23988,"expr"));;return it$0$23691.expr((((((codevar$23992+"(")+trf$24011)+",")+trmsg$24012)+")"),mode$23688);}else{if(($23699$23723&&(($23701$23725=(t0$23713>=1))&&($23696$23708[0]==="array")))){(args$24021=Array.prototype.slice.call($23696$23708,1));(r$24025=(((f$24029=function(x$24033){return it$0$23691.translate(x$24033,"expr");})),(("["+args$24021.map(f$24029).join(","))+"]")));;return it$0$23691.expr(r$24025,mode$23688);}else{if(($23701$23725&&($23696$23708[0]==="object"))){(args$24039=Array.prototype.slice.call($23696$23708,1));(all_strings$24043=args$24039.every(function($24047$24049){var t0$24055;var t1$24056;var other$24077;var v$24071;var t0$24067;var $24051$24062;var ph$24052;var y$24053;(t0$24055=$24047$24049);if(((t0$24055 instanceof Array)&&((t1$24056=t0$24055.length),((t1$24056===3)&&(t0$24055[0]==="array"))))){(ph$24052=t0$24055[1]);(y$24053=t0$24055[2]);;}else{$24855($24047$24049);}($24051$24062=ph$24052);;if((($24051$24062 instanceof Array)&&((t0$24067=$24051$24062.length),((t0$24067===2)&&($24051$24062[0]==="value"))))){(v$24071=$24051$24062[1]);return true;}else{(other$24077=$24051$24062);return false;}}));;(r$24044=function(){if(all_strings$24043){(f$24083=function($24086$24088){var t0$24093;var t1$24094;var a$24100;var b$24101;var x$24090;var y$24091;(t0$24093=$24086$24088);if(((t0$24093 instanceof Array)&&((t1$24094=t0$24093.length),((t1$24094===3)&&(t0$24093[0]==="array"))))){(x$24090=t0$24093[1]);(y$24091=t0$24093[2]);;}else{$24855($24086$24088);}(a$24100=it$0$23691.translate(x$24090,"expr"));;(b$24101=it$0$23691.translate(y$24091,"expr"));;return ((a$24100+":")+b$24101);});;return (("({"+args$24039.map(f$24083).join(","))+"})");}else{(v$24110=gensym$23332());;(f$24115=function($24118$24120){var t0$24125;var t1$24126;var a$24132;var b$24133;var x$24122;var y$24123;(t0$24125=$24118$24120);if(((t0$24125 instanceof Array)&&((t1$24126=t0$24125.length),((t1$24126===3)&&(t0$24125[0]==="array"))))){(x$24122=t0$24125[1]);(y$24123=t0$24125[2]);;}else{$24855($24118$24120);}(a$24132=it$0$23691.translate(x$24122,"expr"));;(b$24133=it$0$23691.translate(y$24123,"expr"));;return (((((v$24110+"[")+a$24132)+"]=")+b$24133)+";");});;return ((((((("(function(){"+"var ")+v$24110)+"={};")+args$24039.map(f$24115).join(""))+";return ")+v$24110)+";}())");}}());;return it$0$23691.expr(r$24044,mode$23688);}else{if(($23699$23723&&((t0$23713===3)&&($23696$23708[0]==="lambda")))){(bindings$24144=$23696$23708[1]);(body$24145=$23696$23708[2]);(a$24149=(((acc$24160=[])),(((temp$24165=bindings$24144)),((($length$24170=temp$24165.length)),((($index$24175=0)),function(){$24157:for(;($index$24175<$length$24170);($index$24175++)){var x$24191;var m$24183;(m$24183=temp$24165[$index$24175]);;(x$24191=m$24183);acc$24160.push(it$0$23691.translate(x$24191,"expr"));}}()))),acc$24160).join(","));;(b$24150=it$0$23691.body(body$24145,"return"));;return it$0$23691.expr((((("function("+a$24149)+"){")+b$24150)+"}"),mode$23688);}else{if(($23699$23723&&(($23701$23725=(t0$23713===4))&&(($23702$23726=($23696$23708[0]==="if"))&&((test$24199=$23696$23708[1]),((pos$24200=$23696$23708[2]),((t1$23714=$23696$23708[3]),((t1$23714 instanceof Array)&&((t2$23715=t1$23714.length),((t2$23715===2)&&((t1$23714[0]==="value")&&(t1$23714[1]===(void 0))))))))))))){($24207$24209=mode$23688);;if(($24207$24209==="expr")){return it$0$23691.body(expr$23687,"expr");}else{(other$24221=$24207$24209);(a$24224=it$0$23691.translate(test$24199,"expr"));;(b$24225=it$0$23691.translate(pos$24200,mode$23688));;return (((("if("+a$24224)+"){")+b$24225)+"}");}}else{if($23702$23726){(test$24234=$23696$23708[1]);(pos$24235=$23696$23708[2]);(neg$24236=$23696$23708[3]);($24239$24241=mode$23688);;if(($24239$24241==="expr")){return it$0$23691.body(expr$23687,"expr");}else{(other$24253=$24239$24241);(a$24256=it$0$23691.translate(test$24234,"expr"));;(b$24257=it$0$23691.translate(pos$24235,mode$23688));;(c$24258=it$0$23691.translate(neg$24236,mode$23688));;return (((((("if("+a$24256)+"){")+b$24257)+"}else{")+c$24258)+"}");}}else{if(($23699$23723&&(($23701$23725=(t0$23713===3))&&(($23702$23726=($23696$23708[0]==="declare"))&&((binding$24270=$23696$23708[1]),((t1$23714=$23696$23708[2]),((t1$23714 instanceof Array)&&((t2$23715=t1$23714.length),((t2$23715===2)&&((t1$23714[0]==="value")&&(t1$23714[1]===(void 0)))))))))))){($24276$24279=mode$23688);;(bridge$24277$24284=$24276$24279);if(((bridge$24277$24284==="expr")||(bridge$24277$24284==="return"))){throw "Invalid in expr ctx";}else{(other$24292=$24276$24279);(a$24295=it$0$23691.translate(binding$24270,"expr"));;return (("var "+a$24295)+";");}}else{if($23702$23726){(binding$24301=$23696$23708[1]);(value$24302=$23696$23708[2]);($24305$24308=mode$23688);;(bridge$24306$24313=$24305$24308);if(((bridge$24306$24313==="expr")||(bridge$24306$24313==="return"))){throw "Invalid in expr ctx";}else{(other$24321=$24305$24308);(a$24324=it$0$23691.translate(binding$24301,"expr"));;(b$24325=it$0$23691.translate(value$24302,"expr"));;return (((("var "+a$24324)+"=")+b$24325)+";");}}else{if(($23701$23725&&(($23702$23726=($23696$23708[0]==="assign"))&&((t1$23714=$23696$23708[1]),((t1$23714 instanceof Array)&&((t2$23715=t1$23714.length),((t2$23715===3)&&(t1$23714[0]==="send")))))))){(obj$24334=t1$23714[1]);(msg$24335=t1$23714[2]);(rhs$24336=$23696$23708[2]);(a$24342=it$0$23691.translate(obj$24334,"expr"));;(b$24343=it$0$23691.translate(msg$24335,"expr"));;(c$24344=it$0$23691.translate(rhs$24336,"expr"));;return it$0$23691.expr((((((("("+a$24342)+"[")+b$24343)+"]=")+c$24344)+")"),mode$23688);}else{if($23702$23726){(lhs$24356=$23696$23708[1]);(rhs$24357=$23696$23708[2]);(a$24361=it$0$23691.translate(lhs$24356,"expr"));;(b$24362=it$0$23691.translate(rhs$24357,"expr"));;return it$0$23691.expr((((("("+a$24361)+"=")+b$24362)+")"),mode$23688);}else{if(($23699$23723&&((t0$23713===1)&&($23696$23708[0]==="multi")))){if((mode$23688==="stmt")){return ";";}else{return "";}}else{if(($23699$23723&&(($23701$23725=(t0$23713>=1))&&($23696$23708[0]==="multi")))){(args$24375=Array.prototype.slice.call($23696$23708,1));(isdecl$24381=function($24384$24386){var other$24410;var variable$24403;var value$24404;var t0$24399;var $24388$24394;var ph$24389;(ph$24389=$24384$24386);;($24388$24394=ph$24389);;if((($24388$24394 instanceof Array)&&((t0$24399=$24388$24394.length),((t0$24399===3)&&($24388$24394[0]==="declare"))))){(variable$24403=$24388$24394[1]);(value$24404=$24388$24394[2]);return true;}else{(other$24410=$24388$24394);return false;}});;($24379$24414=null);;$24379$24414;if((args$24375.length===1)){return it$0$23691.translate(args$24375[0],mode$23688);}else{if(((mode$23688==="expr")&&(!args$24375.some(isdecl$24381)))){(xs$24430=(((acc$24436=[])),(((temp$24441=args$24375)),((($length$24446=temp$24441.length)),((($index$24451=0)),function(){$24433:for(;($index$24451<$length$24446);($index$24451++)){var x$24467;var m$24459;(m$24459=temp$24441[$index$24451]);;(x$24467=m$24459);acc$24436.push(it$0$23691.translate(x$24467,"expr"));}}()))),acc$24436));;(xs$24430=(((acc$24473=[])),(((temp$24478=xs$24430)),((($length$24483=temp$24478.length)),((($index$24488=0)),function(){$24470:for(;($index$24488<$length$24483);($index$24488++)){var x$24504;var m$24496;(m$24496=temp$24478[$index$24488]);;(x$24504=m$24496);if((x$24504!=="")){acc$24473.push(x$24504);}else{false;;}}}()))),acc$24473));return (("("+xs$24430.join(","))+")");}else{return it$0$23691.body(expr$23687,mode$23688);}}}else{if(($23701$23725&&($23696$23708[0]==="splice"))){(args$24514=Array.prototype.slice.call($23696$23708,1));return it$0$23691.translate(["multi"].concat(args$24514),mode$23688);}else{if(($23699$23723&&((t0$23713===2)&&($23696$23708[0]==="variable")))){(s$24519=$23696$23708[1]);return it$0$23691.expr(it$0$23691.mangle(s$24519),mode$23688);}else{if(($23699$23723&&((t0$23713===3)&&($23696$23708[0]==="scope")))){(vars$24524=$23696$23708[1]);(body$24525=$23696$23708[2]);(decls$24529=(((acc$24535=[])),(((temp$24540=vars$24524)),((($length$24545=temp$24540.length)),((($index$24550=0)),function(){$24532:for(;($index$24550<$length$24545);($index$24550++)){var v$24566;var m$24558;(m$24558=temp$24540[$index$24550]);;(v$24566=m$24558);acc$24535.push(["declare",v$24566,["value",(void 0)]]);}}()))),acc$24535));;return it$0$23691.translate(["multi"].concat(decls$24529).concat([body$24525]),mode$23688);}else{if(($23699$23723&&((t0$23713>=1)&&($23696$23708[0]==="object2")))){(args$24571=Array.prototype.slice.call($23696$23708,1));(r$24575=(((f$24579=function($24582$24584){var t0$24589;var t1$24590;var a$24596;var b$24597;var x$24586;var y$24587;(t0$24589=$24582$24584);if(((t0$24589 instanceof Array)&&((t1$24590=t0$24589.length),(t1$24590===2)))){(x$24586=t0$24589[0]);(y$24587=t0$24589[1]);;}else{$24855($24582$24584);}(a$24596=it$0$23691.translate(x$24586,"expr"));;(b$24597=it$0$23691.translate(y$24587,"expr"));;return ((a$24596+":")+b$24597);})),(("({"+args$24571.map(f$24579).join(","))+"})")));;return it$0$23691.expr(r$24575,mode$23688);}else{if(($23699$23723&&((t0$23713===2)&&($23696$23708[0]==="js_new")))){(value$24608=$23696$23708[1]);return it$0$23691.expr((("(new "+it$0$23691.translate(value$24608,"expr"))+")"),mode$23688);}else{if(($23699$23723&&(($23701$23725=((t0$23713>=1)&&(t0$23713<=2)))&&(($23696$23708[0]==="js_break")&&((t1$23714=function(){if((1>=t0$23713)){return ["value",null];}else{return $23696$23708[1];}}()),((t1$23714 instanceof Array)&&((t2$23715=t1$23714.length),((t2$23715===2)&&(t1$23714[0]==="value"))))))))){(label$24613=t1$23714[1]);if((mode$23688==="expr")){throw "Invalid break in ctx";}else{return (("break"+function(){if(label$24613){return (" "+label$24613);}else{return "";}}())+";");}}else{if(($23701$23725&&(($23696$23708[0]==="js_continue")&&((t1$23714=function(){if((1>=t0$23713)){return ["value",null];}else{return $23696$23708[1];}}()),((t1$23714 instanceof Array)&&((t2$23715=t1$23714.length),((t2$23715===2)&&(t1$23714[0]==="value")))))))){(label$24620=t1$23714[1]);if((mode$23688==="expr")){throw "Invalid continue in ctx";}else{return (("continue"+function(){if(label$24620){return (" "+label$24620);}else{return "";}}())+";");}}else{if(($23699$23723&&(($23701$23725=(t0$23713===2))&&($23696$23708[0]==="js_return")))){(value$24627=$23696$23708[1]);if((mode$23688==="expr")){throw "Invalid return in ctx";}else{return (("return "+it$0$23691.translate(value$24627,"expr"))+";");}}else{if(($23701$23725&&($23696$23708[0]==="js_delete"))){(value$24632=$23696$23708[1]);if((mode$23688==="expr")){throw "Invalid delete in ctx";}else{return (("delete "+it$0$23691.translate(value$24632,"expr"))+";");}}else{if(($23701$23725&&($23696$23708[0]==="js_throw"))){(value$24637=$23696$23708[1]);if((mode$23688==="expr")){return (("function(){throw "+it$0$23691.translate(value$24637,"expr"))+";}()");}else{return (("throw "+it$0$23691.translate(value$24637,"expr"))+";");}}else{if(($23699$23723&&(($23701$23725=(t0$23713===3))&&(($23696$23708[0]==="js_label")&&((t1$23714=$23696$23708[1]),((t1$23714 instanceof Array)&&((t2$23715=t1$23714.length),((t2$23715===2)&&(t1$23714[0]==="value"))))))))){(label$24642=t1$23714[1]);(body$24643=$23696$23708[2]);($24648$24650=mode$23688);;if(($24648$24650==="expr")){return it$0$23691.body(expr$23687,"expr");}else{(other$24662=$24648$24650);return ((label$24642+":")+it$0$23691.translate(body$24643,other$24662));}}else{if(($23701$23725&&($23696$23708[0]==="js_while"))){(test$24666=$23696$23708[1]);(body$24667=$23696$23708[2]);($24670$24672=mode$23688);;if(($24670$24672==="expr")){return it$0$23691.body(expr$23687,"expr");}else{(other$24684=$24670$24672);(a$24687=it$0$23691.translate(test$24666,"expr"));;(b$24688=it$0$23691.translate(body$24667,"stmt"));;return (((("while("+a$24687)+"){")+b$24688)+"}");}}else{if(($23699$23723&&((t0$23713===5)&&($23696$23708[0]==="js_for")))){(x$24697=$23696$23708[1]);(y$24698=$23696$23708[2]);(z$24699=$23696$23708[3]);(body$24700=$23696$23708[4]);($24703$24705=mode$23688);;if(($24703$24705==="expr")){return it$0$23691.body(expr$23687,"expr");}else{(other$24717=$24703$24705);(a$24720=it$0$23691.translate(x$24697,"stmt"));;(b$24721=it$0$23691.translate(y$24698,"stmt"));;(c$24722=it$0$23691.translate(z$24699,"expr"));;(d$24723=it$0$23691.translate(body$24700,"stmt"));;return (((((("for("+a$24720)+b$24721)+c$24722)+"){")+d$24723)+"}");}}else{if(($23699$23723&&(($23701$23725=(t0$23713===4))&&($23696$23708[0]==="js_for_in")))){(x$24738=$23696$23708[1]);(y$24739=$23696$23708[2]);(body$24740=$23696$23708[3]);($24743$24745=mode$23688);;if(($24743$24745==="expr")){return it$0$23691.body(expr$23687,"expr");}else{(other$24757=$24743$24745);(a$24760=it$0$23691.translate(x$24738,"expr"));;(b$24761=it$0$23691.translate(y$24739,"expr"));;(c$24762=it$0$23691.translate(body$24740,"stmt"));;return (((((("for("+a$24760)+" in ")+b$24761)+"){")+c$24762)+"}");}}else{if(($23701$23725&&(($23696$23708[0]==="js_try")&&((attempt$24774=$23696$23708[1]),((t1$23714=$23696$23708[2]),((t1$23714 instanceof Array)&&((t2$23715=t1$23714.length),((t2$23715===3)&&((t1$23714[0]==="lambda")&&((t3$23716=t1$23714[1]),((t3$23716 instanceof Array)&&((t4$23717=t3$23716.length),((t4$23717===1)&&((bridge$23698$23719=t3$23716[0]),((((bridge$23698$23719 instanceof Array)&&((t0$24785=bridge$23698$23719.length),((t0$24785===2)&&((bridge$23698$23719[0]==="symbol")&&((v$24775=bridge$23698$23719[1]),true)))))||((bridge$23698$23719 instanceof Array)&&((t0$24789=bridge$23698$23719.length),((t0$24789===2)&&((bridge$23698$23719[0]==="variable")&&((v$24775=bridge$23698$23719[1]),true))))))&&((body$24776=t1$23714[2]),((t5$23720=$23696$23708[3]),((t5$23720 instanceof Array)&&((t6$23721=t5$23720.length),((t6$23721===1)&&(t5$23720[0]==="void"))))))))))))))))))))){($24796$24798=mode$23688);;if(($24796$24798==="expr")){return it$0$23691.body(expr$23687,"expr");}else{(other$24810=$24796$24798);(a$24813=it$0$23691.translate(attempt$24774,"stmt"));;(b$24814=it$0$23691.translate(body$24776,"stmt"));;return (((((("try{"+a$24813)+"}catch(")+v$24775)+"){")+b$24814)+"}");}}else{if(($23699$23723&&((t0$23713===2)&&($23696$23708[0]==="raw")))){(x$24823=$23696$23708[1]);return x$24823;}else{(other$24828=$23696$23708);throw other$24828;}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}});$23285(Translator$23337,$23285(((accum$24831=({})),((accum$24831["::name"]="Translator"),accum$24831)),((accum$24835=({})),((accum$24835["::egclass"]=true),accum$24835))));Translator$23337;(translate$23338=function(expr$24841,mode$24842){var tr$24845;var t$24846;(tr$24845=Translator$23337());;(t$24846=tr$24845.translate(expr$24841,mode$24842));;return (tr$24845.dump_store()+t$24846);});;(exports["Translator"]=Translator$23337);(exports["translate"]=translate$23338);

},{"./pp":11,"./util":14}],14:[function(require,module,exports){
var $25286=function(type$25288){var f$25291;(f$25291=type$25288["::check"]);;if((f$25291===(void 0))){return function(value$25296){return (value$25296 instanceof type$25288);};}else{return function(value$25299){return f$25291.call(type$25288,value$25299);};}};
var $25301=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $25302=function(dest$25304,values$25305){var k$25310;(k$25310=null);$25308:for(k$25310 in values$25305){if(values$25305.hasOwnProperty(k$25310)){(dest$25304[k$25310]=values$25305[k$25310]);}}return dest$25304;};
var $25314=function($25315$25317){var ph$25321;(ph$25321=$25315$25317);;var $25319$25326;($25319$25326=ph$25321);;var bridge$25320$25331;var x$25335;(bridge$25320$25331=$25319$25326);if((((typeof(bridge$25320$25331)==="string")&&((x$25335=bridge$25320$25331),true))||((typeof(bridge$25320$25331)==="number")&&((x$25335=bridge$25320$25331),true)))){return ["value",x$25335];}else{var other$25342;(other$25342=$25319$25326);return other$25342["::serialize_ast"]();}};
var send$25126;(send$25126=function(obj$25131,$25129$25132){var ph$25136;var msg$25137;var t0$25139;(t0$25139=$25129$25132);(msg$25137=t0$25139);(ph$25136=t0$25139);;var $25134$25143;($25134$25143=ph$25136);;var bridge$25135$25148;(bridge$25135$25148=$25134$25143);if(((typeof(bridge$25135$25148)==="string")||(typeof(bridge$25135$25148)==="number"))){return obj$25131[msg$25137];}else{var other$25156;(other$25156=$25134$25143);return obj$25131["::send"](msg$25137);}});;(Array[":::project"]=function($25159$25161){var ph$25164;var value$25165;var t0$25167;(t0$25167=$25159$25161);(value$25165=t0$25167);(ph$25164=t0$25167);;var $25163$25171;($25163$25171=ph$25164);;if($25286(Array)($25163$25171)){return [true,value$25165];}else{$25163$25171;return [true,[value$25165]];}});(Array.prototype["::check"]=function(value$25185){if((value$25185 instanceof Array)){var i$25190;(i$25190=0);;$25188:for(;(i$25190<this.length);(i$25190++)){if(($25301(this,i$25190)!==$25301(value$25185,i$25190))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $25302(this.slice(0),this);});(Array.prototype[":::project"]=function(value$25201){if((value$25201 instanceof Array)){var i$25206;(i$25206=0);;$25204:for(;(i$25206<this.length);(i$25206++)){if(($25301(this,i$25206)!==$25301(value$25201,i$25206))){return [true,[value$25201]];}}return [true,value$25201.slice(this.length)];}else{return [true,[value$25201]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($25314));});(RegExp.prototype["::check"]=function($25216$25218){var ph$25221;(ph$25221=$25216$25218);;var $25220$25226;($25220$25226=ph$25221);;var value$25234;if((typeof($25220$25226)==="string")){(value$25234=$25220$25226);if(value$25234.match(this)){return true;}else{return false;}}else{var other$25239;(other$25239=$25220$25226);return false;}});(RegExp.prototype[":::project"]=function($25241$25243){var ph$25246;(ph$25246=$25241$25243);;var $25245$25251;($25245$25251=ph$25246);;var value$25259;if((typeof($25245$25251)==="string")){(value$25259=$25245$25251);var $25262$25264;($25262$25264=value$25259.match(this));;var m$25272;if(($25262$25264===null)){(m$25272=$25262$25264);return [false,null];}else{var m$25277;(m$25277=$25262$25264);return [true,m$25277];}}else{var other$25281;(other$25281=$25245$25251);return [false,null];}});(Function.prototype["::send"]=function(args$25284){return this.apply(this,args$25284);});
var $26153=function(arr$26155){var results$26159;var l$26160;(results$26159=[]);;(l$26160=arr$26155.length);;var i$26168;(i$26168=0);;$26158:for(;(i$26168<l$26160);(i$26168++)){results$26159.push([i$26168,$25301(arr$26155,i$26168)]);}return results$26159;};
var $25984=function(){var $25985$25987;($25985$25987=function(tags$25991){var it$0$25994;(it$0$25994=function(){if((!$25286($25985$25987)(this))){return Object.create($25985$25987.prototype);}else{return this;}}());;(it$0$25994["tags"]=tags$25991);return it$0$25994;});;($25985$25987.prototype["create"]=function(){var $26003$26005;($26003$26005=arguments);;var t0$26010;var message$26014;var args$26015;(t0$26010=$26003$26005.length);if((t0$26010>=0)){(message$26014=function(){if((0>=t0$26010)){return "";}else{return $26003$26005[0];}}());(args$26015=Array.prototype.slice.call($26003$26005,1));var it$0$26019;(it$0$26019=this);;var self$26024;(self$26024=this);;var e$26029;(e$26029=Error(message$26014));;(e$26029["::tags"]=it$0$26019.tags);(e$26029["args"]=args$26015);var temp$26037;(temp$26037=$26153(args$26015));;var $length$26042;($length$26042=temp$26037.length);;var $index$26047;($index$26047=0);;$26030:for(;($index$26047<$length$26042);($index$26047++)){var m$26055;(m$26055=temp$26037[$index$26047]);;var t0$26060;var t1$26061;var i$26065;var arg$26066;(t0$26060=m$26055);if(((t0$26060 instanceof Array)&&((t1$26061=t0$26060.length),(t1$26061===2)))){(i$26065=t0$26060[0]);(arg$26066=t0$26060[1]);(e$26029[i$26065]=arg$26066);}else{$25971(m$26055);;}}(e$26029["length"]=args$26015.length);(e$26029["name"]=["E"].concat(it$0$26019.tags).join("."));return e$26029;}else{$25971($26003$26005);}});($25985$25987.prototype["::check"]=function(e$26077){var it$0$26080;(it$0$26080=this);;var self$26085;(self$26085=this);;var tags$26090;if(((!e$26077)||(!$25286(Error)(e$26077)))){return false;}(tags$26090=(e$26077["::tags"]||[]));;var temp$26099;(temp$26099=it$0$26080.tags);;var $length$26104;($length$26104=temp$26099.length);;var $index$26109;($index$26109=0);;$26091:for(;($index$26109<$length$26104);($index$26109++)){var m$26117;(m$26117=temp$26099[$index$26109]);;var tag$26125;(tag$26125=m$26117);if((tags$26090.indexOf(tag$26125)===-1)){return false;}else{false;;}}return true;});($25985$25987.prototype["::deconstruct"]=function(e$26133){var it$0$26136;(it$0$26136=this);;var self$26141;(self$26141=this);;return e$26133.args;});$25302($25985$25987,$25302(function(){var accum$26146;(accum$26146=({}));(accum$26146["::name"]="$25985");return accum$26146;}(),function(){var accum$26150;(accum$26150=({}));(accum$26150["::egclass"]=true);return accum$26150;}()));return $25985$25987;}();
var $25971=function(value$25973,url$25974,start$25975,end$25976){var err$25979;(err$25979=$25984(["match"]).create("Could not find a match for value",({"value":value$25973})));;if(url$25974){(err$25979["location"]=["location",url$25974,start$25975,end$25976]);}throw err$25979;};var GenSym$25346;var gensym$25347;var uuid$25348;var identity$25349;var binsearch$25350;var __classify$25351;var classify$25352;var classify_contiguous$25353;var neighbours$25354;var partition$25355;var construct$25356;var mkset$25357;var make_object$25358;var product$25359;(GenSym$25346=function(prefix$25363){var id$25366;(id$25366=0);;return function(){var r$25386;var pfx$25382;var t0$25378;var $25371$25373;($25371$25373=arguments);;(t0$25378=$25371$25373.length);if(((t0$25378>=0)&&(t0$25378<=1))){(pfx$25382=function(){if((0>=t0$25378)){return null;}else{return $25371$25373[0];}}());(r$25386=(((pfx$25382||"")+prefix$25363)+[true,String(id$25366)][1]));;(id$25366++);return r$25386;}else{$25971($25371$25373);}};});;(gensym$25347=GenSym$25346("$"));;(uuid$25348=function(){return gensym$25347("#");});;(identity$25349=function(x$25404){return x$25404;});;(binsearch$25350=function(xs$25410,x$25411){var lo$25414;var hi$25415;(lo$25414=0);;(hi$25415=(xs$25410.length-1));;$25422:while((lo$25414<=hi$25415)){var $25426$25436;var mid$25427;var v$25428;(mid$25427=(lo$25414+((hi$25415-lo$25414)>>1)));;(v$25428=$25301(xs$25410,mid$25427));;($25426$25436=$25301(xs$25410,mid$25427));;if(($25426$25436<x$25411)){(lo$25414=(mid$25427+1));}else{if(($25426$25436>x$25411)){(hi$25415=(mid$25427-1));}else{$25426$25436;return (mid$25427+1);}}}return lo$25414;});;(__classify$25351=function(xs$25457){var results$25460;(results$25460=({}));;$25464:while(xs$25457.length){var cls$25490;var x$25491;var newxs$25484;var $25468$25479;var $25469$25480;var $25470$25481;var t0$25477;var $25467$25472;($25467$25472=xs$25457.shift());;if((($25468$25479=($25467$25472 instanceof Array))&&((t0$25477=$25467$25472.length),(($25470$25481=(t0$25477===2))&&($25467$25472[0]==="splice"))))){(newxs$25484=$25467$25472[1]);(xs$25457=newxs$25484.concat(xs$25457));}else{if($25470$25481){(cls$25490=$25467$25472[0]);(x$25491=$25467$25472[1]);if((!$25301(results$25460,cls$25490))){(results$25460[cls$25490]=[]);}$25301(results$25460,cls$25490).push(x$25491);}else{$25971($25467$25472);;}}}return results$25460;});;(classify$25352=function(){var $index$25536;var $length$25531;var temp$25526;var results$25518;var classes$25513;var xs$25514;var t0$25509;var $25502$25504;($25502$25504=arguments);;(t0$25509=$25502$25504.length);if((t0$25509>=1)){(classes$25513=Array.prototype.slice.call($25502$25504,0,-1));(xs$25514=$25502$25504[(t0$25509-1)]);(results$25518=({"rest":[]}));;(temp$25526=classes$25513);;($length$25531=temp$25526.length);;($index$25536=0);;$25519:for(;($index$25536<$length$25531);($index$25536++)){var cls$25552;var m$25544;(m$25544=temp$25526[$index$25536]);;(cls$25552=m$25544);(results$25518[cls$25552]=[]);}$25554:while(xs$25514.length){var x$25576;var other$25592;var cls$25583;var x$25584;var newxs$25568;var t0$25564;var $25557$25559;($25557$25559=xs$25514.shift());;if((($25557$25559 instanceof Array)&&((t0$25564=$25557$25559.length),((t0$25564>=1)&&($25557$25559[0]==="splice"))))){(newxs$25568=Array.prototype.slice.call($25557$25559,1));(xs$25514=newxs$25568.concat(xs$25514));}else{if((((x$25576=$25557$25559)),((x$25576 instanceof Array)&&(x$25576[0]==="ignore")))){null;}else{if((($25557$25559 instanceof Array)&&((t0$25564=$25557$25559.length),((t0$25564===2)&&((cls$25583=$25557$25559[0]),((x$25584=$25557$25559[1]),$25301(results$25518,cls$25583))))))){$25301(results$25518,cls$25583).push(x$25584);}else{(other$25592=$25557$25559);results$25518.rest.push(other$25592);}}}}return results$25518;}else{$25971($25502$25504);}});;(classify_contiguous$25353=function(xs$25600,classifier$25601){var $index$25630;var $length$25625;var temp$25620;var groups$25604;var currcls$25605;var curr$25606;(groups$25604=[]);;(currcls$25605=null);;(curr$25606=null);;(temp$25620=xs$25600);;($length$25625=temp$25620.length);;($index$25630=0);;$25607:for(;($index$25630<$length$25625);($index$25630++)){var cls$25649;var x$25646;var m$25638;(m$25638=temp$25620[$index$25630]);;(x$25646=m$25638);(cls$25649=classifier$25601(x$25646));;if((cls$25649===currcls$25605)){curr$25606.push(x$25646);}else{if(curr$25606){groups$25604.push(curr$25606);}(curr$25606=[cls$25649,x$25646]);(currcls$25605=cls$25649);}}if(curr$25606){groups$25604.push(curr$25606);}return groups$25604;});;(neighbours$25354=function($25659$25661){var x$25692;var y$25693;var rest$25694;var x$25687;var $25664$25678;var $25665$25679;var t0$25676;var $25663$25671;var ph$25666;(ph$25666=$25659$25661);;($25663$25671=ph$25666);;if((($25664$25678=($25663$25671 instanceof Array))&&((t0$25676=$25663$25671.length),(t0$25676===0)))){return [];}else{if(($25664$25678&&(t0$25676===1))){(x$25687=$25663$25671[0]);return [];}else{if(($25664$25678&&(t0$25676>=2))){(x$25692=$25663$25671[0]);(y$25693=$25663$25671[1]);(rest$25694=Array.prototype.slice.call($25663$25671,2));return [[x$25692,y$25693]].concat(neighbours$25354([y$25693].concat(rest$25694)));}else{$25971($25663$25671);}}}});;(partition$25355=function(xs$25703,predicate$25704){var $index$25729;var $length$25724;var temp$25719;var t$25707;var f$25708;(t$25707=[]);;(f$25708=[]);;(temp$25719=xs$25703);;($length$25724=temp$25719.length);;($index$25729=0);;$25709:for(;($index$25729<$length$25724);($index$25729++)){var x$25750;var x$25745;var m$25737;(m$25737=temp$25719[$index$25729]);;(x$25745=m$25737);if(predicate$25704(x$25745)){t$25707.push(x$25745);}else{(x$25750=m$25737);f$25708.push(x$25750);}}return [t$25707,f$25708];});;(construct$25356=function($25755$25757,fn$25758,zero$25759){var x$25790;var rest$25791;var x$25785;var $25762$25776;var $25763$25777;var t0$25774;var $25761$25769;var ph$25764;(ph$25764=$25755$25757);;($25761$25769=ph$25764);;if((($25762$25776=($25761$25769 instanceof Array))&&((t0$25774=$25761$25769.length),(t0$25774===0)))){return zero$25759;}else{if(($25762$25776&&(t0$25774===1))){(x$25785=$25761$25769[0]);return x$25785;}else{if(($25762$25776&&(t0$25774>=1))){(x$25790=$25761$25769[0]);(rest$25791=Array.prototype.slice.call($25761$25769,1));return fn$25758(x$25790,construct$25356(rest$25791,fn$25758,zero$25759));}else{$25971($25761$25769);}}}});;(mkset$25357=function(xs$25800){var $index$25821;var $length$25816;var temp$25811;var rval$25803;(rval$25803=({}));;(temp$25811=xs$25800);;($length$25816=temp$25811.length);;($index$25821=0);;$25804:for(;($index$25821<$length$25816);($index$25821++)){var x$25837;var m$25829;(m$25829=temp$25811[$index$25821]);;(x$25837=m$25829);(rval$25803[x$25837]=true);}return rval$25803;});;(make_object$25358=function(pairs$25843){var $index$25864;var $length$25859;var temp$25854;var rval$25846;(rval$25846=({}));;(temp$25854=pairs$25843);;($length$25859=temp$25854.length);;($index$25864=0);;$25847:for(;($index$25864<$length$25859);($index$25864++)){var k$25882;var v$25883;var t0$25877;var t1$25878;var m$25872;(m$25872=temp$25854[$index$25864]);;(t0$25877=m$25872);if(((t0$25877 instanceof Array)&&((t1$25878=t0$25877.length),(t1$25878===2)))){(k$25882=t0$25877[0]);(v$25883=t0$25877[1]);(rval$25846[k$25882]=v$25883);}else{$25971(m$25872,"/home/olivier/git/earl-grey/src/util.eg",2736,2779);;}}return rval$25846;});;(product$25359=function(a$25893,b$25894){var $index$25915;var $length$25910;var temp$25905;var results$25897;(results$25897=[]);;(temp$25905=a$25893);;($length$25910=temp$25905.length);;($index$25915=0);;$25898:for(;($index$25915<$length$25910);($index$25915++)){var $index$25951;var $length$25946;var temp$25941;var acc$25936;var x$25931;var m$25923;(m$25923=temp$25905[$index$25915]);;(x$25931=m$25923);(results$25897=results$25897.concat((((acc$25936=[])),(((temp$25941=b$25894)),((($length$25946=temp$25941.length)),((($index$25951=0)),function(){$25933:for(;($index$25951<$length$25946);($index$25951++)){var y$25967;var m$25959;(m$25959=temp$25941[$index$25951]);;(y$25967=m$25959);acc$25936.push([x$25931,y$25967]);}}()))),acc$25936)));}return results$25897;});;(exports["GenSym"]=GenSym$25346);(exports["gensym"]=gensym$25347);(exports["uuid"]=uuid$25348);(exports["identity"]=identity$25349);(exports["binsearch"]=binsearch$25350);(exports["classify"]=classify$25352);(exports["classify_contiguous"]=classify_contiguous$25353);(exports["neighbours"]=neighbours$25354);(exports["partition"]=partition$25355);(exports["construct"]=construct$25356);(exports["mkset"]=mkset$25357);(exports["make_object"]=make_object$25358);(exports["product"]=product$25359);

},{}],15:[function(require,module,exports){

},{}]},{},[])