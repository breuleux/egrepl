require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var $184=function(type$186){var f$189;(f$189=type$186["::check"]);;if((f$189===(void 0))){return function(value$194){return (value$194 instanceof type$186);};}else{return function(value$197){return f$189.call(type$186,value$197);};}};
var $199=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $200=function($201$203){var ph$207;(ph$207=$201$203);;var $205$212;($205$212=ph$207);;var bridge$206$217;var x$221;(bridge$206$217=$205$212);if((((typeof(bridge$206$217)==="string")&&((x$221=bridge$206$217),true))||((typeof(bridge$206$217)==="number")&&((x$221=bridge$206$217),true)))){return ["value",x$221];}else{var other$228;(other$228=$205$212);return other$228["::serialize_ast"]();}};
var send$24;(send$24=function(obj$29,$27$30){var ph$34;var msg$35;var t0$37;(t0$37=$27$30);(msg$35=t0$37);(ph$34=t0$37);;var $32$41;($32$41=ph$34);;var bridge$33$46;(bridge$33$46=$32$41);if(((typeof(bridge$33$46)==="string")||(typeof(bridge$33$46)==="number"))){return obj$29[msg$35];}else{var other$54;(other$54=$32$41);return obj$29["::send"](msg$35);}});;(Array[":::project"]=function($57$59){var ph$62;var value$63;var t0$65;(t0$65=$57$59);(value$63=t0$65);(ph$62=t0$65);;var $61$69;($61$69=ph$62);;if($184(Array)($61$69)){return [true,value$63];}else{$61$69;return [true,[value$63]];}});(Array.prototype["::check"]=function(value$83){if((value$83 instanceof Array)){var i$88;(i$88=0);;$86:for(;(i$88<this.length);(i$88++)){if(($199(this,i$88)!==$199(value$83,i$88))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$99){if((value$99 instanceof Array)){var i$104;(i$104=0);;$102:for(;(i$104<this.length);(i$104++)){if(($199(this,i$104)!==$199(value$99,i$104))){return [true,[value$99]];}}return [true,value$99.slice(this.length)];}else{return [true,[value$99]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($200));});(RegExp.prototype["::check"]=function($114$116){var ph$119;(ph$119=$114$116);;var $118$124;($118$124=ph$119);;var value$132;if((typeof($118$124)==="string")){(value$132=$118$124);if(value$132.match(this)){return true;}else{return false;}}else{var other$137;(other$137=$118$124);return false;}});(RegExp.prototype[":::project"]=function($139$141){var ph$144;(ph$144=$139$141);;var $143$149;($143$149=ph$144);;var value$157;if((typeof($143$149)==="string")){(value$157=$143$149);var $160$162;($160$162=value$157.match(this));;var m$170;if(($160$162===null)){(m$170=$160$162);return [false,null];}else{var m$175;(m$175=$160$162);return [true,m$175];}}else{var other$179;(other$179=$143$149);return [false,null];}});(Function.prototype["::send"]=function(args$182){return this.apply(this,args$182);});
var $616=function(dest$618,values$619){var k$624;(k$624=null);$622:for(k$624 in values$619){if(values$619.hasOwnProperty(k$624)){(dest$618[k$624]=values$619[k$624]);}}return dest$618;};
var $754=function(obj$756){var results$760;(results$760=[]);;var k$765;(k$765=null);$759:for(k$765 in obj$756){if(Object.prototype.hasOwnProperty.call(obj$756,k$765)){results$760.push(k$765);}}return results$760;};
var $769=function($770$772,key$773){var ph$777;(ph$777=$770$772);;var $775$782;($775$782=ph$777);;var bridge$776$787;(bridge$776$787=$775$782);if(((bridge$776$787===null)||(bridge$776$787===(void 0)))){return false;}else{var x$795;if((typeof($775$782)==="string")){(x$795=$775$782);return (key$773 in String.prototype);}else{var x$800;if((typeof($775$782)==="number")){(x$800=$775$782);return (key$773 in Number.prototype);}else{var x$805;(x$805=$775$782);return (key$773 in x$805);}}}};
var $633=function($634$636,b$637){var ph$643;var a$644;var t0$646;(t0$646=$634$636);(a$644=t0$646);(ph$643=t0$646);;var $639$650;($639$650=ph$643);;var bridge$640$655;if(($639$650===b$637)){return true;}else{(bridge$640$655=$639$650);if((function(){var bridge$641$665;(bridge$641$665=bridge$640$655);return (function(){var bridge$642$668;(bridge$642$668=bridge$641$665);return ((typeof(bridge$642$668)==="number")||(typeof(bridge$642$668)==="string"));}()||(bridge$641$665===null));}()||(bridge$640$655===(void 0)))){return false;}else{if($184(Array)($639$650)){if(((!$184(Array)(b$637))||(a$644.length!==b$637.length))){return false;}var i$679;(i$679=0);;$676:for(;(i$679<a$644.length);(i$679++)){if((!$633(a$644[i$679],b$637[i$679]))){return false;}}return true;}else{$639$650;if(((Object.getPrototypeOf(a$644)===Object.prototype)&&(Object.getPrototypeOf(b$637)===Object.prototype))){var ka$692;(ka$692=$754(a$644));;if((!$633(ka$692.sort(),$754(b$637).sort()))){return false;}var temp$701;(temp$701=ka$692);;var $length$706;($length$706=temp$701.length);;var $index$711;($index$711=0);;$693:for(;($index$711<$length$706);($index$711++)){var m$719;(m$719=temp$701[$index$711]);;var k$727;(k$727=m$719);if((!$633(a$644[k$727],b$637[k$727]))){return false;}}return true;}else{if($769($639$650,"::serialize")){$639$650["::serialize"];var $734$736;($734$736=b$637);;if($769($734$736,"::serialize")){$734$736["::serialize"];return $633(a$644["::serialize"](),b$637["::serialize"]());}else{var otherwise$748;(otherwise$748=$734$736);return false;}}else{var otherwise$752;(otherwise$752=$639$650);return false;}}}}}};
var $628=function(x$630,y$631){return (!$633(x$630,y$631));};var accum$608;var accum$612;var keynames$231;var prevent$232;var Interactor$233;(keynames$231=({8:"Backspace",9:"Tab",13:"Enter",16:"S-",17:"C-",18:"A-",27:"Esc",32:"Space",33:"PgUp",34:"PgDn",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12"}));;(prevent$232=function(event$240){event$240.preventDefault();return event$240.stopPropagation();});;(Interactor$233=function(target$247){var accum$257;var accum$263;var accum$269;var accum$275;var it$0$250;(it$0$250=function(){if((!$184(Interactor$233)(this))){return Object.create(Interactor$233.prototype);}else{return this;}}());;(it$0$250["functions"]=(target$247.interactor_functions||target$247));(it$0$250["more_functions"]=$616(((accum$257=({})),((accum$257["default"]=function(){return "default";}),accum$257)),$616(((accum$263=({})),((accum$263["stick"]=function(){return "stick";}),accum$263)),$616(((accum$269=({})),((accum$269["break"]=function(){return "break";}),accum$269)),((accum$275=({})),((accum$275["none"]=function(){return (void 0);}),accum$275))))));(it$0$250["current_bindings"]=null);(it$0$250["global_bindings"]=null);return it$0$250;});;(Interactor$233.prototype["set_bindings"]=function(new_bindings$284){var it$0$287;(it$0$287=this);;(it$0$287["current_bindings"]=null);return (it$0$287["global_bindings"]=new_bindings$284);});(Interactor$233.prototype["execute"]=function(c$295,e$296){var f$317;var $index$350;var $length$345;var temp$340;var result$332;var cmd$396;var cmds$328;var f$323;var cmd$313;var $299$305;var it$0$300;(it$0$300=this);;($299$305=c$295);;if((typeof($299$305)==="string")){(cmd$313=$299$305);(f$317=($199(it$0$300.functions,cmd$313)||$199(it$0$300.more_functions,cmd$313)));;return f$317(e$296);}else{if($184(Function)($299$305)){(f$323=$299$305);return f$323(it$0$300.target,e$296);}else{if($184(Array)($299$305)){(cmds$328=$299$305);(result$332=null);;(temp$340=cmds$328);;($length$345=temp$340.length);;($index$350=0);;$333:for(;($index$350<$length$345);($index$350++)){var other$392;var $369$371;var cmd$366;var m$358;(m$358=temp$340[$index$350]);;(cmd$366=m$358);(result$332=it$0$300.execute(cmd$366,e$296));($369$371=result$332);;if(($369$371==="break")){prevent$232(e$296);break $333;}else{if(($369$371==="default")){break $333;}else{if(($369$371==="ignore")){continue $333;}else{(other$392=$369$371);prevent$232(e$296);}}}}return result$332;}else{(cmd$396=$299$305);(it$0$300["current_bindings"]=cmd$396);return "break stick";}}}});(Interactor$233.prototype["process_codes"]=function(codes$402,e$403){var $index$438;var $length$433;var temp$428;var otherwise$504;var $477$485;var $476$479;var result$510;var t0$469;var $411$464;var bindings$412;var just_modifiers$413;var commands$414;var it$0$406;(it$0$406=this);;(bindings$412=(it$0$406.current_bindings||it$0$406.global_bindings));;(just_modifiers$413=null);;(commands$414=[]);;(temp$428=codes$402);;($length$433=temp$428.length);;($index$438=0);;$415:for(;($index$438<$length$433);($index$438++)){var command$457;var code$454;var m$446;(m$446=temp$428[$index$438]);;(code$454=m$446);if($184(RegExp("^([ACS]-)+$",""))(code$454)){(just_modifiers$413=true);}(command$457=$199(bindings$412,code$454));;if($628(command$457,(void 0))){commands$414.push(command$457);}}($411$464=commands$414);;if((($411$464 instanceof Array)&&((t0$469=$411$464.length),(t0$469===0)))){($476$479=null);;$476$479;if((it$0$406.current_bindings&&it$0$406.current_bindings._eat)){if((!just_modifiers$413)){(it$0$406["current_bindings"]=null);}return prevent$232(e$403);}else{if((it$0$406.current_bindings&&it$0$406.current_bindings._browser)){if((!just_modifiers$413)){return (it$0$406["current_bindings"]=null);}}else{if((it$0$406.current_bindings&&(!just_modifiers$413))){(it$0$406["current_bindings"]=null);return it$0$406.process_codes(codes$402,e$403);}else{(otherwise$504=$476$479);return null;}}}}else{$411$464;(result$510=it$0$406.execute(commands$414,e$403));;if(($633(result$510,(void 0))||(result$510.match&&result$510.match("break")))){prevent$232(e$403);}if((((!((result$510&&result$510.match)&&result$510.match("stick")))&&it$0$406.current_bindings)&&(!it$0$406.current_bindings._stick))){return (it$0$406["current_bindings"]=null);}}});(Interactor$233.prototype["getcode"]=function(e$519){var otherwise$555;var $528$540;var $527$534;var code$529;var it$0$522;(it$0$522=this);;(code$529=($199(keynames$231,e$519.which)||(("<"+e$519.which)+">")));;($527$534=null);;$527$534;if((e$519.shiftKey&&$628(code$529,"S-"))){return ("S-"+code$529);}else{if((e$519.altKey&&$628(code$529,"A-"))){return ("A-"+code$529);}else{if(((e$519.ctrlKey||e$519.metaKey)&&$628(code$529,"C-"))){return ("C-"+code$529);}else{(otherwise$555=$527$534);return code$529;}}}});(Interactor$233.prototype["keyup"]=function(e$560){var it$0$563;(it$0$563=this);;return it$0$563.process_codes(["!^All",("^"+it$0$563.getcode(e$560)),"^All"],e$560);});(Interactor$233.prototype["keydown"]=function(e$570){var it$0$573;(it$0$573=this);;return it$0$573.process_codes(["!All",it$0$573.getcode(e$570),"All"],e$570);});(Interactor$233.prototype["keypress"]=function(e$580){var key$588;var code$589;var it$0$583;(it$0$583=this);;(key$588=e$580.which);;(code$589=("="+String.fromCharCode(key$588)));;return it$0$583.process_codes(["!=All",code$589,"=All"],e$580);});(Interactor$233.prototype["install"]=function(element$599){var it$0$602;(it$0$602=this);;(element$599["onkeydown"]=it$0$602.keydown.bind(it$0$602));(element$599["onkeyup"]=it$0$602.keyup.bind(it$0$602));return (element$599["onkeypress"]=it$0$602.keypress.bind(it$0$602));});$616(Interactor$233,$616(((accum$608=({})),((accum$608["::name"]="Interactor"),accum$608)),((accum$612=({})),((accum$612["::egclass"]=true),accum$612))));Interactor$233;(exports["Interactor"]=Interactor$233);

},{}],"eXk3/i":[function(require,module,exports){
var $968=function(type$970){var f$973;(f$973=type$970["::check"]);;if((f$973===(void 0))){return function(value$978){return (value$978 instanceof type$970);};}else{return function(value$981){return f$973.call(type$970,value$981);};}};
var $983=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $984=function($985$987){var ph$991;(ph$991=$985$987);;var $989$996;($989$996=ph$991);;var bridge$990$1001;var x$1005;(bridge$990$1001=$989$996);if((((typeof(bridge$990$1001)==="string")&&((x$1005=bridge$990$1001),true))||((typeof(bridge$990$1001)==="number")&&((x$1005=bridge$990$1001),true)))){return ["value",x$1005];}else{var other$1012;(other$1012=$989$996);return other$1012["::serialize_ast"]();}};
var send$808;(send$808=function(obj$813,$811$814){var ph$818;var msg$819;var t0$821;(t0$821=$811$814);(msg$819=t0$821);(ph$818=t0$821);;var $816$825;($816$825=ph$818);;var bridge$817$830;(bridge$817$830=$816$825);if(((typeof(bridge$817$830)==="string")||(typeof(bridge$817$830)==="number"))){return obj$813[msg$819];}else{var other$838;(other$838=$816$825);return obj$813["::send"](msg$819);}});;(Array[":::project"]=function($841$843){var ph$846;var value$847;var t0$849;(t0$849=$841$843);(value$847=t0$849);(ph$846=t0$849);;var $845$853;($845$853=ph$846);;if($968(Array)($845$853)){return [true,value$847];}else{$845$853;return [true,[value$847]];}});(Array.prototype["::check"]=function(value$867){if((value$867 instanceof Array)){var i$872;(i$872=0);;$870:for(;(i$872<this.length);(i$872++)){if(($983(this,i$872)!==$983(value$867,i$872))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$883){if((value$883 instanceof Array)){var i$888;(i$888=0);;$886:for(;(i$888<this.length);(i$888++)){if(($983(this,i$888)!==$983(value$883,i$888))){return [true,[value$883]];}}return [true,value$883.slice(this.length)];}else{return [true,[value$883]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($984));});(RegExp.prototype["::check"]=function($898$900){var ph$903;(ph$903=$898$900);;var $902$908;($902$908=ph$903);;var value$916;if((typeof($902$908)==="string")){(value$916=$902$908);if(value$916.match(this)){return true;}else{return false;}}else{var other$921;(other$921=$902$908);return false;}});(RegExp.prototype[":::project"]=function($923$925){var ph$928;(ph$928=$923$925);;var $927$933;($927$933=ph$928);;var value$941;if((typeof($927$933)==="string")){(value$941=$927$933);var $944$946;($944$946=value$941.match(this));;var m$954;if(($944$946===null)){(m$954=$944$946);return [false,null];}else{var m$959;(m$959=$944$946);return [true,m$959];}}else{var other$963;(other$963=$927$933);return [false,null];}});(Function.prototype["::send"]=function(args$966){return this.apply(this,args$966);});
var $2322=function(obj$2324){var results$2328;(results$2328=[]);;var k$2333;(k$2333=null);$2327:for(k$2333 in obj$2324){if(Object.prototype.hasOwnProperty.call(obj$2324,k$2333)){results$2328.push([k$2333,$983(obj$2324,k$2333)]);}}return results$2328;};
var $2504=function(arr$2506){var results$2510;var l$2511;(results$2510=[]);;(l$2511=arr$2506.length);;var i$2519;(i$2519=0);;$2509:for(;(i$2519<l$2511);(i$2519++)){results$2510.push([i$2519,$983(arr$2506,i$2519)]);}return results$2510;};
var $2526=function(dest$2528,values$2529){var k$2534;(k$2534=null);$2532:for(k$2534 in values$2529){if(values$2529.hasOwnProperty(k$2534)){(dest$2528[k$2534]=values$2529[k$2534]);}}return dest$2528;};
var $2350=function(){var $2351$2353;($2351$2353=function(tags$2357){var it$0$2360;(it$0$2360=function(){if((!$968($2351$2353)(this))){return Object.create($2351$2353.prototype);}else{return this;}}());;(it$0$2360["tags"]=tags$2357);return it$0$2360;});;($2351$2353.prototype["create"]=function(){var $2369$2371;($2369$2371=arguments);;var t0$2376;var message$2380;var args$2381;(t0$2376=$2369$2371.length);if((t0$2376>=0)){(message$2380=function(){if((0>=t0$2376)){return "";}else{return $2369$2371[0];}}());(args$2381=Array.prototype.slice.call($2369$2371,1));var it$0$2385;(it$0$2385=this);;var e$2390;(e$2390=Error(message$2380));;(e$2390["::tags"]=it$0$2385.tags);(e$2390["args"]=args$2381);var temp$2398;(temp$2398=$2504(args$2381));;var $length$2403;($length$2403=temp$2398.length);;var $index$2408;($index$2408=0);;$2391:for(;($index$2408<$length$2403);($index$2408++)){var m$2416;(m$2416=temp$2398[$index$2408]);;var t0$2421;var t1$2422;var i$2426;var arg$2427;(t0$2421=m$2416);if(((t0$2421 instanceof Array)&&((t1$2422=t0$2421.length),(t1$2422===2)))){(i$2426=t0$2421[0]);(arg$2427=t0$2421[1]);(e$2390[i$2426]=arg$2427);}else{$2337(m$2416);;}}(e$2390["length"]=args$2381.length);(e$2390["name"]=["E"].concat(it$0$2385.tags).join("."));return e$2390;}else{$2337($2369$2371);}});($2351$2353.prototype["::check"]=function(e$2438){var it$0$2441;(it$0$2441=this);;var tags$2446;if(((!e$2438)||(!$968(Error)(e$2438)))){return false;}(tags$2446=(e$2438["::tags"]||[]));;var temp$2455;(temp$2455=it$0$2441.tags);;var $length$2460;($length$2460=temp$2455.length);;var $index$2465;($index$2465=0);;$2447:for(;($index$2465<$length$2460);($index$2465++)){var m$2473;(m$2473=temp$2455[$index$2465]);;var tag$2481;(tag$2481=m$2473);if((tags$2446.indexOf(tag$2481)===-1)){return false;}else{false;;}}return true;});($2351$2353.prototype["::deconstruct"]=function(e$2489){var it$0$2492;(it$0$2492=this);;return e$2489.args;});$2526($2351$2353,$2526(function(){var accum$2497;(accum$2497=({}));(accum$2497["::name"]="$2351");return accum$2497;}(),function(){var accum$2501;(accum$2501=({}));(accum$2501["::egclass"]=true);return accum$2501;}()));return $2351$2353;}();
var $2337=function(value$2339,url$2340,start$2341,end$2342){var err$2345;(err$2345=$2350(["match"]).create("Could not find a match for value",({"value":value$2339})));;if(url$2340){(err$2345["location"]=["location",url$2340,start$2341,end$2342]);}throw err$2345;};
var $2538=function(type$2540){return function(value$2543){var f$2546;(f$2546=type$2540[":::project"]);;if((f$2546===(void 0))){var f$2551;(f$2551=type$2540["::project"]);;if((f$2551===(void 0))){return [true,type$2540(value$2543)];}else{var rval$2556;(rval$2556=false);;try{(rval$2556=[true,f$2551(value$2543)]);}catch(excv$2562){var e$2568;(e$2568=excv$2562);(rval$2556=[false,null]);}return rval$2556;}}else{return f$2546.call(type$2540,value$2543);}};};
var $2570=function(){var $2571$2573;($2571$2573=function($2576$2579,$2577$2580){var classes$2582;var children$2583;var t0$2585;(t0$2585=$2538(Array)($2576$2579));if(t0$2585[0]){(classes$2582=t0$2585[1]);;}else{$2337($2576$2579);}var t0$2590;(t0$2590=$2538(Array)($2577$2580));if(t0$2590[0]){(children$2583=t0$2590[1]);;}else{$2337($2577$2580);}var it$0$2595;(it$0$2595=function(){if((!$968($2571$2573)(this))){return Object.create($2571$2573.prototype);}else{return this;}}());;(it$0$2595["classes"]=classes$2582.sort());(it$0$2595["children"]=children$2583);return it$0$2595;});;$2526(function(){var accum$2603;(accum$2603=({}));(accum$2603["::check"]=function(x$2607){return ((x$2607&&x$2607.classes)&&x$2607.children);});return accum$2603;}(),$2526(function(){var accum$2610;(accum$2610=({}));(accum$2610["::deconstruct"]=function(x$2614){return [x$2614.classes,x$2614.children];});return accum$2610;}(),$2526(function(){var accum$2617;(accum$2617=({}));(accum$2617["::name"]="$2571");return accum$2617;}(),function(){var accum$2621;(accum$2621=({}));(accum$2621["::egclass"]=true);return accum$2621;}())));($2571$2573.prototype["::check"]=function(n$2627){var it$0$2630;(it$0$2630=this);;var temp$2639;(temp$2639=it$0$2630.classes);;var $length$2644;($length$2644=temp$2639.length);;var $index$2649;($index$2649=0);;$2635:for(;($index$2649<$length$2644);($index$2649++)){var m$2657;(m$2657=temp$2639[$index$2649]);;var c$2665;(c$2665=m$2657);if((n$2627.classes.indexOf(c$2665)===-1)){return false;}else{false;;}}return true;});$2526($2571$2573,$2526(function(){var accum$2671;(accum$2671=({}));(accum$2671["::check"]=function(x$2675){return ((x$2675&&x$2675.classes)&&x$2675.children);});return accum$2671;}(),$2526(function(){var accum$2678;(accum$2678=({}));(accum$2678["::deconstruct"]=function(x$2682){return [x$2682.classes,x$2682.children];});return accum$2678;}(),$2526(function(){var accum$2685;(accum$2685=({}));(accum$2685["::name"]="$2571");return accum$2685;}(),function(){var accum$2689;(accum$2689=({}));(accum$2689["::egclass"]=true);return accum$2689;}()))));return $2571$2573;}();
var $2692=function($2693$2695,key$2696){var ph$2700;(ph$2700=$2693$2695);;var $2698$2705;($2698$2705=ph$2700);;var bridge$2699$2710;(bridge$2699$2710=$2698$2705);if(((bridge$2699$2710===null)||(bridge$2699$2710===(void 0)))){return false;}else{var x$2718;if((typeof($2698$2705)==="string")){(x$2718=$2698$2705);return (key$2696 in String.prototype);}else{var x$2723;if((typeof($2698$2705)==="number")){(x$2723=$2698$2705);return (key$2696 in Number.prototype);}else{var x$2728;(x$2728=$2698$2705);return (key$2696 in x$2728);}}}};
var $2851=function(obj$2853){var results$2857;(results$2857=[]);;var k$2862;(k$2862=null);$2856:for(k$2862 in obj$2853){if(Object.prototype.hasOwnProperty.call(obj$2853,k$2862)){results$2857.push(k$2862);}}return results$2857;};
var $2730=function($2731$2733,b$2734){var ph$2740;var a$2741;var t0$2743;(t0$2743=$2731$2733);(a$2741=t0$2743);(ph$2740=t0$2743);;var $2736$2747;($2736$2747=ph$2740);;var bridge$2737$2752;if(($2736$2747===b$2734)){return true;}else{(bridge$2737$2752=$2736$2747);if((function(){var bridge$2738$2762;(bridge$2738$2762=bridge$2737$2752);return (function(){var bridge$2739$2765;(bridge$2739$2765=bridge$2738$2762);return ((typeof(bridge$2739$2765)==="number")||(typeof(bridge$2739$2765)==="string"));}()||(bridge$2738$2762===null));}()||(bridge$2737$2752===(void 0)))){return false;}else{if($968(Array)($2736$2747)){if(((!$968(Array)(b$2734))||(a$2741.length!==b$2734.length))){return false;}var i$2776;(i$2776=0);;$2773:for(;(i$2776<a$2741.length);(i$2776++)){if((!$2730(a$2741[i$2776],b$2734[i$2776]))){return false;}}return true;}else{$2736$2747;if(((Object.getPrototypeOf(a$2741)===Object.prototype)&&(Object.getPrototypeOf(b$2734)===Object.prototype))){var ka$2789;(ka$2789=$2851(a$2741));;if((!$2730(ka$2789.sort(),$2851(b$2734).sort()))){return false;}var temp$2798;(temp$2798=ka$2789);;var $length$2803;($length$2803=temp$2798.length);;var $index$2808;($index$2808=0);;$2790:for(;($index$2808<$length$2803);($index$2808++)){var m$2816;(m$2816=temp$2798[$index$2808]);;var k$2824;(k$2824=m$2816);if((!$2730(a$2741[k$2824],b$2734[k$2824]))){return false;}}return true;}else{if($2692($2736$2747,"::serialize")){$2736$2747["::serialize"];var $2831$2833;($2831$2833=b$2734);;if($2692($2831$2833,"::serialize")){$2831$2833["::serialize"];return $2730(a$2741["::serialize"](),b$2734["::serialize"]());}else{var otherwise$2845;(otherwise$2845=$2831$2833);return false;}}else{var otherwise$2849;(otherwise$2849=$2736$2747);return false;}}}}}};
var $2882=function($2883$2885){var ph$2891;var x$2892;var t0$2894;(t0$2894=$2883$2885);(x$2892=t0$2894);(ph$2891=t0$2894);;var $2887$2898;($2887$2898=ph$2891);;var bridge$2888$2903;(bridge$2888$2903=$2887$2898);if((function(){var bridge$2889$2909;(bridge$2889$2909=bridge$2888$2903);return (function(){var bridge$2890$2912;(bridge$2890$2912=bridge$2889$2909);return ((bridge$2890$2912===(void 0))||(bridge$2890$2912===null));}()||(typeof(bridge$2889$2909)==="string"));}()||(typeof(bridge$2888$2903)==="number"))){return x$2892;}else{if($2692($2887$2898,"::clone")){$2887$2898["::clone"];return x$2892["::clone"]();}else{$2887$2898;if((Object.getPrototypeOf(x$2892)===Object.prototype)){var dest$2925;(dest$2925=({}));;var k$2930;(k$2930=null);$2924:for(k$2930 in x$2892){if(Object.prototype.hasOwnProperty.call(x$2892,k$2930)){(dest$2925[k$2930]=x$2892[k$2930]);}}return dest$2925;}else{var other$2936;(other$2936=$2887$2898);throw $2350(["clone"]).create("Object cannot be cloned",({"obj":x$2892}));}}}};
var $2866=function(a$2868,b$2869){var dest$2873;(dest$2873=$2882(a$2868));;var k$2878;(k$2878=null);$2872:for(k$2878 in b$2869){if(Object.prototype.hasOwnProperty.call(b$2869,k$2878)){(dest$2873[k$2878]=b$2869[k$2878]);}}return dest$2873;};var accum$2229;var accum$2233;var kb$1021;var eg$1022;var $1017$1023;var GenSym$1024;var $1018$1025;var Location$1026;var highlight_locations$1027;var format_error$1028;var $1019$1029;var tokenize$1030;var $1020$1031;var parse$1032;var gensym$1033;var create_node$1034;var make_dom$1035;var mktable$1036;var mktable2$1037;var repr$1038;var goto_end$1039;var _insert_before_caret$1040;var insert_before_caret$1041;var Repl$1042;var make_cards$1043;(kb$1021=require("./kb"));;(eg$1022=require("../lib/earl-grey"));;($1017$1023=require("../lib/util"));;(GenSym$1024=$1017$1023.GenSym);;($1018$1025=require("../lib/location"));;(Location$1026=$1018$1025.Location);;(highlight_locations$1027=$1018$1025.highlight_locations);;(format_error$1028=$1018$1025.format_error);;($1019$1029=require("../lib/lex"));;(tokenize$1030=$1019$1029.tokenize);;($1020$1031=require("../lib/parse"));;(parse$1032=$1020$1031.parse);;(gensym$1033=GenSym$1024("io_"));;(create_node$1034=function(tag$1086,kv$1087,contents$1088){var $index$1111;var $length$1106;var temp$1101;var $index$1148;var $length$1143;var temp$1138;var node$1091;(node$1091=document.createElement(tag$1086));;(temp$1101=$2322(kv$1087));;($length$1106=temp$1101.length);;($index$1111=0);;$1092:for(;($index$1111<$length$1106);($index$1111++)){var k$1129;var v$1130;var t0$1124;var t1$1125;var m$1119;(m$1119=temp$1101[$index$1111]);;(t0$1124=m$1119);if(((t0$1124 instanceof Array)&&((t1$1125=t0$1124.length),(t1$1125===2)))){(k$1129=t0$1124[0]);(v$1130=t0$1124[1]);(node$1091[k$1129]=v$1130);}else{$2337(m$1119,"/home/olivier/git/egrepl/src/repl.eg",1782,1829);;}}(temp$1138=$2538(Array)(contents$1088)[1]);;($length$1143=temp$1138.length);;($index$1148=0);;$1094:for(;($index$1148<$length$1143);($index$1148++)){var other$1170;var s$1165;var t0$1161;var m$1156;(m$1156=temp$1138[$index$1148]);;(t0$1161=m$1156);if((typeof(t0$1161)==="string")){(s$1165=t0$1161);node$1091.appendChild(document.createTextNode(s$1165));}else{(other$1170=m$1156);node$1091.appendChild(other$1170);}}return node$1091;});;(make_dom$1035=function(){var $index$1226;var $length$1221;var temp$1216;var node$1208;var $index$1293;var $length$1288;var temp$1283;var $index$1363;var $length$1358;var temp$1353;var $index$1417;var $length$1412;var temp$1407;var acc$1402;var $index$1461;var $length$1456;var temp$1451;var acc$1446;var other$1441;var $1252$1389;var tag$1253;var _classes$1254;var id$1255;var kv$1256;var sub$1257;var node$1258;var other$1481;var classes$1246;var children$1247;var args$1204;var s$1199;var $1178$1196;var t0$1194;var default_tag$1189;var $1177$1190;var t0$1185;var $1176$1180;($1176$1180=arguments);;(t0$1185=$1176$1180.length);if(((t0$1185>=1)&&(t0$1185<=2))){($1177$1190=$1176$1180[0]);(default_tag$1189=function(){if((1>=t0$1185)){return "div";}else{return $1176$1180[1];}}());(t0$1194=$1177$1190);if((typeof(t0$1194)==="string")){(s$1199=t0$1194);return document.createTextNode(s$1199);}else{if($968(Array)(t0$1194)){(args$1204=t0$1194);(node$1208=document.createElement("span"));;(temp$1216=args$1204);;($length$1221=temp$1216.length);;($index$1226=0);;$1209:for(;($index$1226<$length$1221);($index$1226++)){var arg$1242;var m$1234;(m$1234=temp$1216[$index$1226]);;(arg$1242=m$1234);node$1208.appendChild(make_dom$1035(arg$1242,default_tag$1189));}return node$1208;}else{if(($968($2570)(t0$1194)&&($2692(t0$1194,"classes")&&((classes$1246=t0$1194.classes),$2692(t0$1194,"children"))))){(children$1247=t0$1194.children);(tag$1253=default_tag$1189);;(_classes$1254=[]);;(id$1255=null);;(kv$1256=[]);;(sub$1257=[]);;(temp$1283=classes$1246);;($length$1288=temp$1283.length);;($index$1293=0);;$1259:for(;($index$1293<$length$1288);($index$1293++)){var s$1341;var m$1334;var m$1327;var k$1322;var k$1315;var v$1316;var $1261$1310;var $1262$1311;var $1263$1312;var t0$1306;var t1$1307;var t2$1308;var m$1301;(m$1301=temp$1283[$index$1293]);;(t0$1306=m$1301);if((($1262$1311=(t0$1306 instanceof Array))&&((t1$1307=t0$1306.length),((t1$1307===3)&&(t0$1306[0]==="assoc"))))){(k$1315=t0$1306[1]);(v$1316=t0$1306[2]);kv$1256.push([k$1315,v$1316]);}else{if(($1262$1311&&((t1$1307===2)&&(t0$1306[0]==="assoc")))){(k$1322=t0$1306[1]);kv$1256.push([k$1322,(void 0)]);}else{(t0$1306=$2538(RegExp("(?:^\\+((?:.*)))",""))(m$1301));if((t0$1306[0]&&((t1$1307=t0$1306[1]),((t2$1308=t1$1307.length),(t2$1308===2))))){t1$1307[0];(m$1327=t1$1307[1]);(tag$1253=m$1327);}else{(t0$1306=$2538(RegExp("(?:^#((?:.*)))",""))(m$1301));if((t0$1306[0]&&((t1$1307=t0$1306[1]),((t2$1308=t1$1307.length),(t2$1308===2))))){t1$1307[0];(m$1334=t1$1307[1]);(id$1255=m$1334);}else{(t0$1306=m$1301);if((typeof(t0$1306)==="string")){(s$1341=t0$1306);_classes$1254.push(s$1341);}else{$2337(m$1301,"/home/olivier/git/egrepl/src/repl.eg",2357,2678);;}}}}}}(node$1258=document.createElement(tag$1253));;if(id$1255){(node$1258["id"]=id$1255);}if(_classes$1254.length){(node$1258["className"]=_classes$1254.join(" "));}(temp$1353=kv$1256);;($length$1358=temp$1353.length);;($index$1363=0);;$1264:for(;($index$1363<$length$1358);($index$1363++)){var k$1381;var v$1382;var t0$1376;var t1$1377;var m$1371;(m$1371=temp$1353[$index$1363]);;(t0$1376=m$1371);if(((t0$1376 instanceof Array)&&((t1$1377=t0$1376.length),(t1$1377===2)))){(k$1381=t0$1376[0]);(v$1382=t0$1376[1]);(node$1258[k$1381]=v$1382);}else{$2337(m$1371,"/home/olivier/git/egrepl/src/repl.eg",2827,2874);;}}($1252$1389=tag$1253);;if(($1252$1389==="raw")){(acc$1402=[]);;(temp$1407=children$1247);;($length$1412=temp$1407.length);;($index$1417=0);;$1399:for(;($index$1417<$length$1412);($index$1417++)){var s$1434;var t0$1430;var m$1425;(m$1425=temp$1407[$index$1417]);;(t0$1430=m$1425);if((typeof(t0$1430)==="string")){(s$1434=t0$1430);acc$1402.push((node$1258["innerHTML"]=s$1434));}else{$2337(m$1425,"/home/olivier/git/egrepl/src/repl.eg",2901,3003);;}}acc$1402;}else{(other$1441=$1252$1389);(acc$1446=[]);;(temp$1451=children$1247);;($length$1456=temp$1451.length);;($index$1461=0);;$1443:for(;($index$1461<$length$1456);($index$1461++)){var c$1477;var m$1469;(m$1469=temp$1451[$index$1461]);;(c$1477=m$1469);acc$1446.push(node$1258.appendChild(make_dom$1035(c$1477,default_tag$1189)));}acc$1446;}return node$1258;}else{(other$1481=$1177$1190);return make_dom$1035([true,String(other$1481)][1]);}}}}else{$2337($1176$1180);}});;(mktable$1036=function(){var other$1522;var $1508$1510;var $index$1543;var $length$1538;var temp$1533;var acc$1528;var its$1505;var x$1500;var recur$1501;var t0$1496;var $1489$1491;($1489$1491=arguments);;(t0$1496=$1489$1491.length);if(((t0$1496>=1)&&(t0$1496<=2))){(x$1500=$1489$1491[0]);(recur$1501=function(){if((1>=t0$1496)){return repr$1038;}else{return $1489$1491[1];}}());(its$1505=((($1508$1510=x$1500)),function(){if($968(Array)($1508$1510)){return x$1500;}else{(other$1522=$1508$1510);return $2322(x$1500);}}()));;if(its$1505.length){return $2570(["+table","object"],(((acc$1528=[])),(((temp$1533=its$1505)),((($length$1538=temp$1533.length)),((($index$1543=0)),function(){$1525:for(;($index$1543<$length$1538);($index$1543++)){var k$1561;var v$1562;var t0$1556;var t1$1557;var m$1551;(m$1551=temp$1533[$index$1543]);;(t0$1556=m$1551);if(((t0$1556 instanceof Array)&&((t1$1557=t0$1556.length),(t1$1557===2)))){(k$1561=t0$1556[0]);(v$1562=t0$1556[1]);acc$1528.push($2570(["+tr"],[$2570(["+th"],recur$1501(k$1561,repr$1038)),$2570(["+td"],recur$1501(v$1562,repr$1038))]));}else{$2337(m$1551,"/home/olivier/git/egrepl/src/repl.eg",3297,3431);;}}}()))),acc$1528));}else{return $2570(["object","empty"],[]);}}else{$2337($1489$1491);}});;(mktable2$1037=function(){var other$1607;var $1593$1595;var $index$1628;var $length$1623;var temp$1618;var acc$1613;var its$1590;var x$1585;var recur$1586;var t0$1581;var $1574$1576;($1574$1576=arguments);;(t0$1581=$1574$1576.length);if(((t0$1581>=1)&&(t0$1581<=2))){(x$1585=$1574$1576[0]);(recur$1586=function(){if((1>=t0$1581)){return repr$1038;}else{return $1574$1576[1];}}());(its$1590=((($1593$1595=x$1585)),function(){if($968(Array)($1593$1595)){return x$1585;}else{(other$1607=$1593$1595);return $2322(x$1585);}}()));;return $2570(["+table"],(((acc$1613=[])),(((temp$1618=its$1590)),((($length$1623=temp$1618.length)),((($index$1628=0)),function(){$1610:for(;($index$1628<$length$1623);($index$1628++)){var k$1646;var v$1647;var t0$1641;var t1$1642;var m$1636;(m$1636=temp$1618[$index$1628]);;(t0$1641=m$1636);if(((t0$1641 instanceof Array)&&((t1$1642=t0$1641.length),(t1$1642===2)))){(k$1646=t0$1641[0]);(v$1647=t0$1641[1]);acc$1613.push($2570(["+tr"],[$2570(["+th"],recur$1586(k$1646,repr$1038)),$2570(["+td"],recur$1586(v$1647,repr$1038))]));}else{$2337(m$1636,"/home/olivier/git/egrepl/src/repl.eg",3561,3666);;}}}()))),acc$1613));}else{$2337($1574$1576);}});;(repr$1038=function(){var $index$1746;var $length$1741;var temp$1736;var acc$1731;var other$1792;var f$1787;var n$1766;var entries$1725;var $1661$1688;var $1662$1689;var t0$1685;var t1$1686;var x$1675;var recur$1676;var $1660$1677;var t0$1669;var t1$1670;var t2$1671;var $1659$1664;($1659$1664=arguments);;(t0$1669=$1659$1664.length);if((((t0$1669>=1)&&(t0$1669<=2))&&((t1$1670=$1659$1664[0]),((x$1675=t1$1670),(($1660$1677=t1$1670),((t2$1671=function(){if((1>=t0$1669)){return repr$1038;}else{return $1659$1664[1];}}()),$968(Function)(t2$1671))))))){(recur$1676=t2$1671);if(($1660$1677===true)){return $2570(["special","true"],"true");}else{if(($1660$1677===false)){return $2570(["special","false"],"false");}else{if(($1660$1677===null)){return $2570(["special","nil"],"null");}else{if(($1660$1677===(void 0))){return $2570(["special","nil"],"undefined");}else{if((typeof($1660$1677)==="number")){return $2570(["num"],String(x$1675));}else{if(($1660$1677==="")){return $2570(["str","empty"],[]);}else{if((typeof($1660$1677)==="string")){return $2570(["str"],x$1675);}else{(t0$1685=$1660$1677);if((($1662$1689=$968(Array)(t0$1685))&&((t1$1686=t0$1685.length),(t1$1686===0)))){return $2570(["sequence","empty"],[]);}else{if($1662$1689){(entries$1725=t0$1685);return $2570(["sequence"],(((acc$1731=[])),(((temp$1736=entries$1725)),((($length$1741=temp$1736.length)),((($index$1746=0)),function(){$1728:for(;($index$1746<$length$1741);($index$1746++)){var x$1762;var m$1754;(m$1754=temp$1736[$index$1746]);;(x$1762=m$1754);acc$1731.push(recur$1676(x$1762,repr$1038));}}()))),acc$1731));}else{if($968($2570)(t0$1685)){(n$1766=t0$1685);return n$1766;}else{$1660$1677;if(x$1675["::repr"]){return x$1675["::repr"](recur$1676);}else{if((Object.getPrototypeOf(x$1675)===Object.prototype)){return mktable$1036(x$1675);}else{if((x$1675.constructor&&x$1675.constructor["::egclass"])){return $2570(["instance"],[$2570(["classname"],x$1675.constructor["::name"]),mktable$1036(x$1675)]);}else{if(x$1675["::egclass"]){return $2570(["class"],[$2570(["classname"],("Class "+x$1675["::name"])),mktable$1036(x$1675.prototype)]);}else{(t0$1685=$1660$1677);if($968(Function)(t0$1685)){(f$1787=t0$1685);return $2570(["function"],function(){if(f$1787.name){return f$1787.name;}else{return "<anonymous>";}}());}else{(other$1792=$1660$1677);return $2570(["unknown"],other$1792.toString());}}}}}}}}}}}}}}}}else{$2337($1659$1664);}});;(goto_end$1039=function(elem$1800){var range$1803;var selection$1804;(range$1803=document.createRange());;range$1803.selectNodeContents(elem$1800);range$1803.collapse(false);(selection$1804=window.getSelection());;selection$1804.removeAllRanges();return selection$1804.addRange(range$1803);});;(_insert_before_caret$1040=function(text$1815){var other$1836;var $1822$1824;var it$0$1848;var it$0$1854;var range$1843;var node$1818;var sel$1819;(node$1818=((($1822$1824=text$1815)),function(){if((typeof($1822$1824)==="string")){return document.createTextNode(text$1815);}else{(other$1836=$1822$1824);return other$1836;}}()));;(sel$1819=window.getSelection());;if(sel$1819.rangeCount){(range$1843=sel$1819.getRangeAt(0));;(it$0$1848=range$1843);;it$0$1848.collapse(false);it$0$1848.insertNode(node$1818);(range$1843=range$1843.cloneRange());(it$0$1854=range$1843);;it$0$1854.selectNodeContents(node$1818);it$0$1854.collapse(false);sel$1819.removeAllRanges();sel$1819.addRange(range$1843);return console.log(range$1843);}});;(insert_before_caret$1041=function(text$1863){var rval$1866;(rval$1866=false);;try{(rval$1866=_insert_before_caret$1040(text$1863));}catch(excv$1872){var e$1878;(e$1878=excv$1872);(rval$1866=console.log(e$1878));}return rval$1866;});;(Error.prototype["::repr"]=function(){return format_error$1028(this);});(Repl$1042=function(box$1886,target$1887,input$1888,evaluator$1889){var it$0$1892;(it$0$1892=function(){if((!$968(Repl$1042)(this))){return Object.create(Repl$1042.prototype);}else{return this;}}());;(it$0$1892["url"]="<repl>");(it$0$1892["gen"]=eg$1022.Generator());(it$0$1892["evaluator"]=evaluator$1889);(it$0$1892["box"]=box$1886);(it$0$1892["target"]=target$1887);(it$0$1892["input"]=input$1888);(it$0$1892["multiline"]=false);(it$0$1892["interactor"]=kb$1021.Interactor(({})));it$0$1892.set_multiline(false);it$0$1892.interactor.install(it$0$1892.input);(it$0$1892["cursor"]=0);(it$0$1892["history"]=[""]);return it$0$1892;});;(Repl$1042.prototype["sink"]=function(){var it$0$1904;(it$0$1904=this);;return jQuery(it$0$1904.box).scrollTop(it$0$1904.box.scrollHeight);});(Repl$1042.prototype["add_to_history"]=function(text$1911){var hl$1919;var it$0$1914;(it$0$1914=this);;(hl$1919=it$0$1914.history.length);;if(((text$1911!=="")&&(!((hl$1919>1)&&$2730($983(it$0$1914.history,(hl$1919-2)),text$1911))))){(it$0$1914.history[(hl$1919-1)]=text$1911);it$0$1914.history.push("");}return (it$0$1914["cursor"]=(it$0$1914.history.length-1));});(Repl$1042.prototype["submit"]=function(){var text$1934;var it$0$1929;(it$0$1929=this);;it$0$1929.set_multiline(false);(text$1934=it$0$1929.input.textContent);;it$0$1929.process(text$1934);(it$0$1929.input["innerHTML"]="");return it$0$1929.sink();});(Repl$1042.prototype["begin_multiline"]=function(){var it$0$1943;(it$0$1943=this);;it$0$1943.set_multiline(true);goto_end$1039(it$0$1943.input);insert_before_caret$1041("\n   ");return it$0$1943.sink();});(Repl$1042.prototype["set_multiline"]=function(x$1951){var accum$1985;var accum$1991;var accum$2003;var accum$2010;var accum$2017;var accum$2044;var accum$2051;var accum$2057;var accum$2064;var previous$1967;var next$1968;var common$1969;var $1954$1960;var it$0$1955;(it$0$1955=this);;($1954$1960=x$1951);;(previous$1967=function(){if((it$0$1955.cursor>0)){(it$0$1955.input["textContent"]=$983(it$0$1955.history,(--it$0$1955.cursor)));goto_end$1039(it$0$1955.input);return it$0$1955.sink();}});;(next$1968=function(){if((it$0$1955.cursor<(it$0$1955.history.length-1))){(it$0$1955.input["textContent"]=$983(it$0$1955.history,(++it$0$1955.cursor)));goto_end$1039(it$0$1955.input);return it$0$1955.sink();}});;(common$1969=$2526(((accum$1985=({})),((accum$1985["C-l"]=function(){return jQuery(it$0$1955.target).empty();}),accum$1985)),((accum$1991=({})),((accum$1991["S-Enter"]=function(){return it$0$1955.submit();}),accum$1991))));;if(($1954$1960===false)){jQuery(it$0$1955.input).removeClass("multiline");return it$0$1955.interactor.set_bindings($2866(common$1969,$2526(((accum$2003=({})),((accum$2003["C-m"]=function(){it$0$1955.set_multiline(true);return "break";}),accum$2003)),$2526(((accum$2010=({})),((accum$2010["C-Enter"]=function(){it$0$1955.begin_multiline();return "break";}),accum$2010)),$2526(((accum$2017=({})),((accum$2017["Enter"]=function(){var other$2036;var $2022$2024;($2022$2024=it$0$1955.input.textContent);;if($968(RegExp("(=|->|%|:|with|where|each)$",""))($2022$2024)){return it$0$1955.begin_multiline();}else{(other$2036=$2022$2024);return it$0$1955.submit();}}),accum$2017)),({"Up":previous$1967,"Down":next$1968}))))));}else{if(($1954$1960===true)){jQuery(it$0$1955.input).addClass("multiline");return it$0$1955.interactor.set_bindings($2866(common$1969,$2526(((accum$2044=({})),((accum$2044["C-m"]=function(){it$0$1955.set_multiline(false);return "break";}),accum$2044)),$2526(((accum$2051=({})),((accum$2051["C-Enter"]=function(){return it$0$1955.submit();}),accum$2051)),$2526(((accum$2057=({})),((accum$2057["Enter"]=function(){insert_before_caret$1041("\n");return it$0$1955.sink();}),accum$2057)),((accum$2064=({})),((accum$2064["Tab"]=function(){return insert_before_caret$1041("   ");}),accum$2064)))))));}else{$2337($1954$1960);}}});(Repl$1042.prototype["generate"]=function(text$2074){var it$0$2077;(it$0$2077=this);;return it$0$2077.gen.generate(eg$1022.Source(text$2074,it$0$2077.url));});(Repl$1042.prototype["eval"]=function(text$2084){var rval$2111;var gen$2092;var handle$2093;var it$0$2087;(it$0$2087=this);;(gen$2092=function(){var g$2099;(g$2099=it$0$2087.generate(text$2084));;return ["success",it$0$2087.evaluator(g$2099)];});;(handle$2093=function(e$2107){return ["failure",e$2107];});;(rval$2111=false);;try{(rval$2111=gen$2092());}catch(excv$2117){var e$2123;(e$2123=excv$2117);(rval$2111=handle$2093(e$2123));}return rval$2111;});(Repl$1042.prototype["process"]=function(){var error$2199;var value$2194;var n$2188;var $2160$2173;var $2161$2174;var $2162$2175;var $2163$2176;var t0$2170;var t1$2171;var $2159$2165;var real_text$2149;var node$2150;var name$2151;var collapse$2152;var on$2153;var it$0$2144;var text$2139;var display_in$2140;var t0$2135;var $2128$2130;($2128$2130=arguments);;(t0$2135=$2128$2130.length);if(((t0$2135>=1)&&(t0$2135<=2))){(text$2139=$2128$2130[0]);(display_in$2140=function(){if((1>=t0$2135)){return true;}else{return $2128$2130[1];}}());(it$0$2144=this);;it$0$2144.add_to_history(text$2139);(real_text$2149=(("\n"+text$2139)+"\n"));;(node$2150=make_dom$1035($2570(["io"],[function(){if(display_in$2140){return $2570(["in"],[$2570(["inbanner"],[]),$2570(["entry"],text$2139)]);}else{return "";}}(),((($2159$2165=it$0$2144.eval(real_text$2149))),($2159$2165,function(){if((text$2139&&(text$2139.trim()===""))){return "";}else{if((($2160$2173=($2159$2165 instanceof Array))&&((t0$2170=$2159$2165.length),(($2162$2175=(t0$2170===2))&&(($2163$2176=($2159$2165[0]==="success"))&&($2159$2165[1]===(void 0))))))){return "";}else{if(($2163$2176&&((t1$2171=$2159$2165[1]),$968($2570)(t1$2171)))){(n$2188=t1$2171);return $2570(["display"],[$2570(["displaybanner"],[]),$2570(["result"],n$2188)]);}else{if($2163$2176){(value$2194=$2159$2165[1]);return $2570(["out"],[$2570(["outbanner"],[]),$2570(["result"],$2570(["eg"],repr$1038(value$2194)))]);}else{if(($2162$2175&&($2159$2165[0]==="failure"))){(error$2199=$2159$2165[1]);return $2570(["err"],[$2570(["errbanner"],[]),$2570(["result"],$2570(["eg"],repr$1038(error$2199)))]);}else{$2337($2159$2165);}}}}}}()))])));;(name$2151=gensym$1033());;(node$2150["id"]=name$2151);it$0$2144.target.appendChild(node$2150);(collapse$2152=function(e$2211){var at_top$2214;e$2211.stopPropagation();(at_top$2214=$2730((it$0$2144.box.scrollTop+jQuery(it$0$2144.box).height()),it$0$2144.box.scrollHeight));;jQuery(this).toggleClass("collapsed");if(at_top$2214){return jQuery(it$0$2144.box).scrollTop(it$0$2144.box.scrollHeight);}});;(on$2153=function(sel$2223){return jQuery(((("#"+name$2151)+" ")+sel$2223));});;on$2153(".sequence").addClass("complex");on$2153(".object").addClass("complex");on$2153(".complex").click(collapse$2152);on$2153(".complex .complex .complex").addClass("collapsed");on$2153(".error_args.syntax").addClass("collapsed").click(collapse$2152);return on$2153(".traceback").addClass("collapsed").click(collapse$2152);}else{$2337($2128$2130);}});$2526(Repl$1042,$2526(((accum$2229=({})),((accum$2229["::name"]="Repl"),accum$2229)),((accum$2233=({})),((accum$2233["::egclass"]=true),accum$2233))));Repl$1042;(make_cards$1043=function(repl$2239){var clickable$2242;var clickable_row$2243;(clickable$2242=function(text$2247){var click$2250;(click$2250=function(e$2254){e$2254.preventDefault();repl$2239.process(text$2247);repl$2239.sink();return jQuery(repl$2239.input).focus();});;return $2570(["clickable",["assoc","onclick",click$2250]],text$2247);});;(clickable_row$2243=function(){var $index$2294;var $length$2289;var temp$2284;var acc$2279;var items$2273;var t0$2269;var $2262$2264;($2262$2264=arguments);;(t0$2269=$2262$2264.length);if((t0$2269>=0)){(items$2273=Array.prototype.slice.call($2262$2264,0));return $2570(["+span"],(((acc$2279=[])),(((temp$2284=items$2273)),((($length$2289=temp$2284.length)),((($index$2294=0)),function(){$2276:for(;($index$2294<$length$2289);($index$2294++)){var item$2315;var item$2310;var m$2302;(m$2302=temp$2284[$index$2294]);;(item$2310=m$2302);if(($index$2294===0)){acc$2279.push(clickable$2242(item$2310));}else{(item$2315=m$2302);acc$2279.push($2570(["+span"],[$2570(["+span","separator"],""),clickable$2242(item$2315)]));}}}()))),acc$2279));}else{$2337($2262$2264);}});;return [$2570(["card"],[$2570(["+h3"],"Keyboard controls"),mktable2$1037([[$2570(["+code"],"Up/Down"),"Navigate history"],[$2570(["+code"],"Enter/Shift-Enter"),"Evaluate an expression"],[$2570(["+code"],"Control-l"),"Clear the screen"],[$2570(["+code"],"Control-m"),"Toggle mulitline mode"]]),"Type ",clickable$2242("next")," to continue with the tutorial"]),$2570(["card"],[$2570(["+h3"],"Basics"),$2570([],["Click on boxes like ",clickable$2242("this")," to evaluate their contents."]),$2570(["+h4"],"Strings"),$2570(["+span"],clickable_row$2243("\"hello world\"",".word","\"My name is \\\"Olivier\\\"\"")),$2570(["+h4"],"Numbers"),mktable2$1037([[$2570([],"Decimal"),clickable_row$2243("1","1.4","4.93e51")],[$2570([],"Hex"),clickable_row$2243("16rFF","16r100","16rDEADBEEF","16r0.8")],[$2570([],"Binary etc."),clickable_row$2243("2r1110","3r20","36rZAZZ")]]),$2570(["+h4"],"Function calls"),mktable2$1037([[$2570([],"Call"),clickable_row$2243("alert{\"Hello!\"}","alert with \"Hello!\"")],[$2570([],"Methods"),clickable_row$2243("\"hello\".substring{1}")]]),clickable$2242("next")," => variables"]),$2570(["card"],[$2570(["+h3"],"Variables"),$2570([],["There are separate operators for declaration and assignment. ","A variable cannot be assigned to before it is declared."]),$2570(["+table"],[$2570(["+tr"],[$2570(["+td"],[$2570(["+b"],"Declare")," a variable"]),$2570(["+td"],clickable$2242("x = 1234"))]),$2570(["+tr"],[$2570(["+td"],[$2570(["+b"],"Set")," an existing variable"]),$2570(["+td"],clickable$2242("x := 999"))]),$2570(["+tr"],[$2570(["+td"],[$2570(["+b"],"Use")," your variable!"]),$2570(["+td"],clickable$2242("x + x"))])]),$2570([],["You can create blocks with their own local variables using ",$2570(["+code"],"[]"),", ",$2570(["+code"],"let")," or ",$2570(["+code"],"where")]),$2570([],clickable$2242("[a = 10, b = 90, a + b]")),$2570([],clickable$2242("let [a = 10, b = 90]: a + b")),$2570([],clickable$2242("a + b where\n   a = 10\n   b = 90")),$2570([],["Be aware that ",$2570(["+code"],"[]")," only creates a block"," when it encloses more than one expression."]),$2570([],["An indented block is completely equivalent to ","wrapping it in ",$2570(["+code"],"[]"),"s"]),clickable$2242("next")," => data structures"]),$2570(["card"],[$2570(["+h3"],"Data structures"),$2570([],["Earl Grey uses curly braces ",$2570(["+code"],"{}")," to define all data structures."]),mktable2$1037([[$2570([],"Arrays"),clickable_row$2243("{1, 2, 3}","{1, {2, 3}}","{\"hello\"}")],[$2570([],"Objects"),clickable_row$2243("{name = .Peter, age = 20}","{\"a\" => 123}")]]),$2570([],["The empty array is ",clickable$2242("{}")," and the empty object is ",clickable$2242("{=}")]),$2570(["+h4"],"Deconstruction"),$2570([],"You can extract array elements and object fields into variables directly."),$2570([],clickable$2242("{x, y} = {11, 22}")),$2570([],clickable$2242("{x, *rest, y} = {111, 222, 333, 444}")),$2570([],clickable$2242("{=> name} = {name = .Peter, age = 20}")),$2570(["+h4"],"Operations"),mktable2$1037([[$2570([],"Concatenation"),clickable$2242("{1, 2} ++ {3, 4, 5}")],[$2570([],"Object fusion"),clickable$2242("{name = .Kim} & {age = 39}")]]),clickable$2242("next")," => control structures"]),$2570(["card"],[$2570(["+h3"],"Control structures"),$2570([],[$2570(["+code"],"if")," and ",$2570(["+code"],"while")," are available."]),$2570([],clickable$2242("if [13 > 0]:\n   then: \"This number is positive!\"\n   else: \"This number is negative!\"\n")),$2570([],clickable$2242("i = 3\nwhile [i > 0]:\n   alert{i}\n   i--\n")),$2570([],["Notice that both branches of ",$2570(["+code"],"if")," must be nested."," The expression form of ",$2570(["+code"],"if")," is simply ",clickable$2242("if{1, .yes, .no}")]),clickable$2242("next")," => control structures [2]"]),$2570(["card"],[$2570(["+h3"],"Control structures [2]"),$2570([],["Earl Grey's ",$2570(["+code"],"if")," nests poorly, so if you want to ","write many clauses use ",$2570(["+code"],"match")]),$2570([],clickable$2242("x = 13\nmatch:\n   when x > 0 -> .positive\n   when x < 0 -> .negative\n   when x == 0 -> .zero\n")),$2570([],"You can also match on the variable directly!"),$2570([],clickable$2242("x = 13\nmatch x:\n   > 0 -> .positive\n   < 0 -> .negative\n   0 -> .zero\n")),$2570([],["The left hand side of the arrow is a special pattern matching"," language, whereas ",$2570(["+code"],"when")," takes a standard expression."]),clickable$2242("next")," => each"]),$2570(["card"],[$2570(["+h3"],"each"),$2570([],["A single operator serves both looping over data structures"," and list comprehensions."]),$2570([],clickable$2242("{1, 2, 3} each i -> -i")),$2570([],clickable$2242("1..10 each i -> i * i")),$2570([],clickable$2242("1..10 each i when i mod 2 == 0 -> i")),$2570([],"You can have more than one clause"),$2570([],clickable$2242("{1, 2, .hello, 4, 72, 99, {}} each\n   String? s -> {s, .string}\n   Number? i when i mod 2 == 0 -> {i, .even}\n   Number? i when i mod 2 == 1 -> {i, .odd}\n   x -> {x, .dunno}\n")),$2570([],[$2570(["+code"],"first")," and ",$2570(["+code"],"last")," are special patterns"]),$2570([],clickable$2242("acc = \"\"\n{.a, .b, .c, .d} each\n   first x -> acc += \"[\" + x\n   last x -> acc += \", \" + x + \"]\"\n   x -> acc += \", \" + x\nacc\n")),$2570([],"Be careful to put the catchall clause last."),clickable$2242("next")," => functions"]),$2570(["card"],[$2570(["+h3"],"Functions"),$2570([],["Functions are declared with ",$2570(["+code"],"=")," or ",$2570(["+code"],"->"),". For instance the following are equivalent"]),$2570([],clickable$2242("f{x, y} = [x * x + y * y] ** 0.5")),$2570([],clickable$2242("f = {x, y} -> [x * x + y * y] ** 0.5")),$2570([],"It works inside object definitions as well, of course"),$2570([],clickable$2242("{add1{x} = x + 1, add2{x} = x + 2}")),$2570([],["Pattern matching is deeply integrated in Earl Grey. ","For instance:"]),$2570([],clickable$2242("fact{match} =\n   0 or 1 -> 1\n   n -> n * fact{n - 1}\n")),clickable$2242("next")," => type checking and coercion"]),$2570(["card"],[$2570(["+h3"],"Type checking and coercion"),mktable2$1037([[$2570([],"Type checking"),clickable_row$2243("String? .hello","Number? 1","Array? .nope","R\"x$\"? .simplex")],[$2570([],"Coercion"),clickable_row$2243("String! {1, 2}","Number! \"3.14\"","Array! .yep")]]),$2570([],["Both type checking and coercion can be used in patterns."," Observe the difference in behavior of the following functions "," (try on ",clickable$2242("f{1, \"2\"}"),")"]),$2570([],clickable$2242("f{x, y} = x + y")),$2570([],clickable$2242("f{Number? x, Number? y} = x + y")),$2570([],clickable$2242("f{Number! x, Number! y} = x + y")),$2570([],["Functions naturally act as coercers: ",clickable$2242("parseInt! x = \"99\"")]),$2570(["+h4"],"Predicates"),$2570([],["You can create your own predicates with the ",$2570(["+code"],"predicate")," builtin"]),$2570([],clickable$2242("predicate! even{x} = x mod 2 == 0")),$2570([],clickable_row$2243("even? x = 1","even? x = 2")),clickable$2242("next")," => classes"]),$2570(["card"],[$2570(["+h3"],"Classes"),$2570([],["Classes are declared with the ",$2570(["+code"],"class")," macro. As a convenience, @ can be used to"," refer to fields and members of the instance."]),$2570([],clickable$2242("class Person:\n   constructor{name, age, job} =\n      @name := name\n      @age := age\n      @job := job\n   hello{} =\n      \"Hello, I am \" + @name + \", \" + @age + \", and I am a \" + @job\n")),$2570([],["The ",$2570(["+code"],"new")," keyword is optional."," I prefer to avoid it."]),$2570([],clickable$2242("Person{.Sonia, 25, .baker}")),$2570([],clickable$2242("Person{.Jack, 56, \"serial murderer\"}.hello{}")),clickable$2242("next")," => HTML generation"]),$2570(["card"],[$2570(["+h3"],"Here, let's have some fun"),$2570([],["The ",$2570(["+code"],"%")," operator creates structured data"," which is directly translated as HTML."]),$2570([],clickable_row$2243("b % .hello","i % .hello")),$2570([],"We can print out a multiplication table!"),$2570([],clickable_row$2243("table % 1..10 each i ->\n   tr % 1..10 each j ->\n      td % i * j\n"))]),$2570(["card"],[$2570(["+h3"],"The end"),$2570([],["This is the end of this humble tutorial,"," but you can keep messing around with the language,"," it's a lot of fun :)"])])];});;(exports["Repl"]=Repl$1042);(exports["Interactor"]=kb$1021.Interactor);(exports["parse"]=parse$1032);(exports["tokenize"]=tokenize$1030);(exports["Source"]=eg$1022.Source);(exports["make_cards"]=make_cards$1043);

},{"../lib/earl-grey":4,"../lib/lex":6,"../lib/location":7,"../lib/parse":9,"../lib/util":14,"./kb":1}],"repl":[function(require,module,exports){
module.exports=require('eXk3/i');
},{}],4:[function(require,module,exports){
var $184=function(type$186){var f$189;(f$189=type$186["::check"]);;if((f$189===(void 0))){return function(value$194){return (value$194 instanceof type$186);};}else{return function(value$197){return f$189.call(type$186,value$197);};}};
var $199=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $200=function($201$203){var ph$207;(ph$207=$201$203);;var $205$212;($205$212=ph$207);;var bridge$206$217;var x$221;(bridge$206$217=$205$212);if((((typeof(bridge$206$217)==="string")&&((x$221=bridge$206$217),true))||((typeof(bridge$206$217)==="number")&&((x$221=bridge$206$217),true)))){return ["value",x$221];}else{var other$228;(other$228=$205$212);return other$228["::serialize_ast"]();}};
var send$24;(send$24=function(obj$29,$27$30){var ph$34;var msg$35;var t0$37;(t0$37=$27$30);(msg$35=t0$37);(ph$34=t0$37);;var $32$41;($32$41=ph$34);;var bridge$33$46;(bridge$33$46=$32$41);if(((typeof(bridge$33$46)==="string")||(typeof(bridge$33$46)==="number"))){return obj$29[msg$35];}else{var other$54;(other$54=$32$41);return obj$29["::send"](msg$35);}});;(Array[":::project"]=function($57$59){var ph$62;var value$63;var t0$65;(t0$65=$57$59);(value$63=t0$65);(ph$62=t0$65);;var $61$69;($61$69=ph$62);;if($184(Array)($61$69)){return [true,value$63];}else{$61$69;return [true,[value$63]];}});(Array.prototype["::check"]=function(value$83){if((value$83 instanceof Array)){var i$88;(i$88=0);;$86:for(;(i$88<this.length);(i$88++)){if(($199(this,i$88)!==$199(value$83,i$88))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$99){if((value$99 instanceof Array)){var i$104;(i$104=0);;$102:for(;(i$104<this.length);(i$104++)){if(($199(this,i$104)!==$199(value$99,i$104))){return [true,[value$99]];}}return [true,value$99.slice(this.length)];}else{return [true,[value$99]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($200));});(RegExp.prototype["::check"]=function($114$116){var ph$119;(ph$119=$114$116);;var $118$124;($118$124=ph$119);;var value$132;if((typeof($118$124)==="string")){(value$132=$118$124);if(value$132.match(this)){return true;}else{return false;}}else{var other$137;(other$137=$118$124);return false;}});(RegExp.prototype[":::project"]=function($139$141){var ph$144;(ph$144=$139$141);;var $143$149;($143$149=ph$144);;var value$157;if((typeof($143$149)==="string")){(value$157=$143$149);var $160$162;($160$162=value$157.match(this));;var m$170;if(($160$162===null)){(m$170=$160$162);return [false,null];}else{var m$175;(m$175=$160$162);return [true,m$175];}}else{var other$179;(other$179=$143$149);return [false,null];}});(Function.prototype["::send"]=function(args$182){return this.apply(this,args$182);});
var $699=function(arr$701){var results$705;var l$706;(results$705=[]);;(l$706=arr$701.length);;var i$714;(i$714=0);;$704:for(;(i$714<l$706);(i$714++)){results$705.push([i$714,$199(arr$701,i$714)]);}return results$705;};
var $721=function(dest$723,values$724){var k$729;(k$729=null);$727:for(k$729 in values$724){if(values$724.hasOwnProperty(k$729)){(dest$723[k$729]=values$724[k$729]);}}return dest$723;};
var $545=function(){var $546$548;($546$548=function(tags$552){var it$0$555;(it$0$555=function(){if((!$184($546$548)(this))){return Object.create($546$548.prototype);}else{return this;}}());;(it$0$555["tags"]=tags$552);return it$0$555;});;($546$548.prototype["create"]=function(){var $564$566;($564$566=arguments);;var t0$571;var message$575;var args$576;(t0$571=$564$566.length);if((t0$571>=0)){(message$575=function(){if((0>=t0$571)){return "";}else{return $564$566[0];}}());(args$576=Array.prototype.slice.call($564$566,1));var it$0$580;(it$0$580=this);;var e$585;(e$585=Error(message$575));;(e$585["::tags"]=it$0$580.tags);(e$585["args"]=args$576);var temp$593;(temp$593=$699(args$576));;var $length$598;($length$598=temp$593.length);;var $index$603;($index$603=0);;$586:for(;($index$603<$length$598);($index$603++)){var m$611;(m$611=temp$593[$index$603]);;var t0$616;var t1$617;var i$621;var arg$622;(t0$616=m$611);if(((t0$616 instanceof Array)&&((t1$617=t0$616.length),(t1$617===2)))){(i$621=t0$616[0]);(arg$622=t0$616[1]);(e$585[i$621]=arg$622);}else{$532(m$611);;}}(e$585["length"]=args$576.length);(e$585["name"]=["E"].concat(it$0$580.tags).join("."));return e$585;}else{$532($564$566);}});($546$548.prototype["::check"]=function(e$633){var it$0$636;(it$0$636=this);;var tags$641;if(((!e$633)||(!$184(Error)(e$633)))){return false;}(tags$641=(e$633["::tags"]||[]));;var temp$650;(temp$650=it$0$636.tags);;var $length$655;($length$655=temp$650.length);;var $index$660;($index$660=0);;$642:for(;($index$660<$length$655);($index$660++)){var m$668;(m$668=temp$650[$index$660]);;var tag$676;(tag$676=m$668);if((tags$641.indexOf(tag$676)===-1)){return false;}else{false;;}}return true;});($546$548.prototype["::deconstruct"]=function(e$684){var it$0$687;(it$0$687=this);;return e$684.args;});$721($546$548,$721(function(){var accum$692;(accum$692=({}));(accum$692["::name"]="$546");return accum$692;}(),function(){var accum$696;(accum$696=({}));(accum$696["::egclass"]=true);return accum$696;}()));return $546$548;}();
var $532=function(value$534,url$535,start$536,end$537){var err$540;(err$540=$545(["match"]).create("Could not find a match for value",({"value":value$534})));;if(url$535){(err$540["location"]=["location",url$535,start$536,end$537]);}throw err$540;};
var $733=function($734$736,key$737){var ph$741;(ph$741=$734$736);;var $739$746;($739$746=ph$741);;var bridge$740$751;(bridge$740$751=$739$746);if(((bridge$740$751===null)||(bridge$740$751===(void 0)))){return false;}else{var x$759;if((typeof($739$746)==="string")){(x$759=$739$746);return (key$737 in String.prototype);}else{var x$764;if((typeof($739$746)==="number")){(x$764=$739$746);return (key$737 in Number.prototype);}else{var x$769;(x$769=$739$746);return (key$737 in x$769);}}}};var accum$524;var accum$528;var $231$239;var items$240;var $232$241;var Source$242;var Location$243;var highlight_locations$244;var $233$245;var tokenize$246;var $234$247;var parse$248;var $235$249;var translate$250;var Translator$251;var std$252;var exp$253;var opt$254;var generate_from_ast$255;var generate$256;var Generator$257;($231$239=require("./util"));;(items$240=$231$239.items);;($232$241=require("./location"));;(Source$242=$232$241.Source);;(Location$243=$232$241.Location);;(highlight_locations$244=$232$241.highlight_locations);;($233$245=require("./lex"));;(tokenize$246=$233$245.tokenize);;($234$247=require("./parse"));;(parse$248=$234$247.parse);;($235$249=require("./translate-js"));;(translate$250=$235$249.translate);;(Translator$251=$235$249.Translator);;(std$252=require("./stdenv"));;(exp$253=require("./expand"));;(opt$254=require("./opt"));;(generate_from_ast$255=function(ast$309){var ex$312;var tr$313;var rval$314;(ex$312=std$252.expand(["top"],std$252.topscope,std$252.stdenv.fork().convert(["multi",ast$309])));;(ex$312=opt$254.hoist(ex$312));(tr$313=Translator$251());;(rval$314=tr$313.translate(ex$312,"expr"));;return [tr$313.dump_store(),rval$314];});;std$252.stdenv.bind(std$252.topscope,"macro",["macro",function(context$327,scope$328,form$329,$325$330){var t0$369;var t1$370;var prep$364;var code$365;var mac$366;var mac2$367;var name$351;var sym$352;var arguments$353;var ast$354;var t0$343;var t1$344;var t2$345;var t3$346;var t4$347;var $332$338;var ph$333;(ph$333=$325$330);;($332$338=ph$333);;if((($332$338 instanceof Array)&&((t0$343=$332$338.length),((t0$343===3)&&(($332$338[0]==="data")&&((t1$344=$332$338[1]),((t1$344 instanceof Array)&&((t2$345=t1$344.length),((t2$345===3)&&((t1$344[0]==="send")&&((t3$346=t1$344[1]),((name$351=t3$346),((t3$346 instanceof Array)&&((t4$347=t3$346.length),((t4$347===2)&&(t3$346[0]==="symbol")))))))))))))))){(sym$352=t3$346[1]);(arguments$353=t1$344[2]);(ast$354=$332$338[2]);(t0$369=generate_from_ast$255(["send",["symbol","->"],["data",arguments$353,ast$354]]));if(((t0$369 instanceof Array)&&((t1$370=t0$369.length),(t1$370===2)))){(prep$364=t0$369[0]);(code$365=t0$369[1]);;}else{$532(generate_from_ast$255(["send",["symbol","->"],["data",arguments$353,ast$354]]),"/home/olivier/git/earl-grey/src/earl-grey.eg",792,832);}(mac$366=eval((prep$364+((";("+code$365)+")"))));;(mac2$367=function(c$381,s$382,f$383,e$384){var env$387;var r$388;(env$387=scope$328.expander.mkenv());;env$387.bind(scope$328,sym$352,["macro",mac2$367]);(r$388=mac$366(c$381,s$382,f$383,e$384));;return env$387.convert(r$388);});;return ["declare_raw",name$351,["macro",mac2$367]];}else{$532($332$338);}}]);std$252.stdenv.bind(std$252.topscope,"macros",["macro",function(context$401,scope$402,$398$403,$399$404){var t0$409;var t0$414;var t1$415;var t0$425;var t1$426;var $index$453;var $length$448;var temp$443;var acc$438;var prep$421;var code$422;var the_macros$423;var env$406;var body$407;(t0$409=$398$403);if($733(t0$409,"env")){(env$406=t0$409.env);;}else{$532($398$403);}(t0$414=$399$404);if(((t0$414 instanceof Array)&&((t1$415=t0$414.length),((t1$415===2)&&(t0$414[0]==="data"))))){(body$407=t0$414[1]);;}else{$532($399$404);}(t0$425=generate_from_ast$255(body$407));if(((t0$425 instanceof Array)&&((t1$426=t0$425.length),(t1$426===2)))){(prep$421=t0$425[0]);(code$422=t0$425[1]);;}else{$532(generate_from_ast$255(body$407),"/home/olivier/git/earl-grey/src/earl-grey.eg",1352,1375);}(the_macros$423=eval((((prep$421+";(")+code$422)+")")));;return ["splice"].concat((((acc$438=[])),(((temp$443=items$240(the_macros$423))),((($length$448=temp$443.length)),((($index$453=0)),function(){$435:for(;($index$453<$length$448);($index$453++)){var k$471;var v$472;var t0$466;var t1$467;var m$461;(m$461=temp$443[$index$453]);;(t0$466=m$461);if(((t0$466 instanceof Array)&&((t1$467=t0$466.length),(t1$467===2)))){(k$471=t0$466[0]);(v$472=t0$466[1]);acc$438.push(["declare_raw",$721(["symbol",k$471],({"env":env$406})),["macro",v$472]]);}else{$532(m$461,"/home/olivier/git/earl-grey/src/earl-grey.eg",1451,1558);;}}}()))),acc$438));}]);(generate$256=function(source$481){return Generator$257().generate(source$481);});;(Generator$257=function(){var it$0$489;(it$0$489=function(){if((!$184(Generator$257)(this))){return Object.create(Generator$257.prototype);}else{return this;}}());;(it$0$489["tr"]=Translator$251(std$252.stdprelude));(it$0$489["env"]=std$252.stdenv.fork());return it$0$489;});;(Generator$257.prototype["generate"]=function(source$499){var t$507;var p$508;var ex$509;var rval$510;var it$0$502;(it$0$502=this);;(t$507=tokenize$246(source$499));;(p$508=parse$248(t$507));;(ex$509=std$252.expand(["top"],std$252.topscope,it$0$502.env.convert(["splice",p$508])));;(ex$509=opt$254.hoist(ex$509));(rval$510=it$0$502.tr.translate(ex$509,"stmt"));;return (it$0$502.tr.dump_store()+rval$510);});$721(Generator$257,$721(((accum$524=({})),((accum$524["::name"]="Generator"),accum$524)),((accum$528=({})),((accum$528["::egclass"]=true),accum$528))));Generator$257;(exports["Source"]=Source$242);(exports["Location"]=Location$243);(exports["highlight_locations"]=highlight_locations$244);(exports["tokenize"]=tokenize$246);(exports["parse"]=parse$248);(exports["Generator"]=Generator$257);(exports["generate"]=generate$256);

},{"./expand":5,"./lex":6,"./location":7,"./opt":8,"./parse":9,"./stdenv":12,"./translate-js":13,"./util":14}],5:[function(require,module,exports){
var $932=function(type$934){var f$937;(f$937=type$934["::check"]);;if((f$937===(void 0))){return function(value$942){return (value$942 instanceof type$934);};}else{return function(value$945){return f$937.call(type$934,value$945);};}};
var $947=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $948=function($949$951){var ph$955;(ph$955=$949$951);;var $953$960;($953$960=ph$955);;var bridge$954$965;var x$969;(bridge$954$965=$953$960);if((((typeof(bridge$954$965)==="string")&&((x$969=bridge$954$965),true))||((typeof(bridge$954$965)==="number")&&((x$969=bridge$954$965),true)))){return ["value",x$969];}else{var other$976;(other$976=$953$960);return other$976["::serialize_ast"]();}};
var send$772;(send$772=function(obj$777,$775$778){var ph$782;var msg$783;var t0$785;(t0$785=$775$778);(msg$783=t0$785);(ph$782=t0$785);;var $780$789;($780$789=ph$782);;var bridge$781$794;(bridge$781$794=$780$789);if(((typeof(bridge$781$794)==="string")||(typeof(bridge$781$794)==="number"))){return obj$777[msg$783];}else{var other$802;(other$802=$780$789);return obj$777["::send"](msg$783);}});;(Array[":::project"]=function($805$807){var ph$810;var value$811;var t0$813;(t0$813=$805$807);(value$811=t0$813);(ph$810=t0$813);;var $809$817;($809$817=ph$810);;if($932(Array)($809$817)){return [true,value$811];}else{$809$817;return [true,[value$811]];}});(Array.prototype["::check"]=function(value$831){if((value$831 instanceof Array)){var i$836;(i$836=0);;$834:for(;(i$836<this.length);(i$836++)){if(($947(this,i$836)!==$947(value$831,i$836))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$847){if((value$847 instanceof Array)){var i$852;(i$852=0);;$850:for(;(i$852<this.length);(i$852++)){if(($947(this,i$852)!==$947(value$847,i$852))){return [true,[value$847]];}}return [true,value$847.slice(this.length)];}else{return [true,[value$847]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($948));});(RegExp.prototype["::check"]=function($862$864){var ph$867;(ph$867=$862$864);;var $866$872;($866$872=ph$867);;var value$880;if((typeof($866$872)==="string")){(value$880=$866$872);if(value$880.match(this)){return true;}else{return false;}}else{var other$885;(other$885=$866$872);return false;}});(RegExp.prototype[":::project"]=function($887$889){var ph$892;(ph$892=$887$889);;var $891$897;($891$897=ph$892);;var value$905;if((typeof($891$897)==="string")){(value$905=$891$897);var $908$910;($908$910=value$905.match(this));;var m$918;if(($908$910===null)){(m$918=$908$910);return [false,null];}else{var m$923;(m$923=$908$910);return [true,m$923];}}else{var other$927;(other$927=$891$897);return [false,null];}});(Function.prototype["::send"]=function(args$930){return this.apply(this,args$930);});
var $3109=function(arr$3111){var results$3115;var l$3116;(results$3115=[]);;(l$3116=arr$3111.length);;var i$3124;(i$3124=0);;$3114:for(;(i$3124<l$3116);(i$3124++)){results$3115.push([i$3124,$947(arr$3111,i$3124)]);}return results$3115;};
var $3131=function(dest$3133,values$3134){var k$3139;(k$3139=null);$3137:for(k$3139 in values$3134){if(values$3134.hasOwnProperty(k$3139)){(dest$3133[k$3139]=values$3134[k$3139]);}}return dest$3133;};
var $2955=function(){var $2956$2958;($2956$2958=function(tags$2962){var it$0$2965;(it$0$2965=function(){if((!$932($2956$2958)(this))){return Object.create($2956$2958.prototype);}else{return this;}}());;(it$0$2965["tags"]=tags$2962);return it$0$2965;});;($2956$2958.prototype["create"]=function(){var $2974$2976;($2974$2976=arguments);;var t0$2981;var message$2985;var args$2986;(t0$2981=$2974$2976.length);if((t0$2981>=0)){(message$2985=function(){if((0>=t0$2981)){return "";}else{return $2974$2976[0];}}());(args$2986=Array.prototype.slice.call($2974$2976,1));var it$0$2990;(it$0$2990=this);;var e$2995;(e$2995=Error(message$2985));;(e$2995["::tags"]=it$0$2990.tags);(e$2995["args"]=args$2986);var temp$3003;(temp$3003=$3109(args$2986));;var $length$3008;($length$3008=temp$3003.length);;var $index$3013;($index$3013=0);;$2996:for(;($index$3013<$length$3008);($index$3013++)){var m$3021;(m$3021=temp$3003[$index$3013]);;var t0$3026;var t1$3027;var i$3031;var arg$3032;(t0$3026=m$3021);if(((t0$3026 instanceof Array)&&((t1$3027=t0$3026.length),(t1$3027===2)))){(i$3031=t0$3026[0]);(arg$3032=t0$3026[1]);(e$2995[i$3031]=arg$3032);}else{$2942(m$3021);;}}(e$2995["length"]=args$2986.length);(e$2995["name"]=["E"].concat(it$0$2990.tags).join("."));return e$2995;}else{$2942($2974$2976);}});($2956$2958.prototype["::check"]=function(e$3043){var it$0$3046;(it$0$3046=this);;var tags$3051;if(((!e$3043)||(!$932(Error)(e$3043)))){return false;}(tags$3051=(e$3043["::tags"]||[]));;var temp$3060;(temp$3060=it$0$3046.tags);;var $length$3065;($length$3065=temp$3060.length);;var $index$3070;($index$3070=0);;$3052:for(;($index$3070<$length$3065);($index$3070++)){var m$3078;(m$3078=temp$3060[$index$3070]);;var tag$3086;(tag$3086=m$3078);if((tags$3051.indexOf(tag$3086)===-1)){return false;}else{false;;}}return true;});($2956$2958.prototype["::deconstruct"]=function(e$3094){var it$0$3097;(it$0$3097=this);;return e$3094.args;});$3131($2956$2958,$3131(function(){var accum$3102;(accum$3102=({}));(accum$3102["::name"]="$2956");return accum$3102;}(),function(){var accum$3106;(accum$3106=({}));(accum$3106["::egclass"]=true);return accum$3106;}()));return $2956$2958;}();
var $2942=function(value$2944,url$2945,start$2946,end$2947){var err$2950;(err$2950=$2955(["match"]).create("Could not find a match for value",({"value":value$2944})));;if(url$2945){(err$2950["location"]=["location",url$2945,start$2946,end$2947]);}throw err$2950;};
var $3143=function($3144$3146,key$3147){var ph$3151;(ph$3151=$3144$3146);;var $3149$3156;($3149$3156=ph$3151);;var bridge$3150$3161;(bridge$3150$3161=$3149$3156);if(((bridge$3150$3161===null)||(bridge$3150$3161===(void 0)))){return false;}else{var x$3169;if((typeof($3149$3156)==="string")){(x$3169=$3149$3156);return (key$3147 in String.prototype);}else{var x$3174;if((typeof($3149$3156)==="number")){(x$3174=$3149$3156);return (key$3147 in Number.prototype);}else{var x$3179;(x$3179=$3149$3156);return (key$3147 in x$3179);}}}};
var $3181=function(type$3183){return function(value$3186){var f$3189;(f$3189=type$3183[":::project"]);;if((f$3189===(void 0))){var f$3194;(f$3194=type$3183["::project"]);;if((f$3194===(void 0))){return [true,type$3183(value$3186)];}else{var rval$3199;(rval$3199=false);;try{(rval$3199=[true,f$3194(value$3186)]);}catch(excv$3205){var e$3211;(e$3211=excv$3205);(rval$3199=[false,null]);}return rval$3199;}}else{return f$3189.call(type$3183,value$3186);}};};var accum$1183;var accum$1187;var accum$1451;var accum$1455;var accum$2823;var accum$2827;var $979$983;var __lt____gt__$984;var $980$985;var __lt____lt____colon__$986;var util$987;var classify$988;var items$989;var iterkeys$990;var enumerate$991;var neighbours$992;var zip$993;var GenSym$994;var gensym$995;var uuid$996;var $982$997;var PatternParser$998;var PatternProcessor$999;var Scope$1000;var Env$1001;var track_location$1002;var Expander$1003;var mac1$1004;var __chk_ncache$1005;var __chk_scache$1006;var checker_db$1007;($979$983=require("./pp"));;(__lt____gt__$984=$979$983["<>"]);;($980$985=require("./location"));;(__lt____lt____colon__$986=$980$985["<<:"]);;(util$987=require("./util"));;(classify$988=util$987.classify);;(items$989=util$987.items);;(iterkeys$990=util$987.keys);;(enumerate$991=util$987.enumerate);;(neighbours$992=util$987.neighbours);;(zip$993=util$987.zip);;(GenSym$994=util$987.GenSym);;(gensym$995=util$987.gensym);;(uuid$996=util$987.uuid);;($982$997=require("./pattern"));;(PatternParser$998=$982$997.PatternParser);;(PatternProcessor$999=$982$997.PatternProcessor);;(Scope$1000=function(){var it$0$1079;var parent$1073;var name$1074;var expander$1075;var t0$1069;var $1062$1064;($1062$1064=arguments);;(t0$1069=$1062$1064.length);if(((t0$1069>=0)&&(t0$1069<=3))){(parent$1073=function(){if((0>=t0$1069)){return null;}else{return $1062$1064[0];}}());(name$1074=function(){if((1>=t0$1069)){return null;}else{return $1062$1064[1];}}());(expander$1075=function(){if((2>=t0$1069)){return null;}else{return $1062$1064[2];}}());(it$0$1079=function(){if((!$932(Scope$1000)(this))){return Object.create(Scope$1000.prototype);}else{return this;}}());;(it$0$1079["name"]=(name$1074||gensym$995("scope")));(it$0$1079["parent"]=parent$1073);(it$0$1079["options"]=({}));(it$0$1079["expander"]=(expander$1075||parent$1073.expander));return it$0$1079;}else{$2942($1062$1064);}});;(Scope$1000.prototype["getopt"]=function(opt$1091){var otherwise$1118;var $1095$1107;var $1094$1101;var it$0$1096;(it$0$1096=this);;($1094$1101=null);;$1094$1101;if(Object.prototype.hasOwnProperty.call(it$0$1096.options,opt$1091)){return $947(it$0$1096.options,opt$1091);}else{if((it$0$1096.parent===null)){return (void 0);}else{(otherwise$1118=$1094$1101);return it$0$1096.parent.getopt(opt$1091);}}});(Scope$1000.prototype["setopt"]=function(opt$1123,value$1124){var it$0$1127;(it$0$1127=this);;return (it$0$1127.options[opt$1123]=value$1124);});(Scope$1000.prototype["gensym"]=function(){var it$0$1136;(it$0$1136=this);;return it$0$1136.expander.gensym();});(Scope$1000.prototype["step"]=function(context$1143,expr$1144){var it$0$1147;(it$0$1147=this);;return it$0$1147.expander.step(context$1143,it$0$1147,expr$1144);});(Scope$1000.prototype["step_all"]=function(context$1154,exprs$1155){var it$0$1158;(it$0$1158=this);;return it$0$1158.expander.step_all(context$1154,it$0$1158,exprs$1155);});(Scope$1000.prototype["expand"]=function(context$1165,expr$1166){var it$0$1169;(it$0$1169=this);;return it$0$1169.expander.expand(context$1165,it$0$1169,expr$1166);});(Scope$1000.prototype["toString"]=function(){var it$0$1178;(it$0$1178=this);;return (("Scope{"+it$0$1178.name)+"}");});$3131(Scope$1000,$3131(((accum$1183=({})),((accum$1183["::name"]="Scope"),accum$1183)),((accum$1187=({})),((accum$1187["::egclass"]=true),accum$1187))));Scope$1000;(Env$1001=function(){var it$0$1195;(it$0$1195=function(){if((!$932(Env$1001)(this))){return Object.create(Env$1001.prototype);}else{return this;}}());;(it$0$1195["scopes"]=({}));return it$0$1195;});;(Env$1001.prototype["resolve"]=function(scope$1204,name$1205){var scope_data$1213;var it$0$1208;(it$0$1208=this);;if((scope$1204===null)){return (void 0);}(scope_data$1213=$947(it$0$1208.scopes,scope$1204.name));;if((scope_data$1213&&Object.prototype.hasOwnProperty.call(scope_data$1213,name$1205))){return $947(scope_data$1213,name$1205);}else{return it$0$1208.resolve(scope$1204.parent,name$1205);}});(Env$1001.prototype["bind"]=function(scope$1221,name$1222,value$1223){var it$0$1226;(it$0$1226=this);;if((!$947(it$0$1226.scopes,scope$1221.name))){(it$0$1226.scopes[scope$1221.name]=({}));}return ($947(it$0$1226.scopes,scope$1221.name)[name$1222]=value$1223);});(Env$1001.prototype["convert"]=function(expr$1235){var x$1274;var x$1279;var bridge$1242$1271;var x$1284;var bridge$1241$1268;var x$1289;var bridge$1240$1265;var x$1294;var $index$1321;var $length$1316;var temp$1311;var other$1341;var type$1301;var args$1302;var e$1258;var bridge$1239$1253;var t0$1254;var $1238$1248;var it$0$1243;(it$0$1243=this);;($1238$1248=expr$1235);;if($3143($1238$1248,"env")){(e$1258=$1238$1248.env);return expr$1235;}else{(bridge$1239$1253=$1238$1248);if((((bridge$1240$1265=bridge$1239$1253),(((bridge$1241$1268=bridge$1240$1265),(((bridge$1242$1271=bridge$1241$1268),((((x$1274=bridge$1242$1271)),((x$1274 instanceof Array)&&(x$1274[0]==="symbol")))||(((x$1279=bridge$1242$1271)),((x$1279 instanceof Array)&&(x$1279[0]==="value")))))||(((x$1284=bridge$1241$1268)),((x$1284 instanceof Array)&&(x$1284[0]==="variable")))))||(((x$1289=bridge$1240$1265)),((x$1289 instanceof Array)&&(x$1289[0]==="macro")))))||(((x$1294=bridge$1239$1253)),((x$1294 instanceof Array)&&(x$1294[0]==="void"))))){return $3131(expr$1235,({"env":it$0$1243}));}else{if((($1238$1248 instanceof Array)&&((t0$1254=$1238$1248.length),(t0$1254>=1)))){(type$1301=$1238$1248[0]);(args$1302=Array.prototype.slice.call($1238$1248,1));(temp$1311=args$1302);;($length$1316=temp$1311.length);;($index$1321=0);;$1307:for(;($index$1321<$length$1316);($index$1321++)){var arg$1337;var m$1329;(m$1329=temp$1311[$index$1321]);;(arg$1337=m$1329);it$0$1243.convert(arg$1337);}return $3131(expr$1235,({"env":it$0$1243}));}else{(other$1341=$1238$1248);return $3131(expr$1235,({"env":it$0$1243}));}}}});(Env$1001.prototype["fork"]=function(){var $index$1371;var $length$1366;var temp$1361;var e$1353;var it$0$1348;(it$0$1348=this);;(e$1353=Env$1001());;(temp$1361=items$989(it$0$1348.scopes));;($length$1366=temp$1361.length);;($index$1371=0);;$1354:for(;($index$1371<$length$1366);($index$1371++)){var $index$1412;var $length$1407;var temp$1402;var acc$1397;var scope$1389;var bindings$1390;var t0$1384;var t1$1385;var m$1379;(m$1379=temp$1361[$index$1371]);;(t0$1384=m$1379);if(((t0$1384 instanceof Array)&&((t1$1385=t0$1384.length),(t1$1385===2)))){(scope$1389=t0$1384[0]);(bindings$1390=t0$1384[1]);(acc$1397=[]);;(temp$1402=items$989(bindings$1390));;($length$1407=temp$1402.length);;($index$1412=0);;$1394:for(;($index$1412<$length$1407);($index$1412++)){var k$1430;var v$1431;var t0$1425;var t1$1426;var m$1420;(m$1420=temp$1402[$index$1412]);;(t0$1425=m$1420);if(((t0$1425 instanceof Array)&&((t1$1426=t0$1425.length),(t1$1426===2)))){(k$1430=t0$1425[0]);(v$1431=t0$1425[1]);acc$1397.push((function(){if((!$947(e$1353.scopes,scope$1389))){return (e$1353.scopes[scope$1389]=({}));}}(),($947(e$1353.scopes,scope$1389)[k$1430]=v$1431)));}else{$2942(m$1420,"/home/olivier/git/earl-grey/src/expand.eg",2004,2163);;}}acc$1397;}else{$2942(m$1379,"/home/olivier/git/earl-grey/src/expand.eg",1964,2163);;}}return e$1353;});(Env$1001.prototype["toString"]=function(){var it$0$1446;(it$0$1446=this);;return "Env{...}";});$3131(Env$1001,$3131(((accum$1451=({})),((accum$1451["::name"]="Env"),accum$1451)),((accum$1455=({})),((accum$1455["::egclass"]=true),accum$1455))));Env$1001;(track_location$1002=function(f$1461){var f2$1464;(f2$1464=function(context$1468,scope$1469,expr$1470){var rval$1478;var other$1510;var v$1504;var t0$1500;var $1473$1495;var rval$1474;(rval$1474=(((rval$1478=false)),(function(){try{(rval$1478=f$1461(context$1468,scope$1469,expr$1470));}catch(excv$1484){var e$1490;(e$1490=excv$1484);(rval$1478=(__lt____lt____colon__$986(e$1490,expr$1470),function(){throw e$1490;}()));}}(),rval$1478)));;($1473$1495=rval$1474);;if((($1473$1495 instanceof Array)&&((t0$1500=$1473$1495.length),((t0$1500===2)&&($1473$1495[0]==="bounce"))))){(v$1504=$1473$1495[1]);return f2$1464(context$1468,scope$1469,__lt____lt____colon__$986(v$1504,expr$1470));}else{(other$1510=$1473$1495);return __lt____lt____colon__$986(other$1510,expr$1470);}});;return f2$1464;});;(Expander$1003=function(env_factory$1517,generic_nodes$1518){var it$0$1521;(it$0$1521=function(){if((!$932(Expander$1003)(this))){return Object.create(Expander$1003.prototype);}else{return this;}}());;(it$0$1521["gensym"]=gensym$995);(it$0$1521["mkenv"]=env_factory$1517);(it$0$1521["generic_nodes"]=generic_nodes$1518);return it$0$1521;});;(Expander$1003.prototype["run_macro"]=function(m$1531,context$1532,scope$1533,form$1534,arg$1535){var rval$1547;var rval$1543;var it$0$1538;(it$0$1538=this);;(rval$1543=(((rval$1547=false)),(function(){try{(rval$1547=m$1531(context$1532,scope$1533,form$1534,arg$1535));}catch(excv$1553){var msg$1586;var msg$1681;var find$1595;var err$1596;var other$1592;var $1573$1575;var e$1570;var e$1688;var value$1563;var t0$1556;var t1$1557;var t2$1558;var t3$1559;(t0$1556=excv$1553);if(($932($2955(["match"]))(t0$1556)&&($3143(t0$1556,"args")&&((t1$1557=t0$1556.args),((t1$1557 instanceof Array)&&((t2$1558=t1$1557.length),((t2$1558===1)&&((t3$1559=t1$1557[0]),$3143(t3$1559,"value"))))))))){(value$1563=t3$1559.value);(rval$1547=(((e$1570=((($1573$1575=value$1563)),function(){if(($1573$1575===context$1532)){(msg$1586="The macro cannot be found in this context.");;return $2955(["syntax","context"]).create(msg$1586,({"context":context$1532,"form":form$1534}));}else{(other$1592=$1573$1575);(find$1595=function($1599$1601){var t0$1607;var msg$1623;var $index$1649;var $length$1644;var temp$1639;var other$1674;var type$1629;var xs$1630;var t0$1616;var $1603$1611;var ph$1604;var arg$1605;(t0$1607=$1599$1601);(arg$1605=t0$1607);(ph$1604=t0$1607);;($1603$1611=ph$1604);;if(($1603$1611===value$1563)){(msg$1623="The macro could not match its argument (or part of it).");;return $2955(["syntax","argument"]).create(msg$1623,({"context":context$1532,"argument":arg$1605,"form":form$1534}));}else{if((($1603$1611 instanceof Array)&&((t0$1616=$1603$1611.length),(t0$1616>=1)))){(type$1629=$1603$1611[0]);(xs$1630=Array.prototype.slice.call($1603$1611,1));(temp$1639=xs$1630);;($length$1644=temp$1639.length);;($index$1649=0);;$1635:for(;($index$1649<$length$1644);($index$1649++)){var x$1666;var t0$1662;var m$1657;(m$1657=temp$1639[$index$1649]);;(t0$1662=$3181(find$1595)(m$1657));if(t0$1662[0]){(x$1666=t0$1662[1]);if(x$1666){return x$1666;}}else{$2942(m$1657,"/home/olivier/git/earl-grey/src/expand.eg",3441,3526);;}}return false;}else{(other$1674=$1603$1611);return false;}}});;(err$1596=find$1595(arg$1535));;if(err$1596){return err$1596;}else{(msg$1681="The macro failed because it failed to match some value, probably one that it generated itself.");;return $2955(["syntax","failure"]).create(msg$1681,({"form":form$1534,"value":value$1563}));}}}()))),function(){throw e$1570;}()));}else{(e$1688=excv$1553);(rval$1547=function(){throw e$1688;}());}}}(),rval$1547)));;return it$0$1538.mkenv().convert(rval$1543);});(Expander$1003.prototype["step"]=function(context$1694,scope$1695,expr$1696){var helper$1704;var it$0$1699;(it$0$1699=this);;(helper$1704=track_location$1002(function(context$1709,scope$1710,$1707$1711){var t0$1720;var other$1760;var env$1755;var $1745$1747;var other$1793;var t0$1784;var $1777$1779;var other$1797;var m$1773;var t0$1769;var $1741$1764;var env$1742;var other$1820;var t0$1811;var $1804$1806;var other$1845;var m$1839;var t0$1835;var $1828$1830;var other$1854;var x$1849;var f$1824;var arg$1825;var m$1801;var s$1736;var $1714$1731;var $1715$1732;var $1716$1733;var t0$1729;var $1713$1724;var ph$1717;var expr$1718;(t0$1720=$1707$1711);(expr$1718=t0$1720);(ph$1717=t0$1720);;($1713$1724=ph$1717);;if((($1714$1731=($1713$1724 instanceof Array))&&((t0$1729=$1713$1724.length),(($1716$1733=(t0$1729===2))&&($1713$1724[0]==="symbol"))))){(s$1736=$1713$1724[1]);(env$1742=((($1745$1747=expr$1718)),function(){if($3143($1745$1747,"env")){(env$1755=$1745$1747.env);return expr$1718.env;}else{(other$1760=$1745$1747);throw $2955(["syntax","no_env"]).create("No environment was found to resolve",({"symbol":expr$1718}));}}()));;($1741$1764=env$1742.resolve(scope$1710,s$1736));;if((($1741$1764 instanceof Array)&&((t0$1769=$1741$1764.length),((t0$1769===2)&&($1741$1764[0]==="macro"))))){(m$1773=$1741$1764[1]);($1777$1779=context$1709);;if((($1777$1779 instanceof Array)&&((t0$1784=$1777$1779.length),((t0$1784===2)&&(($1777$1779[0]==="expr")&&($1777$1779[1]==="head")))))){return ["macro",m$1773];}else{(other$1793=$1777$1779);return ["bounce",it$0$1699.run_macro(m$1773,context$1709,scope$1710,expr$1718,__lt____lt____colon__$986(["void"],expr$1718))];}}else{(other$1797=$1741$1764);return expr$1718;}}else{if(($1716$1733&&($1713$1724[0]==="macro"))){(m$1801=$1713$1724[1]);($1804$1806=context$1709);;if((($1804$1806 instanceof Array)&&((t0$1811=$1804$1806.length),((t0$1811===2)&&(($1804$1806[0]==="expr")&&($1804$1806[1]==="head")))))){return expr$1718;}else{(other$1820=$1804$1806);return ["bounce",it$0$1699.run_macro(m$1801,context$1709,scope$1710,expr$1718,__lt____lt____colon__$986(["void"],expr$1718))];}}else{if(($1714$1731&&((t0$1729===3)&&($1713$1724[0]==="send")))){(f$1824=$1713$1724[1]);(arg$1825=$1713$1724[2]);($1828$1830=helper$1704(["expr","head"],scope$1710,f$1824));;if((($1828$1830 instanceof Array)&&((t0$1835=$1828$1830.length),((t0$1835===2)&&($1828$1830[0]==="macro"))))){(m$1839=$1828$1830[1]);return ["bounce",it$0$1699.run_macro(m$1839,context$1709,scope$1710,expr$1718,arg$1825)];}else{(other$1845=$1828$1830);return expr$1718;}}else{if(($1714$1731&&((t0$1729===2)&&($1713$1724[0]==="nostep")))){(x$1849=$1713$1724[1]);return x$1849;}else{(other$1854=$1713$1724);return expr$1718;}}}}}));;return helper$1704(context$1694,scope$1695,expr$1696);});(Expander$1003.prototype["step_all"]=function(context$1861,scope$1862,$1859$1863){var t0$1867;var t1$1868;var pre$1879;var bulk$1880;var post$1881;var it$0$1874;var stmts$1865;(t0$1867=$1859$1863);if(((t0$1867 instanceof Array)&&((t1$1868=t0$1867.length),(t1$1868>=0)))){(stmts$1865=Array.prototype.slice.call(t0$1867,0));;}else{$2942($1859$1863);}(it$0$1874=this);;(pre$1879=[]);;(bulk$1880=[]);;(post$1881=[]);;$1891:while(stmts$1865.length){var x$1937;var m$1932;var stmt$1927;var stmt$1922;var prepend$1916;var $1896$1911;var $1897$1912;var $1898$1913;var t0$1909;var $1895$1904;var current$1899;(current$1899=stmts$1865.shift());;($1895$1904=it$0$1874.step(context$1861,scope$1862,current$1899));;if((($1896$1911=($1895$1904 instanceof Array))&&((t0$1909=$1895$1904.length),((t0$1909>=1)&&($1895$1904[0]==="splice"))))){(prepend$1916=Array.prototype.slice.call($1895$1904,1));(stmts$1865=prepend$1916.concat(stmts$1865));}else{if(($1896$1911&&(($1898$1913=(t0$1909===2))&&($1895$1904[0]==="float")))){(stmt$1922=$1895$1904[1]);(pre$1879=pre$1879.concat(it$0$1874.step_all(context$1861,scope$1862,[stmt$1922])));}else{if(($1898$1913&&($1895$1904[0]==="sink"))){(stmt$1927=$1895$1904[1]);(post$1881=post$1881.concat(it$0$1874.step_all(context$1861,scope$1862,[stmt$1927])));}else{if(($1898$1913&&($1895$1904[0]==="multimacro"))){(m$1932=$1895$1904[1]);(stmts$1865=m$1932(context$1861,scope$1862,current$1899,stmts$1865));}else{(x$1937=$1895$1904);bulk$1880.push(x$1937);}}}}}return pre$1879.concat(bulk$1880).concat(post$1881);});(Expander$1003.prototype["expand"]=function(context$1942,scope$1943,expr$1944){var helper$1952;var it$0$1947;(it$0$1947=this);;(helper$1952=track_location$1002(function(context$1956,scope$1957,expr$1958){var t0$1989;var other$2006;var $1986$1994;var env$1987;var $index$2053;var $length$2048;var temp$2043;var acc$2038;var newargs$2032;var $index$2099;var $length$2094;var temp$2089;var acc$2084;var newargs$2078;var t0$2143;var newscope$2137;var env$2138;var $index$2200;var $length$2195;var temp$2190;var acc$2185;var $index$2310;var $length$2305;var temp$2300;var acc$2295;var t0$2174;var newscope$2158;var stepscope$2159;var changes$2160;var newargs$2161;var vars$2162;var exp$2163;var $index$2578;var $length$2573;var temp$2568;var other$2652;var t0$2635;var $2628$2630;var is_obj$2489;var obj$2490;var arr$2491;var arr_parts$2492;var obj_parts$2493;var new_arr_part$2494;var new_obj_part$2495;var r$2496;var $index$2695;var $length$2690;var temp$2685;var acc$2680;var newscope$2672;var s$2755;var newscope$2764;var name$2751;var t0$2747;var $index$2799;var $length$2794;var temp$2789;var acc$2784;var other$2819;var type$2775;var args$2776;var tag$2768;var body$2769;var x$2742;var $1962$2743;var bindings$2667;var body$2668;var target$2661;var value$2662;var args$2485;var args$2154;var args$2149;var variable$2127;var s$2128;var value$2129;var body$2130;var args$2074;var args$2028;var f$2022;var arg$2023;var s$1981;var $1963$1976;var $1964$1977;var $1965$1978;var t0$1972;var t1$1973;var t2$1974;var $1961$1967;(expr$1958=it$0$1947.step(context$1956,scope$1957,expr$1958));($1961$1967=expr$1958);;if((($1963$1976=($1961$1967 instanceof Array))&&((t0$1972=$1961$1967.length),(($1965$1978=(t0$1972===2))&&($1961$1967[0]==="symbol"))))){(s$1981=$1961$1967[1]);(t0$1989=expr$1958);if($3143(t0$1989,"env")){(env$1987=t0$1989.env);;}else{$2942(expr$1958,"/home/olivier/git/earl-grey/src/expand.eg",7759,7763);}($1986$1994=env$1987.resolve(scope$1957,s$1981));;if(($1986$1994===(void 0))){throw $2955(["syntax","undeclared"]).create(("Undeclared variable: "+s$1981),({"node":expr$1958}));}else{(other$2006=$1986$1994);return ["bounce",other$2006];}}else{if(($1965$1978&&($1961$1967[0]==="value"))){$1961$1967[1];return expr$1958;}else{if(($1965$1978&&($1961$1967[0]==="variable"))){$1961$1967[1];return expr$1958;}else{if(($1963$1976&&((t0$1972===1)&&($1961$1967[0]==="void")))){return expr$1958;}else{if(($1963$1976&&((t0$1972===3)&&($1961$1967[0]==="send")))){(f$2022=$1961$1967[1]);(arg$2023=$1961$1967[2]);return ["send",helper$1952(["expr","head"],scope$1957,f$2022),helper$1952(["expr","tail"],scope$1957,arg$2023)];}else{if(($1963$1976&&(($1965$1978=(t0$1972>=1))&&($1961$1967[0]==="array")))){(args$2028=Array.prototype.slice.call($1961$1967,1));(newargs$2032=(((acc$2038=[])),(((temp$2043=it$0$1947.step_all(["expr","array"],scope$1957,args$2028))),((($length$2048=temp$2043.length)),((($index$2053=0)),function(){$2035:for(;($index$2053<$length$2048);($index$2053++)){var arg$2069;var m$2061;(m$2061=temp$2043[$index$2053]);;(arg$2069=m$2061);acc$2038.push(helper$1952(["expr","expr"],scope$1957,arg$2069));}}()))),acc$2038));;return ["array"].concat(newargs$2032);}else{if(($1965$1978&&($1961$1967[0]==="object"))){(args$2074=Array.prototype.slice.call($1961$1967,1));(newargs$2078=(((acc$2084=[])),(((temp$2089=it$0$1947.step_all(["expr","object"],scope$1957,args$2074))),((($length$2094=temp$2089.length)),((($index$2099=0)),function(){$2081:for(;($index$2099<$length$2094);($index$2099++)){var k$2117;var v$2118;var t0$2112;var t1$2113;var m$2107;(m$2107=temp$2089[$index$2099]);;(t0$2112=m$2107);if(((t0$2112 instanceof Array)&&((t1$2113=t0$2112.length),((t1$2113===3)&&(t0$2112[0]==="array"))))){(k$2117=t0$2112[1]);(v$2118=t0$2112[2]);acc$2084.push(["array",helper$1952(["expr","expr"],scope$1957,k$2117),helper$1952(["expr","expr"],scope$1957,v$2118)]);}else{$2942(m$2107,"/home/olivier/git/earl-grey/src/expand.eg",8603,8791);;}}}()))),acc$2084));;return ["object"].concat(newargs$2078);}else{if(($1963$1976&&((t0$1972===4)&&(($1961$1967[0]==="bind")&&((t1$1973=$1961$1967[1]),((variable$2127=t1$1973),((t1$1973 instanceof Array)&&((t2$1974=t1$1973.length),((t2$1974===2)&&(t1$1973[0]==="symbol")))))))))){(s$2128=t1$1973[1]);(value$2129=$1961$1967[2]);(body$2130=$1961$1967[3]);(newscope$2137=Scope$1000(scope$1957));;(t0$2143=variable$2127);if($3143(t0$2143,"env")){(env$2138=t0$2143.env);;}else{$2942(variable$2127,"/home/olivier/git/earl-grey/src/expand.eg",8934,8942);}env$2138.bind(newscope$2137,s$2128,value$2129);return helper$1952(context$1956,newscope$2137,body$2130);}else{if(($1963$1976&&(($1965$1978=(t0$1972>=1))&&($1961$1967[0]==="splice")))){(args$2149=Array.prototype.slice.call($1961$1967,1));return ["bounce",$3131(["multi"].concat(args$2149),({"override_scope":true}))];}else{if(($1965$1978&&($1961$1967[0]==="multi"))){(args$2154=Array.prototype.slice.call($1961$1967,1));(newscope$2158=function(){if(expr$1958.override_scope){return scope$1957;}else{return Scope$1000(scope$1957);}}());;(stepscope$2159=function(){if(expr$1958.nonrecursive){return scope$1957;}else{return newscope$2158;}}());;(changes$2160=false);;(t0$2174=classify$988("newargs","vars",(((acc$2185=[])),(((temp$2190=it$0$1947.step_all(["expr","multi"],stepscope$2159,args$2154))),((($length$2195=temp$2190.length)),((($index$2200=0)),function(){$2176:for(;($index$2200<$length$2195);($index$2200++)){var t0$2245;var env$2243;var t0$2263;var env$2260;var v$2261;var other$2281;var v$2272;var value$2273;var variable$2251;var s$2252;var value$2253;var variable$2234;var s$2235;var value$2236;var opt$2226;var value$2227;var $2178$2218;var $2179$2219;var $2180$2220;var $2181$2221;var $2182$2222;var $2183$2223;var t0$2213;var t1$2214;var t2$2215;var t3$2216;var m$2208;(m$2208=temp$2190[$index$2200]);;(t0$2213=m$2208);if((($2179$2219=(t0$2213 instanceof Array))&&((t1$2214=t0$2213.length),(($2181$2221=(t1$2214===3))&&(t0$2213[0]==="option"))))){(opt$2226=t0$2213[1]);(value$2227=t0$2213[2]);acc$2185.push((newscope$2158.setopt(opt$2226,value$2227),["ignore"]));}else{if(($2181$2221&&((t0$2213[0]==="declare_raw")&&((t2$2215=t0$2213[1]),((variable$2234=t2$2215),((t2$2215 instanceof Array)&&((t3$2216=t2$2215.length),((t3$2216===2)&&(t2$2215[0]==="symbol"))))))))){(s$2235=t2$2215[1]);(value$2236=t0$2213[2]);acc$2185.push((((t0$2245=variable$2234),function(){if($3143(t0$2245,"env")){(env$2243=t0$2245.env);}else{return $2942(variable$2234,"/home/olivier/git/earl-grey/src/expand.eg",9738,9746);}}()),env$2243.bind(newscope$2158,s$2235,value$2236),(changes$2160=true),["ignore"]));}else{if(($2179$2219&&(($2181$2221=((t1$2214>=2)&&(t1$2214<=3)))&&(($2182$2222=(t0$2213[0]==="declare"))&&((t2$2215=t0$2213[1]),((variable$2251=t2$2215),((t2$2215 instanceof Array)&&((t3$2216=t2$2215.length),((t3$2216===2)&&(t2$2215[0]==="symbol")))))))))){(s$2252=t2$2215[1]);(value$2253=function(){if((2>=t1$2214)){return null;}else{return t0$2213[2];}}());acc$2185.push((((t0$2263=variable$2251),function(){if($3143(t0$2263,"env")){(env$2260=t0$2263.env);}else{return $2942(variable$2251,"/home/olivier/git/earl-grey/src/expand.eg",9983,9991);}}()),((v$2261=__lt____lt____colon__$986(["variable",it$0$1947.gensym(s$2252)],variable$2251))),env$2260.bind(newscope$2158,s$2252,v$2261),(changes$2160=true),function(){if(value$2253){return ["splice",["newargs",["assign",v$2261,value$2253]],["vars",v$2261]];}else{return ["vars",v$2261];}}()));}else{if(($2182$2222&&((v$2272=t2$2215),((t2$2215 instanceof Array)&&((t3$2216=t2$2215.length),((t3$2216===2)&&(t2$2215[0]==="variable"))))))){t2$2215[1];(value$2273=function(){if((2>=t1$2214)){return null;}else{return t0$2213[2];}}());acc$2185.push(((changes$2160=true),function(){if(value$2273){return ["splice",["newargs",["assign",v$2272,value$2273]],["vars",v$2272]];}else{return ["vars",v$2272];}}()));}else{(other$2281=m$2208);acc$2185.push(["newargs",other$2281]);}}}}}}()))),acc$2185)));if(($3143(t0$2174,"newargs")&&((newargs$2161=t0$2174.newargs),$3143(t0$2174,"vars")))){(vars$2162=t0$2174.vars);;}else{$2942(classify$988("newargs","vars",(((acc$2295=[])),(((temp$2300=it$0$1947.step_all(["expr","multi"],stepscope$2159,args$2154))),((($length$2305=temp$2300.length)),((($index$2310=0)),function(){$2286:for(;($index$2310<$length$2305);($index$2310++)){var t0$2355;var env$2353;var t0$2373;var env$2370;var v$2371;var other$2391;var v$2382;var value$2383;var variable$2361;var s$2362;var value$2363;var variable$2344;var s$2345;var value$2346;var opt$2336;var value$2337;var $2288$2328;var $2289$2329;var $2290$2330;var $2291$2331;var $2292$2332;var $2293$2333;var t0$2323;var t1$2324;var t2$2325;var t3$2326;var m$2318;(m$2318=temp$2300[$index$2310]);;(t0$2323=m$2318);if((($2289$2329=(t0$2323 instanceof Array))&&((t1$2324=t0$2323.length),(($2291$2331=(t1$2324===3))&&(t0$2323[0]==="option"))))){(opt$2336=t0$2323[1]);(value$2337=t0$2323[2]);acc$2295.push((newscope$2158.setopt(opt$2336,value$2337),["ignore"]));}else{if(($2291$2331&&((t0$2323[0]==="declare_raw")&&((t2$2325=t0$2323[1]),((variable$2344=t2$2325),((t2$2325 instanceof Array)&&((t3$2326=t2$2325.length),((t3$2326===2)&&(t2$2325[0]==="symbol"))))))))){(s$2345=t2$2325[1]);(value$2346=t0$2323[2]);acc$2295.push((((t0$2355=variable$2344),function(){if($3143(t0$2355,"env")){(env$2353=t0$2355.env);}else{return $2942(variable$2344,"/home/olivier/git/earl-grey/src/expand.eg",9738,9746);}}()),env$2353.bind(newscope$2158,s$2345,value$2346),(changes$2160=true),["ignore"]));}else{if(($2289$2329&&(($2291$2331=((t1$2324>=2)&&(t1$2324<=3)))&&(($2292$2332=(t0$2323[0]==="declare"))&&((t2$2325=t0$2323[1]),((variable$2361=t2$2325),((t2$2325 instanceof Array)&&((t3$2326=t2$2325.length),((t3$2326===2)&&(t2$2325[0]==="symbol")))))))))){(s$2362=t2$2325[1]);(value$2363=function(){if((2>=t1$2324)){return null;}else{return t0$2323[2];}}());acc$2295.push((((t0$2373=variable$2361),function(){if($3143(t0$2373,"env")){(env$2370=t0$2373.env);}else{return $2942(variable$2361,"/home/olivier/git/earl-grey/src/expand.eg",9983,9991);}}()),((v$2371=__lt____lt____colon__$986(["variable",it$0$1947.gensym(s$2362)],variable$2361))),env$2370.bind(newscope$2158,s$2362,v$2371),(changes$2160=true),function(){if(value$2363){return ["splice",["newargs",["assign",v$2371,value$2363]],["vars",v$2371]];}else{return ["vars",v$2371];}}()));}else{if(($2292$2332&&((v$2382=t2$2325),((t2$2325 instanceof Array)&&((t3$2326=t2$2325.length),((t3$2326===2)&&(t2$2325[0]==="variable"))))))){t2$2325[1];(value$2383=function(){if((2>=t1$2324)){return null;}else{return t0$2323[2];}}());acc$2295.push(((changes$2160=true),function(){if(value$2383){return ["splice",["newargs",["assign",v$2382,value$2383]],["vars",v$2382]];}else{return ["vars",v$2382];}}()));}else{(other$2391=m$2318);acc$2295.push(["newargs",other$2391]);}}}}}}()))),acc$2295)),"/home/olivier/git/earl-grey/src/expand.eg",9410,10931);}(exp$2163=function(s$2396){var $index$2422;var $length$2417;var temp$2412;var acc$2407;var $index$2464;var $length$2459;var temp$2454;var acc$2449;var stepped$2399;(stepped$2399=(((acc$2407=[])),(((temp$2412=enumerate$991(newargs$2161))),((($length$2417=temp$2412.length)),((($index$2422=0)),function(){$2404:for(;($index$2422<$length$2417);($index$2422++)){var i$2440;var arg$2441;var t0$2435;var t1$2436;var m$2430;(m$2430=temp$2412[$index$2422]);;(t0$2435=m$2430);if(((t0$2435 instanceof Array)&&((t1$2436=t0$2435.length),(t1$2436===2)))){(i$2440=t0$2435[0]);(arg$2441=t0$2435[1]);acc$2407.push(it$0$1947.step(["expr",function(){if((i$2440===(newargs$2161.length-1))){return "expr";}else{return "ignore";}}()],s$2396,arg$2441));}else{$2942(m$2430,"/home/olivier/git/earl-grey/src/expand.eg",11153,11330);;}}}()))),acc$2407));;(acc$2449=[]);;(temp$2454=stepped$2399);;($length$2459=temp$2454.length);;($index$2464=0);;$2400:for(;($index$2464<$length$2459);($index$2464++)){var arg$2480;var m$2472;(m$2472=temp$2454[$index$2464]);;(arg$2480=m$2472);acc$2449.push(helper$1952(["expr","expr"],s$2396,arg$2480));}return acc$2449;});;if(changes$2160){return ["scope",vars$2162,["multi"].concat(exp$2163(newscope$2158))];}else{return ["multi"].concat(exp$2163(scope$1957));}}else{if(($1965$1978&&($1961$1967[0]==="data"))){(args$2485=Array.prototype.slice.call($1961$1967,1));(is_obj$2489=false);;(obj$2490=["object"]);;(arr$2491=["array"]);;(arr_parts$2492=[]);;(obj_parts$2493=[]);;(new_arr_part$2494=function(){var other$2538;var t0$2529;var $2522$2524;($2522$2524=arr$2491);;if((($2522$2524 instanceof Array)&&((t0$2529=$2522$2524.length),((t0$2529===1)&&($2522$2524[0]==="array"))))){return false;}else{(other$2538=$2522$2524);arr_parts$2492.push(arr$2491);return (arr$2491=["array"]);}});;(new_obj_part$2495=function(){var other$2562;var t0$2553;var $2546$2548;($2546$2548=obj$2490);;if((($2546$2548 instanceof Array)&&((t0$2553=$2546$2548.length),((t0$2553===1)&&($2546$2548[0]==="object"))))){return false;}else{(other$2562=$2546$2548);obj_parts$2493.push(obj$2490);return (obj$2490=["object"]);}});;(temp$2568=it$0$1947.step_all(["expr","data"],scope$1957,args$2485));;($length$2573=temp$2568.length);;($index$2578=0);;$2497:for(;($index$2578<$length$2573);($index$2578++)){var other$2624;var expr$2618;var expr$2612;var k$2605;var v$2606;var $2499$2594;var $2500$2595;var $2501$2596;var $2502$2597;var t0$2591;var t1$2592;var m$2586;(m$2586=temp$2568[$index$2578]);;(t0$2591=m$2586);if((($2500$2595=(t0$2591 instanceof Array))&&((t1$2592=t0$2591.length),((t1$2592===1)&&(t0$2591[0]==="assoc"))))){(is_obj$2489=true);}else{if(($2500$2595&&((t1$2592===3)&&(t0$2591[0]==="assoc")))){(k$2605=t0$2591[1]);(v$2606=t0$2591[2]);(is_obj$2489=true);obj$2490.push(["array",k$2605,v$2606]);}else{if(($2500$2595&&(($2502$2597=(t1$2592===2))&&(t0$2591[0]==="dynsplice")))){(expr$2612=t0$2591[1]);new_arr_part$2494();arr_parts$2492.push(expr$2612);}else{if(($2502$2597&&(t0$2591[0]==="objsplice"))){(expr$2618=t0$2591[1]);(is_obj$2489=true);new_obj_part$2495();obj_parts$2493.push(expr$2618);}else{(other$2624=m$2586);arr$2491.push(other$2624);}}}}}new_arr_part$2494();new_obj_part$2495();(r$2496=((($2628$2630=arr_parts$2492)),function(){if((($2628$2630 instanceof Array)&&((t0$2635=$2628$2630.length),((t0$2635===0)&&is_obj$2489)))){return util$987.construct(obj_parts$2493,function(x$2643,rest$2644){return ["send",["symbol","&:"],["data",x$2643,rest$2644]];},["object"]);}else{$2628$2630;if(is_obj$2489){throw $2955(["syntax","array","object"]).create("Cannot mix array and object notations.");}else{(other$2652=$2628$2630);return util$987.construct(arr_parts$2492.reverse(),function(x$2655,rest$2656){return ["send",["send",rest$2656,["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",x$2655]];},["array"]);}}}()));;return helper$1952(context$1956,scope$1957,it$0$1947.mkenv().convert(r$2496));}else{if(($1963$1976&&(($1965$1978=(t0$1972===3))&&($1961$1967[0]==="assign")))){(target$2661=$1961$1967[1]);(value$2662=$1961$1967[2]);return ["assign",helper$1952(["expr","expr"],scope$1957,target$2661),helper$1952(["expr","expr"],scope$1957,value$2662)];}else{if(($1965$1978&&($1961$1967[0]==="lambda"))){(bindings$2667=$1961$1967[1]);(body$2668=$1961$1967[2]);(newscope$2672=Scope$1000(scope$1957));;return ["lambda",(((acc$2680=[])),(((temp$2685=bindings$2667)),((($length$2690=temp$2685.length)),((($index$2695=0)),function(){$2676:for(;($index$2695<$length$2690);($index$2695++)){var v$2721;var x$2731;var other$2738;var v$2728;var b$2714;var env$2715;var $2678$2711;var t0$2708;var t1$2709;var m$2703;(m$2703=temp$2685[$index$2695]);;(t0$2708=m$2703);if(((t0$2708 instanceof Array)&&((t1$2709=t0$2708.length),((t1$2709===2)&&((t0$2708[0]==="symbol")&&((b$2714=t0$2708[1]),$3143(t0$2708,"env"))))))){(env$2715=t0$2708.env);acc$2680.push((((v$2721=["variable",it$0$1947.gensym(b$2714)])),(env$2715.bind(newscope$2672,b$2714,v$2721),v$2721)));}else{if((((x$2731=t0$2708)),((x$2731 instanceof Array)&&(x$2731[0]==="variable")))){(v$2728=t0$2708);acc$2680.push(v$2728);}else{(other$2738=m$2703);acc$2680.push(function(){throw $2955(["syntax","lambda","binding"]).create("Not a valid binding.",({"node":other$2738}));}());}}}}()))),acc$2680),helper$1952(["expr","expr"],newscope$2672,body$2668)];}else{if(($1965$1978&&($1961$1967[0]==="use"))){($1962$2743=$1961$1967[1]);(x$2742=$1961$1967[2]);(t0$2747=$1962$2743);if((typeof(t0$2747)==="string")){(name$2751=t0$2747);(s$2755=scope$1957);;$2759:while(s$2755){if((s$2755.name.slice(0,(name$2751.length+1))===(name$2751+"/"))){break $2759;}else{(s$2755=s$2755.parent);}}if(s$2755){return helper$1952(context$1956,s$2755,x$2742);}else{throw $2955(["syntax","noscope"]).create(("Could not find a scope tagged: "+name$2751));}}else{(newscope$2764=$1962$2743);return helper$1952(context$1956,newscope$2764,x$2742);}}else{if(($1965$1978&&(($1961$1967[0]==="tagscope")&&((t1$1973=$1961$1967[1]),(typeof(t1$1973)==="string"))))){(tag$2768=t1$1973);(body$2769=$1961$1967[2]);return helper$1952(context$1956,Scope$1000(scope$1957,it$0$1947.gensym((tag$2768+"/"))),body$2769);}else{if(($1963$1976&&((t0$1972>=1)&&((type$2775=$1961$1967[0]),((args$2776=Array.prototype.slice.call($1961$1967,1)),(it$0$1947.generic_nodes.indexOf(type$2775)!==-1)))))){return [type$2775].concat((((acc$2784=[])),(((temp$2789=args$2776)),((($length$2794=temp$2789.length)),((($index$2799=0)),function(){$2781:for(;($index$2799<$length$2794);($index$2799++)){var arg$2815;var m$2807;(m$2807=temp$2789[$index$2799]);;(arg$2815=m$2807);acc$2784.push(helper$1952(["expr","expr"],scope$1957,arg$2815));}}()))),acc$2784));}else{(other$2819=$1961$1967);throw $2955(["syntax","illegal_node"]).create("An illegal node was found.",({"node":other$2819,"context":context$1956}));}}}}}}}}}}}}}}}}}));;return helper$1952(context$1942,scope$1943,expr$1944);});$3131(Expander$1003,$3131(((accum$2823=({})),((accum$2823["::name"]="Expander"),accum$2823)),((accum$2827=({})),((accum$2827["::egclass"]=true),accum$2827))));Expander$1003;(mac1$1004=function(f$2833){return ["macro",function(context$2837,scope$2838,form$2839,$2835$2840){var t0$2844;var t1$2845;var expr$2842;(t0$2844=$2835$2840);if(((t0$2844 instanceof Array)&&((t1$2845=t0$2844.length),((t1$2845===2)&&(t0$2844[0]==="data"))))){(expr$2842=t0$2844[1]);;}else{$2942($2835$2840);}return f$2833(expr$2842);}];});;(__chk_ncache$1005=({}));;(__chk_scache$1006=({}));;(checker_db$1007=function($2859$2861){var v$2897;var v$2910;var s$2906;var n$2893;var $2863$2869;var ph$2864;(ph$2864=$2859$2861);;($2863$2869=ph$2864);;if(($2863$2869===null)){return checker_db$1007.null;}else{if(($2863$2869===(void 0))){return checker_db$1007.undefined;}else{if(($2863$2869===true)){return checker_db$1007.true;}else{if(($2863$2869===false)){return checker_db$1007.false;}else{if((typeof($2863$2869)==="number")){(n$2893=$2863$2869);if($947(__chk_ncache$1005,n$2893)){return $947(__chk_ncache$1005,n$2893);}else{(v$2897=mac1$1004(function(x$2901){return ["send",["symbol","==="],["data",x$2901,["value",n$2893]]];}));;(__chk_ncache$1005[n$2893]=v$2897);return v$2897;}}else{if((typeof($2863$2869)==="string")){(s$2906=$2863$2869);if(Object.prototype.hasOwnProperty.call(__chk_scache$1006,s$2906)){return $947(__chk_scache$1006,s$2906);}else{(v$2910=mac1$1004(function(x$2914){return ["send",["symbol","==="],["data",x$2914,["value",s$2906]]];}));;(__chk_scache$1006[s$2906]=v$2910);return v$2910;}}else{$2942($2863$2869);}}}}}}});;$3131(checker_db$1007,({"String":mac1$1004(function(x$2921){return ["send",["symbol","==="],["data",["send",["symbol","typeof"],["data",x$2921]],["value","string"]]];}),"Number":mac1$1004(function(x$2924){return ["send",["symbol","==="],["data",["send",["symbol","typeof"],["data",x$2924]],["value","number"]]];}),"Array":mac1$1004(function(x$2927){return ["send",["symbol","instanceof"],["data",x$2927,["symbol","Array"]]];}),"true":mac1$1004(function(x$2930){return x$2930;}),"false":mac1$1004(function(x$2933){return ["send",["symbol","not"],["data",["void"],x$2933]];}),"null":mac1$1004(function(x$2936){return ["send",["symbol","==="],["data",x$2936,["value",null]]];}),"undefined":mac1$1004(function(x$2939){return ["send",["symbol","==="],["data",x$2939,["value",(void 0)]]];})}));(exports["Env"]=Env$1001);(exports["Scope"]=Scope$1000);(exports["track_location"]=track_location$1002);(exports["Expander"]=Expander$1003);(exports["GenSym"]=GenSym$994);(exports["gensym"]=gensym$995);(exports["mac1"]=mac1$1004);(exports["checker_db"]=checker_db$1007);

},{"./location":7,"./pattern":10,"./pp":11,"./util":14}],6:[function(require,module,exports){
var $3374=function(type$3376){var f$3379;(f$3379=type$3376["::check"]);;if((f$3379===(void 0))){return function(value$3384){return (value$3384 instanceof type$3376);};}else{return function(value$3387){return f$3379.call(type$3376,value$3387);};}};
var $3389=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $3390=function($3391$3393){var ph$3397;(ph$3397=$3391$3393);;var $3395$3402;($3395$3402=ph$3397);;var bridge$3396$3407;var x$3411;(bridge$3396$3407=$3395$3402);if((((typeof(bridge$3396$3407)==="string")&&((x$3411=bridge$3396$3407),true))||((typeof(bridge$3396$3407)==="number")&&((x$3411=bridge$3396$3407),true)))){return ["value",x$3411];}else{var other$3418;(other$3418=$3395$3402);return other$3418["::serialize_ast"]();}};
var send$3214;(send$3214=function(obj$3219,$3217$3220){var ph$3224;var msg$3225;var t0$3227;(t0$3227=$3217$3220);(msg$3225=t0$3227);(ph$3224=t0$3227);;var $3222$3231;($3222$3231=ph$3224);;var bridge$3223$3236;(bridge$3223$3236=$3222$3231);if(((typeof(bridge$3223$3236)==="string")||(typeof(bridge$3223$3236)==="number"))){return obj$3219[msg$3225];}else{var other$3244;(other$3244=$3222$3231);return obj$3219["::send"](msg$3225);}});;(Array[":::project"]=function($3247$3249){var ph$3252;var value$3253;var t0$3255;(t0$3255=$3247$3249);(value$3253=t0$3255);(ph$3252=t0$3255);;var $3251$3259;($3251$3259=ph$3252);;if($3374(Array)($3251$3259)){return [true,value$3253];}else{$3251$3259;return [true,[value$3253]];}});(Array.prototype["::check"]=function(value$3273){if((value$3273 instanceof Array)){var i$3278;(i$3278=0);;$3276:for(;(i$3278<this.length);(i$3278++)){if(($3389(this,i$3278)!==$3389(value$3273,i$3278))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$3289){if((value$3289 instanceof Array)){var i$3294;(i$3294=0);;$3292:for(;(i$3294<this.length);(i$3294++)){if(($3389(this,i$3294)!==$3389(value$3289,i$3294))){return [true,[value$3289]];}}return [true,value$3289.slice(this.length)];}else{return [true,[value$3289]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($3390));});(RegExp.prototype["::check"]=function($3304$3306){var ph$3309;(ph$3309=$3304$3306);;var $3308$3314;($3308$3314=ph$3309);;var value$3322;if((typeof($3308$3314)==="string")){(value$3322=$3308$3314);if(value$3322.match(this)){return true;}else{return false;}}else{var other$3327;(other$3327=$3308$3314);return false;}});(RegExp.prototype[":::project"]=function($3329$3331){var ph$3334;(ph$3334=$3329$3331);;var $3333$3339;($3333$3339=ph$3334);;var value$3347;if((typeof($3333$3339)==="string")){(value$3347=$3333$3339);var $3350$3352;($3350$3352=value$3347.match(this));;var m$3360;if(($3350$3352===null)){(m$3360=$3350$3352);return [false,null];}else{var m$3365;(m$3365=$3350$3352);return [true,m$3365];}}else{var other$3369;(other$3369=$3333$3339);return [false,null];}});(Function.prototype["::send"]=function(args$3372){return this.apply(this,args$3372);});
var $4254=function(arr$4256){var results$4260;var l$4261;(results$4260=[]);;(l$4261=arr$4256.length);;var i$4269;(i$4269=0);;$4259:for(;(i$4269<l$4261);(i$4269++)){results$4260.push([i$4269,$3389(arr$4256,i$4269)]);}return results$4260;};
var $4276=function(dest$4278,values$4279){var k$4284;(k$4284=null);$4282:for(k$4284 in values$4279){if(values$4279.hasOwnProperty(k$4284)){(dest$4278[k$4284]=values$4279[k$4284]);}}return dest$4278;};
var $4100=function(){var $4101$4103;($4101$4103=function(tags$4107){var it$0$4110;(it$0$4110=function(){if((!$3374($4101$4103)(this))){return Object.create($4101$4103.prototype);}else{return this;}}());;(it$0$4110["tags"]=tags$4107);return it$0$4110;});;($4101$4103.prototype["create"]=function(){var $4119$4121;($4119$4121=arguments);;var t0$4126;var message$4130;var args$4131;(t0$4126=$4119$4121.length);if((t0$4126>=0)){(message$4130=function(){if((0>=t0$4126)){return "";}else{return $4119$4121[0];}}());(args$4131=Array.prototype.slice.call($4119$4121,1));var it$0$4135;(it$0$4135=this);;var e$4140;(e$4140=Error(message$4130));;(e$4140["::tags"]=it$0$4135.tags);(e$4140["args"]=args$4131);var temp$4148;(temp$4148=$4254(args$4131));;var $length$4153;($length$4153=temp$4148.length);;var $index$4158;($index$4158=0);;$4141:for(;($index$4158<$length$4153);($index$4158++)){var m$4166;(m$4166=temp$4148[$index$4158]);;var t0$4171;var t1$4172;var i$4176;var arg$4177;(t0$4171=m$4166);if(((t0$4171 instanceof Array)&&((t1$4172=t0$4171.length),(t1$4172===2)))){(i$4176=t0$4171[0]);(arg$4177=t0$4171[1]);(e$4140[i$4176]=arg$4177);}else{$4087(m$4166);;}}(e$4140["length"]=args$4131.length);(e$4140["name"]=["E"].concat(it$0$4135.tags).join("."));return e$4140;}else{$4087($4119$4121);}});($4101$4103.prototype["::check"]=function(e$4188){var it$0$4191;(it$0$4191=this);;var tags$4196;if(((!e$4188)||(!$3374(Error)(e$4188)))){return false;}(tags$4196=(e$4188["::tags"]||[]));;var temp$4205;(temp$4205=it$0$4191.tags);;var $length$4210;($length$4210=temp$4205.length);;var $index$4215;($index$4215=0);;$4197:for(;($index$4215<$length$4210);($index$4215++)){var m$4223;(m$4223=temp$4205[$index$4215]);;var tag$4231;(tag$4231=m$4223);if((tags$4196.indexOf(tag$4231)===-1)){return false;}else{false;;}}return true;});($4101$4103.prototype["::deconstruct"]=function(e$4239){var it$0$4242;(it$0$4242=this);;return e$4239.args;});$4276($4101$4103,$4276(function(){var accum$4247;(accum$4247=({}));(accum$4247["::name"]="$4101");return accum$4247;}(),function(){var accum$4251;(accum$4251=({}));(accum$4251["::egclass"]=true);return accum$4251;}()));return $4101$4103;}();
var $4087=function(value$4089,url$4090,start$4091,end$4092){var err$4095;(err$4095=$4100(["match"]).create("Could not find a match for value",({"value":value$4089})));;if(url$4090){(err$4095["location"]=["location",url$4090,start$4091,end$4092]);}throw err$4095;};var id$3447;var id_f$3448;var numr$3449;var numr_f$3450;var num$3451;var num_f$3452;var str$3453;var str_f$3454;var op$3455;var op2$3456;var op3$3457;var op4$3458;var op_f$3459;var indent$3460;var indent_f$3461;var cmnt$3462;var cmnt_f$3463;var unkn$3464;var unkn_f$3465;var $3421$3422;var Location$3423;var __lt____lt____colon__$3424;var special_ops$3425;var regexps$3426;var ws_re$3427;var eol_re$3428;var indent_tracker$3429;var process_token$3430;var tokenize$3431;($3421$3422=require("./location"));;(Location$3423=$3421$3422.Location);;(__lt____lt____colon__$3424=$3421$3422["<<:"]);;(special_ops$3425=({"(":"PFX","[":"PFX","{":"PFX",")":"SFX","]":"SFX","}":"SFX",",":"IFX",":":"IFX",".":"PFX","'":"PFX"}));;(regexps$3426=(((id$3447=RegExp("(?:^[a-zA-Z$_](?:[a-zA-Z$_0-9]*))",""))),((id_f$3448=function(m$3472,wsb$3473,wsa$3474,last_op$3475){return ["ID","ID",m$3472[0]];})),((numr$3449=RegExp("(?:^((?:\\d+))[rR]((?:[A-Za-z0-9_]+))(?:(?:\\.((?:[A-Za-z0-9_]+)))?))",""))),((numr_f$3450=function(m$3484,wsb$3485,wsa$3486,last_op$3487){var t0$3495;var t1$3496;var radix$3490;var intp$3491;var frac$3492;var value$3493;(t0$3495=m$3484);if(((t0$3495 instanceof Array)&&((t1$3496=t0$3495.length),(t1$3496===4)))){t0$3495[0];(radix$3490=t0$3495[1]);(intp$3491=t0$3495[2]);(frac$3492=t0$3495[3]);;}else{$4087(m$3484,"/home/olivier/git/earl-grey/src/lex.eg",980,981);}(value$3493=parseInt(intp$3491.replace(RegExp("_","g"),""),radix$3490));;if(frac$3492){(frac$3492=frac$3492.replace(RegExp("_","g"),""));(value$3493=(value$3493+(parseInt(frac$3492,radix$3490)/Math.pow(radix$3490,frac$3492.length))));}return ["ID","NUM",value$3493];})),((num$3451=RegExp("(?:^((?:[0-9_]+))(?:(?:\\.((?:\\d+)))?)(?:(?:[eE]((?:[+-]?)(?:[0-9_]+)))?))",""))),((num_f$3452=function(m$3512,wsb$3513,wsa$3514,last_op$3515){return ["ID","NUM",parseFloat(m$3512[0].replace(RegExp("_","g"),""))];})),((str$3453=RegExp("(?:^\"((?:(?:(?:\\\\\\\\|\\\\\")|[^\"])*))\")",""))),((str_f$3454=function(m$3524,wsb$3525,wsa$3526,last_op$3527){var repl$3530;var r$3531;(repl$3530=({"\\\"":"\"","\\\\":"\\","\\n":"\n"}));;(r$3531=m$3524[1].replace(RegExp("((?:(?:\\\\\"|\\\\\\\\)|\\\\n))","g"),function(m$3538){return $3389(repl$3530,m$3538);}));;return ["ID","STR",r$3531];})),((op$3455=RegExp("(?:^(?:[+\\-*/~\\^<>=%&|?!@#.:']+))",""))),((op2$3456=RegExp("(?:^[\\[\\{\\}\\],])",""))),((op3$3457=RegExp("(?:^(?:(?:(?:(?:(?:(?:(?:(?:(?:(?:with|where)|when)|and)|not)|or)|in)|instanceof)|mod)|each)|as)(?:(?:[+\\-*/~\\^<>=%&|?!@#.:']+)|\\b))",""))),((op4$3458=RegExp("(?:^`((?:[A-Za-z0-9_]+))`)",""))),((op_f$3459=function(m$3557,wsb$3558,wsa$3559,last_op$3560,column$3561){var other$3616;var $3594$3596;var fixity$3587;var width$3588;var $3565$3577;var $3564$3571;var op$3566;(op$3566=(m$3557[1]||m$3557[0]));;($3564$3571=null);;$3564$3571;if((op$3566==="|")){return ["INDENT",(column$3561-1)];}else{if((op$3566 in special_ops$3425)){(fixity$3587=$3389(special_ops$3425,op$3566));;(width$3588=((($3594$3596=fixity$3587)),function(){if(($3594$3596==="IFX")){if((wsb$3558||wsa$3559)){return "wide";}else{return "short";}}else{if(($3594$3596==="SFX")){if(wsb$3558){return "wide";}else{return "short";}}else{if(($3594$3596==="PFX")){if(wsa$3559){return "wide";}else{return "short";}}else{(other$3616=$3594$3596);throw $4100(["syntax","should_never_happen"]).create("unknown fixity");}}}}()));;return ["OP",fixity$3587,width$3588,op$3566];}else{if((wsa$3559&&wsb$3558)){return ["OP",function(){if(last_op$3560){return "PFX";}else{return "IFX";}}(),"wide",op$3566];}else{if(((!wsa$3559)&&(!wsb$3558))){return ["OP",function(){if(last_op$3560){return "PFX";}else{return "IFX";}}(),"short",op$3566];}else{if((wsa$3559&&last_op$3560)){return ["OP","PFX","wide",op$3566];}else{if(wsa$3559){return ["OP","SFX","short",op$3566];}else{if(wsb$3558){return ["OP","PFX","short",op$3566];}else{return ["OP","PFX","short",op$3566];}}}}}}}})),((indent$3460=RegExp("(?:^(?:(?:\n((?: *)))+))",""))),((indent_f$3461=function(m$3649,wsb$3650,wsa$3651,last_op$3652){var ilen$3655;(ilen$3655=m$3649[1].length);;return ["INDENT",ilen$3655];})),((cmnt$3462=RegExp("(?:^;(?:[^\n]*))",""))),((cmnt_f$3463=function(m$3666,wsb$3667,wsa$3668,last_op$3669){return ["IGNORE"];})),((unkn$3464=RegExp("(?:^.)",""))),((unkn_f$3465=function(m$3678,wsb$3679,wsa$3680,last_op$3681){return ["ILLEGAL",m$3678[0]];})),[[op3$3457,op_f$3459],[id$3447,id_f$3448],[numr$3449,numr_f$3450],[num$3451,num_f$3452],[str$3453,str_f$3454],[op$3455,op_f$3459],[op2$3456,op_f$3459],[op4$3458,op_f$3459],[indent$3460,indent_f$3461],[cmnt$3462,cmnt_f$3463],[unkn$3464,unkn_f$3465]]));;(ws_re$3427=RegExp("(?:^(?: *)(?:(?:\n(?: *)\\\\(?: *))*))",""));;(eol_re$3428=RegExp("(?:^(?: *)(?:\n|$))",""));;(indent_tracker$3429=function(){var curr$3697;var stack$3698;var stacks$3699;(curr$3697=false);;(stack$3698=[]);;(stacks$3699=[stack$3698]);;return function($3696$3710){var t0$3723;var rval$3769;var $index$3825;var $length$3820;var temp$3815;var acc$3810;var rval$3804;var other$3845;var fixity$3796;var width$3797;var fixity$3786;var width$3787;var stuff$3781;var new_indent$3743;var $3713$3744;var $3716$3737;var $3717$3738;var $3718$3739;var $3719$3740;var t0$3732;var t1$3733;var bridge$3714$3734;var bridge$3715$3735;var $3712$3727;var ph$3720;var token$3721;(t0$3723=$3696$3710);(token$3721=t0$3723);(ph$3720=t0$3723);;($3712$3727=ph$3720);;if((($3716$3737=($3712$3727 instanceof Array))&&((t0$3732=$3712$3727.length),((t0$3732===2)&&($3712$3727[0]==="INDENT"))))){(t1$3733=$3712$3727[1]);(new_indent$3743=t1$3733);($3713$3744=t1$3733);$3713$3744;if((curr$3697===false)){(curr$3697=new_indent$3743);return [["OP","IFX","wide",","]];}else{if(($3713$3744>curr$3697)){$3389(stack$3698.push(curr$3697),(curr$3697=new_indent$3743));return [["OP","PFX","wide","["]];}else{if(($3713$3744===curr$3697)){return [["OP","IFX","wide",","]];}else{if(($3713$3744<curr$3697)){(rval$3769=[]);;$3773:while(((stack$3698.length>0)&&(new_indent$3743<curr$3697))){(curr$3697=stack$3698.pop());rval$3769.push(["OP","SFX","wide","]"]);}rval$3769.push(["OP","IFX","wide",","]);return rval$3769;}else{$4087($3713$3744,"/home/olivier/git/earl-grey/src/lex.eg",4969,4985);}}}}}else{if(($3716$3737&&((t0$3732>=1)&&($3712$3727[0]==="ID")))){(stuff$3781=Array.prototype.slice.call($3712$3727,1));return [token$3721];}else{if(($3716$3737&&(($3718$3739=(t0$3732===4))&&(($3719$3740=($3712$3727[0]==="OP"))&&((fixity$3786=$3712$3727[1]),((width$3787=$3712$3727[2]),((bridge$3714$3734=$3712$3727[3]),((bridge$3714$3734==="[")||(bridge$3714$3734==="{"))))))))){stack$3698.push(curr$3697);stacks$3699.push(stack$3698);(stack$3698=[]);(curr$3697=false);return [token$3721];}else{if(($3719$3740&&((fixity$3796=$3712$3727[1]),((width$3797=$3712$3727[2]),((bridge$3715$3735=$3712$3727[3]),((bridge$3715$3735==="]")||(bridge$3715$3735==="}"))))))){(rval$3804=(((acc$3810=[])),(((temp$3815=stack$3698)),((($length$3820=temp$3815.length)),((($index$3825=0)),function(){$3807:for(;($index$3825<$length$3820);($index$3825++)){var m$3833;(m$3833=temp$3815[$index$3825]);;m$3833;acc$3810.push(["OP","SFX","short","]"]);}}()))),acc$3810));;(stack$3698=stacks$3699.pop());(curr$3697=stack$3698.pop());rval$3804.push(token$3721);return rval$3804;}else{(other$3845=$3712$3727);return [token$3721];}}}}};});;(process_token$3430=function(src$3851,token$3852,last_op$3853,wsa$3854,wsb$3855,pos$3856,endpos$3857,accum$3858){var t0$3865;var t1$3866;var w$3888;var v$3899;var w$3921;var v$3922;var v$3934;var $3897$3904;var other$3946;var $3861$3872;var type$3862;var result$3863;(t0$3865=token$3852);if(((t0$3865 instanceof Array)&&((t1$3866=t0$3865.length),(t1$3866>=1)))){(type$3862=t0$3865[0]);(result$3863=Array.prototype.slice.call(t0$3865,1));;}else{$4087(token$3852,"/home/olivier/git/earl-grey/src/lex.eg",6493,6498);}__lt____lt____colon__$3424(result$3863,token$3852);($3861$3872=type$3862);;if(($3861$3872==="IGNORE")){return last_op$3853;}else{if(($3861$3872==="ID")){if((!last_op$3853)){(w$3888=["IFX",function(){if(wsb$3855){return "wide";}else{return "short";}}(),"WHITE"]);;(w$3888["location"]=Location$3423(src$3851,pos$3856,pos$3856));accum$3858.push(w$3888);}accum$3858.push(result$3863);return false;}else{if(($3861$3872==="OP")){if(last_op$3853){(v$3899=["VOID"]);;(v$3899["location"]=Location$3423(src$3851,pos$3856,pos$3856));accum$3858.push(v$3899);}($3897$3904=result$3863[0]);;if(($3897$3904==="IFX")){accum$3858.push(result$3863);return true;}else{if(($3897$3904==="PFX")){if((!last_op$3853)){(w$3921=["IFX",function(){if(wsb$3855){return "wide";}else{return "short";}}(),"WHITE"]);;(w$3921["location"]=Location$3423(src$3851,pos$3856,pos$3856));(v$3922=["VOID"]);;(v$3922["location"]=Location$3423(src$3851,pos$3856,pos$3856));accum$3858.push(w$3921);accum$3858.push(v$3922);}accum$3858.push(result$3863);return true;}else{if(($3897$3904==="SFX")){accum$3858.push(result$3863);(v$3934=["VOID"]);;(v$3934["location"]=Location$3423(src$3851,endpos$3857,endpos$3857));accum$3858.push(v$3934);return false;}else{$4087($3897$3904);}}}}else{if(($3861$3872==="ILLEGAL")){throw $4100(["syntax","illegal"]).create("unknown character",({"chr":token$3852}));}else{(other$3946=$3861$3872);throw $4100(["should_never_happen"]).create("unknown token type",({"token":token$3852}));}}}}});;(tokenize$3431=function(src$3952){var v$4081;var text$3955;var last_op$3956;var results$3957;var wsb$3958;var pos$3959;var column$3960;var indent$3961;(text$3955=src$3952.text);;(last_op$3956=true);;(results$3957=[]);;(wsb$3958=text$3955.match(ws_re$3427)[0].length);;(text$3955=text$3955.slice(wsb$3958));(pos$3959=wsb$3958);;(column$3960=0);;(indent$3961=indent_tracker$3429());;$3983:while(text$3955){var i$3988;(i$3988=0);;$3986:for(;(i$3988<regexps$3426.length);(++i$3988)){var t0$4000;var t1$4001;var splits$4027;var $index$4061;var $length$4056;var temp$4051;var skip$4010;var endpos$4011;var wsa$4012;var eol$4013;var bwsb$4014;var bwsa$4015;var token$4016;var tokens$4017;var re$3996;var fn$3997;var m$3998;(t0$4000=$3389(regexps$3426,i$3988));if(((t0$4000 instanceof Array)&&((t1$4001=t0$4000.length),(t1$4001===2)))){(re$3996=t0$4000[0]);(fn$3997=t0$4000[1]);;}else{$4087($3389(regexps$3426,i$3988),"/home/olivier/git/earl-grey/src/lex.eg",8067,8077);}(m$3998=text$3955.match(re$3996));;if(m$3998){(skip$4010=m$3998[0].length);;(endpos$4011=(pos$3959+skip$4010));;(column$3960=(((splits$4027=m$3998[0].split("\n"))),function(){if((splits$4027.length>1)){return $3389(splits$4027,(splits$4027.length-1)).length;}else{return (column$3960+skip$4010);}}()));(text$3955=text$3955.slice(skip$4010));(wsa$4012=text$3955.match(ws_re$3427)[0].length);;(eol$4013=(text$3955.match(eol_re$3428)&&true));;(bwsb$4014=(wsb$3958>0));;(bwsa$4015=function(){if(eol$4013){return bwsb$4014;}else{return (wsa$4012>0);}}());;(token$4016=fn$3997(m$3998,bwsb$4014,bwsa$4015,last_op$3956,column$3960));;(tokens$4017=indent$3961(token$4016));;(temp$4051=tokens$4017);;($length$4056=temp$4051.length);;($index$4061=0);;$4018:for(;($index$4061<$length$4056);($index$4061++)){var x$4077;var m$4069;(m$4069=temp$4051[$index$4061]);;(x$4077=m$4069);(x$4077["location"]=Location$3423(src$3952,pos$3959,endpos$4011));(last_op$3956=process_token$3430(src$3952,x$4077,last_op$3956,bwsa$4015,bwsb$4014,pos$3959,endpos$4011,results$3957));}(text$3955=text$3955.slice(wsa$4012));(column$3960=(column$3960+wsa$4012));(wsb$3958=wsa$4012);(pos$3959=(endpos$4011+wsa$4012));break $3986;}}}if(last_op$3956){(v$4081=["VOID"]);;(v$4081["location"]=[pos$3959,pos$3959]);results$3957.push(v$4081);}return results$3957;});;(exports["tokenize"]=tokenize$3431);

},{"./location":7}],7:[function(require,module,exports){
var $4449=function(type$4451){var f$4454;(f$4454=type$4451["::check"]);;if((f$4454===(void 0))){return function(value$4459){return (value$4459 instanceof type$4451);};}else{return function(value$4462){return f$4454.call(type$4451,value$4462);};}};
var $4464=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $4465=function($4466$4468){var ph$4472;(ph$4472=$4466$4468);;var $4470$4477;($4470$4477=ph$4472);;var bridge$4471$4482;var x$4486;(bridge$4471$4482=$4470$4477);if((((typeof(bridge$4471$4482)==="string")&&((x$4486=bridge$4471$4482),true))||((typeof(bridge$4471$4482)==="number")&&((x$4486=bridge$4471$4482),true)))){return ["value",x$4486];}else{var other$4493;(other$4493=$4470$4477);return other$4493["::serialize_ast"]();}};
var send$4289;(send$4289=function(obj$4294,$4292$4295){var ph$4299;var msg$4300;var t0$4302;(t0$4302=$4292$4295);(msg$4300=t0$4302);(ph$4299=t0$4302);;var $4297$4306;($4297$4306=ph$4299);;var bridge$4298$4311;(bridge$4298$4311=$4297$4306);if(((typeof(bridge$4298$4311)==="string")||(typeof(bridge$4298$4311)==="number"))){return obj$4294[msg$4300];}else{var other$4319;(other$4319=$4297$4306);return obj$4294["::send"](msg$4300);}});;(Array[":::project"]=function($4322$4324){var ph$4327;var value$4328;var t0$4330;(t0$4330=$4322$4324);(value$4328=t0$4330);(ph$4327=t0$4330);;var $4326$4334;($4326$4334=ph$4327);;if($4449(Array)($4326$4334)){return [true,value$4328];}else{$4326$4334;return [true,[value$4328]];}});(Array.prototype["::check"]=function(value$4348){if((value$4348 instanceof Array)){var i$4353;(i$4353=0);;$4351:for(;(i$4353<this.length);(i$4353++)){if(($4464(this,i$4353)!==$4464(value$4348,i$4353))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$4364){if((value$4364 instanceof Array)){var i$4369;(i$4369=0);;$4367:for(;(i$4369<this.length);(i$4369++)){if(($4464(this,i$4369)!==$4464(value$4364,i$4369))){return [true,[value$4364]];}}return [true,value$4364.slice(this.length)];}else{return [true,[value$4364]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($4465));});(RegExp.prototype["::check"]=function($4379$4381){var ph$4384;(ph$4384=$4379$4381);;var $4383$4389;($4383$4389=ph$4384);;var value$4397;if((typeof($4383$4389)==="string")){(value$4397=$4383$4389);if(value$4397.match(this)){return true;}else{return false;}}else{var other$4402;(other$4402=$4383$4389);return false;}});(RegExp.prototype[":::project"]=function($4404$4406){var ph$4409;(ph$4409=$4404$4406);;var $4408$4414;($4408$4414=ph$4409);;var value$4422;if((typeof($4408$4414)==="string")){(value$4422=$4408$4414);var $4425$4427;($4425$4427=value$4422.match(this));;var m$4435;if(($4425$4427===null)){(m$4435=$4425$4427);return [false,null];}else{var m$4440;(m$4440=$4425$4427);return [true,m$4440];}}else{var other$4444;(other$4444=$4408$4414);return [false,null];}});(Function.prototype["::send"]=function(args$4447){return this.apply(this,args$4447);});
var $6166=function(arr$6168){var results$6172;var l$6173;(results$6172=[]);;(l$6173=arr$6168.length);;var i$6181;(i$6181=0);;$6171:for(;(i$6181<l$6173);(i$6181++)){results$6172.push([i$6181,$4464(arr$6168,i$6181)]);}return results$6172;};
var $6188=function(dest$6190,values$6191){var k$6196;(k$6196=null);$6194:for(k$6196 in values$6191){if(values$6191.hasOwnProperty(k$6196)){(dest$6190[k$6196]=values$6191[k$6196]);}}return dest$6190;};
var $6012=function(){var $6013$6015;($6013$6015=function(tags$6019){var it$0$6022;(it$0$6022=function(){if((!$4449($6013$6015)(this))){return Object.create($6013$6015.prototype);}else{return this;}}());;(it$0$6022["tags"]=tags$6019);return it$0$6022;});;($6013$6015.prototype["create"]=function(){var $6031$6033;($6031$6033=arguments);;var t0$6038;var message$6042;var args$6043;(t0$6038=$6031$6033.length);if((t0$6038>=0)){(message$6042=function(){if((0>=t0$6038)){return "";}else{return $6031$6033[0];}}());(args$6043=Array.prototype.slice.call($6031$6033,1));var it$0$6047;(it$0$6047=this);;var e$6052;(e$6052=Error(message$6042));;(e$6052["::tags"]=it$0$6047.tags);(e$6052["args"]=args$6043);var temp$6060;(temp$6060=$6166(args$6043));;var $length$6065;($length$6065=temp$6060.length);;var $index$6070;($index$6070=0);;$6053:for(;($index$6070<$length$6065);($index$6070++)){var m$6078;(m$6078=temp$6060[$index$6070]);;var t0$6083;var t1$6084;var i$6088;var arg$6089;(t0$6083=m$6078);if(((t0$6083 instanceof Array)&&((t1$6084=t0$6083.length),(t1$6084===2)))){(i$6088=t0$6083[0]);(arg$6089=t0$6083[1]);(e$6052[i$6088]=arg$6089);}else{$5999(m$6078);;}}(e$6052["length"]=args$6043.length);(e$6052["name"]=["E"].concat(it$0$6047.tags).join("."));return e$6052;}else{$5999($6031$6033);}});($6013$6015.prototype["::check"]=function(e$6100){var it$0$6103;(it$0$6103=this);;var tags$6108;if(((!e$6100)||(!$4449(Error)(e$6100)))){return false;}(tags$6108=(e$6100["::tags"]||[]));;var temp$6117;(temp$6117=it$0$6103.tags);;var $length$6122;($length$6122=temp$6117.length);;var $index$6127;($index$6127=0);;$6109:for(;($index$6127<$length$6122);($index$6127++)){var m$6135;(m$6135=temp$6117[$index$6127]);;var tag$6143;(tag$6143=m$6135);if((tags$6108.indexOf(tag$6143)===-1)){return false;}else{false;;}}return true;});($6013$6015.prototype["::deconstruct"]=function(e$6151){var it$0$6154;(it$0$6154=this);;return e$6151.args;});$6188($6013$6015,$6188(function(){var accum$6159;(accum$6159=({}));(accum$6159["::name"]="$6013");return accum$6159;}(),function(){var accum$6163;(accum$6163=({}));(accum$6163["::egclass"]=true);return accum$6163;}()));return $6013$6015;}();
var $5999=function(value$6001,url$6002,start$6003,end$6004){var err$6007;(err$6007=$6012(["match"]).create("Could not find a match for value",({"value":value$6001})));;if(url$6002){(err$6007["location"]=["location",url$6002,start$6003,end$6004]);}throw err$6007;};
var $6322=function(type$6324){return function(value$6327){var f$6330;(f$6330=type$6324[":::project"]);;if((f$6330===(void 0))){var f$6335;(f$6335=type$6324["::project"]);;if((f$6335===(void 0))){return [true,type$6324(value$6327)];}else{var rval$6340;(rval$6340=false);;try{(rval$6340=[true,f$6335(value$6327)]);}catch(excv$6346){var e$6352;(e$6352=excv$6346);(rval$6340=[false,null]);}return rval$6340;}}else{return f$6330.call(type$6324,value$6327);}};};
var $6200=function(){var $6201$6203;($6201$6203=function($6206$6209,$6207$6210){var classes$6212;var children$6213;var t0$6215;(t0$6215=$6322(Array)($6206$6209));if(t0$6215[0]){(classes$6212=t0$6215[1]);;}else{$5999($6206$6209);}var t0$6220;(t0$6220=$6322(Array)($6207$6210));if(t0$6220[0]){(children$6213=t0$6220[1]);;}else{$5999($6207$6210);}var it$0$6225;(it$0$6225=function(){if((!$4449($6201$6203)(this))){return Object.create($6201$6203.prototype);}else{return this;}}());;(it$0$6225["classes"]=classes$6212.sort());(it$0$6225["children"]=children$6213);return it$0$6225;});;$6188(function(){var accum$6233;(accum$6233=({}));(accum$6233["::check"]=function(x$6237){return ((x$6237&&x$6237.classes)&&x$6237.children);});return accum$6233;}(),$6188(function(){var accum$6240;(accum$6240=({}));(accum$6240["::deconstruct"]=function(x$6244){return [x$6244.classes,x$6244.children];});return accum$6240;}(),$6188(function(){var accum$6247;(accum$6247=({}));(accum$6247["::name"]="$6201");return accum$6247;}(),function(){var accum$6251;(accum$6251=({}));(accum$6251["::egclass"]=true);return accum$6251;}())));($6201$6203.prototype["::check"]=function(n$6257){var it$0$6260;(it$0$6260=this);;var temp$6269;(temp$6269=it$0$6260.classes);;var $length$6274;($length$6274=temp$6269.length);;var $index$6279;($index$6279=0);;$6265:for(;($index$6279<$length$6274);($index$6279++)){var m$6287;(m$6287=temp$6269[$index$6279]);;var c$6295;(c$6295=m$6287);if((n$6257.classes.indexOf(c$6295)===-1)){return false;}else{false;;}}return true;});$6188($6201$6203,$6188(function(){var accum$6301;(accum$6301=({}));(accum$6301["::check"]=function(x$6305){return ((x$6305&&x$6305.classes)&&x$6305.children);});return accum$6301;}(),$6188(function(){var accum$6308;(accum$6308=({}));(accum$6308["::deconstruct"]=function(x$6312){return [x$6312.classes,x$6312.children];});return accum$6308;}(),$6188(function(){var accum$6315;(accum$6315=({}));(accum$6315["::name"]="$6201");return accum$6315;}(),function(){var accum$6319;(accum$6319=({}));(accum$6319["::egclass"]=true);return accum$6319;}()))));return $6201$6203;}();
var $6354=function(from$6356,to$6357){var rval$6361;(rval$6361=[]);;var i$6366;(i$6366=from$6356);;$6360:for(;(i$6366<=to$6357);(i$6366++)){rval$6361.push(i$6366);}return rval$6361;};
var $6373=function($6374$6376,key$6377){var ph$6381;(ph$6381=$6374$6376);;var $6379$6386;($6379$6386=ph$6381);;var bridge$6380$6391;(bridge$6380$6391=$6379$6386);if(((bridge$6380$6391===null)||(bridge$6380$6391===(void 0)))){return false;}else{var x$6399;if((typeof($6379$6386)==="string")){(x$6399=$6379$6386);return (key$6377 in String.prototype);}else{var x$6404;if((typeof($6379$6386)==="number")){(x$6404=$6379$6386);return (key$6377 in Number.prototype);}else{var x$6409;(x$6409=$6379$6386);return (key$6377 in x$6409);}}}};var accum$4640;var accum$4644;var accum$4845;var accum$4849;var $4496$4498;var binsearch$4499;var items$4500;var enumerate$4501;var $4497$4502;var __lt____gt__$4503;var repr$4504;var fs$4505;var Source$4506;var Location$4507;var highlight$4508;var highlight_lines$4509;var clamp$4510;var morsel$4511;var highlight_locations$4512;var highlight_locations_same_source$4513;var merge_locations$4514;var __lt____lt____colon__$4515;var __plus____plus____colon__$4516;var format_error$4517;var display_error$4518;($4496$4498=require("./util"));;(binsearch$4499=$4496$4498.binsearch);;(items$4500=$4496$4498.items);;(enumerate$4501=$4496$4498.enumerate);;($4497$4502=require("./pp"));;(__lt____gt__$4503=$4497$4502["<>"]);;(repr$4504=$4497$4502.repr);;(fs$4505=require("fs"));;(Source$4506=function(){var $index$4586;var $length$4581;var temp$4576;var curr$4568;var it$0$4562;var text$4557;var url$4558;var t0$4553;var $4546$4548;($4546$4548=arguments);;(t0$4553=$4546$4548.length);if(((t0$4553>=1)&&(t0$4553<=2))){(text$4557=$4546$4548[0]);(url$4558=function(){if((1>=t0$4553)){return false;}else{return $4546$4548[1];}}());(it$0$4562=function(){if((!$4449(Source$4506)(this))){return Object.create(Source$4506.prototype);}else{return this;}}());;(it$0$4562["text"]=text$4557);(it$0$4562["url"]=url$4558);(it$0$4562["counts"]=[]);(curr$4568=0);;(temp$4576=text$4557.split("\n"));;($length$4581=temp$4576.length);;($index$4586=0);;$4569:for(;($index$4586<$length$4581);($index$4586++)){var line$4602;var m$4594;(m$4594=temp$4576[$index$4586]);;(line$4602=m$4594);it$0$4562.counts.push(curr$4568);(curr$4568=(curr$4568+(line$4602.length+1)));}it$0$4562.counts.push(curr$4568);(it$0$4562["nlines"]=(it$0$4562.counts.length-1));return it$0$4562;}else{$5999($4546$4548);}});;(Source$4506.prototype["linecol"]=function(pos$4611){var line$4619;var col$4620;var it$0$4614;(it$0$4614=this);;(line$4619=binsearch$4499(it$0$4614.counts,pos$4611));;(col$4620=(pos$4611-$4464(it$0$4614.counts,(line$4619-1))));;return [line$4619,col$4620];});(Source$4506.prototype["highlight_lines"]=function(l1$4630,l2$4631,spans$4632){var it$0$4635;(it$0$4635=this);;return highlight_lines$4509(it$0$4635.text,it$0$4635.counts,[(l1$4630-1),(l2$4631-1)],spans$4632);});$6188(Source$4506,$6188(((accum$4640=({})),((accum$4640["::name"]="Source"),accum$4640)),((accum$4644=({})),((accum$4644["::egclass"]=true),accum$4644))));Source$4506;(Location$4507=function(source$4650,start$4651,end$4652){var it$0$4655;(it$0$4655=function(){if((!$4449(Location$4507)(this))){return Object.create(Location$4507.prototype);}else{return this;}}());;(it$0$4655["source"]=(source$4650||Source$4506("",null)));(it$0$4655["start"]=start$4651);(it$0$4655["end"]=end$4652);return it$0$4655;});;(Location$4507.prototype["text"]=function(){var it$0$4667;(it$0$4667=this);;return it$0$4667.source.text.slice(it$0$4667.start,it$0$4667.end);});(Location$4507.prototype["linerange"]=function(){var l2$4711;var t0$4702;var t1$4703;var l1$4694;var $4677$4695;var t0$4688;var t1$4689;var t2$4690;var $4676$4683;var it$0$4678;(it$0$4678=this);;($4676$4683=it$0$4678.linecol());;if((($4676$4683 instanceof Array)&&((t0$4688=$4676$4683.length),((t0$4688===2)&&((t1$4689=$4676$4683[0]),((t1$4689 instanceof Array)&&((t2$4690=t1$4689.length),(t2$4690===2)))))))){(l1$4694=t1$4689[0]);t1$4689[1];($4677$4695=$4676$4683[1]);if(($4677$4695===null)){return [l1$4694,l1$4694];}else{(t0$4702=$4677$4695);if(((t0$4702 instanceof Array)&&((t1$4703=t0$4702.length),(t1$4703===2)))){(l2$4711=t0$4702[0]);t0$4702[1];return [l1$4694,l2$4711];}else{$5999($4677$4695,"/home/olivier/git/earl-grey/src/location.eg",972,977);}}}else{$5999($4676$4683);}});(Location$4507.prototype["linecol"]=function(){var start$4729;var end$4730;var it$0$4724;(it$0$4724=this);;(start$4729=it$0$4724.source.linecol(it$0$4724.start));;(end$4730=function(){if((it$0$4724.start===it$0$4724.end)){return null;}else{return it$0$4724.source.linecol((it$0$4724.end-1));}}());;return [start$4729,end$4730];});(Location$4507.prototype["ref"]=function(){var otherwise$4813;var $4794$4802;var $4793$4796;var l2$4785;var c2$4786;var t0$4774;var t1$4775;var t2$4776;var t3$4777;var l1$4762;var c1$4763;var $4743$4764;var t0$4754;var t1$4755;var t2$4756;var t3$4757;var t4$4758;var $4742$4749;var it$0$4744;(it$0$4744=this);;($4742$4749=it$0$4744.linecol());;if((($4742$4749 instanceof Array)&&((t0$4754=$4742$4749.length),((t0$4754===2)&&((t1$4755=$4742$4749[0]),((t1$4755 instanceof Array)&&((t2$4756=t1$4755.length),((t2$4756===2)&&((t3$4757=[true,String(t1$4755[0])]),(t3$4757[0]&&((l1$4762=t3$4757[1]),((t4$4758=[true,String(t1$4755[1])]),t4$4758[0])))))))))))){(c1$4763=t4$4758[1]);($4743$4764=$4742$4749[1]);if(($4743$4764===null)){return ((l1$4762+":")+c1$4763);}else{(t0$4774=$4743$4764);if(((t0$4774 instanceof Array)&&((t1$4775=t0$4774.length),((t1$4775===2)&&((t2$4776=[true,String(t0$4774[0])]),(t2$4776[0]&&((l2$4785=t2$4776[1]),((t3$4777=[true,String(t0$4774[1])]),t3$4777[0])))))))){(c2$4786=t3$4777[1]);($4793$4796=null);;$4793$4796;if(((l1$4762===l2$4785)&&(c1$4763===c2$4786))){return ((l1$4762+":")+c1$4763);}else{if((l1$4762===l2$4785)){return ((((l1$4762+":")+c1$4763)+"-")+c2$4786);}else{(otherwise$4813=$4793$4796);return ((((((l1$4762+":")+c1$4763)+"-")+l1$4762)+":")+c2$4786);}}}else{$5999($4743$4764,"/home/olivier/git/earl-grey/src/location.eg",1314,1319);}}}else{$5999($4742$4749);}});(Location$4507.prototype["highlight"]=function(){var it$0$4838;var cls$4833;var context$4834;var t0$4829;var $4822$4824;($4822$4824=arguments);;(t0$4829=$4822$4824.length);if(((t0$4829>=0)&&(t0$4829<=2))){(cls$4833=function(){if((0>=t0$4829)){return "hl1";}else{return $4822$4824[0];}}());(context$4834=function(){if((1>=t0$4829)){return 0;}else{return $4822$4824[1];}}());(it$0$4838=this);;return highlight_locations$4512([[it$0$4838,cls$4833]],context$4834);}else{$5999($4822$4824);}});$6188(Location$4507,$6188(((accum$4845=({})),((accum$4845["::name"]="Location"),accum$4845)),((accum$4849=({})),((accum$4849["::egclass"]=true),accum$4849))));Location$4507;(highlight$4508=function(){var $index$4889;var $length$4884;var temp$4879;var acc$4874;var text$4866;var spans$4867;var offset$4868;var t0$4862;var $4855$4857;($4855$4857=arguments);;(t0$4862=$4855$4857.length);if(((t0$4862>=2)&&(t0$4862<=3))){(text$4866=$4855$4857[0]);(spans$4867=$4855$4857[1]);(offset$4868=function(){if((2>=t0$4862)){return 0;}else{return $4855$4857[2];}}());return $6200([],(((acc$4874=[])),(((temp$4879=morsel$4511(spans$4867))),((($length$4884=temp$4879.length)),((($index$4889=0)),function(){$4871:for(;($index$4889<$length$4884);($index$4889++)){var xstart$4914;var xend$4915;var start$4907;var end$4908;var attributes$4909;var t0$4902;var t1$4903;var m$4897;(m$4897=temp$4879[$index$4889]);;(t0$4902=m$4897);if(((t0$4902 instanceof Array)&&((t1$4903=t0$4902.length),(t1$4903===3)))){(start$4907=t0$4902[0]);(end$4908=t0$4902[1]);(attributes$4909=t0$4902[2]);acc$4874.push((((xstart$4914=Math.max((start$4907-offset$4868),0))),((xend$4915=Math.min((end$4908-offset$4868),text$4866.length))),$6200(attributes$4909.slice(0,1),[text$4866.slice(xstart$4914,xend$4915)])));}else{$5999(m$4897,"/home/olivier/git/earl-grey/src/location.eg",1862,2073);;}}}()))),acc$4874));}else{$5999($4855$4857);}});;(highlight_lines$4509=function(text$4931,linelocs$4932,$4929$4933,spans$4934){var t0$4939;var t1$4940;var $index$4963;var $length$4958;var temp$4953;var acc$4948;var l1$4936;var l2$4937;(t0$4939=$4929$4933);if(((t0$4939 instanceof Array)&&((t1$4940=t0$4939.length),(t1$4940===2)))){(l1$4936=t0$4939[0]);(l2$4937=t0$4939[1]);;}else{$5999($4929$4933);}return $6200(["+span"],(((acc$4948=[])),(((temp$4953=$6354(l1$4936,l2$4937))),((($length$4958=temp$4953.length)),((($index$4963=0)),function(){$4945:for(;($index$4963<$length$4958);($index$4963++)){var start$4982;var end$4983;var lineno$4979;var m$4971;(m$4971=temp$4953[$index$4963]);;(lineno$4979=m$4971);acc$4948.push((((start$4982=$4464(linelocs$4932,lineno$4979))),((end$4983=$4464(linelocs$4932,(lineno$4979+1)))),$6200(["+span"],[$6200(["lineno"],(lineno$4979+1)),$6200(["source"],highlight$4508(text$4931,[[start$4982,end$4983,[]]].concat(clamp$4510(spans$4934,start$4982,end$4983))))])));}}()))),acc$4948));});;(clamp$4510=function(spans$4994,bot$4995,top$4996){var $index$5016;var $length$5011;var temp$5006;var acc$5001;(acc$5001=[]);;(temp$5006=spans$4994);;($length$5011=temp$5006.length);;($index$5016=0);;$4998:for(;($index$5016<$length$5011);($index$5016++)){var start$5034;var end$5035;var attr$5036;var t0$5029;var t1$5030;var m$5024;(m$5024=temp$5006[$index$5016]);;(t0$5029=m$5024);if(((t0$5029 instanceof Array)&&((t1$5030=t0$5029.length),((t1$5030===3)&&((start$5034=t0$5029[0]),((end$5035=t0$5029[1]),((attr$5036=t0$5029[2]),((end$5035>=bot$4995)&&(start$5034<=top$4996))))))))){acc$5001.push([Math.max(start$5034,bot$4995),Math.min(end$5035,top$4996),attr$5036]);}else{false;;}}return acc$5001;});;(morsel$4511=function(spans$5049){var jump$5052;var jumptill$5053;var process$5054;var thespans$5055;(jump$5052=function(active$5059,bot$5060,top$5061){var $index$5089;var $length$5084;var temp$5079;var acc$5074;var $index$5129;var $length$5124;var temp$5119;var e$5064;var attributes$5065;(e$5064=$4464(Math.min,[top$5061].concat((((acc$5074=[])),(((temp$5079=active$5059)),((($length$5084=temp$5079.length)),((($index$5089=0)),function(){$5071:for(;($index$5089<$length$5084);($index$5089++)){var x$5107;var t0$5102;var t1$5103;var m$5097;(m$5097=temp$5079[$index$5089]);;(t0$5102=m$5097);if(((t0$5102 instanceof Array)&&((t1$5103=t0$5102.length),(t1$5103===3)))){t0$5102[0];(x$5107=t0$5102[1]);t0$5102[2];acc$5074.push(x$5107);}else{$5999(m$5097,"/home/olivier/git/earl-grey/src/location.eg",3395,3438);;}}}()))),acc$5074))));;(attributes$5065=[]);;(temp$5119=active$5059);;($length$5124=temp$5119.length);;($index$5129=0);;$5066:for(;($index$5129<$length$5124);($index$5129++)){var X$5147;var t0$5142;var t1$5143;var m$5137;(m$5137=temp$5119[$index$5129]);;(t0$5142=m$5137);if(((t0$5142 instanceof Array)&&((t1$5143=t0$5142.length),(t1$5143===3)))){t0$5142[0];t0$5142[1];(X$5147=t0$5142[2]);(attributes$5065=attributes$5065.concat(X$5147));}else{$5999(m$5137,"/home/olivier/git/earl-grey/src/location.eg",3460,3501);;}}return [e$5064,[bot$5060,e$5064,attributes$5065]];});;(jumptill$5053=function(active$5157,bot$5158,top$5159){var t0$5168;var t1$5169;var $index$5194;var $length$5189;var temp$5184;var acc$5179;var t0$5225;var t1$5226;var newbot$5162;var span$5163;var newactive$5164;var spans$5165;var remainder$5166;if((bot$5158===top$5159)){return [[],active$5157];}else{(t0$5168=jump$5052(active$5157,bot$5158,top$5159));if(((t0$5168 instanceof Array)&&((t1$5169=t0$5168.length),(t1$5169===2)))){(newbot$5162=t0$5168[0]);(span$5163=t0$5168[1]);;}else{$5999(jump$5052(active$5157,bot$5158,top$5159),"/home/olivier/git/earl-grey/src/location.eg",3737,3759);}(newactive$5164=(((acc$5179=[])),(((temp$5184=active$5157)),((($length$5189=temp$5184.length)),((($index$5194=0)),function(){$5176:for(;($index$5194<$length$5189);($index$5194++)){var x$5212;var e$5213;var attr$5214;var t0$5207;var t1$5208;var m$5202;(m$5202=temp$5184[$index$5194]);;(t0$5207=m$5202);(x$5212=t0$5207);if(((t0$5207 instanceof Array)&&((t1$5208=t0$5207.length),((t1$5208===3)&&(t0$5207[0],((e$5213=t0$5207[1]),((attr$5214=t0$5207[2]),(e$5213>newbot$5162)))))))){acc$5179.push(x$5212);}else{false;;}}}()))),acc$5179));;(t0$5225=jumptill$5053(newactive$5164,newbot$5162,top$5159));if(((t0$5225 instanceof Array)&&((t1$5226=t0$5225.length),(t1$5226===2)))){(spans$5165=t0$5225[0]);(remainder$5166=t0$5225[1]);;}else{$5999(jumptill$5053(newactive$5164,newbot$5162,top$5159),"/home/olivier/git/earl-grey/src/location.eg",3882,3914);}return [[span$5163].concat(spans$5165),remainder$5166];}});;(process$5054=function(start$5235,active$5236,rem$5237){var $index$5302;var $length$5297;var temp$5292;var acc$5287;var t0$5331;var t1$5332;var top$5279;var bot$5280;var spans$5281;var t0$5359;var t1$5360;var spans$5356;var newactive$5357;var start$5339;var active$5340;var next$5341;var target$5342;var end$5343;var attr$5344;var rest$5345;var start$5270;var active$5271;var $5240$5255;var $5241$5256;var $5242$5257;var t0$5249;var t1$5250;var t2$5251;var t3$5252;var t4$5253;var $5239$5244;($5239$5244=[start$5235,active$5236,rem$5237]);;if((($5240$5255=($5239$5244 instanceof Array))&&((t0$5249=$5239$5244.length),(($5242$5257=(t0$5249===3))&&($5239$5244[0],((t1$5250=$5239$5244[1]),((t1$5250 instanceof Array)&&((t2$5251=t1$5250.length),((t2$5251===0)&&((t3$5252=$5239$5244[2]),((t3$5252 instanceof Array)&&((t4$5253=t3$5252.length),(t4$5253===0))))))))))))){return [];}else{if(($5242$5257&&((start$5270=$5239$5244[0]),((active$5271=$5239$5244[1]),((t1$5250=$5239$5244[2]),((t1$5250 instanceof Array)&&((t2$5251=t1$5250.length),(t2$5251===0)))))))){(top$5279=$4464(Math.max,(((acc$5287=[])),(((temp$5292=active$5271)),((($length$5297=temp$5292.length)),((($index$5302=0)),function(){$5284:for(;($index$5302<$length$5297);($index$5302++)){var e$5320;var t0$5315;var t1$5316;var m$5310;(m$5310=temp$5292[$index$5302]);;(t0$5315=m$5310);if(((t0$5315 instanceof Array)&&((t1$5316=t0$5315.length),(t1$5316===3)))){t0$5315[0];(e$5320=t0$5315[1]);t0$5315[2];acc$5287.push(e$5320);}else{$5999(m$5310,"/home/olivier/git/earl-grey/src/location.eg",4102,4130);;}}}()))),acc$5287)));;(bot$5280=Math.min(start$5270,top$5279));;(t0$5331=jumptill$5053(active$5271,start$5270,top$5279));if(((t0$5331 instanceof Array)&&((t1$5332=t0$5331.length),(t1$5332===2)))){(spans$5281=t0$5331[0]);t0$5331[1];;}else{$5999(jumptill$5053(active$5271,start$5270,top$5279),"/home/olivier/git/earl-grey/src/location.eg",4189,4217);}return spans$5281;}else{if(($5242$5257&&((start$5339=$5239$5244[0]),((active$5340=$5239$5244[1]),((t1$5250=$5239$5244[2]),((t1$5250 instanceof Array)&&((t2$5251=t1$5250.length),((t2$5251>=1)&&((t3$5252=t1$5250[0]),((next$5341=t3$5252),((t3$5252 instanceof Array)&&((t4$5253=t3$5252.length),(t4$5253===3))))))))))))){(target$5342=t3$5252[0]);(end$5343=t3$5252[1]);(attr$5344=t3$5252[2]);(rest$5345=Array.prototype.slice.call(t1$5250,1));(t0$5359=jumptill$5053(active$5340,start$5339,target$5342));if(((t0$5359 instanceof Array)&&((t1$5360=t0$5359.length),(t1$5360===2)))){(spans$5356=t0$5359[0]);(newactive$5357=t0$5359[1]);;}else{$5999(jumptill$5053(active$5340,start$5339,target$5342),"/home/olivier/git/earl-grey/src/location.eg",4327,4358);}return spans$5356.concat(process$5054(target$5342,[next$5341].concat(newactive$5357),rest$5345));}else{$5999($5239$5244);}}}});;(thespans$5055=spans$5049.sort(function($5370$5373,$5371$5374){var t0$5381;var t1$5382;var t0$5388;var t1$5389;var s1$5376;var e1$5377;var s2$5378;var e2$5379;(t0$5381=$5370$5373);if(((t0$5381 instanceof Array)&&((t1$5382=t0$5381.length),(t1$5382===3)))){(s1$5376=t0$5381[0]);(e1$5377=t0$5381[1]);t0$5381[2];;}else{$5999($5370$5373);}(t0$5388=$5371$5374);if(((t0$5388 instanceof Array)&&((t1$5389=t0$5388.length),(t1$5389===3)))){(s2$5378=t0$5388[0]);(e2$5379=t0$5388[1]);t0$5388[2];;}else{$5999($5371$5374);}if((s1$5376===s2$5378)){return (e1$5377-e2$5379);}else{return (s1$5376-s2$5378);}}));;return process$5054(thespans$5055[0][0],[],thespans$5055);});;(highlight_locations$4512=function(){var $index$5433;var $length$5428;var temp$5423;var $index$5482;var $length$5477;var temp$5472;var acc$5467;var srcs$5415;var locations$5410;var context$5411;var t0$5406;var $5399$5401;($5399$5401=arguments);;(t0$5406=$5399$5401.length);if(((t0$5406>=1)&&(t0$5406<=2))){(locations$5410=$5399$5401[0]);(context$5411=function(){if((1>=t0$5406)){return 0;}else{return $5399$5401[1];}}());(srcs$5415=({}));;(temp$5423=locations$5410);;($length$5428=temp$5423.length);;($index$5433=0);;$5416:for(;($index$5433<$length$5428);($index$5433++)){var key$5457;var loc$5451;var cls$5452;var t0$5446;var t1$5447;var m$5441;(m$5441=temp$5423[$index$5433]);;(t0$5446=m$5441);if(((t0$5446 instanceof Array)&&((t1$5447=t0$5446.length),(t1$5447===2)))){(loc$5451=t0$5446[0]);(cls$5452=t0$5446[1]);(key$5457=String((loc$5451.source&&loc$5451.source.url)));;if((!$4464(srcs$5415,key$5457))){(srcs$5415[key$5457]=[]);}$4464(srcs$5415,key$5457).push([loc$5451,cls$5452]);}else{$5999(m$5441,"/home/olivier/git/earl-grey/src/location.eg",4696,4866);;}}return $6200(["+div"],(((acc$5467=[])),(((temp$5472=items$4500(srcs$5415))),((($length$5477=temp$5472.length)),((($index$5482=0)),function(){$5464:for(;($index$5482<$length$5477);($index$5482++)){var locs$5500;var t0$5495;var t1$5496;var m$5490;(m$5490=temp$5472[$index$5482]);;(t0$5495=m$5490);if(((t0$5495 instanceof Array)&&((t1$5496=t0$5495.length),(t1$5496===2)))){t0$5495[0];(locs$5500=t0$5495[1]);acc$5467.push(highlight_locations_same_source$4513(locs$5500,context$5411));}else{$5999(m$5490,"/home/olivier/git/earl-grey/src/location.eg",4871,4965);;}}}()))),acc$5467));}else{$5999($5399$5401);}});;(highlight_locations_same_source$4513=function(){var $index$5554;var $length$5549;var temp$5544;var acc$5539;var t0$5584;var t1$5585;var $index$5614;var $length$5609;var temp$5604;var acc$5599;var $index$5657;var $length$5652;var temp$5647;var acc$5642;var loc$5528;var src$5529;var l1$5530;var l2$5531;var first$5532;var last$5533;var locations$5523;var context$5524;var t0$5519;var $5512$5514;($5512$5514=arguments);;(t0$5519=$5512$5514.length);if(((t0$5519>=1)&&(t0$5519<=2))){(locations$5523=$5512$5514[0]);(context$5524=function(){if((1>=t0$5519)){return 0;}else{return $5512$5514[1];}}());(loc$5528=merge_locations$4514((((acc$5539=[])),(((temp$5544=locations$5523)),((($length$5549=temp$5544.length)),((($index$5554=0)),function(){$5536:for(;($index$5554<$length$5549);($index$5554++)){var x$5572;var cls$5573;var t0$5567;var t1$5568;var m$5562;(m$5562=temp$5544[$index$5554]);;(t0$5567=m$5562);if(((t0$5567 instanceof Array)&&((t1$5568=t0$5567.length),(t1$5568===2)))){(x$5572=t0$5567[0]);(cls$5573=t0$5567[1]);acc$5539.push(x$5572);}else{$5999(m$5562,"/home/olivier/git/earl-grey/src/location.eg",5048,5076);;}}}()))),acc$5539)));;(src$5529=loc$5528.source);;(t0$5584=loc$5528.linerange());if(((t0$5584 instanceof Array)&&((t1$5585=t0$5584.length),(t1$5585===2)))){(l1$5530=t0$5584[0]);(l2$5531=t0$5584[1]);;}else{$5999(loc$5528.linerange(),"/home/olivier/git/earl-grey/src/location.eg",5112,5127);}(first$5532=Math.max(1,(l1$5530-context$5524)));;(last$5533=Math.min(src$5529.nlines,(l2$5531+context$5524)));;return $6200(["+div","location"],[$6200(["+div","source"],[$6200(["sourcefile"],(src$5529.url||"???")),(((acc$5599=[])),(((temp$5604=locations$5523)),((($length$5609=temp$5604.length)),((($index$5614=0)),function(){$5596:for(;($index$5614<$length$5609);($index$5614++)){var loc$5632;var cls$5633;var t0$5627;var t1$5628;var m$5622;(m$5622=temp$5604[$index$5614]);;(t0$5627=m$5622);if(((t0$5627 instanceof Array)&&((t1$5628=t0$5627.length),(t1$5628===2)))){(loc$5632=t0$5627[0]);(cls$5633=t0$5627[1]);acc$5599.push($6200([cls$5633,"sourcepos"],loc$5632.ref()));}else{$5999(m$5622,"/home/olivier/git/earl-grey/src/location.eg",5296,5359);;}}}()))),acc$5599)]),src$5529.highlight_lines(first$5532,last$5533,(((acc$5642=[])),(((temp$5647=locations$5523)),((($length$5652=temp$5647.length)),((($index$5657=0)),function(){$5639:for(;($index$5657<$length$5652);($index$5657++)){var loc$5675;var cls$5676;var t0$5670;var t1$5671;var m$5665;(m$5665=temp$5647[$index$5657]);;(t0$5670=m$5665);if(((t0$5670 instanceof Array)&&((t1$5671=t0$5670.length),(t1$5671===2)))){(loc$5675=t0$5670[0]);(cls$5676=t0$5670[1]);acc$5642.push([loc$5675.start,loc$5675.end,[cls$5676]]);}else{$5999(m$5665,"/home/olivier/git/earl-grey/src/location.eg",5421,5477);;}}}()))),acc$5642))]);}else{$5999($5512$5514);}});;(merge_locations$4514=function($5687$5689){var $index$5746;var $length$5741;var temp$5736;var acc$5731;var $index$5785;var $length$5780;var temp$5775;var acc$5770;var start$5724;var end$5725;var locs$5720;var loc$5715;var $5692$5706;var $5693$5707;var t0$5704;var $5691$5699;var ph$5694;(ph$5694=$5687$5689);;($5691$5699=ph$5694);;if((($5692$5706=($5691$5699 instanceof Array))&&((t0$5704=$5691$5699.length),(t0$5704===0)))){return Location$4507(null,0,0);}else{if(($5692$5706&&(t0$5704===1))){(loc$5715=$5691$5699[0]);return loc$5715;}else{if(($5692$5706&&(t0$5704>=0))){(locs$5720=Array.prototype.slice.call($5691$5699,0));(start$5724=$4464(Math.min,(((acc$5731=[])),(((temp$5736=locs$5720)),((($length$5741=temp$5736.length)),((($index$5746=0)),function(){$5728:for(;($index$5746<$length$5741);($index$5746++)){var loc$5762;var m$5754;(m$5754=temp$5736[$index$5746]);;(loc$5762=m$5754);acc$5731.push(loc$5762.start);}}()))),acc$5731)));;(end$5725=$4464(Math.max,(((acc$5770=[])),(((temp$5775=locs$5720)),((($length$5780=temp$5775.length)),((($index$5785=0)),function(){$5767:for(;($index$5785<$length$5780);($index$5785++)){var loc$5801;var m$5793;(m$5793=temp$5775[$index$5785]);;(loc$5801=m$5793);acc$5770.push(loc$5801.end);}}()))),acc$5770)));;return Location$4507(locs$5720[0].source,start$5724,end$5725);}else{$5999($5691$5699);}}}});;(__lt____lt____colon__$4515=function(x$5810,y$5811){if((!$4449(Location$4507)(x$5810.location))){(x$5810["location"]=function(){if(((!y$5811)||$4449(Location$4507)(y$5811))){return y$5811;}else{return y$5811.location;}}());}return x$5810;});;(__plus____plus____colon__$4516=function(x$5819,y$5820){var rval$5824;(x$5819=function(){if(((!x$5819)||$4449(Location$4507)(x$5819))){return x$5819;}else{return x$5819.location;}}());(y$5820=function(){if(((!y$5820)||$4449(Location$4507)(y$5820))){return y$5820;}else{return y$5820.location;}}());(rval$5824=false);;try{(rval$5824=merge_locations$4514([x$5819,y$5820]));}catch(excv$5830){var e$5836;(e$5836=excv$5830);(rval$5824=(void 0));}return rval$5824;});;(format_error$4517=function(){var $index$5912;var $length$5907;var temp$5902;var acc$5897;var hls$5887;var locs$5888;var rval$5965;var loc$5981;var data$5961;var other$5987;var url$5954;var start$5955;var end$5956;var loc$5948;var args$5881;var fmt_args$5872;var $5844$5868;var $5845$5869;var $5846$5870;var t0$5864;var t1$5865;var t2$5866;var e$5858;var context$5859;var $5843$5860;var t0$5853;var t1$5854;var $5842$5848;($5842$5848=arguments);;(t0$5853=$5842$5848.length);if(((t0$5853>=1)&&(t0$5853<=2))){(t1$5854=$5842$5848[0]);(e$5858=t1$5854);($5843$5860=t1$5854);(context$5859=function(){if((1>=t0$5853)){return 0;}else{return $5842$5848[1];}}());(fmt_args$5872=function(e$5876){if((e$5876.args&&e$5876.args.length)){return $6200(["error_args"],repr$4504(e$5876.args));}else{return "";}});;(t0$5864=$5843$5860);if(($4449($6012(["syntax"]))(t0$5864)&&($6373(t0$5864,"args")&&((t1$5865=t0$5864.args),((t1$5865 instanceof Array)&&((t2$5866=t1$5865.length),(t2$5866===1))))))){(args$5881=t1$5865[0]);(hls$5887=["hl1","hl2","hl3","hl4"]);;(locs$5888=(((acc$5897=[])),(((temp$5902=enumerate$4501(items$4500(args$5881)))),((($length$5907=temp$5902.length)),((($index$5912=0)),function(){$5894:for(;($index$5912<$length$5907);($index$5912++)){var i$5932;var key$5933;var arg$5934;var t0$5925;var t1$5926;var t2$5927;var t3$5928;var m$5920;(m$5920=temp$5902[$index$5912]);;(t0$5925=m$5920);if(((t0$5925 instanceof Array)&&((t1$5926=t0$5925.length),((t1$5926===2)&&((i$5932=t0$5925[0]),((t2$5927=t0$5925[1]),((t2$5927 instanceof Array)&&((t3$5928=t2$5927.length),((t3$5928===2)&&((key$5933=t2$5927[0]),((arg$5934=t2$5927[1]),(arg$5934&&arg$5934.location)))))))))))){acc$5897.push([arg$5934.location,$4464(hls$5887,(i$5932%4))]);}else{false;;}}}()))),acc$5897));;return $6200(["+div"],[$6200(["error"],[$6200(["error_type"],e$5858.name),$6200(["error_message"],e$5858.message)]),$6200(["error_args","syntax"],repr$4504(args$5881)),highlight_locations$4512(locs$5888,context$5859)]);}else{if((($5845$5869=$6373(t0$5864,"location"))&&((t1$5865=t0$5864.location),$4449(Location$4507)(t1$5865)))){(loc$5948=t1$5865);return $6200(["+div"],[$6200(["error"],[$6200(["error_type"],e$5858.name),$6200(["error_message"],e$5858.message)]),fmt_args$5872(e$5858),highlight_locations$4512([[loc$5948,"hl1"]],context$5859),$6200(["traceback"],(e$5858.stack||""))]);}else{if(($5845$5869&&((t1$5865 instanceof Array)&&((t2$5866=t1$5865.length),((t2$5866===4)&&(t1$5865[0]==="location")))))){(url$5954=t1$5865[1]);(start$5955=t1$5865[2]);(end$5956=t1$5865[3]);(data$5961=(((rval$5965=false)),(function(){try{(rval$5965=fs$4505.readFileSync(url$5954,"utf8"));}catch(excv$5971){var e$5977;(e$5977=excv$5971);(rval$5965=null);}}(),rval$5965)));;if(data$5961){(loc$5981=Location$4507(Source$4506(data$5961,url$5954),start$5955,end$5956));;return $6200(["+div"],[$6200(["error"],[$6200(["error_type"],e$5858.name),$6200(["error_message"],e$5858.message)]),fmt_args$5872(e$5858),highlight_locations$4512([[loc$5981,"hl1"]],context$5859),$6200(["traceback"],($6200([],e$5858.stack)||""))]);}else{return $6200(["+div"],[$6200(["error"],[$6200(["error_type"],e$5858.name),$6200(["error_message"],e$5858.message)]),fmt_args$5872(e$5858),$6200(["traceback"],($6200([],e$5858.stack)||e$5858))]);}}else{(other$5987=$5843$5860);return $6200(["+div"],[$6200(["error"],[$6200(["error_type"],e$5858.name),$6200(["error_message"],e$5858.message)]),fmt_args$5872(e$5858),$6200(["traceback"],$6200([],e$5858.stack))]);}}}}else{$5999($5842$5848);}});;(display_error$4518=function(e$5995){return __lt____gt__$4503(null,format_error$4517(e$5995));});;(exports["Source"]=Source$4506);(exports["Location"]=Location$4507);(exports["highlight"]=highlight$4508);(exports["highlight_locations"]=highlight_locations$4512);(exports["merge_locations"]=merge_locations$4514);(exports["<<:"]=__lt____lt____colon__$4515);(exports["++:"]=__plus____plus____colon__$4516);(exports["format_error"]=format_error$4517);(exports["display_error"]=display_error$4518);

},{"./pp":11,"./util":14,"fs":15}],8:[function(require,module,exports){
var $6572=function(type$6574){var f$6577;(f$6577=type$6574["::check"]);;if((f$6577===(void 0))){return function(value$6582){return (value$6582 instanceof type$6574);};}else{return function(value$6585){return f$6577.call(type$6574,value$6585);};}};
var $6587=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $6588=function($6589$6591){var ph$6595;(ph$6595=$6589$6591);;var $6593$6600;($6593$6600=ph$6595);;var bridge$6594$6605;var x$6609;(bridge$6594$6605=$6593$6600);if((((typeof(bridge$6594$6605)==="string")&&((x$6609=bridge$6594$6605),true))||((typeof(bridge$6594$6605)==="number")&&((x$6609=bridge$6594$6605),true)))){return ["value",x$6609];}else{var other$6616;(other$6616=$6593$6600);return other$6616["::serialize_ast"]();}};
var send$6412;(send$6412=function(obj$6417,$6415$6418){var ph$6422;var msg$6423;var t0$6425;(t0$6425=$6415$6418);(msg$6423=t0$6425);(ph$6422=t0$6425);;var $6420$6429;($6420$6429=ph$6422);;var bridge$6421$6434;(bridge$6421$6434=$6420$6429);if(((typeof(bridge$6421$6434)==="string")||(typeof(bridge$6421$6434)==="number"))){return obj$6417[msg$6423];}else{var other$6442;(other$6442=$6420$6429);return obj$6417["::send"](msg$6423);}});;(Array[":::project"]=function($6445$6447){var ph$6450;var value$6451;var t0$6453;(t0$6453=$6445$6447);(value$6451=t0$6453);(ph$6450=t0$6453);;var $6449$6457;($6449$6457=ph$6450);;if($6572(Array)($6449$6457)){return [true,value$6451];}else{$6449$6457;return [true,[value$6451]];}});(Array.prototype["::check"]=function(value$6471){if((value$6471 instanceof Array)){var i$6476;(i$6476=0);;$6474:for(;(i$6476<this.length);(i$6476++)){if(($6587(this,i$6476)!==$6587(value$6471,i$6476))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$6487){if((value$6487 instanceof Array)){var i$6492;(i$6492=0);;$6490:for(;(i$6492<this.length);(i$6492++)){if(($6587(this,i$6492)!==$6587(value$6487,i$6492))){return [true,[value$6487]];}}return [true,value$6487.slice(this.length)];}else{return [true,[value$6487]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($6588));});(RegExp.prototype["::check"]=function($6502$6504){var ph$6507;(ph$6507=$6502$6504);;var $6506$6512;($6506$6512=ph$6507);;var value$6520;if((typeof($6506$6512)==="string")){(value$6520=$6506$6512);if(value$6520.match(this)){return true;}else{return false;}}else{var other$6525;(other$6525=$6506$6512);return false;}});(RegExp.prototype[":::project"]=function($6527$6529){var ph$6532;(ph$6532=$6527$6529);;var $6531$6537;($6531$6537=ph$6532);;var value$6545;if((typeof($6531$6537)==="string")){(value$6545=$6531$6537);var $6548$6550;($6548$6550=value$6545.match(this));;var m$6558;if(($6548$6550===null)){(m$6558=$6548$6550);return [false,null];}else{var m$6563;(m$6563=$6548$6550);return [true,m$6563];}}else{var other$6567;(other$6567=$6531$6537);return [false,null];}});(Function.prototype["::send"]=function(args$6570){return this.apply(this,args$6570);});
var $7043=function(arr$7045){var results$7049;var l$7050;(results$7049=[]);;(l$7050=arr$7045.length);;var i$7058;(i$7058=0);;$7048:for(;(i$7058<l$7050);(i$7058++)){results$7049.push([i$7058,$6587(arr$7045,i$7058)]);}return results$7049;};
var $7065=function(dest$7067,values$7068){var k$7073;(k$7073=null);$7071:for(k$7073 in values$7068){if(values$7068.hasOwnProperty(k$7073)){(dest$7067[k$7073]=values$7068[k$7073]);}}return dest$7067;};
var $6889=function(){var $6890$6892;($6890$6892=function(tags$6896){var it$0$6899;(it$0$6899=function(){if((!$6572($6890$6892)(this))){return Object.create($6890$6892.prototype);}else{return this;}}());;(it$0$6899["tags"]=tags$6896);return it$0$6899;});;($6890$6892.prototype["create"]=function(){var $6908$6910;($6908$6910=arguments);;var t0$6915;var message$6919;var args$6920;(t0$6915=$6908$6910.length);if((t0$6915>=0)){(message$6919=function(){if((0>=t0$6915)){return "";}else{return $6908$6910[0];}}());(args$6920=Array.prototype.slice.call($6908$6910,1));var it$0$6924;(it$0$6924=this);;var e$6929;(e$6929=Error(message$6919));;(e$6929["::tags"]=it$0$6924.tags);(e$6929["args"]=args$6920);var temp$6937;(temp$6937=$7043(args$6920));;var $length$6942;($length$6942=temp$6937.length);;var $index$6947;($index$6947=0);;$6930:for(;($index$6947<$length$6942);($index$6947++)){var m$6955;(m$6955=temp$6937[$index$6947]);;var t0$6960;var t1$6961;var i$6965;var arg$6966;(t0$6960=m$6955);if(((t0$6960 instanceof Array)&&((t1$6961=t0$6960.length),(t1$6961===2)))){(i$6965=t0$6960[0]);(arg$6966=t0$6960[1]);(e$6929[i$6965]=arg$6966);}else{$6876(m$6955);;}}(e$6929["length"]=args$6920.length);(e$6929["name"]=["E"].concat(it$0$6924.tags).join("."));return e$6929;}else{$6876($6908$6910);}});($6890$6892.prototype["::check"]=function(e$6977){var it$0$6980;(it$0$6980=this);;var tags$6985;if(((!e$6977)||(!$6572(Error)(e$6977)))){return false;}(tags$6985=(e$6977["::tags"]||[]));;var temp$6994;(temp$6994=it$0$6980.tags);;var $length$6999;($length$6999=temp$6994.length);;var $index$7004;($index$7004=0);;$6986:for(;($index$7004<$length$6999);($index$7004++)){var m$7012;(m$7012=temp$6994[$index$7004]);;var tag$7020;(tag$7020=m$7012);if((tags$6985.indexOf(tag$7020)===-1)){return false;}else{false;;}}return true;});($6890$6892.prototype["::deconstruct"]=function(e$7028){var it$0$7031;(it$0$7031=this);;return e$7028.args;});$7065($6890$6892,$7065(function(){var accum$7036;(accum$7036=({}));(accum$7036["::name"]="$6890");return accum$7036;}(),function(){var accum$7040;(accum$7040=({}));(accum$7040["::egclass"]=true);return accum$7040;}()));return $6890$6892;}();
var $6876=function(value$6878,url$6879,start$6880,end$6881){var err$6884;(err$6884=$6889(["match"]).create("Could not find a match for value",({"value":value$6878})));;if(url$6879){(err$6884["location"]=["location",url$6879,start$6880,end$6881]);}throw err$6884;};var hoist$6619;var hoistable$6620;var not_hoistable$6621;var hoist_helper$6622;(hoist$6619=function(expr$6626){var t0$6632;var t1$6633;var b$6629;var inner$6630;(t0$6632=hoist_helper$6622(expr$6626));if(((t0$6632 instanceof Array)&&((t1$6633=t0$6632.length),(t1$6633===2)))){(b$6629=t0$6632[0]);(inner$6630=t0$6632[1]);;}else{$6876(hoist_helper$6622(expr$6626),"/home/olivier/git/earl-grey/src/opt.eg",50,68);}return ["scope",inner$6630,b$6629];});;(hoistable$6620=["send","array","object","multi","if","assign","js_break","js_continue","js_return","js_delete","js_throw","js_try","js_new"]);;(not_hoistable$6621=["void","js_while","js_for","js_for_in","js_label"]);;(hoist_helper$6622=function($6647$6649){var t0$6660;var x$6682;var x$6687;var bridge$6653$6679;var x$6692;var t0$6708;var t1$6709;var newbody$6705;var inner$6706;var t0$6724;var t1$6725;var newbody$6721;var inner$6722;var $index$6764;var $length$6759;var temp$6754;var acc$6749;var accum$6739;var newargs$6740;var $index$6823;var $length$6818;var temp$6813;var acc$6808;var newargs$6802;var other$6872;var type$6795;var args$6796;var type$6732;var args$6733;var vars$6716;var body$6717;var vars$6699;var body$6700;var $6654$6672;var $6655$6673;var $6656$6674;var bridge$6652$6669;var t0$6670;var $6651$6664;var ph$6657;var expr$6658;(t0$6660=$6647$6649);(expr$6658=t0$6660);(ph$6657=t0$6660);;($6651$6664=ph$6657);;(bridge$6652$6669=$6651$6664);if((((bridge$6653$6679=bridge$6652$6669),((((x$6682=bridge$6653$6679)),((x$6682 instanceof Array)&&(x$6682[0]==="symbol")))||(((x$6687=bridge$6653$6679)),((x$6687 instanceof Array)&&(x$6687[0]==="value")))))||(((x$6692=bridge$6652$6669)),((x$6692 instanceof Array)&&(x$6692[0]==="variable"))))){return [expr$6658,[]];}else{if((($6654$6672=($6651$6664 instanceof Array))&&((t0$6670=$6651$6664.length),(($6656$6674=(t0$6670===3))&&($6651$6664[0]==="scope"))))){(vars$6699=$6651$6664[1]);(body$6700=$6651$6664[2]);(t0$6708=hoist_helper$6622(body$6700));if(((t0$6708 instanceof Array)&&((t1$6709=t0$6708.length),(t1$6709===2)))){(newbody$6705=t0$6708[0]);(inner$6706=t0$6708[1]);;}else{$6876(hoist_helper$6622(body$6700),"/home/olivier/git/earl-grey/src/opt.eg",447,465);}return [newbody$6705,inner$6706.concat(vars$6699)];}else{if(($6656$6674&&($6651$6664[0]==="lambda"))){(vars$6716=$6651$6664[1]);(body$6717=$6651$6664[2]);(t0$6724=hoist_helper$6622(body$6717));if(((t0$6724 instanceof Array)&&((t1$6725=t0$6724.length),(t1$6725===2)))){(newbody$6721=t0$6724[0]);(inner$6722=t0$6724[1]);;}else{$6876(hoist_helper$6622(body$6717),"/home/olivier/git/earl-grey/src/opt.eg",581,599);}return [["lambda",vars$6716,["scope",inner$6722,newbody$6721]],[]];}else{if(($6654$6672&&(($6656$6674=(t0$6670>=1))&&((type$6732=$6651$6664[0]),((args$6733=Array.prototype.slice.call($6651$6664,1)),(hoistable$6620.indexOf(type$6732)!==-1)))))){(accum$6739=[]);;(newargs$6740=(((acc$6749=[])),(((temp$6754=args$6733)),((($length$6759=temp$6754.length)),((($index$6764=0)),function(){$6746:for(;($index$6764<$length$6759);($index$6764++)){var t0$6786;var t1$6787;var b$6783;var inner$6784;var arg$6780;var m$6772;(m$6772=temp$6754[$index$6764]);;(arg$6780=m$6772);acc$6749.push((((t0$6786=hoist_helper$6622(arg$6780)),function(){if(((t0$6786 instanceof Array)&&((t1$6787=t0$6786.length),(t1$6787===2)))){(b$6783=t0$6786[0]);(inner$6784=t0$6786[1]);}else{return $6876(hoist_helper$6622(arg$6780),"/home/olivier/git/earl-grey/src/opt.eg",779,796);}}()),(accum$6739=accum$6739.concat(inner$6784)),b$6783));}}()))),acc$6749));;return [[type$6732].concat(newargs$6740),accum$6739];}else{if(($6656$6674&&((type$6795=$6651$6664[0]),((args$6796=Array.prototype.slice.call($6651$6664,1)),(not_hoistable$6621.indexOf(type$6795)!==-1))))){(newargs$6802=(((acc$6808=[])),(((temp$6813=args$6796)),((($length$6818=temp$6813.length)),((($index$6823=0)),function(){$6805:for(;($index$6823<$length$6818);($index$6823++)){var t0$6846;var t1$6847;var other$6867;var t0$6858;var $6842$6853;var b$6843;var inner$6844;var arg$6839;var m$6831;(m$6831=temp$6813[$index$6823]);;(arg$6839=m$6831);acc$6808.push((((t0$6846=hoist_helper$6622(arg$6839)),function(){if(((t0$6846 instanceof Array)&&((t1$6847=t0$6846.length),(t1$6847===2)))){(b$6843=t0$6846[0]);(inner$6844=t0$6846[1]);}else{return $6876(hoist_helper$6622(arg$6839),"/home/olivier/git/earl-grey/src/opt.eg",981,998);}}()),((($6842$6853=inner$6844)),function(){if((($6842$6853 instanceof Array)&&((t0$6858=$6842$6853.length),(t0$6858===0)))){return b$6843;}else{(other$6867=$6842$6853);return ["scope",inner$6844,b$6843];}}())));}}()))),acc$6808));;return [[type$6795].concat(newargs$6802),[]];}else{(other$6872=$6651$6664);throw $6889(["syntax","illegal"]).create("Illegal node -- this should not happen.",({"node":other$6872}));}}}}}});;(exports["hoist"]=hoist$6619);

},{}],9:[function(require,module,exports){
var $7238=function(type$7240){var f$7243;(f$7243=type$7240["::check"]);;if((f$7243===(void 0))){return function(value$7248){return (value$7248 instanceof type$7240);};}else{return function(value$7251){return f$7243.call(type$7240,value$7251);};}};
var $7253=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $7254=function($7255$7257){var ph$7261;(ph$7261=$7255$7257);;var $7259$7266;($7259$7266=ph$7261);;var bridge$7260$7271;var x$7275;(bridge$7260$7271=$7259$7266);if((((typeof(bridge$7260$7271)==="string")&&((x$7275=bridge$7260$7271),true))||((typeof(bridge$7260$7271)==="number")&&((x$7275=bridge$7260$7271),true)))){return ["value",x$7275];}else{var other$7282;(other$7282=$7259$7266);return other$7282["::serialize_ast"]();}};
var send$7078;(send$7078=function(obj$7083,$7081$7084){var ph$7088;var msg$7089;var t0$7091;(t0$7091=$7081$7084);(msg$7089=t0$7091);(ph$7088=t0$7091);;var $7086$7095;($7086$7095=ph$7088);;var bridge$7087$7100;(bridge$7087$7100=$7086$7095);if(((typeof(bridge$7087$7100)==="string")||(typeof(bridge$7087$7100)==="number"))){return obj$7083[msg$7089];}else{var other$7108;(other$7108=$7086$7095);return obj$7083["::send"](msg$7089);}});;(Array[":::project"]=function($7111$7113){var ph$7116;var value$7117;var t0$7119;(t0$7119=$7111$7113);(value$7117=t0$7119);(ph$7116=t0$7119);;var $7115$7123;($7115$7123=ph$7116);;if($7238(Array)($7115$7123)){return [true,value$7117];}else{$7115$7123;return [true,[value$7117]];}});(Array.prototype["::check"]=function(value$7137){if((value$7137 instanceof Array)){var i$7142;(i$7142=0);;$7140:for(;(i$7142<this.length);(i$7142++)){if(($7253(this,i$7142)!==$7253(value$7137,i$7142))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$7153){if((value$7153 instanceof Array)){var i$7158;(i$7158=0);;$7156:for(;(i$7158<this.length);(i$7158++)){if(($7253(this,i$7158)!==$7253(value$7153,i$7158))){return [true,[value$7153]];}}return [true,value$7153.slice(this.length)];}else{return [true,[value$7153]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($7254));});(RegExp.prototype["::check"]=function($7168$7170){var ph$7173;(ph$7173=$7168$7170);;var $7172$7178;($7172$7178=ph$7173);;var value$7186;if((typeof($7172$7178)==="string")){(value$7186=$7172$7178);if(value$7186.match(this)){return true;}else{return false;}}else{var other$7191;(other$7191=$7172$7178);return false;}});(RegExp.prototype[":::project"]=function($7193$7195){var ph$7198;(ph$7198=$7193$7195);;var $7197$7203;($7197$7203=ph$7198);;var value$7211;if((typeof($7197$7203)==="string")){(value$7211=$7197$7203);var $7214$7216;($7214$7216=value$7211.match(this));;var m$7224;if(($7214$7216===null)){(m$7224=$7214$7216);return [false,null];}else{var m$7229;(m$7229=$7214$7216);return [true,m$7229];}}else{var other$7233;(other$7233=$7197$7203);return [false,null];}});(Function.prototype["::send"]=function(args$7236){return this.apply(this,args$7236);});
var $8292=function(arr$8294){var results$8298;var l$8299;(results$8298=[]);;(l$8299=arr$8294.length);;var i$8307;(i$8307=0);;$8297:for(;(i$8307<l$8299);(i$8307++)){results$8298.push([i$8307,$7253(arr$8294,i$8307)]);}return results$8298;};
var $8314=function(dest$8316,values$8317){var k$8322;(k$8322=null);$8320:for(k$8322 in values$8317){if(values$8317.hasOwnProperty(k$8322)){(dest$8316[k$8322]=values$8317[k$8322]);}}return dest$8316;};
var $8138=function(){var $8139$8141;($8139$8141=function(tags$8145){var it$0$8148;(it$0$8148=function(){if((!$7238($8139$8141)(this))){return Object.create($8139$8141.prototype);}else{return this;}}());;(it$0$8148["tags"]=tags$8145);return it$0$8148;});;($8139$8141.prototype["create"]=function(){var $8157$8159;($8157$8159=arguments);;var t0$8164;var message$8168;var args$8169;(t0$8164=$8157$8159.length);if((t0$8164>=0)){(message$8168=function(){if((0>=t0$8164)){return "";}else{return $8157$8159[0];}}());(args$8169=Array.prototype.slice.call($8157$8159,1));var it$0$8173;(it$0$8173=this);;var e$8178;(e$8178=Error(message$8168));;(e$8178["::tags"]=it$0$8173.tags);(e$8178["args"]=args$8169);var temp$8186;(temp$8186=$8292(args$8169));;var $length$8191;($length$8191=temp$8186.length);;var $index$8196;($index$8196=0);;$8179:for(;($index$8196<$length$8191);($index$8196++)){var m$8204;(m$8204=temp$8186[$index$8196]);;var t0$8209;var t1$8210;var i$8214;var arg$8215;(t0$8209=m$8204);if(((t0$8209 instanceof Array)&&((t1$8210=t0$8209.length),(t1$8210===2)))){(i$8214=t0$8209[0]);(arg$8215=t0$8209[1]);(e$8178[i$8214]=arg$8215);}else{$8125(m$8204);;}}(e$8178["length"]=args$8169.length);(e$8178["name"]=["E"].concat(it$0$8173.tags).join("."));return e$8178;}else{$8125($8157$8159);}});($8139$8141.prototype["::check"]=function(e$8226){var it$0$8229;(it$0$8229=this);;var tags$8234;if(((!e$8226)||(!$7238(Error)(e$8226)))){return false;}(tags$8234=(e$8226["::tags"]||[]));;var temp$8243;(temp$8243=it$0$8229.tags);;var $length$8248;($length$8248=temp$8243.length);;var $index$8253;($index$8253=0);;$8235:for(;($index$8253<$length$8248);($index$8253++)){var m$8261;(m$8261=temp$8243[$index$8253]);;var tag$8269;(tag$8269=m$8261);if((tags$8234.indexOf(tag$8269)===-1)){return false;}else{false;;}}return true;});($8139$8141.prototype["::deconstruct"]=function(e$8277){var it$0$8280;(it$0$8280=this);;return e$8277.args;});$8314($8139$8141,$8314(function(){var accum$8285;(accum$8285=({}));(accum$8285["::name"]="$8139");return accum$8285;}(),function(){var accum$8289;(accum$8289=({}));(accum$8289["::egclass"]=true);return accum$8289;}()));return $8139$8141;}();
var $8125=function(value$8127,url$8128,start$8129,end$8130){var err$8133;(err$8133=$8138(["match"]).create("Could not find a match for value",({"value":value$8127})));;if(url$8128){(err$8133["location"]=["location",url$8128,start$8129,end$8130]);}throw err$8133;};
var $8326=function(type$8328){return function(value$8331){var f$8334;(f$8334=type$8328[":::project"]);;if((f$8334===(void 0))){var f$8339;(f$8339=type$8328["::project"]);;if((f$8339===(void 0))){return [true,type$8328(value$8331)];}else{var rval$8344;(rval$8344=false);;try{(rval$8344=[true,f$8339(value$8331)]);}catch(excv$8350){var e$8356;(e$8356=excv$8350);(rval$8344=[false,null]);}return rval$8344;}}else{return f$8334.call(type$8328,value$8331);}};};var $7285$7286;var __lt____lt____colon__$7287;var __plus____plus____colon__$7288;var transform$7289;var MAX$7290;var order_map$7291;var DONE$7292;var NONE$7293;var LEFT$7294;var RIGHT$7295;var BOTH$7296;var oparse$7297;var consult$7298;var order$7299;var finalize$7300;var parse$7301;($7285$7286=require("./location"));;(__lt____lt____colon__$7287=$7285$7286["<<:"]);;(__plus____plus____colon__$7288=$7285$7286["++:"]);;(transform$7289=function(expr$7314,cb$7315){var rval$7329;var tr$7318;var result$7319;(tr$7318=function(x$7323){return transform$7289(x$7323,cb$7315);});;(result$7319=(((rval$7329=false)),(function(){try{(rval$7329=cb$7315.call(tr$7318,expr$7314));}catch(excv$7335){var name$7375;var args$7376;var v$7370;var s$7365;var $7344$7355;var $7345$7356;var $7346$7357;var t0$7353;var $7343$7348;var e$7341;(e$7341=excv$7335);(rval$7329=((($7343$7348=expr$7314)),function(){if((($7344$7355=($7343$7348 instanceof Array))&&((t0$7353=$7343$7348.length),((t0$7353===1)&&($7343$7348[0]==="void"))))){return ["void"];}else{if(($7344$7355&&(($7346$7357=(t0$7353===2))&&($7343$7348[0]==="symbol")))){(s$7365=$7343$7348[1]);return expr$7314;}else{if(($7346$7357&&($7343$7348[0]==="value"))){(v$7370=$7343$7348[1]);return expr$7314;}else{if(($7344$7355&&(t0$7353>=1))){(name$7375=$7343$7348[0]);(args$7376=Array.prototype.slice.call($7343$7348,1));return [name$7375].concat(args$7376.map(tr$7318));}else{$8125($7343$7348);}}}}}()));}}(),rval$7329)));;return __lt____lt____colon__$7287(result$7319,expr$7314);});;(MAX$7290=(1/0));;(order_map$7291=({"IFX":({"wide":({",":[[15,1],[15,1]],"with":[[15,1999],[15,10]],"each":[[15,11],[15,10]],"each?":[[15,11],[15,10]],"where":[[15,11],[15,10]],"!!":[[15,11],[15,10]],"|>":[[15,11],[15,10]],"->":[[15,11],[15,10]],"=>":[[15,11],[15,10]],"=":[[15,11],[15,10]],":=":[[15,11],[15,10]],"+=":[[15,11],[15,10]],"-=":[[15,11],[15,10]],"*=":[[15,11],[15,10]],"/=":[[15,11],[15,10]],"<<=":[[15,11],[15,10]],">>=":[[15,11],[15,10]],">>>=":[[15,11],[15,10]],"++=":[[15,11],[15,10]],"?=":[[15,11],[15,10]],"or=":[[15,11],[15,10]],"and=":[[15,11],[15,10]],"each=":[[15,11],[15,10]],"%":[[15,11],[15,10]],"when":[[15,100],[15,101]],"||":[[15,110],[15,111]],"&&":[[15,120],[15,121]],"or":[[15,110],[15,111]],"and":[[15,120],[15,121]],"not":[[15,130],[15,131]],"==":[[15,200],[15,201]],"!=":[[15,200],[15,201]],">=":[[15,200],[15,201]],"<=":[[15,200],[15,201]],">":[[15,200],[15,201]],"<":[[15,200],[15,201]],"^.":[[15,400],[15,401]],"|.":[[15,410],[15,411]],"&.":[[15,420],[15,421]],"<<":[[1,500],[1,501]],">>":[[1,500],[1,501]],">>>":[[1,500],[1,501]],"+":[[1,550],[1,551]],"-":[[1,550],[1,551]],"*":[[1,560],[1,561]],"/":[[1,560],[1,561]],"mod":[[1,560],[1,561]],"**":[[1,571],[1,570]],"DEFAULT":[[8,900],[4,901]],"WHITE":[[15,1002],[15,1001]],":":[[15,1001],[15,2]]}),"short":({"DEFAULT":[[15,1800],[15,1801]],"WHITE":[[15,2000],[15,2001]],",":[[15,1],[15,1]],":":[[15,1001],[15,2]]})}),"PFX":({"wide":({"DEFAULT":[[15,MAX$7290],[15,900]],"when":[[15,MAX$7290],[15,101]],"not":[[15,MAX$7290],[15,131]],".":[[15,MAX$7290],[15,3000]],"#":[[15,MAX$7290],[15,3000]],"@":[[15,MAX$7290],[15,3000]],"<>":[[15,MAX$7290],[15,5]],"(":[[15,MAX$7290],[15,1]],"[":[[15,MAX$7290],[15,1]],"{":[[15,MAX$7290],[15,1]]}),"short":({"DEFAULT":[[15,MAX$7290],[15,1901]],".":[[15,MAX$7290],[15,3000]],"#":[[15,MAX$7290],[15,3000]],"@":[[15,MAX$7290],[15,3000]],"(":[[15,MAX$7290],[15,1]],"[":[[15,MAX$7290],[15,1]],"{":[[15,MAX$7290],[15,1]]})}),"SFX":({"wide":({"DEFAULT":[[15,901],[15,MAX$7290]],")":[[15,1],[15,MAX$7290]],"]":[[15,1],[15,MAX$7290]],"}":[[15,1],[15,MAX$7290]]}),"short":({"DEFAULT":[[15,1900],[15,MAX$7290]],")":[[15,1],[15,MAX$7290]],"]":[[15,1],[15,MAX$7290]],"}":[[15,1],[15,MAX$7290]]})})}));;(DONE$7292=-1);;(NONE$7293=0);;(LEFT$7294=1);;(RIGHT$7295=2);;(BOTH$7296=3);;(oparse$7297=function(next$7407,order$7408,finalize$7409){var between$7412;var right_op$7413;var stack$7414;var left_op$7415;var current$7416;(between$7412=finalize$7409(next$7407()));;(right_op$7413=next$7407());;(stack$7414=[]);;(left_op$7415=null);;(current$7416=null);;$7417:while(true){var v$7457;var other$7473;var $7436$7442;var o$7437;(o$7437=function(){if(((!left_op$7415)&&(!right_op$7413))){return DONE$7292;}else{return ((((!left_op$7415)&&RIGHT$7295)||((!right_op$7413)&&LEFT$7294))||order$7408(left_op$7415,right_op$7413));}}());;($7436$7442=o$7437);;if(($7436$7442===DONE$7292)){return between$7412;}else{if(($7436$7442===LEFT$7294)){current$7416.push(between$7412);(between$7412=finalize$7409(current$7416));(v$7457=stack$7414.pop());;(left_op$7415=v$7457[0]);(current$7416=v$7457[1]);}else{if(($7436$7442===RIGHT$7295)){stack$7414.push([left_op$7415,current$7416]);(left_op$7415=right_op$7413);(current$7416=[[right_op$7413],between$7412]);(between$7412=finalize$7409(next$7407()));(right_op$7413=next$7407());}else{if(($7436$7442===BOTH$7296)){current$7416[0].push(right_op$7413);current$7416.push(between$7412);(left_op$7415=right_op$7413);(between$7412=finalize$7409(next$7407()));(right_op$7413=next$7407());}else{(other$7473=$7436$7442);throw $8138(["should_never_happen"]).create("undefined priority",({"left":left_op$7415,"right":right_op$7413}));}}}}}});;(consult$7298=function($7478$7480){var t0$7486;var t1$7487;var map$7493;var fixity$7482;var width$7483;var op$7484;(t0$7486=$7478$7480);if(((t0$7486 instanceof Array)&&((t1$7487=t0$7486.length),(t1$7487===3)))){(fixity$7482=t0$7486[0]);(width$7483=t0$7486[1]);(op$7484=t0$7486[2]);;}else{$8125($7478$7480);}(map$7493=$7253($7253(order_map$7291,fixity$7482),width$7483));;return ($7253(map$7493,op$7484)||map$7493.DEFAULT);});;(order$7299=function(o1$7501,o2$7502){var t0$7512;var t1$7513;var t0$7519;var t1$7520;var $7506$7532;var $7505$7526;var code1$7507;var ord1$7508;var code2$7509;var ord2$7510;(t0$7512=consult$7298(o1$7501)[1]);if(((t0$7512 instanceof Array)&&((t1$7513=t0$7512.length),(t1$7513===2)))){(code1$7507=t0$7512[0]);(ord1$7508=t0$7512[1]);;}else{$8125(consult$7298(o1$7501)[1],"/home/olivier/git/earl-grey/src/parse.eg",6233,6247);}(t0$7519=consult$7298(o2$7502)[0]);if(((t0$7519 instanceof Array)&&((t1$7520=t0$7519.length),(t1$7520===2)))){(code2$7509=t0$7519[0]);(ord2$7510=t0$7519[1]);;}else{$8125(consult$7298(o2$7502)[0],"/home/olivier/git/earl-grey/src/parse.eg",6267,6281);}($7505$7526=null);;$7505$7526;if(((code1$7507&code2$7509)===0)){throw $8138(["syntax","order"]).create("Cannot mix operators in the given order",({"left":o1$7501,"right":o2$7502}));}else{if((ord1$7508>ord2$7510)){return LEFT$7294;}else{if((ord1$7508<ord2$7510)){return RIGHT$7295;}else{if((ord1$7508===ord2$7510)){return BOTH$7296;}else{$8125($7505$7526);}}}}});;(finalize$7300=function($7554$7556){var t0$7565;var $index$7642;var $length$7637;var temp$7632;var $index$7672;var $length$7667;var temp$7662;var $index$7711;var $length$7706;var temp$7701;var acc$7696;var other$7939;var args$7934;var f$7922;var orig_args$7923;var args$7924;var $7897$7909;var $7898$7910;var t0$7905;var t1$7906;var t2$7907;var $7896$7900;var inserted$7792;var result$7793;var f$7950;var other$8009;var x$8002;var $7983$7993;var $7984$7994;var t0$7991;var $7982$7986;var result$7947;var f$8017;var oloc$8084;var abloc$8085;var oabloc$8086;var rval$8087;var a$8079;var b$8080;var $7609$8064;var $7610$8065;var $7611$8066;var $7612$8067;var t0$8057;var t1$8058;var t2$8059;var t3$8060;var t4$8061;var t5$8062;var other$8104;var $7608$8053;var target$7778;var _b$7779;var body$7780;var f$7770;var body$7771;var f$7758;var arg$7759;var body$7760;var $7613$7749;var $7614$7750;var $7615$7751;var $7616$7752;var $7617$7753;var $7618$7754;var $7619$7755;var t0$7738;var t1$7739;var t2$7740;var t3$7741;var t4$7742;var t5$7743;var t6$7744;var t7$7745;var t8$7746;var bridge$7607$7747;var $7606$7733;var sumloc$7620;var orig_ops$7621;var op$7622;var other$8108;var ops$7601;var args$7602;var value$7592;var value$7587;var value$7581;var $7559$7576;var $7560$7577;var $7561$7578;var t0$7574;var $7558$7569;var ph$7562;var token$7563;(t0$7565=$7554$7556);(token$7563=t0$7565);(ph$7562=t0$7565);;($7558$7569=ph$7562);;if((($7559$7576=($7558$7569 instanceof Array))&&((t0$7574=$7558$7569.length),(($7561$7578=(t0$7574===2))&&($7558$7569[0]==="ID"))))){(value$7581=$7558$7569[1]);return __lt____lt____colon__$7287(["symbol",value$7581],token$7563);}else{if(($7561$7578&&($7558$7569[0]==="NUM"))){(value$7587=$7558$7569[1]);return __lt____lt____colon__$7287(["value",value$7587],token$7563);}else{if(($7561$7578&&($7558$7569[0]==="STR"))){(value$7592=$7558$7569[1]);return __lt____lt____colon__$7287(["value",value$7592],token$7563);}else{if(($7559$7576&&((t0$7574===1)&&($7558$7569[0]==="VOID")))){return __lt____lt____colon__$7287(["void"],token$7563);}else{if(($7559$7576&&(t0$7574>=1))){(ops$7601=$7558$7569[0]);(args$7602=Array.prototype.slice.call($7558$7569,1));(sumloc$7620=ops$7601[0].location);;(temp$7632=ops$7601.slice(1));;($length$7637=temp$7632.length);;($index$7642=0);;$7623:for(;($index$7642<$length$7637);($index$7642++)){var op$7658;var m$7650;(m$7650=temp$7632[$index$7642]);;(op$7658=m$7650);(sumloc$7620=__plus____plus____colon__$7288(sumloc$7620,op$7658));}(temp$7662=args$7602);;($length$7667=temp$7662.length);;($index$7672=0);;$7625:for(;($index$7672<$length$7667);($index$7672++)){var arg$7688;var m$7680;(m$7680=temp$7662[$index$7672]);;(arg$7688=m$7680);(sumloc$7620=__plus____plus____colon__$7288(sumloc$7620,arg$7688));}(orig_ops$7621=ops$7601);;(ops$7601=(((acc$7696=[])),(((temp$7701=ops$7601)),((($length$7706=temp$7701.length)),((($index$7711=0)),function(){$7693:for(;($index$7711<$length$7706);($index$7711++)){var o$7727;var m$7719;(m$7719=temp$7701[$index$7711]);;(o$7727=m$7719);acc$7696.push(o$7727[2]);}}()))),acc$7696));(op$7622=ops$7601[0]);;($7606$7733=[ops$7601,args$7602]);;if((($7613$7749=($7606$7733 instanceof Array))&&((t0$7738=$7606$7733.length),(($7615$7751=(t0$7738===2))&&((t1$7739=$7606$7733[0]),(($7617$7753=(t1$7739 instanceof Array))&&((t2$7740=t1$7739.length),((t2$7740===2)&&((t1$7739[0]==="WHITE")&&((t1$7739[1]===":")&&((t3$7741=$7606$7733[1]),((t3$7741 instanceof Array)&&((t4$7742=t3$7741.length),(t4$7742===3)))))))))))))){(f$7758=t3$7741[0]);(arg$7759=t3$7741[1]);(body$7760=t3$7741[2]);return __lt____lt____colon__$7287(["send",f$7758,__lt____lt____colon__$7287(["data",arg$7759,body$7760],__plus____plus____colon__$7288(arg$7759,body$7760))],sumloc$7620);}else{if(($7617$7753&&(($7619$7755=(t2$7740===1))&&((t1$7739[0]===":")&&((t3$7741=$7606$7733[1]),((t3$7741 instanceof Array)&&((t4$7742=t3$7741.length),(t4$7742===2)))))))){(f$7770=t3$7741[0]);(body$7771=t3$7741[1]);return __lt____lt____colon__$7287(["send",f$7770,__lt____lt____colon__$7287(["data",body$7771],body$7771)],sumloc$7620);}else{if(($7619$7755&&((t1$7739[0]==="with")&&((t3$7741=$7606$7733[1]),((t3$7741 instanceof Array)&&((t4$7742=t3$7741.length),((t4$7742===2)&&((target$7778=t3$7741[0]),((t5$7743=t3$7741[1]),((_b$7779=t5$7743),((t6$7744=$8326(["multi"])(t5$7743)),(t6$7744[0]&&((t7$7745=t6$7744[1]),((t8$7746=t7$7745.length),(t8$7746>=0))))))))))))))){(body$7780=Array.prototype.slice.call(t7$7745,0));(inserted$7792=false);;(result$7793=transform$7289(target$7778,function($7799$7801){var t0$7807;var $index$7867;var $length$7862;var temp$7857;var tr$7845;var res$7846;var args$7840;var x$7828;var f$7829;var a$7830;var b$7831;var t0$7816;var t1$7817;var t2$7818;var $7803$7811;var ph$7804;var expr$7805;(t0$7807=$7799$7801);(expr$7805=t0$7807);(ph$7804=t0$7807);;($7803$7811=ph$7804);;if((($7803$7811 instanceof Array)&&((t0$7816=$7803$7811.length),((t0$7816===2)&&(($7803$7811[0]==="symbol")&&($7803$7811[1]==="...")))))){(inserted$7792=true);return __lt____lt____colon__$7287(["multi"].concat(body$7780),_b$7779);}else{(x$7828=$7803$7811);if((x$7828.fromop&&(($7803$7811 instanceof Array)&&((t0$7816=$7803$7811.length),((t0$7816===3)&&(($7803$7811[0]==="send")&&((f$7829=$7803$7811[1]),((t1$7817=$7803$7811[2]),((t1$7817 instanceof Array)&&((t2$7818=t1$7817.length),((t2$7818===3)&&(t1$7817[0]==="data")))))))))))){(a$7830=t1$7817[1]);(b$7831=t1$7817[2]);return ["send",this(f$7829),__lt____lt____colon__$7287(["data",this(a$7830),this(b$7831)],__plus____plus____colon__$7288(a$7830,b$7831))];}else{if((($7803$7811 instanceof Array)&&((t0$7816=$7803$7811.length),((t0$7816>=1)&&($7803$7811[0]==="data"))))){(args$7840=Array.prototype.slice.call($7803$7811,1));(tr$7845=this);;(res$7846=["data"]);;(temp$7857=args$7840);;($length$7862=temp$7857.length);;($index$7867=0);;$7847:for(;($index$7867<$length$7862);($index$7867++)){var other$7891;var t0$7880;var t1$7881;var m$7875;(m$7875=temp$7857[$index$7867]);;(t0$7880=m$7875);if(((t0$7880 instanceof Array)&&((t1$7881=t0$7880.length),((t1$7881===2)&&((t0$7880[0]==="symbol")&&(t0$7880[1]==="...")))))){(inserted$7792=true);(res$7846=res$7846.concat(body$7780));}else{(other$7891=m$7875);res$7846.push(__lt____lt____colon__$7287(tr$7845(other$7891),other$7891));}}return __lt____lt____colon__$7287(res$7846,expr$7805);}else{$8125($7803$7811);}}}}));;if((!inserted$7792)){($7896$7900=target$7778);;if((($7896$7900 instanceof Array)&&((t0$7905=$7896$7900.length),((t0$7905===1)&&($7896$7900[0]==="void"))))){return __lt____lt____colon__$7287(["data"].concat(body$7780),sumloc$7620);}else{$7896$7900;if(target$7778.fromop){return __lt____lt____colon__$7287(["send",target$7778,__lt____lt____colon__$7287(["data"].concat(body$7780),_b$7779)],sumloc$7620);}else{if((($7897$7909=($7896$7900 instanceof Array))&&((t0$7905=$7896$7900.length),((t0$7905===3)&&(($7896$7900[0]==="send")&&((f$7922=$7896$7900[1]),((t1$7906=$7896$7900[2]),((orig_args$7923=t1$7906),((t1$7906 instanceof Array)&&((t2$7907=t1$7906.length),((t2$7907>=1)&&(t1$7906[0]==="data")))))))))))){(args$7924=Array.prototype.slice.call(t1$7906,1));return __lt____lt____colon__$7287(["send",f$7922,__lt____lt____colon__$7287(["data"].concat(args$7924).concat(body$7780),__plus____plus____colon__$7288(orig_args$7923,_b$7779))],sumloc$7620);}else{if(($7897$7909&&((t0$7905>=1)&&($7896$7900[0]==="data")))){(args$7934=Array.prototype.slice.call($7896$7900,1));return __lt____lt____colon__$7287(target$7778.concat(body$7780),sumloc$7620);}else{(other$7939=$7896$7900);return __lt____lt____colon__$7287(["send",target$7778,__lt____lt____colon__$7287(["data"].concat(body$7780),_b$7779)],sumloc$7620);}}}}}else{return __lt____lt____colon__$7287(result$7793,sumloc$7620);}}else{if(($7617$7753&&(($7619$7755=(t2$7740>=1))&&((bridge$7607$7747=t1$7739[0]),((bridge$7607$7747==="[")||(bridge$7607$7747===",")))))){Array.prototype.slice.call(t1$7739,1);$7606$7733[1];if((op$7622==="[")){(args$7602=args$7602.slice(1,-1));}(args$7602=(((f$7950=function($7953$7955){var other$7977;var t0$7968;var $7957$7963;var ph$7958;(ph$7958=$7953$7955);;($7957$7963=ph$7958);;if((($7957$7963 instanceof Array)&&((t0$7968=$7957$7963.length),((t0$7968===1)&&($7957$7963[0]==="void"))))){return false;}else{(other$7977=$7957$7963);return true;}})),args$7602.filter(f$7950)));(result$7947=((($7982$7986=args$7602)),function(){if((($7983$7993=($7982$7986 instanceof Array))&&((t0$7991=$7982$7986.length),(t0$7991===0)))){return ["value",(void 0)];}else{if(($7983$7993&&(t0$7991===1))){(x$8002=$7982$7986[0]);if(((!isNaN(sumloc$7620.start))&&(!isNaN(sumloc$7620.end)))){(x$8002["location"]=sumloc$7620);}return x$8002;}else{(other$8009=$7982$7986);return ["multi"].concat(args$7602);}}}()));;return __lt____lt____colon__$7287(result$7947,sumloc$7620);}else{if(($7619$7755&&(t1$7739[0]==="{"))){Array.prototype.slice.call(t1$7739,1);$7606$7733[1];(f$8017=function($8020$8022){var other$8044;var t0$8035;var $8024$8030;var ph$8025;(ph$8025=$8020$8022);;($8024$8030=ph$8025);;if((($8024$8030 instanceof Array)&&((t0$8035=$8024$8030.length),((t0$8035===1)&&($8024$8030[0]==="void"))))){return false;}else{(other$8044=$8024$8030);return true;}});;return __lt____lt____colon__$7287(["data"].concat(args$7602.slice(1,-1).filter(f$8017)),sumloc$7620);}else{if(($7617$7753&&(($7619$7755=(t2$7740===1))&&(t1$7739[0]==="WHITE")))){$7606$7733[1];return __lt____lt____colon__$7287(["send"].concat(args$7602),sumloc$7620);}else{if($7619$7755){t1$7739[0];($7608$8053=$7606$7733[1]);(t0$8057=$7608$8053);if((($7610$8065=(t0$8057 instanceof Array))&&((t1$8058=t0$8057.length),(($7612$8067=(t1$8058===2))&&((t2$8059=t0$8057[0]),((t2$8059 instanceof Array)&&((t3$8060=t2$8059.length),((t3$8060===1)&&((t2$8059[0]==="void")&&((t4$8061=t0$8057[1]),((t4$8061 instanceof Array)&&((t5$8062=t4$8061.length),((t5$8062===1)&&(t4$8061[0]==="void")))))))))))))){return __lt____lt____colon__$7287(["symbol",op$7622],orig_ops$7621[0]);}else{if($7612$8067){(a$8079=t0$8057[0]);(b$8080=t0$8057[1]);(oloc$8084=orig_ops$7621[0].location);;(abloc$8085=__plus____plus____colon__$7288(a$8079,b$8080));;(oabloc$8086=__plus____plus____colon__$7288(orig_ops$7621[0],abloc$8085));;(rval$8087=__lt____lt____colon__$7287(["send",__lt____lt____colon__$7287(["symbol",op$7622],oloc$8084),__lt____lt____colon__$7287(["data",a$8079,b$8080],abloc$8085)],__plus____plus____colon__$7288(oloc$8084,abloc$8085)));;(rval$8087["fromop"]=true);return rval$8087;}else{$8125($7608$8053,"/home/olivier/git/earl-grey/src/parse.eg",9806,9811);}}}else{(other$8104=$7606$7733);throw $8138(["should_never_happen"]).create("unknown node",({"node":token$7563}));}}}}}}}}else{(other$8108=$7558$7569);throw $8138(["should_never_happen"]).create("unknown node (B)",({"node":token$7563}));}}}}}});;(parse$7301=function(tokens$8114){var next$8117;(next$8117=function(){return tokens$8114.shift();});;return oparse$7297(next$8117,order$7299,finalize$7300);});;(exports["parse"]=parse$7301);(exports["order"]=order$7299);(exports["oparse"]=oparse$7297);(exports["finalize"]=finalize$7300);(exports["DONE"]=DONE$7292);(exports["NONE"]=NONE$7293);(exports["LEFT"]=LEFT$7294);(exports["RIGHT"]=RIGHT$7295);(exports["BOTH"]=BOTH$7296);

},{"./location":7}],10:[function(require,module,exports){
var $8519=function(type$8521){var f$8524;(f$8524=type$8521["::check"]);;if((f$8524===(void 0))){return function(value$8529){return (value$8529 instanceof type$8521);};}else{return function(value$8532){return f$8524.call(type$8521,value$8532);};}};
var $8534=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $8535=function($8536$8538){var ph$8542;(ph$8542=$8536$8538);;var $8540$8547;($8540$8547=ph$8542);;var bridge$8541$8552;var x$8556;(bridge$8541$8552=$8540$8547);if((((typeof(bridge$8541$8552)==="string")&&((x$8556=bridge$8541$8552),true))||((typeof(bridge$8541$8552)==="number")&&((x$8556=bridge$8541$8552),true)))){return ["value",x$8556];}else{var other$8563;(other$8563=$8540$8547);return other$8563["::serialize_ast"]();}};
var send$8359;(send$8359=function(obj$8364,$8362$8365){var ph$8369;var msg$8370;var t0$8372;(t0$8372=$8362$8365);(msg$8370=t0$8372);(ph$8369=t0$8372);;var $8367$8376;($8367$8376=ph$8369);;var bridge$8368$8381;(bridge$8368$8381=$8367$8376);if(((typeof(bridge$8368$8381)==="string")||(typeof(bridge$8368$8381)==="number"))){return obj$8364[msg$8370];}else{var other$8389;(other$8389=$8367$8376);return obj$8364["::send"](msg$8370);}});;(Array[":::project"]=function($8392$8394){var ph$8397;var value$8398;var t0$8400;(t0$8400=$8392$8394);(value$8398=t0$8400);(ph$8397=t0$8400);;var $8396$8404;($8396$8404=ph$8397);;if($8519(Array)($8396$8404)){return [true,value$8398];}else{$8396$8404;return [true,[value$8398]];}});(Array.prototype["::check"]=function(value$8418){if((value$8418 instanceof Array)){var i$8423;(i$8423=0);;$8421:for(;(i$8423<this.length);(i$8423++)){if(($8534(this,i$8423)!==$8534(value$8418,i$8423))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$8434){if((value$8434 instanceof Array)){var i$8439;(i$8439=0);;$8437:for(;(i$8439<this.length);(i$8439++)){if(($8534(this,i$8439)!==$8534(value$8434,i$8439))){return [true,[value$8434]];}}return [true,value$8434.slice(this.length)];}else{return [true,[value$8434]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($8535));});(RegExp.prototype["::check"]=function($8449$8451){var ph$8454;(ph$8454=$8449$8451);;var $8453$8459;($8453$8459=ph$8454);;var value$8467;if((typeof($8453$8459)==="string")){(value$8467=$8453$8459);if(value$8467.match(this)){return true;}else{return false;}}else{var other$8472;(other$8472=$8453$8459);return false;}});(RegExp.prototype[":::project"]=function($8474$8476){var ph$8479;(ph$8479=$8474$8476);;var $8478$8484;($8478$8484=ph$8479);;var value$8492;if((typeof($8478$8484)==="string")){(value$8492=$8478$8484);var $8495$8497;($8495$8497=value$8492.match(this));;var m$8505;if(($8495$8497===null)){(m$8505=$8495$8497);return [false,null];}else{var m$8510;(m$8510=$8495$8497);return [true,m$8510];}}else{var other$8514;(other$8514=$8478$8484);return [false,null];}});(Function.prototype["::send"]=function(args$8517){return this.apply(this,args$8517);});
var $11474=function(arr$11476){var results$11480;var l$11481;(results$11480=[]);;(l$11481=arr$11476.length);;var i$11489;(i$11489=0);;$11479:for(;(i$11489<l$11481);(i$11489++)){results$11480.push([i$11489,$8534(arr$11476,i$11489)]);}return results$11480;};
var $11496=function(value$11498,url$11499,start$11500,end$11501){var err$11504;(err$11504=$11320(["match"]).create("Could not find a match for value",({"value":value$11498})));;if(url$11499){(err$11504["location"]=["location",url$11499,start$11500,end$11501]);}throw err$11504;};
var $11509=function(dest$11511,values$11512){var k$11517;(k$11517=null);$11515:for(k$11517 in values$11512){if(values$11512.hasOwnProperty(k$11517)){(dest$11511[k$11517]=values$11512[k$11517]);}}return dest$11511;};
var $11320=function(){var $11321$11323;($11321$11323=function(tags$11327){var it$0$11330;(it$0$11330=function(){if((!$8519($11321$11323)(this))){return Object.create($11321$11323.prototype);}else{return this;}}());;(it$0$11330["tags"]=tags$11327);return it$0$11330;});;($11321$11323.prototype["create"]=function(){var $11339$11341;($11339$11341=arguments);;var t0$11346;var message$11350;var args$11351;(t0$11346=$11339$11341.length);if((t0$11346>=0)){(message$11350=function(){if((0>=t0$11346)){return "";}else{return $11339$11341[0];}}());(args$11351=Array.prototype.slice.call($11339$11341,1));var it$0$11355;(it$0$11355=this);;var e$11360;(e$11360=Error(message$11350));;(e$11360["::tags"]=it$0$11355.tags);(e$11360["args"]=args$11351);var temp$11368;(temp$11368=$11474(args$11351));;var $length$11373;($length$11373=temp$11368.length);;var $index$11378;($index$11378=0);;$11361:for(;($index$11378<$length$11373);($index$11378++)){var m$11386;(m$11386=temp$11368[$index$11378]);;var t0$11391;var t1$11392;var i$11396;var arg$11397;(t0$11391=m$11386);if(((t0$11391 instanceof Array)&&((t1$11392=t0$11391.length),(t1$11392===2)))){(i$11396=t0$11391[0]);(arg$11397=t0$11391[1]);(e$11360[i$11396]=arg$11397);}else{$11496(m$11386);;}}(e$11360["length"]=args$11351.length);(e$11360["name"]=["E"].concat(it$0$11355.tags).join("."));return e$11360;}else{$11496($11339$11341);}});($11321$11323.prototype["::check"]=function(e$11408){var it$0$11411;(it$0$11411=this);;var tags$11416;if(((!e$11408)||(!$8519(Error)(e$11408)))){return false;}(tags$11416=(e$11408["::tags"]||[]));;var temp$11425;(temp$11425=it$0$11411.tags);;var $length$11430;($length$11430=temp$11425.length);;var $index$11435;($index$11435=0);;$11417:for(;($index$11435<$length$11430);($index$11435++)){var m$11443;(m$11443=temp$11425[$index$11435]);;var tag$11451;(tag$11451=m$11443);if((tags$11416.indexOf(tag$11451)===-1)){return false;}else{false;;}}return true;});($11321$11323.prototype["::deconstruct"]=function(e$11459){var it$0$11462;(it$0$11462=this);;return e$11459.args;});$11509($11321$11323,$11509(function(){var accum$11467;(accum$11467=({}));(accum$11467["::name"]="$11321");return accum$11467;}(),function(){var accum$11471;(accum$11471=({}));(accum$11471["::egclass"]=true);return accum$11471;}()));return $11321$11323;}();
var $11521=function($11522$11524,key$11525){var ph$11529;(ph$11529=$11522$11524);;var $11527$11534;($11527$11534=ph$11529);;var bridge$11528$11539;(bridge$11528$11539=$11527$11534);if(((bridge$11528$11539===null)||(bridge$11528$11539===(void 0)))){return false;}else{var x$11547;if((typeof($11527$11534)==="string")){(x$11547=$11527$11534);return (key$11525 in String.prototype);}else{var x$11552;if((typeof($11527$11534)==="number")){(x$11552=$11527$11534);return (key$11525 in Number.prototype);}else{var x$11557;(x$11557=$11527$11534);return (key$11525 in x$11557);}}}};
var $11575=function($11576$11578){var ph$11584;var x$11585;var t0$11587;(t0$11587=$11576$11578);(x$11585=t0$11587);(ph$11584=t0$11587);;var $11580$11591;($11580$11591=ph$11584);;var bridge$11581$11596;(bridge$11581$11596=$11580$11591);if((function(){var bridge$11582$11602;(bridge$11582$11602=bridge$11581$11596);return (function(){var bridge$11583$11605;(bridge$11583$11605=bridge$11582$11602);return ((bridge$11583$11605===(void 0))||(bridge$11583$11605===null));}()||(typeof(bridge$11582$11602)==="string"));}()||(typeof(bridge$11581$11596)==="number"))){return x$11585;}else{if($11521($11580$11591,"::clone")){$11580$11591["::clone"];return x$11585["::clone"]();}else{$11580$11591;if((Object.getPrototypeOf(x$11585)===Object.prototype)){var dest$11618;(dest$11618=({}));;var k$11623;(k$11623=null);$11617:for(k$11623 in x$11585){if(Object.prototype.hasOwnProperty.call(x$11585,k$11623)){(dest$11618[k$11623]=x$11585[k$11623]);}}return dest$11618;}else{var other$11629;(other$11629=$11580$11591);throw $11320(["clone"]).create("Object cannot be cloned",({"obj":x$11585}));}}}};
var $11559=function(a$11561,b$11562){var dest$11566;(dest$11566=$11575(a$11561));;var k$11571;(k$11571=null);$11565:for(k$11571 in b$11562){if(Object.prototype.hasOwnProperty.call(b$11562,k$11571)){(dest$11566[k$11571]=b$11562[k$11571]);}}return dest$11566;};
var $11631=function(type$11633){return function(value$11636){var f$11639;(f$11639=type$11633[":::project"]);;if((f$11639===(void 0))){var f$11644;(f$11644=type$11633["::project"]);;if((f$11644===(void 0))){return [true,type$11633(value$11636)];}else{var rval$11649;(rval$11649=false);;try{(rval$11649=[true,f$11644(value$11636)]);}catch(excv$11655){var e$11661;(e$11661=excv$11655);(rval$11649=[false,null]);}return rval$11649;}}else{return f$11639.call(type$11633,value$11636);}};};
var $11663=function(from$11665,to$11666){var rval$11670;(rval$11670=[]);;var i$11675;(i$11675=from$11665);;$11669:for(;(i$11675<=to$11666);(i$11675++)){rval$11670.push(i$11675);}return rval$11670;};var accum$9278;var accum$9282;var accum$9864;var accum$9868;var $8566$8570;var __lt____gt__$8571;var $8567$8572;var __lt____lt____colon__$8573;var util$8574;var GenSym$8575;var gensym$8576;var zip$8577;var enumerate$8578;var iterkeys$8579;var neighbours$8580;var classify$8581;var classify_contiguous$8582;var identity$8583;var $8569$8584;var checker_db$8585;var PatternParser$8586;var PatternProcessor$8587;var assemble_conditions$8588;var assemble_pattern$8589;var inject_below_uses$8590;var parse_pattern$8591;var checkall$8592;var same_block$8593;var parse_clauses$8594;var opt_clauses$8595;var weave_clauses$8596;($8566$8570=require("./pp"));;(__lt____gt__$8571=$8566$8570["<>"]);;($8567$8572=require("./location"));;(__lt____lt____colon__$8573=$8567$8572["<<:"]);;(util$8574=require("./util"));;(GenSym$8575=util$8574.GenSym);;(gensym$8576=util$8574.gensym);;(zip$8577=util$8574.zip);;(enumerate$8578=util$8574.enumerate);;(iterkeys$8579=util$8574.keys);;(neighbours$8580=util$8574.neighbours);;(classify$8581=util$8574.classify);;(classify_contiguous$8582=util$8574.classify_contiguous);;(identity$8583=util$8574.identity);;($8569$8584=require("./expand"));;(checker_db$8585=$8569$8584.checker_db);;(PatternParser$8586=function(scope$8648,pattern$8649,opt$8650){var it$0$8653;(it$0$8653=function(){if((!$8519(PatternParser$8586)(this))){return Object.create(PatternParser$8586.prototype);}else{return this;}}());;(it$0$8653["opt"]=opt$8650);(it$0$8653["arguments"]=[]);(it$0$8653["vars"]=[]);(it$0$8653["specials"]=({}));(it$0$8653["pattern"]=it$0$8653.expand(scope$8648,pattern$8649,true,it$0$8653.opt.indexable));return it$0$8653;});;(PatternParser$8586.prototype["parse_specs"]=function(scope$8663,specs$8664){var $index$8705;var $length$8700;var temp$8695;var acc$8690;var rest$8672;var has_defaults$8673;var rval$8674;var it$0$8667;(it$0$8667=this);;(rest$8672=(void 0));;(has_defaults$8673=false);;(rval$8674=classify$8581("fw","bw","keys","defaults",(((acc$8690=[])),(((temp$8695=scope$8663.step_all(["pattern"],specs$8664))),((($length$8700=temp$8695.length)),((($index$8705=0)),function(){$8683:for(;($index$8705<$length$8700);($index$8705++)){var v$8757;var v$8752;var variable$8745;var value$8746;var key$8739;var subp$8740;var key$8734;var variable$8727;var $8685$8721;var $8686$8722;var $8687$8723;var $8688$8724;var t0$8718;var t1$8719;var m$8713;(m$8713=temp$8695[$index$8705]);;(t0$8718=m$8713);if((($8686$8722=(t0$8718 instanceof Array))&&((t1$8719=t0$8718.length),(($8688$8724=(t1$8719===2))&&(t0$8718[0]==="dynsplice"))))){(variable$8727=t0$8718[1]);acc$8690.push(((rest$8672=it$0$8667.expand(scope$8663,variable$8727)),["ignore"]));}else{if(($8688$8724&&(t0$8718[0]==="assoc"))){(key$8734=t0$8718[1]);acc$8690.push(["keys",[key$8734,it$0$8667.expand(scope$8663,key$8734)]]);}else{if(($8686$8722&&(($8688$8724=(t1$8719===3))&&(t0$8718[0]==="assoc")))){(key$8739=t0$8718[1]);(subp$8740=t0$8718[2]);acc$8690.push(["keys",[key$8739,it$0$8667.expand(scope$8663,subp$8740)]]);}else{if(($8688$8724&&(t0$8718[0]==="default"))){(variable$8745=t0$8718[1]);(value$8746=t0$8718[2]);acc$8690.push(((has_defaults$8673=true),function(){if(rest$8672){throw $11320(["syntax","pattern"]).create("No default arguments after rest arg.");}else{return ["defaults",[it$0$8667.expand(scope$8663,variable$8745),value$8746]];}}()));}else{(v$8752=m$8713);if(((rest$8672===(void 0))&&(!has_defaults$8673))){acc$8690.push(["fw",it$0$8667.expand(scope$8663,v$8752)]);}else{(v$8757=m$8713);acc$8690.push(["bw",it$0$8667.expand(scope$8663,v$8757)]);}}}}}}}()))),acc$8690)));;(rval$8674["rest"]=rest$8672);return rval$8674;});(PatternParser$8586.prototype["expand"]=function(){var x$8817;var x$8826;var x$8842;var x$8847;var msg$8893;var x$8905;var msg$8918;var msg$8927;var $index$8960;var $length$8955;var temp$8950;var acc$8945;var $index$9064;var $length$9059;var temp$9054;var acc$9049;var $index$9095;var $length$9090;var temp$9085;var t0$9156;var t1$9157;var t2$9158;var $index$9186;var $length$9181;var temp$9176;var acc$9171;var patts$9165;var canon$8984;var normalize$8985;var pps$8986;var vars$8987;var patt$9245;var msg$9266;var other$9263;var keys$9251;var fw$9233;var bw$9234;var defaults$9235;var rest$9236;var $9212$9230;var t0$9223;var t1$9224;var t2$9225;var t3$9226;var t4$9227;var t5$9228;var $9211$9218;var specs$9213;var other$9272;var args$9207;var xs$8980;var xs$8939;var x$8933;var f$8913;var arg$8914;var f$8899;var arguments$8900;var f$8886;var arg$8887;var checker$8880;var subp$8881;var projector$8874;var subp$8875;var condition$8868;var subp$8869;var v$8863;var v$8855;var type$8833;var $8795$8809;var $8796$8810;var $8797$8811;var $8798$8812;var t0$8805;var bridge$8794$8806;var t1$8807;var $8793$8800;var expr$8786;var rval$8787;var it$0$8781;var scope$8774;var pattern$8775;var toplevel$8776;var checked$8777;var t0$8770;var $8763$8765;($8763$8765=arguments);;(t0$8770=$8763$8765.length);if(((t0$8770>=2)&&(t0$8770<=4))){(scope$8774=$8763$8765[0]);(pattern$8775=$8763$8765[1]);(toplevel$8776=function(){if((2>=t0$8770)){return false;}else{return $8763$8765[2];}}());(checked$8777=function(){if((3>=t0$8770)){return false;}else{return $8763$8765[3];}}());(it$0$8781=this);;(expr$8786=scope$8774.step(["pattern"],pattern$8775));;(rval$8787=((($8793$8800=expr$8786)),function(){if((((x$8817=$8793$8800)),((x$8817 instanceof Array)&&(x$8817[0]==="void")))){return ["check",checker_db$8585.null,["ignore"]];}else{if((((x$8826=$8793$8800)),((x$8826 instanceof Array)&&(x$8826[0]==="ignore")))){return expr$8786;}else{if((($8793$8800 instanceof Array)&&((t0$8805=$8793$8800.length),((t0$8805===2)&&($8793$8800[0]==="special"))))){(type$8833=$8793$8800[1]);(it$0$8781.specials[type$8833]=true);return expr$8786;}else{(bridge$8794$8806=$8793$8800);if(((((x$8842=bridge$8794$8806)),((x$8842 instanceof Array)&&(x$8842[0]==="symbol")))||(((x$8847=bridge$8794$8806)),((x$8847 instanceof Array)&&(x$8847[0]==="variable"))))){it$0$8781.vars.push(expr$8786);return ["assign",expr$8786];}else{if((($8795$8809=($8793$8800 instanceof Array))&&((t0$8805=$8793$8800.length),(($8797$8811=(t0$8805===2))&&(($8798$8812=($8793$8800[0]==="value"))&&((v$8855=$8793$8800[1]),it$0$8781.opt.strings_as_variables)))))){it$0$8781.vars.push(expr$8786);return ["assign",expr$8786];}else{if($8798$8812){(v$8863=$8793$8800[1]);return ["check",checker_db$8585(v$8863),["ignore"]];}else{if(($8795$8809&&(($8797$8811=(t0$8805===3))&&($8793$8800[0]==="test")))){(condition$8868=$8793$8800[1]);(subp$8869=$8793$8800[2]);return ["test",condition$8868,it$0$8781.expand(scope$8774,subp$8869,toplevel$8776,false)];}else{if(($8797$8811&&($8793$8800[0]==="project"))){(projector$8874=$8793$8800[1]);(subp$8875=$8793$8800[2]);return ["project",projector$8874,it$0$8781.expand(scope$8774,subp$8875,toplevel$8776,true)];}else{if(($8797$8811&&($8793$8800[0]==="check"))){(checker$8880=$8793$8800[1]);(subp$8881=$8793$8800[2]);return ["check",checker$8880,it$0$8781.expand(scope$8774,subp$8881,toplevel$8776,true)];}else{if(($8797$8811&&(($8798$8812=($8793$8800[0]==="send"))&&((f$8886=$8793$8800[1]),((arg$8887=$8793$8800[2]),(!toplevel$8776)))))){(msg$8893="Function arguments can only be declared as a top level pattern.");;throw $11320(["syntax","pattern"]).create(msg$8893,({"node":expr$8786,"arg":arg$8887}));}else{if(($8798$8812&&((f$8899=$8793$8800[1]),((t1$8807=$8793$8800[2]),(((x$8905=t1$8807)),((x$8905 instanceof Array)&&(x$8905[0]==="data"))))))){(arguments$8900=t1$8807);it$0$8781.arguments.unshift(arguments$8900);return it$0$8781.expand(scope$8774,f$8899,true,false);}else{if($8798$8812){(f$8913=$8793$8800[1]);(arg$8914=$8793$8800[2]);(msg$8918=["Function must be declared with an array of arguments","(did you mean to use ':='?)"].join(" "));;throw $11320(["syntax","pattern"]).create(msg$8918,({"node":expr$8786,"arg":arg$8914}));}else{$8793$8800;if((!it$0$8781.opt.allow_nested)){(msg$8927="Nested patterns are not allowed here.");;throw $11320(["syntax","pattern"]).create(msg$8927,({"node":expr$8786}));}else{if((($8795$8809=($8793$8800 instanceof Array))&&((t0$8805=$8793$8800.length),((t0$8805===2)&&($8793$8800[0]==="neg"))))){(x$8933=$8793$8800[1]);return ["neg",it$0$8781.expand(scope$8774,x$8933)];}else{if(($8795$8809&&(($8797$8811=(t0$8805>=1))&&($8793$8800[0]==="all")))){(xs$8939=Array.prototype.slice.call($8793$8800,1));return ["all"].concat((((acc$8945=[])),(((temp$8950=xs$8939)),((($length$8955=temp$8950.length)),((($index$8960=0)),function(){$8942:for(;($index$8960<$length$8955);($index$8960++)){var x$8976;var m$8968;(m$8968=temp$8950[$index$8960]);;(x$8976=m$8968);acc$8945.push(it$0$8781.expand(scope$8774,x$8976));}}()))),acc$8945));}else{if(($8797$8811&&($8793$8800[0]==="any"))){(xs$8980=Array.prototype.slice.call($8793$8800,1));(canon$8984=function(all$8993){return all$8993.sort().join(",");});;(normalize$8985=function(vars$8999){var $index$9019;var $length$9014;var temp$9009;var acc$9004;return canon$8984((((acc$9004=[])),(((temp$9009=vars$8999)),((($length$9014=temp$9009.length)),((($index$9019=0)),function(){$9001:for(;($index$9019<$length$9014);($index$9019++)){var v$9037;var t0$9032;var t1$9033;var m$9027;(m$9027=temp$9009[$index$9019]);;(t0$9032=m$9027);if(((t0$9032 instanceof Array)&&((t1$9033=t0$9032.length),((t1$9033===2)&&(t0$9032[0]==="symbol"))))){(v$9037=t0$9032[1]);acc$9004.push(v$9037);}else{$11496(m$9027,"/home/olivier/git/earl-grey/src/pattern.eg",3447,3504);;}}}()))),acc$9004));});;(pps$8986=(((acc$9049=[])),(((temp$9054=xs$8980)),((($length$9059=temp$9054.length)),((($index$9064=0)),function(){$9046:for(;($index$9064<$length$9059);($index$9064++)){var x$9080;var m$9072;(m$9072=temp$9054[$index$9064]);;(x$9080=m$9072);acc$9049.push(PatternParser$8586(scope$8774,x$9080,it$0$8781.opt));}}()))),acc$9049));;(temp$9085=neighbours$8580(pps$8986));;($length$9090=temp$9085.length);;($index$9095=0);;$8988:for(;($index$9095<$length$9090);($index$9095++)){var $index$9133;var $length$9128;var temp$9123;var pp1$9113;var pp2$9114;var t0$9108;var t1$9109;var m$9103;(m$9103=temp$9085[$index$9095]);;(t0$9108=m$9103);if(((t0$9108 instanceof Array)&&((t1$9109=t0$9108.length),(t1$9109===2)))){(pp1$9113=t0$9108[0]);(pp2$9114=t0$9108[1]);(temp$9123=pps$8986);;($length$9128=temp$9123.length);;($index$9133=0);;$9119:for(;($index$9133<$length$9128);($index$9133++)){var pp$9149;var m$9141;(m$9141=temp$9123[$index$9133]);;(pp$9149=m$9141);normalize$8985(pp$9149.vars);}if((normalize$8985(pp1$9113.vars)!==normalize$8985(pp2$9114.vars))){throw $11320(["syntax","pattern"]).create("Both branches of 'or' must contain the same variables",({"vars1":__lt____lt____colon__$8573(pp1$9113.vars.sort(),pp1$9113.pattern),"vars2":__lt____lt____colon__$8573(pp2$9114.vars.sort(),pp2$9114.pattern)}));}if((canon$8984(iterkeys$8579(pp1$9113.specials))!==canon$8984(iterkeys$8579(pp2$9114.specials)))){throw $11320(["syntax","pattern"]).create("Both branches of 'or' must contain the same special tokens",({"special1":__lt____lt____colon__$8573(iterkeys$8579(pp1$9113.specials).sort(),pp1$9113.pattern),"special2":__lt____lt____colon__$8573(iterkeys$8579(pp2$9114.specials).sort(),pp2$9114.pattern)}));}}else{$11496(m$9103,"/home/olivier/git/earl-grey/src/pattern.eg",3580,4393);;}}(t0$9156=pps$8986);if(((t0$9156 instanceof Array)&&((t1$9157=t0$9156.length),((t1$9157>=1)&&((t2$9158=t0$9156[0]),$11521(t2$9158,"vars")))))){(vars$8987=t2$9158.vars);Array.prototype.slice.call(t0$9156,1);;}else{$11496(pps$8986,"/home/olivier/git/earl-grey/src/pattern.eg",4410,4413);}(it$0$8781["vars"]=it$0$8781.vars.concat(vars$8987));(patts$9165=(((acc$9171=[])),(((temp$9176=pps$8986)),((($length$9181=temp$9176.length)),((($index$9186=0)),function(){$9168:for(;($index$9186<$length$9181);($index$9186++)){var pp$9202;var m$9194;(m$9194=temp$9176[$index$9186]);;(pp$9202=m$9194);acc$9171.push(pp$9202.pattern);}}()))),acc$9171));;return ["any"].concat(patts$9165);}else{if(($8797$8811&&($8793$8800[0]==="data"))){(args$9207=Array.prototype.slice.call($8793$8800,1));(specs$9213=it$0$8781.parse_specs(scope$8774,args$9207));;($9211$9218=specs$9213);;if((($9212$9230=$11521($9211$9218,"keys"))&&((t0$9223=$9211$9218.keys),((t0$9223 instanceof Array)&&((t1$9224=t0$9223.length),((t1$9224===0)&&($11521($9211$9218,"fw")&&((fw$9233=$9211$9218.fw),($11521($9211$9218,"bw")&&((bw$9234=$9211$9218.bw),($11521($9211$9218,"defaults")&&((defaults$9235=$9211$9218.defaults),$11521($9211$9218,"rest"))))))))))))){(rest$9236=$9211$9218.rest);(patt$9245=__lt____lt____colon__$8573(["array_pattern",fw$9233,bw$9234,defaults$9235,rest$9236],pattern$8775));;if(checked$8777){return patt$9245;}else{return ["check",checker_db$8585.Array,patt$9245];}}else{if(($9212$9230&&((keys$9251=$9211$9218.keys),($11521($9211$9218,"fw")&&((t0$9223=$9211$9218.fw),((t0$9223 instanceof Array)&&((t1$9224=t0$9223.length),((t1$9224===0)&&($11521($9211$9218,"bw")&&((t2$9225=$9211$9218.bw),((t2$9225 instanceof Array)&&((t3$9226=t2$9225.length),((t3$9226===0)&&($11521($9211$9218,"defaults")&&((t4$9227=$9211$9218.defaults),((t4$9227 instanceof Array)&&((t5$9228=t4$9227.length),((t5$9228===0)&&($11521($9211$9218,"rest")&&($9211$9218.rest===(void 0))))))))))))))))))))){return ["object_pattern"].concat(keys$9251);}else{(other$9263=$9211$9218);(msg$9266="Pattern must be an array or an object.");;throw $11320(["syntax","pattern"]).create(msg$9266,({"node":expr$8786,"specs":specs$9213}));}}}else{(other$9272=$8793$8800);throw $11320(["syntax","pattern"]).create("Illegal pattern",({"node":other$9272}));}}}}}}}}}}}}}}}}}}()));;return (it$0$8781.opt.wrap_pattern||identity$8583)(__lt____lt____colon__$8573(rval$8787,pattern$8775),toplevel$8776);}else{$11496($8763$8765);}});$11509(PatternParser$8586,$11509(((accum$9278=({})),((accum$9278["::name"]="PatternParser"),accum$9278)),((accum$9282=({})),((accum$9282["::egclass"]=true),accum$9282))));PatternParser$8586;(PatternProcessor$8587=function(){var it$0$9290;(it$0$9290=function(){if((!$8519(PatternProcessor$8587)(this))){return Object.create(PatternProcessor$8587.prototype);}else{return this;}}());;(it$0$9290["temps"]=[]);(it$0$9290["parts"]=[]);(it$0$9290["gen"]=GenSym$8575("t"));return it$0$9290;});;(PatternProcessor$8587.prototype["do"]=function(part$9300){var it$0$9303;(it$0$9303=this);;return it$0$9303.parts.push(["do",part$9300]);});(PatternProcessor$8587.prototype["check"]=function(){var it$0$9326;var part$9321;var tags$9322;var t0$9317;var $9310$9312;($9310$9312=arguments);;(t0$9317=$9310$9312.length);if(((t0$9317>=1)&&(t0$9317<=2))){(part$9321=$9310$9312[0]);(tags$9322=function(){if((1>=t0$9317)){return ({});}else{return $9310$9312[1];}}());(it$0$9326=this);;return it$0$9326.parts.push($11559(["check",part$9321],tags$9322));}else{$11496($9310$9312);}});(PatternProcessor$8587.prototype["temp"]=function(){var x$9369;var x$9374;var init$9381;var bridge$9352$9363;var $9351$9358;var it$0$9353;var x$9346;var v$9347;var t0$9342;var $9335$9337;($9335$9337=arguments);;(t0$9342=$9335$9337.length);if(((t0$9342>=1)&&(t0$9342<=2))){(x$9346=$9335$9337[0]);(v$9347=function(){if((1>=t0$9342)){return null;}else{return $9335$9337[1];}}());(it$0$9353=this);;($9351$9358=x$9346);;(bridge$9352$9363=$9351$9358);if((((((x$9369=bridge$9352$9363)),((x$9369 instanceof Array)&&(x$9369[0]==="variable")))||(((x$9374=bridge$9352$9363)),((x$9374 instanceof Array)&&(x$9374[0]==="symbol"))))&&($11521($9351$9358,"single_assignment")&&($9351$9358.single_assignment&&(!v$9347))))){return x$9346;}else{(init$9381=$9351$9358);(v$9347=(v$9347||["symbol",it$0$9353.gen()]));(v$9347["single_assignment"]=true);it$0$9353.temps.push(v$9347);it$0$9353.do(["send",["symbol",":="],["data",v$9347,init$9381]]);return v$9347;}}else{$11496($9335$9337);}});(PatternProcessor$8587.prototype["process"]=function(pattern$9389,rhs$9390,fns$9391){var x$9423;var x$9452;var t$9464;var t$9475;var pp$9485;var $index$9513;var $length$9508;var temp$9503;var t$9495;var $index$9571;var $length$9566;var temp$9561;var acc$9556;var fn$9542;var parts$9543;var t$9537;var $index$9623;var $length$9618;var temp$9613;var acc$9608;var t$9601;var otherwise$9722;var $9704$9706;var $index$9736;var $length$9731;var temp$9726;var $index$9773;var $length$9768;var temp$9763;var end$9815;var pos$9810;var $index$9835;var $length$9830;var temp$9825;var acc$9820;var nfw$9662;var nbw$9663;var ndflt$9664;var extract_length$9665;var check_length$9666;var lo$9667;var hi$9668;var t$9669;var len$9670;var fw$9655;var bw$9656;var dflt$9657;var rest$9658;var subp$9597;var xs$9533;var xs$9491;var patt$9481;var projector$9470;var subp$9471;var checker$9459;var subp$9460;var checker$9448;var condition$9441;var subp$9442;var kind$9436;var sym$9430;var $9403$9415;var $9404$9416;var $9405$9417;var $9406$9418;var t0$9413;var $9402$9408;var rval$9399;var it$0$9394;(it$0$9394=this);;(rval$9399=((($9402$9408=pattern$9389)),function(){if((((x$9423=$9402$9408)),((x$9423 instanceof Array)&&(x$9423[0]==="ignore")))){return it$0$9394.do(rhs$9390);}else{if((($9403$9415=($9402$9408 instanceof Array))&&((t0$9413=$9402$9408.length),(($9405$9417=(t0$9413===2))&&($9402$9408[0]==="assign"))))){(sym$9430=$9402$9408[1]);return it$0$9394.parts.push(fns$9391.assign(sym$9430,rhs$9390));}else{if(($9405$9417&&($9402$9408[0]==="special"))){(kind$9436=$9402$9408[1]);return it$0$9394.process(fns$9391.special(pattern$9389,rhs$9390),rhs$9390,fns$9391);}else{if(($9403$9415&&(($9405$9417=(t0$9413===3))&&($9402$9408[0]==="test")))){(condition$9441=$9402$9408[1]);(subp$9442=$9402$9408[2]);it$0$9394.process(subp$9442,rhs$9390,fns$9391);return it$0$9394.check(condition$9441,({"test":true}));}else{if(($9405$9417&&(($9406$9418=($9402$9408[0]==="check"))&&((checker$9448=$9402$9408[1]),(((x$9452=$9402$9408[2])),((x$9452 instanceof Array)&&(x$9452[0]==="ignore"))))))){return it$0$9394.check(["send",checker$9448,["data",rhs$9390]]);}else{if($9406$9418){(checker$9459=$9402$9408[1]);(subp$9460=$9402$9408[2]);(t$9464=it$0$9394.temp(rhs$9390));;it$0$9394.check(["send",checker$9459,["data",t$9464]]);return it$0$9394.process(subp$9460,t$9464,fns$9391);}else{if(($9405$9417&&($9402$9408[0]==="project"))){(projector$9470=$9402$9408[1]);(subp$9471=$9402$9408[2]);(t$9475=it$0$9394.temp(["send",projector$9470,["data",rhs$9390]]));;it$0$9394.check(["send",t$9475,["value",0]]);return it$0$9394.process(subp$9471,["send",t$9475,["value",1]],fns$9391);}else{if(($9403$9415&&((t0$9413===2)&&($9402$9408[0]==="neg")))){(patt$9481=$9402$9408[1]);return it$0$9394.check(["send",["symbol","not"],["data",["void"],(((pp$9485=PatternProcessor$8587())),pp$9485.process(patt$9481,rhs$9390,fns$9391),assemble_conditions$8588(pp$9485))]]);}else{if(($9403$9415&&(($9405$9417=(t0$9413>=1))&&($9402$9408[0]==="all")))){(xs$9491=Array.prototype.slice.call($9402$9408,1));(t$9495=it$0$9394.temp(rhs$9390));;(temp$9503=xs$9491);;($length$9508=temp$9503.length);;($index$9513=0);;$9496:for(;($index$9513<$length$9508);($index$9513++)){var x$9529;var m$9521;(m$9521=temp$9503[$index$9513]);;(x$9529=m$9521);it$0$9394.process(x$9529,t$9495,fns$9391);}return null;}else{if(($9405$9417&&($9402$9408[0]==="any"))){(xs$9533=Array.prototype.slice.call($9402$9408,1));(t$9537=it$0$9394.temp(rhs$9390,["symbol",gensym$8576("bridge")]));;return it$0$9394.check((((fn$9542=function(x$9547,rest$9548){return ["send",["symbol","or"],["data",x$9547,rest$9548]];})),((parts$9543=(((acc$9556=[])),(((temp$9561=xs$9533)),((($length$9566=temp$9561.length)),((($index$9571=0)),function(){$9553:for(;($index$9571<$length$9566);($index$9571++)){var pp$9590;var x$9587;var m$9579;(m$9579=temp$9561[$index$9571]);;(x$9587=m$9579);acc$9556.push((((pp$9590=PatternProcessor$8587())),pp$9590.process(x$9587,t$9537,fns$9391),assemble_conditions$8588(pp$9590)));}}()))),acc$9556))),util$8574.construct(parts$9543,fn$9542,["symbol","false"])));}else{if(($9405$9417&&($9402$9408[0]==="object_pattern"))){(subp$9597=Array.prototype.slice.call($9402$9408,1));(t$9601=it$0$9394.temp(rhs$9390));;(acc$9608=[]);;(temp$9613=subp$9597);;($length$9618=temp$9613.length);;($index$9623=0);;$9602:for(;($index$9623<$length$9618);($index$9623++)){var k$9643;var v$9644;var t0$9636;var t1$9637;var t2$9638;var t3$9639;var m$9631;(m$9631=temp$9613[$index$9623]);;(t0$9636=m$9631);if(((t0$9636 instanceof Array)&&((t1$9637=t0$9636.length),((t1$9637===2)&&((t2$9638=t0$9636[0]),((t2$9638 instanceof Array)&&((t3$9639=t2$9638.length),((t3$9639===2)&&(t2$9638[0]==="value"))))))))){(k$9643=t2$9638[1]);(v$9644=t0$9636[1]);acc$9608.push((it$0$9394.check(["send",["symbol","___hasprop"],["data",t$9601,["value",k$9643]]]),it$0$9394.process(v$9644,["send",t$9601,["value",k$9643]],fns$9391)));}else{$11496(m$9631,"/home/olivier/git/earl-grey/src/pattern.eg",7617,7749);;}}return acc$9608;}else{if(($9403$9415&&((t0$9413===5)&&($9402$9408[0]==="array_pattern")))){(fw$9655=$9402$9408[1]);(bw$9656=$9402$9408[2]);(dflt$9657=$9402$9408[3]);(rest$9658=$9402$9408[4]);(nfw$9662=fw$9655.length);;(nbw$9663=bw$9656.length);;(ndflt$9664=dflt$9657.length);;(extract_length$9665=true);;(check_length$9666=true);;(lo$9667=(nfw$9662+nbw$9663));;(hi$9668=(lo$9667+ndflt$9664));;(t$9669=it$0$9394.temp(rhs$9390));;(len$9670=it$0$9394.temp(["send",t$9669,["send",["symbol","."],["data",["void"],["symbol","length"]]]]));;it$0$9394.check(((($9704$9706=rest$9658)),function(){if($9704$9706){return ["send",["symbol",">="],["data",len$9670,["value",lo$9667]]];}else{$9704$9706;if((lo$9667===hi$9668)){return ["send",["symbol","==="],["data",len$9670,["value",lo$9667]]];}else{(otherwise$9722=$9704$9706);return ["send",["symbol","and"],["data",["send",["symbol",">="],["data",len$9670,["value",lo$9667]]],["send",["symbol","<="],["data",len$9670,["value",hi$9668]]]]];}}}()));(temp$9726=enumerate$8578(fw$9655));;($length$9731=temp$9726.length);;($index$9736=0);;$9671:for(;($index$9736<$length$9731);($index$9736++)){var i$9754;var m$9755;var t0$9749;var t1$9750;var m$9744;(m$9744=temp$9726[$index$9736]);;(t0$9749=m$9744);if(((t0$9749 instanceof Array)&&((t1$9750=t0$9749.length),(t1$9750===2)))){(i$9754=t0$9749[0]);(m$9755=t0$9749[1]);it$0$9394.process(m$9755,["send",t$9669,["value",i$9754]],fns$9391);}else{$11496(m$9744,"/home/olivier/git/earl-grey/src/pattern.eg",8481,8567);;}}(temp$9763=enumerate$8578(dflt$9657));;($length$9768=temp$9763.length);;($index$9773=0);;$9673:for(;($index$9773<$length$9768);($index$9773++)){var idx$9803;var i$9793;var patt$9794;var value$9795;var t0$9786;var t1$9787;var t2$9788;var t3$9789;var m$9781;(m$9781=temp$9763[$index$9773]);;(t0$9786=m$9781);if(((t0$9786 instanceof Array)&&((t1$9787=t0$9786.length),((t1$9787===2)&&((i$9793=t0$9786[0]),((t2$9788=t0$9786[1]),((t2$9788 instanceof Array)&&((t3$9789=t2$9788.length),(t3$9789===2))))))))){(patt$9794=t2$9788[0]);(value$9795=t2$9788[1]);(idx$9803=(i$9793+nfw$9662));;it$0$9394.process(patt$9794,["send",["symbol","if"],["data",["send",["symbol",">="],["data",["value",(idx$9803+nbw$9663)],len$9670]],value$9795,["send",t$9669,["value",idx$9803]]]],fns$9391);}else{$11496(m$9781,"/home/olivier/git/earl-grey/src/pattern.eg",8567,8736);;}}if((rest$9658!==(void 0))){(pos$9810=(nfw$9662+ndflt$9664));;(end$9815=function(){if((nbw$9663>0)){return [["value",(-nbw$9663)]];}else{return [];}}());;it$0$9394.process(rest$9658,["send",["send",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","slice"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",t$9669,["value",pos$9810]].concat(end$9815)],fns$9391);}else{[];}(acc$9820=[]);;(temp$9825=enumerate$8578(bw$9656));;($length$9830=temp$9825.length);;($index$9835=0);;$9675:for(;($index$9835<$length$9830);($index$9835++)){var i$9853;var m$9854;var t0$9848;var t1$9849;var m$9843;(m$9843=temp$9825[$index$9835]);;(t0$9848=m$9843);if(((t0$9848 instanceof Array)&&((t1$9849=t0$9848.length),(t1$9849===2)))){(i$9853=t0$9848[0]);(m$9854=t0$9848[1]);acc$9820.push(it$0$9394.process(m$9854,["send",["symbol","___js_fetch"],["data",t$9669,["send",["symbol","-"],["data",len$9670,["value",(nbw$9663-i$9853)]]]]],fns$9391));}else{$11496(m$9843,"/home/olivier/git/earl-grey/src/pattern.eg",9187,9293);;}}return acc$9820;}else{$11496($9402$9408);}}}}}}}}}}}}}()));;return rval$9399;});$11509(PatternProcessor$8587,$11509(((accum$9864=({})),((accum$9864["::name"]="PatternProcessor"),accum$9864)),((accum$9868=({})),((accum$9868["::egclass"]=true),accum$9868))));PatternProcessor$8587;(assemble_conditions$8588=function(pp$9874){var $index$9956;var $length$9951;var temp$9946;var acc$9941;var decls$9935;var construct$9877;(construct$9877=function($9880$9882){var x$9925;var rest$9926;var x$9918;var x$9910;var rest$9911;var $9885$9901;var $9886$9902;var t0$9897;var t1$9898;var t2$9899;var $9884$9892;var ph$9887;(ph$9887=$9880$9882);;($9884$9892=ph$9887);;if((($9885$9901=($9884$9892 instanceof Array))&&((t0$9897=$9884$9892.length),(t0$9897===0)))){return ["value",true];}else{if(($9885$9901&&((t0$9897>=1)&&((t1$9898=$9884$9892[0]),((t1$9898 instanceof Array)&&((t2$9899=t1$9898.length),((t2$9899===2)&&(t1$9898[0]==="do")))))))){(x$9910=t1$9898[1]);(rest$9911=Array.prototype.slice.call($9884$9892,1));return ["multi",x$9910,construct$9877(rest$9911)];}else{if(($9885$9901&&((t0$9897===1)&&((t1$9898=$9884$9892[0]),((t1$9898 instanceof Array)&&((t2$9899=t1$9898.length),((t2$9899===2)&&(t1$9898[0]==="check")))))))){(x$9918=t1$9898[1]);return x$9918;}else{if(($9885$9901&&((t0$9897>=1)&&((t1$9898=$9884$9892[0]),((t1$9898 instanceof Array)&&((t2$9899=t1$9898.length),((t2$9899===2)&&(t1$9898[0]==="check")))))))){(x$9925=t1$9898[1]);(rest$9926=Array.prototype.slice.call($9884$9892,1));return ["send",["symbol","and"],["data",x$9925,construct$9877(rest$9926)]];}else{$11496($9884$9892);}}}}});;if(pp$9874.temps.length){(decls$9935=(((acc$9941=[])),(((temp$9946=pp$9874.temps)),((($length$9951=temp$9946.length)),((($index$9956=0)),function(){$9938:for(;($index$9956<$length$9951);($index$9956++)){var t$9972;var m$9964;(m$9964=temp$9946[$index$9956]);;(t$9972=m$9964);acc$9941.push(["declare",t$9972]);}}()))),acc$9941));;return ["multi"].concat(decls$9935).concat([construct$9877(pp$9874.parts)]);}else{return construct$9877(pp$9874.parts);}});;(assemble_pattern$8589=function(){var $index$10026;var $length$10021;var temp$10016;var $index$10075;var $length$10070;var temp$10065;var test$10168;var lead$9996;var trail$9997;var construct$9998;var parts$9990;var t$9991;var f$9992;var t0$9986;var $9979$9981;($9979$9981=arguments);;(t0$9986=$9979$9981.length);if(((t0$9986>=2)&&(t0$9986<=3))){(parts$9990=$9979$9981[0]);(t$9991=$9979$9981[1]);(f$9992=function(){if((2>=t0$9986)){return null;}else{return $9979$9981[2];}}());(lead$9996=[]);;(temp$10016=parts$9990.slice(0));;($length$10021=temp$10016.length);;($index$10026=0);;$9999:for(;($index$10026<$length$10021);($index$10026++)){var x$10055;var x$10048;var $10001$10042;var $10002$10043;var $10003$10044;var $10004$10045;var t0$10039;var t1$10040;var m$10034;(m$10034=temp$10016[$index$10026]);;(t0$10039=m$10034);if((($10002$10043=(t0$10039 instanceof Array))&&((t1$10040=t0$10039.length),(($10004$10045=(t1$10040===2))&&(t0$10039[0]==="do"))))){(x$10048=t0$10039[1]);lead$9996.push(x$10048);parts$9990.shift();}else{if(($10004$10045&&(t0$10039[0]==="check"))){(x$10055=t0$10039[1]);break $9999;}else{$11496(m$10034,"/home/olivier/git/earl-grey/src/pattern.eg",9799,9909);;}}}(trail$9997=[]);;(temp$10065=parts$9990.slice(0).reverse());;($length$10070=temp$10065.length);;($index$10075=0);;$10005:for(;($index$10075<$length$10070);($index$10075++)){var x$10104;var x$10097;var $10007$10091;var $10008$10092;var $10009$10093;var $10010$10094;var t0$10088;var t1$10089;var m$10083;(m$10083=temp$10065[$index$10075]);;(t0$10088=m$10083);if((($10008$10092=(t0$10088 instanceof Array))&&((t1$10089=t0$10088.length),(($10010$10094=(t1$10089===2))&&(t0$10088[0]==="do"))))){(x$10097=t0$10088[1]);trail$9997.unshift(x$10097);parts$9990.pop();}else{if(($10010$10094&&(t0$10088[0]==="check"))){(x$10104=t0$10088[1]);break $10005;}else{$11496(m$10083,"/home/olivier/git/earl-grey/src/pattern.eg",9923,10045);;}}}(construct$9998=function($10111$10113){var other$10164;var x$10156;var rest$10157;var x$10149;var x$10141;var rest$10142;var $10116$10132;var $10117$10133;var t0$10128;var t1$10129;var t2$10130;var $10115$10123;var ph$10118;(ph$10118=$10111$10113);;($10115$10123=ph$10118);;if((($10116$10132=($10115$10123 instanceof Array))&&((t0$10128=$10115$10123.length),(t0$10128===0)))){return ["value",true];}else{if(($10116$10132&&((t0$10128>=1)&&((t1$10129=$10115$10123[0]),((t1$10129 instanceof Array)&&((t2$10130=t1$10129.length),((t2$10130===2)&&(t1$10129[0]==="do")))))))){(x$10141=t1$10129[1]);(rest$10142=Array.prototype.slice.call($10115$10123,1));return ["multi",x$10141,construct$9998(rest$10142)];}else{if(($10116$10132&&((t0$10128===1)&&((t1$10129=$10115$10123[0]),((t1$10129 instanceof Array)&&((t2$10130=t1$10129.length),((t2$10130===2)&&(t1$10129[0]==="check")))))))){(x$10149=t1$10129[1]);return x$10149;}else{if(($10116$10132&&((t0$10128>=1)&&((t1$10129=$10115$10123[0]),((t1$10129 instanceof Array)&&((t2$10130=t1$10129.length),((t2$10130===2)&&(t1$10129[0]==="check")))))))){(x$10156=t1$10129[1]);(rest$10157=Array.prototype.slice.call($10115$10123,1));return ["send",["symbol","and"],["data",x$10156,construct$9998(rest$10157)]];}else{(other$10164=$10115$10123);throw $11320(["oops"]).create("?!?",other$10164);}}}}});;if(parts$9990.length){(test$10168=construct$9998(parts$9990));;return ["multi"].concat(lead$9996).concat([function(){if(f$9992){return ["send",["symbol","if"],["data",test$10168,["multi"].concat(trail$9997).concat([t$9991]),f$9992]];}else{return ["send",["symbol","if"],["data",test$10168,["multi"].concat(trail$9997).concat([t$9991])]];}}()]);}else{return ["multi"].concat(lead$9996).concat(trail$9997).concat([t$9991]);}}else{$11496($9979$9981);}});;(inject_below_uses$8590=function($10177$10179,fn$10180){var other$10204;var scope$10197;var x$10198;var t0$10193;var $10182$10188;var ph$10183;(ph$10183=$10177$10179);;($10182$10188=ph$10183);;if((($10182$10188 instanceof Array)&&((t0$10193=$10182$10188.length),((t0$10193===3)&&($10182$10188[0]==="use"))))){(scope$10197=$10182$10188[1]);(x$10198=$10182$10188[2]);return ["use",scope$10197,inject_below_uses$8590(x$10198,fn$10180)];}else{(other$10204=$10182$10188);return fn$10180(other$10204);}});;(parse_pattern$8591=function(scope$10210,pattern$10211,rhs$10212,opt$10213){var t0$10224;var $index$10263;var $length$10258;var temp$10253;var acc$10248;var parse$10216;var target$10217;var proc$10218;(parse$10216=PatternParser$8586(scope$10210,pattern$10211,opt$10213));;if(((!opt$10213.allow_arguments)&&parse$10216.arguments.length)){throw $11320(["syntax","pattern","arguments"]).create("Arguments cannot be declared in this pattern",({"args":parse$10216.arguments[0]}));}(t0$10224=$11631((opt$10213.wrap_target||identity$8583))(function(){if(parse$10216.arguments.length){return inject_below_uses$8590(rhs$10212,function(x$10227){return util$8574.construct(parse$10216.arguments.concat([x$10227]),function(args$10230,rest$10231){return ["send",["symbol","->"],["data",args$10230,rest$10231]];});});}else{return rhs$10212;}}()));if(t0$10224[0]){(target$10217=t0$10224[1]);;}else{$11496(function(){if(parse$10216.arguments.length){return inject_below_uses$8590(rhs$10212,function(x$10236){return util$8574.construct(parse$10216.arguments.concat([x$10236]),function(args$10239,rest$10240){return ["send",["symbol","->"],["data",args$10239,rest$10240]];});});}else{return rhs$10212;}}(),"/home/olivier/git/earl-grey/src/pattern.eg",11438,11871);}(proc$10218=PatternProcessor$8587());;proc$10218.process(parse$10216.pattern,target$10217,opt$10213);if(opt$10213.finalize){return ["splice"].concat(opt$10213.declare(parse$10216.vars)).concat([["multi"].concat((((acc$10248=[])),(((temp$10253=proc$10218.temps)),((($length$10258=temp$10253.length)),((($index$10263=0)),function(){$10245:for(;($index$10263<$length$10258);($index$10263++)){var t$10279;var m$10271;(m$10271=temp$10253[$index$10263]);;(t$10279=m$10271);acc$10248.push(["declare",t$10279]);}}()))),acc$10248)).concat([assemble_pattern$8589(proc$10218.parts,opt$10213.success(target$10217),opt$10213.failure(target$10217))])]);}else{return [parse$10216.vars,proc$10218.temps,proc$10218.parts];}});;(checkall$8592=["send","data","multi","assign","void","check","do"]);;(same_block$8593=function($10287$10289,ban1$10290,ban2$10291){var $index$10392;var $length$10387;var temp$10382;var other$10413;var type1$10365;var args1$10366;var type2$10367;var args2$10368;var m1$10356;var m2$10357;var v1$10347;var v2$10348;var s1$10338;var s2$10339;var v1$10326;var v2$10327;var $10294$10317;var $10295$10318;var $10296$10319;var $10297$10320;var $10298$10321;var $10299$10322;var $10300$10323;var t0$10311;var t1$10312;var t2$10313;var t3$10314;var t4$10315;var $10293$10306;var ph$10301;(ph$10301=$10287$10289);;($10293$10306=ph$10301);;if((($10294$10317=($10293$10306 instanceof Array))&&((t0$10311=$10293$10306.length),(($10296$10319=(t0$10311===2))&&((t1$10312=$10293$10306[0]),(($10298$10321=(t1$10312 instanceof Array))&&((t2$10313=t1$10312.length),(($10300$10323=(t2$10313===2))&&((t1$10312[0]==="variable")&&((v1$10326=t1$10312[1]),((t3$10314=$10293$10306[1]),((t3$10314 instanceof Array)&&((t4$10315=t3$10314.length),((t4$10315===2)&&(t3$10314[0]==="variable"))))))))))))))){(v2$10327=t3$10314[1]);return (v1$10326===v2$10327);}else{if(($10300$10323&&((t1$10312[0]==="symbol")&&((s1$10338=t1$10312[1]),((t3$10314=$10293$10306[1]),((t3$10314 instanceof Array)&&((t4$10315=t3$10314.length),((t4$10315===2)&&(t3$10314[0]==="symbol"))))))))){(s2$10339=t3$10314[1]);return (((!$8534(ban1$10290,s1$10338))&&(!$8534(ban2$10291,s2$10339)))&&(s1$10338===s2$10339));}else{if(($10300$10323&&((t1$10312[0]==="value")&&((v1$10347=t1$10312[1]),((t3$10314=$10293$10306[1]),((t3$10314 instanceof Array)&&((t4$10315=t3$10314.length),((t4$10315===2)&&(t3$10314[0]==="value"))))))))){(v2$10348=t3$10314[1]);return (v1$10347===v2$10348);}else{if(($10300$10323&&((t1$10312[0]==="macro")&&((m1$10356=t1$10312[1]),((t3$10314=$10293$10306[1]),((t3$10314 instanceof Array)&&((t4$10315=t3$10314.length),((t4$10315===2)&&(t3$10314[0]==="macro"))))))))){(m2$10357=t3$10314[1]);return (m1$10356===m2$10357);}else{if(($10298$10321&&((t2$10313>=1)&&((type1$10365=t1$10312[0]),((args1$10366=Array.prototype.slice.call(t1$10312,1)),((t3$10314=$10293$10306[1]),((t3$10314 instanceof Array)&&((t4$10315=t3$10314.length),((t4$10315>=1)&&((type2$10367=t3$10314[0]),((args2$10368=Array.prototype.slice.call(t3$10314,1)),(checkall$8592.indexOf(type1$10365)!==-1)))))))))))){if(((type1$10365===type2$10367)&&(args1$10366.length===args2$10368.length))){(temp$10382=zip$8577(args1$10366,args2$10368));;($length$10387=temp$10382.length);;($index$10392=0);;$10378:for(;($index$10392<$length$10387);($index$10392++)){var pair$10408;var m$10400;(m$10400=temp$10382[$index$10392]);;(pair$10408=m$10400);if((!same_block$8593(pair$10408,ban1$10290,ban2$10291))){return false;}}return true;}else{return false;}}else{(other$10413=$10293$10306);return false;}}}}}});;(parse_clauses$8594=function(scope$10419,target$10420,stmts$10421,opt$10422){var $index$10452;var $length$10447;var temp$10442;var acc$10437;var $index$10628;var $length$10623;var temp$10618;var acc$10613;var $index$10675;var $length$10670;var temp$10665;var acc$10660;var decls$10654;var all_temps$10425;var the_parts$10426;var unique_temps$10427;(all_temps$10425=[]);;(the_parts$10426=(((acc$10437=[])),(((temp$10442=scope$10419.step_all(["clause"],stmts$10421))),((($length$10447=temp$10442.length)),((($index$10452=0)),function(){$10433:for(;($index$10452<$length$10447);($index$10452++)){var accum$10527;var accum$10538;var t0$10523;var t1$10524;var $index$10561;var $length$10556;var temp$10551;var bod$10588;var placeholder$10477;var special_fn$10478;var vars$10479;var temps$10480;var blocks$10481;var vars2$10482;var x$10597;var other$10604;var b$10594;var pattern$10471;var body$10472;var $10435$10468;var t0$10465;var t1$10466;var m$10460;(m$10460=temp$10442[$index$10452]);;(t0$10465=m$10460);if(((t0$10465 instanceof Array)&&((t1$10466=t0$10465.length),((t1$10466===3)&&(t0$10465[0]==="clause"))))){(pattern$10471=t0$10465[1]);(body$10472=t0$10465[2]);acc$10437.push((((placeholder$10477=(void 0))),((special_fn$10478=function($10490$10492,value$10493){var t0$10499;var t1$10500;var other$10519;var $10495$10506;var ph$10496;var expr$10497;(t0$10499=$10490$10492);if(((t0$10499 instanceof Array)&&((t1$10500=t0$10499.length),((t1$10500===2)&&(t0$10499[0]==="special"))))){(ph$10496=t0$10499[1]);(expr$10497=t0$10499);;}else{$11496($10490$10492);}($10495$10506=ph$10496);;if(($10495$10506==="match")){(placeholder$10477=__lt____lt____colon__$8573(["symbol",scope$10419.gensym("ph")],expr$10497));return ["assign",placeholder$10477];}else{(other$10519=$10495$10506);throw $11320(["syntax","pattern","special"]).create("Special token cannot be used here",({"special":expr$10497}));}})),((t0$10523=parse_pattern$8591(scope$10419,pattern$10471,target$10420,$11559(opt$10422,$11509(({"allow_arguments":false,"allow_nested":true,"special":special_fn$10478}),$11509(((accum$10527=({})),((accum$10527["assign"]=function(v$10531,value$10532){return ["do",__lt____lt____colon__$8573(["assign",v$10531,value$10532],v$10531)];}),accum$10527)),({"finalize":false})))))),function(){if(((t0$10523 instanceof Array)&&((t1$10524=t0$10523.length),(t1$10524===3)))){(vars$10479=t0$10523[0]);(temps$10480=t0$10523[1]);(blocks$10481=t0$10523[2]);}else{return $11496(parse_pattern$8591(scope$10419,pattern$10471,target$10420,$11559(opt$10422,$11509(({"allow_arguments":false,"allow_nested":true,"special":special_fn$10478}),$11509(((accum$10538=({})),((accum$10538["assign"]=function(v$10542,value$10543){return ["do",__lt____lt____colon__$8573(["assign",v$10542,value$10543],v$10542)];}),accum$10538)),({"finalize":false}))))),"/home/olivier/git/earl-grey/src/pattern.eg",13491,13838);}}()),(all_temps$10425=all_temps$10425.concat(temps$10480)),function(){if(placeholder$10477){return vars$10479.push(placeholder$10477);}}(),((vars2$10482=({}))),(((temp$10551=vars$10479)),((($length$10556=temp$10551.length)),((($index$10561=0)),function(){$10483:for(;($index$10561<$length$10556);($index$10561++)){var other$10585;var xxx$10579;var t0$10574;var t1$10575;var m$10569;(m$10569=temp$10551[$index$10561]);;(t0$10574=m$10569);if(((t0$10574 instanceof Array)&&((t1$10575=t0$10574.length),((t1$10575===2)&&(t0$10574[0]==="symbol"))))){(xxx$10579=t0$10574[1]);(vars2$10482[xxx$10579]=true);}else{(other$10585=m$10569);throw $11320(["syntax","unexpected"]).create();}}}()))),(((bod$10588=function(){if(placeholder$10477){return parse_clauses$8594(scope$10419,placeholder$10477,$11631(["multi"])(body$10472)[1],opt$10422);}else{if(opt$10422.wrap){return opt$10422.wrap(body$10472);}else{return body$10472;}}}())),["clause",vars$10479,vars2$10482,blocks$10481,bod$10588])));}else{if((((x$10597=t0$10465)),((x$10597 instanceof Array)&&(x$10597[0]==="block")))){(b$10594=t0$10465);acc$10437.push(b$10594);}else{(other$10604=m$10460);acc$10437.push(function(){throw $11320(["syntax","clause"]).create("Illegal clause",({"clause":other$10604}));}());}}}}()))),acc$10437));;if(opt$10422.fallback){the_parts$10426.push(["block",opt$10422.fallback(target$10420)]);}(unique_temps$10427=iterkeys$8579(util$8574.set((((acc$10613=[])),(((temp$10618=all_temps$10425)),((($length$10623=temp$10618.length)),((($index$10628=0)),function(){$10610:for(;($index$10628<$length$10623);($index$10628++)){var t$10646;var t0$10641;var t1$10642;var m$10636;(m$10636=temp$10618[$index$10628]);;(t0$10641=m$10636);if(((t0$10641 instanceof Array)&&((t1$10642=t0$10641.length),((t1$10642===2)&&(t0$10641[0]==="symbol"))))){(t$10646=t0$10641[1]);acc$10613.push(t$10646);}else{$11496(m$10636,"/home/olivier/git/earl-grey/src/pattern.eg",14650,14680);;}}}()))),acc$10613))));;(decls$10654=(((acc$10660=[])),(((temp$10665=unique_temps$10427)),((($length$10670=temp$10665.length)),((($index$10675=0)),function(){$10657:for(;($index$10675<$length$10670);($index$10675++)){var t$10691;var m$10683;(m$10683=temp$10665[$index$10675]);;(t$10691=m$10683);acc$10660.push(["declare",["symbol",t$10691]]);}}()))),acc$10660));;return ["multi"].concat(decls$10654).concat([weave_clauses$8596(the_parts$10426)]);});;(opt_clauses$8595=function(clauses$10698){var $index$10727;var $length$10722;var temp$10717;var acc$10712;var $index$10862;var $length$10857;var temp$10852;var acc$10847;var $index$10907;var $length$10902;var temp$10897;var acc$10892;var $index$10951;var $length$10946;var temp$10941;var acc$10936;var shares$10701;var max$10702;var temps$10703;var shared_last$10704;var idx_last$10705;var new_clauses$10706;(shares$10701=(((acc$10712=[])),(((temp$10717=enumerate$8578(clauses$10698.slice(1)))),((($length$10722=temp$10717.length)),((($index$10727=0)),function(){$10709:for(;($index$10727<$length$10722);($index$10727++)){var t0$10766;var t1$10767;var $index$10790;var $length$10785;var temp$10780;var varsd0$10759;var blocks0$10760;var share$10761;var idx$10762;var i$10747;var vars$10748;var varsd$10749;var blocks$10750;var body$10751;var t0$10740;var t1$10741;var t2$10742;var t3$10743;var m$10735;(m$10735=temp$10717[$index$10727]);;(t0$10740=m$10735);if(((t0$10740 instanceof Array)&&((t1$10741=t0$10740.length),((t1$10741===2)&&((i$10747=t0$10740[0]),((t2$10742=t0$10740[1]),((t2$10742 instanceof Array)&&((t3$10743=t2$10742.length),((t3$10743===5)&&(t2$10742[0]==="clause")))))))))){(vars$10748=t2$10742[1]);(varsd$10749=t2$10742[2]);(blocks$10750=t2$10742[3]);(body$10751=t2$10742[4]);acc$10712.push((((t0$10766=$8534(clauses$10698,i$10747)),function(){if(((t0$10766 instanceof Array)&&((t1$10767=t0$10766.length),((t1$10767===5)&&(t0$10766[0]==="clause"))))){t0$10766[1];(varsd0$10759=t0$10766[2]);(blocks0$10760=t0$10766[3]);t0$10766[4];}else{return $11496($8534(clauses$10698,i$10747),"/home/olivier/git/earl-grey/src/pattern.eg",14953,14963);}}()),((share$10761=0)),((idx$10762=0)),(((temp$10780=blocks$10750)),((($length$10785=temp$10780.length)),((($index$10790=0)),function(){$10763:for(;($index$10790<$length$10785);($index$10790++)){var x$10821;var x$10830;var other$10837;var $10809$10811;var b$10806;var m$10798;(m$10798=temp$10780[$index$10790]);;(b$10806=m$10798);if(same_block$8593([$8534(blocks0$10760,share$10761),b$10806],varsd0$10759,varsd$10749)){(share$10761++);($10809$10811=b$10806);;if((((x$10821=$10809$10811)),((x$10821 instanceof Array)&&(x$10821[0]==="do")))){null;}else{if((((x$10830=$10809$10811)),((x$10830 instanceof Array)&&(x$10830[0]==="check")))){(idx$10762=share$10761);}else{(other$10837=$10809$10811);__lt____gt__$8571(null,other$10837);}}}else{break $10763;}}}()))),[share$10761,idx$10762]));}else{$11496(m$10735,"/home/olivier/git/earl-grey/src/pattern.eg",14829,15350);;}}}()))),acc$10712));;(max$10702=$8534(Math.max,(((acc$10847=[])),(((temp$10852=shares$10701)),((($length$10857=temp$10852.length)),((($index$10862=0)),function(){$10844:for(;($index$10862<$length$10857);($index$10862++)){var x$10880;var t0$10875;var t1$10876;var m$10870;(m$10870=temp$10852[$index$10862]);;(t0$10875=m$10870);if(((t0$10875 instanceof Array)&&((t1$10876=t0$10875.length),(t1$10876===2)))){(x$10880=t0$10875[0]);t0$10875[1];acc$10847.push(x$10880);}else{$11496(m$10870,"/home/olivier/git/earl-grey/src/pattern.eg",15364,15389);;}}}()))),acc$10847)));;shares$10701.push([0,0]);(temps$10703=(((acc$10892=[])),(((temp$10897=$11663(1,max$10702))),((($length$10902=temp$10897.length)),((($index$10907=0)),function(){$10889:for(;($index$10907<$length$10902);($index$10907++)){var m$10915;(m$10915=temp$10897[$index$10907]);;m$10915;acc$10892.push(["symbol",gensym$8576()]);}}()))),acc$10892));;(shared_last$10704=0);;(idx_last$10705=0);;(new_clauses$10706=(((acc$10936=[])),(((temp$10941=enumerate$8578(clauses$10698))),((($length$10946=temp$10941.length)),((($index$10951=0)),function(){$10933:for(;($index$10951<$length$10946);($index$10951++)){var t0$10989;var t1$10990;var $index$11025;var $length$11020;var temp$11015;var acc$11010;var rest$11074;var newblocks$11070;var share$10983;var idx$10984;var shared$10985;var n_to_share$10986;var to_share$10987;var other$11081;var i$10971;var vars$10972;var varsd$10973;var blocks$10974;var body$10975;var t0$10964;var t1$10965;var t2$10966;var t3$10967;var m$10959;(m$10959=temp$10941[$index$10951]);;(t0$10964=m$10959);if(((t0$10964 instanceof Array)&&((t1$10965=t0$10964.length),((t1$10965===2)&&((i$10971=t0$10964[0]),((t2$10966=t0$10964[1]),((t2$10966 instanceof Array)&&((t3$10967=t2$10966.length),((t3$10967===5)&&(t2$10966[0]==="clause")))))))))){(vars$10972=t2$10966[1]);(varsd$10973=t2$10966[2]);(blocks$10974=t2$10966[3]);(body$10975=t2$10966[4]);acc$10936.push((((t0$10989=$8534(shares$10701,i$10971)),function(){if(((t0$10989 instanceof Array)&&((t1$10990=t0$10989.length),(t1$10990===2)))){(share$10983=t0$10989[0]);(idx$10984=t0$10989[1]);}else{return $11496($8534(shares$10701,i$10971),"/home/olivier/git/earl-grey/src/pattern.eg",15614,15623);}}()),((shared$10985=function(){if(idx_last$10705){return [["check",$8534(temps$10703,(idx_last$10705-1))]];}else{return [];}}())),((n_to_share$10986=Math.max(shared_last$10704,share$10983))),((to_share$10987=(((acc$11010=[])),(((temp$11015=enumerate$8578(blocks$10974.slice(shared_last$10704,n_to_share$10986)))),((($length$11020=temp$11015.length)),((($index$11025=0)),function(){$11003:for(;($index$11025<$length$11020);($index$11025++)){var j$11059;var x$11060;var j$11049;var x$11050;var $11005$11043;var $11006$11044;var $11007$11045;var $11008$11046;var t0$11038;var t1$11039;var t2$11040;var t3$11041;var m$11033;(m$11033=temp$11015[$index$11025]);;(t0$11038=m$11033);if((($11006$11044=(t0$11038 instanceof Array))&&((t1$11039=t0$11038.length),(($11008$11046=(t1$11039===2))&&((j$11049=t0$11038[0]),((t2$11040=t0$11038[1]),((t2$11040 instanceof Array)&&((t3$11041=t2$11040.length),((t3$11041===2)&&(t2$11040[0]==="check")))))))))){(x$11050=t2$11040[1]);acc$11010.push(["check",["assign",$8534(temps$10703,(shared_last$10704+j$11049)),x$11050]]);}else{if(($11008$11046&&((j$11059=t0$11038[0]),((t2$11040=t0$11038[1]),((t2$11040 instanceof Array)&&((t3$11041=t2$11040.length),((t3$11041===2)&&(t2$11040[0]==="do")))))))){(x$11060=t2$11040[1]);acc$11010.push(["do",x$11060]);}else{$11496(m$11033,"/home/olivier/git/earl-grey/src/pattern.eg",15762,15933);;}}}}()))),acc$11010))),(shared_last$10704=share$10983),(idx_last$10705=idx$10984),(((newblocks$11070=(((rest$11074=blocks$10974.slice(n_to_share$10986))),shared$10985.concat(to_share$10987).concat(rest$11074)))),["clause",vars$10972,varsd$10973,newblocks$11070,body$10975])));}else{(other$11081=m$10959);acc$10936.push(function(){throw $11320(["oops"]).create("what",({"value":other$11081}));}());}}}()))),acc$10936));;return [temps$10703,new_clauses$10706];});;(weave_clauses$8596=function(parts$11088){var $index$11134;var $length$11129;var temp$11124;var $index$11300;var $length$11295;var temp$11290;var acc$11285;var groups$11091;var reassemble$11092;var new_temps$11093;var helper$11094;(groups$11091=classify_contiguous$8582(parts$11088,function($11103$11105){var t0$11109;var t1$11110;var cls$11107;(t0$11109=$11103$11105);if(((t0$11109 instanceof Array)&&((t1$11110=t0$11109.length),(t1$11110>=1)))){(cls$11107=t0$11109[0]);Array.prototype.slice.call(t0$11109,1);;}else{$11496($11103$11105);}return cls$11107;}));;(reassemble$11092=[]);;(new_temps$11093=[]);;(temp$11124=groups$11091);;($length$11129=temp$11124.length);;($index$11134=0);;$11095:for(;($index$11134<$length$11129);($index$11134++)){var t0$11164;var t1$11165;var ts$11161;var new_clauses$11162;var elems$11172;var elems$11156;var $11097$11150;var $11098$11151;var $11099$11152;var $11100$11153;var t0$11147;var t1$11148;var m$11142;(m$11142=temp$11124[$index$11134]);;(t0$11147=m$11142);if((($11098$11151=(t0$11147 instanceof Array))&&((t1$11148=t0$11147.length),(($11100$11153=(t1$11148>=1))&&(t0$11147[0]==="clause"))))){(elems$11156=Array.prototype.slice.call(t0$11147,1));(t0$11164=opt_clauses$8595(elems$11156));if(((t0$11164 instanceof Array)&&((t1$11165=t0$11164.length),(t1$11165===2)))){(ts$11161=t0$11164[0]);(new_clauses$11162=t0$11164[1]);;}else{$11496(opt_clauses$8595(elems$11156),"/home/olivier/git/earl-grey/src/pattern.eg",16428,16446);}(new_temps$11093=new_temps$11093.concat(ts$11161));(reassemble$11092=reassemble$11092.concat(new_clauses$11162));}else{if(($11100$11153&&(t0$11147[0]==="block"))){(elems$11172=Array.prototype.slice.call(t0$11147,1));(reassemble$11092=reassemble$11092.concat(elems$11172));}else{$11496(m$11142,"/home/olivier/git/earl-grey/src/pattern.eg",16362,16567);;}}}(helper$11094=function($11179$11181){var $index$11260;var $length$11255;var temp$11250;var acc$11245;var decls$11239;var vars$11231;var varsd$11232;var blocks$11233;var body$11234;var rest$11235;var body$11220;var rest$11221;var $11184$11207;var $11185$11208;var $11186$11209;var $11187$11210;var $11188$11211;var $11189$11212;var t0$11200;var t1$11201;var t2$11202;var t3$11203;var t4$11204;var t5$11205;var $11183$11195;var ph$11190;(ph$11190=$11179$11181);;($11183$11195=ph$11190);;if((($11184$11207=($11183$11195 instanceof Array))&&((t0$11200=$11183$11195.length),(t0$11200===0)))){return ["multi"];}else{if(($11184$11207&&(($11186$11209=(t0$11200>=1))&&((t1$11201=$11183$11195[0]),(($11188$11211=(t1$11201 instanceof Array))&&((t2$11202=t1$11201.length),((t2$11202===2)&&((t1$11201[0]==="block")&&((t3$11203=$11631(["multi"])(t1$11201[1])),(t3$11203[0]&&((t4$11204=t3$11203[1]),((t5$11205=t4$11204.length),(t5$11205>=0))))))))))))){(body$11220=Array.prototype.slice.call(t4$11204,0));(rest$11221=Array.prototype.slice.call($11183$11195,1));return ["multi"].concat(body$11220).concat([helper$11094(rest$11221)]);}else{if(($11188$11211&&((t2$11202===5)&&(t1$11201[0]==="clause")))){(vars$11231=t1$11201[1]);(varsd$11232=t1$11201[2]);(blocks$11233=t1$11201[3]);(body$11234=t1$11201[4]);(rest$11235=Array.prototype.slice.call($11183$11195,1));(decls$11239=(((acc$11245=[])),(((temp$11250=vars$11231)),((($length$11255=temp$11250.length)),((($index$11260=0)),function(){$11242:for(;($index$11260<$length$11255);($index$11260++)){var v$11276;var m$11268;(m$11268=temp$11250[$index$11260]);;(v$11276=m$11268);acc$11245.push(["declare",v$11276]);}}()))),acc$11245));;return ["tagscope","back",["multi"].concat(decls$11239).concat([assemble_pattern$8589(blocks$11233,body$11234,["use","back",helper$11094(rest$11235)])])];}else{$11496($11183$11195);}}}});;return ["multi"].concat((((acc$11285=[])),(((temp$11290=new_temps$11093)),((($length$11295=temp$11290.length)),((($index$11300=0)),function(){$11282:for(;($index$11300<$length$11295);($index$11300++)){var t$11316;var m$11308;(m$11308=temp$11290[$index$11300]);;(t$11316=m$11308);acc$11285.push(["declare",t$11316]);}}()))),acc$11285)).concat([helper$11094(reassemble$11092)]);});;(exports["PatternParser"]=PatternParser$8586);(exports["PatternProcessor"]=PatternProcessor$8587);(exports["parse_clauses"]=parse_clauses$8594);(exports["parse_pattern"]=parse_pattern$8591);

},{"./expand":5,"./location":7,"./pp":11,"./util":14}],11:[function(require,module,exports){
var $11843=function(type$11845){var f$11848;(f$11848=type$11845["::check"]);;if((f$11848===(void 0))){return function(value$11853){return (value$11853 instanceof type$11845);};}else{return function(value$11856){return f$11848.call(type$11845,value$11856);};}};
var $11858=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $11859=function($11860$11862){var ph$11866;(ph$11866=$11860$11862);;var $11864$11871;($11864$11871=ph$11866);;var bridge$11865$11876;var x$11880;(bridge$11865$11876=$11864$11871);if((((typeof(bridge$11865$11876)==="string")&&((x$11880=bridge$11865$11876),true))||((typeof(bridge$11865$11876)==="number")&&((x$11880=bridge$11865$11876),true)))){return ["value",x$11880];}else{var other$11887;(other$11887=$11864$11871);return other$11887["::serialize_ast"]();}};
var send$11683;(send$11683=function(obj$11688,$11686$11689){var ph$11693;var msg$11694;var t0$11696;(t0$11696=$11686$11689);(msg$11694=t0$11696);(ph$11693=t0$11696);;var $11691$11700;($11691$11700=ph$11693);;var bridge$11692$11705;(bridge$11692$11705=$11691$11700);if(((typeof(bridge$11692$11705)==="string")||(typeof(bridge$11692$11705)==="number"))){return obj$11688[msg$11694];}else{var other$11713;(other$11713=$11691$11700);return obj$11688["::send"](msg$11694);}});;(Array[":::project"]=function($11716$11718){var ph$11721;var value$11722;var t0$11724;(t0$11724=$11716$11718);(value$11722=t0$11724);(ph$11721=t0$11724);;var $11720$11728;($11720$11728=ph$11721);;if($11843(Array)($11720$11728)){return [true,value$11722];}else{$11720$11728;return [true,[value$11722]];}});(Array.prototype["::check"]=function(value$11742){if((value$11742 instanceof Array)){var i$11747;(i$11747=0);;$11745:for(;(i$11747<this.length);(i$11747++)){if(($11858(this,i$11747)!==$11858(value$11742,i$11747))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$11758){if((value$11758 instanceof Array)){var i$11763;(i$11763=0);;$11761:for(;(i$11763<this.length);(i$11763++)){if(($11858(this,i$11763)!==$11858(value$11758,i$11763))){return [true,[value$11758]];}}return [true,value$11758.slice(this.length)];}else{return [true,[value$11758]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($11859));});(RegExp.prototype["::check"]=function($11773$11775){var ph$11778;(ph$11778=$11773$11775);;var $11777$11783;($11777$11783=ph$11778);;var value$11791;if((typeof($11777$11783)==="string")){(value$11791=$11777$11783);if(value$11791.match(this)){return true;}else{return false;}}else{var other$11796;(other$11796=$11777$11783);return false;}});(RegExp.prototype[":::project"]=function($11798$11800){var ph$11803;(ph$11803=$11798$11800);;var $11802$11808;($11802$11808=ph$11803);;var value$11816;if((typeof($11802$11808)==="string")){(value$11816=$11802$11808);var $11819$11821;($11819$11821=value$11816.match(this));;var m$11829;if(($11819$11821===null)){(m$11829=$11819$11821);return [false,null];}else{var m$11834;(m$11834=$11819$11821);return [true,m$11834];}}else{var other$11838;(other$11838=$11802$11808);return [false,null];}});(Function.prototype["::send"]=function(args$11841){return this.apply(this,args$11841);});
var $12614=function(type$12616){return function(value$12619){var f$12622;(f$12622=type$12616[":::project"]);;if((f$12622===(void 0))){var f$12627;(f$12627=type$12616["::project"]);;if((f$12627===(void 0))){return [true,type$12616(value$12619)];}else{var rval$12632;(rval$12632=false);;try{(rval$12632=[true,f$12627(value$12619)]);}catch(excv$12638){var e$12644;(e$12644=excv$12638);(rval$12632=[false,null]);}return rval$12632;}}else{return f$12622.call(type$12616,value$12619);}};};
var $12813=function(arr$12815){var results$12819;var l$12820;(results$12819=[]);;(l$12820=arr$12815.length);;var i$12828;(i$12828=0);;$12818:for(;(i$12828<l$12820);(i$12828++)){results$12819.push([i$12828,$11858(arr$12815,i$12828)]);}return results$12819;};
var $12835=function(dest$12837,values$12838){var k$12843;(k$12843=null);$12841:for(k$12843 in values$12838){if(values$12838.hasOwnProperty(k$12843)){(dest$12837[k$12843]=values$12838[k$12843]);}}return dest$12837;};
var $12659=function(){var $12660$12662;($12660$12662=function(tags$12666){var it$0$12669;(it$0$12669=function(){if((!$11843($12660$12662)(this))){return Object.create($12660$12662.prototype);}else{return this;}}());;(it$0$12669["tags"]=tags$12666);return it$0$12669;});;($12660$12662.prototype["create"]=function(){var $12678$12680;($12678$12680=arguments);;var t0$12685;var message$12689;var args$12690;(t0$12685=$12678$12680.length);if((t0$12685>=0)){(message$12689=function(){if((0>=t0$12685)){return "";}else{return $12678$12680[0];}}());(args$12690=Array.prototype.slice.call($12678$12680,1));var it$0$12694;(it$0$12694=this);;var e$12699;(e$12699=Error(message$12689));;(e$12699["::tags"]=it$0$12694.tags);(e$12699["args"]=args$12690);var temp$12707;(temp$12707=$12813(args$12690));;var $length$12712;($length$12712=temp$12707.length);;var $index$12717;($index$12717=0);;$12700:for(;($index$12717<$length$12712);($index$12717++)){var m$12725;(m$12725=temp$12707[$index$12717]);;var t0$12730;var t1$12731;var i$12735;var arg$12736;(t0$12730=m$12725);if(((t0$12730 instanceof Array)&&((t1$12731=t0$12730.length),(t1$12731===2)))){(i$12735=t0$12730[0]);(arg$12736=t0$12730[1]);(e$12699[i$12735]=arg$12736);}else{$12646(m$12725);;}}(e$12699["length"]=args$12690.length);(e$12699["name"]=["E"].concat(it$0$12694.tags).join("."));return e$12699;}else{$12646($12678$12680);}});($12660$12662.prototype["::check"]=function(e$12747){var it$0$12750;(it$0$12750=this);;var tags$12755;if(((!e$12747)||(!$11843(Error)(e$12747)))){return false;}(tags$12755=(e$12747["::tags"]||[]));;var temp$12764;(temp$12764=it$0$12750.tags);;var $length$12769;($length$12769=temp$12764.length);;var $index$12774;($index$12774=0);;$12756:for(;($index$12774<$length$12769);($index$12774++)){var m$12782;(m$12782=temp$12764[$index$12774]);;var tag$12790;(tag$12790=m$12782);if((tags$12755.indexOf(tag$12790)===-1)){return false;}else{false;;}}return true;});($12660$12662.prototype["::deconstruct"]=function(e$12798){var it$0$12801;(it$0$12801=this);;return e$12798.args;});$12835($12660$12662,$12835(function(){var accum$12806;(accum$12806=({}));(accum$12806["::name"]="$12660");return accum$12806;}(),function(){var accum$12810;(accum$12810=({}));(accum$12810["::egclass"]=true);return accum$12810;}()));return $12660$12662;}();
var $12646=function(value$12648,url$12649,start$12650,end$12651){var err$12654;(err$12654=$12659(["match"]).create("Could not find a match for value",({"value":value$12648})));;if(url$12649){(err$12654["location"]=["location",url$12649,start$12650,end$12651]);}throw err$12654;};
var $12492=function(){var $12493$12495;($12493$12495=function($12498$12501,$12499$12502){var classes$12504;var children$12505;var t0$12507;(t0$12507=$12614(Array)($12498$12501));if(t0$12507[0]){(classes$12504=t0$12507[1]);;}else{$12646($12498$12501);}var t0$12512;(t0$12512=$12614(Array)($12499$12502));if(t0$12512[0]){(children$12505=t0$12512[1]);;}else{$12646($12499$12502);}var it$0$12517;(it$0$12517=function(){if((!$11843($12493$12495)(this))){return Object.create($12493$12495.prototype);}else{return this;}}());;(it$0$12517["classes"]=classes$12504.sort());(it$0$12517["children"]=children$12505);return it$0$12517;});;$12835(function(){var accum$12525;(accum$12525=({}));(accum$12525["::check"]=function(x$12529){return ((x$12529&&x$12529.classes)&&x$12529.children);});return accum$12525;}(),$12835(function(){var accum$12532;(accum$12532=({}));(accum$12532["::deconstruct"]=function(x$12536){return [x$12536.classes,x$12536.children];});return accum$12532;}(),$12835(function(){var accum$12539;(accum$12539=({}));(accum$12539["::name"]="$12493");return accum$12539;}(),function(){var accum$12543;(accum$12543=({}));(accum$12543["::egclass"]=true);return accum$12543;}())));($12493$12495.prototype["::check"]=function(n$12549){var it$0$12552;(it$0$12552=this);;var temp$12561;(temp$12561=it$0$12552.classes);;var $length$12566;($length$12566=temp$12561.length);;var $index$12571;($index$12571=0);;$12557:for(;($index$12571<$length$12566);($index$12571++)){var m$12579;(m$12579=temp$12561[$index$12571]);;var c$12587;(c$12587=m$12579);if((n$12549.classes.indexOf(c$12587)===-1)){return false;}else{false;;}}return true;});$12835($12493$12495,$12835(function(){var accum$12593;(accum$12593=({}));(accum$12593["::check"]=function(x$12597){return ((x$12597&&x$12597.classes)&&x$12597.children);});return accum$12593;}(),$12835(function(){var accum$12600;(accum$12600=({}));(accum$12600["::deconstruct"]=function(x$12604){return [x$12604.classes,x$12604.children];});return accum$12600;}(),$12835(function(){var accum$12607;(accum$12607=({}));(accum$12607["::name"]="$12493");return accum$12607;}(),function(){var accum$12611;(accum$12611=({}));(accum$12611["::egclass"]=true);return accum$12611;}()))));return $12493$12495;}();
var $12847=function($12848$12850,key$12851){var ph$12855;(ph$12855=$12848$12850);;var $12853$12860;($12853$12860=ph$12855);;var bridge$12854$12865;(bridge$12854$12865=$12853$12860);if(((bridge$12854$12865===null)||(bridge$12854$12865===(void 0)))){return false;}else{var x$12873;if((typeof($12853$12860)==="string")){(x$12873=$12853$12860);return (key$12851 in String.prototype);}else{var x$12878;if((typeof($12853$12860)==="number")){(x$12878=$12853$12860);return (key$12851 in Number.prototype);}else{var x$12883;(x$12883=$12853$12860);return (key$12851 in x$12883);}}}};var $11890$11891;var items$11892;var pr_terminus$11893;var pr$11894;var __lt____gt__$11895;var repr$11896;var escape_html$11897;var quotify$11898;var HTML$11899;($11890$11891=require("./util"));;(items$11892=$11890$11891.items);;(pr_terminus$11893=function(node$11909){var r$11912;var pre$11913;var post$11914;(r$11912=HTML$11899(node$11909,"span"));;(pre$11913=(String.fromCharCode(27)+"[?0;7y+h <div class=\"ug\">"));;(post$11914=("</div>"+String.fromCharCode(7)));;return console.log(((pre$11913+r$11912)+post$11914));});;(pr$11894=function($11927$11929,r$11930){var x$11951;var n$11946;var $11932$11938;var ph$11933;(ph$11933=$11927$11929);;($11932$11938=ph$11933);;if($11843($12492)($11932$11938)){(n$11946=$11932$11938);return pr_terminus$11893(n$11946);}else{(x$11951=$11932$11938);return pr_terminus$11893((r$11930||repr$11896)(x$11951));}});;(__lt____gt__$11895=function($11956$11958,x$11959){if(($11956$11958===null)){;}else{$12646($11956$11958);}return pr$11894(x$11959);});;(repr$11896=function(){var $index$12044;var $length$12039;var temp$12034;var acc$12029;var $index$12088;var $length$12083;var temp$12078;var acc$12073;var other$12115;var entries$12023;var $11971$11996;var t0$11994;var x$11984;var recur$11985;var $11970$11986;var t0$11978;var t1$11979;var t2$11980;var $11969$11973;($11969$11973=arguments);;(t0$11978=$11969$11973.length);if((((t0$11978>=1)&&(t0$11978<=2))&&((t1$11979=$11969$11973[0]),((x$11984=t1$11979),(($11970$11986=t1$11979),((t2$11980=function(){if((1>=t0$11978)){return repr$11896;}else{return $11969$11973[1];}}()),$11843(Function)(t2$11980))))))){(recur$11985=t2$11980);if(($11970$11986===true)){return $12492(["special","true"],"true");}else{if(($11970$11986===false)){return $12492(["special","false"],"false");}else{if(($11970$11986===null)){return $12492(["special","nil"],"null");}else{if(($11970$11986===(void 0))){return $12492(["special","nil"],"undefined");}else{if((typeof($11970$11986)==="number")){return $12492(["num"],String(x$11984));}else{if((typeof($11970$11986)==="string")){return $12492(["str"],x$11984);}else{(t0$11994=$11970$11986);if($11843(Array)(t0$11994)){(entries$12023=t0$11994);return $12492(["sequence"],(((acc$12029=[])),(((temp$12034=entries$12023)),((($length$12039=temp$12034.length)),((($index$12044=0)),function(){$12026:for(;($index$12044<$length$12039);($index$12044++)){var x$12060;var m$12052;(m$12052=temp$12034[$index$12044]);;(x$12060=m$12052);acc$12029.push(recur$11985(x$12060,repr$11896));}}()))),acc$12029));}else{$11970$11986;if(x$11984["::repr"]){return x$11984["::repr"](recur$11985);}else{if((Object.getPrototypeOf(x$11984)===Object.prototype)){return $12492(["+table","object"],(((acc$12073=[])),(((temp$12078=items$11892(x$11984))),((($length$12083=temp$12078.length)),((($index$12088=0)),function(){$12070:for(;($index$12088<$length$12083);($index$12088++)){var k$12106;var v$12107;var t0$12101;var t1$12102;var m$12096;(m$12096=temp$12078[$index$12088]);;(t0$12101=m$12096);if(((t0$12101 instanceof Array)&&((t1$12102=t0$12101.length),(t1$12102===2)))){(k$12106=t0$12101[0]);(v$12107=t0$12101[1]);acc$12073.push($12492(["+tr"],[$12492(["+th"],recur$11985(k$12106,repr$11896)),$12492(["+td"],recur$11985(v$12107,repr$11896))]));}else{$12646(m$12096,"/home/olivier/git/earl-grey/src/pp.eg",950,1074);;}}}()))),acc$12073));}else{(other$12115=$11970$11986);return $12492(["unknown"],other$12115.toString());}}}}}}}}}}else{$12646($11969$11973);}});;(escape_html$11897=function($12122$12124){var t0$12128;var repl$12133;var s$12126;(t0$12128=[true,String($12122$12124)]);if(t0$12128[0]){(s$12126=t0$12128[1]);;}else{$12646($12122$12124);}(repl$12133=({"&":"&amp;","<":"&lt;",">":"&gt;"}));;return s$12126.replace(RegExp("[&<>]","g"),function(x$12138){return $11858(repl$12133,x$12138);});});;(quotify$11898=function($12143$12145){var t0$12149;var s$12147;(t0$12149=[true,String($12143$12145)]);if(t0$12149[0]){(s$12147=t0$12149[1]);;}else{$12646($12143$12145);}return s$12147.replace(RegExp("[\"\\\\]","g"),function(x$12154){return ("\\"+x$12154);});});;(HTML$11899=function($12159$12161,default_tag$12162){var $index$12205;var $length$12200;var temp$12195;var acc$12190;var $index$12270;var $length$12265;var temp$12260;var $index$12347;var $length$12342;var temp$12337;var acc$12332;var $index$12402;var $length$12397;var temp$12392;var acc$12387;var $index$12448;var $length$12443;var temp$12438;var acc$12433;var other$12428;var $12372$12374;var x$12482;var other$12479;var $12231$12467;var tag$12232;var _classes$12233;var id$12234;var kv$12235;var sub$12236;var accum$12237;var other$12488;var classes$12225;var children$12226;var children$12183;var s$12178;var $12164$12170;var ph$12165;(ph$12165=$12159$12161);;($12164$12170=ph$12165);;if((typeof($12164$12170)==="string")){(s$12178=$12164$12170);return escape_html$11897(s$12178);}else{if($11843(Array)($12164$12170)){(children$12183=$12164$12170);return (((acc$12190=[])),(((temp$12195=children$12183)),((($length$12200=temp$12195.length)),((($index$12205=0)),function(){$12187:for(;($index$12205<$length$12200);($index$12205++)){var child$12221;var m$12213;(m$12213=temp$12195[$index$12205]);;(child$12221=m$12213);acc$12190.push(HTML$11899(child$12221,default_tag$12162));}}()))),acc$12190).join("");}else{if(($11843($12492)($12164$12170)&&($12847($12164$12170,"classes")&&((classes$12225=$12164$12170.classes),$12847($12164$12170,"children"))))){(children$12226=$12164$12170.children);(tag$12232=(default_tag$12162||"span"));;(_classes$12233=[]);;(id$12234=null);;(kv$12235=[]);;(sub$12236=[]);;(temp$12260=classes$12225);;($length$12265=temp$12260.length);;($index$12270=0);;$12238:for(;($index$12270<$length$12265);($index$12270++)){var s$12318;var m$12311;var m$12304;var k$12299;var k$12292;var v$12293;var $12240$12287;var $12241$12288;var $12242$12289;var t0$12283;var t1$12284;var t2$12285;var m$12278;(m$12278=temp$12260[$index$12270]);;(t0$12283=m$12278);if((($12241$12288=(t0$12283 instanceof Array))&&((t1$12284=t0$12283.length),((t1$12284===3)&&(t0$12283[0]==="assoc"))))){(k$12292=t0$12283[1]);(v$12293=t0$12283[2]);kv$12235.push([k$12292,v$12293]);}else{if(($12241$12288&&((t1$12284===2)&&(t0$12283[0]==="assoc")))){(k$12299=t0$12283[1]);kv$12235.push([k$12299,(void 0)]);}else{(t0$12283=$12614(RegExp("(?:^\\+((?:.*)))",""))(m$12278));if((t0$12283[0]&&((t1$12284=t0$12283[1]),((t2$12285=t1$12284.length),(t2$12285===2))))){t1$12284[0];(m$12304=t1$12284[1]);(tag$12232=m$12304);}else{(t0$12283=$12614(RegExp("(?:^#((?:.*)))",""))(m$12278));if((t0$12283[0]&&((t1$12284=t0$12283[1]),((t2$12285=t1$12284.length),(t2$12285===2))))){t1$12284[0];(m$12311=t1$12284[1]);(id$12234=m$12311);}else{(t0$12283=m$12278);if((typeof(t0$12283)==="string")){(s$12318=t0$12283);_classes$12233.push(s$12318);}else{$12646(m$12278,"/home/olivier/git/earl-grey/src/pp.eg",1851,2172);;}}}}}}(accum$12237=function(){if((tag$12232==="raw")){return [];}else{return ["<",tag$12232];}}());;if(id$12234){(accum$12237=accum$12237.concat(" id=\"",id$12234,"\""));}if(_classes$12233.length){(accum$12237=accum$12237.concat(" class=\"",quotify$11898(_classes$12233.join(" ")),"\""));}if(kv$12235){(acc$12332=[]);;(temp$12337=kv$12235);;($length$12342=temp$12337.length);;($index$12347=0);;$12329:for(;($index$12347<$length$12342);($index$12347++)){var k$12365;var v$12366;var t0$12360;var t1$12361;var m$12355;(m$12355=temp$12337[$index$12347]);;(t0$12360=m$12355);if(((t0$12360 instanceof Array)&&((t1$12361=t0$12360.length),(t1$12361===2)))){(k$12365=t0$12360[0]);(v$12366=t0$12360[1]);acc$12332.push((accum$12237=accum$12237.concat(function(){if((v$12366!==null)){return [" ",k$12365,"=\"",quotify$11898(v$12366),"\""];}else{return [" ",k$12365];}}())));}else{$12646(m$12355,"/home/olivier/git/earl-grey/src/pp.eg",2426,2623);;}}acc$12332;}(children$12226=((($12372$12374=tag$12232)),function(){if(($12372$12374==="raw")){(acc$12387=[]);;(temp$12392=children$12226);;($length$12397=temp$12392.length);;($index$12402=0);;$12384:for(;($index$12402<$length$12397);($index$12402++)){var c$12424;var s$12419;var t0$12415;var m$12410;(m$12410=temp$12392[$index$12402]);;(t0$12415=m$12410);if((typeof(t0$12415)==="string")){(s$12419=t0$12415);acc$12387.push(s$12419);}else{(c$12424=m$12410);acc$12387.push(HTML$11899(c$12424,default_tag$12162));}}return acc$12387;}else{(other$12428=$12372$12374);(acc$12433=[]);;(temp$12438=children$12226);;($length$12443=temp$12438.length);;($index$12448=0);;$12430:for(;($index$12448<$length$12443);($index$12448++)){var c$12464;var m$12456;(m$12456=temp$12438[$index$12448]);;(c$12464=m$12456);acc$12433.push(HTML$11899(c$12464,default_tag$12162));}return acc$12433;}}()));($12231$12467=tag$12232);;if(($12231$12467==="raw")){return accum$12237.concat(children$12226).join("");}else{(other$12479=$12231$12467);(x$12482=[">"].concat(children$12226).concat(["</",tag$12232,">"]));;return accum$12237.concat(x$12482).join("");}}else{(other$12488=$12164$12170);return HTML$11899([true,String(other$12488)][1],default_tag$12162);}}}});;(exports["pr_terminus"]=pr_terminus$11893);(exports["pr"]=pr$11894);(exports["<>"]=__lt____gt__$11895);(exports["repr"]=repr$11896);

},{"./util":14}],12:[function(require,module,exports){
var $14105=function(type$14107){var f$14110;(f$14110=type$14107["::check"]);;if((f$14110===(void 0))){return function(value$14115){return (value$14115 instanceof type$14107);};}else{return function(value$14118){return f$14110.call(type$14107,value$14118);};}};
var $14120=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $14121=function($14122$14124){var ph$14128;(ph$14128=$14122$14124);;var $14126$14133;($14126$14133=ph$14128);;var bridge$14127$14138;var x$14142;(bridge$14127$14138=$14126$14133);if((((typeof(bridge$14127$14138)==="string")&&((x$14142=bridge$14127$14138),true))||((typeof(bridge$14127$14138)==="number")&&((x$14142=bridge$14127$14138),true)))){return ["value",x$14142];}else{var other$14149;(other$14149=$14126$14133);return other$14149["::serialize_ast"]();}};
var send$13945;(send$13945=function(obj$13950,$13948$13951){var ph$13955;var msg$13956;var t0$13958;(t0$13958=$13948$13951);(msg$13956=t0$13958);(ph$13955=t0$13958);;var $13953$13962;($13953$13962=ph$13955);;var bridge$13954$13967;(bridge$13954$13967=$13953$13962);if(((typeof(bridge$13954$13967)==="string")||(typeof(bridge$13954$13967)==="number"))){return obj$13950[msg$13956];}else{var other$13975;(other$13975=$13953$13962);return obj$13950["::send"](msg$13956);}});;(Array[":::project"]=function($13978$13980){var ph$13983;var value$13984;var t0$13986;(t0$13986=$13978$13980);(value$13984=t0$13986);(ph$13983=t0$13986);;var $13982$13990;($13982$13990=ph$13983);;if($14105(Array)($13982$13990)){return [true,value$13984];}else{$13982$13990;return [true,[value$13984]];}});(Array.prototype["::check"]=function(value$14004){if((value$14004 instanceof Array)){var i$14009;(i$14009=0);;$14007:for(;(i$14009<this.length);(i$14009++)){if(($14120(this,i$14009)!==$14120(value$14004,i$14009))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$14020){if((value$14020 instanceof Array)){var i$14025;(i$14025=0);;$14023:for(;(i$14025<this.length);(i$14025++)){if(($14120(this,i$14025)!==$14120(value$14020,i$14025))){return [true,[value$14020]];}}return [true,value$14020.slice(this.length)];}else{return [true,[value$14020]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($14121));});(RegExp.prototype["::check"]=function($14035$14037){var ph$14040;(ph$14040=$14035$14037);;var $14039$14045;($14039$14045=ph$14040);;var value$14053;if((typeof($14039$14045)==="string")){(value$14053=$14039$14045);if(value$14053.match(this)){return true;}else{return false;}}else{var other$14058;(other$14058=$14039$14045);return false;}});(RegExp.prototype[":::project"]=function($14060$14062){var ph$14065;(ph$14065=$14060$14062);;var $14064$14070;($14064$14070=ph$14065);;var value$14078;if((typeof($14064$14070)==="string")){(value$14078=$14064$14070);var $14081$14083;($14081$14083=value$14078.match(this));;var m$14091;if(($14081$14083===null)){(m$14091=$14081$14083);return [false,null];}else{var m$14096;(m$14096=$14081$14083);return [true,m$14096];}}else{var other$14100;(other$14100=$14064$14070);return [false,null];}});(Function.prototype["::send"]=function(args$14103){return this.apply(this,args$14103);});
var $20252=function(dest$20254,values$20255){var k$20260;(k$20260=null);$20258:for(k$20260 in values$20255){if(values$20255.hasOwnProperty(k$20260)){(dest$20254[k$20260]=values$20255[k$20260]);}}return dest$20254;};
var $20264=function($20265$20267,key$20268){var ph$20272;(ph$20272=$20265$20267);;var $20270$20277;($20270$20277=ph$20272);;var bridge$20271$20282;(bridge$20271$20282=$20270$20277);if(((bridge$20271$20282===null)||(bridge$20271$20282===(void 0)))){return false;}else{var x$20290;if((typeof($20270$20277)==="string")){(x$20290=$20270$20277);return (key$20268 in String.prototype);}else{var x$20295;if((typeof($20270$20277)==="number")){(x$20295=$20270$20277);return (key$20268 in Number.prototype);}else{var x$20300;(x$20300=$20270$20277);return (key$20268 in x$20300);}}}};
var $20456=function(arr$20458){var results$20462;var l$20463;(results$20462=[]);;(l$20463=arr$20458.length);;var i$20471;(i$20471=0);;$20461:for(;(i$20471<l$20463);(i$20471++)){results$20462.push([i$20471,$14120(arr$20458,i$20471)]);}return results$20462;};
var $20478=function(value$20480,url$20481,start$20482,end$20483){var err$20486;(err$20486=$20302(["match"]).create("Could not find a match for value",({"value":value$20480})));;if(url$20481){(err$20486["location"]=["location",url$20481,start$20482,end$20483]);}throw err$20486;};
var $20302=function(){var $20303$20305;($20303$20305=function(tags$20309){var it$0$20312;(it$0$20312=function(){if((!$14105($20303$20305)(this))){return Object.create($20303$20305.prototype);}else{return this;}}());;(it$0$20312["tags"]=tags$20309);return it$0$20312;});;($20303$20305.prototype["create"]=function(){var $20321$20323;($20321$20323=arguments);;var t0$20328;var message$20332;var args$20333;(t0$20328=$20321$20323.length);if((t0$20328>=0)){(message$20332=function(){if((0>=t0$20328)){return "";}else{return $20321$20323[0];}}());(args$20333=Array.prototype.slice.call($20321$20323,1));var it$0$20337;(it$0$20337=this);;var e$20342;(e$20342=Error(message$20332));;(e$20342["::tags"]=it$0$20337.tags);(e$20342["args"]=args$20333);var temp$20350;(temp$20350=$20456(args$20333));;var $length$20355;($length$20355=temp$20350.length);;var $index$20360;($index$20360=0);;$20343:for(;($index$20360<$length$20355);($index$20360++)){var m$20368;(m$20368=temp$20350[$index$20360]);;var t0$20373;var t1$20374;var i$20378;var arg$20379;(t0$20373=m$20368);if(((t0$20373 instanceof Array)&&((t1$20374=t0$20373.length),(t1$20374===2)))){(i$20378=t0$20373[0]);(arg$20379=t0$20373[1]);(e$20342[i$20378]=arg$20379);}else{$20478(m$20368);;}}(e$20342["length"]=args$20333.length);(e$20342["name"]=["E"].concat(it$0$20337.tags).join("."));return e$20342;}else{$20478($20321$20323);}});($20303$20305.prototype["::check"]=function(e$20390){var it$0$20393;(it$0$20393=this);;var tags$20398;if(((!e$20390)||(!$14105(Error)(e$20390)))){return false;}(tags$20398=(e$20390["::tags"]||[]));;var temp$20407;(temp$20407=it$0$20393.tags);;var $length$20412;($length$20412=temp$20407.length);;var $index$20417;($index$20417=0);;$20399:for(;($index$20417<$length$20412);($index$20417++)){var m$20425;(m$20425=temp$20407[$index$20417]);;var tag$20433;(tag$20433=m$20425);if((tags$20398.indexOf(tag$20433)===-1)){return false;}else{false;;}}return true;});($20303$20305.prototype["::deconstruct"]=function(e$20441){var it$0$20444;(it$0$20444=this);;return e$20441.args;});$20252($20303$20305,$20252(function(){var accum$20449;(accum$20449=({}));(accum$20449["::name"]="$20303");return accum$20449;}(),function(){var accum$20453;(accum$20453=({}));(accum$20453["::egclass"]=true);return accum$20453;}()));return $20303$20305;}();
var $20507=function($20508$20510){var ph$20516;var x$20517;var t0$20519;(t0$20519=$20508$20510);(x$20517=t0$20519);(ph$20516=t0$20519);;var $20512$20523;($20512$20523=ph$20516);;var bridge$20513$20528;(bridge$20513$20528=$20512$20523);if((function(){var bridge$20514$20534;(bridge$20514$20534=bridge$20513$20528);return (function(){var bridge$20515$20537;(bridge$20515$20537=bridge$20514$20534);return ((bridge$20515$20537===(void 0))||(bridge$20515$20537===null));}()||(typeof(bridge$20514$20534)==="string"));}()||(typeof(bridge$20513$20528)==="number"))){return x$20517;}else{if($20264($20512$20523,"::clone")){$20512$20523["::clone"];return x$20517["::clone"]();}else{$20512$20523;if((Object.getPrototypeOf(x$20517)===Object.prototype)){var dest$20550;(dest$20550=({}));;var k$20555;(k$20555=null);$20549:for(k$20555 in x$20517){if(Object.prototype.hasOwnProperty.call(x$20517,k$20555)){(dest$20550[k$20555]=x$20517[k$20555]);}}return dest$20550;}else{var other$20561;(other$20561=$20512$20523);throw $20302(["clone"]).create("Object cannot be cloned",({"obj":x$20517}));}}}};
var $20491=function(a$20493,b$20494){var dest$20498;(dest$20498=$20507(a$20493));;var k$20503;(k$20503=null);$20497:for(k$20503 in b$20494){if(Object.prototype.hasOwnProperty.call(b$20494,k$20503)){(dest$20498[k$20503]=b$20494[k$20503]);}}return dest$20498;};
var $20563=function(type$20565){return function(value$20568){var f$20571;(f$20571=type$20565[":::project"]);;if((f$20571===(void 0))){var f$20576;(f$20576=type$20565["::project"]);;if((f$20576===(void 0))){return [true,type$20565(value$20568)];}else{var rval$20581;(rval$20581=false);;try{(rval$20581=[true,f$20576(value$20568)]);}catch(excv$20587){var e$20593;(e$20593=excv$20587);(rval$20581=[false,null]);}return rval$20581;}}else{return f$20571.call(type$20565,value$20568);}};};
var $20595=function(obj$20597){var results$20601;(results$20601=[]);;var k$20606;(k$20606=null);$20600:for(k$20606 in obj$20597){if(Object.prototype.hasOwnProperty.call(obj$20597,k$20606)){results$20601.push([k$20606,$14120(obj$20597,k$20606)]);}}return results$20601;};var accum$14302;var accum$14306;var $index$14343;var $length$14338;var temp$14333;var accum$14927;var accum$14935;var accum$14978;var accum$14989;var accum$14996;var accum$15020;var accum$15027;var accum$15038;var accum$15284;var accum$15338;var accum$15402;var accum$15464;var accum$15484;var accum$15556;var accum$15640;var accum$15668;var accum$15718;var accum$15765;var accum$15812;var accum$15850;var accum$15956;var accum$16063;var accum$16192;var accum$16212;var accum$16616;var accum$16752;var accum$16843;var t0$16915;var accum$16913;var t0$17061;var accum$17059;var t0$17115;var accum$17113;var t0$17257;var accum$17255;var t0$17497;var accum$17495;var accum$17657;var t0$17794;var accum$17792;var t0$17920;var accum$17918;var accum$17966;var t0$17988;var accum$17986;var t0$18004;var accum$18002;var t0$18020;var accum$18018;var t0$18036;var accum$18034;var accum$18050;var accum$18175;var accum$18290;var accum$18428;var accum$18623;var accum$18722;var accum$19067;var accum$19266;var $index$19341;var $length$19336;var temp$15280;var accum$20098;var accum$20102;var mac$20112;var $index$20223;var $length$20218;var temp$20213;var $14152$14157;var __lt____gt__$14158;var $14153$14159;var __lt____lt____colon__$14160;var util$14161;var neighbours$14162;var zip$14163;var uuid$14164;var $14155$14165;var PatternParser$14166;var PatternProcessor$14167;var parse_pattern$14168;var parse_clauses$14169;var mt$14170;var Expander$14171;var Scope$14172;var Env$14173;var nullenv$14174;var mac1$14175;var checker_db$14176;var generic_nodes$14177;var Embedded$14178;var stdenv$14179;var mkstdenv$14180;var expander$14181;var expand$14182;var topscope$14183;var embed_location$14184;var error_embed_location$14185;var match_error$14186;var drop_ctx$14187;var expr_mac$14188;var overridable$14189;var protected_value$14190;var setup_label$14191;var break_mac$14192;var continue_mac$14193;var var_operator$14194;var accum_flags$14195;var pattern_constructors$14196;var disregard_specials$14197;var pattern_handlers$14198;var build_loop$14199;var partial_pattern$14200;var make_assigner$14201;var blocktest_wrap$14202;var blocktest_mac$14203;var qqstruct$14204;var qq$14205;var RegexBuilder$14206;var build_regexp$14207;var errf_macro$14208;var stdprelude$14209;($14152$14157=require("./pp"));;(__lt____gt__$14158=$14152$14157["<>"]);;($14153$14159=require("./location"));;(__lt____lt____colon__$14160=$14153$14159["<<:"]);;(util$14161=require("./util"));;(neighbours$14162=util$14161.neighbours);;(zip$14163=util$14161.zip);;(uuid$14164=util$14161.uuid);;($14155$14165=require("./pattern"));;(PatternParser$14166=$14155$14165.PatternParser);;(PatternProcessor$14167=$14155$14165.PatternProcessor);;(parse_pattern$14168=$14155$14165.parse_pattern);;(parse_clauses$14169=$14155$14165.parse_clauses);;(mt$14170=require("./expand"));;(Expander$14171=mt$14170.Expander);;(Scope$14172=mt$14170.Scope);;(Env$14173=mt$14170.Env);;(nullenv$14174=mt$14170.nullenv);;(mac1$14175=mt$14170["mac1"]);;(checker_db$14176=mt$14170.checker_db);;(generic_nodes$14177=["if","js_while","js_for","js_for_in","js_label","js_break","js_continue","js_return","js_delete","js_throw","js_try","js_new"]);;(Embedded$14178=function(code$14282){var it$0$14285;(it$0$14285=function(){if((!$14105(Embedded$14178)(this))){return Object.create(Embedded$14178.prototype);}else{return this;}}());;(it$0$14285["code"]=mkstdenv$14180().convert(code$14282));(it$0$14285["::id"]=uuid$14164());return it$0$14285;});;(Embedded$14178.prototype["::serialize_ast"]=function(){var it$0$14297;(it$0$14297=this);;return expand$14182(["top"],topscope$14183,it$0$14297.code);});$20252(Embedded$14178,$20252(((accum$14302=({})),((accum$14302["::name"]="Embedded"),accum$14302)),((accum$14306=({})),((accum$14306["::egclass"]=true),accum$14306))));Embedded$14178;(stdenv$14179=Env$14173());;(mkstdenv$14180=function(){var e$14317;(e$14317=Env$14173());;(e$14317.scopes["top"]=stdenv$14179.scopes.top);return e$14317;});;(expander$14181=Expander$14171(mkstdenv$14180,generic_nodes$14177));;(expand$14182=expander$14181.expand.bind(expander$14181));;(topscope$14183=Scope$14172(null,"top",expander$14181));;(temp$14333=["+","-","*","/","mod","&.","|.","^.","and","or","not","===","!==","<",">","<=",">=","<<",">>",">>>","in","instanceof","--","++","true","false","null","undefined","typeof","String","Array","Number","Object","RegExp","Function","parseInt","parseFloat","Math","Error","TypeError","ReferenceError","console","process","eval","setTimeout","clearTimeout","___js_fetch","___node","arguments","this","exports"]);;($length$14338=temp$14333.length);;($index$14343=0);;$14210:for(;($index$14343<$length$14338);($index$14343++)){var k$14359;var m$14351;(m$14351=temp$14333[$index$14343]);;(k$14359=m$14351);stdenv$14179.bind(topscope$14183,k$14359,["variable",k$14359]);}(embed_location$14184=function($14363$14365){var other$14394;var url$14383;var start$14384;var end$14385;var t0$14378;var t1$14379;var $14367$14373;var ph$14368;(ph$14368=$14363$14365);;($14367$14373=ph$14368);;if(($20264($14367$14373,"location")&&((t0$14378=$14367$14373.location),($20264(t0$14378,"source")&&((t1$14379=t0$14378.source),($20264(t1$14379,"url")&&((url$14383=t1$14379.url),($20264(t0$14378,"start")&&((start$14384=t0$14378.start),$20264(t0$14378,"end")))))))))){(end$14385=t0$14378.end);return ["send",["send",["symbol","#"],["data",["void"],["symbol","location"]]],["data",["value",url$14383],["value",start$14384],["value",end$14385]]];}else{(other$14394=$14367$14373);return ["send",["send",["symbol","#"],["data",["void"],["symbol","location"]]],["data",["symbol","null"],["value",0],["value",0]]];}});;(error_embed_location$14185=function(error$14400,target$14401){return ["send",["symbol","throw"],["send",["symbol","&:"],["data",error$14400,["data",["send",["symbol","="],["data",["symbol","location"],embed_location$14184(target$14401)]]]]]];});;(match_error$14186=function($14406$14408){var t0$14414;var other$14439;var url$14428;var start$14429;var end$14430;var t0$14423;var t1$14424;var $14410$14418;var ph$14411;var target$14412;(t0$14414=$14406$14408);(target$14412=t0$14414);(ph$14411=t0$14414);;($14410$14418=ph$14411);;if(($20264($14410$14418,"location")&&((t0$14423=$14410$14418.location),($20264(t0$14423,"source")&&((t1$14424=t0$14423.source),($20264(t1$14424,"url")&&((url$14428=t1$14424.url),($20264(t0$14423,"start")&&((start$14429=t0$14423.start),$20264(t0$14423,"end")))))))))){(end$14430=t0$14423.end);return ["send",["symbol","___match_error"],["data",target$14412,["value",url$14428],["value",start$14429],["value",end$14430]]];}else{(other$14439=$14410$14418);return ["send",["symbol","___match_error"],["data",other$14439]];}});;(drop_ctx$14187=function(f$14445){return function(context$14448,scope$14449,form$14450,arg$14451){var rval$14454;(rval$14454=false);;try{(rval$14454=f$14445(context$14448,scope$14449,form$14450,arg$14451));}catch(excv$14460){var t0$14477;var e$14482;var t0$14463;var t1$14464;var t2$14465;var t3$14466;var t4$14467;(t0$14463=excv$14460);if(($14105($20302(["match"]))(t0$14463)&&($20264(t0$14463,"args")&&((t1$14464=t0$14463.args),((t1$14464 instanceof Array)&&((t2$14465=t1$14464.length),((t2$14465===1)&&((t3$14466=t1$14464[0]),($20264(t3$14466,"value")&&((t4$14467=t3$14466.value),((t4$14467===context$14448)&&(!((t4$14467 instanceof Array)&&((t0$14477=t4$14467.length),((t0$14477===2)&&((t4$14467[0]==="expr")&&(t4$14467[1]==="expr"))))))))))))))))){(rval$14454=["nostep",form$14450]);}else{(e$14482=excv$14460);(rval$14454=function(){throw e$14482;}());}}return rval$14454;};});;(expr_mac$14188=function(f$14488){return function($14490$14492,scope$14493,form$14494,arg$14495){var t0$14515;var t0$14518;var otherwise$14523;var bridge$14498$14509;var $14497$14504;var ph$14499;(ph$14499=$14490$14492);;($14497$14504=ph$14499);;(bridge$14498$14509=$14497$14504);if((((bridge$14498$14509 instanceof Array)&&((t0$14515=bridge$14498$14509.length),((t0$14515===2)&&((bridge$14498$14509[0]==="expr")&&(bridge$14498$14509[1]==="expr")))))||((bridge$14498$14509 instanceof Array)&&((t0$14518=bridge$14498$14509.length),((t0$14518===2)&&((bridge$14498$14509[0]==="expr")&&(bridge$14498$14509[1]==="head"))))))){return f$14488(scope$14493,form$14494,arg$14495);}else{(otherwise$14523=$14497$14504);return ["nostep",form$14494];}};});;(overridable$14189=function(f$14529){return function($14531$14533,scope$14534,form$14535,arg$14536){var t0$14542;var x$14557;var other$14569;var t0$14551;var $14538$14546;var ph$14539;var context$14540;(t0$14542=$14531$14533);(context$14540=t0$14542);(ph$14539=t0$14542);;($14538$14546=ph$14539);;if((((x$14557=$14538$14546)),((x$14557 instanceof Array)&&(x$14557[0]==="pattern")))){return ["nostep",form$14535];}else{if((($14538$14546 instanceof Array)&&((t0$14551=$14538$14546.length),((t0$14551===2)&&(($14538$14546[0]==="expr")&&($14538$14546[1]==="multi")))))){return ["nostep",form$14535];}else{(other$14569=$14538$14546);return f$14529(context$14540,scope$14534,form$14535,arg$14536);}}};});;(protected_value$14190=function(name$14575,value$14576){return function($14578$14580,scope$14581,form$14582,arg$14583){var x$14601;var other$14626;var t0$14617;var $14610$14612;var other$14608;var $14585$14591;var ph$14586;(ph$14586=$14578$14580);;($14585$14591=ph$14586);;if((((x$14601=$14585$14591)),((x$14601 instanceof Array)&&(x$14601[0]==="pattern")))){throw $20302(["syntax","pattern"]).create((("'"+name$14575)+"' is not a valid pattern and cannot be redeclared"));}else{(other$14608=$14585$14591);($14610$14612=arg$14583);;if((($14610$14612 instanceof Array)&&((t0$14617=$14610$14612.length),((t0$14617===1)&&($14610$14612[0]==="void"))))){return ["value",value$14576];}else{(other$14626=$14610$14612);return ["send",["value",value$14576],arg$14583];}}};});;(setup_label$14191=function(label$14632,env$14633,body$14634){return ["bind",$20491(["symbol","break"],({"env":env$14633})),["macro",break_mac$14192(label$14632)],["bind",$20491(["symbol","continue"],({"env":env$14633})),["macro",continue_mac$14193(label$14632)],["js_label",["value",label$14632],body$14634]]];});;(break_mac$14192=function(default_label$14640){return overridable$14189(function(context$14644,scope$14645,form$14646,$14642$14647){var t0$14657;var v$14688;var v$14683;var $14650$14668;var $14651$14669;var $14652$14670;var $14653$14671;var t0$14666;var $14649$14661;var ph$14654;var expr$14655;(t0$14657=$14642$14647);(expr$14655=t0$14657);(ph$14654=t0$14657);;($14649$14661=ph$14654);;if((($14650$14668=($14649$14661 instanceof Array))&&((t0$14666=$14649$14661.length),(($14652$14670=(t0$14666===1))&&(($14653$14671=($14649$14661[0]==="void"))&&default_label$14640))))){return ["js_break",["value",default_label$14640]];}else{if($14653$14671){return ["js_break"];}else{if(($14650$14668&&(($14652$14670=(t0$14666===2))&&($14649$14661[0]==="value")))){(v$14683=$14649$14661[1]);return ["js_break",expr$14655];}else{if(($14652$14670&&($14649$14661[0]==="symbol"))){(v$14688=$14649$14661[1]);return ["js_break",["value",v$14688]];}else{$20478($14649$14661);}}}}});});;(continue_mac$14193=function(default_label$14697){return overridable$14189(function(context$14701,scope$14702,form$14703,$14699$14704){var t0$14714;var v$14745;var v$14740;var $14707$14725;var $14708$14726;var $14709$14727;var $14710$14728;var t0$14723;var $14706$14718;var ph$14711;var expr$14712;(t0$14714=$14699$14704);(expr$14712=t0$14714);(ph$14711=t0$14714);;($14706$14718=ph$14711);;if((($14707$14725=($14706$14718 instanceof Array))&&((t0$14723=$14706$14718.length),(($14709$14727=(t0$14723===1))&&(($14710$14728=($14706$14718[0]==="void"))&&default_label$14697))))){return ["js_continue",["value",default_label$14697]];}else{if($14710$14728){return ["js_continue"];}else{if(($14707$14725&&(($14709$14727=(t0$14723===2))&&($14706$14718[0]==="value")))){(v$14740=$14706$14718[1]);return ["js_continue",expr$14712];}else{if(($14709$14727&&($14706$14718[0]==="symbol"))){(v$14745=$14706$14718[1]);return ["js_continue",["value",v$14745]];}else{$20478($14706$14718);}}}}});});;(var_operator$14194=function(name$14754){return function(context$14757,scope$14758,form$14759,expr$14760){var t0$14770;var x$14797;var other$14814;var s$14808;var t0$14803;var t1$14804;var $14764$14794;var $14765$14785;var $14766$14786;var t0$14783;var $14763$14778;var env$14767;var sym$14768;(t0$14770=form$14759);if($20264(t0$14770,"env")){(env$14767=t0$14770.env);;}else{$20478(form$14759,"/home/olivier/git/earl-grey/src/stdenv.eg",3498,3502);}(sym$14768=$20491(["symbol",name$14754],({"env":env$14767})));;($14763$14778=expr$14760);;if((($14765$14785=($14763$14778 instanceof Array))&&((t0$14783=$14763$14778.length),((t0$14783===1)&&($14763$14778[0]==="void"))))){return sym$14768;}else{if(($14765$14785&&((t0$14783===3)&&(($14763$14778[0]==="data")&&(((x$14797=$14763$14778[1])),((x$14797 instanceof Array)&&(x$14797[0]==="void"))))))){($14764$14794=$14763$14778[2]);(t0$14803=$14764$14794);if(((t0$14803 instanceof Array)&&((t1$14804=t0$14803.length),((t1$14804===2)&&(t0$14803[0]==="symbol"))))){(s$14808=t0$14803[1]);return ["send",sym$14768,["value",s$14808]];}else{(other$14814=$14764$14794);return ["send",sym$14768,other$14814];}}else{$20478($14763$14778);}}};});;(accum_flags$14195=function(){var make$14838;var mac$14833;var also_values$14834;var t0$14829;var $14822$14824;($14822$14824=arguments);;(t0$14829=$14822$14824.length);if(((t0$14829>=1)&&(t0$14829<=2))){(mac$14833=$14822$14824[0]);(also_values$14834=function(){if((1>=t0$14829)){return true;}else{return $14822$14824[1];}}());(make$14838=function(flags$14842){return function(context$14846,scope$14847,form$14848,$14844$14849){var other$14898;var flag$14885;var flag$14878;var $14852$14874;var $14853$14875;var t0$14864;var t1$14865;var t2$14866;var t3$14867;var t4$14868;var t5$14869;var t6$14870;var t7$14871;var t8$14872;var $14851$14859;var ph$14854;(ph$14854=$14844$14849);;($14851$14859=ph$14854);;if((($14852$14874=($14851$14859 instanceof Array))&&((t0$14864=$14851$14859.length),((t0$14864===2)&&(($14851$14859[0]==="value")&&((flag$14878=$14851$14859[1]),also_values$14834)))))){return ["macro",make$14838(flags$14842.concat([flag$14878]))];}else{if(($14852$14874&&((t0$14864===3)&&(($14851$14859[0]==="send")&&((t1$14865=$14851$14859[1]),((t1$14865 instanceof Array)&&((t2$14866=t1$14865.length),((t2$14866===2)&&((t1$14865[0]==="symbol")&&((t1$14865[1]===".")&&((t3$14867=$14851$14859[2]),((t3$14867 instanceof Array)&&((t4$14868=t3$14867.length),((t4$14868===3)&&((t3$14867[0]==="data")&&((t5$14869=t3$14867[1]),((t5$14869 instanceof Array)&&((t6$14870=t5$14869.length),((t6$14870===1)&&((t5$14869[0]==="void")&&((t7$14871=t3$14867[2]),((t7$14871 instanceof Array)&&((t8$14872=t7$14871.length),((t8$14872===2)&&(t7$14871[0]==="symbol"))))))))))))))))))))))))){(flag$14885=t7$14871[1]);return ["macro",make$14838(flags$14842.concat([flag$14885]))];}else{(other$14898=$14851$14859);return mac$14833(context$14846,scope$14847,form$14848,other$14898,flags$14842);}}};});;return make$14838([]);}else{$20478($14822$14824);}});;(pattern_constructors$14196=({}));;(disregard_specials$14197=function($14909$14911,value$14912){var t0$14917;var t1$14918;var kind$14914;var expr$14915;(t0$14917=$14909$14911);if(((t0$14917 instanceof Array)&&((t1$14918=t0$14917.length),((t1$14918===2)&&(t0$14917[0]==="special"))))){(kind$14914=t0$14917[1]);(expr$14915=t0$14917);;}else{$20478($14909$14911);}throw $20302(["syntax","pattern","special"]).create("Special token cannot be used here",({"special":expr$14915}));});;(pattern_handlers$14198=({"declare_variables":$20252(({"allow_nested":true,"allow_arguments":true,"special":disregard_specials$14197}),$20252(((accum$14927=({})),((accum$14927["assign"]=function(v$14931,value$14932){return ["do",__lt____lt____colon__$14160(["assign",v$14931,value$14932],v$14931)];}),accum$14927)),$20252(({"finalize":true}),$20252(((accum$14935=({})),((accum$14935["declare"]=function(vars$14939){var $index$14959;var $length$14954;var temp$14949;var acc$14944;(acc$14944=[]);;(temp$14949=vars$14939);;($length$14954=temp$14949.length);;($index$14959=0);;$14941:for(;($index$14959<$length$14954);($index$14959++)){var v$14975;var m$14967;(m$14967=temp$14949[$index$14959]);;(v$14975=m$14967);acc$14944.push(["declare",v$14975]);}return acc$14944;}),accum$14935)),$20252(((accum$14978=({})),((accum$14978["success"]=function($14981$14983){$14981$14983;;return ["multi"];}),accum$14978)),((accum$14989=({})),((accum$14989["failure"]=function(target$14993){return match_error$14186(target$14993);}),accum$14989))))))),"build_object":$20252(({"strings_as_variables":true,"allow_nested":true,"allow_arguments":true,"special":disregard_specials$14197}),$20252(((accum$14996=({})),((accum$14996["assign"]=function($14999$15002,value$15003){var t0$15010;var t0$15014;var bridge$15000$15007;var v$15005;(bridge$15000$15007=$14999$15002);if((((bridge$15000$15007 instanceof Array)&&((t0$15010=bridge$15000$15007.length),((t0$15010===2)&&((bridge$15000$15007[0]==="symbol")&&((v$15005=bridge$15000$15007[1]),true)))))||((bridge$15000$15007 instanceof Array)&&((t0$15014=bridge$15000$15007.length),((t0$15014===2)&&((bridge$15000$15007[0]==="value")&&((v$15005=bridge$15000$15007[1]),true))))))){;}else{$20478($14999$15002);}return ["do",__lt____lt____colon__$14160(["assign",["send",["symbol","accum"],["value",v$15005]],value$15003],v$15005)];}),accum$14996)),$20252(({"finalize":true}),$20252(((accum$15020=({})),((accum$15020["declare"]=function(vars$15024){return [["declare",["symbol","accum"],["data",["symbol","="]]]];}),accum$15020)),$20252(((accum$15027=({})),((accum$15027["success"]=function($15030$15032){$15030$15032;;return ["symbol","accum"];}),accum$15027)),((accum$15038=({})),((accum$15038["failure"]=function(target$15042){return match_error$14186(target$15042);}),accum$15038)))))))}));;(build_loop$14199=function(scope$15048,env$15049,form$15050,li$15051,clauses$15052,wrap$15053,pre$15054,post$15055,opt$15056){var t0$15076;var t0$15113;var accum$15156;var lbl$15059;var i$15060;var len$15061;var first_mac$15062;var last_mac$15063;var newscope$15064;var m$15065;(lbl$15059=function(){if(env$15049){return $20491(["value",scope$15048.gensym()],({"env":env$15049}));}else{return ["value",scope$15048.gensym()];}}());;(i$15060=$20491(["symbol","$index"],({"env":env$15049})));;(len$15061=$20491(["symbol","$length"],({"env":env$15049})));;(t0$15076=$20563(drop_ctx$14187)(function($15078$15080,scope$15081,form$15082,subp$15083){var x$15088;if((((x$15088=$15078$15080)),((x$15088 instanceof Array)&&(x$15088[0]==="pattern")))){;}else{$20478($15078$15080);}return ["test",["send",["symbol","==="],["data",i$15060,["value",0]]],subp$15083];}));if(t0$15076[0]){(first_mac$15062=t0$15076[1]);;}else{$20478(function($15096$15098,scope$15099,form$15100,subp$15101){var x$15106;if((((x$15106=$15096$15098)),((x$15106 instanceof Array)&&(x$15106[0]==="pattern")))){;}else{$20478($15096$15098);}return ["test",["send",["symbol","==="],["data",i$15060,["value",0]]],subp$15101];});}(t0$15113=$20563(drop_ctx$14187)(function($15115$15117,scope$15118,form$15119,subp$15120){var x$15125;if((((x$15125=$15115$15117)),((x$15125 instanceof Array)&&(x$15125[0]==="pattern")))){;}else{$20478($15115$15117);}return ["test",["send",["symbol","==="],["data",i$15060,["send",["symbol","-"],["data",len$15061,["value",1]]]]],subp$15120];}));if(t0$15113[0]){(last_mac$15063=t0$15113[1]);;}else{$20478(function($15133$15135,scope$15136,form$15137,subp$15138){var x$15143;if((((x$15143=$15133$15135)),((x$15143 instanceof Array)&&(x$15143[0]==="pattern")))){;}else{$20478($15133$15135);}return ["test",["send",["symbol","==="],["data",i$15060,["send",["symbol","-"],["data",len$15061,["value",1]]]]],subp$15138];});}(newscope$15064=Scope$14172(scope$15048));;env$15049.bind(newscope$15064,"first",["macro",first_mac$15062]);env$15049.bind(newscope$15064,"last",["macro",last_mac$15063]);(m$15065=__lt____lt____colon__$14160(["symbol","m"],form$15050));;return ["multi",pre$15054,["send",["symbol","let"],["data",["multi",["send",["symbol","="],["data",["symbol","temp"],li$15051]],["send",["symbol","="],["data",len$15061,["send",["symbol","temp"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]]],["send",["send",["symbol","for"],lbl$15059],["data",["multi",["send",["symbol","="],["data",i$15060,["value",0]]],["send",["symbol","<"],["data",i$15060,len$15061]],["send",["symbol","++"],["data",i$15060,["void"]]]],["multi",["send",["symbol","="],["data",m$15065,["send",["symbol","___js_fetch"],["data",["symbol","temp"],i$15060]]]],parse_clauses$14169(newscope$15064,m$15065,clauses$15052,$20491(opt$15056,((accum$15156=({})),((accum$15156["wrap"]=function(x$15160){return wrap$15053(x$15160,i$15060);}),accum$15156))))]]]]],post$15055];});;(partial_pattern$14200=function(operator$15166){var x$15184;var $15172$15174;var op$15169;(op$15169=((($15172$15174=operator$15166)),function(){if((((x$15184=$15172$15174)),((x$15184 instanceof Array)&&(x$15184[0]==="symbol")))){return operator$15166;}else{if((typeof($15172$15174)==="string")){return ["variable",operator$15166];}else{$20478($15172$15174);}}}()));;return function(context$15197,scope$15198,form$15199,expr$15200){var x$15227;var m$15237;var other$15253;var val$15223;var $15203$15218;var $15204$15219;var $15205$15220;var t0$15212;var t1$15213;var t2$15214;var t3$15215;var t4$15216;var $15202$15207;($15202$15207=[context$15197,expr$15200]);;if((($15203$15218=($15202$15207 instanceof Array))&&((t0$15212=$15202$15207.length),(($15205$15220=(t0$15212===2))&&((((x$15227=$15202$15207[0])),((x$15227 instanceof Array)&&(x$15227[0]==="pattern")))&&((t1$15213=$15202$15207[1]),((t1$15213 instanceof Array)&&((t2$15214=t1$15213.length),((t2$15214===3)&&((t1$15213[0]==="data")&&((t3$15215=t1$15213[1]),((t3$15215 instanceof Array)&&((t4$15216=t3$15215.length),((t4$15216===1)&&(t3$15215[0]==="void"))))))))))))))){(val$15223=t1$15213[2]);(m$15237=mac1$14175(function(x$15241){return ["send",op$15169,["data",x$15241,val$15223]];}));;return ["check",m$15237,["ignore"]];}else{if(($15205$15220&&($15202$15207[0],((t1$15213=$15202$15207[1]),((t1$15213 instanceof Array)&&((t2$15214=t1$15213.length),((t2$15214===1)&&(t1$15213[0]==="void")))))))){return op$15169;}else{(other$15253=$15202$15207);return ["send",op$15169,expr$15200];}}};});;(make_assigner$14201=function(op$15259){return function(context$15263,scope$15264,form$15265,$15261$15266){var t0$15271;var t1$15272;var a$15268;var b$15269;(t0$15271=$15261$15266);if(((t0$15271 instanceof Array)&&((t1$15272=t0$15271.length),((t1$15272===3)&&(t0$15271[0]==="data"))))){(a$15268=t0$15271[1]);(b$15269=t0$15271[2]);;}else{$20478($15261$15266);}return ["assign",a$15268,["send",["symbol",op$15259],["data",a$15268,b$15269]]];};});;(temp$15280=$20595($20252(({"true":protected_value$14190("true",true),"false":protected_value$14190("false",false),"null":protected_value$14190("null",null),"undefined":protected_value$14190("undefined",(void 0)),"===":partial_pattern$14200("==="),"!==":partial_pattern$14200("!=="),"==":partial_pattern$14200(["symbol","___equal"]),"!=":partial_pattern$14200(["symbol","___nequal"]),"<=":partial_pattern$14200("<="),">=":partial_pattern$14200(">="),"<":partial_pattern$14200("<"),">":partial_pattern$14200(">")}),$20252(((accum$15284=({})),((accum$15284["-"]=function(context$15289,scope$15290,form$15291,$15287$15292){var t0$15300;var other$15335;var n$15320;var $15295$15316;var $15296$15317;var t0$15309;var t1$15310;var t2$15311;var t3$15312;var t4$15313;var t5$15314;var $15294$15304;var ph$15297;var expr$15298;(t0$15300=$15287$15292);(expr$15298=t0$15300);(ph$15297=t0$15300);;($15294$15304=ph$15297);;if((($15295$15316=($15294$15304 instanceof Array))&&((t0$15309=$15294$15304.length),((t0$15309===3)&&(($15294$15304[0]==="data")&&((t1$15310=$15294$15304[1]),((t1$15310 instanceof Array)&&((t2$15311=t1$15310.length),((t2$15311===1)&&((t1$15310[0]==="void")&&((t3$15312=$15294$15304[2]),((t3$15312 instanceof Array)&&((t4$15313=t3$15312.length),((t4$15313===2)&&((t3$15312[0]==="value")&&((t5$15314=t3$15312[1]),(typeof(t5$15314)==="number"))))))))))))))))){(n$15320=t5$15314);return ["value",(-n$15320)];}else{if(($15295$15316&&((t0$15309===1)&&($15294$15304[0]==="void")))){return ["variable","-"];}else{(other$15335=$15294$15304);return ["send",["variable","-"],expr$15298];}}}),accum$15284)),$20252(((accum$15338=({})),((accum$15338["++"]=function(context$15343,scope$15344,form$15345,$15341$15346){var other$15399;var x$15389;var y$15390;var x$15381;var x$15373;var $15349$15367;var $15350$15368;var $15351$15369;var $15352$15370;var t0$15363;var t1$15364;var t2$15365;var $15348$15358;var ph$15353;(ph$15353=$15341$15346);;($15348$15358=ph$15353);;if((($15349$15367=($15348$15358 instanceof Array))&&((t0$15363=$15348$15358.length),(($15351$15369=(t0$15363===3))&&(($15352$15370=($15348$15358[0]==="data"))&&((t1$15364=$15348$15358[1]),((t1$15364 instanceof Array)&&((t2$15365=t1$15364.length),((t2$15365===1)&&(t1$15364[0]==="void")))))))))){(x$15373=$15348$15358[2]);return ["send",["variable","++"],["data",["void"],x$15373]];}else{if(($15352$15370&&((x$15381=$15348$15358[1]),((t1$15364=$15348$15358[2]),((t1$15364 instanceof Array)&&((t2$15365=t1$15364.length),((t2$15365===1)&&(t1$15364[0]==="void")))))))){return ["send",["variable","++"],["data",x$15381,["void"]]];}else{if($15352$15370){(x$15389=$15348$15358[1]);(y$15390=$15348$15358[2]);return ["send",["send",x$15389,["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",y$15390]];}else{if(($15349$15367&&((t0$15363===1)&&($15348$15358[0]==="void")))){return ["send",["symbol","->"],["data",["data",["symbol","x"],["symbol","y"]],["send",["send",["symbol","x"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",["symbol","y"]]]]];}else{(other$15399=$15348$15358);return ["send",["symbol","___build_array"],["data",other$15399]];}}}}}),accum$15338)),$20252(((accum$15402=({})),((accum$15402[".."]=function(context$15407,scope$15408,form$15409,$15405$15410){var x$15453;var y$15454;var x$15445;var x$15437;var $15413$15431;var $15414$15432;var $15415$15433;var $15416$15434;var t0$15427;var t1$15428;var t2$15429;var $15412$15422;var ph$15417;(ph$15417=$15405$15410);;($15412$15422=ph$15417);;if((($15413$15431=($15412$15422 instanceof Array))&&((t0$15427=$15412$15422.length),(($15415$15433=(t0$15427===3))&&(($15416$15434=($15412$15422[0]==="data"))&&((t1$15428=$15412$15422[1]),((t1$15428 instanceof Array)&&((t2$15429=t1$15428.length),((t2$15429===1)&&(t1$15428[0]==="void")))))))))){(x$15437=$15412$15422[2]);return ["send",["symbol","range"],["data",["value",1],x$15437]];}else{if(($15416$15434&&((x$15445=$15412$15422[1]),((t1$15428=$15412$15422[2]),((t1$15428 instanceof Array)&&((t2$15429=t1$15428.length),((t2$15429===1)&&(t1$15428[0]==="void")))))))){return ["send",["symbol","range"],["data",x$15445]];}else{if($15416$15434){(x$15453=$15412$15422[1]);(y$15454=$15412$15422[2]);return ["send",["symbol","range"],["data",x$15453,y$15454]];}else{if(($15413$15431&&((t0$15427===1)&&($15412$15422[0]==="void")))){return ["symbol","range"];}else{$20478($15412$15422);}}}}}),accum$15402)),$20252(((accum$15464=({})),((accum$15464["//"]=function(context$15469,scope$15470,form$15471,$15467$15472){var t0$15477;var t1$15478;var a$15474;var b$15475;(t0$15477=$15467$15472);if(((t0$15477 instanceof Array)&&((t1$15478=t0$15477.length),((t1$15478===3)&&(t0$15477[0]==="data"))))){(a$15474=t0$15477[1]);(b$15475=t0$15477[2]);;}else{$20478($15467$15472);}return ["send",["send",["symbol","Math"],["send",["symbol","."],["data",["void"],["symbol","floor"]]]],["data",["send",["symbol","/"],["data",a$15474,b$15475]]]];}),accum$15464)),$20252(((accum$15484=({})),((accum$15484["*"]=function(context$15488,scope$15489,form$15490,expr$15491){var x$15519;var x$15532;var t0$15537;var other$15553;var val$15528;var $15495$15511;var $15496$15512;var $15497$15513;var t0$15504;var t1$15505;var t2$15506;var bridge$15494$15507;var t3$15508;var t4$15509;var $15493$15499;($15493$15499=[context$15488,expr$15491]);;if((($15495$15511=($15493$15499 instanceof Array))&&((t0$15504=$15493$15499.length),(($15497$15513=(t0$15504===2))&&((((x$15519=$15493$15499[0])),((x$15519 instanceof Array)&&(x$15519[0]==="pattern")))&&((t1$15505=$15493$15499[1]),((t1$15505 instanceof Array)&&((t2$15506=t1$15505.length),((t2$15506===1)&&(t1$15505[0]==="void")))))))))){return ["dynsplice",["ignore"]];}else{if(($15497$15513&&((bridge$15494$15507=$15493$15499[0]),(((((x$15532=bridge$15494$15507)),((x$15532 instanceof Array)&&(x$15532[0]==="pattern")))||((bridge$15494$15507 instanceof Array)&&((t0$15537=bridge$15494$15507.length),((t0$15537===2)&&((bridge$15494$15507[0]==="expr")&&(bridge$15494$15507[1]==="data"))))))&&((t1$15505=$15493$15499[1]),((t1$15505 instanceof Array)&&((t2$15506=t1$15505.length),((t2$15506===3)&&((t1$15505[0]==="data")&&((t3$15508=t1$15505[1]),((t3$15508 instanceof Array)&&((t4$15509=t3$15508.length),((t4$15509===1)&&(t3$15508[0]==="void")))))))))))))){(val$15528=t1$15505[2]);return ["dynsplice",val$15528];}else{if(($15497$15513&&($15493$15499[0],((t1$15505=$15493$15499[1]),((t1$15505 instanceof Array)&&((t2$15506=t1$15505.length),((t2$15506===1)&&(t1$15505[0]==="void")))))))){return ["variable","*"];}else{(other$15553=$15493$15499);return ["send",["variable","*"],expr$15491];}}}}),accum$15484)),$20252(((accum$15556=({})),((accum$15556["**"]=function(context$15560,scope$15561,form$15562,expr$15563){var x$15599;var x$15612;var t0$15617;var a$15633;var b$15634;var val$15608;var $15567$15587;var $15568$15588;var $15569$15589;var $15570$15590;var $15571$15591;var $15572$15592;var $15573$15593;var t0$15580;var t1$15581;var t2$15582;var bridge$15566$15583;var t3$15584;var t4$15585;var $15565$15575;($15565$15575=[context$15560,expr$15563]);;if((($15567$15587=($15565$15575 instanceof Array))&&((t0$15580=$15565$15575.length),(($15569$15589=(t0$15580===2))&&((((x$15599=$15565$15575[0])),((x$15599 instanceof Array)&&(x$15599[0]==="pattern")))&&((t1$15581=$15565$15575[1]),((t1$15581 instanceof Array)&&((t2$15582=t1$15581.length),((t2$15582===1)&&(t1$15581[0]==="void")))))))))){return ["objsplice",["ignore"]];}else{if(($15569$15589&&((bridge$15566$15583=$15565$15575[0]),(((((x$15612=bridge$15566$15583)),((x$15612 instanceof Array)&&(x$15612[0]==="pattern")))||((bridge$15566$15583 instanceof Array)&&((t0$15617=bridge$15566$15583.length),((t0$15617===2)&&((bridge$15566$15583[0]==="expr")&&(bridge$15566$15583[1]==="data"))))))&&((t1$15581=$15565$15575[1]),((t1$15581 instanceof Array)&&((t2$15582=t1$15581.length),((t2$15582===3)&&((t1$15581[0]==="data")&&((t3$15584=t1$15581[1]),((t3$15584 instanceof Array)&&((t4$15585=t3$15584.length),((t4$15585===1)&&(t3$15584[0]==="void")))))))))))))){(val$15608=t1$15581[2]);return ["objsplice",val$15608];}else{if(($15569$15589&&($15565$15575[0],((t1$15581=$15565$15575[1]),(($15572$15592=(t1$15581 instanceof Array))&&((t2$15582=t1$15581.length),((t2$15582===1)&&(t1$15581[0]==="void")))))))){return ["send",["symbol","Math"],["send",["symbol","."],["data",["void"],["symbol","pow"]]]];}else{if(($15572$15592&&((t2$15582===3)&&(t1$15581[0]==="data")))){(a$15633=t1$15581[1]);(b$15634=t1$15581[2]);return ["send",["send",["symbol","Math"],["send",["symbol","."],["data",["void"],["symbol","pow"]]]],["data",a$15633,b$15634]];}else{$20478($15565$15575);}}}}}),accum$15556)),$20252(((accum$15640=({})),((accum$15640["_"]=function($15643$15646,scope$15647,form$15648,$15644$15649){var x$15654;var t0$15661;var t1$15662;if((((x$15654=$15643$15646)),((x$15654 instanceof Array)&&(x$15654[0]==="pattern")))){;}else{$20478($15643$15646);}(t0$15661=$15644$15649);if(((t0$15661 instanceof Array)&&((t1$15662=t0$15661.length),((t1$15662===1)&&(t0$15661[0]==="void"))))){;}else{$20478($15644$15649);}return ["ignore"];}),accum$15640)),$20252(((accum$15668=({})),((accum$15668["not"]=function($15671$15674,scope$15675,form$15676,$15672$15677){var t0$15687;var t1$15688;var t2$15689;var t3$15690;var x$15708;var other$15715;var $15679$15698;var ph$15680;var rhs$15681;var arg$15682;(ph$15680=$15671$15674);;(t0$15687=$15672$15677);if(((t0$15687 instanceof Array)&&((t1$15688=t0$15687.length),((t1$15688===3)&&((t0$15687[0]==="data")&&((t2$15689=t0$15687[1]),((t2$15689 instanceof Array)&&((t3$15690=t2$15689.length),((t3$15690===1)&&(t2$15689[0]==="void")))))))))){(rhs$15681=t0$15687[2]);(arg$15682=t0$15687);;}else{$20478($15672$15677);}($15679$15698=ph$15680);;if((((x$15708=$15679$15698)),((x$15708 instanceof Array)&&(x$15708[0]==="pattern")))){return ["neg",rhs$15681];}else{(other$15715=$15679$15698);return ["send",["variable","not"],arg$15682];}}),accum$15668)),$20252(((accum$15718=({})),((accum$15718["and"]=function($15721$15724,scope$15725,form$15726,$15722$15727){var t0$15738;var t1$15739;var x$15755;var other$15762;var $15729$15745;var ph$15730;var lhs$15731;var rhs$15732;var arg$15733;(ph$15730=$15721$15724);;(t0$15738=$15722$15727);if(((t0$15738 instanceof Array)&&((t1$15739=t0$15738.length),((t1$15739===3)&&(t0$15738[0]==="data"))))){(lhs$15731=t0$15738[1]);(rhs$15732=t0$15738[2]);(arg$15733=t0$15738);;}else{$20478($15722$15727);}($15729$15745=ph$15730);;if((((x$15755=$15729$15745)),((x$15755 instanceof Array)&&(x$15755[0]==="pattern")))){return ["all",lhs$15731,rhs$15732];}else{(other$15762=$15729$15745);return ["send",["variable","and"],arg$15733];}}),accum$15718)),$20252(((accum$15765=({})),((accum$15765["or"]=function($15768$15771,scope$15772,form$15773,$15769$15774){var t0$15785;var t1$15786;var x$15802;var other$15809;var $15776$15792;var ph$15777;var lhs$15778;var rhs$15779;var arg$15780;(ph$15777=$15768$15771);;(t0$15785=$15769$15774);if(((t0$15785 instanceof Array)&&((t1$15786=t0$15785.length),((t1$15786===3)&&(t0$15785[0]==="data"))))){(lhs$15778=t0$15785[1]);(rhs$15779=t0$15785[2]);(arg$15780=t0$15785);;}else{$20478($15769$15774);}($15776$15792=ph$15777);;if((((x$15802=$15776$15792)),((x$15802 instanceof Array)&&(x$15802[0]==="pattern")))){return ["any",lhs$15778,rhs$15779];}else{(other$15809=$15776$15792);return ["send",["variable","or"],arg$15780];}}),accum$15765)),$20252(((accum$15812=({})),((accum$15812["when"]=function(context$15817,scope$15818,form$15819,$15815$15820){var t0$15826;var t1$15827;var other$15847;var t0$15838;var $15822$15833;var ph$15823;var condition$15824;(t0$15826=$15815$15820);if(((t0$15826 instanceof Array)&&((t1$15827=t0$15826.length),((t1$15827===3)&&(t0$15826[0]==="data"))))){(ph$15823=t0$15826[1]);(condition$15824=t0$15826[2]);;}else{$20478($15815$15820);}($15822$15833=ph$15823);;if((($15822$15833 instanceof Array)&&((t0$15838=$15822$15833.length),((t0$15838===1)&&($15822$15833[0]==="void"))))){return ["test",condition$15824,["ignore"]];}else{(other$15847=$15822$15833);return ["test",condition$15824,other$15847];}}),accum$15812)),$20252(((accum$15850=({})),((accum$15850["."]=function(context$15855,scope$15856,form$15857,$15853$15858){var t0$15862;var t1$15863;var t2$15864;var t3$15865;var f$15873;var expr$15860;(t0$15862=$15853$15858);if(((t0$15862 instanceof Array)&&((t1$15863=t0$15862.length),((t1$15863===3)&&((t0$15862[0]==="data")&&((t2$15864=t0$15862[1]),((t2$15864 instanceof Array)&&((t3$15865=t2$15864.length),((t3$15865===1)&&(t2$15864[0]==="void")))))))))){(expr$15860=t0$15862[2]);;}else{$20478($15853$15858);}(f$15873=function($15876$15878){var t0$15900;var t0$15904;var $index$15932;var $length$15927;var temp$15922;var acc$15917;var other$15952;var args$15910;var x$15897;var bridge$15881$15892;var t0$15893;var $15880$15887;var ph$15882;(ph$15882=$15876$15878);;($15880$15887=ph$15882);;(bridge$15881$15892=$15880$15887);if((((bridge$15881$15892 instanceof Array)&&((t0$15900=bridge$15881$15892.length),((t0$15900===2)&&((bridge$15881$15892[0]==="symbol")&&((x$15897=bridge$15881$15892[1]),true)))))||((bridge$15881$15892 instanceof Array)&&((t0$15904=bridge$15881$15892.length),((t0$15904===2)&&((bridge$15881$15892[0]==="value")&&((x$15897=bridge$15881$15892[1]),true))))))){return ["value",x$15897];}else{if((($15880$15887 instanceof Array)&&((t0$15893=$15880$15887.length),((t0$15893>=1)&&($15880$15887[0]==="data"))))){(args$15910=Array.prototype.slice.call($15880$15887,1));return ["data"].concat((((acc$15917=[])),(((temp$15922=args$15910)),((($length$15927=temp$15922.length)),((($index$15932=0)),function(){$15914:for(;($index$15932<$length$15927);($index$15932++)){var arg$15948;var m$15940;(m$15940=temp$15922[$index$15932]);;(arg$15948=m$15940);acc$15917.push(f$15873(arg$15948));}}()))),acc$15917));}else{(other$15952=$15880$15887);throw $20302(["syntax","dot"]).create("Argument to '.' must be a symbol or an array",({"argument":other$15952}));}}});;return f$15873(expr$15860);}),accum$15850)),$20252(((accum$15956=({})),((accum$15956["="]=function(context$15960,scope$15961,form$15962,expr$15963){var t0$15991;var t1$15992;var lhs$15988;var rhs$15989;var lhs$16035;var rhs$16036;var s$16027;var rhs$16028;var $16002$16016;var $16003$16017;var $16004$16018;var $16005$16019;var t0$16012;var t1$16013;var t2$16014;var $16001$16007;var x$16045;var t0$16054;var t1$16055;var lhs$16051;var rhs$16052;var $15966$15978;var $15967$15979;var $15968$15980;var $15969$15981;var t0$15976;var $15965$15971;($15965$15971=context$15960);;if((($15966$15978=($15965$15971 instanceof Array))&&((t0$15976=$15965$15971.length),(($15968$15980=(t0$15976===2))&&(($15969$15981=($15965$15971[0]==="expr"))&&($15965$15971[1]==="multi")))))){(t0$15991=expr$15963);if(((t0$15991 instanceof Array)&&((t1$15992=t0$15991.length),((t1$15992===3)&&(t0$15991[0]==="data"))))){(lhs$15988=t0$15991[1]);(rhs$15989=t0$15991[2]);;}else{$20478(expr$15963,"/home/olivier/git/earl-grey/src/stdenv.eg",10464,10468);}return parse_pattern$14168(scope$15961,lhs$15988,__lt____lt____colon__$14160(["use",scope$15961,rhs$15989],rhs$15989),pattern_handlers$14198.declare_variables);}else{if(($15969$15981&&($15965$15971[1]==="data"))){($16001$16007=expr$15963);;if((($16002$16016=($16001$16007 instanceof Array))&&((t0$16012=$16001$16007.length),((t0$16012===1)&&($16001$16007[0]==="void"))))){return ["assoc"];}else{if(($16002$16016&&(($16004$16018=(t0$16012===3))&&(($16005$16019=($16001$16007[0]==="data"))&&((t1$16013=$16001$16007[1]),((t1$16013 instanceof Array)&&((t2$16014=t1$16013.length),((t2$16014===2)&&(t1$16013[0]==="symbol"))))))))){(s$16027=t1$16013[1]);(rhs$16028=$16001$16007[2]);return ["assoc",["value",s$16027],rhs$16028];}else{if($16005$16019){(lhs$16035=$16001$16007[1]);(rhs$16036=$16001$16007[2]);return ["objsplice",["multi",parse_pattern$14168(scope$15961,lhs$16035,__lt____lt____colon__$14160(["use",scope$15961,rhs$16036],rhs$16036),pattern_handlers$14198.build_object)]];}else{$20478($16001$16007);}}}}else{if((((x$16045=$15965$15971)),((x$16045 instanceof Array)&&(x$16045[0]==="pattern")))){(t0$16054=expr$15963);if(((t0$16054 instanceof Array)&&((t1$16055=t0$16054.length),((t1$16055===3)&&(t0$16054[0]==="data"))))){(lhs$16051=t0$16054[1]);(rhs$16052=t0$16054[2]);;}else{$20478(expr$15963,"/home/olivier/git/earl-grey/src/stdenv.eg",11101,11105);}return ["default",lhs$16051,rhs$16052];}else{$20478($15965$15971);}}}}),accum$15956)),$20252(((accum$16063=({})),((accum$16063["=>"]=function($16066$16070,scope$16071,$16067$16072,$16068$16073){var t0$16084;var t0$16089;var t1$16090;var x$16106;var x$16136;var t0$16142;var t0$16146;var t0$16157;var t0$16161;var k$16152;var rhs$16153;var k$16132;var $16114$16127;var $16115$16128;var $16116$16129;var t0$16123;var bridge$16112$16124;var bridge$16113$16125;var $16111$16118;var x$16171;var t0$16179;var t1$16180;var t2$16181;var stmts$16177;var other$16189;var $16075$16096;var ph$16076;var env$16077;var lhs$16078;var rhs$16079;(ph$16076=$16066$16070);;(t0$16084=$16067$16072);if($20264(t0$16084,"env")){(env$16077=t0$16084.env);;}else{$20478($16067$16072);}(t0$16089=$16068$16073);if(((t0$16089 instanceof Array)&&((t1$16090=t0$16089.length),((t1$16090===3)&&(t0$16089[0]==="data"))))){(lhs$16078=t0$16089[1]);(rhs$16079=t0$16089[2]);;}else{$20478($16068$16073);}($16075$16096=ph$16076);;if((((x$16106=$16075$16096)),((x$16106 instanceof Array)&&(x$16106[0]==="pattern")))){($16111$16118=[lhs$16078,rhs$16079]);;if((($16114$16127=($16111$16118 instanceof Array))&&((t0$16123=$16111$16118.length),(($16116$16129=(t0$16123===2))&&((((x$16136=$16111$16118[0])),((x$16136 instanceof Array)&&(x$16136[0]==="void")))&&((bridge$16112$16124=$16111$16118[1]),(((bridge$16112$16124 instanceof Array)&&((t0$16142=bridge$16112$16124.length),((t0$16142===2)&&((bridge$16112$16124[0]==="symbol")&&((k$16132=bridge$16112$16124[1]),true)))))||((bridge$16112$16124 instanceof Array)&&((t0$16146=bridge$16112$16124.length),((t0$16146===2)&&((bridge$16112$16124[0]==="value")&&((k$16132=bridge$16112$16124[1]),true)))))))))))){return ["assoc",["value",k$16132],$20491(["symbol",k$16132],({"env":env$16077}))];}else{if(($16116$16129&&((bridge$16113$16125=$16111$16118[0]),(((bridge$16113$16125 instanceof Array)&&((t0$16157=bridge$16113$16125.length),((t0$16157===2)&&((bridge$16113$16125[0]==="symbol")&&((k$16152=bridge$16113$16125[1]),true)))))||((bridge$16113$16125 instanceof Array)&&((t0$16161=bridge$16113$16125.length),((t0$16161===2)&&((bridge$16113$16125[0]==="value")&&((k$16152=bridge$16113$16125[1]),true))))))))){(rhs$16153=$16111$16118[1]);return ["assoc",["value",k$16152],rhs$16153];}else{$20478($16111$16118);}}}else{if((((x$16171=$16075$16096)),((x$16171 instanceof Array)&&(x$16171[0]==="test")))){(t0$16179=$20563(["multi"])(rhs$16079));if((t0$16179[0]&&((t1$16180=t0$16179[1]),((t2$16181=t1$16180.length),(t2$16181>=0))))){(stmts$16177=Array.prototype.slice.call(t1$16180,0));;}else{$20478(rhs$16079,"/home/olivier/git/earl-grey/src/stdenv.eg",11578,11581);}return ["blocktest",lhs$16078,stmts$16177];}else{(other$16189=$16075$16096);return ["assoc",lhs$16078,rhs$16079];}}}),accum$16063)),$20252(((accum$16192=({})),((accum$16192[":="]=function(context$16197,scope$16198,form$16199,$16195$16200){var t0$16205;var t1$16206;var lhs$16202;var rhs$16203;(t0$16205=$16195$16200);if(((t0$16205 instanceof Array)&&((t1$16206=t0$16205.length),((t1$16206===3)&&(t0$16205[0]==="data"))))){(lhs$16202=t0$16205[1]);(rhs$16203=t0$16205[2]);;}else{$20478($16195$16200);}return ["assign",lhs$16202,rhs$16203];}),accum$16192)),$20252(({"+=":make_assigner$14201("+"),"-=":make_assigner$14201("-"),"*=":make_assigner$14201("*"),"/=":make_assigner$14201("/"),"<<=":make_assigner$14201("<<"),">>=":make_assigner$14201(">>"),">>>=":make_assigner$14201(">>>"),"++=":make_assigner$14201("++"),"?=":make_assigner$14201("match"),"or=":make_assigner$14201("or"),"and=":make_assigner$14201("and"),"each=":make_assigner$14201("each")}),$20252(((accum$16212=({})),((accum$16212["->"]=function($16215$16217,scope$16218,form$16219,expr$16220){var x$16238;var t0$16247;var t1$16248;var lhs$16244;var rhs$16245;var $index$16352;var $length$16347;var temp$16342;var acc$16337;var decls$16326;var newargs$16327;var body$16443;var a$16438;var other$16435;var fw$16316;var t0$16308;var t1$16309;var t2$16310;var t3$16311;var t4$16312;var $16297$16303;var pp$16298;var other$16455;var args$16449;var rhs$16450;var args$16288;var arg$16289;var rhs$16290;var $16258$16277;var $16259$16278;var $16260$16279;var $16261$16280;var $16262$16281;var $16263$16282;var $16264$16283;var $16265$16284;var $16266$16285;var t0$16273;var t1$16274;var t2$16275;var $16257$16268;var other$16255;var $16222$16228;var ph$16223;(ph$16223=$16215$16217);;($16222$16228=ph$16223);;if((((x$16238=$16222$16228)),((x$16238 instanceof Array)&&(x$16238[0]==="clause")))){(t0$16247=expr$16220);if(((t0$16247 instanceof Array)&&((t1$16248=t0$16247.length),((t1$16248===3)&&(t0$16247[0]==="data"))))){(lhs$16244=t0$16247[1]);(rhs$16245=t0$16247[2]);;}else{$20478(expr$16220,"/home/olivier/git/earl-grey/src/stdenv.eg",12198,12202);}return ["clause",lhs$16244,rhs$16245];}else{(other$16255=$16222$16228);($16257$16268=expr$16220);;if((($16258$16277=($16257$16268 instanceof Array))&&((t0$16273=$16257$16268.length),(($16260$16279=(t0$16273===3))&&(($16261$16280=($16257$16268[0]==="data"))&&((t1$16274=$16257$16268[1]),(($16263$16282=(t1$16274 instanceof Array))&&((t2$16275=t1$16274.length),(($16265$16284=(t2$16275>=1))&&($16266$16285=(t1$16274[0]==="data"))))))))))){(args$16288=Array.prototype.slice.call(t1$16274,1));(arg$16289=t1$16274);(rhs$16290=$16257$16268[2]);(pp$16298=PatternParser$14166(scope$16218,arg$16289,({"indexable":true,"allow_nested":true})));;($16297$16303=pp$16298.pattern);;if((($16297$16303 instanceof Array)&&((t0$16308=$16297$16303.length),((t0$16308===5)&&(($16297$16303[0]==="array_pattern")&&((fw$16316=$16297$16303[1]),((t1$16309=$16297$16303[2]),((t1$16309 instanceof Array)&&((t2$16310=t1$16309.length),((t2$16310===0)&&((t3$16311=$16297$16303[3]),((t3$16311 instanceof Array)&&((t4$16312=t3$16311.length),((t4$16312===0)&&($16297$16303[4]===(void 0)))))))))))))))){(decls$16326=function(){if(pp$16298.specials.match){return [["declare",["symbol","ph"]]];}else{return [];}}());;(newargs$16327=(((acc$16337=[])),(((temp$16342=zip$14163(fw$16316,args$16288))),((($length$16347=temp$16342.length)),((($index$16352=0)),function(){$16333:for(;($index$16352<$length$16347);($index$16352++)){var newv$16396;var other$16393;var expr$16383;var v$16384;var t0$16376;var t1$16377;var t2$16378;var t3$16379;var arg$16370;var $16335$16371;var t0$16365;var t1$16366;var m$16360;(m$16360=temp$16342[$index$16352]);;(t0$16365=m$16360);if(((t0$16365 instanceof Array)&&((t1$16366=t0$16365.length),(t1$16366===2)))){($16335$16371=t0$16365[0]);(arg$16370=t0$16365[1]);(t0$16376=$16335$16371);if(((t0$16376 instanceof Array)&&((t1$16377=t0$16376.length),((t1$16377===2)&&((t0$16376[0]==="assign")&&((t2$16378=t0$16376[1]),((expr$16383=t2$16378),((t2$16378 instanceof Array)&&((t3$16379=t2$16378.length),((t3$16379===2)&&(t2$16378[0]==="symbol"))))))))))){(v$16384=t2$16378[1]);acc$16337.push(expr$16383);}else{(other$16393=$16335$16371);acc$16337.push((((newv$16396=$20491(["symbol",scope$16218.gensym("temp")],({"env":stdenv$14179})))),decls$16326.push(parse_pattern$14168(scope$16218,arg$16370,newv$16396,$20491(pattern_handlers$14198.declare_variables,({"special":function($16400$16402,value$16403){var t0$16409;var t1$16410;var other$16428;var $16405$16416;var ph$16406;var expr$16407;(t0$16409=$16400$16402);if(((t0$16409 instanceof Array)&&((t1$16410=t0$16409.length),((t1$16410===2)&&(t0$16409[0]==="special"))))){(ph$16406=t0$16409[1]);(expr$16407=t0$16409);;}else{$20478($16400$16402);}($16405$16416=ph$16406);;if(($16405$16416==="match")){return ["assign",["symbol","ph"]];}else{(other$16428=$16405$16416);throw $20302(["syntax","pattern","special"]).create("Special token cannot be used here",({"special":expr$16407}));}}})))),newv$16396));}}else{$20478(m$16360,"/home/olivier/git/earl-grey/src/stdenv.eg",12674,13636);;}}}()))),acc$16337));;return ["lambda",newargs$16327,["multi"].concat(decls$16326).concat([function(){if(pp$16298.specials.match){return ["send",["symbol","match"],["data",["symbol","ph"],rhs$16290]];}else{return rhs$16290;}}()])];}else{(other$16435=$16297$16303);(a$16438=__lt____lt____colon__$14160(["symbol","arguments"],arg$16289));;(body$16443=["send",["send",["symbol","match"],["send",["symbol","."],["data",["void"],["symbol","indexable"]]]],["data",a$16438,["send",["symbol","->"],["data",arg$16289,rhs$16290]]]]);;return ["lambda",[],body$16443];}}else{if($16266$16285){(args$16449=Array.prototype.slice.call(t1$16274,1));(rhs$16450=$16257$16268[2]);return ["lambda",args$16449,rhs$16450];}else{(other$16455=$16257$16268);throw $20302(["syntax","lambda"]).create("Bad lambda syntax",({"node":other$16455}));}}}}),accum$16212)),$20252(({"match":accum_flags$14195(function($16457$16459,scope$16460,form$16461,expr$16462,flags$16463){var x$16481;var other$16502;var t0$16493;var $16486$16488;var v$16550;var b$16551;var b$16541;var $16524$16537;var $16525$16538;var t0$16532;var t1$16533;var t2$16534;var t3$16535;var $16523$16527;var v$16590;var b$16591;var b$16581;var $16564$16577;var $16565$16578;var t0$16572;var t1$16573;var t2$16574;var t3$16575;var $16563$16567;var t0$16520;var t1$16521;var accum$16605;var mbody$16601;var opt$16509;var to_match$16510;var value$16511;var body$16512;var other$16506;var $16465$16471;var ph$16466;(ph$16466=$16457$16459);;($16465$16471=ph$16466);;if((((x$16481=$16465$16471)),((x$16481 instanceof Array)&&(x$16481[0]==="pattern")))){($16486$16488=expr$16462);;if((($16486$16488 instanceof Array)&&((t0$16493=$16486$16488.length),((t0$16493===1)&&($16486$16488[0]==="void"))))){return ["special","match"];}else{(other$16502=$16486$16488);return ["all",__lt____lt____colon__$14160(other$16502,expr$16462),__lt____lt____colon__$14160(["special","match"],form$16461)];}}else{(other$16506=$16465$16471);(opt$16509=util$14161.set(flags$16463));;(to_match$16510=$20491(["symbol",scope$16460.gensym("m")],({"single_assignment":true})));;(t0$16520=((($16523$16527=expr$16462)),function(){if((($16524$16537=($16523$16527 instanceof Array))&&((t0$16532=$16523$16527.length),((t0$16532===2)&&(($16523$16527[0]==="data")&&((t1$16533=$20563(["multi"])($16523$16527[1])),(t1$16533[0]&&((t2$16534=t1$16533[1]),((t3$16535=t2$16534.length),(t3$16535>=0)))))))))){(b$16541=Array.prototype.slice.call(t2$16534,0));return [["value",null],b$16541];}else{if(($16524$16537&&((t0$16532===3)&&(($16523$16527[0]==="data")&&((v$16550=$16523$16527[1]),((t1$16533=$20563(["multi"])($16523$16527[2])),(t1$16533[0]&&((t2$16534=t1$16533[1]),((t3$16535=t2$16534.length),(t3$16535>=0)))))))))){(b$16551=Array.prototype.slice.call(t2$16534,0));return [v$16550,b$16551];}else{$20478($16523$16527);}}}()));if(((t0$16520 instanceof Array)&&((t1$16521=t0$16520.length),(t1$16521===2)))){(value$16511=t0$16520[0]);(body$16512=t0$16520[1]);;}else{$20478(((($16563$16567=expr$16462)),function(){if((($16564$16577=($16563$16567 instanceof Array))&&((t0$16572=$16563$16567.length),((t0$16572===2)&&(($16563$16567[0]==="data")&&((t1$16573=$20563(["multi"])($16563$16567[1])),(t1$16573[0]&&((t2$16574=t1$16573[1]),((t3$16575=t2$16574.length),(t3$16575>=0)))))))))){(b$16581=Array.prototype.slice.call(t2$16574,0));return [["value",null],b$16581];}else{if(($16564$16577&&((t0$16572===3)&&(($16563$16567[0]==="data")&&((v$16590=$16563$16567[1]),((t1$16573=$20563(["multi"])($16563$16567[2])),(t1$16573[0]&&((t2$16574=t1$16573[1]),((t3$16575=t2$16574.length),(t3$16575>=0)))))))))){(b$16591=Array.prototype.slice.call(t2$16574,0));return [v$16590,b$16591];}else{$20478($16563$16567);}}}()),"/home/olivier/git/earl-grey/src/stdenv.eg",14569,14688);}(mbody$16601=parse_clauses$14169(scope$16460,to_match$16510,body$16512,$20491(opt$16509,$20252(((accum$16605=({})),((accum$16605["fallback"]=function(target$16609){return match_error$14186(target$16609);}),accum$16605)),({"wrap":function(x$16612){return x$16612;}})))));;return ["send",["symbol","let"],["data",["send",["symbol","="],["data",to_match$16510,value$16511]],mbody$16601]];}})}),$20252(((accum$16616=({})),((accum$16616["each"]=function($16619$16623,scope$16624,$16620$16625,$16621$16626){var t0$16642;var t0$16647;var t1$16648;var t2$16649;var t3$16650;var t4$16651;var x$16727;var other$16746;var ends_with_test$16673;var _build_loop$16674;var $16629$16668;var $16630$16669;var $16631$16670;var $16632$16671;var t0$16666;var $16628$16661;var ph$16633;var form$16634;var env$16635;var li$16636;var clauses$16637;(ph$16633=$16619$16623);;(t0$16642=$16620$16625);(form$16634=t0$16642);if($20264(t0$16642,"env")){(env$16635=t0$16642.env);;}else{$20478($16620$16625);}(t0$16647=$16621$16626);if(((t0$16647 instanceof Array)&&((t1$16648=t0$16647.length),((t1$16648===3)&&((t0$16647[0]==="data")&&((li$16636=t0$16647[1]),((t2$16649=$20563(["multi"])(t0$16647[2])),(t2$16649[0]&&((t3$16650=t2$16649[1]),((t4$16651=t3$16650.length),(t4$16651>=0))))))))))){(clauses$16637=Array.prototype.slice.call(t3$16650,0));;}else{$20478($16621$16626);}($16628$16661=ph$16633);;(ends_with_test$16673=false);;(_build_loop$16674=function(wrap$16681,pre$16682,post$16683){var accum$16686;var accum$16716;return build_loop$14199(scope$16624,env$16635,form$16634,li$16636,clauses$16637,wrap$16681,pre$16682,post$16683,$20252(((accum$16686=({})),((accum$16686["wrap_pattern"]=function(x$16690,toplevel$16691){var x$16706;var other$16713;var $16694$16696;(ends_with_test$16673=((($16694$16696=x$16690)),function(){if((((x$16706=$16694$16696)),((x$16706 instanceof Array)&&(x$16706[0]==="test")))){return toplevel$16691;}else{(other$16713=$16694$16696);return false;}}()));return x$16690;}),accum$16686)),((accum$16716=({})),((accum$16716["fallback"]=function(target$16720){if(ends_with_test$16673){return ["symbol","false"];}else{return match_error$14186(target$16720);}}),accum$16716))));});;if((((x$16727=$16628$16661)),((x$16727 instanceof Array)&&(x$16727[0]==="test")))){return $20491(["test_factory",li$16636,clauses$16637],({"env":env$16635}));}else{if((($16629$16668=($16628$16661 instanceof Array))&&((t0$16666=$16628$16661.length),(($16631$16670=(t0$16666===2))&&(($16632$16671=($16628$16661[0]==="expr"))&&($16628$16661[1]==="multi")))))){return ["nostep",form$16634];}else{if(($16632$16671&&($16628$16661[1]==="ignore"))){return _build_loop$16674(function(x$16742){return x$16742;},["splice"],["splice"]);}else{(other$16746=$16628$16661);return _build_loop$16674(function(x$16749){return ["send",["send",["symbol","acc"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",x$16749]];},["send",["symbol","="],["data",["symbol","acc"],["data"]]],["symbol","acc"]);}}}}),accum$16616)),$20252(((accum$16752=({})),((accum$16752["each?"]=function($16755$16759,scope$16760,$16756$16761,$16757$16762){var t0$16778;var t0$16783;var t1$16784;var t2$16785;var t3$16786;var t4$16787;var x$16812;var other$16834;var $16765$16804;var $16766$16805;var $16767$16806;var $16768$16807;var t0$16802;var $16764$16797;var ph$16769;var form$16770;var env$16771;var li$16772;var clauses$16773;(ph$16769=$16755$16759);;(t0$16778=$16756$16761);(form$16770=t0$16778);if($20264(t0$16778,"env")){(env$16771=t0$16778.env);;}else{$20478($16756$16761);}(t0$16783=$16757$16762);if(((t0$16783 instanceof Array)&&((t1$16784=t0$16783.length),((t1$16784===3)&&((t0$16783[0]==="data")&&((li$16772=t0$16783[1]),((t2$16785=$20563(["multi"])(t0$16783[2])),(t2$16785[0]&&((t3$16786=t2$16785[1]),((t4$16787=t3$16786.length),(t4$16787>=0))))))))))){(clauses$16773=Array.prototype.slice.call(t3$16786,0));;}else{$20478($16757$16762);}($16764$16797=ph$16769);;if((((x$16812=$16764$16797)),((x$16812 instanceof Array)&&(x$16812[0]==="test")))){return $20491(["test_factory",li$16772,clauses$16773],({"env":env$16771}));}else{if((($16765$16804=($16764$16797 instanceof Array))&&((t0$16802=$16764$16797.length),(($16767$16806=(t0$16802===2))&&(($16768$16807=($16764$16797[0]==="expr"))&&($16764$16797[1]==="multi")))))){return ["nostep",form$16770];}else{if(($16768$16807&&($16764$16797[1]==="ignore"))){return build_loop$14199(scope$16760,env$16771,form$16770,li$16772,clauses$16773,function(x$16827){return x$16827;},["splice"],["splice"],({"fallback":function(target$16830){return ["symbol","false"];}}));}else{(other$16834=$16764$16797);return build_loop$14199(scope$16760,env$16771,form$16770,li$16772,clauses$16773,function(x$16837){return ["send",["send",["symbol","acc"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",x$16837]];},["send",["symbol","="],["data",["symbol","acc"],["data"]]],["symbol","acc"],({"fallback":function(target$16840){return ["symbol","false"];}}));}}}}),accum$16752)),$20252(((accum$16843=({})),((accum$16843["!!"]=function($16846$16849,scope$16850,form$16851,$16847$16852){var t0$16866;var t1$16867;var t2$16868;var t3$16869;var t4$16870;var other$16906;var $16855$16887;var $16856$16888;var $16857$16889;var $16858$16890;var t0$16885;var $16854$16880;var ph$16859;var expr$16860;var clauses$16861;(ph$16859=$16846$16849);;(t0$16866=$16847$16852);if(((t0$16866 instanceof Array)&&((t1$16867=t0$16866.length),((t1$16867===3)&&((t0$16866[0]==="data")&&((expr$16860=t0$16866[1]),((t2$16868=$20563(["multi"])(t0$16866[2])),(t2$16868[0]&&((t3$16869=t2$16868[1]),((t4$16870=t3$16869.length),(t4$16870>=0))))))))))){(clauses$16861=Array.prototype.slice.call(t3$16869,0));;}else{$20478($16847$16852);}($16854$16880=ph$16859);;if((($16855$16887=($16854$16880 instanceof Array))&&((t0$16885=$16854$16880.length),(($16857$16889=(t0$16885===2))&&(($16858$16890=($16854$16880[0]==="expr"))&&($16854$16880[1]==="multi")))))){return ["nostep",form$16851];}else{if(($16858$16890&&($16854$16880[1]==="ignore"))){clauses$16861.push(mkstdenv$14180().convert(["send",["symbol","->"],["data",["symbol","e"],["send",["symbol","throw"],["symbol","e"]]]]));return ["js_try",expr$16860,["send",["symbol","->"],["data",["data",["symbol","excv"]],parse_clauses$14169(scope$16850,["symbol","excv"],clauses$16861,({"wrap":function(x$16902){return x$16902;}}))]],["void"]];}else{(other$16906=$16854$16880);clauses$16861.push(mkstdenv$14180().convert(["send",["symbol","->"],["data",["symbol","e"],["send",["symbol","throw"],["symbol","e"]]]]));return ["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","rval"],["symbol","false"]]],["multi",["js_try",["send",["symbol",":="],["data",["symbol","rval"],expr$16860]],["send",["symbol","->"],["data",["data",["symbol","excv"]],parse_clauses$14169(scope$16850,["symbol","excv"],clauses$16861,({"wrap":function(x$16910){return ["send",["symbol",":="],["data",["symbol","rval"],x$16910]];}}))]],["void"]],["symbol","rval"]]]];}}}),accum$16843)),$20252(({"@":var_operator$14194(expander$14181.gensym("it"))}),$20252(((accum$16913=({})),((t0$16915=$20563(expr_mac$14188)(function(scope$16919,form$16920,$16917$16921){var t0$16927;var t1$16928;var t2$16929;var t3$16930;var t4$16931;var t5$16932;var it$16944;var construct$16945;var defn$16923;var env$16924;var body$16925;(t0$16927=$16917$16921);if(((t0$16927 instanceof Array)&&((t1$16928=t0$16927.length),((t1$16928===3)&&((t0$16927[0]==="data")&&((t2$16929=t0$16927[1]),((defn$16923=t2$16929),($20264(t2$16929,"env")&&((env$16924=t2$16929.env),((t3$16930=$20563(["multi"])(t0$16927[2])),(t3$16930[0]&&((t4$16931=t3$16930[1]),((t5$16932=t4$16931.length),(t5$16932>=0)))))))))))))){(body$16925=Array.prototype.slice.call(t4$16931,0));;}else{$20478($16917$16921);}(it$16944=$20491(["symbol","@"],({"env":env$16924})));;(construct$16945=function($16951$16953){var x$16980;var rest$16981;var x$16974;var $16956$16970;var $16957$16971;var t0$16968;var $16955$16963;var ph$16958;(ph$16958=$16951$16953);;($16955$16963=ph$16958);;if((($16956$16970=($16955$16963 instanceof Array))&&((t0$16968=$16955$16963.length),(t0$16968===1)))){(x$16974=$16955$16963[0]);return x$16974;}else{if(($16956$16970&&(t0$16968>=1))){(x$16980=$16955$16963[0]);(rest$16981=Array.prototype.slice.call($16955$16963,1));return ["send",["symbol","let"],["data",["send",["symbol","="],["data",it$16944,x$16980]],construct$16945(rest$16981)]];}else{$20478($16955$16963);}}});;return construct$16945([defn$16923].concat(body$16925));})),function(){if(t0$16915[0]){(accum$16913["chain"]=t0$16915[1]);return accum$16913;}else{return $20478(function(scope$16990,form$16991,$16988$16992){var t0$16998;var t1$16999;var t2$17000;var t3$17001;var t4$17002;var t5$17003;var it$17015;var construct$17016;var defn$16994;var env$16995;var body$16996;(t0$16998=$16988$16992);if(((t0$16998 instanceof Array)&&((t1$16999=t0$16998.length),((t1$16999===3)&&((t0$16998[0]==="data")&&((t2$17000=t0$16998[1]),((defn$16994=t2$17000),($20264(t2$17000,"env")&&((env$16995=t2$17000.env),((t3$17001=$20563(["multi"])(t0$16998[2])),(t3$17001[0]&&((t4$17002=t3$17001[1]),((t5$17003=t4$17002.length),(t5$17003>=0)))))))))))))){(body$16996=Array.prototype.slice.call(t4$17002,0));;}else{$20478($16988$16992);}(it$17015=$20491(["symbol","@"],({"env":env$16995})));;(construct$17016=function($17022$17024){var x$17051;var rest$17052;var x$17045;var $17027$17041;var $17028$17042;var t0$17039;var $17026$17034;var ph$17029;(ph$17029=$17022$17024);;($17026$17034=ph$17029);;if((($17027$17041=($17026$17034 instanceof Array))&&((t0$17039=$17026$17034.length),(t0$17039===1)))){(x$17045=$17026$17034[0]);return x$17045;}else{if(($17027$17041&&(t0$17039>=1))){(x$17051=$17026$17034[0]);(rest$17052=Array.prototype.slice.call($17026$17034,1));return ["send",["symbol","let"],["data",["send",["symbol","="],["data",it$17015,x$17051]],construct$17016(rest$17052)]];}else{$20478($17026$17034);}}});;return construct$17016([defn$16994].concat(body$16996));});}}())),$20252(((accum$17059=({})),((t0$17061=$20563(expr_mac$14188)(function(scope$17065,form$17066,$17063$17067){var t0$17073;var t1$17074;var t2$17075;var it$17083;var defn$17069;var env$17070;var body$17071;(t0$17073=$17063$17067);if(((t0$17073 instanceof Array)&&((t1$17074=t0$17073.length),((t1$17074===3)&&((t0$17073[0]==="data")&&((t2$17075=t0$17073[1]),((defn$17069=t2$17075),$20264(t2$17075,"env")))))))){(env$17070=t2$17075.env);(body$17071=t0$17073[2]);;}else{$20478($17063$17067);}(it$17083=$20491(["symbol","@"],({"env":env$17070})));;return ["send",["symbol","let"],["data",["send",["symbol","="],["data",it$17083,defn$17069]],body$17071]];})),function(){if(t0$17061[0]){(accum$17059["using"]=t0$17061[1]);return accum$17059;}else{return $20478(function(scope$17090,form$17091,$17088$17092){var t0$17098;var t1$17099;var t2$17100;var it$17108;var defn$17094;var env$17095;var body$17096;(t0$17098=$17088$17092);if(((t0$17098 instanceof Array)&&((t1$17099=t0$17098.length),((t1$17099===3)&&((t0$17098[0]==="data")&&((t2$17100=t0$17098[1]),((defn$17094=t2$17100),$20264(t2$17100,"env")))))))){(env$17095=t2$17100.env);(body$17096=t0$17098[2]);;}else{$20478($17088$17092);}(it$17108=$20491(["symbol","@"],({"env":env$17095})));;return ["send",["symbol","let"],["data",["send",["symbol","="],["data",it$17108,defn$17094]],body$17096]];});}}())),$20252(((accum$17113=({})),((t0$17115=$20563(overridable$14189)(function($17117$17120,scope$17121,form$17122,$17118$17123){var t0$17132;var t1$17133;var x$17149;var x$17158;var t0$17166;var t1$17167;var t2$17168;var stmts$17164;var x$17178;var $17125$17139;var ph$17126;var body$17127;(ph$17126=$17117$17120);;(t0$17132=$17118$17123);if(((t0$17132 instanceof Array)&&((t1$17133=t0$17132.length),((t1$17133===2)&&(t0$17132[0]==="data"))))){(body$17127=t0$17132[1]);;}else{$20478($17118$17123);}($17125$17139=ph$17126);;if((((x$17149=$17125$17139)),((x$17149 instanceof Array)&&(x$17149[0]==="clause")))){return ["block",body$17127];}else{if((((x$17158=$17125$17139)),((x$17158 instanceof Array)&&(x$17158[0]==="test")))){(t0$17166=$20563(["multi"])(body$17127));if((t0$17166[0]&&((t1$17167=t0$17166[1]),((t2$17168=t1$17167.length),(t2$17168>=0))))){(stmts$17164=Array.prototype.slice.call(t1$17167,0));;}else{$20478(body$17127,"/home/olivier/git/earl-grey/src/stdenv.eg",19041,19045);}return ["do",["splice"].concat(stmts$17164)];}else{if((((x$17178=$17125$17139)),((x$17178 instanceof Array)&&(x$17178[0]==="expr")))){return ["multi",body$17127];}else{$20478($17125$17139);}}}})),function(){if(t0$17115[0]){(accum$17113["do"]=t0$17115[1]);return accum$17113;}else{return $20478(function($17186$17189,scope$17190,form$17191,$17187$17192){var t0$17201;var t1$17202;var x$17218;var x$17227;var t0$17235;var t1$17236;var t2$17237;var stmts$17233;var x$17247;var $17194$17208;var ph$17195;var body$17196;(ph$17195=$17186$17189);;(t0$17201=$17187$17192);if(((t0$17201 instanceof Array)&&((t1$17202=t0$17201.length),((t1$17202===2)&&(t0$17201[0]==="data"))))){(body$17196=t0$17201[1]);;}else{$20478($17187$17192);}($17194$17208=ph$17195);;if((((x$17218=$17194$17208)),((x$17218 instanceof Array)&&(x$17218[0]==="clause")))){return ["block",body$17196];}else{if((((x$17227=$17194$17208)),((x$17227 instanceof Array)&&(x$17227[0]==="test")))){(t0$17235=$20563(["multi"])(body$17196));if((t0$17235[0]&&((t1$17236=t0$17235[1]),((t2$17237=t1$17236.length),(t2$17237>=0))))){(stmts$17233=Array.prototype.slice.call(t1$17236,0));;}else{$20478(body$17196,"/home/olivier/git/earl-grey/src/stdenv.eg",19041,19045);}return ["do",["splice"].concat(stmts$17233)];}else{if((((x$17247=$17194$17208)),((x$17247 instanceof Array)&&(x$17247[0]==="expr")))){return ["multi",body$17196];}else{$20478($17194$17208);}}}});}}())),$20252(((accum$17255=({})),((t0$17257=$20563(expr_mac$14188)(function(scope$17261,form$17262,$17259$17263){var other$17372;var s1$17359;var b$17360;var a$17340;var b$17341;var a$17328;var $17267$17323;var $17268$17324;var $17269$17325;var t0$17308;var t1$17309;var t2$17310;var t3$17311;var t4$17312;var t5$17313;var t6$17314;var t7$17315;var t8$17316;var t9$17317;var t10$17318;var t11$17319;var t12$17320;var t13$17321;var test$17299;var $17266$17300;var test$17291;var a$17292;var b$17293;var $17270$17287;var $17271$17288;var t0$17282;var t1$17283;var t2$17284;var t3$17285;var $17265$17277;var ph$17272;(ph$17272=$17259$17263);;($17265$17277=ph$17272);;if((($17270$17287=($17265$17277 instanceof Array))&&((t0$17282=$17265$17277.length),((t0$17282===4)&&($17265$17277[0]==="data"))))){(test$17291=$17265$17277[1]);(a$17292=$17265$17277[2]);(b$17293=$17265$17277[3]);return ["if",test$17291,a$17292,b$17293];}else{if(($17270$17287&&((t0$17282===3)&&(($17265$17277[0]==="data")&&((test$17299=$17265$17277[1]),((t1$17283=$20563(["multi"])($17265$17277[2])),(t1$17283[0]&&((t2$17284=t1$17283[1]),((t3$17285=t2$17284.length),(t3$17285>=0)))))))))){($17266$17300=Array.prototype.slice.call(t2$17284,0));(t0$17308=$17266$17300);if((($17268$17324=(t0$17308 instanceof Array))&&((t1$17309=t0$17308.length),((t1$17309===1)&&((t2$17310=t0$17308[0]),((t2$17310 instanceof Array)&&((t3$17311=t2$17310.length),((t3$17311===3)&&((t2$17310[0]==="send")&&((t4$17312=t2$17310[1]),((t4$17312 instanceof Array)&&((t5$17313=t4$17312.length),((t5$17313===2)&&((t4$17312[0]==="symbol")&&((t4$17312[1]==="then")&&((t6$17314=t2$17310[2]),((t6$17314 instanceof Array)&&((t7$17315=t6$17314.length),((t7$17315===2)&&(t6$17314[0]==="data")))))))))))))))))))){(a$17328=t6$17314[1]);return ["if",test$17299,a$17328,["value",(void 0)]];}else{if(($17268$17324&&((t1$17309===2)&&((t2$17310=t0$17308[0]),((t2$17310 instanceof Array)&&((t3$17311=t2$17310.length),((t3$17311===3)&&((t2$17310[0]==="send")&&((t4$17312=t2$17310[1]),((t4$17312 instanceof Array)&&((t5$17313=t4$17312.length),((t5$17313===2)&&((t4$17312[0]==="symbol")&&((t4$17312[1]==="then")&&((t6$17314=t2$17310[2]),((t6$17314 instanceof Array)&&((t7$17315=t6$17314.length),((t7$17315===2)&&((t6$17314[0]==="data")&&((a$17340=t6$17314[1]),((t8$17316=t0$17308[1]),((t8$17316 instanceof Array)&&((t9$17317=t8$17316.length),((t9$17317===3)&&((t8$17316[0]==="send")&&((t10$17318=t8$17316[1]),((t10$17318 instanceof Array)&&((t11$17319=t10$17318.length),((t11$17319===2)&&((t10$17318[0]==="symbol")&&((t10$17318[1]==="else")&&((t12$17320=t8$17316[2]),((t12$17320 instanceof Array)&&((t13$17321=t12$17320.length),((t13$17321===2)&&(t12$17320[0]==="data")))))))))))))))))))))))))))))))))))){(b$17341=t12$17320[1]);return ["if",test$17299,a$17340,b$17341];}else{if(($17268$17324&&((t1$17309>=1)&&((s1$17359=Array.prototype.slice.call(t0$17308,0,-1)),((t2$17310=t0$17308[(t1$17309-1)]),((t2$17310 instanceof Array)&&((t3$17311=t2$17310.length),((t3$17311===3)&&((t2$17310[0]==="send")&&((t4$17312=t2$17310[1]),((t4$17312 instanceof Array)&&((t5$17313=t4$17312.length),((t5$17313===2)&&((t4$17312[0]==="symbol")&&((t4$17312[1]==="else")&&((t6$17314=t2$17310[2]),((t6$17314 instanceof Array)&&((t7$17315=t6$17314.length),((t7$17315===2)&&(t6$17314[0]==="data")))))))))))))))))))){(b$17360=t6$17314[1]);return ["if",test$17299,["multi"].concat(s1$17359),b$17360];}else{(other$17372=$17266$17300);return ["if",test$17299,["multi"].concat(other$17372),["value",(void 0)]];}}}}else{$20478($17265$17277);}}})),function(){if(t0$17257[0]){(accum$17255["if"]=t0$17257[1]);return accum$17255;}else{return $20478(function(scope$17379,form$17380,$17377$17381){var other$17490;var s1$17477;var b$17478;var a$17458;var b$17459;var a$17446;var $17385$17441;var $17386$17442;var $17387$17443;var t0$17426;var t1$17427;var t2$17428;var t3$17429;var t4$17430;var t5$17431;var t6$17432;var t7$17433;var t8$17434;var t9$17435;var t10$17436;var t11$17437;var t12$17438;var t13$17439;var test$17417;var $17384$17418;var test$17409;var a$17410;var b$17411;var $17388$17405;var $17389$17406;var t0$17400;var t1$17401;var t2$17402;var t3$17403;var $17383$17395;var ph$17390;(ph$17390=$17377$17381);;($17383$17395=ph$17390);;if((($17388$17405=($17383$17395 instanceof Array))&&((t0$17400=$17383$17395.length),((t0$17400===4)&&($17383$17395[0]==="data"))))){(test$17409=$17383$17395[1]);(a$17410=$17383$17395[2]);(b$17411=$17383$17395[3]);return ["if",test$17409,a$17410,b$17411];}else{if(($17388$17405&&((t0$17400===3)&&(($17383$17395[0]==="data")&&((test$17417=$17383$17395[1]),((t1$17401=$20563(["multi"])($17383$17395[2])),(t1$17401[0]&&((t2$17402=t1$17401[1]),((t3$17403=t2$17402.length),(t3$17403>=0)))))))))){($17384$17418=Array.prototype.slice.call(t2$17402,0));(t0$17426=$17384$17418);if((($17386$17442=(t0$17426 instanceof Array))&&((t1$17427=t0$17426.length),((t1$17427===1)&&((t2$17428=t0$17426[0]),((t2$17428 instanceof Array)&&((t3$17429=t2$17428.length),((t3$17429===3)&&((t2$17428[0]==="send")&&((t4$17430=t2$17428[1]),((t4$17430 instanceof Array)&&((t5$17431=t4$17430.length),((t5$17431===2)&&((t4$17430[0]==="symbol")&&((t4$17430[1]==="then")&&((t6$17432=t2$17428[2]),((t6$17432 instanceof Array)&&((t7$17433=t6$17432.length),((t7$17433===2)&&(t6$17432[0]==="data")))))))))))))))))))){(a$17446=t6$17432[1]);return ["if",test$17417,a$17446,["value",(void 0)]];}else{if(($17386$17442&&((t1$17427===2)&&((t2$17428=t0$17426[0]),((t2$17428 instanceof Array)&&((t3$17429=t2$17428.length),((t3$17429===3)&&((t2$17428[0]==="send")&&((t4$17430=t2$17428[1]),((t4$17430 instanceof Array)&&((t5$17431=t4$17430.length),((t5$17431===2)&&((t4$17430[0]==="symbol")&&((t4$17430[1]==="then")&&((t6$17432=t2$17428[2]),((t6$17432 instanceof Array)&&((t7$17433=t6$17432.length),((t7$17433===2)&&((t6$17432[0]==="data")&&((a$17458=t6$17432[1]),((t8$17434=t0$17426[1]),((t8$17434 instanceof Array)&&((t9$17435=t8$17434.length),((t9$17435===3)&&((t8$17434[0]==="send")&&((t10$17436=t8$17434[1]),((t10$17436 instanceof Array)&&((t11$17437=t10$17436.length),((t11$17437===2)&&((t10$17436[0]==="symbol")&&((t10$17436[1]==="else")&&((t12$17438=t8$17434[2]),((t12$17438 instanceof Array)&&((t13$17439=t12$17438.length),((t13$17439===2)&&(t12$17438[0]==="data")))))))))))))))))))))))))))))))))))){(b$17459=t12$17438[1]);return ["if",test$17417,a$17458,b$17459];}else{if(($17386$17442&&((t1$17427>=1)&&((s1$17477=Array.prototype.slice.call(t0$17426,0,-1)),((t2$17428=t0$17426[(t1$17427-1)]),((t2$17428 instanceof Array)&&((t3$17429=t2$17428.length),((t3$17429===3)&&((t2$17428[0]==="send")&&((t4$17430=t2$17428[1]),((t4$17430 instanceof Array)&&((t5$17431=t4$17430.length),((t5$17431===2)&&((t4$17430[0]==="symbol")&&((t4$17430[1]==="else")&&((t6$17432=t2$17428[2]),((t6$17432 instanceof Array)&&((t7$17433=t6$17432.length),((t7$17433===2)&&(t6$17432[0]==="data")))))))))))))))))))){(b$17478=t6$17432[1]);return ["if",test$17417,["multi"].concat(s1$17477),b$17478];}else{(other$17490=$17384$17418);return ["if",test$17417,["multi"].concat(other$17490),["value",(void 0)]];}}}}else{$20478($17383$17395);}}});}}())),$20252(((accum$17495=({})),((t0$17497=$20563(expr_mac$14188)(function(scope$17501,form$17502,$17499$17503){var t0$17510;var t0$17528;var t1$17529;var t2$17530;var t3$17531;var t4$17532;var t5$17533;var t6$17534;var t7$17535;var t8$17536;var t0$17548;var test$17570;var body$17571;var label$17525;var bridge$17506$17520;var t0$17521;var $17505$17515;var ph$17507;var env$17508;(t0$17510=$17499$17503);if($20264(t0$17510,"env")){(env$17508=t0$17510.env);(ph$17507=t0$17510);;}else{$20478($17499$17503);}($17505$17515=ph$17507);;(bridge$17506$17520=$17505$17515);if((((bridge$17506$17520 instanceof Array)&&((t0$17528=bridge$17506$17520.length),((t0$17528===3)&&((bridge$17506$17520[0]==="send")&&((t1$17529=bridge$17506$17520[1]),((t1$17529 instanceof Array)&&((t2$17530=t1$17529.length),((t2$17530===2)&&((t1$17529[0]==="symbol")&&((t1$17529[1]===".")&&((t3$17531=bridge$17506$17520[2]),((t3$17531 instanceof Array)&&((t4$17532=t3$17531.length),((t4$17532===3)&&((t3$17531[0]==="data")&&((t5$17533=t3$17531[1]),((t5$17533 instanceof Array)&&((t6$17534=t5$17533.length),((t6$17534===1)&&((t5$17533[0]==="void")&&((t7$17535=t3$17531[2]),((t7$17535 instanceof Array)&&((t8$17536=t7$17535.length),((t8$17536===2)&&((t7$17535[0]==="symbol")&&((label$17525=t7$17535[1]),true))))))))))))))))))))))))))||((bridge$17506$17520 instanceof Array)&&((t0$17548=bridge$17506$17520.length),((t0$17548===2)&&((bridge$17506$17520[0]==="value")&&((label$17525=bridge$17506$17520[1]),true))))))){return ["macro",function(context$17554,scope$17555,form$17556,$17552$17557){var t0$17562;var t1$17563;var test$17559;var body$17560;(t0$17562=$17552$17557);if(((t0$17562 instanceof Array)&&((t1$17563=t0$17562.length),((t1$17563===3)&&(t0$17562[0]==="data"))))){(test$17559=t0$17562[1]);(body$17560=t0$17562[2]);;}else{$20478($17552$17557);}return setup_label$14191(label$17525,env$17508,["js_while",test$17559,body$17560]);}];}else{if((($17505$17515 instanceof Array)&&((t0$17521=$17505$17515.length),((t0$17521===3)&&($17505$17515[0]==="data"))))){(test$17570=$17505$17515[1]);(body$17571=$17505$17515[2]);return setup_label$14191(scope$17501.gensym(),env$17508,["js_while",test$17570,body$17571]);}else{$20478($17505$17515);}}})),function(){if(t0$17497[0]){(accum$17495["while"]=t0$17497[1]);return accum$17495;}else{return $20478(function(scope$17580,form$17581,$17578$17582){var t0$17589;var t0$17607;var t1$17608;var t2$17609;var t3$17610;var t4$17611;var t5$17612;var t6$17613;var t7$17614;var t8$17615;var t0$17627;var test$17649;var body$17650;var label$17604;var bridge$17585$17599;var t0$17600;var $17584$17594;var ph$17586;var env$17587;(t0$17589=$17578$17582);if($20264(t0$17589,"env")){(env$17587=t0$17589.env);(ph$17586=t0$17589);;}else{$20478($17578$17582);}($17584$17594=ph$17586);;(bridge$17585$17599=$17584$17594);if((((bridge$17585$17599 instanceof Array)&&((t0$17607=bridge$17585$17599.length),((t0$17607===3)&&((bridge$17585$17599[0]==="send")&&((t1$17608=bridge$17585$17599[1]),((t1$17608 instanceof Array)&&((t2$17609=t1$17608.length),((t2$17609===2)&&((t1$17608[0]==="symbol")&&((t1$17608[1]===".")&&((t3$17610=bridge$17585$17599[2]),((t3$17610 instanceof Array)&&((t4$17611=t3$17610.length),((t4$17611===3)&&((t3$17610[0]==="data")&&((t5$17612=t3$17610[1]),((t5$17612 instanceof Array)&&((t6$17613=t5$17612.length),((t6$17613===1)&&((t5$17612[0]==="void")&&((t7$17614=t3$17610[2]),((t7$17614 instanceof Array)&&((t8$17615=t7$17614.length),((t8$17615===2)&&((t7$17614[0]==="symbol")&&((label$17604=t7$17614[1]),true))))))))))))))))))))))))))||((bridge$17585$17599 instanceof Array)&&((t0$17627=bridge$17585$17599.length),((t0$17627===2)&&((bridge$17585$17599[0]==="value")&&((label$17604=bridge$17585$17599[1]),true))))))){return ["macro",function(context$17633,scope$17634,form$17635,$17631$17636){var t0$17641;var t1$17642;var test$17638;var body$17639;(t0$17641=$17631$17636);if(((t0$17641 instanceof Array)&&((t1$17642=t0$17641.length),((t1$17642===3)&&(t0$17641[0]==="data"))))){(test$17638=t0$17641[1]);(body$17639=t0$17641[2]);;}else{$20478($17631$17636);}return setup_label$14191(label$17604,env$17587,["js_while",test$17638,body$17639]);}];}else{if((($17584$17594 instanceof Array)&&((t0$17600=$17584$17594.length),((t0$17600===3)&&($17584$17594[0]==="data"))))){(test$17649=$17584$17594[1]);(body$17650=$17584$17594[2]);return setup_label$14191(scope$17580.gensym(),env$17587,["js_while",test$17649,body$17650]);}else{$20478($17584$17594);}}});}}())),$20252(((accum$17657=({})),((accum$17657["for"]=function(context$17662,scope$17663,form$17664,$17660$17665){var t0$17672;var t0$17742;var t1$17743;var t2$17744;var t3$17745;var t4$17746;var t5$17747;var t6$17748;var t7$17749;var t8$17750;var t0$17762;var spec$17784;var body$17785;var label$17739;var setup_for$17685;var bridge$17668$17681;var t0$17682;var $17667$17676;var ph$17669;var expr$17670;(t0$17672=$17660$17665);(expr$17670=t0$17672);(ph$17669=t0$17672);;($17667$17676=ph$17669);;(setup_for$17685=function(label$17690,env$17691,$17688$17692,body$17693){var a$17726;var b$17727;var a$17718;var b$17719;var c$17720;var $17696$17714;var $17697$17715;var t0$17708;var t1$17709;var t2$17710;var t3$17711;var t4$17712;var $17695$17703;var ph$17698;(ph$17698=$17688$17692);;($17695$17703=ph$17698);;if((($17696$17714=($17695$17703 instanceof Array))&&((t0$17708=$17695$17703.length),((t0$17708===4)&&($17695$17703[0]==="multi"))))){(a$17718=$17695$17703[1]);(b$17719=$17695$17703[2]);(c$17720=$17695$17703[3]);return ["multi",a$17718,setup_label$14191(label$17690,env$17691,["js_for",["multi"],b$17719,c$17720,body$17693])];}else{if(($17696$17714&&((t0$17708===3)&&(($17695$17703[0]==="send")&&((t1$17709=$17695$17703[1]),((t1$17709 instanceof Array)&&((t2$17710=t1$17709.length),((t2$17710===2)&&((t1$17709[0]==="symbol")&&((t1$17709[1]==="in")&&((t3$17711=$17695$17703[2]),((t3$17711 instanceof Array)&&((t4$17712=t3$17711.length),((t4$17712===3)&&(t3$17711[0]==="data"))))))))))))))){(a$17726=t3$17711[1]);(b$17727=t3$17711[2]);return ["multi",["declare",a$17726,["value",null]],setup_label$14191(label$17690,env$17691,["js_for_in",a$17726,b$17727,body$17693])];}else{$20478($17695$17703);}}});;(bridge$17668$17681=$17667$17676);if((((bridge$17668$17681 instanceof Array)&&((t0$17742=bridge$17668$17681.length),((t0$17742===3)&&((bridge$17668$17681[0]==="send")&&((t1$17743=bridge$17668$17681[1]),((t1$17743 instanceof Array)&&((t2$17744=t1$17743.length),((t2$17744===2)&&((t1$17743[0]==="symbol")&&((t1$17743[1]===".")&&((t3$17745=bridge$17668$17681[2]),((t3$17745 instanceof Array)&&((t4$17746=t3$17745.length),((t4$17746===3)&&((t3$17745[0]==="data")&&((t5$17747=t3$17745[1]),((t5$17747 instanceof Array)&&((t6$17748=t5$17747.length),((t6$17748===1)&&((t5$17747[0]==="void")&&((t7$17749=t3$17745[2]),((t7$17749 instanceof Array)&&((t8$17750=t7$17749.length),((t8$17750===2)&&((t7$17749[0]==="symbol")&&((label$17739=t7$17749[1]),true))))))))))))))))))))))))))||((bridge$17668$17681 instanceof Array)&&((t0$17762=bridge$17668$17681.length),((t0$17762===2)&&((bridge$17668$17681[0]==="value")&&((label$17739=bridge$17668$17681[1]),true))))))){return ["macro",function(context$17768,scope$17769,form$17770,$17766$17771){var t0$17776;var t1$17777;var spec$17773;var body$17774;(t0$17776=$17766$17771);if(((t0$17776 instanceof Array)&&((t1$17777=t0$17776.length),((t1$17777===3)&&(t0$17776[0]==="data"))))){(spec$17773=t0$17776[1]);(body$17774=t0$17776[2]);;}else{$20478($17766$17771);}return setup_for$17685(label$17739,expr$17670.env,spec$17773,body$17774);}];}else{if((($17667$17676 instanceof Array)&&((t0$17682=$17667$17676.length),((t0$17682===3)&&($17667$17676[0]==="data"))))){(spec$17784=$17667$17676[1]);(body$17785=$17667$17676[2]);return setup_for$17685(scope$17663.gensym(),form$17664.env,spec$17784,body$17785);}else{$20478($17667$17676);}}}),accum$17657)),$20252(((accum$17792=({})),((t0$17794=$20563(expr_mac$14188)(function(scope$17798,form$17799,$17796$17800){var t0$17805;var t1$17806;var t2$17807;var t3$17808;var t4$17809;var construct$17818;var bindings$17802;var body$17803;(t0$17805=$17796$17800);if(((t0$17805 instanceof Array)&&((t1$17806=t0$17805.length),((t1$17806===3)&&((t0$17805[0]==="data")&&((t2$17807=$20563(["multi"])(t0$17805[1])),(t2$17807[0]&&((t3$17808=t2$17807[1]),((t4$17809=t3$17808.length),(t4$17809>=0)))))))))){(bindings$17802=Array.prototype.slice.call(t3$17808,0));(body$17803=t0$17805[2]);;}else{$20478($17796$17800);}(construct$17818=function($17821$17823){var x$17849;var xs$17850;var $17826$17840;var $17827$17841;var t0$17838;var $17825$17833;var ph$17828;(ph$17828=$17821$17823);;($17825$17833=ph$17828);;if((($17826$17840=($17825$17833 instanceof Array))&&((t0$17838=$17825$17833.length),(t0$17838===0)))){return body$17803;}else{if(($17826$17840&&(t0$17838>=1))){(x$17849=$17825$17833[0]);(xs$17850=Array.prototype.slice.call($17825$17833,1));return $20491(["multi",x$17849,construct$17818(xs$17850)],({"nonrecursive":true}));}else{$20478($17825$17833);}}});;return construct$17818(bindings$17802);})),function(){if(t0$17794[0]){(accum$17792["let"]=t0$17794[1]);return accum$17792;}else{return $20478(function(scope$17859,form$17860,$17857$17861){var t0$17866;var t1$17867;var t2$17868;var t3$17869;var t4$17870;var construct$17879;var bindings$17863;var body$17864;(t0$17866=$17857$17861);if(((t0$17866 instanceof Array)&&((t1$17867=t0$17866.length),((t1$17867===3)&&((t0$17866[0]==="data")&&((t2$17868=$20563(["multi"])(t0$17866[1])),(t2$17868[0]&&((t3$17869=t2$17868[1]),((t4$17870=t3$17869.length),(t4$17870>=0)))))))))){(bindings$17863=Array.prototype.slice.call(t3$17869,0));(body$17864=t0$17866[2]);;}else{$20478($17857$17861);}(construct$17879=function($17882$17884){var x$17910;var xs$17911;var $17887$17901;var $17888$17902;var t0$17899;var $17886$17894;var ph$17889;(ph$17889=$17882$17884);;($17886$17894=ph$17889);;if((($17887$17901=($17886$17894 instanceof Array))&&((t0$17899=$17886$17894.length),(t0$17899===0)))){return body$17864;}else{if(($17887$17901&&(t0$17899>=1))){(x$17910=$17886$17894[0]);(xs$17911=Array.prototype.slice.call($17886$17894,1));return $20491(["multi",x$17910,construct$17879(xs$17911)],({"nonrecursive":true}));}else{$20478($17886$17894);}}});;return construct$17879(bindings$17863);});}}())),$20252(((accum$17918=({})),((t0$17920=$20563(expr_mac$14188)(function(scope$17924,form$17925,$17922$17926){var t0$17931;var t1$17932;var t2$17933;var t3$17934;var t4$17935;var bindings$17928;var body$17929;(t0$17931=$17922$17926);if(((t0$17931 instanceof Array)&&((t1$17932=t0$17931.length),((t1$17932===3)&&((t0$17931[0]==="data")&&((t2$17933=$20563(["multi"])(t0$17931[1])),(t2$17933[0]&&((t3$17934=t2$17933[1]),((t4$17935=t3$17934.length),(t4$17935>=0)))))))))){(bindings$17928=Array.prototype.slice.call(t3$17934,0));(body$17929=t0$17931[2]);;}else{$20478($17922$17926);}return ["multi"].concat(bindings$17928).concat([body$17929]);})),function(){if(t0$17920[0]){(accum$17918["letrec"]=t0$17920[1]);return accum$17918;}else{return $20478(function(scope$17946,form$17947,$17944$17948){var t0$17953;var t1$17954;var t2$17955;var t3$17956;var t4$17957;var bindings$17950;var body$17951;(t0$17953=$17944$17948);if(((t0$17953 instanceof Array)&&((t1$17954=t0$17953.length),((t1$17954===3)&&((t0$17953[0]==="data")&&((t2$17955=$20563(["multi"])(t0$17953[1])),(t2$17955[0]&&((t3$17956=t2$17955[1]),((t4$17957=t3$17956.length),(t4$17957>=0)))))))))){(bindings$17950=Array.prototype.slice.call(t3$17956,0));(body$17951=t0$17953[2]);;}else{$20478($17944$17948);}return ["multi"].concat(bindings$17950).concat([body$17951]);});}}())),$20252(((accum$17966=({})),((accum$17966["where"]=function(context$17971,scope$17972,form$17973,$17969$17974){var t0$17979;var t1$17980;var body$17976;var bindings$17977;(t0$17979=$17969$17974);if(((t0$17979 instanceof Array)&&((t1$17980=t0$17979.length),((t1$17980===3)&&(t0$17979[0]==="data"))))){(body$17976=t0$17979[1]);(bindings$17977=t0$17979[2]);;}else{$20478($17969$17974);}return ["send",["symbol","letrec"],["data",bindings$17977,body$17976]];}),accum$17966)),$20252(({"break":break_mac$14192(null),"continue":continue_mac$14193(null)}),$20252(((accum$17986=({})),((t0$17988=$20563(expr_mac$14188)(function(scope$17991,form$17992,arg$17993){return ["js_throw",arg$17993];})),function(){if(t0$17988[0]){(accum$17986["throw"]=t0$17988[1]);return accum$17986;}else{return $20478(function(scope$17997,form$17998,arg$17999){return ["js_throw",arg$17999];});}}())),$20252(((accum$18002=({})),((t0$18004=$20563(expr_mac$14188)(function(scope$18007,form$18008,arg$18009){return ["js_return",arg$18009];})),function(){if(t0$18004[0]){(accum$18002["return"]=t0$18004[1]);return accum$18002;}else{return $20478(function(scope$18013,form$18014,arg$18015){return ["js_return",arg$18015];});}}())),$20252(((accum$18018=({})),((t0$18020=$20563(expr_mac$14188)(function(scope$18023,form$18024,arg$18025){return ["js_new",arg$18025];})),function(){if(t0$18020[0]){(accum$18018["new"]=t0$18020[1]);return accum$18018;}else{return $20478(function(scope$18029,form$18030,arg$18031){return ["js_new",arg$18031];});}}())),$20252(((accum$18034=({})),((t0$18036=$20563(expr_mac$14188)(function(scope$18039,form$18040,arg$18041){return ["js_delete",arg$18041];})),function(){if(t0$18036[0]){(accum$18034["delete"]=t0$18036[1]);return accum$18034;}else{return $20478(function(scope$18045,form$18046,arg$18047){return ["js_delete",arg$18047];});}}())),$20252(((accum$18050=({})),((accum$18050["?"]=function(context$18055,scope$18056,form$18057,$18053$18058){var t0$18062;var t1$18063;var t2$18064;var t3$18065;var other$18121;var $18078$18090;var $18079$18091;var $18080$18092;var $18081$18093;var t0$18088;var $18077$18083;var checker$18074;var expr$18060;(t0$18062=$18053$18058);if(((t0$18062 instanceof Array)&&((t1$18063=t0$18062.length),((t1$18063===3)&&((t0$18062[0]==="data")&&((expr$18060=t0$18062[1]),((t2$18064=t0$18062[2]),((t2$18064 instanceof Array)&&((t3$18065=t2$18064.length),((t3$18065===1)&&(t2$18064[0]==="void"))))))))))){;}else{$20478($18053$18058);}(checker$18074=((($18077$18083=expr$18060)),function(){if((($18078$18090=($18077$18083 instanceof Array))&&((t0$18088=$18077$18083.length),(($18080$18092=(t0$18088===2))&&(($18081$18093=($18077$18083[0]==="symbol"))&&($18077$18083[1]==="String")))))){return checker_db$14176.String;}else{if(($18081$18093&&($18077$18083[1]==="Number"))){return checker_db$14176.Number;}else{if(($18081$18093&&($18077$18083[1]==="true"))){return checker_db$14176.true;}else{if(($18081$18093&&($18077$18083[1]==="false"))){return checker_db$14176.false;}else{if(($18081$18093&&($18077$18083[1]==="null"))){return checker_db$14176.null;}else{if(($18081$18093&&($18077$18083[1]==="undefined"))){return checker_db$14176.undefined;}else{(other$18121=$18077$18083);return ["send",["symbol","___checker"],["data",expr$18060]];}}}}}}}()));;return ["macro",function($18124$18126,env$18127,form$18128,expr$18129){var x$18147;var other$18168;var t0$18159;var $18152$18154;var other$18172;var $18131$18137;var ph$18132;(ph$18132=$18124$18126);;($18131$18137=ph$18132);;if((((x$18147=$18131$18137)),((x$18147 instanceof Array)&&(x$18147[0]==="pattern")))){($18152$18154=expr$18129);;if((($18152$18154 instanceof Array)&&((t0$18159=$18152$18154.length),((t0$18159===1)&&($18152$18154[0]==="void"))))){return ["check",checker$18074,["ignore"]];}else{(other$18168=$18152$18154);return ["check",checker$18074,expr$18129];}}else{(other$18172=$18131$18137);return ["send",checker$18074,["data",expr$18129]];}}];}),accum$18050)),$20252(((accum$18175=({})),((accum$18175["!"]=function(context$18180,scope$18181,form$18182,$18178$18183){var t0$18187;var t1$18188;var t2$18189;var t3$18190;var other$18236;var $18203$18215;var $18204$18216;var $18205$18217;var $18206$18218;var t0$18213;var $18202$18208;var projector$18199;var expr$18185;(t0$18187=$18178$18183);if(((t0$18187 instanceof Array)&&((t1$18188=t0$18187.length),((t1$18188===3)&&((t0$18187[0]==="data")&&((expr$18185=t0$18187[1]),((t2$18189=t0$18187[2]),((t2$18189 instanceof Array)&&((t3$18190=t2$18189.length),((t3$18190===1)&&(t2$18189[0]==="void"))))))))))){;}else{$20478($18178$18183);}(projector$18199=((($18202$18208=expr$18185)),function(){if((($18203$18215=($18202$18208 instanceof Array))&&((t0$18213=$18202$18208.length),(($18205$18217=(t0$18213===2))&&(($18206$18218=($18202$18208[0]==="symbol"))&&($18202$18208[1]==="String")))))){return mac1$14175(function(x$18225){return ["data",["symbol","true"],["send",["symbol","String"],["data",x$18225]]];});}else{if(($18206$18218&&($18202$18208[1]==="Number"))){return mac1$14175(function(x$18232){return ["data",["symbol","true"],["send",["symbol","parseFloat"],["data",x$18232]]];});}else{(other$18236=$18202$18208);return ["send",["symbol","___projector"],["data",expr$18185]];}}}()));;return ["macro",function($18239$18241,env$18242,form$18243,expr$18244){var x$18262;var other$18283;var t0$18274;var $18267$18269;var other$18287;var $18246$18252;var ph$18247;(ph$18247=$18239$18241);;($18246$18252=ph$18247);;if((((x$18262=$18246$18252)),((x$18262 instanceof Array)&&(x$18262[0]==="pattern")))){($18267$18269=expr$18244);;if((($18267$18269 instanceof Array)&&((t0$18274=$18267$18269.length),((t0$18274===1)&&($18267$18269[0]==="void"))))){return ["project",projector$18199,["ignore"]];}else{(other$18283=$18267$18269);return ["project",projector$18199,expr$18244];}}else{(other$18287=$18246$18252);return ["send",["send",projector$18199,["data",expr$18244]],["value",1]];}}];}),accum$18175)),$20252(((accum$18290=({})),((accum$18290["#"]=function(context$18295,scope$18296,form$18297,$18293$18298){var t0$18302;var t1$18303;var t2$18304;var t3$18305;var t4$18306;var t5$18307;var f$18318;var tag$18300;(t0$18302=$18293$18298);if(((t0$18302 instanceof Array)&&((t1$18303=t0$18302.length),((t1$18303===3)&&((t0$18302[0]==="data")&&((t2$18304=t0$18302[1]),((t2$18304 instanceof Array)&&((t3$18305=t2$18304.length),((t3$18305===1)&&((t2$18304[0]==="void")&&((t4$18306=t0$18302[2]),((t4$18306 instanceof Array)&&((t5$18307=t4$18306.length),((t5$18307===2)&&(t4$18306[0]==="symbol"))))))))))))))){(tag$18300=t4$18306[1]);;}else{$20478($18293$18298);}(tag$18300=["value",tag$18300]);(f$18318=function($18321$18323,scope$18324,form$18325,expr$18326){var x$18344;var other$18394;var subp$18384;var $18351$18380;var $18352$18381;var t0$18378;var $18350$18373;var checker_mac$18353;var other$18424;var args$18419;var $18400$18410;var $18401$18411;var t0$18408;var $18399$18403;var $18328$18334;var ph$18329;(ph$18329=$18321$18323);;($18328$18334=ph$18329);;if((((x$18344=$18328$18334)),((x$18344 instanceof Array)&&(x$18344[0]==="pattern")))){(checker_mac$18353=["macro",function(context$18358,scope$18359,form$18360,$18356$18361){var t0$18365;var t1$18366;var expr$18363;(t0$18365=$18356$18361);if(((t0$18365 instanceof Array)&&((t1$18366=t0$18365.length),((t1$18366===2)&&(t0$18365[0]==="data"))))){(expr$18363=t0$18365[1]);;}else{$20478($18356$18361);}return ["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","x"],expr$18363]],["send",["symbol","and"],["data",["send",["symbol","instanceof"],["data",["symbol","x"],["symbol","Array"]]],["send",["symbol","==="],["data",["send",["symbol","x"],["value",0]],tag$18300]]]]]];}]);;($18350$18373=expr$18326);;if((($18351$18380=($18350$18373 instanceof Array))&&((t0$18378=$18350$18373.length),((t0$18378>=1)&&($18350$18373[0]==="data"))))){(subp$18384=Array.prototype.slice.call($18350$18373,1));return ["data",tag$18300].concat(subp$18384);}else{if(($18351$18380&&((t0$18378===1)&&($18350$18373[0]==="void")))){return ["check",checker_mac$18353,["ignore"]];}else{(other$18394=$18350$18373);return ["check",checker_mac$18353,expr$18326];}}}else{$18328$18334;($18399$18403=expr$18326);;if((($18400$18410=($18399$18403 instanceof Array))&&((t0$18408=$18399$18403.length),((t0$18408===1)&&($18399$18403[0]==="void"))))){return ["data",tag$18300];}else{if(($18400$18410&&((t0$18408>=1)&&($18399$18403[0]==="data")))){(args$18419=Array.prototype.slice.call($18399$18403,1));return ["data",tag$18300].concat(args$18419);}else{(other$18424=$18399$18403);return ["send",["data",tag$18300],other$18424];}}}});;return ["macro",f$18318];}),accum$18290)),$20252(((accum$18428=({})),((accum$18428["require"]=function(context$18433,scope$18434,form$18435,$18431$18436){var t0$18440;var t1$18441;var req$18447;var stmts$18448;var topfetch$18449;var produce$18450;var expr$18438;(t0$18440=$18431$18436);if(((t0$18440 instanceof Array)&&((t1$18441=t0$18440.length),((t1$18441===2)&&(t0$18440[0]==="data"))))){(expr$18438=t0$18440[1]);;}else{$20478($18431$18436);}(req$18447=["variable","require"]);;(stmts$18448=[]);;(topfetch$18449=function(pkg$18460,v$18461){stmts$18448.push(["send",["symbol","="],["data",v$18461,["send",req$18447,["data",pkg$18460]]]]);return v$18461;});;(produce$18450=function($18467$18469,fetch$18470){var t0$18486;var t0$18530;var t0$18534;var $index$18556;var $length$18551;var temp$18546;var acc$18541;var pkgv$18611;var pkg$18604;var subp$18605;var pkg$18588;var s$18589;var name$18576;var subp$18527;var s$18521;var s$18515;var $18474$18504;var $18475$18505;var $18476$18506;var $18477$18507;var $18478$18508;var $18479$18509;var $18480$18510;var $18481$18511;var $18482$18512;var t0$18495;var t1$18496;var bridge$18473$18497;var t2$18498;var t3$18499;var t4$18500;var t5$18501;var t6$18502;var $18472$18490;var ph$18483;var expr$18484;(t0$18486=$18467$18469);(expr$18484=t0$18486);(ph$18483=t0$18486);;($18472$18490=ph$18483);;if((($18474$18504=($18472$18490 instanceof Array))&&((t0$18495=$18472$18490.length),(($18476$18506=(t0$18495===2))&&($18472$18490[0]==="symbol"))))){(s$18515=$18472$18490[1]);return fetch$18470(["value",s$18515],expr$18484);}else{if(($18476$18506&&(($18472$18490[0]==="value")&&((t1$18496=$18472$18490[1]),(typeof(t1$18496)==="string"))))){(s$18521=t1$18496);return fetch$18470(expr$18484,["symbol",scope$18434.gensym()]);}else{(bridge$18473$18497=$18472$18490);if((((bridge$18473$18497 instanceof Array)&&((t0$18530=bridge$18473$18497.length),((t0$18530>=1)&&((bridge$18473$18497[0]==="multi")&&((subp$18527=Array.prototype.slice.call(bridge$18473$18497,1)),true)))))||((bridge$18473$18497 instanceof Array)&&((t0$18534=bridge$18473$18497.length),((t0$18534>=1)&&((bridge$18473$18497[0]==="data")&&((subp$18527=Array.prototype.slice.call(bridge$18473$18497,1)),true))))))){(acc$18541=[]);;(temp$18546=subp$18527);;($length$18551=temp$18546.length);;($index$18556=0);;$18538:for(;($index$18556<$length$18551);($index$18556++)){var p$18572;var m$18564;(m$18564=temp$18546[$index$18556]);;(p$18572=m$18564);acc$18541.push(produce$18450(p$18572,fetch$18470));}return acc$18541;}else{if((($18474$18504=($18472$18490 instanceof Array))&&((t0$18495=$18472$18490.length),(($18476$18506=(t0$18495===3))&&(($18477$18507=($18472$18490[0]==="send"))&&((t1$18496=$18472$18490[1]),(($18479$18509=(t1$18496 instanceof Array))&&((t2$18498=t1$18496.length),(($18481$18511=(t2$18498===2))&&(($18482$18512=(t1$18496[0]==="symbol"))&&((t1$18496[1]==="^")&&((t3$18499=$18472$18490[2]),((t3$18499 instanceof Array)&&((t4$18500=t3$18499.length),((t4$18500===3)&&((t3$18499[0]==="data")&&((t5$18501=t3$18499[1]),((t5$18501 instanceof Array)&&((t6$18502=t5$18501.length),((t6$18502===1)&&(t5$18501[0]==="void"))))))))))))))))))))){(name$18576=t3$18499[2]);return fetch$18470(name$18576,["symbol",scope$18434.gensym()]);}else{if(($18482$18512&&((t1$18496[1]==="as")&&((t3$18499=$18472$18490[2]),((t3$18499 instanceof Array)&&((t4$18500=t3$18499.length),((t4$18500===3)&&(t3$18499[0]==="data")))))))){(pkg$18588=t3$18499[1]);(s$18589=t3$18499[2]);return produce$18450(pkg$18588,function(the_pkg$18596,$18594$18597){$18594$18597;;return fetch$18470(the_pkg$18596,s$18589);});}else{if(($18482$18512&&((t1$18496[1]==="->")&&((t3$18499=$18472$18490[2]),((t3$18499 instanceof Array)&&((t4$18500=t3$18499.length),((t4$18500===3)&&(t3$18499[0]==="data")))))))){(pkg$18604=t3$18499[1]);(subp$18605=t3$18499[2]);(pkgv$18611=produce$18450(pkg$18604,fetch$18470));;return produce$18450(subp$18605,function(pkg$18616,v$18617){return stmts$18448.push(["send",["symbol","="],["data",v$18617,["send",pkgv$18611,pkg$18616]]]);});}else{$20478($18472$18490);}}}}}}});;produce$18450(expr$18438,topfetch$18449);return ["splice"].concat(stmts$18448);}),accum$18428)),$20252(((accum$18623=({})),((accum$18623["provide"]=function(context$18628,scope$18629,form$18630,$18626$18631){var t0$18635;var t1$18636;var t2$18637;var t3$18638;var t4$18639;var $index$18667;var $length$18662;var temp$18657;var acc$18652;var expr$18633;(t0$18635=$18626$18631);if(((t0$18635 instanceof Array)&&((t1$18636=t0$18635.length),((t1$18636===2)&&((t0$18635[0]==="data")&&((t2$18637=$20563(["multi"])(t0$18635[1])),(t2$18637[0]&&((t3$18638=t2$18637[1]),((t4$18639=t3$18638.length),(t4$18639>=0)))))))))){(expr$18633=Array.prototype.slice.call(t3$18638,0));;}else{$20478($18626$18631);}return ["sink",["multi"].concat((((acc$18652=[])),(((temp$18657=expr$18633)),((($length$18662=temp$18657.length)),((($index$18667=0)),function(){$18647:for(;($index$18667<$length$18662);($index$18667++)){var t0$18709;var t0$18713;var other$18719;var s$18698;var name$18699;var s$18691;var name$18692;var $18650$18688;var t0$18680;var t1$18681;var t2$18682;var t3$18683;var t4$18684;var t5$18685;var bridge$18649$18686;var m$18675;(m$18675=temp$18657[$index$18667]);;(t0$18680=m$18675);(s$18691=t0$18680);if(((t0$18680 instanceof Array)&&((t1$18681=t0$18680.length),((t1$18681===2)&&(t0$18680[0]==="symbol"))))){(name$18692=t0$18680[1]);acc$18652.push(["send",["symbol",":="],["data",["send",["symbol","exports"],["value",name$18692]],s$18691]]);}else{if(((t0$18680 instanceof Array)&&((t1$18681=t0$18680.length),((t1$18681===3)&&((t0$18680[0]==="send")&&((t2$18682=t0$18680[1]),((t2$18682 instanceof Array)&&((t3$18683=t2$18682.length),((t3$18683===2)&&((t2$18682[0]==="symbol")&&((t2$18682[1]==="as")&&((t4$18684=t0$18680[2]),((t4$18684 instanceof Array)&&((t5$18685=t4$18684.length),((t5$18685===3)&&((t4$18684[0]==="data")&&((s$18698=t4$18684[1]),((bridge$18649$18686=t4$18684[2]),(((bridge$18649$18686 instanceof Array)&&((t0$18709=bridge$18649$18686.length),((t0$18709===2)&&((bridge$18649$18686[0]==="symbol")&&((name$18699=bridge$18649$18686[1]),true)))))||((bridge$18649$18686 instanceof Array)&&((t0$18713=bridge$18649$18686.length),((t0$18713===2)&&((bridge$18649$18686[0]==="value")&&((name$18699=bridge$18649$18686[1]),true)))))))))))))))))))))))){acc$18652.push(["send",["symbol",":="],["data",["send",["symbol","exports"],["value",name$18699]],s$18698]]);}else{(other$18719=m$18675);acc$18652.push(function(){throw $20302(["syntax","provide"]).create("Each clause of provide must be 'sym' or 'sym as name'");}());}}}}()))),acc$18652))];}),accum$18623)),$20252(((accum$18722=({})),((accum$18722["class"]=function(context$18727,scope$18728,$18725$18729,expr$18730){var t0$18734;var stmts$19058;var name$19047;var stmts$19048;var $18740$19043;var $18741$19044;var t0$19038;var t1$19039;var t2$19040;var t3$19041;var $18739$19033;var helper$18742;var env$18732;(t0$18734=$18725$18729);if($20264(t0$18734,"env")){(env$18732=t0$18734.env);;}else{$20478($18725$18729);}(helper$18742=function(name$18746,stmts$18747){var $index$18785;var $length$18780;var temp$18775;var acc$18770;var t0$18987;var t1$18988;var t0$18997;var env2$18994;var it$18995;var t0$19005;var t1$19006;var other$19029;var t0$19020;var $18750$19015;var statics$18751;var ctor$18752;var new_stmts$18753;var ctor_args$18754;var ctor_body$18755;var name_str$18756;var node$18757;(statics$18751=["data",["symbol","="]]);;(ctor$18752=[["data"],$20491(["multi"],({"env":env$18732}))]);;(new_stmts$18753=(((acc$18770=[])),(((temp$18775=stmts$18747)),((($length$18780=temp$18775.length)),((($index$18785=0)),function(){$18766:for(;($index$18785<$length$18780);($index$18785++)){var t0$18828;var t1$18829;var t2$18830;var t3$18831;var t4$18832;var t5$18833;var t6$18834;var t7$18835;var t8$18836;var t0$18849;var t1$18850;var t2$18851;var t3$18852;var t4$18853;var t5$18854;var t6$18855;var t7$18856;var t8$18857;var t9$18858;var t10$18859;var t11$18860;var t12$18861;var accum$18891;var accum$18915;var accum$18922;var accum$18973;var lhs$18881;var rhs$18882;var args$18824;var body$18825;var methods$18811;var t0$18798;var t1$18799;var t2$18800;var t3$18801;var t4$18802;var t5$18803;var t6$18804;var t7$18805;var t8$18806;var bridge$18768$18807;var m$18793;(m$18793=temp$18775[$index$18785]);;(t0$18798=m$18793);if(((t0$18798 instanceof Array)&&((t1$18799=t0$18798.length),((t1$18799===3)&&((t0$18798[0]==="send")&&((t2$18800=t0$18798[1]),((t2$18800 instanceof Array)&&((t3$18801=t2$18800.length),((t3$18801===2)&&((t2$18800[0]==="symbol")&&((t2$18800[1]==="static")&&((t4$18802=t0$18798[2]),((t4$18802 instanceof Array)&&((t5$18803=t4$18802.length),((t5$18803===2)&&((t4$18802[0]==="data")&&((t6$18804=$20563(["multi"])(t4$18802[1])),(t6$18804[0]&&((t7$18805=t6$18804[1]),((t8$18806=t7$18805.length),(t8$18806>=0))))))))))))))))))))){(methods$18811=Array.prototype.slice.call(t7$18805,0));acc$18770.push((statics$18751=statics$18751.concat(methods$18811)));}else{(bridge$18768$18807=m$18793);if((((bridge$18768$18807 instanceof Array)&&((t0$18828=bridge$18768$18807.length),((t0$18828===3)&&((bridge$18768$18807[0]==="send")&&((t1$18829=bridge$18768$18807[1]),((t1$18829 instanceof Array)&&((t2$18830=t1$18829.length),((t2$18830===2)&&((t1$18829[0]==="symbol")&&((t1$18829[1]==="=")&&((t3$18831=bridge$18768$18807[2]),((t3$18831 instanceof Array)&&((t4$18832=t3$18831.length),((t4$18832===3)&&((t3$18831[0]==="data")&&((t5$18833=t3$18831[1]),((t5$18833 instanceof Array)&&((t6$18834=t5$18833.length),((t6$18834===3)&&((t5$18833[0]==="send")&&((t7$18835=t5$18833[1]),((t7$18835 instanceof Array)&&((t8$18836=t7$18835.length),((t8$18836===2)&&((t7$18835[0]==="symbol")&&((t7$18835[1]==="constructor")&&((args$18824=t5$18833[2]),((body$18825=t3$18831[2]),true))))))))))))))))))))))))))))||((bridge$18768$18807 instanceof Array)&&((t0$18849=bridge$18768$18807.length),((t0$18849===3)&&((bridge$18768$18807[0]==="send")&&((t1$18850=bridge$18768$18807[1]),((t1$18850 instanceof Array)&&((t2$18851=t1$18850.length),((t2$18851===2)&&((t1$18850[0]==="symbol")&&((t1$18850[1]==="=")&&((t3$18852=bridge$18768$18807[2]),((t3$18852 instanceof Array)&&((t4$18853=t3$18852.length),((t4$18853===3)&&((t3$18852[0]==="data")&&((t5$18854=t3$18852[1]),((t5$18854 instanceof Array)&&((t6$18855=t5$18854.length),((t6$18855===2)&&((t5$18854[0]==="symbol")&&((t5$18854[1]==="constructor")&&((t7$18856=t3$18852[2]),((t7$18856 instanceof Array)&&((t8$18857=t7$18856.length),((t8$18857===3)&&((t7$18856[0]==="send")&&((t9$18858=t7$18856[1]),((t9$18858 instanceof Array)&&((t10$18859=t9$18858.length),((t10$18859===2)&&((t9$18858[0]==="symbol")&&((t9$18858[1]==="->")&&((t11$18860=t7$18856[2]),((t11$18860 instanceof Array)&&((t12$18861=t11$18860.length),((t12$18861===3)&&((t11$18860[0]==="data")&&((args$18824=t11$18860[1]),((body$18825=t11$18860[2]),true))))))))))))))))))))))))))))))))))))))))){acc$18770.push(((ctor$18752=[args$18824,body$18825]),["splice"]));}else{(t0$18798=m$18793);if(((t0$18798 instanceof Array)&&((t1$18799=t0$18798.length),((t1$18799===3)&&((t0$18798[0]==="send")&&((t2$18800=t0$18798[1]),((t2$18800 instanceof Array)&&((t3$18801=t2$18800.length),((t3$18801===2)&&((t2$18800[0]==="symbol")&&((t2$18800[1]==="=")&&((t4$18802=t0$18798[2]),((t4$18802 instanceof Array)&&((t5$18803=t4$18802.length),((t5$18803===3)&&(t4$18802[0]==="data")))))))))))))))){(lhs$18881=t4$18802[1]);(rhs$18882=t4$18802[2]);acc$18770.push(parse_pattern$14168(scope$18728,lhs$18881,rhs$18882,$20491(pattern_handlers$14198.build_object,$20252(({"allow_nested":false}),$20252(((accum$18891=({})),((accum$18891["assign"]=function($18894$18897,value$18898){var t0$18905;var t0$18909;var bridge$18895$18902;var v$18900;(bridge$18895$18902=$18894$18897);if((((bridge$18895$18902 instanceof Array)&&((t0$18905=bridge$18895$18902.length),((t0$18905===2)&&((bridge$18895$18902[0]==="symbol")&&((v$18900=bridge$18895$18902[1]),true)))))||((bridge$18895$18902 instanceof Array)&&((t0$18909=bridge$18895$18902.length),((t0$18909===2)&&((bridge$18895$18902[0]==="value")&&((v$18900=bridge$18895$18902[1]),true))))))){;}else{$20478($18894$18897);}return ["do",__lt____lt____colon__$14160(["assign",["send",["send",name$18746,["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value",v$18900]],value$18898],v$18900)];}),accum$18891)),$20252(((accum$18915=({})),((accum$18915["declare"]=function(vars$18919){return [];}),accum$18915)),$20252(((accum$18922=({})),((accum$18922["wrap_target"]=function($18925$18927){var t0$18961;var env$18958;var it$18959;var other$18970;var args$18948;var body$18949;var t0$18940;var t1$18941;var t2$18942;var t3$18943;var t4$18944;var $18929$18935;var ph$18930;(ph$18930=$18925$18927);;($18929$18935=ph$18930);;if((($18929$18935 instanceof Array)&&((t0$18940=$18929$18935.length),((t0$18940===3)&&(($18929$18935[0]==="send")&&((t1$18941=$18929$18935[1]),((t1$18941 instanceof Array)&&((t2$18942=t1$18941.length),((t2$18942===2)&&((t1$18941[0]==="symbol")&&((t1$18941[1]==="->")&&((t3$18943=$18929$18935[2]),((t3$18943 instanceof Array)&&((t4$18944=t3$18943.length),((t4$18944===3)&&(t3$18943[0]==="data")))))))))))))))){(args$18948=t3$18943[1]);(body$18949=t3$18943[2]);(t0$18961=body$18949);if($20264(t0$18961,"env")){(env$18958=t0$18961.env);;}else{$20478(body$18949,"/home/olivier/git/earl-grey/src/stdenv.eg",25878,25882);}(it$18959=$20491(["symbol","@"],({"env":env$18958})));;return ["send",["symbol","->"],["data",args$18948,["send",["symbol","let"],["data",["send",["symbol","="],["data",it$18959,["symbol","this"]]],body$18949]]]];}else{(other$18970=$18929$18935);return other$18970;}}),accum$18922)),((accum$18973=({})),((accum$18973["success"]=function($18976$18978){$18976$18978;;return ["splice"];}),accum$18973)))))))));}else{$20478(m$18793,"/home/olivier/git/earl-grey/src/stdenv.eg",25157,26213);;}}}}}()))),acc$18770));;(t0$18987=ctor$18752);if(((t0$18987 instanceof Array)&&((t1$18988=t0$18987.length),(t1$18988===2)))){(ctor_args$18754=t0$18987[0]);(ctor_body$18755=t0$18987[1]);;}else{$20478(ctor$18752,"/home/olivier/git/earl-grey/src/stdenv.eg",26238,26242);}(ctor_body$18755=(((t0$18997=ctor_body$18755),function(){if($20264(t0$18997,"env")){(env2$18994=t0$18997.env);}else{return $20478(ctor_body$18755,"/home/olivier/git/earl-grey/src/stdenv.eg",26293,26302);}}()),((it$18995=$20491(["symbol","@"],({"env":env2$18994})))),["send",["symbol","let"],["data",["send",["symbol","="],["data",it$18995,["send",["symbol","if"],["data",["send",["symbol","not"],["data",["void"],["send",["send",["symbol","?"],["data",name$18746,["void"]]],["symbol","this"]]]],["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","create"]]]],["data",["send",name$18746,["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]],["symbol","this"]]]]],["multi",ctor_body$18755,it$18995]]]));(t0$19005=name$18746);if(((t0$19005 instanceof Array)&&((t1$19006=t0$19005.length),((t1$19006===2)&&(t0$19005[0]==="symbol"))))){(name_str$18756=t0$19005[1]);;}else{$20478(name$18746,"/home/olivier/git/earl-grey/src/stdenv.eg",26518,26522);}statics$18751.push(["send",["symbol","="],["data",["value","::name"],["value",name_str$18756]]]);statics$18751.push(["send",["symbol","="],["data",["value","::egclass"],["symbol","true"]]]);(node$18757=["splice",["send",["symbol","="],["data",name$18746,["send",["symbol","->"],["data",ctor_args$18754,ctor_body$18755]]]]].concat(new_stmts$18753).concat([["send",["symbol","&:"],["data",name$18746,statics$18751]],name$18746]));;($18750$19015=context$18727);;if((($18750$19015 instanceof Array)&&((t0$19020=$18750$19015.length),((t0$19020===2)&&(($18750$19015[0]==="expr")&&($18750$19015[1]==="multi")))))){return node$18757;}else{(other$19029=$18750$19015);return ["multi",node$18757];}});;($18739$19033=expr$18730);;if((($18740$19043=($18739$19033 instanceof Array))&&((t0$19038=$18739$19033.length),((t0$19038===3)&&(($18739$19033[0]==="data")&&((name$19047=$18739$19033[1]),((t1$19039=$20563(["multi"])($18739$19033[2])),(t1$19039[0]&&((t2$19040=t1$19039[1]),((t3$19041=t2$19040.length),(t3$19041>=0))))))))))){(stmts$19048=Array.prototype.slice.call(t2$19040,0));return helper$18742(name$19047,stmts$19048);}else{if(($18740$19043&&((t0$19038===2)&&(($18739$19033[0]==="data")&&((t1$19039=$20563(["multi"])($18739$19033[1])),(t1$19039[0]&&((t2$19040=t1$19039[1]),((t3$19041=t2$19040.length),(t3$19041>=0))))))))){(stmts$19058=Array.prototype.slice.call(t2$19040,0));return helper$18742(["symbol",scope$18728.gensym()],stmts$19058);}else{$20478($18739$19033);}}}),accum$18722)),$20252(((accum$19067=({})),((accum$19067["%"]=function(context$19072,scope$19073,form$19074,$19070$19075){var t0$19080;var t1$19081;var x$19263;var args$19258;var $19239$19249;var $19240$19250;var t0$19247;var $19238$19242;var tags$19087;var parse$19088;var descr$19077;var contents$19078;(t0$19080=$19070$19075);if(((t0$19080 instanceof Array)&&((t1$19081=t0$19080.length),((t1$19081===3)&&(t0$19080[0]==="data"))))){(descr$19077=t0$19080[1]);(contents$19078=t0$19080[2]);;}else{$20478($19070$19075);}(tags$19087=["data"]);;(parse$19088=function($19094$19096){var t0$19115;var t0$19172;var t0$19176;var t0$19190;var t0$19194;var t0$19207;var t0$19211;var t0$19227;var t0$19231;var args$19224;var expr$19217;var rest$19218;var prop$19200;var value$19201;var x$19182;var x$19162;var x$19157;var s$19152;var $19103$19136;var $19104$19137;var $19105$19138;var $19106$19139;var $19107$19140;var $19108$19141;var $19109$19142;var $19110$19143;var $19111$19144;var t0$19124;var t1$19125;var t2$19126;var t3$19127;var t4$19128;var t5$19129;var t6$19130;var bridge$19099$19131;var bridge$19100$19132;var bridge$19101$19133;var bridge$19102$19134;var $19098$19119;var ph$19112;var toparse$19113;(t0$19115=$19094$19096);(toparse$19113=t0$19115);(ph$19112=t0$19115);;($19098$19119=ph$19112);;if((($19103$19136=($19098$19119 instanceof Array))&&((t0$19124=$19098$19119.length),((t0$19124===1)&&($19098$19119[0]==="void"))))){return null;}else{if(($19103$19136&&(($19105$19138=(t0$19124===2))&&($19098$19119[0]==="symbol")))){(s$19152=$19098$19119[1]);return tags$19087.push(["value",("+"+s$19152)]);}else{if(($19105$19138&&($19098$19119[0]==="value"))){(x$19157=$19098$19119[1]);return tags$19087.push(["value",("+"+x$19157)]);}else{if(($19103$19136&&(($19105$19138=(t0$19124===3))&&(($19106$19139=($19098$19119[0]==="send"))&&((t1$19125=$19098$19119[1]),(($19108$19141=(t1$19125 instanceof Array))&&((t2$19126=t1$19125.length),(($19110$19143=(t2$19126===2))&&(($19111$19144=(t1$19125[0]==="symbol"))&&((t1$19125[1]===".")&&((t3$19127=$19098$19119[2]),((t3$19127 instanceof Array)&&((t4$19128=t3$19127.length),((t4$19128===3)&&((t3$19127[0]==="data")&&((t5$19129=t3$19127[1]),((t5$19129 instanceof Array)&&((t6$19130=t5$19129.length),((t6$19130===1)&&((t5$19129[0]==="void")&&((bridge$19099$19131=t3$19127[2]),(((bridge$19099$19131 instanceof Array)&&((t0$19172=bridge$19099$19131.length),((t0$19172===2)&&((bridge$19099$19131[0]==="symbol")&&((x$19162=bridge$19099$19131[1]),true)))))||((bridge$19099$19131 instanceof Array)&&((t0$19176=bridge$19099$19131.length),((t0$19176===2)&&((bridge$19099$19131[0]==="value")&&((x$19162=bridge$19099$19131[1]),true))))))))))))))))))))))))))){return tags$19087.push(["value",x$19162]);}else{if(($19111$19144&&((t1$19125[1]==="#")&&((t3$19127=$19098$19119[2]),((t3$19127 instanceof Array)&&((t4$19128=t3$19127.length),((t4$19128===3)&&((t3$19127[0]==="data")&&((t5$19129=t3$19127[1]),((t5$19129 instanceof Array)&&((t6$19130=t5$19129.length),((t6$19130===1)&&((t5$19129[0]==="void")&&((bridge$19100$19132=t3$19127[2]),(((bridge$19100$19132 instanceof Array)&&((t0$19190=bridge$19100$19132.length),((t0$19190===2)&&((bridge$19100$19132[0]==="symbol")&&((x$19182=bridge$19100$19132[1]),true)))))||((bridge$19100$19132 instanceof Array)&&((t0$19194=bridge$19100$19132.length),((t0$19194===2)&&((bridge$19100$19132[0]==="value")&&((x$19182=bridge$19100$19132[1]),true)))))))))))))))))))){return tags$19087.push(["value",("#"+x$19182)]);}else{if(($19111$19144&&((t1$19125[1]==="=")&&((t3$19127=$19098$19119[2]),((t3$19127 instanceof Array)&&((t4$19128=t3$19127.length),((t4$19128===3)&&((t3$19127[0]==="data")&&((bridge$19101$19133=t3$19127[1]),(((bridge$19101$19133 instanceof Array)&&((t0$19207=bridge$19101$19133.length),((t0$19207===2)&&((bridge$19101$19133[0]==="symbol")&&((prop$19200=bridge$19101$19133[1]),true)))))||((bridge$19101$19133 instanceof Array)&&((t0$19211=bridge$19101$19133.length),((t0$19211===2)&&((bridge$19101$19133[0]==="value")&&((prop$19200=bridge$19101$19133[1]),true))))))))))))))){(value$19201=t3$19127[2]);return tags$19087.push(["send",["send",["symbol","#"],["data",["void"],["symbol","assoc"]]],["data",["value",prop$19200],value$19201]]);}else{if($19106$19139){(expr$19217=$19098$19119[1]);(rest$19218=$19098$19119[2]);parse$19088(expr$19217);return parse$19088(rest$19218);}else{(bridge$19102$19134=$19098$19119);if((((bridge$19102$19134 instanceof Array)&&((t0$19227=bridge$19102$19134.length),((t0$19227>=1)&&((bridge$19102$19134[0]==="multi")&&((args$19224=Array.prototype.slice.call(bridge$19102$19134,1)),true)))))||((bridge$19102$19134 instanceof Array)&&((t0$19231=bridge$19102$19134.length),((t0$19231>=1)&&((bridge$19102$19134[0]==="data")&&((args$19224=Array.prototype.slice.call(bridge$19102$19134,1)),true))))))){return args$19224.forEach(parse$19088);}else{$20478($19098$19119);}}}}}}}}});;parse$19088(descr$19077);(contents$19078=((($19238$19242=contents$19078)),function(){if((($19239$19249=($19238$19242 instanceof Array))&&((t0$19247=$19238$19242.length),((t0$19247===1)&&($19238$19242[0]==="void"))))){return ["data"];}else{if(($19239$19249&&((t0$19247>=1)&&($19238$19242[0]==="multi")))){(args$19258=Array.prototype.slice.call($19238$19242,1));return ["data"].concat(args$19258);}else{(x$19263=$19238$19242);return x$19263;}}}()));return ["send",["symbol","Node"],["data",tags$19087,contents$19078]];}),accum$19067)),((accum$19266=({})),((accum$19266["globals"]=function(context$19271,scope$19272,form$19273,$19269$19274){var t0$19278;var t1$19279;var t2$19280;var t3$19281;var t4$19282;var $index$19309;var $length$19304;var temp$19299;var acc$19294;var vars$19276;(t0$19278=$19269$19274);if(((t0$19278 instanceof Array)&&((t1$19279=t0$19278.length),((t1$19279===2)&&((t0$19278[0]==="data")&&((t2$19280=$20563(["multi"])(t0$19278[1])),(t2$19280[0]&&((t3$19281=t2$19280[1]),((t4$19282=t3$19281.length),(t4$19282>=0)))))))))){(vars$19276=Array.prototype.slice.call(t3$19281,0));;}else{$20478($19269$19274);}return ["splice"].concat((((acc$19294=[])),(((temp$19299=vars$19276)),((($length$19304=temp$19299.length)),((($index$19309=0)),function(){$19291:for(;($index$19309<$length$19304);($index$19309++)){var var$19327;var s$19328;var t0$19322;var t1$19323;var m$19317;(m$19317=temp$19299[$index$19309]);;(t0$19322=m$19317);(var$19327=t0$19322);if(((t0$19322 instanceof Array)&&((t1$19323=t0$19322.length),((t1$19323===2)&&(t0$19322[0]==="symbol"))))){(s$19328=t0$19322[1]);acc$19294.push(["declare_raw",var$19327,["variable",s$19328]]);}else{$20478(m$19317,"/home/olivier/git/earl-grey/src/stdenv.eg",28161,28238);;}}}()))),acc$19294));}),accum$19266))))))))))))))))))))))))))))))))))))))))))))))));;($length$19336=temp$15280.length);;($index$19341=0);;$14212:for(;($index$19341<$length$19336);($index$19341++)){var k$19359;var v$19360;var t0$19354;var t1$19355;var m$19349;(m$19349=temp$15280[$index$19341]);;(t0$19354=m$19349);if(((t0$19354 instanceof Array)&&((t1$19355=t0$19354.length),(t1$19355===2)))){(k$19359=t0$19354[0]);(v$19360=t0$19354[1]);stdenv$14179.bind(topscope$14183,k$19359,["macro",v$19360]);}else{$20478(m$19349,"/home/olivier/git/earl-grey/src/stdenv.eg",7379,7444);;}}(blocktest_wrap$14202=function(expr$19369){return ["multi",["send",["symbol","="],["data",["symbol","value"],["send",["symbol","!!"],["data",["multi",["send",["symbol","match"],["data",expr$19369,["multi",["send",["symbol","->"],["data",["send",["send",["symbol","?"],["data",["symbol","true"],["void"]]],["symbol","x"]],["send",["send",["symbol","#"],["data",["void"],["symbol","success"]]],["data",["symbol","x"]]]]],["send",["symbol","->"],["data",["send",["send",["symbol","?"],["data",["symbol","false"],["void"]]],["symbol","x"]],["send",["send",["symbol","#"],["data",["void"],["symbol","failure"]]],["data",["symbol","x"]]]]]]]]],["send",["symbol","->"],["data",["symbol","e"],["send",["send",["symbol","#"],["data",["void"],["symbol","error"]]],["data",["symbol","e"]]]]]]]]],["send",["send",["symbol","acc"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",["send",["send",["symbol","#"],["data",["void"],["symbol","test_result"]]],["data",["symbol","label"],["symbol","value"]]]]]];});;(blocktest_mac$14203=function(scope$19375,tests$19376){var $index$19412;var $length$19407;var temp$19402;var acc$19397;var exptests$19379;var n$19380;var stmts$19381;(exptests$19379=$20456(scope$19375.step_all(["test"],tests$19376)));;(n$19380=exptests$19379.length);;(stmts$19381=(((acc$19397=[])),(((temp$19402=exptests$19379)),((($length$19407=temp$19402.length)),((($index$19412=0)),function(){$19390:for(;($index$19412<$length$19407);($index$19412++)){var wrap$19468;var fall$19469;var lbl$19490;var i$19485;var expr$19486;var i$19456;var elements$19457;var clauses$19458;var env$19459;var i$19446;var more_labels$19447;var more_tests$19448;var i$19436;var stmt$19437;var $19392$19430;var $19393$19431;var $19394$19432;var $19395$19433;var t0$19425;var t1$19426;var t2$19427;var t3$19428;var m$19420;(m$19420=temp$19402[$index$19412]);;(t0$19425=m$19420);if((($19393$19431=(t0$19425 instanceof Array))&&((t1$19426=t0$19425.length),(($19395$19433=(t1$19426===2))&&((i$19436=t0$19425[0]),((t2$19427=t0$19425[1]),((t2$19427 instanceof Array)&&((t3$19428=t2$19427.length),((t3$19428===2)&&(t2$19427[0]==="do")))))))))){(stmt$19437=t2$19427[1]);acc$19397.push(stmt$19437);}else{if(($19395$19433&&((i$19446=t0$19425[0]),((t2$19427=t0$19425[1]),((t2$19427 instanceof Array)&&((t3$19428=t2$19427.length),((t3$19428===3)&&(t2$19427[0]==="blocktest")))))))){(more_labels$19447=t2$19427[1]);(more_tests$19448=t2$19427[2]);acc$19397.push(["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","label"],["send",["send",["symbol","label"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",["send",["send",["symbol","!"],["data",["symbol","Array"],["void"]]],more_labels$19447]]]]],["send",["symbol",":="],["data",["symbol","acc"],["send",["send",["symbol","acc"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",blocktest_mac$14203(scope$19375,more_tests$19448)]]]]]]);}else{if(($19395$19433&&((i$19456=t0$19425[0]),((t2$19427=t0$19425[1]),((t2$19427 instanceof Array)&&((t3$19428=t2$19427.length),((t3$19428===3)&&((t2$19427[0]==="test_factory")&&((elements$19457=t2$19427[1]),((clauses$19458=t2$19427[2]),$20264(t2$19427,"env"))))))))))){(env$19459=t2$19427.env);acc$19397.push((((wrap$19468=function(expr$19473,index$19474){return ["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","label"],["send",["send",["symbol","label"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",["data",index$19474]]]]],blocktest_wrap$14202(expr$19473)]];})),((fall$19469=function(target$19480){return match_error$14186(target$19480);})),build_loop$14199(scope$19375,env$19459,["void"],elements$19457,clauses$19458,wrap$19468,["splice"],["splice"],({"fallback":fall$19469}))));}else{if($19395$19433){(i$19485=t0$19425[0]);(expr$19486=t0$19425[1]);acc$19397.push((((lbl$19490=function(){if((n$19380===1)){return ["data"];}else{return ["data",["value",i$19485]];}}())),["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","label"],["send",["send",["symbol","label"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",lbl$19490]]]],blocktest_wrap$14202(expr$19486)]]));}else{$20478(m$19420,"/home/olivier/git/earl-grey/src/stdenv.eg",28575,29381);;}}}}}}()))),acc$19397));;return ["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","acc"],["data"]]],["send",["symbol","!!"],["data",["multi"].concat(stmts$19381).concat([["symbol","acc"]]),["send",["symbol","->"],["data",["symbol","e"],["send",["send",["symbol","acc"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",["data",["send",["send",["symbol","#"],["data",["void"],["symbol","error"]]],["data",["symbol","label"],["symbol","e"]]]]]]]]]]]];});;stdenv$14179.bind(topscope$14183,"blocktest",["macro",function(context$19500,scope$19501,form$19502,$19498$19503){var t0$19510;var t1$19511;var labels$19540;var tests$19541;var tests$19531;var $19506$19527;var $19507$19528;var t0$19522;var t1$19523;var t2$19524;var t3$19525;var $19505$19517;var args$19508;(t0$19510=$19498$19503);if(((t0$19510 instanceof Array)&&((t1$19511=t0$19510.length),((t1$19511>=1)&&(t0$19510[0]==="data"))))){(args$19508=Array.prototype.slice.call(t0$19510,1));;}else{$20478($19498$19503);}($19505$19517=args$19508);;if((($19506$19527=($19505$19517 instanceof Array))&&((t0$19522=$19505$19517.length),((t0$19522===1)&&((t1$19523=$20563(["multi"])($19505$19517[0])),(t1$19523[0]&&((t2$19524=t1$19523[1]),((t3$19525=t2$19524.length),(t3$19525>=0))))))))){(tests$19531=Array.prototype.slice.call(t2$19524,0));return ["multi",["send",["symbol","="],["data",["symbol","label"],["data"]]],blocktest_mac$14203(scope$19501,tests$19531)];}else{if(($19506$19527&&((t0$19522===2)&&((labels$19540=$19505$19517[0]),((t1$19523=$20563(["multi"])($19505$19517[1])),(t1$19523[0]&&((t2$19524=t1$19523[1]),((t3$19525=t2$19524.length),(t3$19525>=0))))))))){(tests$19541=Array.prototype.slice.call(t2$19524,0));return ["multi",["send",["symbol","="],["data",["symbol","label"],["send",["send",["symbol","!"],["data",["symbol","Array"],["void"]]],labels$19540]]],blocktest_mac$14203(scope$19501,tests$19541)];}else{$20478($19505$19517);}}}]);(qqstruct$14204=function(name$19553,args$19554){return ["data",["value",name$19553]].concat(args$19554);});;(qq$14205=function($19559$19561){var t0$19576;var $index$19670;var $length$19665;var temp$19660;var acc$19655;var name$19648;var args$19649;var insert$19639;var insert$19630;var insert$19619;var v$19614;var s$19604;var $19564$19593;var $19565$19594;var $19566$19595;var $19567$19596;var $19568$19597;var $19569$19598;var $19570$19599;var $19571$19600;var $19572$19601;var t0$19585;var t1$19586;var t2$19587;var t3$19588;var t4$19589;var t5$19590;var t6$19591;var $19563$19580;var ph$19573;var expr$19574;(t0$19576=$19559$19561);(expr$19574=t0$19576);(ph$19573=t0$19576);;($19563$19580=ph$19573);;if((($19564$19593=($19563$19580 instanceof Array))&&((t0$19585=$19563$19580.length),((t0$19585===2)&&($19563$19580[0]==="symbol"))))){(s$19604=$19563$19580[1]);return qqstruct$14204("symbol",[["value",s$19604]]);}else{if(($19564$19593&&((t0$19585===1)&&($19563$19580[0]==="void")))){return qqstruct$14204("void",[]);}else{if(($19564$19593&&((t0$19585===2)&&($19563$19580[0]==="value")))){(v$19614=$19563$19580[1]);return qqstruct$14204("value",[expr$19574]);}else{if(($19564$19593&&(($19566$19595=(t0$19585===3))&&(($19567$19596=($19563$19580[0]==="send"))&&((t1$19586=$19563$19580[1]),(($19569$19598=(t1$19586 instanceof Array))&&((t2$19587=t1$19586.length),(($19571$19600=(t2$19587===2))&&(($19572$19601=(t1$19586[0]==="symbol"))&&((t1$19586[1]==="^")&&((t3$19588=$19563$19580[2]),((t3$19588 instanceof Array)&&((t4$19589=t3$19588.length),((t4$19589===3)&&((t3$19588[0]==="data")&&((t5$19590=t3$19588[1]),((t5$19590 instanceof Array)&&((t6$19591=t5$19590.length),((t6$19591===1)&&(t5$19590[0]==="void")))))))))))))))))))){(insert$19619=t3$19588[2]);return insert$19619;}else{if(($19572$19601&&((t1$19586[1]==="^=")&&((t3$19588=$19563$19580[2]),((t3$19588 instanceof Array)&&((t4$19589=t3$19588.length),((t4$19589===3)&&((t3$19588[0]==="data")&&((t5$19590=t3$19588[1]),((t5$19590 instanceof Array)&&((t6$19591=t5$19590.length),((t6$19591===1)&&(t5$19590[0]==="void"))))))))))))){(insert$19630=t3$19588[2]);return qqstruct$14204("value",[insert$19630]);}else{if(($19572$19601&&((t1$19586[1]==="^*")&&((t3$19588=$19563$19580[2]),((t3$19588 instanceof Array)&&((t4$19589=t3$19588.length),((t4$19589===3)&&((t3$19588[0]==="data")&&((t5$19590=t3$19588[1]),((t5$19590 instanceof Array)&&((t6$19591=t5$19590.length),((t6$19591===1)&&(t5$19590[0]==="void"))))))))))))){(insert$19639=t3$19588[2]);return ["send",["symbol","*"],["data",["void"],insert$19639]];}else{if(($19564$19593&&(t0$19585>=1))){(name$19648=$19563$19580[0]);(args$19649=Array.prototype.slice.call($19563$19580,1));return qqstruct$14204(name$19648,(((acc$19655=[])),(((temp$19660=args$19649)),((($length$19665=temp$19660.length)),((($index$19670=0)),function(){$19652:for(;($index$19670<$length$19665);($index$19670++)){var arg$19686;var m$19678;(m$19678=temp$19660[$index$19670]);;(arg$19686=m$19678);acc$19655.push(qq$14205(arg$19686));}}()))),acc$19655));}else{$20478($19563$19580);}}}}}}}});;stdenv$14179.bind(topscope$14183,"'",["macro",function(context$19693,scope$19694,form$19695,$19691$19696){var t0$19700;var t1$19701;var t2$19702;var t3$19703;var expr$19698;(t0$19700=$19691$19696);if(((t0$19700 instanceof Array)&&((t1$19701=t0$19700.length),((t1$19701===3)&&((t0$19700[0]==="data")&&((t2$19702=t0$19700[1]),((t2$19702 instanceof Array)&&((t3$19703=t2$19702.length),((t3$19703===1)&&(t2$19702[0]==="void")))))))))){(expr$19698=t0$19700[2]);;}else{$20478($19691$19696);}return qq$14205(expr$19698);}]);(RegexBuilder$14206=function(){var it$0$19715;(it$0$19715=function(){if((!$14105(RegexBuilder$14206)(this))){return Object.create(RegexBuilder$14206.prototype);}else{return this;}}());;;return it$0$19715;});;(RegexBuilder$14206.prototype["wrap"]=function(x$19725){var it$0$19728;(it$0$19728=this);;return (("(?:"+x$19725)+")");});(RegexBuilder$14206.prototype["quote"]=function(x$19735){var it$0$19738;(it$0$19738=this);;return x$19735.replace(RegExp("([.?*+\\^$\\[\\]\\(\\)\\{\\}|\\\\])","g"),"\\$1");});(RegexBuilder$14206.prototype["quote_charset"]=function(x$19745){var it$0$19748;(it$0$19748=this);;return x$19745.replace(RegExp("([\\[\\]\\(\\)\\{\\}\\^])","g"),"\\$1");});(RegexBuilder$14206.prototype["build"]=function(expr$19755){var t0$19897;var t1$19898;var t0$19909;var t1$19910;var t0$19921;var t1$19922;var t0$19934;var t1$19935;var t0$19941;var t1$19942;var x$19948;var v$19932;var t0$19959;var t1$19960;var t0$19966;var t1$19967;var t2$19968;var t3$19969;var t4$19970;var t5$19971;var t6$19972;var t7$19973;var t8$19974;var t9$19975;var x$19989;var v$19957;var $index$20026;var $length$20021;var temp$20016;var acc$20011;var $index$20075;var $length$20070;var temp$20065;var acc$20060;var other$20095;var args$20046;var args$19997;var a$19873;var b$19874;var $19760$19875;var s$19864;var x$19859;var $19759$19797;var $19761$19786;var $19762$19787;var $19763$19788;var $19764$19789;var $19765$19790;var $19766$19791;var $19767$19792;var $19768$19793;var $19769$19794;var t0$19780;var t1$19781;var t2$19782;var t3$19783;var t4$19784;var $19758$19775;var it$0$19770;(it$0$19770=this);;($19758$19775=expr$19755);;if((($19761$19786=($19758$19775 instanceof Array))&&((t0$19780=$19758$19775.length),(($19763$19788=(t0$19780===2))&&($19758$19775[0]==="symbol"))))){($19759$19797=$19758$19775[1]);if(($19759$19797==="any")){return ".";}else{if(($19759$19797==="start")){return "^";}else{if(($19759$19797==="end")){return "$";}else{if(($19759$19797==="alpha")){return "\\a";}else{if(($19759$19797==="digit")){return "\\d";}else{if(($19759$19797==="word")){return "\\w";}else{if(($19759$19797==="space")){return "\\s";}else{if(($19759$19797==="boundary")){return "\\b";}else{if(($19759$19797==="a")){return "\\a";}else{if(($19759$19797==="d")){return "\\d";}else{if(($19759$19797==="w")){return "\\w";}else{if(($19759$19797==="s")){return "\\s";}else{if(($19759$19797==="b")){return "\\b";}else{$20478($19759$19797,"/home/olivier/git/earl-grey/src/stdenv.eg",30675,30680);}}}}}}}}}}}}}}else{if(($19763$19788&&($19758$19775[0]==="value"))){(x$19859=$19758$19775[1]);return it$0$19770.quote(x$19859);}else{if(($19761$19786&&(($19763$19788=(t0$19780===3))&&(($19764$19789=($19758$19775[0]==="send"))&&((t1$19781=$19758$19775[1]),(($19766$19791=(t1$19781 instanceof Array))&&((t2$19782=t1$19781.length),(($19768$19793=(t2$19782===2))&&(($19769$19794=(t1$19781[0]==="symbol"))&&((t1$19781[1]==="raw")&&((t3$19783=$19758$19775[2]),((t3$19783 instanceof Array)&&((t4$19784=t3$19783.length),((t4$19784===2)&&(t3$19783[0]==="value"))))))))))))))){(s$19864=t3$19783[1]);return s$19864;}else{if(($19769$19794&&(($19760$19875=t1$19781[1]),((t3$19783=$19758$19775[2]),((t3$19783 instanceof Array)&&((t4$19784=t3$19783.length),((t4$19784===3)&&(t3$19783[0]==="data")))))))){(a$19873=t3$19783[1]);(b$19874=t3$19783[2]);if(($19760$19875==="||")){return it$0$19770.wrap(((it$0$19770.build(a$19873)+"|")+it$0$19770.build(b$19874)));}else{if(($19760$19875==="or")){return it$0$19770.wrap(((it$0$19770.build(a$19873)+"|")+it$0$19770.build(b$19874)));}else{if(($19760$19875==="*")){(t0$19897=a$19873);if(((t0$19897 instanceof Array)&&((t1$19898=t0$19897.length),((t1$19898===1)&&(t0$19897[0]==="void"))))){;}else{$20478(a$19873,"/home/olivier/git/earl-grey/src/stdenv.eg",31347,31348);}return it$0$19770.wrap((it$0$19770.build(b$19874)+"*"));}else{if(($19760$19875==="+")){(t0$19909=a$19873);if(((t0$19909 instanceof Array)&&((t1$19910=t0$19909.length),((t1$19910===1)&&(t0$19909[0]==="void"))))){;}else{$20478(a$19873,"/home/olivier/git/earl-grey/src/stdenv.eg",31431,31432);}return it$0$19770.wrap((it$0$19770.build(b$19874)+"+"));}else{if(($19760$19875==="?")){(t0$19921=a$19873);if(((t0$19921 instanceof Array)&&((t1$19922=t0$19921.length),((t1$19922===1)&&(t0$19921[0]==="void"))))){;}else{$20478(a$19873,"/home/olivier/git/earl-grey/src/stdenv.eg",31515,31516);}return it$0$19770.wrap((it$0$19770.build(b$19874)+"?"));}else{if(($19760$19875==="in")){(t0$19934=a$19873);if(((t0$19934 instanceof Array)&&((t1$19935=t0$19934.length),((t1$19935===1)&&(t0$19934[0]==="void"))))){;}else{$20478(a$19873,"/home/olivier/git/earl-grey/src/stdenv.eg",31600,31601);}(t0$19941=b$19874);if(((t0$19941 instanceof Array)&&((t1$19942=t0$19941.length),((t1$19942===2)&&(t0$19941[0]==="value"))))){(v$19932=t0$19941[1]);;}else{$20478(b$19874,"/home/olivier/git/earl-grey/src/stdenv.eg",31629,31630);}(x$19948=it$0$19770.quote_charset(v$19932));;return (("["+x$19948)+"]");}else{if(($19760$19875==="not")){(t0$19959=a$19873);if(((t0$19959 instanceof Array)&&((t1$19960=t0$19959.length),((t1$19960===1)&&(t0$19959[0]==="void"))))){;}else{$20478(a$19873,"/home/olivier/git/earl-grey/src/stdenv.eg",31754,31755);}(t0$19966=b$19874);if(((t0$19966 instanceof Array)&&((t1$19967=t0$19966.length),((t1$19967===3)&&((t0$19966[0]==="send")&&((t2$19968=t0$19966[1]),((t2$19968 instanceof Array)&&((t3$19969=t2$19968.length),((t3$19969===2)&&((t2$19968[0]==="symbol")&&((t2$19968[1]==="in")&&((t4$19970=t0$19966[2]),((t4$19970 instanceof Array)&&((t5$19971=t4$19970.length),((t5$19971===3)&&((t4$19970[0]==="data")&&((t6$19972=t4$19970[1]),((t6$19972 instanceof Array)&&((t7$19973=t6$19972.length),((t7$19973===1)&&((t6$19972[0]==="void")&&((t8$19974=t4$19970[2]),((t8$19974 instanceof Array)&&((t9$19975=t8$19974.length),((t9$19975===2)&&(t8$19974[0]==="value")))))))))))))))))))))))))){(v$19957=t8$19974[1]);;}else{$20478(b$19874,"/home/olivier/git/earl-grey/src/stdenv.eg",31821,31822);}(x$19989=it$0$19770.quote_charset(v$19957));;return (("[^"+x$19989)+"]");}else{$20478($19760$19875,"/home/olivier/git/earl-grey/src/stdenv.eg",31139,31144);}}}}}}}}else{if(($19761$19786&&(($19763$19788=(t0$19780>=1))&&($19758$19775[0]==="data")))){(args$19997=Array.prototype.slice.call($19758$19775,1));return (("("+(((acc$20011=[])),(((temp$20016=args$19997)),((($length$20021=temp$20016.length)),((($index$20026=0)),function(){$20008:for(;($index$20026<$length$20021);($index$20026++)){var arg$20042;var m$20034;(m$20034=temp$20016[$index$20026]);;(arg$20042=m$20034);acc$20011.push(it$0$19770.build(arg$20042));}}()))),acc$20011).join(""))+")");}else{if(($19763$19788&&($19758$19775[0]==="multi"))){(args$20046=Array.prototype.slice.call($19758$19775,1));return (("(?:"+(((acc$20060=[])),(((temp$20065=args$20046)),((($length$20070=temp$20065.length)),((($index$20075=0)),function(){$20057:for(;($index$20075<$length$20070);($index$20075++)){var arg$20091;var m$20083;(m$20083=temp$20065[$index$20075]);;(arg$20091=m$20083);acc$20060.push(it$0$19770.build(arg$20091));}}()))),acc$20060).join(""))+")");}else{(other$20095=$19758$19775);return $20302(["syntax","regexp"]).create("Illegal regular expression",({"expr":expr$19755}));}}}}}}});$20252(RegexBuilder$14206,$20252(((accum$20098=({})),((accum$20098["::name"]="RegexBuilder"),accum$20098)),((accum$20102=({})),((accum$20102["::egclass"]=true),accum$20102))));RegexBuilder$14206;(build_regexp$14207=function(x$20108){return RegexBuilder$14206().build(x$20108);});;(mac$20112=function(context$20117,scope$20118,form$20119,$20115$20120,flags$20121){var arg$20155;var v$20148;var $20124$20144;var $20125$20145;var t0$20136;var t1$20137;var t2$20138;var t3$20139;var t4$20140;var t5$20141;var t6$20142;var $20123$20131;var ph$20126;(ph$20126=$20115$20120);;($20123$20131=ph$20126);;if((($20124$20144=($20123$20131 instanceof Array))&&((t0$20136=$20123$20131.length),((t0$20136===2)&&(($20123$20131[0]==="value")&&((t1$20137=$20123$20131[1]),(typeof(t1$20137)==="string"))))))){(v$20148=t1$20137);return ["send",["symbol","RegExp"],["data",["value",v$20148],["value",flags$20121.join("")]]];}else{if(($20124$20144&&((t0$20136===3)&&(($20123$20131[0]==="send")&&((t1$20137=$20123$20131[1]),((t1$20137 instanceof Array)&&((t2$20138=t1$20137.length),((t2$20138===2)&&((t1$20137[0]==="symbol")&&((t1$20137[1]==="'")&&((t3$20139=$20123$20131[2]),((t3$20139 instanceof Array)&&((t4$20140=t3$20139.length),((t4$20140===3)&&((t3$20139[0]==="data")&&((t5$20141=t3$20139[1]),((t5$20141 instanceof Array)&&((t6$20142=t5$20141.length),((t6$20142===1)&&(t5$20141[0]==="void")))))))))))))))))))){(arg$20155=t3$20139[2]);return ["send",["symbol","RegExp"],["data",["value",build_regexp$14207(arg$20155)],["value",flags$20121.join("")]]];}else{$20478($20123$20131);}}});;stdenv$14179.bind(topscope$14183,"R",["macro",accum_flags$14195(mac$20112,false)]);(errf_macro$14208=function(tags$20170){return function(context$20174,scope$20175,form$20176,$20172$20177){var other$20208;var args$20203;var $20180$20194;var $20181$20195;var t0$20192;var $20179$20187;var ph$20182;(ph$20182=$20172$20177);;($20179$20187=ph$20182);;if((($20180$20194=($20179$20187 instanceof Array))&&((t0$20192=$20179$20187.length),((t0$20192===1)&&($20179$20187[0]==="void"))))){return ["send",["symbol","ErrorFactory"],["data",["data"].concat(tags$20170)]];}else{if(($20180$20194&&((t0$20192>=1)&&($20179$20187[0]==="data")))){(args$20203=Array.prototype.slice.call($20179$20187,1));return ["send",["send",["send",["symbol","ErrorFactory"],["data",["data"].concat(tags$20170)]],["send",["symbol","."],["data",["void"],["symbol","create"]]]],["data"].concat(args$20203)];}else{(other$20208=$20179$20187);return ["macro",errf_macro$14208(tags$20170.concat([other$20208]))];}}};});;stdenv$14179.bind(topscope$14183,"E",["macro",errf_macro$14208([])]);(temp$20213=$20595(({"___build_array":Embedded$14178(["send",["symbol","->"],["data",["data",["symbol","arrays"]],["multi",["send",["symbol","="],["data",["symbol","results"],["data"]]],["send",["symbol","each"],["data",["symbol","arrays"],["send",["symbol","->"],["data",["symbol","a"],["send",["symbol",":="],["data",["symbol","results"],["send",["send",["symbol","results"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",["symbol","a"]]]]]]]]],["symbol","results"]]]]),"object":Embedded$14178(["send",["symbol","->"],["data",["data",["symbol","pairs"]],["multi",["send",["symbol","="],["data",["symbol","rval"],["data",["symbol","="]]]],["send",["symbol","each"],["data",["symbol","pairs"],["send",["symbol","->"],["data",["data",["symbol","k"],["symbol","v"]],["send",["symbol",":="],["data",["send",["symbol","rval"],["symbol","k"]],["symbol","v"]]]]]]],["symbol","rval"]]]]),"items":Embedded$14178(["send",["symbol","->"],["data",["data",["symbol","obj"]],["multi",["send",["symbol","="],["data",["symbol","results"],["data"]]],["send",["symbol","for"],["data",["send",["symbol","in"],["data",["symbol","k"],["symbol","obj"]]],["send",["symbol","if"],["data",["send",["send",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","hasOwnProperty"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","obj"],["symbol","k"]]],["send",["send",["symbol","results"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",["data",["symbol","k"],["send",["symbol","obj"],["symbol","k"]]]]]]]]],["symbol","results"]]]]),"keys":Embedded$14178(["send",["symbol","->"],["data",["data",["symbol","obj"]],["multi",["send",["symbol","="],["data",["symbol","results"],["data"]]],["send",["symbol","for"],["data",["send",["symbol","in"],["data",["symbol","k"],["symbol","obj"]]],["send",["symbol","if"],["data",["send",["send",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","hasOwnProperty"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","obj"],["symbol","k"]]],["send",["send",["symbol","results"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",["symbol","k"]]]]]]],["symbol","results"]]]]),"enumerate":Embedded$14178(["send",["symbol","->"],["data",["data",["symbol","arr"]],["multi",["send",["symbol","="],["data",["symbol","results"],["data"]]],["send",["symbol","="],["data",["symbol","l"],["send",["symbol","arr"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]],["send",["symbol","for"],["data",["multi",["send",["symbol","="],["data",["symbol","i"],["value",0]]],["send",["symbol","<"],["data",["symbol","i"],["symbol","l"]]],["send",["symbol","++"],["data",["symbol","i"],["void"]]]],["send",["send",["symbol","results"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",["data",["symbol","i"],["send",["symbol","arr"],["symbol","i"]]]]]]],["symbol","results"]]]]),"zip":Embedded$14178(["send",["symbol","->"],["data",["data",["symbol","xs"],["symbol","ys"]],["send",["symbol","each"],["data",["send",["symbol","enumerate"],["data",["symbol","xs"]]],["send",["symbol","->"],["data",["data",["symbol","i"],["symbol","x"]],["data",["symbol","x"],["send",["symbol","ys"],["symbol","i"]]]]]]]]]),"predicate":Embedded$14178(["send",["symbol","->"],["data",["data",["symbol","f"]],["multi",["send",["symbol",":="],["data",["send",["symbol","f"],["value","::check"]],["symbol","f"]]],["symbol","f"]]]]),"___nequal":Embedded$14178(["send",["symbol","->"],["data",["data",["symbol","x"],["symbol","y"]],["send",["symbol","not"],["data",["void"],["send",["symbol","=="],["data",["symbol","x"],["symbol","y"]]]]]]]),"___equal":Embedded$14178(["send",["symbol","->"],["data",["data",["send",["symbol","match"],["symbol","a"]],["symbol","b"]],["multi",["send",["symbol","->"],["data",["send",["symbol","==="],["data",["void"],["symbol","b"]]],["symbol","true"]]],["send",["symbol","->"],["data",["send",["symbol","or"],["data",["send",["symbol","or"],["data",["send",["symbol","or"],["data",["send",["symbol","?"],["data",["symbol","Number"],["void"]]],["send",["symbol","?"],["data",["symbol","String"],["void"]]]]],["send",["symbol","?"],["data",["symbol","null"],["void"]]]]],["send",["symbol","?"],["data",["symbol","undefined"],["void"]]]]],["symbol","false"]]],["send",["symbol","->"],["data",["send",["symbol","?"],["data",["symbol","Array"],["void"]]],["multi",["send",["symbol","if"],["data",["send",["symbol","or"],["data",["send",["symbol","not"],["data",["void"],["send",["send",["symbol","?"],["data",["symbol","Array"],["void"]]],["symbol","b"]]]],["send",["symbol","!=="],["data",["send",["symbol","a"],["send",["symbol","."],["data",["void"],["symbol","length"]]]],["send",["symbol","b"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]]]],["send",["symbol","return"],["symbol","false"]]]],["send",["symbol","for"],["data",["multi",["send",["symbol","="],["data",["symbol","i"],["value",0]]],["send",["symbol","<"],["data",["symbol","i"],["send",["symbol","a"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]],["send",["symbol","++"],["data",["symbol","i"],["void"]]]],["send",["symbol","if"],["data",["send",["symbol","not"],["data",["void"],["send",["symbol","=="],["data",["send",["symbol","___js_fetch"],["data",["symbol","a"],["symbol","i"]]],["send",["symbol","___js_fetch"],["data",["symbol","b"],["symbol","i"]]]]]]],["send",["symbol","return"],["symbol","false"]]]]]],["symbol","true"]]]],["send",["symbol","->"],["data",["send",["symbol","when"],["data",["void"],["send",["symbol","and"],["data",["send",["symbol","==="],["data",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","getPrototypeOf"]]]],["data",["symbol","a"]]],["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]],["send",["symbol","==="],["data",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","getPrototypeOf"]]]],["data",["symbol","b"]]],["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]]]]]],["multi",["send",["symbol","="],["data",["symbol","ka"],["send",["symbol","keys"],["data",["symbol","a"]]]]],["send",["symbol","if"],["data",["send",["symbol","not"],["data",["void"],["send",["symbol","=="],["data",["send",["send",["symbol","ka"],["send",["symbol","."],["data",["void"],["symbol","sort"]]]],["data"]],["send",["send",["send",["symbol","keys"],["data",["symbol","b"]]],["send",["symbol","."],["data",["void"],["symbol","sort"]]]],["data"]]]]]],["send",["symbol","return"],["symbol","false"]]]],["send",["symbol","each"],["data",["symbol","ka"],["send",["symbol","->"],["data",["symbol","k"],["send",["symbol","if"],["data",["send",["symbol","not"],["data",["void"],["send",["symbol","=="],["data",["send",["symbol","___js_fetch"],["data",["symbol","a"],["symbol","k"]]],["send",["symbol","___js_fetch"],["data",["symbol","b"],["symbol","k"]]]]]]],["send",["symbol","return"],["symbol","false"]]]]]]]],["symbol","true"]]]],["send",["symbol","->"],["data",["data",["send",["symbol","=>"],["data",["value","::serialize"],["symbol","_"]]]],["send",["symbol","match"],["data",["symbol","b"],["multi",["send",["symbol","->"],["data",["data",["send",["symbol","=>"],["data",["value","::serialize"],["symbol","_"]]]],["send",["symbol","=="],["data",["send",["send",["symbol","a"],["value","::serialize"]],["data"]],["send",["send",["symbol","b"],["value","::serialize"]],["data"]]]]]],["send",["symbol","->"],["data",["symbol","otherwise"],["symbol","false"]]]]]]]],["send",["symbol","->"],["data",["symbol","otherwise"],["symbol","false"]]]]]]),"&:":Embedded$14178(["send",["symbol","->"],["data",["data",["symbol","dest"],["symbol","values"]],["multi",["send",["symbol","for"],["data",["send",["symbol","in"],["data",["symbol","k"],["symbol","values"]]],["send",["symbol","if"],["data",["send",["send",["symbol","values"],["send",["symbol","."],["data",["void"],["symbol","hasOwnProperty"]]]],["data",["symbol","k"]]],["send",["symbol",":="],["data",["send",["symbol","dest"],["symbol","k"]],["send",["symbol","___js_fetch"],["data",["symbol","values"],["symbol","k"]]]]]]]]],["symbol","dest"]]]]),"&":Embedded$14178(["send",["symbol","->"],["data",["data",["symbol","a"],["symbol","b"]],["multi",["send",["symbol","="],["data",["symbol","dest"],["send",["symbol","clone"],["data",["symbol","a"]]]]],["send",["symbol","for"],["data",["send",["symbol","in"],["data",["symbol","k"],["symbol","b"]]],["send",["symbol","if"],["data",["send",["send",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","hasOwnProperty"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","b"],["symbol","k"]]],["send",["symbol",":="],["data",["send",["symbol","dest"],["symbol","k"]],["send",["symbol","___js_fetch"],["data",["symbol","b"],["symbol","k"]]]]]]]]],["symbol","dest"]]]]),"&+":Embedded$14178(["send",["symbol","->"],["data",["data",["symbol","a"],["symbol","b"]],["multi",["send",["symbol","="],["data",["symbol","dest"],["send",["symbol","clone"],["data",["symbol","a"]]]]],["send",["symbol","for"],["data",["send",["symbol","in"],["data",["symbol","k"],["symbol","b"]]],["send",["symbol","if"],["data",["send",["send",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","hasOwnProperty"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","b"],["symbol","k"]]],["send",["symbol",":="],["data",["send",["symbol","dest"],["symbol","k"]],["send",["symbol","___js_fetch"],["data",["symbol","b"],["symbol","k"]]]]]]]]],["symbol","dest"]]]]),"clone":Embedded$14178(["send",["symbol","->"],["data",["data",["send",["symbol","match"],["symbol","x"]]],["multi",["send",["symbol","->"],["data",["send",["symbol","or"],["data",["send",["symbol","or"],["data",["send",["symbol","or"],["data",["send",["symbol","?"],["data",["symbol","undefined"],["void"]]],["send",["symbol","?"],["data",["symbol","null"],["void"]]]]],["send",["symbol","?"],["data",["symbol","String"],["void"]]]]],["send",["symbol","?"],["data",["symbol","Number"],["void"]]]]],["symbol","x"]]],["send",["symbol","->"],["data",["data",["send",["symbol","=>"],["data",["value","::clone"],["symbol","_"]]]],["send",["send",["symbol","x"],["value","::clone"]],["data"]]]],["send",["symbol","->"],["data",["send",["symbol","when"],["data",["void"],["send",["symbol","==="],["data",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","getPrototypeOf"]]]],["data",["symbol","x"]]],["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]]]],["multi",["send",["symbol","="],["data",["symbol","dest"],["data",["symbol","="]]]],["send",["symbol","for"],["data",["send",["symbol","in"],["data",["symbol","k"],["symbol","x"]]],["send",["symbol","if"],["data",["send",["send",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","hasOwnProperty"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","x"],["symbol","k"]]],["send",["symbol",":="],["data",["send",["symbol","dest"],["symbol","k"]],["send",["symbol","___js_fetch"],["data",["symbol","x"],["symbol","k"]]]]]]]]],["symbol","dest"]]]],["send",["symbol","->"],["data",["symbol","other"],["send",["symbol","throw"],["send",["send",["symbol","E"],["send",["symbol","."],["data",["void"],["symbol","clone"]]]],["data",["value","Object cannot be cloned"],["data",["send",["symbol","="],["data",["symbol","obj"],["symbol","x"]]]]]]]]]]]]),"___checker":Embedded$14178(["send",["symbol","->"],["data",["data",["symbol","type"]],["multi",["send",["symbol","="],["data",["symbol","f"],["send",["symbol","type"],["value","::check"]]]],["send",["symbol","if"],["data",["send",["symbol","==="],["data",["symbol","f"],["symbol","undefined"]]],["multi",["send",["symbol","then"],["data",["send",["symbol","->"],["data",["data",["symbol","value"]],["send",["symbol","instanceof"],["data",["symbol","value"],["symbol","type"]]]]]]],["send",["symbol","else"],["data",["send",["symbol","->"],["data",["data",["symbol","value"]],["send",["send",["symbol","f"],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","type"],["symbol","value"]]]]]]]]]]]]]),"___projector":Embedded$14178(["send",["symbol","->"],["data",["data",["symbol","type"]],["send",["symbol","->"],["data",["data",["symbol","value"]],["multi",["send",["symbol","="],["data",["symbol","f"],["send",["symbol","type"],["value",":::project"]]]],["send",["symbol","if"],["data",["send",["symbol","==="],["data",["symbol","f"],["symbol","undefined"]]],["multi",["send",["symbol","then"],["data",["multi",["send",["symbol","="],["data",["symbol","f"],["send",["symbol","type"],["value","::project"]]]],["send",["symbol","if"],["data",["send",["symbol","==="],["data",["symbol","f"],["symbol","undefined"]]],["multi",["send",["symbol","then"],["data",["data",["symbol","true"],["send",["symbol","type"],["data",["symbol","value"]]]]]],["send",["symbol","else"],["data",["send",["symbol","!!"],["data",["data",["symbol","true"],["send",["symbol","f"],["data",["symbol","value"]]]],["send",["symbol","->"],["data",["symbol","e"],["data",["symbol","false"],["symbol","null"]]]]]]]]]]]]]],["send",["symbol","else"],["data",["send",["send",["symbol","f"],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","type"],["symbol","value"]]]]]]]]]]]]]),"___hasprop":Embedded$14178(["send",["symbol","->"],["data",["data",["symbol","match"],["symbol","key"]],["multi",["send",["symbol","->"],["data",["send",["symbol","or"],["data",["send",["symbol","?"],["data",["symbol","null"],["void"]]],["send",["symbol","?"],["data",["symbol","undefined"],["void"]]]]],["symbol","false"]]],["send",["symbol","->"],["data",["send",["send",["symbol","?"],["data",["symbol","String"],["void"]]],["symbol","x"]],["send",["symbol","in"],["data",["symbol","key"],["send",["symbol","String"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]]]],["send",["symbol","->"],["data",["send",["send",["symbol","?"],["data",["symbol","Number"],["void"]]],["symbol","x"]],["send",["symbol","in"],["data",["symbol","key"],["send",["symbol","Number"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]]]],["send",["symbol","->"],["data",["symbol","x"],["send",["symbol","in"],["data",["symbol","key"],["symbol","x"]]]]]]]]),"range":Embedded$14178(["send",["symbol","->"],["data",["data",["symbol","from"],["symbol","to"]],["multi",["send",["symbol","="],["data",["symbol","rval"],["data"]]],["send",["symbol","for"],["data",["multi",["send",["symbol","="],["data",["symbol","i"],["symbol","from"]]],["send",["symbol","<="],["data",["symbol","i"],["symbol","to"]]],["send",["symbol","++"],["data",["symbol","i"],["void"]]]],["send",["send",["symbol","rval"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",["symbol","i"]]]]],["symbol","rval"]]]]),"___serialize_ast":Embedded$14178(["send",["symbol","->"],["data",["data",["symbol","match"]],["multi",["send",["symbol","->"],["data",["send",["symbol","or"],["data",["send",["send",["symbol","?"],["data",["symbol","String"],["void"]]],["symbol","x"]],["send",["send",["symbol","?"],["data",["symbol","Number"],["void"]]],["symbol","x"]]]],["send",["send",["symbol","#"],["data",["void"],["symbol","value"]]],["data",["symbol","x"]]]]],["send",["symbol","->"],["data",["symbol","other"],["send",["send",["symbol","other"],["value","::serialize_ast"]],["data"]]]]]]]),"___match_error":Embedded$14178(["send",["symbol","->"],["data",["data",["symbol","value"],["symbol","url"],["symbol","start"],["symbol","end"]],["multi",["send",["symbol","="],["data",["symbol","err"],["send",["send",["symbol","E"],["send",["symbol","."],["data",["void"],["symbol","match"]]]],["data",["value","Could not find a match for value"],["data",["send",["symbol","="],["data",["symbol","value"],["symbol","value"]]]]]]]],["send",["symbol","if"],["data",["symbol","url"],["send",["symbol",":="],["data",["send",["symbol","err"],["send",["symbol","."],["data",["void"],["symbol","location"]]]],["send",["send",["symbol","#"],["data",["void"],["symbol","location"]]],["data",["symbol","url"],["symbol","start"],["symbol","end"]]]]]]],["send",["symbol","throw"],["symbol","err"]]]]]),"ErrorFactory":Embedded$14178(["send",["symbol","class"],["data",["multi",["send",["symbol","="],["data",["send",["symbol","constructor"],["data",["symbol","tags"]]],["send",["symbol",":="],["data",["send",["symbol","@"],["data",["void"],["symbol","tags"]]],["symbol","tags"]]]]],["send",["symbol","="],["data",["send",["symbol","create"],["data",["send",["symbol","="],["data",["symbol","message"],["value",""]]],["send",["symbol","*"],["data",["void"],["symbol","args"]]]]],["multi",["send",["symbol","="],["data",["symbol","e"],["send",["symbol","Error"],["data",["symbol","message"]]]]],["send",["symbol",":="],["data",["send",["symbol","e"],["value","::tags"]],["send",["symbol","@"],["data",["void"],["symbol","tags"]]]]],["send",["symbol",":="],["data",["send",["symbol","e"],["send",["symbol","."],["data",["void"],["symbol","args"]]]],["symbol","args"]]],["send",["symbol","each"],["data",["send",["symbol","enumerate"],["data",["symbol","args"]]],["send",["symbol","->"],["data",["data",["symbol","i"],["symbol","arg"]],["send",["symbol",":="],["data",["send",["symbol","e"],["symbol","i"]],["symbol","arg"]]]]]]],["send",["symbol",":="],["data",["send",["symbol","e"],["send",["symbol","."],["data",["void"],["symbol","length"]]]],["send",["symbol","args"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]],["send",["symbol",":="],["data",["send",["symbol","e"],["send",["symbol","."],["data",["void"],["symbol","name"]]]],["send",["send",["send",["symbol","++"],["data",["data",["send",["symbol","."],["data",["void"],["symbol","E"]]]],["send",["symbol","@"],["data",["void"],["symbol","tags"]]]]],["send",["symbol","."],["data",["void"],["symbol","join"]]]],["data",["value","."]]]]],["symbol","e"]]]],["send",["symbol","="],["data",["send",["value","::check"],["data",["symbol","e"]]],["multi",["send",["symbol","if"],["data",["send",["symbol","or"],["data",["send",["symbol","not"],["data",["void"],["symbol","e"]]],["send",["symbol","not"],["data",["void"],["send",["send",["symbol","?"],["data",["symbol","Error"],["void"]]],["symbol","e"]]]]]],["send",["symbol","return"],["symbol","false"]]]],["send",["symbol","="],["data",["symbol","tags"],["send",["symbol","or"],["data",["send",["symbol","e"],["value","::tags"]],["data"]]]]],["send",["symbol","each?"],["data",["send",["symbol","@"],["data",["void"],["symbol","tags"]]],["send",["symbol","->"],["data",["send",["symbol","when"],["data",["symbol","tag"],["send",["symbol","==="],["data",["send",["send",["symbol","tags"],["send",["symbol","."],["data",["void"],["symbol","indexOf"]]]],["data",["symbol","tag"]]],["send",["symbol","-"],["data",["void"],["value",1]]]]]]],["send",["symbol","return"],["symbol","false"]]]]]],["symbol","true"]]]],["send",["symbol","="],["data",["send",["value","::deconstruct"],["data",["symbol","e"]]],["send",["symbol","e"],["send",["symbol","."],["data",["void"],["symbol","args"]]]]]]]]]),"Node":Embedded$14178(["send",["symbol","class"],["data",["multi",["send",["symbol","static"],["data",["multi",["send",["symbol","="],["data",["send",["value","::check"],["data",["symbol","x"]]],["send",["symbol","and"],["data",["send",["symbol","and"],["data",["symbol","x"],["send",["symbol","x"],["send",["symbol","."],["data",["void"],["symbol","classes"]]]]]],["send",["symbol","x"],["send",["symbol","."],["data",["void"],["symbol","children"]]]]]]]],["send",["symbol","="],["data",["send",["value","::deconstruct"],["data",["symbol","x"]]],["data",["send",["symbol","x"],["send",["symbol","."],["data",["void"],["symbol","classes"]]]],["send",["symbol","x"],["send",["symbol","."],["data",["void"],["symbol","children"]]]]]]]]]],["send",["symbol","="],["data",["send",["symbol","constructor"],["data",["send",["send",["symbol","!"],["data",["symbol","Array"],["void"]]],["symbol","classes"]],["send",["send",["symbol","!"],["data",["symbol","Array"],["void"]]],["symbol","children"]]]],["multi",["send",["symbol",":="],["data",["send",["symbol","@"],["data",["void"],["symbol","classes"]]],["send",["send",["symbol","classes"],["send",["symbol","."],["data",["void"],["symbol","sort"]]]],["data"]]]],["send",["symbol",":="],["data",["send",["symbol","@"],["data",["void"],["symbol","children"]]],["symbol","children"]]]]]],["send",["symbol","="],["data",["send",["value","::check"],["data",["symbol","n"]]],["multi",["send",["symbol","each?"],["data",["send",["symbol","@"],["data",["void"],["symbol","classes"]]],["send",["symbol","->"],["data",["send",["symbol","when"],["data",["symbol","c"],["send",["symbol","==="],["data",["send",["send",["send",["symbol","n"],["send",["symbol","."],["data",["void"],["symbol","classes"]]]],["send",["symbol","."],["data",["void"],["symbol","indexOf"]]]],["data",["symbol","c"]]],["send",["symbol","-"],["data",["void"],["value",1]]]]]]],["send",["symbol","return"],["symbol","false"]]]]]],["symbol","true"]]]]]]])})));;($length$20218=temp$20213.length);;($index$20223=0);;$14214:for(;($index$20223<$length$20218);($index$20223++)){var k$20241;var v$20242;var t0$20236;var t1$20237;var m$20231;(m$20231=temp$20213[$index$20223]);;(t0$20236=m$20231);if(((t0$20236 instanceof Array)&&((t1$20237=t0$20236.length),(t1$20237===2)))){(k$20241=t0$20236[0]);(v$20242=t0$20236[1]);stdenv$14179.bind(topscope$14183,k$20241,["value",v$20242]);}else{$20478(m$20231,"/home/olivier/git/earl-grey/src/stdenv.eg",32906,32971);;}}(stdprelude$14209=Embedded$14178(["multi",["send",["symbol","="],["data",["send",["symbol","send"],["data",["symbol","obj"],["send",["symbol","match"],["symbol","msg"]]]],["multi",["send",["symbol","->"],["data",["send",["symbol","or"],["data",["send",["symbol","?"],["data",["symbol","String"],["void"]]],["send",["symbol","?"],["data",["symbol","Number"],["void"]]]]],["send",["symbol","___js_fetch"],["data",["symbol","obj"],["symbol","msg"]]]]],["send",["symbol","->"],["data",["symbol","other"],["send",["send",["symbol","obj"],["value","::send"]],["data",["symbol","msg"]]]]]]]],["send",["symbol",":="],["data",["send",["symbol","Array"],["value",":::project"]],["send",["symbol","->"],["data",["data",["send",["symbol","match"],["symbol","value"]]],["multi",["send",["symbol","->"],["data",["send",["symbol","?"],["data",["symbol","Array"],["void"]]],["data",["symbol","true"],["symbol","value"]]]],["send",["symbol","->"],["data",["symbol","_"],["data",["symbol","true"],["data",["symbol","value"]]]]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value","::check"]],["send",["symbol","->"],["data",["data",["symbol","value"]],["send",["symbol","if"],["data",["send",["symbol","instanceof"],["data",["symbol","value"],["symbol","Array"]]],["multi",["send",["symbol","then"],["data",["multi",["send",["symbol","for"],["data",["multi",["send",["symbol","="],["data",["symbol","i"],["value",0]]],["send",["symbol","<"],["data",["symbol","i"],["send",["symbol","this"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]],["send",["symbol","++"],["data",["symbol","i"],["void"]]]],["send",["symbol","if"],["data",["send",["symbol","!=="],["data",["send",["symbol","this"],["symbol","i"]],["send",["symbol","value"],["symbol","i"]]]],["send",["symbol","return"],["symbol","false"]]]]]],["symbol","true"]]]],["send",["symbol","else"],["data",["symbol","false"]]]]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value","::clone"]],["send",["symbol","->"],["data",["data"],["send",["send",["symbol","this"],["send",["symbol","."],["data",["void"],["symbol","slice"]]]],["data",["value",0]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value",":::project"]],["send",["symbol","->"],["data",["data",["symbol","value"]],["send",["symbol","if"],["data",["send",["symbol","instanceof"],["data",["symbol","value"],["symbol","Array"]]],["multi",["send",["symbol","then"],["data",["multi",["send",["symbol","for"],["data",["multi",["send",["symbol","="],["data",["symbol","i"],["value",0]]],["send",["symbol","<"],["data",["symbol","i"],["send",["symbol","this"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]],["send",["symbol","++"],["data",["symbol","i"],["void"]]]],["send",["symbol","if"],["data",["send",["symbol","!=="],["data",["send",["symbol","this"],["symbol","i"]],["send",["symbol","value"],["symbol","i"]]]],["send",["symbol","return"],["data",["symbol","true"],["data",["symbol","value"]]]]]]]],["data",["symbol","true"],["send",["send",["symbol","value"],["send",["symbol","."],["data",["void"],["symbol","slice"]]]],["data",["send",["symbol","this"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]]]]]],["send",["symbol","else"],["data",["data",["symbol","true"],["data",["symbol","value"]]]]]]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value","::serialize_ast"]],["send",["symbol","->"],["data",["data"],["send",["send",["symbol","#"],["data",["void"],["symbol","array"]]],["data",["send",["symbol","*"],["data",["void"],["send",["send",["symbol","this"],["send",["symbol","."],["data",["void"],["symbol","map"]]]],["data",["symbol","___serialize_ast"]]]]]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","RegExp"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value","::check"]],["send",["symbol","->"],["data",["data",["symbol","match"]],["multi",["send",["symbol","->"],["data",["send",["send",["symbol","?"],["data",["symbol","String"],["void"]]],["symbol","value"]],["send",["symbol","if"],["data",["send",["send",["symbol","value"],["send",["symbol","."],["data",["void"],["symbol","match"]]]],["data",["symbol","this"]]],["symbol","true"],["symbol","false"]]]]],["send",["symbol","->"],["data",["symbol","other"],["symbol","false"]]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","RegExp"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value",":::project"]],["send",["symbol","->"],["data",["data",["symbol","match"]],["multi",["send",["symbol","->"],["data",["send",["send",["symbol","?"],["data",["symbol","String"],["void"]]],["symbol","value"]],["send",["symbol","match"],["data",["send",["send",["symbol","value"],["send",["symbol","."],["data",["void"],["symbol","match"]]]],["data",["symbol","this"]]],["multi",["send",["symbol","->"],["data",["send",["send",["symbol","?"],["data",["symbol","null"],["void"]]],["symbol","m"]],["data",["symbol","false"],["symbol","null"]]]],["send",["symbol","->"],["data",["symbol","m"],["data",["symbol","true"],["symbol","m"]]]]]]]]],["send",["symbol","->"],["data",["symbol","other"],["data",["symbol","false"],["symbol","null"]]]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","Function"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value","::send"]],["send",["symbol","->"],["data",["data",["symbol","args"]],["send",["send",["symbol","this"],["send",["symbol","."],["data",["void"],["symbol","apply"]]]],["data",["symbol","this"],["symbol","args"]]]]]]]]));;(expander$14181["utils"]=({"var_operator":var_operator$14194}));(exports["topscope"]=topscope$14183);(exports["stdenv"]=stdenv$14179);(exports["expander"]=expander$14181);(exports["expand"]=expand$14182);(exports["stdprelude"]=stdprelude$14209);

},{"./expand":5,"./location":7,"./pattern":10,"./pp":11,"./util":14}],13:[function(require,module,exports){
var $20771=function(type$20773){var f$20776;(f$20776=type$20773["::check"]);;if((f$20776===(void 0))){return function(value$20781){return (value$20781 instanceof type$20773);};}else{return function(value$20784){return f$20776.call(type$20773,value$20784);};}};
var $20786=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $20787=function($20788$20790){var ph$20794;(ph$20794=$20788$20790);;var $20792$20799;($20792$20799=ph$20794);;var bridge$20793$20804;var x$20808;(bridge$20793$20804=$20792$20799);if((((typeof(bridge$20793$20804)==="string")&&((x$20808=bridge$20793$20804),true))||((typeof(bridge$20793$20804)==="number")&&((x$20808=bridge$20793$20804),true)))){return ["value",x$20808];}else{var other$20815;(other$20815=$20792$20799);return other$20815["::serialize_ast"]();}};
var send$20611;(send$20611=function(obj$20616,$20614$20617){var ph$20621;var msg$20622;var t0$20624;(t0$20624=$20614$20617);(msg$20622=t0$20624);(ph$20621=t0$20624);;var $20619$20628;($20619$20628=ph$20621);;var bridge$20620$20633;(bridge$20620$20633=$20619$20628);if(((typeof(bridge$20620$20633)==="string")||(typeof(bridge$20620$20633)==="number"))){return obj$20616[msg$20622];}else{var other$20641;(other$20641=$20619$20628);return obj$20616["::send"](msg$20622);}});;(Array[":::project"]=function($20644$20646){var ph$20649;var value$20650;var t0$20652;(t0$20652=$20644$20646);(value$20650=t0$20652);(ph$20649=t0$20652);;var $20648$20656;($20648$20656=ph$20649);;if($20771(Array)($20648$20656)){return [true,value$20650];}else{$20648$20656;return [true,[value$20650]];}});(Array.prototype["::check"]=function(value$20670){if((value$20670 instanceof Array)){var i$20675;(i$20675=0);;$20673:for(;(i$20675<this.length);(i$20675++)){if(($20786(this,i$20675)!==$20786(value$20670,i$20675))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$20686){if((value$20686 instanceof Array)){var i$20691;(i$20691=0);;$20689:for(;(i$20691<this.length);(i$20691++)){if(($20786(this,i$20691)!==$20786(value$20686,i$20691))){return [true,[value$20686]];}}return [true,value$20686.slice(this.length)];}else{return [true,[value$20686]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($20787));});(RegExp.prototype["::check"]=function($20701$20703){var ph$20706;(ph$20706=$20701$20703);;var $20705$20711;($20705$20711=ph$20706);;var value$20719;if((typeof($20705$20711)==="string")){(value$20719=$20705$20711);if(value$20719.match(this)){return true;}else{return false;}}else{var other$20724;(other$20724=$20705$20711);return false;}});(RegExp.prototype[":::project"]=function($20726$20728){var ph$20731;(ph$20731=$20726$20728);;var $20730$20736;($20730$20736=ph$20731);;var value$20744;if((typeof($20730$20736)==="string")){(value$20744=$20730$20736);var $20747$20749;($20747$20749=value$20744.match(this));;var m$20757;if(($20747$20749===null)){(m$20757=$20747$20749);return [false,null];}else{var m$20762;(m$20762=$20747$20749);return [true,m$20762];}}else{var other$20766;(other$20766=$20730$20736);return [false,null];}});(Function.prototype["::send"]=function(args$20769){return this.apply(this,args$20769);});
var $22407=function(arr$22409){var results$22413;var l$22414;(results$22413=[]);;(l$22414=arr$22409.length);;var i$22422;(i$22422=0);;$22412:for(;(i$22422<l$22414);(i$22422++)){results$22413.push([i$22422,$20786(arr$22409,i$22422)]);}return results$22413;};
var $22429=function(dest$22431,values$22432){var k$22437;(k$22437=null);$22435:for(k$22437 in values$22432){if(values$22432.hasOwnProperty(k$22437)){(dest$22431[k$22437]=values$22432[k$22437]);}}return dest$22431;};
var $22253=function(){var $22254$22256;($22254$22256=function(tags$22260){var it$0$22263;(it$0$22263=function(){if((!$20771($22254$22256)(this))){return Object.create($22254$22256.prototype);}else{return this;}}());;(it$0$22263["tags"]=tags$22260);return it$0$22263;});;($22254$22256.prototype["create"]=function(){var $22272$22274;($22272$22274=arguments);;var t0$22279;var message$22283;var args$22284;(t0$22279=$22272$22274.length);if((t0$22279>=0)){(message$22283=function(){if((0>=t0$22279)){return "";}else{return $22272$22274[0];}}());(args$22284=Array.prototype.slice.call($22272$22274,1));var it$0$22288;(it$0$22288=this);;var e$22293;(e$22293=Error(message$22283));;(e$22293["::tags"]=it$0$22288.tags);(e$22293["args"]=args$22284);var temp$22301;(temp$22301=$22407(args$22284));;var $length$22306;($length$22306=temp$22301.length);;var $index$22311;($index$22311=0);;$22294:for(;($index$22311<$length$22306);($index$22311++)){var m$22319;(m$22319=temp$22301[$index$22311]);;var t0$22324;var t1$22325;var i$22329;var arg$22330;(t0$22324=m$22319);if(((t0$22324 instanceof Array)&&((t1$22325=t0$22324.length),(t1$22325===2)))){(i$22329=t0$22324[0]);(arg$22330=t0$22324[1]);(e$22293[i$22329]=arg$22330);}else{$22240(m$22319);;}}(e$22293["length"]=args$22284.length);(e$22293["name"]=["E"].concat(it$0$22288.tags).join("."));return e$22293;}else{$22240($22272$22274);}});($22254$22256.prototype["::check"]=function(e$22341){var it$0$22344;(it$0$22344=this);;var tags$22349;if(((!e$22341)||(!$20771(Error)(e$22341)))){return false;}(tags$22349=(e$22341["::tags"]||[]));;var temp$22358;(temp$22358=it$0$22344.tags);;var $length$22363;($length$22363=temp$22358.length);;var $index$22368;($index$22368=0);;$22350:for(;($index$22368<$length$22363);($index$22368++)){var m$22376;(m$22376=temp$22358[$index$22368]);;var tag$22384;(tag$22384=m$22376);if((tags$22349.indexOf(tag$22384)===-1)){return false;}else{false;;}}return true;});($22254$22256.prototype["::deconstruct"]=function(e$22392){var it$0$22395;(it$0$22395=this);;return e$22392.args;});$22429($22254$22256,$22429(function(){var accum$22400;(accum$22400=({}));(accum$22400["::name"]="$22254");return accum$22400;}(),function(){var accum$22404;(accum$22404=({}));(accum$22404["::egclass"]=true);return accum$22404;}()));return $22254$22256;}();
var $22240=function(value$22242,url$22243,start$22244,end$22245){var err$22248;(err$22248=$22253(["match"]).create("Could not find a match for value",({"value":value$22242})));;if(url$22243){(err$22248["location"]=["location",url$22243,start$22244,end$22245]);}throw err$22248;};
var $22441=function(type$22443){return function(value$22446){var f$22449;(f$22449=type$22443[":::project"]);;if((f$22449===(void 0))){var f$22454;(f$22454=type$22443["::project"]);;if((f$22454===(void 0))){return [true,type$22443(value$22446)];}else{var rval$22459;(rval$22459=false);;try{(rval$22459=[true,f$22454(value$22446)]);}catch(excv$22465){var e$22471;(e$22471=excv$22465);(rval$22459=[false,null]);}return rval$22459;}}else{return f$22449.call(type$22443,value$22446);}};};
var $22473=function($22474$22476,key$22477){var ph$22481;(ph$22481=$22474$22476);;var $22479$22486;($22479$22486=ph$22481);;var bridge$22480$22491;(bridge$22480$22491=$22479$22486);if(((bridge$22480$22491===null)||(bridge$22480$22491===(void 0)))){return false;}else{var x$22499;if((typeof($22479$22486)==="string")){(x$22499=$22479$22486);return (key$22477 in String.prototype);}else{var x$22504;if((typeof($22479$22486)==="number")){(x$22504=$22479$22486);return (key$22477 in Number.prototype);}else{var x$22509;(x$22509=$22479$22486);return (key$22477 in x$22509);}}}};var accum$22216;var accum$22220;var $20818$20820;var items$20821;var gensym$20822;var $20819$20823;var __lt____gt__$20824;var js_op_table2$20825;var js_op_table$20826;var Translator$20827;var translate$20828;($20818$20820=require("./util"));;(items$20821=$20818$20820.items);;(gensym$20822=$20818$20820.gensym);;($20819$20823=require("./pp"));;(__lt____gt__$20824=$20819$20823["<>"]);;(js_op_table2$20825=({"+":"+","-":"-","*":"*","/":"/","mod":"%","&.":"&","|.":"|","^.":"^","~":"~","and":"&&","or":"||","not":"!","==":"===","!=":"!==","===":"===","!==":"!==","<":"<",">":">","<=":"<=",">=":">=","<<":"<<",">>":">>",">>>":">>>","in":" in ","instanceof":" instanceof ","++":"++","--":"--"}));;(js_op_table$20826=({"___plus":"+","___minus":"-","___times":"*","___div":"/","___mod":"%","___binxor":"^","___binand":"&","___binor":"|","___binnot":"~","___and":"&&","___or":"||","___not":"!","___is":"===","___isnt":"!==","___eq":"===","___neq":"!==","___lt":"<","___gt":">","___lte":"<=","___gte":">=","___shl":"<<","___shr":">>","___shr2":">>>","___in":" in ","___instanceof":" instanceof ","___plusplus":"++","___minusminus":"--"}));;(Translator$20827=function(){var it$0$20868;var prelude$20864;var t0$20860;var $20853$20855;($20853$20855=arguments);;(t0$20860=$20853$20855.length);if(((t0$20860>=0)&&(t0$20860<=1))){(prelude$20864=function(){if((0>=t0$20860)){return null;}else{return $20853$20855[0];}}());(it$0$20868=function(){if((!$20771(Translator$20827)(this))){return Object.create(Translator$20827.prototype);}else{return this;}}());;(it$0$20868["cache"]=({}));(it$0$20868["prepend"]=[]);if(prelude$20864){it$0$20868.prepend.push(it$0$20868.translate($20787(prelude$20864),"stmt"));}return it$0$20868;}else{$22240($20853$20855);}});;(Translator$20827.prototype["register_value"]=function(v$20881,id$20882){var temp$20902;var name$20908;var $20885$20891;var it$0$20886;(it$0$20886=this);;($20885$20891=$20786(it$0$20886.cache,id$20882));;if(($20885$20891===(void 0))){(temp$20902=["symbol",gensym$20822()]);;(it$0$20886.cache[id$20882]=temp$20902);it$0$20886.prepend.push(it$0$20886.translate(["declare",temp$20902,$20787(v$20881)],"stmt"));return temp$20902;}else{(name$20908=$20885$20891);return name$20908;}});(Translator$20827.prototype["register_raw"]=function(raw$20913,id$20914){var temp$20934;var name$20940;var $20917$20923;var it$0$20918;(it$0$20918=this);;($20917$20923=$20786(it$0$20918.cache,id$20914));;if(($20917$20923===(void 0))){(temp$20934=["symbol",gensym$20822()]);;(it$0$20918.cache[id$20914]=temp$20934);it$0$20918.prepend.push(it$0$20918.translate(["declare",temp$20934,["raw",raw$20913]],"stmt"));return temp$20934;}else{(name$20940=$20917$20923);return name$20940;}});(Translator$20827.prototype["dump_store"]=function(){var rval$20952;var it$0$20947;(it$0$20947=this);;(rval$20952=it$0$20947.prepend.join("\n"));;(it$0$20947["prepend"]=[]);return rval$20952;});(Translator$20827.prototype["mangle"]=function(name$20959){var i$20977;var tr$20968;var r$20969;var it$0$20962;(it$0$20962=this);;(tr$20968=({"+":"__plus__","-":"__minus__","*":"__asterisk__","/":"__slash__","%":"__percent__","^":"__caret__","#":"__hash__","&":"__amp__","|":"__pipe__","@":"__at__","!":"__bang__","?":"__qmark__","=":"__equal__","<":"__lt__",">":"__gt__","~":"__tilde__",".":"__dot__",":":"__colon__"}));;(r$20969=[]);;(i$20977=0);;$20967:for(;(i$20977<name$20959.length);(++i$20977)){var c$20985;(c$20985=$20786(name$20959,i$20977));;r$20969.push(($20786(tr$20968,c$20985)||c$20985));}return r$20969.join("");});(Translator$20827.prototype["body"]=function(orig$20992,mode$20993){var t0$21005;var t1$21006;var t2$21007;var x$21031;var stmts$21040;var ret$21041;var other$21054;var $21001$21020;var b$21002;var trst$21003;var it$0$20996;(it$0$20996=this);;(t0$21005=$22441(["multi"])(orig$20992));if((t0$21005[0]&&((t1$21006=t0$21005[1]),((t2$21007=t1$21006.length),(t2$21007>=0))))){(b$21002=Array.prototype.slice.call(t1$21006,0));;}else{$22240(orig$20992,"/home/olivier/git/earl-grey/src/translate-js.eg",3265,3269);}(trst$21003=function(stmt$21016){return it$0$20996.translate(stmt$21016,"stmt");});;($21001$21020=mode$20993);;if(($21001$21020==="expr")){(x$21031=["send",["lambda",[],orig$20992],["array"]]);;return it$0$20996.translate(x$21031,mode$20993);}else{if(($21001$21020==="return")){(stmts$21040=b$21002.slice(0,-1));;(ret$21041=$20786(b$21002,(b$21002.length-1)));;return (stmts$21040.map(trst$21003).join("")+it$0$20996.translate(ret$21041,"return"));}else{if(($21001$21020==="stmt")){return b$21002.map(trst$21003).join("");}else{(other$21054=$21001$21020);throw $22253(["syntax","mode"]).create("Unknown mode",({"mode":mode$20993}));}}}});(Translator$20827.prototype["expr"]=function(x$21059,mode$21060){var other$21089;var $21063$21069;var it$0$21064;(it$0$21064=this);;($21063$21069=mode$21060);;if(($21063$21069==="expr")){return x$21059;}else{if(($21063$21069==="stmt")){return (x$21059+";");}else{if(($21063$21069==="return")){return (("return "+x$21059)+";");}else{(other$21089=$21063$21069);throw "OopsI";}}}});(Translator$20827.prototype["op"]=function(op$21094,a$21095,b$21096){var $21108$21121;var $21109$21122;var $21110$21123;var t0$21117;var t1$21118;var t2$21119;var $21107$21112;var e$21104;var it$0$21099;(it$0$21099=this);;(e$21104=((($21107$21112=[a$21095,b$21096])),function(){if((($21108$21121=($21107$21112 instanceof Array))&&((t0$21117=$21107$21112.length),(($21110$21123=(t0$21117===2))&&((t1$21118=$21107$21112[0]),((t1$21118 instanceof Array)&&((t2$21119=t1$21118.length),((t2$21119===1)&&(t1$21118[0]==="void"))))))))){$21107$21112[1];return (op$21094+it$0$21099.translate(b$21096,"expr"));}else{if(($21110$21123&&($21107$21112[0],((t1$21118=$21107$21112[1]),((t1$21118 instanceof Array)&&((t2$21119=t1$21118.length),((t2$21119===1)&&(t1$21118[0]==="void")))))))){return (it$0$21099.translate(a$21095,"expr")+op$21094);}else{$21107$21112;return ((it$0$21099.translate(a$21095,"expr")+op$21094)+it$0$21099.translate(b$21096,"expr"));}}}()));;return (("("+e$21104)+")");});(Translator$20827.prototype["translate"]=function(expr$21145,mode$21146){var repl$21216;var it$0$21247;var it$0$21242;var it$0$21237;var it$0$21232;var bridge$21202$21258;var bridge$21201$21255;var other$21269;var id$21263;var bridge$21200$21209;var $21199$21204;var r$21196;var t0$21288;var t0$21291;var trf$21297;var trmsg$21298;var trf$21329;var trmsg$21330;var trf$21342;var trmsg$21343;var otherwise$21339;var $21316$21318;var x$21386;var x$21380;var $21364$21375;var $21365$21376;var $21366$21377;var t0$21373;var $21363$21368;var $index$21419;var $length$21414;var temp$21409;var acc$21404;var trf$21394;var trargs$21395;var op$21360;var code$21451;var code$21459;var t0$21447;var t1$21448;var trf$21464;var trmsg$21465;var codevar$21445;var f$21482;var r$21478;var f$21500;var r$21496;var $index$21560;var $length$21555;var temp$21550;var acc$21545;var a$21534;var b$21535;var a$21609;var b$21610;var other$21606;var $21592$21594;var a$21641;var b$21642;var c$21643;var other$21638;var $21624$21626;var a$21680;var other$21677;var bridge$21662$21669;var $21661$21664;var a$21709;var b$21710;var other$21706;var bridge$21691$21698;var $21690$21693;var a$21727;var b$21728;var c$21729;var a$21746;var b$21747;var $index$21836;var $length$21831;var temp$21826;var acc$21821;var $index$21873;var $length$21868;var temp$21863;var acc$21858;var xs$21815;var $21765$21805;var $21764$21799;var isdecl$21766;var $index$21935;var $length$21930;var temp$21925;var acc$21920;var decls$21914;var f$21964;var r$21960;var other$22047;var $22033$22035;var a$22072;var b$22073;var other$22069;var $22055$22057;var a$22105;var b$22106;var c$22107;var d$22108;var other$22102;var $22088$22090;var a$22145;var b$22146;var c$22147;var other$22142;var $22128$22130;var t0$22170;var t0$22174;var a$22198;var b$22199;var other$22195;var $22181$22183;var other$22213;var x$22208;var attempt$22159;var v$22160;var body$22161;var x$22123;var y$22124;var body$22125;var x$22082;var y$22083;var z$22084;var body$22085;var test$22051;var body$22052;var label$22027;var body$22028;var value$22022;var value$22017;var value$22012;var label$22005;var label$21998;var value$21993;var args$21956;var vars$21909;var body$21910;var s$21904;var args$21899;var args$21760;var lhs$21741;var rhs$21742;var obj$21719;var msg$21720;var rhs$21721;var binding$21686;var value$21687;var binding$21655;var test$21619;var pos$21620;var neg$21621;var test$21584;var pos$21585;var bindings$21529;var body$21530;var args$21492;var args$21474;var f$21440;var msg$21441;var f$21352;var args$21353;var f$21307;var msg$21308;var s$21309;var f$21283;var msg$21284;var f$21274;var v$21192;var s$21182;var $21152$21176;var $21153$21177;var $21154$21178;var $21155$21179;var t0$21166;var t1$21167;var t2$21168;var t3$21169;var t4$21170;var bridge$21150$21171;var bridge$21151$21172;var t5$21173;var t6$21174;var $21149$21161;var it$0$21156;(it$0$21156=this);;($21149$21161=expr$21145);;if((($21152$21176=($21149$21161 instanceof Array))&&((t0$21166=$21149$21161.length),((t0$21166===2)&&($21149$21161[0]==="symbol"))))){(s$21182=$21149$21161[1]);return it$0$21156.expr(it$0$21156.mangle(s$21182),mode$21146);}else{if(($21152$21176&&((t0$21166===1)&&($21149$21161[0]==="void")))){return it$0$21156.expr("null",mode$21146);}else{if(($21152$21176&&((t0$21166===2)&&($21149$21161[0]==="value")))){(v$21192=$21149$21161[1]);(r$21196=((($21199$21204=v$21192)),function(){if((typeof($21199$21204)==="string")){(repl$21216=({"\"":"\\\"","\n":"\\n","\\":"\\\\"}));;(v$21192=v$21192.replace(RegExp("((?:(?:\"|\\\\)|\n))","g"),function(m$21221){return $20786(repl$21216,m$21221);}));return (("\""+v$21192)+"\"");}else{if(($21199$21204===(void 0))){return "(void 0)";}else{if($20771(RegExp)($21199$21204)){(it$0$21232=String(v$21192));;(it$0$21237=it$0$21232.slice(1,-1));;(it$0$21242=it$0$21237.replace(RegExp("/","g"),"\\/"));;(it$0$21247=it$0$21242.replace(RegExp("\n","g"),"\\n"));;return "/".concat(it$0$21247).concat("/");}else{(bridge$21200$21209=$21199$21204);if((((bridge$21201$21255=bridge$21200$21209),(((bridge$21202$21258=bridge$21201$21255),((typeof(bridge$21202$21258)==="number")||(bridge$21202$21258===true)))||(bridge$21201$21255===false)))||(bridge$21200$21209===null))){return String(v$21192);}else{if(($22473($21199$21204,"::id")&&((id$21263=$21199$21204["::id"]),id$21263))){return it$0$21156.translate(it$0$21156.register_value(v$21192,id$21263),mode$21146);}else{(other$21269=$21199$21204);throw $22253(["cannot_serialize"]).create("Cannot serialize value",({"value":v$21192}));}}}}}}()));;return it$0$21156.expr(r$21196,mode$21146);}else{if(($21152$21176&&(($21154$21178=(t0$21166===3))&&(($21155$21179=($21149$21161[0]==="send"))&&((t1$21167=$21149$21161[1]),((t1$21167 instanceof Array)&&((t2$21168=t1$21167.length),((t2$21168===2)&&((t1$21167[0]==="variable")&&((t1$21167[1]==="___node")&&((t3$21169=$21149$21161[2]),((t3$21169 instanceof Array)&&((t4$21170=t3$21169.length),((t4$21170===2)&&(t3$21169[0]==="value"))))))))))))))){(f$21274=t3$21169[1]);return f$21274;}else{if(($21155$21179&&((bridge$21150$21171=$21149$21161[1]),((((bridge$21150$21171 instanceof Array)&&((t0$21288=bridge$21150$21171.length),((t0$21288===2)&&((bridge$21150$21171[0]==="symbol")&&(bridge$21150$21171[1]==="___js_fetch")))))||((bridge$21150$21171 instanceof Array)&&((t0$21291=bridge$21150$21171.length),((t0$21291===2)&&((bridge$21150$21171[0]==="variable")&&(bridge$21150$21171[1]==="___js_fetch"))))))&&((t1$21167=$21149$21161[2]),((t1$21167 instanceof Array)&&((t2$21168=t1$21167.length),((t2$21168===3)&&(t1$21167[0]==="array"))))))))){(f$21283=t1$21167[1]);(msg$21284=t1$21167[2]);(trf$21297=it$0$21156.translate(f$21283,"expr"));;(trmsg$21298=it$0$21156.translate(msg$21284,"expr"));;return it$0$21156.expr((((trf$21297+"[")+trmsg$21298)+"]"),mode$21146);}else{if(($21155$21179&&((f$21307=$21149$21161[1]),((t1$21167=$21149$21161[2]),((msg$21308=t1$21167),((t1$21167 instanceof Array)&&((t2$21168=t1$21167.length),((t2$21168===2)&&(t1$21167[0]==="value"))))))))){(s$21309=t1$21167[1]);($21316$21318=null);;$21316$21318;if(((typeof(s$21309)==="string")&&s$21309.match(RegExp("(?:^(?:[a-zA-Z_$]+)$)","")))){(trf$21329=it$0$21156.translate(f$21307,"expr"));;(trmsg$21330=it$0$21156.translate(["symbol",s$21309],"expr"));;return it$0$21156.expr(((trf$21329+".")+trmsg$21330),mode$21146);}else{(otherwise$21339=$21316$21318);(trf$21342=it$0$21156.translate(f$21307,"expr"));;(trmsg$21343=it$0$21156.translate(msg$21308,"expr"));;return it$0$21156.expr((((trf$21342+"[")+trmsg$21343)+"]"),mode$21146);}}else{if(($21155$21179&&((f$21352=$21149$21161[1]),((t1$21167=$21149$21161[2]),((t1$21167 instanceof Array)&&((t2$21168=t1$21167.length),((t2$21168>=1)&&(t1$21167[0]==="array")))))))){(args$21353=Array.prototype.slice.call(t1$21167,1));(op$21360=((($21363$21368=f$21352)),function(){if((($21364$21375=($21363$21368 instanceof Array))&&((t0$21373=$21363$21368.length),(($21366$21377=(t0$21373===2))&&($21363$21368[0]==="symbol"))))){(x$21380=$21363$21368[1]);return $20786(js_op_table$20826,x$21380);}else{if(($21366$21377&&($21363$21368[0]==="variable"))){(x$21386=$21363$21368[1]);return $20786(js_op_table2$20825,x$21386);}else{$21363$21368;return null;}}}()));;if(op$21360){return it$0$21156.expr(it$0$21156.op(op$21360,args$21353[0],args$21353[1]),mode$21146);}else{(trf$21394=it$0$21156.translate(f$21352,"expr"));;(trargs$21395=(((acc$21404=[])),(((temp$21409=args$21353)),((($length$21414=temp$21409.length)),((($index$21419=0)),function(){$21401:for(;($index$21419<$length$21414);($index$21419++)){var x$21435;var m$21427;(m$21427=temp$21409[$index$21419]);;(x$21435=m$21427);acc$21404.push(it$0$21156.translate(x$21435,"expr"));}}()))),acc$21404));;return it$0$21156.expr((((trf$21394+"(")+trargs$21395.join(","))+")"),mode$21146);}}else{if($21155$21179){(f$21440=$21149$21161[1]);(msg$21441=$21149$21161[2]);(t0$21447=(((code$21451="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$21156.register_raw(code$21451,"~send")));if(((t0$21447 instanceof Array)&&((t1$21448=t0$21447.length),((t1$21448===2)&&(t0$21447[0]==="symbol"))))){(codevar$21445=t0$21447[1]);;}else{$22240((((code$21459="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$21156.register_raw(code$21459,"~send")),"/home/olivier/git/earl-grey/src/translate-js.eg",6898,7075);}(trf$21464=it$0$21156.translate(f$21440,"expr"));;(trmsg$21465=it$0$21156.translate(msg$21441,"expr"));;return it$0$21156.expr((((((codevar$21445+"(")+trf$21464)+",")+trmsg$21465)+")"),mode$21146);}else{if(($21152$21176&&(($21154$21178=(t0$21166>=1))&&($21149$21161[0]==="array")))){(args$21474=Array.prototype.slice.call($21149$21161,1));(r$21478=(((f$21482=function(x$21486){return it$0$21156.translate(x$21486,"expr");})),(("["+args$21474.map(f$21482).join(","))+"]")));;return it$0$21156.expr(r$21478,mode$21146);}else{if(($21154$21178&&($21149$21161[0]==="object"))){(args$21492=Array.prototype.slice.call($21149$21161,1));(r$21496=(((f$21500=function($21503$21505){var t0$21510;var t1$21511;var a$21517;var b$21518;var x$21507;var y$21508;(t0$21510=$21503$21505);if(((t0$21510 instanceof Array)&&((t1$21511=t0$21510.length),((t1$21511===3)&&(t0$21510[0]==="array"))))){(x$21507=t0$21510[1]);(y$21508=t0$21510[2]);;}else{$22240($21503$21505);}(a$21517=it$0$21156.translate(x$21507,"expr"));;(b$21518=it$0$21156.translate(y$21508,"expr"));;return ((a$21517+":")+b$21518);})),(("({"+args$21492.map(f$21500).join(","))+"})")));;return it$0$21156.expr(r$21496,mode$21146);}else{if(($21152$21176&&((t0$21166===3)&&($21149$21161[0]==="lambda")))){(bindings$21529=$21149$21161[1]);(body$21530=$21149$21161[2]);(a$21534=(((acc$21545=[])),(((temp$21550=bindings$21529)),((($length$21555=temp$21550.length)),((($index$21560=0)),function(){$21542:for(;($index$21560<$length$21555);($index$21560++)){var x$21576;var m$21568;(m$21568=temp$21550[$index$21560]);;(x$21576=m$21568);acc$21545.push(it$0$21156.translate(x$21576,"expr"));}}()))),acc$21545).join(","));;(b$21535=it$0$21156.body(body$21530,"return"));;return it$0$21156.expr((((("function("+a$21534)+"){")+b$21535)+"}"),mode$21146);}else{if(($21152$21176&&(($21154$21178=(t0$21166===4))&&(($21155$21179=($21149$21161[0]==="if"))&&((test$21584=$21149$21161[1]),((pos$21585=$21149$21161[2]),((t1$21167=$21149$21161[3]),((t1$21167 instanceof Array)&&((t2$21168=t1$21167.length),((t2$21168===2)&&((t1$21167[0]==="value")&&(t1$21167[1]===(void 0))))))))))))){($21592$21594=mode$21146);;if(($21592$21594==="expr")){return it$0$21156.body(expr$21145,"expr");}else{(other$21606=$21592$21594);(a$21609=it$0$21156.translate(test$21584,"expr"));;(b$21610=it$0$21156.translate(pos$21585,mode$21146));;return (((("if("+a$21609)+"){")+b$21610)+"}");}}else{if($21155$21179){(test$21619=$21149$21161[1]);(pos$21620=$21149$21161[2]);(neg$21621=$21149$21161[3]);($21624$21626=mode$21146);;if(($21624$21626==="expr")){return it$0$21156.body(expr$21145,"expr");}else{(other$21638=$21624$21626);(a$21641=it$0$21156.translate(test$21619,"expr"));;(b$21642=it$0$21156.translate(pos$21620,mode$21146));;(c$21643=it$0$21156.translate(neg$21621,mode$21146));;return (((((("if("+a$21641)+"){")+b$21642)+"}else{")+c$21643)+"}");}}else{if(($21152$21176&&(($21154$21178=(t0$21166===3))&&(($21155$21179=($21149$21161[0]==="declare"))&&((binding$21655=$21149$21161[1]),((t1$21167=$21149$21161[2]),((t1$21167 instanceof Array)&&((t2$21168=t1$21167.length),((t2$21168===2)&&((t1$21167[0]==="value")&&(t1$21167[1]===(void 0)))))))))))){($21661$21664=mode$21146);;(bridge$21662$21669=$21661$21664);if(((bridge$21662$21669==="expr")||(bridge$21662$21669==="return"))){throw "Invalid in expr ctx";}else{(other$21677=$21661$21664);(a$21680=it$0$21156.translate(binding$21655,"expr"));;return (("var "+a$21680)+";");}}else{if($21155$21179){(binding$21686=$21149$21161[1]);(value$21687=$21149$21161[2]);($21690$21693=mode$21146);;(bridge$21691$21698=$21690$21693);if(((bridge$21691$21698==="expr")||(bridge$21691$21698==="return"))){throw "Invalid in expr ctx";}else{(other$21706=$21690$21693);(a$21709=it$0$21156.translate(binding$21686,"expr"));;(b$21710=it$0$21156.translate(value$21687,"expr"));;return (((("var "+a$21709)+"=")+b$21710)+";");}}else{if(($21154$21178&&(($21155$21179=($21149$21161[0]==="assign"))&&((t1$21167=$21149$21161[1]),((t1$21167 instanceof Array)&&((t2$21168=t1$21167.length),((t2$21168===3)&&(t1$21167[0]==="send")))))))){(obj$21719=t1$21167[1]);(msg$21720=t1$21167[2]);(rhs$21721=$21149$21161[2]);(a$21727=it$0$21156.translate(obj$21719,"expr"));;(b$21728=it$0$21156.translate(msg$21720,"expr"));;(c$21729=it$0$21156.translate(rhs$21721,"expr"));;return it$0$21156.expr((((((("("+a$21727)+"[")+b$21728)+"]=")+c$21729)+")"),mode$21146);}else{if($21155$21179){(lhs$21741=$21149$21161[1]);(rhs$21742=$21149$21161[2]);(a$21746=it$0$21156.translate(lhs$21741,"expr"));;(b$21747=it$0$21156.translate(rhs$21742,"expr"));;return it$0$21156.expr((((("("+a$21746)+"=")+b$21747)+")"),mode$21146);}else{if(($21152$21176&&((t0$21166===1)&&($21149$21161[0]==="multi")))){if((mode$21146==="stmt")){return ";";}else{return "";}}else{if(($21152$21176&&(($21154$21178=(t0$21166>=1))&&($21149$21161[0]==="multi")))){(args$21760=Array.prototype.slice.call($21149$21161,1));(isdecl$21766=function($21769$21771){var other$21795;var variable$21788;var value$21789;var t0$21784;var $21773$21779;var ph$21774;(ph$21774=$21769$21771);;($21773$21779=ph$21774);;if((($21773$21779 instanceof Array)&&((t0$21784=$21773$21779.length),((t0$21784===3)&&($21773$21779[0]==="declare"))))){(variable$21788=$21773$21779[1]);(value$21789=$21773$21779[2]);return true;}else{(other$21795=$21773$21779);return false;}});;($21764$21799=null);;$21764$21799;if((args$21760.length===1)){return it$0$21156.translate(args$21760[0],mode$21146);}else{if(((mode$21146==="expr")&&(!args$21760.some(isdecl$21766)))){(xs$21815=(((acc$21821=[])),(((temp$21826=args$21760)),((($length$21831=temp$21826.length)),((($index$21836=0)),function(){$21818:for(;($index$21836<$length$21831);($index$21836++)){var x$21852;var m$21844;(m$21844=temp$21826[$index$21836]);;(x$21852=m$21844);acc$21821.push(it$0$21156.translate(x$21852,"expr"));}}()))),acc$21821));;(xs$21815=(((acc$21858=[])),(((temp$21863=xs$21815)),((($length$21868=temp$21863.length)),((($index$21873=0)),function(){$21855:for(;($index$21873<$length$21868);($index$21873++)){var x$21889;var m$21881;(m$21881=temp$21863[$index$21873]);;(x$21889=m$21881);if((x$21889!=="")){acc$21858.push(x$21889);}else{false;;}}}()))),acc$21858));return (("("+xs$21815.join(","))+")");}else{return it$0$21156.body(expr$21145,mode$21146);}}}else{if(($21154$21178&&($21149$21161[0]==="splice"))){(args$21899=Array.prototype.slice.call($21149$21161,1));return it$0$21156.translate(["multi"].concat(args$21899),mode$21146);}else{if(($21152$21176&&((t0$21166===2)&&($21149$21161[0]==="variable")))){(s$21904=$21149$21161[1]);return it$0$21156.expr(it$0$21156.mangle(s$21904),mode$21146);}else{if(($21152$21176&&((t0$21166===3)&&($21149$21161[0]==="scope")))){(vars$21909=$21149$21161[1]);(body$21910=$21149$21161[2]);(decls$21914=(((acc$21920=[])),(((temp$21925=vars$21909)),((($length$21930=temp$21925.length)),((($index$21935=0)),function(){$21917:for(;($index$21935<$length$21930);($index$21935++)){var v$21951;var m$21943;(m$21943=temp$21925[$index$21935]);;(v$21951=m$21943);acc$21920.push(["declare",v$21951,["value",(void 0)]]);}}()))),acc$21920));;return it$0$21156.translate(["multi"].concat(decls$21914).concat([body$21910]),mode$21146);}else{if(($21152$21176&&((t0$21166>=1)&&($21149$21161[0]==="object2")))){(args$21956=Array.prototype.slice.call($21149$21161,1));(r$21960=(((f$21964=function($21967$21969){var t0$21974;var t1$21975;var a$21981;var b$21982;var x$21971;var y$21972;(t0$21974=$21967$21969);if(((t0$21974 instanceof Array)&&((t1$21975=t0$21974.length),(t1$21975===2)))){(x$21971=t0$21974[0]);(y$21972=t0$21974[1]);;}else{$22240($21967$21969);}(a$21981=it$0$21156.translate(x$21971,"expr"));;(b$21982=it$0$21156.translate(y$21972,"expr"));;return ((a$21981+":")+b$21982);})),(("({"+args$21956.map(f$21964).join(","))+"})")));;return it$0$21156.expr(r$21960,mode$21146);}else{if(($21152$21176&&((t0$21166===2)&&($21149$21161[0]==="js_new")))){(value$21993=$21149$21161[1]);return it$0$21156.expr((("(new "+it$0$21156.translate(value$21993,"expr"))+")"),mode$21146);}else{if(($21152$21176&&(($21154$21178=((t0$21166>=1)&&(t0$21166<=2)))&&(($21149$21161[0]==="js_break")&&((t1$21167=function(){if((1>=t0$21166)){return ["value",null];}else{return $21149$21161[1];}}()),((t1$21167 instanceof Array)&&((t2$21168=t1$21167.length),((t2$21168===2)&&(t1$21167[0]==="value"))))))))){(label$21998=t1$21167[1]);if((mode$21146==="expr")){throw "Invalid break in ctx";}else{return (("break"+function(){if(label$21998){return (" "+label$21998);}else{return "";}}())+";");}}else{if(($21154$21178&&(($21149$21161[0]==="js_continue")&&((t1$21167=function(){if((1>=t0$21166)){return ["value",null];}else{return $21149$21161[1];}}()),((t1$21167 instanceof Array)&&((t2$21168=t1$21167.length),((t2$21168===2)&&(t1$21167[0]==="value")))))))){(label$22005=t1$21167[1]);if((mode$21146==="expr")){throw "Invalid continue in ctx";}else{return (("continue"+function(){if(label$22005){return (" "+label$22005);}else{return "";}}())+";");}}else{if(($21152$21176&&(($21154$21178=(t0$21166===2))&&($21149$21161[0]==="js_return")))){(value$22012=$21149$21161[1]);if((mode$21146==="expr")){throw "Invalid return in ctx";}else{return (("return "+it$0$21156.translate(value$22012,"expr"))+";");}}else{if(($21154$21178&&($21149$21161[0]==="js_delete"))){(value$22017=$21149$21161[1]);if((mode$21146==="expr")){throw "Invalid delete in ctx";}else{return (("delete "+it$0$21156.translate(value$22017,"expr"))+";");}}else{if(($21154$21178&&($21149$21161[0]==="js_throw"))){(value$22022=$21149$21161[1]);if((mode$21146==="expr")){return (("function(){throw "+it$0$21156.translate(value$22022,"expr"))+";}()");}else{return (("throw "+it$0$21156.translate(value$22022,"expr"))+";");}}else{if(($21152$21176&&(($21154$21178=(t0$21166===3))&&(($21149$21161[0]==="js_label")&&((t1$21167=$21149$21161[1]),((t1$21167 instanceof Array)&&((t2$21168=t1$21167.length),((t2$21168===2)&&(t1$21167[0]==="value"))))))))){(label$22027=t1$21167[1]);(body$22028=$21149$21161[2]);($22033$22035=mode$21146);;if(($22033$22035==="expr")){return it$0$21156.body(expr$21145,"expr");}else{(other$22047=$22033$22035);return ((label$22027+":")+it$0$21156.translate(body$22028,other$22047));}}else{if(($21154$21178&&($21149$21161[0]==="js_while"))){(test$22051=$21149$21161[1]);(body$22052=$21149$21161[2]);($22055$22057=mode$21146);;if(($22055$22057==="expr")){return it$0$21156.body(expr$21145,"expr");}else{(other$22069=$22055$22057);(a$22072=it$0$21156.translate(test$22051,"expr"));;(b$22073=it$0$21156.translate(body$22052,"stmt"));;return (((("while("+a$22072)+"){")+b$22073)+"}");}}else{if(($21152$21176&&((t0$21166===5)&&($21149$21161[0]==="js_for")))){(x$22082=$21149$21161[1]);(y$22083=$21149$21161[2]);(z$22084=$21149$21161[3]);(body$22085=$21149$21161[4]);($22088$22090=mode$21146);;if(($22088$22090==="expr")){return it$0$21156.body(expr$21145,"expr");}else{(other$22102=$22088$22090);(a$22105=it$0$21156.translate(x$22082,"stmt"));;(b$22106=it$0$21156.translate(y$22083,"stmt"));;(c$22107=it$0$21156.translate(z$22084,"expr"));;(d$22108=it$0$21156.translate(body$22085,"stmt"));;return (((((("for("+a$22105)+b$22106)+c$22107)+"){")+d$22108)+"}");}}else{if(($21152$21176&&(($21154$21178=(t0$21166===4))&&($21149$21161[0]==="js_for_in")))){(x$22123=$21149$21161[1]);(y$22124=$21149$21161[2]);(body$22125=$21149$21161[3]);($22128$22130=mode$21146);;if(($22128$22130==="expr")){return it$0$21156.body(expr$21145,"expr");}else{(other$22142=$22128$22130);(a$22145=it$0$21156.translate(x$22123,"expr"));;(b$22146=it$0$21156.translate(y$22124,"expr"));;(c$22147=it$0$21156.translate(body$22125,"stmt"));;return (((((("for("+a$22145)+" in ")+b$22146)+"){")+c$22147)+"}");}}else{if(($21154$21178&&(($21149$21161[0]==="js_try")&&((attempt$22159=$21149$21161[1]),((t1$21167=$21149$21161[2]),((t1$21167 instanceof Array)&&((t2$21168=t1$21167.length),((t2$21168===3)&&((t1$21167[0]==="lambda")&&((t3$21169=t1$21167[1]),((t3$21169 instanceof Array)&&((t4$21170=t3$21169.length),((t4$21170===1)&&((bridge$21151$21172=t3$21169[0]),((((bridge$21151$21172 instanceof Array)&&((t0$22170=bridge$21151$21172.length),((t0$22170===2)&&((bridge$21151$21172[0]==="symbol")&&((v$22160=bridge$21151$21172[1]),true)))))||((bridge$21151$21172 instanceof Array)&&((t0$22174=bridge$21151$21172.length),((t0$22174===2)&&((bridge$21151$21172[0]==="variable")&&((v$22160=bridge$21151$21172[1]),true))))))&&((body$22161=t1$21167[2]),((t5$21173=$21149$21161[3]),((t5$21173 instanceof Array)&&((t6$21174=t5$21173.length),((t6$21174===1)&&(t5$21173[0]==="void"))))))))))))))))))))){($22181$22183=mode$21146);;if(($22181$22183==="expr")){return it$0$21156.body(expr$21145,"expr");}else{(other$22195=$22181$22183);(a$22198=it$0$21156.translate(attempt$22159,"stmt"));;(b$22199=it$0$21156.translate(body$22161,"stmt"));;return (((((("try{"+a$22198)+"}catch(")+v$22160)+"){")+b$22199)+"}");}}else{if(($21152$21176&&((t0$21166===2)&&($21149$21161[0]==="raw")))){(x$22208=$21149$21161[1]);return x$22208;}else{(other$22213=$21149$21161);throw other$22213;}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}});$22429(Translator$20827,$22429(((accum$22216=({})),((accum$22216["::name"]="Translator"),accum$22216)),((accum$22220=({})),((accum$22220["::egclass"]=true),accum$22220))));Translator$20827;(translate$20828=function(expr$22226,mode$22227){var tr$22230;var t$22231;(tr$22230=Translator$20827());;(t$22231=tr$22230.translate(expr$22226,mode$22227));;return (tr$22230.dump_store()+t$22231);});;(exports["Translator"]=Translator$20827);(exports["translate"]=translate$20828);

},{"./pp":11,"./util":14}],14:[function(require,module,exports){
var $22672=function(type$22674){var f$22677;(f$22677=type$22674["::check"]);;if((f$22677===(void 0))){return function(value$22682){return (value$22682 instanceof type$22674);};}else{return function(value$22685){return f$22677.call(type$22674,value$22685);};}};
var $22687=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $22688=function($22689$22691){var ph$22695;(ph$22695=$22689$22691);;var $22693$22700;($22693$22700=ph$22695);;var bridge$22694$22705;var x$22709;(bridge$22694$22705=$22693$22700);if((((typeof(bridge$22694$22705)==="string")&&((x$22709=bridge$22694$22705),true))||((typeof(bridge$22694$22705)==="number")&&((x$22709=bridge$22694$22705),true)))){return ["value",x$22709];}else{var other$22716;(other$22716=$22693$22700);return other$22716["::serialize_ast"]();}};
var send$22512;(send$22512=function(obj$22517,$22515$22518){var ph$22522;var msg$22523;var t0$22525;(t0$22525=$22515$22518);(msg$22523=t0$22525);(ph$22522=t0$22525);;var $22520$22529;($22520$22529=ph$22522);;var bridge$22521$22534;(bridge$22521$22534=$22520$22529);if(((typeof(bridge$22521$22534)==="string")||(typeof(bridge$22521$22534)==="number"))){return obj$22517[msg$22523];}else{var other$22542;(other$22542=$22520$22529);return obj$22517["::send"](msg$22523);}});;(Array[":::project"]=function($22545$22547){var ph$22550;var value$22551;var t0$22553;(t0$22553=$22545$22547);(value$22551=t0$22553);(ph$22550=t0$22553);;var $22549$22557;($22549$22557=ph$22550);;if($22672(Array)($22549$22557)){return [true,value$22551];}else{$22549$22557;return [true,[value$22551]];}});(Array.prototype["::check"]=function(value$22571){if((value$22571 instanceof Array)){var i$22576;(i$22576=0);;$22574:for(;(i$22576<this.length);(i$22576++)){if(($22687(this,i$22576)!==$22687(value$22571,i$22576))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$22587){if((value$22587 instanceof Array)){var i$22592;(i$22592=0);;$22590:for(;(i$22592<this.length);(i$22592++)){if(($22687(this,i$22592)!==$22687(value$22587,i$22592))){return [true,[value$22587]];}}return [true,value$22587.slice(this.length)];}else{return [true,[value$22587]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($22688));});(RegExp.prototype["::check"]=function($22602$22604){var ph$22607;(ph$22607=$22602$22604);;var $22606$22612;($22606$22612=ph$22607);;var value$22620;if((typeof($22606$22612)==="string")){(value$22620=$22606$22612);if(value$22620.match(this)){return true;}else{return false;}}else{var other$22625;(other$22625=$22606$22612);return false;}});(RegExp.prototype[":::project"]=function($22627$22629){var ph$22632;(ph$22632=$22627$22629);;var $22631$22637;($22631$22637=ph$22632);;var value$22645;if((typeof($22631$22637)==="string")){(value$22645=$22631$22637);var $22648$22650;($22648$22650=value$22645.match(this));;var m$22658;if(($22648$22650===null)){(m$22658=$22648$22650);return [false,null];}else{var m$22663;(m$22663=$22648$22650);return [true,m$22663];}}else{var other$22667;(other$22667=$22631$22637);return [false,null];}});(Function.prototype["::send"]=function(args$22670){return this.apply(this,args$22670);});
var $23542=function(arr$23544){var results$23548;var l$23549;(results$23548=[]);;(l$23549=arr$23544.length);;var i$23557;(i$23557=0);;$23547:for(;(i$23557<l$23549);(i$23557++)){results$23548.push([i$23557,$22687(arr$23544,i$23557)]);}return results$23548;};
var $23564=function(dest$23566,values$23567){var k$23572;(k$23572=null);$23570:for(k$23572 in values$23567){if(values$23567.hasOwnProperty(k$23572)){(dest$23566[k$23572]=values$23567[k$23572]);}}return dest$23566;};
var $23388=function(){var $23389$23391;($23389$23391=function(tags$23395){var it$0$23398;(it$0$23398=function(){if((!$22672($23389$23391)(this))){return Object.create($23389$23391.prototype);}else{return this;}}());;(it$0$23398["tags"]=tags$23395);return it$0$23398;});;($23389$23391.prototype["create"]=function(){var $23407$23409;($23407$23409=arguments);;var t0$23414;var message$23418;var args$23419;(t0$23414=$23407$23409.length);if((t0$23414>=0)){(message$23418=function(){if((0>=t0$23414)){return "";}else{return $23407$23409[0];}}());(args$23419=Array.prototype.slice.call($23407$23409,1));var it$0$23423;(it$0$23423=this);;var e$23428;(e$23428=Error(message$23418));;(e$23428["::tags"]=it$0$23423.tags);(e$23428["args"]=args$23419);var temp$23436;(temp$23436=$23542(args$23419));;var $length$23441;($length$23441=temp$23436.length);;var $index$23446;($index$23446=0);;$23429:for(;($index$23446<$length$23441);($index$23446++)){var m$23454;(m$23454=temp$23436[$index$23446]);;var t0$23459;var t1$23460;var i$23464;var arg$23465;(t0$23459=m$23454);if(((t0$23459 instanceof Array)&&((t1$23460=t0$23459.length),(t1$23460===2)))){(i$23464=t0$23459[0]);(arg$23465=t0$23459[1]);(e$23428[i$23464]=arg$23465);}else{$23375(m$23454);;}}(e$23428["length"]=args$23419.length);(e$23428["name"]=["E"].concat(it$0$23423.tags).join("."));return e$23428;}else{$23375($23407$23409);}});($23389$23391.prototype["::check"]=function(e$23476){var it$0$23479;(it$0$23479=this);;var tags$23484;if(((!e$23476)||(!$22672(Error)(e$23476)))){return false;}(tags$23484=(e$23476["::tags"]||[]));;var temp$23493;(temp$23493=it$0$23479.tags);;var $length$23498;($length$23498=temp$23493.length);;var $index$23503;($index$23503=0);;$23485:for(;($index$23503<$length$23498);($index$23503++)){var m$23511;(m$23511=temp$23493[$index$23503]);;var tag$23519;(tag$23519=m$23511);if((tags$23484.indexOf(tag$23519)===-1)){return false;}else{false;;}}return true;});($23389$23391.prototype["::deconstruct"]=function(e$23527){var it$0$23530;(it$0$23530=this);;return e$23527.args;});$23564($23389$23391,$23564(function(){var accum$23535;(accum$23535=({}));(accum$23535["::name"]="$23389");return accum$23535;}(),function(){var accum$23539;(accum$23539=({}));(accum$23539["::egclass"]=true);return accum$23539;}()));return $23389$23391;}();
var $23375=function(value$23377,url$23378,start$23379,end$23380){var err$23383;(err$23383=$23388(["match"]).create("Could not find a match for value",({"value":value$23377})));;if(url$23378){(err$23383["location"]=["location",url$23378,start$23379,end$23380]);}throw err$23383;};var GenSym$22719;var gensym$22720;var uuid$22721;var identity$22722;var items$22723;var keys$22724;var enumerate$22725;var binsearch$22726;var __classify$22727;var classify$22728;var classify_contiguous$22729;var neighbours$22730;var zip$22731;var partition$22732;var construct$22733;var set$22734;var make_object$22735;(GenSym$22719=function(prefix$22739){var id$22742;(id$22742=0);;return function(){var r$22762;var pfx$22758;var t0$22754;var $22747$22749;($22747$22749=arguments);;(t0$22754=$22747$22749.length);if(((t0$22754>=0)&&(t0$22754<=1))){(pfx$22758=function(){if((0>=t0$22754)){return null;}else{return $22747$22749[0];}}());(r$22762=(((pfx$22758||"")+prefix$22739)+[true,String(id$22742)][1]));;(id$22742++);return r$22762;}else{$23375($22747$22749);}};});;(gensym$22720=GenSym$22719("$"));;(uuid$22721=function(){return gensym$22720("#");});;(identity$22722=function(x$22780){return x$22780;});;(items$22723=function(obj$22786){var k$22795;var results$22790;(results$22790=[]);;(k$22795=null);$22789:for(k$22795 in obj$22786){if(Object.prototype.hasOwnProperty.call(obj$22786,k$22795)){results$22790.push([k$22795,$22687(obj$22786,k$22795)]);}}return results$22790;});;(keys$22724=function(obj$22803){var k$22812;var results$22807;(results$22807=[]);;(k$22812=null);$22806:for(k$22812 in obj$22803){if(Object.prototype.hasOwnProperty.call(obj$22803,k$22812)){results$22807.push(k$22812);}}return results$22807;});;(enumerate$22725=function(arr$22820){var i$22833;var results$22824;var l$22825;(results$22824=[]);;(l$22825=arr$22820.length);;(i$22833=0);;$22823:for(;(i$22833<l$22825);(i$22833++)){results$22824.push([i$22833,$22687(arr$22820,i$22833)]);}return results$22824;});;(binsearch$22726=function(xs$22844,x$22845){var lo$22848;var hi$22849;(lo$22848=0);;(hi$22849=(xs$22844.length-1));;$22856:while((lo$22848<=hi$22849)){var $22860$22870;var mid$22861;var v$22862;(mid$22861=(lo$22848+((hi$22849-lo$22848)>>1)));;(v$22862=$22687(xs$22844,mid$22861));;($22860$22870=$22687(xs$22844,mid$22861));;if(($22860$22870<x$22845)){(lo$22848=(mid$22861+1));}else{if(($22860$22870>x$22845)){(hi$22849=(mid$22861-1));}else{$22860$22870;return (mid$22861+1);}}}return lo$22848;});;(__classify$22727=function(xs$22891){var results$22894;(results$22894=({}));;$22898:while(xs$22891.length){var cls$22924;var x$22925;var newxs$22918;var $22902$22913;var $22903$22914;var $22904$22915;var t0$22911;var $22901$22906;($22901$22906=xs$22891.shift());;if((($22902$22913=($22901$22906 instanceof Array))&&((t0$22911=$22901$22906.length),(($22904$22915=(t0$22911===2))&&($22901$22906[0]==="splice"))))){(newxs$22918=$22901$22906[1]);(xs$22891=newxs$22918.concat(xs$22891));}else{if($22904$22915){(cls$22924=$22901$22906[0]);(x$22925=$22901$22906[1]);if((!$22687(results$22894,cls$22924))){(results$22894[cls$22924]=[]);}$22687(results$22894,cls$22924).push(x$22925);}else{$23375($22901$22906);;}}}return results$22894;});;(classify$22728=function(){var $index$22970;var $length$22965;var temp$22960;var results$22952;var classes$22947;var xs$22948;var t0$22943;var $22936$22938;($22936$22938=arguments);;(t0$22943=$22936$22938.length);if((t0$22943>=1)){(classes$22947=Array.prototype.slice.call($22936$22938,0,-1));(xs$22948=$22936$22938[(t0$22943-1)]);(results$22952=({"rest":[]}));;(temp$22960=classes$22947);;($length$22965=temp$22960.length);;($index$22970=0);;$22953:for(;($index$22970<$length$22965);($index$22970++)){var cls$22986;var m$22978;(m$22978=temp$22960[$index$22970]);;(cls$22986=m$22978);(results$22952[cls$22986]=[]);}$22988:while(xs$22948.length){var x$23010;var other$23026;var cls$23017;var x$23018;var newxs$23002;var t0$22998;var $22991$22993;($22991$22993=xs$22948.shift());;if((($22991$22993 instanceof Array)&&((t0$22998=$22991$22993.length),((t0$22998>=1)&&($22991$22993[0]==="splice"))))){(newxs$23002=Array.prototype.slice.call($22991$22993,1));(xs$22948=newxs$23002.concat(xs$22948));}else{if((((x$23010=$22991$22993)),((x$23010 instanceof Array)&&(x$23010[0]==="ignore")))){null;}else{if((($22991$22993 instanceof Array)&&((t0$22998=$22991$22993.length),((t0$22998===2)&&((cls$23017=$22991$22993[0]),((x$23018=$22991$22993[1]),$22687(results$22952,cls$23017))))))){$22687(results$22952,cls$23017).push(x$23018);}else{(other$23026=$22991$22993);results$22952.rest.push(other$23026);}}}}return results$22952;}else{$23375($22936$22938);}});;(classify_contiguous$22729=function(xs$23034,classifier$23035){var $index$23064;var $length$23059;var temp$23054;var groups$23038;var currcls$23039;var curr$23040;(groups$23038=[]);;(currcls$23039=null);;(curr$23040=null);;(temp$23054=xs$23034);;($length$23059=temp$23054.length);;($index$23064=0);;$23041:for(;($index$23064<$length$23059);($index$23064++)){var cls$23083;var x$23080;var m$23072;(m$23072=temp$23054[$index$23064]);;(x$23080=m$23072);(cls$23083=classifier$23035(x$23080));;if((cls$23083===currcls$23039)){curr$23040.push(x$23080);}else{if(curr$23040){groups$23038.push(curr$23040);}(curr$23040=[cls$23083,x$23080]);(currcls$23039=cls$23083);}}if(curr$23040){groups$23038.push(curr$23040);}return groups$23038;});;(neighbours$22730=function($23093$23095){var x$23126;var y$23127;var rest$23128;var x$23121;var $23098$23112;var $23099$23113;var t0$23110;var $23097$23105;var ph$23100;(ph$23100=$23093$23095);;($23097$23105=ph$23100);;if((($23098$23112=($23097$23105 instanceof Array))&&((t0$23110=$23097$23105.length),(t0$23110===0)))){return [];}else{if(($23098$23112&&(t0$23110===1))){(x$23121=$23097$23105[0]);return [];}else{if(($23098$23112&&(t0$23110>=2))){(x$23126=$23097$23105[0]);(y$23127=$23097$23105[1]);(rest$23128=Array.prototype.slice.call($23097$23105,2));return [[x$23126,y$23127]].concat(neighbours$22730([y$23127].concat(rest$23128)));}else{$23375($23097$23105);}}}});;(zip$22731=function(xs$23137,ys$23138){var $index$23158;var $length$23153;var temp$23148;var acc$23143;(acc$23143=[]);;(temp$23148=enumerate$22725(xs$23137));;($length$23153=temp$23148.length);;($index$23158=0);;$23140:for(;($index$23158<$length$23153);($index$23158++)){var i$23176;var x$23177;var t0$23171;var t1$23172;var m$23166;(m$23166=temp$23148[$index$23158]);;(t0$23171=m$23166);if(((t0$23171 instanceof Array)&&((t1$23172=t0$23171.length),(t1$23172===2)))){(i$23176=t0$23171[0]);(x$23177=t0$23171[1]);acc$23143.push([x$23177,$22687(ys$23138,i$23176)]);}else{$23375(m$23166,"/home/olivier/git/earl-grey/src/util.eg",2248,2300);;}}return acc$23143;});;(partition$22732=function(xs$23187,predicate$23188){var $index$23213;var $length$23208;var temp$23203;var t$23191;var f$23192;(t$23191=[]);;(f$23192=[]);;(temp$23203=xs$23187);;($length$23208=temp$23203.length);;($index$23213=0);;$23193:for(;($index$23213<$length$23208);($index$23213++)){var x$23234;var x$23229;var m$23221;(m$23221=temp$23203[$index$23213]);;(x$23229=m$23221);if(predicate$23188(x$23229)){t$23191.push(x$23229);}else{(x$23234=m$23221);f$23192.push(x$23234);}}return [t$23191,f$23192];});;(construct$22733=function($23239$23241,fn$23242,zero$23243){var x$23274;var rest$23275;var x$23269;var $23246$23260;var $23247$23261;var t0$23258;var $23245$23253;var ph$23248;(ph$23248=$23239$23241);;($23245$23253=ph$23248);;if((($23246$23260=($23245$23253 instanceof Array))&&((t0$23258=$23245$23253.length),(t0$23258===0)))){return zero$23243;}else{if(($23246$23260&&(t0$23258===1))){(x$23269=$23245$23253[0]);return x$23269;}else{if(($23246$23260&&(t0$23258>=1))){(x$23274=$23245$23253[0]);(rest$23275=Array.prototype.slice.call($23245$23253,1));return fn$23242(x$23274,construct$22733(rest$23275,fn$23242,zero$23243));}else{$23375($23245$23253);}}}});;(set$22734=function(xs$23284){var $index$23305;var $length$23300;var temp$23295;var rval$23287;(rval$23287=({}));;(temp$23295=xs$23284);;($length$23300=temp$23295.length);;($index$23305=0);;$23288:for(;($index$23305<$length$23300);($index$23305++)){var x$23321;var m$23313;(m$23313=temp$23295[$index$23305]);;(x$23321=m$23313);(rval$23287[x$23321]=true);}return rval$23287;});;(make_object$22735=function(pairs$23327){var $index$23348;var $length$23343;var temp$23338;var rval$23330;(rval$23330=({}));;(temp$23338=pairs$23327);;($length$23343=temp$23338.length);;($index$23348=0);;$23331:for(;($index$23348<$length$23343);($index$23348++)){var k$23366;var v$23367;var t0$23361;var t1$23362;var m$23356;(m$23356=temp$23338[$index$23348]);;(t0$23361=m$23356);if(((t0$23361 instanceof Array)&&((t1$23362=t0$23361.length),(t1$23362===2)))){(k$23366=t0$23361[0]);(v$23367=t0$23361[1]);(rval$23330[k$23366]=v$23367);}else{$23375(m$23356,"/home/olivier/git/earl-grey/src/util.eg",2652,2695);;}}return rval$23330;});;(exports["GenSym"]=GenSym$22719);(exports["gensym"]=gensym$22720);(exports["uuid"]=uuid$22721);(exports["identity"]=identity$22722);(exports["items"]=items$22723);(exports["keys"]=keys$22724);(exports["enumerate"]=enumerate$22725);(exports["binsearch"]=binsearch$22726);(exports["classify"]=classify$22728);(exports["classify_contiguous"]=classify_contiguous$22729);(exports["neighbours"]=neighbours$22730);(exports["zip"]=zip$22731);(exports["partition"]=partition$22732);(exports["construct"]=construct$22733);(exports["set"]=set$22734);(exports["make_object"]=make_object$22735);

},{}],15:[function(require,module,exports){

},{}]},{},[])