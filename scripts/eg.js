require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var $140=function(type$142){var f$145;(f$145=type$142["::check"]);;if((f$145===(void 0))){return function(value$150){return (value$150 instanceof type$142);};}else{return function(value$153){return f$145.call(type$142,value$153);};}};
var $155=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $156=function($157$159){var ph$163;(ph$163=$157$159);;var $161$168;($161$168=ph$163);;var bridge$162$173;var x$177;(bridge$162$173=$161$168);if((((typeof(bridge$162$173)==="string")&&((x$177=bridge$162$173),true))||((typeof(bridge$162$173)==="number")&&((x$177=bridge$162$173),true)))){return ["value",x$177];}else{var other$184;(other$184=$161$168);return other$184["::serialize_ast"]();}};
var send$24;(send$24=function(obj$29,$27$30){var ph$34;var msg$35;var t0$37;(t0$37=$27$30);(msg$35=t0$37);(ph$34=t0$37);;var $32$41;($32$41=ph$34);;var bridge$33$46;(bridge$33$46=$32$41);if(((typeof(bridge$33$46)==="string")||(typeof(bridge$33$46)==="number"))){return obj$29[msg$35];}else{var other$54;(other$54=$32$41);return obj$29["::send"](msg$35);}});;(Array[":::project"]=function($57$59){var ph$62;var value$63;var t0$65;(t0$65=$57$59);(value$63=t0$65);(ph$62=t0$65);;var $61$69;($61$69=ph$62);;if($140(Array)($61$69)){return [true,value$63];}else{$61$69;return [true,[value$63]];}});(Array.prototype["::check"]=function(value$83){if((value$83 instanceof Array)){var i$88;(i$88=0);;$86:for(;(i$88<this.length);(i$88++)){if(($155(this,i$88)!==$155(value$83,i$88))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$99){if((value$99 instanceof Array)){var i$104;(i$104=0);;$102:for(;(i$104<this.length);(i$104++)){if(($155(this,i$104)!==$155(value$99,i$104))){return [true,[value$99]];}}return [true,value$99.slice(this.length)];}else{return [true,[value$99]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($156));});(RegExp.prototype["::check"]=function(value$115){return value$115.match(this);});(RegExp.prototype[":::project"]=function(value$118){var $120$122;($120$122=value$118.match(this));;var m$130;if(($120$122===null)){(m$130=$120$122);return [false,null];}else{var m$135;(m$135=$120$122);return [true,m$135];}});(Function.prototype["::send"]=function(args$138){return this.apply(this,args$138);});
var $572=function(dest$574,values$575){var k$580;(k$580=null);$578:for(k$580 in values$575){if(values$575.hasOwnProperty(k$580)){(dest$574[k$580]=values$575[k$580]);}}return dest$574;};
var $710=function(obj$712){var results$716;(results$716=[]);;var k$721;(k$721=null);$715:for(k$721 in obj$712){if(Object.prototype.hasOwnProperty.call(obj$712,k$721)){results$716.push(k$721);}}return results$716;};
var $725=function($726$728,key$729){var ph$733;(ph$733=$726$728);;var $731$738;($731$738=ph$733);;var bridge$732$743;(bridge$732$743=$731$738);if(((bridge$732$743===null)||(bridge$732$743===(void 0)))){return false;}else{var x$751;if((typeof($731$738)==="string")){(x$751=$731$738);return (key$729 in String.prototype);}else{var x$756;if((typeof($731$738)==="number")){(x$756=$731$738);return (key$729 in Number.prototype);}else{var x$761;(x$761=$731$738);return (key$729 in x$761);}}}};
var $589=function($590$592,b$593){var ph$599;var a$600;var t0$602;(t0$602=$590$592);(a$600=t0$602);(ph$599=t0$602);;var $595$606;($595$606=ph$599);;var bridge$596$611;if(($595$606===b$593)){return true;}else{(bridge$596$611=$595$606);if((function(){var bridge$597$621;(bridge$597$621=bridge$596$611);return (function(){var bridge$598$624;(bridge$598$624=bridge$597$621);return ((typeof(bridge$598$624)==="number")||(typeof(bridge$598$624)==="string"));}()||(bridge$597$621===null));}()||(bridge$596$611===(void 0)))){return false;}else{if($140(Array)($595$606)){if(((!$140(Array)(b$593))||(a$600.length!==b$593.length))){return false;}var i$635;(i$635=0);;$632:for(;(i$635<a$600.length);(i$635++)){if((!$589(a$600[i$635],b$593[i$635]))){return false;}}return true;}else{$595$606;if(((Object.getPrototypeOf(a$600)===Object.prototype)&&(Object.getPrototypeOf(b$593)===Object.prototype))){var ka$648;(ka$648=$710(a$600));;if((!$589(ka$648.sort(),$710(b$593).sort()))){return false;}var temp$657;(temp$657=ka$648);;var $length$662;($length$662=temp$657.length);;var $index$667;($index$667=0);;$649:for(;($index$667<$length$662);($index$667++)){var m$675;(m$675=temp$657[$index$667]);;var k$683;(k$683=m$675);if((!$589(a$600[k$683],b$593[k$683]))){return false;}}return true;}else{if($725($595$606,"::serialize")){$595$606["::serialize"];var $690$692;($690$692=b$593);;if($725($690$692,"::serialize")){$690$692["::serialize"];return $589(a$600["::serialize"](),b$593["::serialize"]());}else{var otherwise$704;(otherwise$704=$690$692);return false;}}else{var otherwise$708;(otherwise$708=$595$606);return false;}}}}}};
var $584=function(x$586,y$587){return (!$589(x$586,y$587));};var accum$564;var accum$568;var keynames$187;var prevent$188;var Interactor$189;(keynames$187=({8:"Backspace",9:"Tab",13:"Enter",16:"S-",17:"C-",18:"A-",27:"Esc",32:"Space",33:"PgUp",34:"PgDn",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12"}));;(prevent$188=function(event$196){event$196.preventDefault();return event$196.stopPropagation();});;(Interactor$189=function(target$203){var accum$213;var accum$219;var accum$225;var accum$231;var it$0$206;(it$0$206=function(){if((!$140(Interactor$189)(this))){return Object.create(Interactor$189.prototype);}else{return this;}}());;(it$0$206["functions"]=(target$203.interactor_functions||target$203));(it$0$206["more_functions"]=$572(((accum$213=({})),((accum$213["default"]=function(){return "default";}),accum$213)),$572(((accum$219=({})),((accum$219["stick"]=function(){return "stick";}),accum$219)),$572(((accum$225=({})),((accum$225["break"]=function(){return "break";}),accum$225)),((accum$231=({})),((accum$231["none"]=function(){return (void 0);}),accum$231))))));(it$0$206["current_bindings"]=null);(it$0$206["global_bindings"]=null);return it$0$206;});;(Interactor$189.prototype["set_bindings"]=function(new_bindings$240){var it$0$243;(it$0$243=this);;(it$0$243["current_bindings"]=null);return (it$0$243["global_bindings"]=new_bindings$240);});(Interactor$189.prototype["execute"]=function(c$251,e$252){var f$273;var $index$306;var $length$301;var temp$296;var result$288;var cmd$352;var cmds$284;var f$279;var cmd$269;var $255$261;var it$0$256;(it$0$256=this);;($255$261=c$251);;if((typeof($255$261)==="string")){(cmd$269=$255$261);(f$273=($155(it$0$256.functions,cmd$269)||$155(it$0$256.more_functions,cmd$269)));;return f$273(e$252);}else{if($140(Function)($255$261)){(f$279=$255$261);return f$279(it$0$256.target,e$252);}else{if($140(Array)($255$261)){(cmds$284=$255$261);(result$288=null);;(temp$296=cmds$284);;($length$301=temp$296.length);;($index$306=0);;$289:for(;($index$306<$length$301);($index$306++)){var other$348;var $325$327;var cmd$322;var m$314;(m$314=temp$296[$index$306]);;(cmd$322=m$314);(result$288=it$0$256.execute(cmd$322,e$252));($325$327=result$288);;if(($325$327==="break")){prevent$188(e$252);break $289;}else{if(($325$327==="default")){break $289;}else{if(($325$327==="ignore")){continue $289;}else{(other$348=$325$327);prevent$188(e$252);}}}}return result$288;}else{(cmd$352=$255$261);(it$0$256["current_bindings"]=cmd$352);return "break stick";}}}});(Interactor$189.prototype["process_codes"]=function(codes$358,e$359){var $index$394;var $length$389;var temp$384;var otherwise$460;var $433$441;var $432$435;var result$466;var t0$425;var $367$420;var bindings$368;var just_modifiers$369;var commands$370;var it$0$362;(it$0$362=this);;(bindings$368=(it$0$362.current_bindings||it$0$362.global_bindings));;(just_modifiers$369=null);;(commands$370=[]);;(temp$384=codes$358);;($length$389=temp$384.length);;($index$394=0);;$371:for(;($index$394<$length$389);($index$394++)){var command$413;var code$410;var m$402;(m$402=temp$384[$index$394]);;(code$410=m$402);if($140(RegExp("^([ACS]-)+$",""))(code$410)){(just_modifiers$369=true);}(command$413=$155(bindings$368,code$410));;if($584(command$413,(void 0))){commands$370.push(command$413);}}($367$420=commands$370);;if((($367$420 instanceof Array)&&((t0$425=$367$420.length),(t0$425===0)))){($432$435=null);;$432$435;if((it$0$362.current_bindings&&it$0$362.current_bindings._eat)){if((!just_modifiers$369)){(it$0$362["current_bindings"]=null);}return prevent$188(e$359);}else{if((it$0$362.current_bindings&&it$0$362.current_bindings._browser)){if((!just_modifiers$369)){return (it$0$362["current_bindings"]=null);}}else{if((it$0$362.current_bindings&&(!just_modifiers$369))){(it$0$362["current_bindings"]=null);return it$0$362.process_codes(codes$358,e$359);}else{(otherwise$460=$432$435);return null;}}}}else{$367$420;(result$466=it$0$362.execute(commands$370,e$359));;if(($589(result$466,(void 0))||(result$466.match&&result$466.match("break")))){prevent$188(e$359);}if((((!((result$466&&result$466.match)&&result$466.match("stick")))&&it$0$362.current_bindings)&&(!it$0$362.current_bindings._stick))){return (it$0$362["current_bindings"]=null);}}});(Interactor$189.prototype["getcode"]=function(e$475){var otherwise$511;var $484$496;var $483$490;var code$485;var it$0$478;(it$0$478=this);;(code$485=($155(keynames$187,e$475.which)||(("<"+e$475.which)+">")));;($483$490=null);;$483$490;if((e$475.shiftKey&&$584(code$485,"S-"))){return ("S-"+code$485);}else{if((e$475.altKey&&$584(code$485,"A-"))){return ("A-"+code$485);}else{if(((e$475.ctrlKey||e$475.metaKey)&&$584(code$485,"C-"))){return ("C-"+code$485);}else{(otherwise$511=$483$490);return code$485;}}}});(Interactor$189.prototype["keyup"]=function(e$516){var it$0$519;(it$0$519=this);;return it$0$519.process_codes(["!^All",("^"+it$0$519.getcode(e$516)),"^All"],e$516);});(Interactor$189.prototype["keydown"]=function(e$526){var it$0$529;(it$0$529=this);;return it$0$529.process_codes(["!All",it$0$529.getcode(e$526),"All"],e$526);});(Interactor$189.prototype["keypress"]=function(e$536){var key$544;var code$545;var it$0$539;(it$0$539=this);;(key$544=e$536.which);;(code$545=("="+String.fromCharCode(key$544)));;return it$0$539.process_codes(["!=All",code$545,"=All"],e$536);});(Interactor$189.prototype["install"]=function(element$555){var it$0$558;(it$0$558=this);;(element$555["onkeydown"]=it$0$558.keydown.bind(it$0$558));(element$555["onkeyup"]=it$0$558.keyup.bind(it$0$558));return (element$555["onkeypress"]=it$0$558.keypress.bind(it$0$558));});$572(Interactor$189,$572(((accum$564=({})),((accum$564["::name"]="Interactor"),accum$564)),((accum$568=({})),((accum$568["::egclass"]=true),accum$568))));Interactor$189;(exports["Interactor"]=Interactor$189);

},{}],"eXk3/i":[function(require,module,exports){
var $880=function(type$882){var f$885;(f$885=type$882["::check"]);;if((f$885===(void 0))){return function(value$890){return (value$890 instanceof type$882);};}else{return function(value$893){return f$885.call(type$882,value$893);};}};
var $895=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $896=function($897$899){var ph$903;(ph$903=$897$899);;var $901$908;($901$908=ph$903);;var bridge$902$913;var x$917;(bridge$902$913=$901$908);if((((typeof(bridge$902$913)==="string")&&((x$917=bridge$902$913),true))||((typeof(bridge$902$913)==="number")&&((x$917=bridge$902$913),true)))){return ["value",x$917];}else{var other$924;(other$924=$901$908);return other$924["::serialize_ast"]();}};
var send$764;(send$764=function(obj$769,$767$770){var ph$774;var msg$775;var t0$777;(t0$777=$767$770);(msg$775=t0$777);(ph$774=t0$777);;var $772$781;($772$781=ph$774);;var bridge$773$786;(bridge$773$786=$772$781);if(((typeof(bridge$773$786)==="string")||(typeof(bridge$773$786)==="number"))){return obj$769[msg$775];}else{var other$794;(other$794=$772$781);return obj$769["::send"](msg$775);}});;(Array[":::project"]=function($797$799){var ph$802;var value$803;var t0$805;(t0$805=$797$799);(value$803=t0$805);(ph$802=t0$805);;var $801$809;($801$809=ph$802);;if($880(Array)($801$809)){return [true,value$803];}else{$801$809;return [true,[value$803]];}});(Array.prototype["::check"]=function(value$823){if((value$823 instanceof Array)){var i$828;(i$828=0);;$826:for(;(i$828<this.length);(i$828++)){if(($895(this,i$828)!==$895(value$823,i$828))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$839){if((value$839 instanceof Array)){var i$844;(i$844=0);;$842:for(;(i$844<this.length);(i$844++)){if(($895(this,i$844)!==$895(value$839,i$844))){return [true,[value$839]];}}return [true,value$839.slice(this.length)];}else{return [true,[value$839]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($896));});(RegExp.prototype["::check"]=function(value$855){return value$855.match(this);});(RegExp.prototype[":::project"]=function(value$858){var $860$862;($860$862=value$858.match(this));;var m$870;if(($860$862===null)){(m$870=$860$862);return [false,null];}else{var m$875;(m$875=$860$862);return [true,m$875];}});(Function.prototype["::send"]=function(args$878){return this.apply(this,args$878);});
var $2195=function(obj$2197){var results$2201;(results$2201=[]);;var k$2206;(k$2206=null);$2200:for(k$2206 in obj$2197){if(Object.prototype.hasOwnProperty.call(obj$2197,k$2206)){results$2201.push([k$2206,$895(obj$2197,k$2206)]);}}return results$2201;};
var $2377=function(arr$2379){var results$2383;var l$2384;(results$2383=[]);;(l$2384=arr$2379.length);;var i$2392;(i$2392=0);;$2382:for(;(i$2392<l$2384);(i$2392++)){results$2383.push([i$2392,$895(arr$2379,i$2392)]);}return results$2383;};
var $2399=function(dest$2401,values$2402){var k$2407;(k$2407=null);$2405:for(k$2407 in values$2402){if(values$2402.hasOwnProperty(k$2407)){(dest$2401[k$2407]=values$2402[k$2407]);}}return dest$2401;};
var $2223=function(){var $2224$2226;($2224$2226=function(tags$2230){var it$0$2233;(it$0$2233=function(){if((!$880($2224$2226)(this))){return Object.create($2224$2226.prototype);}else{return this;}}());;(it$0$2233["tags"]=tags$2230);return it$0$2233;});;($2224$2226.prototype["create"]=function(){var $2242$2244;($2242$2244=arguments);;var t0$2249;var message$2253;var args$2254;(t0$2249=$2242$2244.length);if((t0$2249>=0)){(message$2253=function(){if((0>=t0$2249)){return "";}else{return $2242$2244[0];}}());(args$2254=Array.prototype.slice.call($2242$2244,1));var it$0$2258;(it$0$2258=this);;var e$2263;(e$2263=Error(message$2253));;(e$2263["::tags"]=it$0$2258.tags);(e$2263["args"]=args$2254);var temp$2271;(temp$2271=$2377(args$2254));;var $length$2276;($length$2276=temp$2271.length);;var $index$2281;($index$2281=0);;$2264:for(;($index$2281<$length$2276);($index$2281++)){var m$2289;(m$2289=temp$2271[$index$2281]);;var t0$2294;var t1$2295;var i$2299;var arg$2300;(t0$2294=m$2289);if(((t0$2294 instanceof Array)&&((t1$2295=t0$2294.length),(t1$2295===2)))){(i$2299=t0$2294[0]);(arg$2300=t0$2294[1]);(e$2263[i$2299]=arg$2300);}else{$2210(m$2289);;}}(e$2263["length"]=args$2254.length);(e$2263["name"]=["E"].concat(it$0$2258.tags).join("."));return e$2263;}else{$2210($2242$2244);}});($2224$2226.prototype["::check"]=function(e$2311){var it$0$2314;(it$0$2314=this);;var tags$2319;if(((!e$2311)||(!$880(Error)(e$2311)))){return false;}(tags$2319=(e$2311["::tags"]||[]));;var temp$2328;(temp$2328=it$0$2314.tags);;var $length$2333;($length$2333=temp$2328.length);;var $index$2338;($index$2338=0);;$2320:for(;($index$2338<$length$2333);($index$2338++)){var m$2346;(m$2346=temp$2328[$index$2338]);;var tag$2354;(tag$2354=m$2346);if((tags$2319.indexOf(tag$2354)===-1)){return false;}else{false;;}}return true;});($2224$2226.prototype["::deconstruct"]=function(e$2362){var it$0$2365;(it$0$2365=this);;return e$2362.args;});$2399($2224$2226,$2399(function(){var accum$2370;(accum$2370=({}));(accum$2370["::name"]="$2224");return accum$2370;}(),function(){var accum$2374;(accum$2374=({}));(accum$2374["::egclass"]=true);return accum$2374;}()));return $2224$2226;}();
var $2210=function(value$2212,url$2213,start$2214,end$2215){var err$2218;(err$2218=$2223(["match"]).create("Could not find a match for value",({"value":value$2212})));;if(url$2213){(err$2218["location"]=["location",url$2213,start$2214,end$2215]);}throw err$2218;};
var $2411=function(type$2413){return function(value$2416){var f$2419;(f$2419=type$2413[":::project"]);;if((f$2419===(void 0))){var f$2424;(f$2424=type$2413["::project"]);;if((f$2424===(void 0))){return [true,type$2413(value$2416)];}else{var rval$2429;(rval$2429=false);;try{(rval$2429=[true,f$2424(value$2416)]);}catch(excv$2435){var e$2441;(e$2441=excv$2435);(rval$2429=[false,null]);}return rval$2429;}}else{return f$2419.call(type$2413,value$2416);}};};
var $2443=function(){var $2444$2446;($2444$2446=function($2449$2452,$2450$2453){var classes$2455;var children$2456;var t0$2458;(t0$2458=$2411(Array)($2449$2452));if(t0$2458[0]){(classes$2455=t0$2458[1]);;}else{$2210($2449$2452);}var t0$2463;(t0$2463=$2411(Array)($2450$2453));if(t0$2463[0]){(children$2456=t0$2463[1]);;}else{$2210($2450$2453);}var it$0$2468;(it$0$2468=function(){if((!$880($2444$2446)(this))){return Object.create($2444$2446.prototype);}else{return this;}}());;(it$0$2468["classes"]=classes$2455.sort());(it$0$2468["children"]=children$2456);return it$0$2468;});;$2399(function(){var accum$2476;(accum$2476=({}));(accum$2476["::check"]=function(x$2480){return ((x$2480&&x$2480.classes)&&x$2480.children);});return accum$2476;}(),$2399(function(){var accum$2483;(accum$2483=({}));(accum$2483["::deconstruct"]=function(x$2487){return [x$2487.classes,x$2487.children];});return accum$2483;}(),$2399(function(){var accum$2490;(accum$2490=({}));(accum$2490["::name"]="$2444");return accum$2490;}(),function(){var accum$2494;(accum$2494=({}));(accum$2494["::egclass"]=true);return accum$2494;}())));($2444$2446.prototype["::check"]=function(n$2500){var it$0$2503;(it$0$2503=this);;var temp$2512;(temp$2512=it$0$2503.classes);;var $length$2517;($length$2517=temp$2512.length);;var $index$2522;($index$2522=0);;$2508:for(;($index$2522<$length$2517);($index$2522++)){var m$2530;(m$2530=temp$2512[$index$2522]);;var c$2538;(c$2538=m$2530);if((n$2500.classes.indexOf(c$2538)===-1)){return false;}else{false;;}}return true;});$2399($2444$2446,$2399(function(){var accum$2544;(accum$2544=({}));(accum$2544["::check"]=function(x$2548){return ((x$2548&&x$2548.classes)&&x$2548.children);});return accum$2544;}(),$2399(function(){var accum$2551;(accum$2551=({}));(accum$2551["::deconstruct"]=function(x$2555){return [x$2555.classes,x$2555.children];});return accum$2551;}(),$2399(function(){var accum$2558;(accum$2558=({}));(accum$2558["::name"]="$2444");return accum$2558;}(),function(){var accum$2562;(accum$2562=({}));(accum$2562["::egclass"]=true);return accum$2562;}()))));return $2444$2446;}();
var $2565=function($2566$2568,key$2569){var ph$2573;(ph$2573=$2566$2568);;var $2571$2578;($2571$2578=ph$2573);;var bridge$2572$2583;(bridge$2572$2583=$2571$2578);if(((bridge$2572$2583===null)||(bridge$2572$2583===(void 0)))){return false;}else{var x$2591;if((typeof($2571$2578)==="string")){(x$2591=$2571$2578);return (key$2569 in String.prototype);}else{var x$2596;if((typeof($2571$2578)==="number")){(x$2596=$2571$2578);return (key$2569 in Number.prototype);}else{var x$2601;(x$2601=$2571$2578);return (key$2569 in x$2601);}}}};
var $2724=function(obj$2726){var results$2730;(results$2730=[]);;var k$2735;(k$2735=null);$2729:for(k$2735 in obj$2726){if(Object.prototype.hasOwnProperty.call(obj$2726,k$2735)){results$2730.push(k$2735);}}return results$2730;};
var $2603=function($2604$2606,b$2607){var ph$2613;var a$2614;var t0$2616;(t0$2616=$2604$2606);(a$2614=t0$2616);(ph$2613=t0$2616);;var $2609$2620;($2609$2620=ph$2613);;var bridge$2610$2625;if(($2609$2620===b$2607)){return true;}else{(bridge$2610$2625=$2609$2620);if((function(){var bridge$2611$2635;(bridge$2611$2635=bridge$2610$2625);return (function(){var bridge$2612$2638;(bridge$2612$2638=bridge$2611$2635);return ((typeof(bridge$2612$2638)==="number")||(typeof(bridge$2612$2638)==="string"));}()||(bridge$2611$2635===null));}()||(bridge$2610$2625===(void 0)))){return false;}else{if($880(Array)($2609$2620)){if(((!$880(Array)(b$2607))||(a$2614.length!==b$2607.length))){return false;}var i$2649;(i$2649=0);;$2646:for(;(i$2649<a$2614.length);(i$2649++)){if((!$2603(a$2614[i$2649],b$2607[i$2649]))){return false;}}return true;}else{$2609$2620;if(((Object.getPrototypeOf(a$2614)===Object.prototype)&&(Object.getPrototypeOf(b$2607)===Object.prototype))){var ka$2662;(ka$2662=$2724(a$2614));;if((!$2603(ka$2662.sort(),$2724(b$2607).sort()))){return false;}var temp$2671;(temp$2671=ka$2662);;var $length$2676;($length$2676=temp$2671.length);;var $index$2681;($index$2681=0);;$2663:for(;($index$2681<$length$2676);($index$2681++)){var m$2689;(m$2689=temp$2671[$index$2681]);;var k$2697;(k$2697=m$2689);if((!$2603(a$2614[k$2697],b$2607[k$2697]))){return false;}}return true;}else{if($2565($2609$2620,"::serialize")){$2609$2620["::serialize"];var $2704$2706;($2704$2706=b$2607);;if($2565($2704$2706,"::serialize")){$2704$2706["::serialize"];return $2603(a$2614["::serialize"](),b$2607["::serialize"]());}else{var otherwise$2718;(otherwise$2718=$2704$2706);return false;}}else{var otherwise$2722;(otherwise$2722=$2609$2620);return false;}}}}}};
var $2755=function($2756$2758){var ph$2764;var x$2765;var t0$2767;(t0$2767=$2756$2758);(x$2765=t0$2767);(ph$2764=t0$2767);;var $2760$2771;($2760$2771=ph$2764);;var bridge$2761$2776;(bridge$2761$2776=$2760$2771);if((function(){var bridge$2762$2782;(bridge$2762$2782=bridge$2761$2776);return (function(){var bridge$2763$2785;(bridge$2763$2785=bridge$2762$2782);return ((bridge$2763$2785===(void 0))||(bridge$2763$2785===null));}()||(typeof(bridge$2762$2782)==="string"));}()||(typeof(bridge$2761$2776)==="number"))){return x$2765;}else{if($2565($2760$2771,"::clone")){$2760$2771["::clone"];return x$2765["::clone"]();}else{$2760$2771;if((Object.getPrototypeOf(x$2765)===Object.prototype)){var dest$2798;(dest$2798=({}));;var k$2803;(k$2803=null);$2797:for(k$2803 in x$2765){if(Object.prototype.hasOwnProperty.call(x$2765,k$2803)){(dest$2798[k$2803]=x$2765[k$2803]);}}return dest$2798;}else{var other$2809;(other$2809=$2760$2771);throw $2223(["clone"]).create("Object cannot be cloned",({"obj":x$2765}));}}}};
var $2739=function(a$2741,b$2742){var dest$2746;(dest$2746=$2755(a$2741));;var k$2751;(k$2751=null);$2745:for(k$2751 in b$2742){if(Object.prototype.hasOwnProperty.call(b$2742,k$2751)){(dest$2746[k$2751]=b$2742[k$2751]);}}return dest$2746;};var accum$2102;var accum$2106;var kb$933;var eg$934;var $929$935;var GenSym$936;var $930$937;var Location$938;var highlight_locations$939;var format_error$940;var $931$941;var tokenize$942;var $932$943;var parse$944;var gensym$945;var create_node$946;var make_dom$947;var mktable$948;var mktable2$949;var repr$950;var goto_end$951;var insert_before_caret$952;var Repl$953;var make_cards$954;(kb$933=require("./kb"));;(eg$934=require("../lib/earl-grey"));;($929$935=require("../lib/util"));;(GenSym$936=$929$935.GenSym);;($930$937=require("../lib/location"));;(Location$938=$930$937.Location);;(highlight_locations$939=$930$937.highlight_locations);;(format_error$940=$930$937.format_error);;($931$941=require("../lib/lex"));;(tokenize$942=$931$941.tokenize);;($932$943=require("../lib/parse"));;(parse$944=$932$943.parse);;(gensym$945=GenSym$936("io_"));;(create_node$946=function(tag$997,kv$998,contents$999){var $index$1022;var $length$1017;var temp$1012;var $index$1059;var $length$1054;var temp$1049;var node$1002;(node$1002=document.createElement(tag$997));;(temp$1012=$2195(kv$998));;($length$1017=temp$1012.length);;($index$1022=0);;$1003:for(;($index$1022<$length$1017);($index$1022++)){var k$1040;var v$1041;var t0$1035;var t1$1036;var m$1030;(m$1030=temp$1012[$index$1022]);;(t0$1035=m$1030);if(((t0$1035 instanceof Array)&&((t1$1036=t0$1035.length),(t1$1036===2)))){(k$1040=t0$1035[0]);(v$1041=t0$1035[1]);(node$1002[k$1040]=v$1041);}else{$2210(m$1030,"/home/olivier/git/egrepl/src/repl.eg",1782,1829);;}}(temp$1049=$2411(Array)(contents$999)[1]);;($length$1054=temp$1049.length);;($index$1059=0);;$1005:for(;($index$1059<$length$1054);($index$1059++)){var other$1081;var s$1076;var t0$1072;var m$1067;(m$1067=temp$1049[$index$1059]);;(t0$1072=m$1067);if((typeof(t0$1072)==="string")){(s$1076=t0$1072);node$1002.appendChild(document.createTextNode(s$1076));}else{(other$1081=m$1067);node$1002.appendChild(other$1081);}}return node$1002;});;(make_dom$947=function(){var $index$1137;var $length$1132;var temp$1127;var node$1119;var $index$1204;var $length$1199;var temp$1194;var $index$1274;var $length$1269;var temp$1264;var $index$1328;var $length$1323;var temp$1318;var acc$1313;var $index$1372;var $length$1367;var temp$1362;var acc$1357;var other$1352;var $1163$1300;var tag$1164;var _classes$1165;var id$1166;var kv$1167;var sub$1168;var node$1169;var other$1392;var classes$1157;var children$1158;var args$1115;var s$1110;var $1089$1107;var t0$1105;var default_tag$1100;var $1088$1101;var t0$1096;var $1087$1091;($1087$1091=arguments);;(t0$1096=$1087$1091.length);if(((t0$1096>=1)&&(t0$1096<=2))){($1088$1101=$1087$1091[0]);(default_tag$1100=function(){if((1>=t0$1096)){return "div";}else{return $1087$1091[1];}}());(t0$1105=$1088$1101);if((typeof(t0$1105)==="string")){(s$1110=t0$1105);return document.createTextNode(s$1110);}else{if($880(Array)(t0$1105)){(args$1115=t0$1105);(node$1119=document.createElement("span"));;(temp$1127=args$1115);;($length$1132=temp$1127.length);;($index$1137=0);;$1120:for(;($index$1137<$length$1132);($index$1137++)){var arg$1153;var m$1145;(m$1145=temp$1127[$index$1137]);;(arg$1153=m$1145);node$1119.appendChild(make_dom$947(arg$1153,default_tag$1100));}return node$1119;}else{if(($880($2443)(t0$1105)&&($2565(t0$1105,"classes")&&((classes$1157=t0$1105.classes),$2565(t0$1105,"children"))))){(children$1158=t0$1105.children);(tag$1164=default_tag$1100);;(_classes$1165=[]);;(id$1166=null);;(kv$1167=[]);;(sub$1168=[]);;(temp$1194=classes$1157);;($length$1199=temp$1194.length);;($index$1204=0);;$1170:for(;($index$1204<$length$1199);($index$1204++)){var s$1252;var m$1245;var m$1238;var k$1233;var k$1226;var v$1227;var $1172$1221;var $1173$1222;var $1174$1223;var t0$1217;var t1$1218;var t2$1219;var m$1212;(m$1212=temp$1194[$index$1204]);;(t0$1217=m$1212);if((($1173$1222=(t0$1217 instanceof Array))&&((t1$1218=t0$1217.length),((t1$1218===3)&&(t0$1217[0]==="assoc"))))){(k$1226=t0$1217[1]);(v$1227=t0$1217[2]);kv$1167.push([k$1226,v$1227]);}else{if(($1173$1222&&((t1$1218===2)&&(t0$1217[0]==="assoc")))){(k$1233=t0$1217[1]);kv$1167.push([k$1233,(void 0)]);}else{(t0$1217=$2411(RegExp("(?:^\\+((?:.*)))",""))(m$1212));if((t0$1217[0]&&((t1$1218=t0$1217[1]),((t2$1219=t1$1218.length),(t2$1219===2))))){t1$1218[0];(m$1238=t1$1218[1]);(tag$1164=m$1238);}else{(t0$1217=$2411(RegExp("(?:^#((?:.*)))",""))(m$1212));if((t0$1217[0]&&((t1$1218=t0$1217[1]),((t2$1219=t1$1218.length),(t2$1219===2))))){t1$1218[0];(m$1245=t1$1218[1]);(id$1166=m$1245);}else{(t0$1217=m$1212);if((typeof(t0$1217)==="string")){(s$1252=t0$1217);_classes$1165.push(s$1252);}else{$2210(m$1212,"/home/olivier/git/egrepl/src/repl.eg",2357,2678);;}}}}}}(node$1169=document.createElement(tag$1164));;if(id$1166){(node$1169["id"]=id$1166);}if(_classes$1165.length){(node$1169["className"]=_classes$1165.join(" "));}(temp$1264=kv$1167);;($length$1269=temp$1264.length);;($index$1274=0);;$1175:for(;($index$1274<$length$1269);($index$1274++)){var k$1292;var v$1293;var t0$1287;var t1$1288;var m$1282;(m$1282=temp$1264[$index$1274]);;(t0$1287=m$1282);if(((t0$1287 instanceof Array)&&((t1$1288=t0$1287.length),(t1$1288===2)))){(k$1292=t0$1287[0]);(v$1293=t0$1287[1]);(node$1169[k$1292]=v$1293);}else{$2210(m$1282,"/home/olivier/git/egrepl/src/repl.eg",2827,2874);;}}($1163$1300=tag$1164);;if(($1163$1300==="raw")){(acc$1313=[]);;(temp$1318=children$1158);;($length$1323=temp$1318.length);;($index$1328=0);;$1310:for(;($index$1328<$length$1323);($index$1328++)){var s$1345;var t0$1341;var m$1336;(m$1336=temp$1318[$index$1328]);;(t0$1341=m$1336);if((typeof(t0$1341)==="string")){(s$1345=t0$1341);acc$1313.push((node$1169["innerHTML"]=s$1345));}else{$2210(m$1336,"/home/olivier/git/egrepl/src/repl.eg",2901,3003);;}}acc$1313;}else{(other$1352=$1163$1300);(acc$1357=[]);;(temp$1362=children$1158);;($length$1367=temp$1362.length);;($index$1372=0);;$1354:for(;($index$1372<$length$1367);($index$1372++)){var c$1388;var m$1380;(m$1380=temp$1362[$index$1372]);;(c$1388=m$1380);acc$1357.push(node$1169.appendChild(make_dom$947(c$1388,default_tag$1100)));}acc$1357;}return node$1169;}else{(other$1392=$1088$1101);return make_dom$947([true,String(other$1392)][1]);}}}}else{$2210($1087$1091);}});;(mktable$948=function(){var other$1433;var $1419$1421;var $index$1454;var $length$1449;var temp$1444;var acc$1439;var its$1416;var x$1411;var recur$1412;var t0$1407;var $1400$1402;($1400$1402=arguments);;(t0$1407=$1400$1402.length);if(((t0$1407>=1)&&(t0$1407<=2))){(x$1411=$1400$1402[0]);(recur$1412=function(){if((1>=t0$1407)){return repr$950;}else{return $1400$1402[1];}}());(its$1416=((($1419$1421=x$1411)),function(){if($880(Array)($1419$1421)){return x$1411;}else{(other$1433=$1419$1421);return $2195(x$1411);}}()));;if(its$1416.length){return $2443(["+table","object"],(((acc$1439=[])),(((temp$1444=its$1416)),((($length$1449=temp$1444.length)),((($index$1454=0)),function(){$1436:for(;($index$1454<$length$1449);($index$1454++)){var k$1472;var v$1473;var t0$1467;var t1$1468;var m$1462;(m$1462=temp$1444[$index$1454]);;(t0$1467=m$1462);if(((t0$1467 instanceof Array)&&((t1$1468=t0$1467.length),(t1$1468===2)))){(k$1472=t0$1467[0]);(v$1473=t0$1467[1]);acc$1439.push($2443(["+tr"],[$2443(["+th"],recur$1412(k$1472,repr$950)),$2443(["+td"],recur$1412(v$1473,repr$950))]));}else{$2210(m$1462,"/home/olivier/git/egrepl/src/repl.eg",3297,3431);;}}}()))),acc$1439));}else{return $2443(["object","empty"],[]);}}else{$2210($1400$1402);}});;(mktable2$949=function(){var other$1518;var $1504$1506;var $index$1539;var $length$1534;var temp$1529;var acc$1524;var its$1501;var x$1496;var recur$1497;var t0$1492;var $1485$1487;($1485$1487=arguments);;(t0$1492=$1485$1487.length);if(((t0$1492>=1)&&(t0$1492<=2))){(x$1496=$1485$1487[0]);(recur$1497=function(){if((1>=t0$1492)){return repr$950;}else{return $1485$1487[1];}}());(its$1501=((($1504$1506=x$1496)),function(){if($880(Array)($1504$1506)){return x$1496;}else{(other$1518=$1504$1506);return $2195(x$1496);}}()));;return $2443(["+table"],(((acc$1524=[])),(((temp$1529=its$1501)),((($length$1534=temp$1529.length)),((($index$1539=0)),function(){$1521:for(;($index$1539<$length$1534);($index$1539++)){var k$1557;var v$1558;var t0$1552;var t1$1553;var m$1547;(m$1547=temp$1529[$index$1539]);;(t0$1552=m$1547);if(((t0$1552 instanceof Array)&&((t1$1553=t0$1552.length),(t1$1553===2)))){(k$1557=t0$1552[0]);(v$1558=t0$1552[1]);acc$1524.push($2443(["+tr"],[$2443(["+th"],recur$1497(k$1557,repr$950)),$2443(["+td"],recur$1497(v$1558,repr$950))]));}else{$2210(m$1547,"/home/olivier/git/egrepl/src/repl.eg",3561,3666);;}}}()))),acc$1524));}else{$2210($1485$1487);}});;(repr$950=function(){var $index$1657;var $length$1652;var temp$1647;var acc$1642;var other$1703;var f$1698;var n$1677;var entries$1636;var $1572$1599;var $1573$1600;var t0$1596;var t1$1597;var x$1586;var recur$1587;var $1571$1588;var t0$1580;var t1$1581;var t2$1582;var $1570$1575;($1570$1575=arguments);;(t0$1580=$1570$1575.length);if((((t0$1580>=1)&&(t0$1580<=2))&&((t1$1581=$1570$1575[0]),((x$1586=t1$1581),(($1571$1588=t1$1581),((t2$1582=function(){if((1>=t0$1580)){return repr$950;}else{return $1570$1575[1];}}()),$880(Function)(t2$1582))))))){(recur$1587=t2$1582);if(($1571$1588===true)){return $2443(["special","true"],"true");}else{if(($1571$1588===false)){return $2443(["special","false"],"false");}else{if(($1571$1588===null)){return $2443(["special","nil"],"null");}else{if(($1571$1588===(void 0))){return $2443(["special","nil"],"undefined");}else{if((typeof($1571$1588)==="number")){return $2443(["num"],String(x$1586));}else{if(($1571$1588==="")){return $2443(["str","empty"],[]);}else{if((typeof($1571$1588)==="string")){return $2443(["str"],x$1586);}else{(t0$1596=$1571$1588);if((($1573$1600=$880(Array)(t0$1596))&&((t1$1597=t0$1596.length),(t1$1597===0)))){return $2443(["sequence","empty"],[]);}else{if($1573$1600){(entries$1636=t0$1596);return $2443(["sequence"],(((acc$1642=[])),(((temp$1647=entries$1636)),((($length$1652=temp$1647.length)),((($index$1657=0)),function(){$1639:for(;($index$1657<$length$1652);($index$1657++)){var x$1673;var m$1665;(m$1665=temp$1647[$index$1657]);;(x$1673=m$1665);acc$1642.push(recur$1587(x$1673,repr$950));}}()))),acc$1642));}else{if($880($2443)(t0$1596)){(n$1677=t0$1596);return n$1677;}else{$1571$1588;if(x$1586["::repr"]){return x$1586["::repr"](recur$1587);}else{if((Object.getPrototypeOf(x$1586)===Object.prototype)){return mktable$948(x$1586);}else{if((x$1586.constructor&&x$1586.constructor["::egclass"])){return $2443(["instance"],[$2443(["classname"],x$1586.constructor["::name"]),mktable$948(x$1586)]);}else{if(x$1586["::egclass"]){return $2443(["class"],[$2443(["classname"],("Class "+x$1586["::name"])),mktable$948(x$1586.prototype)]);}else{(t0$1596=$1571$1588);if($880(Function)(t0$1596)){(f$1698=t0$1596);return $2443(["function"],function(){if(f$1698.name){return f$1698.name;}else{return "<anonymous>";}}());}else{(other$1703=$1571$1588);return $2443(["unknown"],other$1703.toString());}}}}}}}}}}}}}}}}else{$2210($1570$1575);}});;(goto_end$951=function(elem$1711){var range$1714;var selection$1715;(range$1714=document.createRange());;range$1714.selectNodeContents(elem$1711);range$1714.collapse(false);(selection$1715=window.getSelection());;selection$1715.removeAllRanges();return selection$1715.addRange(range$1714);});;(insert_before_caret$952=function(text$1726){var it$0$1743;var it$0$1749;var range$1738;var node$1729;var sel$1730;(node$1729=document.createTextNode(text$1726));;(sel$1730=window.getSelection());;if(sel$1730.rangeCount){(range$1738=sel$1730.getRangeAt(0));;(it$0$1743=range$1738);;it$0$1743.collapse(false);it$0$1743.insertNode(node$1729);(range$1738=range$1738.cloneRange());(it$0$1749=range$1738);;it$0$1749.selectNodeContents(node$1729);it$0$1749.collapse(false);sel$1730.removeAllRanges();return sel$1730.addRange(range$1738);}});;(Error.prototype["::repr"]=function(){return format_error$940(this);});(Repl$953=function(box$1760,target$1761,input$1762,evaluator$1763){var it$0$1766;(it$0$1766=function(){if((!$880(Repl$953)(this))){return Object.create(Repl$953.prototype);}else{return this;}}());;(it$0$1766["url"]="<repl>");(it$0$1766["gen"]=eg$934.Generator());(it$0$1766["evaluator"]=evaluator$1763);(it$0$1766["box"]=box$1760);(it$0$1766["target"]=target$1761);(it$0$1766["input"]=input$1762);(it$0$1766["multiline"]=false);(it$0$1766["interactor"]=kb$933.Interactor(({})));it$0$1766.set_multiline(false);it$0$1766.interactor.install(it$0$1766.input);(it$0$1766["cursor"]=0);(it$0$1766["history"]=[""]);return it$0$1766;});;(Repl$953.prototype["sink"]=function(){var it$0$1778;(it$0$1778=this);;return jQuery(it$0$1778.box).scrollTop(it$0$1778.box.scrollHeight);});(Repl$953.prototype["add_to_history"]=function(text$1785){var hl$1793;var it$0$1788;(it$0$1788=this);;(hl$1793=it$0$1788.history.length);;if(((text$1785!=="")&&(!((hl$1793>1)&&$2603($895(it$0$1788.history,(hl$1793-2)),text$1785))))){(it$0$1788.history[(hl$1793-1)]=text$1785);it$0$1788.history.push("");}return (it$0$1788["cursor"]=(it$0$1788.history.length-1));});(Repl$953.prototype["submit"]=function(){var text$1808;var it$0$1803;(it$0$1803=this);;it$0$1803.set_multiline(false);(text$1808=it$0$1803.input.innerText);;it$0$1803.process(text$1808);(it$0$1803.input["innerHTML"]="");return it$0$1803.sink();});(Repl$953.prototype["begin_multiline"]=function(){var it$0$1817;(it$0$1817=this);;it$0$1817.set_multiline(true);(it$0$1817.input["innerHTML"]=(it$0$1817.input.innerHTML+"\n   "));goto_end$951(it$0$1817.input);return it$0$1817.sink();});(Repl$953.prototype["set_multiline"]=function(x$1825){var accum$1859;var accum$1865;var accum$1877;var accum$1884;var accum$1891;var accum$1918;var accum$1925;var accum$1931;var previous$1841;var next$1842;var common$1843;var $1828$1834;var it$0$1829;(it$0$1829=this);;($1828$1834=x$1825);;(previous$1841=function(){if((it$0$1829.cursor>0)){(it$0$1829.input["innerText"]=$895(it$0$1829.history,(--it$0$1829.cursor)));goto_end$951(it$0$1829.input);return it$0$1829.sink();}});;(next$1842=function(){if((it$0$1829.cursor<(it$0$1829.history.length-1))){(it$0$1829.input["innerText"]=$895(it$0$1829.history,(++it$0$1829.cursor)));goto_end$951(it$0$1829.input);return it$0$1829.sink();}});;(common$1843=$2399(((accum$1859=({})),((accum$1859["C-l"]=function(){return jQuery(it$0$1829.target).empty();}),accum$1859)),((accum$1865=({})),((accum$1865["S-Enter"]=function(){return it$0$1829.submit();}),accum$1865))));;if(($1828$1834===false)){jQuery(it$0$1829.input).removeClass("multiline");return it$0$1829.interactor.set_bindings($2739(common$1843,$2399(((accum$1877=({})),((accum$1877["C-m"]=function(){it$0$1829.set_multiline(true);return "break";}),accum$1877)),$2399(((accum$1884=({})),((accum$1884["C-Enter"]=function(){it$0$1829.begin_multiline();return "break";}),accum$1884)),$2399(((accum$1891=({})),((accum$1891["Enter"]=function(){var other$1910;var $1896$1898;($1896$1898=it$0$1829.input.innerText);;if($880(RegExp("(=|->|%|:)$",""))($1896$1898)){return it$0$1829.begin_multiline();}else{(other$1910=$1896$1898);return it$0$1829.submit();}}),accum$1891)),({"Up":previous$1841,"Down":next$1842}))))));}else{if(($1828$1834===true)){jQuery(it$0$1829.input).addClass("multiline");return it$0$1829.interactor.set_bindings($2739(common$1843,$2399(((accum$1918=({})),((accum$1918["C-m"]=function(){it$0$1829.set_multiline(false);return "break";}),accum$1918)),$2399(((accum$1925=({})),((accum$1925["C-Enter"]=function(){return it$0$1829.submit();}),accum$1925)),((accum$1931=({})),((accum$1931["Tab"]=function(){var txt$1937;(txt$1937=it$0$1829.input.innerText);;if($880(RegExp("\n$",""))(txt$1937)){(txt$1937=txt$1937.substring(0,(txt$1937.length-1)));}return insert_before_caret$952("   ");}),accum$1931))))));}else{$2210($1828$1834);}}});(Repl$953.prototype["generate"]=function(text$1947){var it$0$1950;(it$0$1950=this);;return it$0$1950.gen.generate(eg$934.Source(text$1947,it$0$1950.url));});(Repl$953.prototype["eval"]=function(text$1957){var rval$1984;var gen$1965;var handle$1966;var it$0$1960;(it$0$1960=this);;(gen$1965=function(){var g$1972;(g$1972=it$0$1960.generate(text$1957));;return ["success",it$0$1960.evaluator(g$1972)];});;(handle$1966=function(e$1980){return ["failure",e$1980];});;(rval$1984=false);;try{(rval$1984=gen$1965());}catch(excv$1990){var e$1996;(e$1996=excv$1990);(rval$1984=handle$1966(e$1996));}return rval$1984;});(Repl$953.prototype["process"]=function(){var error$2072;var value$2067;var n$2061;var $2033$2046;var $2034$2047;var $2035$2048;var $2036$2049;var t0$2043;var t1$2044;var $2032$2038;var real_text$2022;var node$2023;var name$2024;var collapse$2025;var on$2026;var it$0$2017;var text$2012;var display_in$2013;var t0$2008;var $2001$2003;($2001$2003=arguments);;(t0$2008=$2001$2003.length);if(((t0$2008>=1)&&(t0$2008<=2))){(text$2012=$2001$2003[0]);(display_in$2013=function(){if((1>=t0$2008)){return true;}else{return $2001$2003[1];}}());(it$0$2017=this);;it$0$2017.add_to_history(text$2012);(real_text$2022=(("\n"+text$2012)+"\n"));;(node$2023=make_dom$947($2443(["io"],[function(){if(display_in$2013){return $2443(["in"],[$2443(["inbanner"],[]),$2443(["entry"],text$2012)]);}else{return "";}}(),((($2032$2038=it$0$2017.eval(real_text$2022))),($2032$2038,function(){if((text$2012.trim()==="")){return "";}else{if((($2033$2046=($2032$2038 instanceof Array))&&((t0$2043=$2032$2038.length),(($2035$2048=(t0$2043===2))&&(($2036$2049=($2032$2038[0]==="success"))&&($2032$2038[1]===(void 0))))))){return "";}else{if(($2036$2049&&((t1$2044=$2032$2038[1]),$880($2443)(t1$2044)))){(n$2061=t1$2044);return $2443(["display"],[$2443(["displaybanner"],[]),$2443(["result"],n$2061)]);}else{if($2036$2049){(value$2067=$2032$2038[1]);return $2443(["out"],[$2443(["outbanner"],[]),$2443(["result"],$2443(["eg"],repr$950(value$2067)))]);}else{if(($2035$2048&&($2032$2038[0]==="failure"))){(error$2072=$2032$2038[1]);return $2443(["err"],[$2443(["errbanner"],[]),$2443(["result"],$2443(["eg"],repr$950(error$2072)))]);}else{$2210($2032$2038);}}}}}}()))])));;(name$2024=gensym$945());;(node$2023["id"]=name$2024);it$0$2017.target.appendChild(node$2023);(collapse$2025=function(e$2084){var at_top$2087;e$2084.stopPropagation();(at_top$2087=$2603((it$0$2017.box.scrollTop+jQuery(it$0$2017.box).height()),it$0$2017.box.scrollHeight));;jQuery(this).toggleClass("collapsed");if(at_top$2087){return jQuery(it$0$2017.box).scrollTop(it$0$2017.box.scrollHeight);}});;(on$2026=function(sel$2096){return jQuery(((("#"+name$2024)+" ")+sel$2096));});;on$2026(".sequence").addClass("complex");on$2026(".object").addClass("complex");on$2026(".complex").click(collapse$2025);on$2026(".complex .complex .complex").addClass("collapsed");on$2026(".error_args.syntax").addClass("collapsed").click(collapse$2025);return on$2026(".traceback").addClass("collapsed").click(collapse$2025);}else{$2210($2001$2003);}});$2399(Repl$953,$2399(((accum$2102=({})),((accum$2102["::name"]="Repl"),accum$2102)),((accum$2106=({})),((accum$2106["::egclass"]=true),accum$2106))));Repl$953;(make_cards$954=function(repl$2112){var clickable$2115;var clickable_row$2116;(clickable$2115=function(text$2120){var click$2123;(click$2123=function(e$2127){e$2127.preventDefault();repl$2112.process(text$2120);repl$2112.sink();return jQuery(repl$2112.input).focus();});;return $2443(["clickable",["assoc","onclick",click$2123]],text$2120);});;(clickable_row$2116=function(){var $index$2167;var $length$2162;var temp$2157;var acc$2152;var items$2146;var t0$2142;var $2135$2137;($2135$2137=arguments);;(t0$2142=$2135$2137.length);if((t0$2142>=0)){(items$2146=Array.prototype.slice.call($2135$2137,0));return $2443(["+span"],(((acc$2152=[])),(((temp$2157=items$2146)),((($length$2162=temp$2157.length)),((($index$2167=0)),function(){$2149:for(;($index$2167<$length$2162);($index$2167++)){var item$2188;var item$2183;var m$2175;(m$2175=temp$2157[$index$2167]);;(item$2183=m$2175);if(($index$2167===0)){acc$2152.push(clickable$2115(item$2183));}else{(item$2188=m$2175);acc$2152.push($2443(["+span"],[$2443(["+span","separator"],""),clickable$2115(item$2188)]));}}}()))),acc$2152));}else{$2210($2135$2137);}});;return [$2443(["card"],[$2443(["+h3"],"Keyboard controls"),mktable2$949([[$2443(["+code"],"Up/Down"),"Navigate history"],[$2443(["+code"],"Enter/Shift-Enter"),"Evaluate an expression"],[$2443(["+code"],"Control-l"),"Clear the screen"],[$2443(["+code"],"Control-m"),"Toggle mulitline mode"]]),"Type ",clickable$2115("next")," to continue with the tutorial"]),$2443(["card"],[$2443(["+h3"],"Basics"),$2443([],["Click on boxes like ",clickable$2115("this")," to evaluate their contents."]),$2443(["+h4"],"Strings"),$2443(["+span"],clickable_row$2116("\"hello world\"",".word","\"My name is \\\"Olivier\\\"\"")),$2443(["+h4"],"Numbers"),mktable2$949([[$2443([],"Decimal"),clickable_row$2116("1","1.4","4.93e51")],[$2443([],"Hex"),clickable_row$2116("16rFF","16r100","16rDEADBEEF","16r0.8")],[$2443([],"Binary etc."),clickable_row$2116("2r1110","3r20","36rZAZZ")]]),$2443(["+h4"],"Function calls"),mktable2$949([[$2443([],"Call"),clickable_row$2116("alert{\"Hello!\"}","alert with \"Hello!\"")],[$2443([],"Methods"),clickable_row$2116("\"hello\".substring{1}")]]),clickable$2115("next")," => variables"]),$2443(["card"],[$2443(["+h3"],"Variables"),$2443([],["There are separate operators for declaration and assignment. ","A variable cannot be assigned to before it is declared."]),$2443(["+table"],[$2443(["+tr"],[$2443(["+td"],[$2443(["+b"],"Declare")," a variable"]),$2443(["+td"],clickable$2115("x = 1234"))]),$2443(["+tr"],[$2443(["+td"],[$2443(["+b"],"Set")," an existing variable"]),$2443(["+td"],clickable$2115("x := 999"))]),$2443(["+tr"],[$2443(["+td"],[$2443(["+b"],"Use")," your variable!"]),$2443(["+td"],clickable$2115("x + x"))])]),$2443([],["You can create blocks with their own local variables using ",$2443(["+code"],"[]"),", ",$2443(["+code"],"let")," or ",$2443(["+code"],"where")]),$2443([],clickable$2115("[a = 10, b = 90, a + b]")),$2443([],clickable$2115("let [a = 10, b = 90]: a + b")),$2443([],clickable$2115("a + b where\n   a = 10\n   b = 90")),$2443([],["Be aware that ",$2443(["+code"],"[]")," only creates a block"," when it encloses more than one expression."]),$2443([],["An indented block is completely equivalent to ","wrapping it in ",$2443(["+code"],"[]"),"s"]),clickable$2115("next")," => data structures"]),$2443(["card"],[$2443(["+h3"],"Data structures"),$2443([],["Earl Grey uses curly braces ",$2443(["+code"],"{}")," to define all data structures."]),mktable2$949([[$2443([],"Arrays"),clickable_row$2116("{1, 2, 3}","{1, {2, 3}}","{\"hello\"}")],[$2443([],"Objects"),clickable_row$2116("{name = .Peter, age = 20}","{\"a\" => 123}")]]),$2443([],["The empty array is ",clickable$2115("{}")," and the empty object is ",clickable$2115("{=}")]),$2443(["+h4"],"Deconstruction"),$2443([],"You can extract array elements and object fields into variables directly."),$2443([],clickable$2115("{x, y} = {11, 22}")),$2443([],clickable$2115("{x, *rest, y} = {111, 222, 333, 444}")),$2443([],clickable$2115("{=> name} = {name = .Peter, age = 20}")),$2443(["+h4"],"Operations"),mktable2$949([[$2443([],"Concatenation"),clickable$2115("{1, 2} ++ {3, 4, 5}")],[$2443([],"Object fusion"),clickable$2115("{name = .Kim} & {age = 39}")]]),clickable$2115("next")," => control structures"]),$2443(["card"],[$2443(["+h3"],"Control structures"),$2443([],[$2443(["+code"],"if")," and ",$2443(["+code"],"while")," are available."]),$2443([],clickable$2115("if [13 > 0]:\n   then: \"This number is positive!\"\n   else: \"This number is negative!\"\n")),$2443([],clickable$2115("i = 3\nwhile [i > 0]:\n   alert{i}\n   i--\n")),$2443([],["Notice that both branches of ",$2443(["+code"],"if")," must be nested."," The expression form of ",$2443(["+code"],"if")," is simply ",clickable$2115("if{1, .yes, .no}")]),clickable$2115("next")," => control structures [2]"]),$2443(["card"],[$2443(["+h3"],"Control structures [2]"),$2443([],["Earl Grey's ",$2443(["+code"],"if")," nests poorly, so if you want to ","write many clauses use ",$2443(["+code"],"match")]),$2443([],clickable$2115("x = 13\nmatch:\n   when x > 0 -> .positive\n   when x < 0 -> .negative\n   when x == 0 -> .zero\n")),$2443([],"You can also match on the variable directly!"),$2443([],clickable$2115("x = 13\nmatch x:\n   > 0 -> .positive\n   < 0 -> .negative\n   0 -> .zero\n")),$2443([],["The left hand side of the arrow is a special pattern matching"," language, whereas ",$2443(["+code"],"when")," takes a standard expression."]),clickable$2115("next")," => each"]),$2443(["card"],[$2443(["+h3"],"each"),$2443([],["A single operator serves both looping over data structures"," and list comprehensions."]),$2443([],clickable$2115("{1, 2, 3} each i -> -i")),$2443([],clickable$2115("1..10 each i -> i * i")),$2443([],clickable$2115("1..10 each i when i mod 2 == 0 -> i")),$2443([],"You can have more than one clause"),$2443([],clickable$2115("{1, 2, .hello, 4, 72, 99, {}} each\n   String? s -> {s, .string}\n   Number? i when i mod 2 == 0 -> {i, .even}\n   Number? i when i mod 2 == 1 -> {i, .odd}\n   x -> {x, .dunno}\n")),$2443([],[$2443(["+code"],"first")," and ",$2443(["+code"],"last")," are special patterns"]),$2443([],clickable$2115("acc = \"\"\n{.a, .b, .c, .d} each\n   first x -> acc += \"[\" + x\n   last x -> acc += \", \" + x + \"]\"\n   x -> acc += \", \" + x\nacc\n")),$2443([],"Be careful to put the catchall clause last."),clickable$2115("next")," => functions"]),$2443(["card"],[$2443(["+h3"],"Functions"),$2443([],["Functions are declared with ",$2443(["+code"],"=")," or ",$2443(["+code"],"->"),". For instance the following are equivalent"]),$2443([],clickable$2115("f{x, y} = [x * x + y * y] ** 0.5")),$2443([],clickable$2115("f = {x, y} -> [x * x + y * y] ** 0.5")),$2443([],"It works inside object definitions as well, of course"),$2443([],clickable$2115("{add1{x} = x + 1, add2{x} = x + 2}")),$2443([],["Pattern matching is deeply integrated in Earl Grey. ","For instance:"]),$2443([],clickable$2115("fact{match} =\n   0 or 1 -> 1\n   n -> n * fact{n - 1}\n")),clickable$2115("next")," => type checking and coercion"]),$2443(["card"],[$2443(["+h3"],"Type checking and coercion"),mktable2$949([[$2443([],"Type checking"),clickable_row$2116("String? .hello","Number? 1","Array? .nope","R\"x$\"? .simplex")],[$2443([],"Coercion"),clickable_row$2116("String! {1, 2}","Number! \"3.14\"","Array! .yep")]]),$2443([],["Both type checking and coercion can be used in patterns."," Observe the difference in behavior of the following functions "," (try on ",clickable$2115("f{1, \"2\"}"),")"]),$2443([],clickable$2115("f{x, y} = x + y")),$2443([],clickable$2115("f{Number? x, Number? y} = x + y")),$2443([],clickable$2115("f{Number! x, Number! y} = x + y")),$2443([],["Functions naturally act as coercers: ",clickable$2115("parseInt! x = \"99\"")]),$2443(["+h4"],"Predicates"),$2443([],["You can create your own predicates with the ",$2443(["+code"],"predicate")," builtin"]),$2443([],clickable$2115("predicate! even{x} = x mod 2 == 0")),$2443([],clickable_row$2116("even? x = 1","even? x = 2")),clickable$2115("next")," => classes"]),$2443(["card"],[$2443(["+h3"],"Classes"),$2443([],["Classes are declared with the ",$2443(["+code"],"class")," macro. As a convenience, @ can be used to"," refer to fields and members of the instance."]),$2443([],clickable$2115("class Person:\n   constructor{name, age, job} =\n      @name := name\n      @age := age\n      @job := job\n   hello{} =\n      \"Hello, I am \" + @name + \", \" + @age + \", and I am a \" + @job\n")),$2443([],["The ",$2443(["+code"],"new")," keyword is optional."," I prefer to avoid it."]),$2443([],clickable$2115("Person{.Sonia, 25, .baker}")),$2443([],clickable$2115("Person{.Jack, 56, \"serial murderer\"}.hello{}")),clickable$2115("next")," => HTML generation"]),$2443(["card"],[$2443(["+h3"],"Here, let's have some fun"),$2443([],["The ",$2443(["+code"],"%")," operator creates structured data"," which is directly translated as HTML."]),$2443([],clickable_row$2116("b % .hello","i % .hello")),$2443([],"We can print out a multiplication table!"),$2443([],clickable_row$2116("table % 1..10 each i ->\n   tr % 1..10 each j ->\n      td % i * j\n"))]),$2443(["card"],[$2443(["+h3"],"The end"),$2443([],["This is the end of this humble tutorial,"," but you can keep messing around with the language,"," it's a lot of fun :)"])])];});;(exports["Repl"]=Repl$953);(exports["Interactor"]=kb$933.Interactor);(exports["parse"]=parse$944);(exports["tokenize"]=tokenize$942);(exports["Source"]=eg$934.Source);(exports["make_cards"]=make_cards$954);

},{"../lib/earl-grey":4,"../lib/lex":6,"../lib/location":7,"../lib/parse":9,"../lib/util":14,"./kb":1}],"repl":[function(require,module,exports){
module.exports=require('eXk3/i');
},{}],4:[function(require,module,exports){
var $140=function(type$142){var f$145;(f$145=type$142["::check"]);;if((f$145===(void 0))){return function(value$150){return (value$150 instanceof type$142);};}else{return function(value$153){return f$145.call(type$142,value$153);};}};
var $155=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $156=function($157$159){var ph$163;(ph$163=$157$159);;var $161$168;($161$168=ph$163);;var bridge$162$173;var x$177;(bridge$162$173=$161$168);if((((typeof(bridge$162$173)==="string")&&((x$177=bridge$162$173),true))||((typeof(bridge$162$173)==="number")&&((x$177=bridge$162$173),true)))){return ["value",x$177];}else{var other$184;(other$184=$161$168);return other$184["::serialize_ast"]();}};
var send$24;(send$24=function(obj$29,$27$30){var ph$34;var msg$35;var t0$37;(t0$37=$27$30);(msg$35=t0$37);(ph$34=t0$37);;var $32$41;($32$41=ph$34);;var bridge$33$46;(bridge$33$46=$32$41);if(((typeof(bridge$33$46)==="string")||(typeof(bridge$33$46)==="number"))){return obj$29[msg$35];}else{var other$54;(other$54=$32$41);return obj$29["::send"](msg$35);}});;(Array[":::project"]=function($57$59){var ph$62;var value$63;var t0$65;(t0$65=$57$59);(value$63=t0$65);(ph$62=t0$65);;var $61$69;($61$69=ph$62);;if($140(Array)($61$69)){return [true,value$63];}else{$61$69;return [true,[value$63]];}});(Array.prototype["::check"]=function(value$83){if((value$83 instanceof Array)){var i$88;(i$88=0);;$86:for(;(i$88<this.length);(i$88++)){if(($155(this,i$88)!==$155(value$83,i$88))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$99){if((value$99 instanceof Array)){var i$104;(i$104=0);;$102:for(;(i$104<this.length);(i$104++)){if(($155(this,i$104)!==$155(value$99,i$104))){return [true,[value$99]];}}return [true,value$99.slice(this.length)];}else{return [true,[value$99]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($156));});(RegExp.prototype["::check"]=function(value$115){return value$115.match(this);});(RegExp.prototype[":::project"]=function(value$118){var $120$122;($120$122=value$118.match(this));;var m$130;if(($120$122===null)){(m$130=$120$122);return [false,null];}else{var m$135;(m$135=$120$122);return [true,m$135];}});(Function.prototype["::send"]=function(args$138){return this.apply(this,args$138);});
var $655=function(arr$657){var results$661;var l$662;(results$661=[]);;(l$662=arr$657.length);;var i$670;(i$670=0);;$660:for(;(i$670<l$662);(i$670++)){results$661.push([i$670,$155(arr$657,i$670)]);}return results$661;};
var $677=function(dest$679,values$680){var k$685;(k$685=null);$683:for(k$685 in values$680){if(values$680.hasOwnProperty(k$685)){(dest$679[k$685]=values$680[k$685]);}}return dest$679;};
var $501=function(){var $502$504;($502$504=function(tags$508){var it$0$511;(it$0$511=function(){if((!$140($502$504)(this))){return Object.create($502$504.prototype);}else{return this;}}());;(it$0$511["tags"]=tags$508);return it$0$511;});;($502$504.prototype["create"]=function(){var $520$522;($520$522=arguments);;var t0$527;var message$531;var args$532;(t0$527=$520$522.length);if((t0$527>=0)){(message$531=function(){if((0>=t0$527)){return "";}else{return $520$522[0];}}());(args$532=Array.prototype.slice.call($520$522,1));var it$0$536;(it$0$536=this);;var e$541;(e$541=Error(message$531));;(e$541["::tags"]=it$0$536.tags);(e$541["args"]=args$532);var temp$549;(temp$549=$655(args$532));;var $length$554;($length$554=temp$549.length);;var $index$559;($index$559=0);;$542:for(;($index$559<$length$554);($index$559++)){var m$567;(m$567=temp$549[$index$559]);;var t0$572;var t1$573;var i$577;var arg$578;(t0$572=m$567);if(((t0$572 instanceof Array)&&((t1$573=t0$572.length),(t1$573===2)))){(i$577=t0$572[0]);(arg$578=t0$572[1]);(e$541[i$577]=arg$578);}else{$488(m$567);;}}(e$541["length"]=args$532.length);(e$541["name"]=["E"].concat(it$0$536.tags).join("."));return e$541;}else{$488($520$522);}});($502$504.prototype["::check"]=function(e$589){var it$0$592;(it$0$592=this);;var tags$597;if(((!e$589)||(!$140(Error)(e$589)))){return false;}(tags$597=(e$589["::tags"]||[]));;var temp$606;(temp$606=it$0$592.tags);;var $length$611;($length$611=temp$606.length);;var $index$616;($index$616=0);;$598:for(;($index$616<$length$611);($index$616++)){var m$624;(m$624=temp$606[$index$616]);;var tag$632;(tag$632=m$624);if((tags$597.indexOf(tag$632)===-1)){return false;}else{false;;}}return true;});($502$504.prototype["::deconstruct"]=function(e$640){var it$0$643;(it$0$643=this);;return e$640.args;});$677($502$504,$677(function(){var accum$648;(accum$648=({}));(accum$648["::name"]="$502");return accum$648;}(),function(){var accum$652;(accum$652=({}));(accum$652["::egclass"]=true);return accum$652;}()));return $502$504;}();
var $488=function(value$490,url$491,start$492,end$493){var err$496;(err$496=$501(["match"]).create("Could not find a match for value",({"value":value$490})));;if(url$491){(err$496["location"]=["location",url$491,start$492,end$493]);}throw err$496;};
var $689=function($690$692,key$693){var ph$697;(ph$697=$690$692);;var $695$702;($695$702=ph$697);;var bridge$696$707;(bridge$696$707=$695$702);if(((bridge$696$707===null)||(bridge$696$707===(void 0)))){return false;}else{var x$715;if((typeof($695$702)==="string")){(x$715=$695$702);return (key$693 in String.prototype);}else{var x$720;if((typeof($695$702)==="number")){(x$720=$695$702);return (key$693 in Number.prototype);}else{var x$725;(x$725=$695$702);return (key$693 in x$725);}}}};var accum$480;var accum$484;var $187$195;var items$196;var $188$197;var Source$198;var Location$199;var highlight_locations$200;var $189$201;var tokenize$202;var $190$203;var parse$204;var $191$205;var translate$206;var Translator$207;var std$208;var exp$209;var opt$210;var generate_from_ast$211;var generate$212;var Generator$213;($187$195=require("./util"));;(items$196=$187$195.items);;($188$197=require("./location"));;(Source$198=$188$197.Source);;(Location$199=$188$197.Location);;(highlight_locations$200=$188$197.highlight_locations);;($189$201=require("./lex"));;(tokenize$202=$189$201.tokenize);;($190$203=require("./parse"));;(parse$204=$190$203.parse);;($191$205=require("./translate-js"));;(translate$206=$191$205.translate);;(Translator$207=$191$205.Translator);;(std$208=require("./stdenv"));;(exp$209=require("./expand"));;(opt$210=require("./opt"));;(generate_from_ast$211=function(ast$265){var ex$268;var tr$269;var rval$270;(ex$268=std$208.expand(["top"],std$208.topscope,std$208.stdenv.fork().convert(["multi",ast$265])));;(ex$268=opt$210.hoist(ex$268));(tr$269=Translator$207());;(rval$270=tr$269.translate(ex$268,"expr"));;return [tr$269.dump_store(),rval$270];});;std$208.stdenv.bind(std$208.topscope,"macro",["macro",function(context$283,scope$284,form$285,$281$286){var t0$325;var t1$326;var prep$320;var code$321;var mac$322;var mac2$323;var name$307;var sym$308;var arguments$309;var ast$310;var t0$299;var t1$300;var t2$301;var t3$302;var t4$303;var $288$294;var ph$289;(ph$289=$281$286);;($288$294=ph$289);;if((($288$294 instanceof Array)&&((t0$299=$288$294.length),((t0$299===3)&&(($288$294[0]==="data")&&((t1$300=$288$294[1]),((t1$300 instanceof Array)&&((t2$301=t1$300.length),((t2$301===3)&&((t1$300[0]==="send")&&((t3$302=t1$300[1]),((name$307=t3$302),((t3$302 instanceof Array)&&((t4$303=t3$302.length),((t4$303===2)&&(t3$302[0]==="symbol")))))))))))))))){(sym$308=t3$302[1]);(arguments$309=t1$300[2]);(ast$310=$288$294[2]);(t0$325=generate_from_ast$211(["send",["symbol","->"],["data",arguments$309,ast$310]]));if(((t0$325 instanceof Array)&&((t1$326=t0$325.length),(t1$326===2)))){(prep$320=t0$325[0]);(code$321=t0$325[1]);;}else{$488(generate_from_ast$211(["send",["symbol","->"],["data",arguments$309,ast$310]]),"/home/olivier/git/earl-grey/src/earl-grey.eg",792,832);}(mac$322=eval((prep$320+((";("+code$321)+")"))));;(mac2$323=function(c$337,s$338,f$339,e$340){var env$343;var r$344;(env$343=scope$284.expander.mkenv());;env$343.bind(scope$284,sym$308,["macro",mac2$323]);(r$344=mac$322(c$337,s$338,f$339,e$340));;return env$343.convert(r$344);});;return ["declare_raw",name$307,["macro",mac2$323]];}else{$488($288$294);}}]);std$208.stdenv.bind(std$208.topscope,"macros",["macro",function(context$357,scope$358,$354$359,$355$360){var t0$365;var t0$370;var t1$371;var t0$381;var t1$382;var $index$409;var $length$404;var temp$399;var acc$394;var prep$377;var code$378;var the_macros$379;var env$362;var body$363;(t0$365=$354$359);if($689(t0$365,"env")){(env$362=t0$365.env);;}else{$488($354$359);}(t0$370=$355$360);if(((t0$370 instanceof Array)&&((t1$371=t0$370.length),((t1$371===2)&&(t0$370[0]==="data"))))){(body$363=t0$370[1]);;}else{$488($355$360);}(t0$381=generate_from_ast$211(body$363));if(((t0$381 instanceof Array)&&((t1$382=t0$381.length),(t1$382===2)))){(prep$377=t0$381[0]);(code$378=t0$381[1]);;}else{$488(generate_from_ast$211(body$363),"/home/olivier/git/earl-grey/src/earl-grey.eg",1352,1375);}(the_macros$379=eval((((prep$377+";(")+code$378)+")")));;return ["splice"].concat((((acc$394=[])),(((temp$399=items$196(the_macros$379))),((($length$404=temp$399.length)),((($index$409=0)),function(){$391:for(;($index$409<$length$404);($index$409++)){var k$427;var v$428;var t0$422;var t1$423;var m$417;(m$417=temp$399[$index$409]);;(t0$422=m$417);if(((t0$422 instanceof Array)&&((t1$423=t0$422.length),(t1$423===2)))){(k$427=t0$422[0]);(v$428=t0$422[1]);acc$394.push(["declare_raw",$677(["symbol",k$427],({"env":env$362})),["macro",v$428]]);}else{$488(m$417,"/home/olivier/git/earl-grey/src/earl-grey.eg",1451,1558);;}}}()))),acc$394));}]);(generate$212=function(source$437){return Generator$213().generate(source$437);});;(Generator$213=function(){var it$0$445;(it$0$445=function(){if((!$140(Generator$213)(this))){return Object.create(Generator$213.prototype);}else{return this;}}());;(it$0$445["tr"]=Translator$207(std$208.stdprelude));(it$0$445["env"]=std$208.stdenv.fork());return it$0$445;});;(Generator$213.prototype["generate"]=function(source$455){var t$463;var p$464;var ex$465;var rval$466;var it$0$458;(it$0$458=this);;(t$463=tokenize$202(source$455));;(p$464=parse$204(t$463));;(ex$465=std$208.expand(["top"],std$208.topscope,it$0$458.env.convert(["splice",p$464])));;(ex$465=opt$210.hoist(ex$465));(rval$466=it$0$458.tr.translate(ex$465,"stmt"));;return (it$0$458.tr.dump_store()+rval$466);});$677(Generator$213,$677(((accum$480=({})),((accum$480["::name"]="Generator"),accum$480)),((accum$484=({})),((accum$484["::egclass"]=true),accum$484))));Generator$213;(exports["Source"]=Source$198);(exports["Location"]=Location$199);(exports["highlight_locations"]=highlight_locations$200);(exports["tokenize"]=tokenize$202);(exports["parse"]=parse$204);(exports["Generator"]=Generator$213);(exports["generate"]=generate$212);

},{"./expand":5,"./lex":6,"./location":7,"./opt":8,"./parse":9,"./stdenv":12,"./translate-js":13,"./util":14}],5:[function(require,module,exports){
var $844=function(type$846){var f$849;(f$849=type$846["::check"]);;if((f$849===(void 0))){return function(value$854){return (value$854 instanceof type$846);};}else{return function(value$857){return f$849.call(type$846,value$857);};}};
var $859=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $860=function($861$863){var ph$867;(ph$867=$861$863);;var $865$872;($865$872=ph$867);;var bridge$866$877;var x$881;(bridge$866$877=$865$872);if((((typeof(bridge$866$877)==="string")&&((x$881=bridge$866$877),true))||((typeof(bridge$866$877)==="number")&&((x$881=bridge$866$877),true)))){return ["value",x$881];}else{var other$888;(other$888=$865$872);return other$888["::serialize_ast"]();}};
var send$728;(send$728=function(obj$733,$731$734){var ph$738;var msg$739;var t0$741;(t0$741=$731$734);(msg$739=t0$741);(ph$738=t0$741);;var $736$745;($736$745=ph$738);;var bridge$737$750;(bridge$737$750=$736$745);if(((typeof(bridge$737$750)==="string")||(typeof(bridge$737$750)==="number"))){return obj$733[msg$739];}else{var other$758;(other$758=$736$745);return obj$733["::send"](msg$739);}});;(Array[":::project"]=function($761$763){var ph$766;var value$767;var t0$769;(t0$769=$761$763);(value$767=t0$769);(ph$766=t0$769);;var $765$773;($765$773=ph$766);;if($844(Array)($765$773)){return [true,value$767];}else{$765$773;return [true,[value$767]];}});(Array.prototype["::check"]=function(value$787){if((value$787 instanceof Array)){var i$792;(i$792=0);;$790:for(;(i$792<this.length);(i$792++)){if(($859(this,i$792)!==$859(value$787,i$792))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$803){if((value$803 instanceof Array)){var i$808;(i$808=0);;$806:for(;(i$808<this.length);(i$808++)){if(($859(this,i$808)!==$859(value$803,i$808))){return [true,[value$803]];}}return [true,value$803.slice(this.length)];}else{return [true,[value$803]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($860));});(RegExp.prototype["::check"]=function(value$819){return value$819.match(this);});(RegExp.prototype[":::project"]=function(value$822){var $824$826;($824$826=value$822.match(this));;var m$834;if(($824$826===null)){(m$834=$824$826);return [false,null];}else{var m$839;(m$839=$824$826);return [true,m$839];}});(Function.prototype["::send"]=function(args$842){return this.apply(this,args$842);});
var $3021=function(arr$3023){var results$3027;var l$3028;(results$3027=[]);;(l$3028=arr$3023.length);;var i$3036;(i$3036=0);;$3026:for(;(i$3036<l$3028);(i$3036++)){results$3027.push([i$3036,$859(arr$3023,i$3036)]);}return results$3027;};
var $3043=function(dest$3045,values$3046){var k$3051;(k$3051=null);$3049:for(k$3051 in values$3046){if(values$3046.hasOwnProperty(k$3051)){(dest$3045[k$3051]=values$3046[k$3051]);}}return dest$3045;};
var $2867=function(){var $2868$2870;($2868$2870=function(tags$2874){var it$0$2877;(it$0$2877=function(){if((!$844($2868$2870)(this))){return Object.create($2868$2870.prototype);}else{return this;}}());;(it$0$2877["tags"]=tags$2874);return it$0$2877;});;($2868$2870.prototype["create"]=function(){var $2886$2888;($2886$2888=arguments);;var t0$2893;var message$2897;var args$2898;(t0$2893=$2886$2888.length);if((t0$2893>=0)){(message$2897=function(){if((0>=t0$2893)){return "";}else{return $2886$2888[0];}}());(args$2898=Array.prototype.slice.call($2886$2888,1));var it$0$2902;(it$0$2902=this);;var e$2907;(e$2907=Error(message$2897));;(e$2907["::tags"]=it$0$2902.tags);(e$2907["args"]=args$2898);var temp$2915;(temp$2915=$3021(args$2898));;var $length$2920;($length$2920=temp$2915.length);;var $index$2925;($index$2925=0);;$2908:for(;($index$2925<$length$2920);($index$2925++)){var m$2933;(m$2933=temp$2915[$index$2925]);;var t0$2938;var t1$2939;var i$2943;var arg$2944;(t0$2938=m$2933);if(((t0$2938 instanceof Array)&&((t1$2939=t0$2938.length),(t1$2939===2)))){(i$2943=t0$2938[0]);(arg$2944=t0$2938[1]);(e$2907[i$2943]=arg$2944);}else{$2854(m$2933);;}}(e$2907["length"]=args$2898.length);(e$2907["name"]=["E"].concat(it$0$2902.tags).join("."));return e$2907;}else{$2854($2886$2888);}});($2868$2870.prototype["::check"]=function(e$2955){var it$0$2958;(it$0$2958=this);;var tags$2963;if(((!e$2955)||(!$844(Error)(e$2955)))){return false;}(tags$2963=(e$2955["::tags"]||[]));;var temp$2972;(temp$2972=it$0$2958.tags);;var $length$2977;($length$2977=temp$2972.length);;var $index$2982;($index$2982=0);;$2964:for(;($index$2982<$length$2977);($index$2982++)){var m$2990;(m$2990=temp$2972[$index$2982]);;var tag$2998;(tag$2998=m$2990);if((tags$2963.indexOf(tag$2998)===-1)){return false;}else{false;;}}return true;});($2868$2870.prototype["::deconstruct"]=function(e$3006){var it$0$3009;(it$0$3009=this);;return e$3006.args;});$3043($2868$2870,$3043(function(){var accum$3014;(accum$3014=({}));(accum$3014["::name"]="$2868");return accum$3014;}(),function(){var accum$3018;(accum$3018=({}));(accum$3018["::egclass"]=true);return accum$3018;}()));return $2868$2870;}();
var $2854=function(value$2856,url$2857,start$2858,end$2859){var err$2862;(err$2862=$2867(["match"]).create("Could not find a match for value",({"value":value$2856})));;if(url$2857){(err$2862["location"]=["location",url$2857,start$2858,end$2859]);}throw err$2862;};
var $3055=function($3056$3058,key$3059){var ph$3063;(ph$3063=$3056$3058);;var $3061$3068;($3061$3068=ph$3063);;var bridge$3062$3073;(bridge$3062$3073=$3061$3068);if(((bridge$3062$3073===null)||(bridge$3062$3073===(void 0)))){return false;}else{var x$3081;if((typeof($3061$3068)==="string")){(x$3081=$3061$3068);return (key$3059 in String.prototype);}else{var x$3086;if((typeof($3061$3068)==="number")){(x$3086=$3061$3068);return (key$3059 in Number.prototype);}else{var x$3091;(x$3091=$3061$3068);return (key$3059 in x$3091);}}}};
var $3093=function(type$3095){return function(value$3098){var f$3101;(f$3101=type$3095[":::project"]);;if((f$3101===(void 0))){var f$3106;(f$3106=type$3095["::project"]);;if((f$3106===(void 0))){return [true,type$3095(value$3098)];}else{var rval$3111;(rval$3111=false);;try{(rval$3111=[true,f$3106(value$3098)]);}catch(excv$3117){var e$3123;(e$3123=excv$3117);(rval$3111=[false,null]);}return rval$3111;}}else{return f$3101.call(type$3095,value$3098);}};};var accum$1095;var accum$1099;var accum$1363;var accum$1367;var accum$2735;var accum$2739;var $891$895;var __lt____gt__$896;var $892$897;var __lt____lt____colon__$898;var util$899;var classify$900;var items$901;var iterkeys$902;var enumerate$903;var neighbours$904;var zip$905;var GenSym$906;var gensym$907;var uuid$908;var $894$909;var PatternParser$910;var PatternProcessor$911;var Scope$912;var Env$913;var track_location$914;var Expander$915;var mac1$916;var __chk_ncache$917;var __chk_scache$918;var checker_db$919;($891$895=require("./pp"));;(__lt____gt__$896=$891$895["<>"]);;($892$897=require("./location"));;(__lt____lt____colon__$898=$892$897["<<:"]);;(util$899=require("./util"));;(classify$900=util$899.classify);;(items$901=util$899.items);;(iterkeys$902=util$899.keys);;(enumerate$903=util$899.enumerate);;(neighbours$904=util$899.neighbours);;(zip$905=util$899.zip);;(GenSym$906=util$899.GenSym);;(gensym$907=util$899.gensym);;(uuid$908=util$899.uuid);;($894$909=require("./pattern"));;(PatternParser$910=$894$909.PatternParser);;(PatternProcessor$911=$894$909.PatternProcessor);;(Scope$912=function(){var it$0$991;var parent$985;var name$986;var expander$987;var t0$981;var $974$976;($974$976=arguments);;(t0$981=$974$976.length);if(((t0$981>=0)&&(t0$981<=3))){(parent$985=function(){if((0>=t0$981)){return null;}else{return $974$976[0];}}());(name$986=function(){if((1>=t0$981)){return null;}else{return $974$976[1];}}());(expander$987=function(){if((2>=t0$981)){return null;}else{return $974$976[2];}}());(it$0$991=function(){if((!$844(Scope$912)(this))){return Object.create(Scope$912.prototype);}else{return this;}}());;(it$0$991["name"]=(name$986||gensym$907("scope")));(it$0$991["parent"]=parent$985);(it$0$991["options"]=({}));(it$0$991["expander"]=(expander$987||parent$985.expander));return it$0$991;}else{$2854($974$976);}});;(Scope$912.prototype["getopt"]=function(opt$1003){var otherwise$1030;var $1007$1019;var $1006$1013;var it$0$1008;(it$0$1008=this);;($1006$1013=null);;$1006$1013;if(Object.prototype.hasOwnProperty.call(it$0$1008.options,opt$1003)){return $859(it$0$1008.options,opt$1003);}else{if((it$0$1008.parent===null)){return (void 0);}else{(otherwise$1030=$1006$1013);return it$0$1008.parent.getopt(opt$1003);}}});(Scope$912.prototype["setopt"]=function(opt$1035,value$1036){var it$0$1039;(it$0$1039=this);;return (it$0$1039.options[opt$1035]=value$1036);});(Scope$912.prototype["gensym"]=function(){var it$0$1048;(it$0$1048=this);;return it$0$1048.expander.gensym();});(Scope$912.prototype["step"]=function(context$1055,expr$1056){var it$0$1059;(it$0$1059=this);;return it$0$1059.expander.step(context$1055,it$0$1059,expr$1056);});(Scope$912.prototype["step_all"]=function(context$1066,exprs$1067){var it$0$1070;(it$0$1070=this);;return it$0$1070.expander.step_all(context$1066,it$0$1070,exprs$1067);});(Scope$912.prototype["expand"]=function(context$1077,expr$1078){var it$0$1081;(it$0$1081=this);;return it$0$1081.expander.expand(context$1077,it$0$1081,expr$1078);});(Scope$912.prototype["toString"]=function(){var it$0$1090;(it$0$1090=this);;return (("Scope{"+it$0$1090.name)+"}");});$3043(Scope$912,$3043(((accum$1095=({})),((accum$1095["::name"]="Scope"),accum$1095)),((accum$1099=({})),((accum$1099["::egclass"]=true),accum$1099))));Scope$912;(Env$913=function(){var it$0$1107;(it$0$1107=function(){if((!$844(Env$913)(this))){return Object.create(Env$913.prototype);}else{return this;}}());;(it$0$1107["scopes"]=({}));return it$0$1107;});;(Env$913.prototype["resolve"]=function(scope$1116,name$1117){var scope_data$1125;var it$0$1120;(it$0$1120=this);;if((scope$1116===null)){return (void 0);}(scope_data$1125=$859(it$0$1120.scopes,scope$1116.name));;if((scope_data$1125&&Object.prototype.hasOwnProperty.call(scope_data$1125,name$1117))){return $859(scope_data$1125,name$1117);}else{return it$0$1120.resolve(scope$1116.parent,name$1117);}});(Env$913.prototype["bind"]=function(scope$1133,name$1134,value$1135){var it$0$1138;(it$0$1138=this);;if((!$859(it$0$1138.scopes,scope$1133.name))){(it$0$1138.scopes[scope$1133.name]=({}));}return ($859(it$0$1138.scopes,scope$1133.name)[name$1134]=value$1135);});(Env$913.prototype["convert"]=function(expr$1147){var x$1186;var x$1191;var bridge$1154$1183;var x$1196;var bridge$1153$1180;var x$1201;var bridge$1152$1177;var x$1206;var $index$1233;var $length$1228;var temp$1223;var other$1253;var type$1213;var args$1214;var e$1170;var bridge$1151$1165;var t0$1166;var $1150$1160;var it$0$1155;(it$0$1155=this);;($1150$1160=expr$1147);;if($3055($1150$1160,"env")){(e$1170=$1150$1160.env);return expr$1147;}else{(bridge$1151$1165=$1150$1160);if((((bridge$1152$1177=bridge$1151$1165),(((bridge$1153$1180=bridge$1152$1177),(((bridge$1154$1183=bridge$1153$1180),((((x$1186=bridge$1154$1183)),((x$1186 instanceof Array)&&(x$1186[0]==="symbol")))||(((x$1191=bridge$1154$1183)),((x$1191 instanceof Array)&&(x$1191[0]==="value")))))||(((x$1196=bridge$1153$1180)),((x$1196 instanceof Array)&&(x$1196[0]==="variable")))))||(((x$1201=bridge$1152$1177)),((x$1201 instanceof Array)&&(x$1201[0]==="macro")))))||(((x$1206=bridge$1151$1165)),((x$1206 instanceof Array)&&(x$1206[0]==="void"))))){return $3043(expr$1147,({"env":it$0$1155}));}else{if((($1150$1160 instanceof Array)&&((t0$1166=$1150$1160.length),(t0$1166>=1)))){(type$1213=$1150$1160[0]);(args$1214=Array.prototype.slice.call($1150$1160,1));(temp$1223=args$1214);;($length$1228=temp$1223.length);;($index$1233=0);;$1219:for(;($index$1233<$length$1228);($index$1233++)){var arg$1249;var m$1241;(m$1241=temp$1223[$index$1233]);;(arg$1249=m$1241);it$0$1155.convert(arg$1249);}return $3043(expr$1147,({"env":it$0$1155}));}else{(other$1253=$1150$1160);return $3043(expr$1147,({"env":it$0$1155}));}}}});(Env$913.prototype["fork"]=function(){var $index$1283;var $length$1278;var temp$1273;var e$1265;var it$0$1260;(it$0$1260=this);;(e$1265=Env$913());;(temp$1273=items$901(it$0$1260.scopes));;($length$1278=temp$1273.length);;($index$1283=0);;$1266:for(;($index$1283<$length$1278);($index$1283++)){var $index$1324;var $length$1319;var temp$1314;var acc$1309;var scope$1301;var bindings$1302;var t0$1296;var t1$1297;var m$1291;(m$1291=temp$1273[$index$1283]);;(t0$1296=m$1291);if(((t0$1296 instanceof Array)&&((t1$1297=t0$1296.length),(t1$1297===2)))){(scope$1301=t0$1296[0]);(bindings$1302=t0$1296[1]);(acc$1309=[]);;(temp$1314=items$901(bindings$1302));;($length$1319=temp$1314.length);;($index$1324=0);;$1306:for(;($index$1324<$length$1319);($index$1324++)){var k$1342;var v$1343;var t0$1337;var t1$1338;var m$1332;(m$1332=temp$1314[$index$1324]);;(t0$1337=m$1332);if(((t0$1337 instanceof Array)&&((t1$1338=t0$1337.length),(t1$1338===2)))){(k$1342=t0$1337[0]);(v$1343=t0$1337[1]);acc$1309.push((function(){if((!$859(e$1265.scopes,scope$1301))){return (e$1265.scopes[scope$1301]=({}));}}(),($859(e$1265.scopes,scope$1301)[k$1342]=v$1343)));}else{$2854(m$1332,"/home/olivier/git/earl-grey/src/expand.eg",2004,2163);;}}acc$1309;}else{$2854(m$1291,"/home/olivier/git/earl-grey/src/expand.eg",1964,2163);;}}return e$1265;});(Env$913.prototype["toString"]=function(){var it$0$1358;(it$0$1358=this);;return "Env{...}";});$3043(Env$913,$3043(((accum$1363=({})),((accum$1363["::name"]="Env"),accum$1363)),((accum$1367=({})),((accum$1367["::egclass"]=true),accum$1367))));Env$913;(track_location$914=function(f$1373){var f2$1376;(f2$1376=function(context$1380,scope$1381,expr$1382){var rval$1390;var other$1422;var v$1416;var t0$1412;var $1385$1407;var rval$1386;(rval$1386=(((rval$1390=false)),(function(){try{(rval$1390=f$1373(context$1380,scope$1381,expr$1382));}catch(excv$1396){var e$1402;(e$1402=excv$1396);(rval$1390=(__lt____lt____colon__$898(e$1402,expr$1382),function(){throw e$1402;}()));}}(),rval$1390)));;($1385$1407=rval$1386);;if((($1385$1407 instanceof Array)&&((t0$1412=$1385$1407.length),((t0$1412===2)&&($1385$1407[0]==="bounce"))))){(v$1416=$1385$1407[1]);return f2$1376(context$1380,scope$1381,__lt____lt____colon__$898(v$1416,expr$1382));}else{(other$1422=$1385$1407);return __lt____lt____colon__$898(other$1422,expr$1382);}});;return f2$1376;});;(Expander$915=function(env_factory$1429,generic_nodes$1430){var it$0$1433;(it$0$1433=function(){if((!$844(Expander$915)(this))){return Object.create(Expander$915.prototype);}else{return this;}}());;(it$0$1433["gensym"]=gensym$907);(it$0$1433["mkenv"]=env_factory$1429);(it$0$1433["generic_nodes"]=generic_nodes$1430);return it$0$1433;});;(Expander$915.prototype["run_macro"]=function(m$1443,context$1444,scope$1445,form$1446,arg$1447){var rval$1459;var rval$1455;var it$0$1450;(it$0$1450=this);;(rval$1455=(((rval$1459=false)),(function(){try{(rval$1459=m$1443(context$1444,scope$1445,form$1446,arg$1447));}catch(excv$1465){var msg$1498;var msg$1593;var find$1507;var err$1508;var other$1504;var $1485$1487;var e$1482;var e$1600;var value$1475;var t0$1468;var t1$1469;var t2$1470;var t3$1471;(t0$1468=excv$1465);if(($844($2867(["match"]))(t0$1468)&&($3055(t0$1468,"args")&&((t1$1469=t0$1468.args),((t1$1469 instanceof Array)&&((t2$1470=t1$1469.length),((t2$1470===1)&&((t3$1471=t1$1469[0]),$3055(t3$1471,"value"))))))))){(value$1475=t3$1471.value);(rval$1459=(((e$1482=((($1485$1487=value$1475)),function(){if(($1485$1487===context$1444)){(msg$1498="The macro cannot be found in this context.");;return $2867(["syntax","context"]).create(msg$1498,({"context":context$1444,"form":form$1446}));}else{(other$1504=$1485$1487);(find$1507=function($1511$1513){var t0$1519;var msg$1535;var $index$1561;var $length$1556;var temp$1551;var other$1586;var type$1541;var xs$1542;var t0$1528;var $1515$1523;var ph$1516;var arg$1517;(t0$1519=$1511$1513);(arg$1517=t0$1519);(ph$1516=t0$1519);;($1515$1523=ph$1516);;if(($1515$1523===value$1475)){(msg$1535="The macro could not match its argument (or part of it).");;return $2867(["syntax","argument"]).create(msg$1535,({"context":context$1444,"argument":arg$1517,"form":form$1446}));}else{if((($1515$1523 instanceof Array)&&((t0$1528=$1515$1523.length),(t0$1528>=1)))){(type$1541=$1515$1523[0]);(xs$1542=Array.prototype.slice.call($1515$1523,1));(temp$1551=xs$1542);;($length$1556=temp$1551.length);;($index$1561=0);;$1547:for(;($index$1561<$length$1556);($index$1561++)){var x$1578;var t0$1574;var m$1569;(m$1569=temp$1551[$index$1561]);;(t0$1574=$3093(find$1507)(m$1569));if(t0$1574[0]){(x$1578=t0$1574[1]);if(x$1578){return x$1578;}}else{$2854(m$1569,"/home/olivier/git/earl-grey/src/expand.eg",3441,3526);;}}return false;}else{(other$1586=$1515$1523);return false;}}});;(err$1508=find$1507(arg$1447));;if(err$1508){return err$1508;}else{(msg$1593="The macro failed because it failed to match some value, probably one that it generated itself.");;return $2867(["syntax","failure"]).create(msg$1593,({"form":form$1446,"value":value$1475}));}}}()))),function(){throw e$1482;}()));}else{(e$1600=excv$1465);(rval$1459=function(){throw e$1600;}());}}}(),rval$1459)));;return it$0$1450.mkenv().convert(rval$1455);});(Expander$915.prototype["step"]=function(context$1606,scope$1607,expr$1608){var helper$1616;var it$0$1611;(it$0$1611=this);;(helper$1616=track_location$914(function(context$1621,scope$1622,$1619$1623){var t0$1632;var other$1672;var env$1667;var $1657$1659;var other$1705;var t0$1696;var $1689$1691;var other$1709;var m$1685;var t0$1681;var $1653$1676;var env$1654;var other$1732;var t0$1723;var $1716$1718;var other$1757;var m$1751;var t0$1747;var $1740$1742;var other$1766;var x$1761;var f$1736;var arg$1737;var m$1713;var s$1648;var $1626$1643;var $1627$1644;var $1628$1645;var t0$1641;var $1625$1636;var ph$1629;var expr$1630;(t0$1632=$1619$1623);(expr$1630=t0$1632);(ph$1629=t0$1632);;($1625$1636=ph$1629);;if((($1626$1643=($1625$1636 instanceof Array))&&((t0$1641=$1625$1636.length),(($1628$1645=(t0$1641===2))&&($1625$1636[0]==="symbol"))))){(s$1648=$1625$1636[1]);(env$1654=((($1657$1659=expr$1630)),function(){if($3055($1657$1659,"env")){(env$1667=$1657$1659.env);return expr$1630.env;}else{(other$1672=$1657$1659);throw $2867(["syntax","no_env"]).create("No environment was found to resolve",({"symbol":expr$1630}));}}()));;($1653$1676=env$1654.resolve(scope$1622,s$1648));;if((($1653$1676 instanceof Array)&&((t0$1681=$1653$1676.length),((t0$1681===2)&&($1653$1676[0]==="macro"))))){(m$1685=$1653$1676[1]);($1689$1691=context$1621);;if((($1689$1691 instanceof Array)&&((t0$1696=$1689$1691.length),((t0$1696===2)&&(($1689$1691[0]==="expr")&&($1689$1691[1]==="head")))))){return ["macro",m$1685];}else{(other$1705=$1689$1691);return ["bounce",it$0$1611.run_macro(m$1685,context$1621,scope$1622,expr$1630,__lt____lt____colon__$898(["void"],expr$1630))];}}else{(other$1709=$1653$1676);return expr$1630;}}else{if(($1628$1645&&($1625$1636[0]==="macro"))){(m$1713=$1625$1636[1]);($1716$1718=context$1621);;if((($1716$1718 instanceof Array)&&((t0$1723=$1716$1718.length),((t0$1723===2)&&(($1716$1718[0]==="expr")&&($1716$1718[1]==="head")))))){return expr$1630;}else{(other$1732=$1716$1718);return ["bounce",it$0$1611.run_macro(m$1713,context$1621,scope$1622,expr$1630,__lt____lt____colon__$898(["void"],expr$1630))];}}else{if(($1626$1643&&((t0$1641===3)&&($1625$1636[0]==="send")))){(f$1736=$1625$1636[1]);(arg$1737=$1625$1636[2]);($1740$1742=helper$1616(["expr","head"],scope$1622,f$1736));;if((($1740$1742 instanceof Array)&&((t0$1747=$1740$1742.length),((t0$1747===2)&&($1740$1742[0]==="macro"))))){(m$1751=$1740$1742[1]);return ["bounce",it$0$1611.run_macro(m$1751,context$1621,scope$1622,expr$1630,arg$1737)];}else{(other$1757=$1740$1742);return expr$1630;}}else{if(($1626$1643&&((t0$1641===2)&&($1625$1636[0]==="nostep")))){(x$1761=$1625$1636[1]);return x$1761;}else{(other$1766=$1625$1636);return expr$1630;}}}}}));;return helper$1616(context$1606,scope$1607,expr$1608);});(Expander$915.prototype["step_all"]=function(context$1773,scope$1774,$1771$1775){var t0$1779;var t1$1780;var pre$1791;var bulk$1792;var post$1793;var it$0$1786;var stmts$1777;(t0$1779=$1771$1775);if(((t0$1779 instanceof Array)&&((t1$1780=t0$1779.length),(t1$1780>=0)))){(stmts$1777=Array.prototype.slice.call(t0$1779,0));;}else{$2854($1771$1775);}(it$0$1786=this);;(pre$1791=[]);;(bulk$1792=[]);;(post$1793=[]);;$1803:while(stmts$1777.length){var x$1849;var m$1844;var stmt$1839;var stmt$1834;var prepend$1828;var $1808$1823;var $1809$1824;var $1810$1825;var t0$1821;var $1807$1816;var current$1811;(current$1811=stmts$1777.shift());;($1807$1816=it$0$1786.step(context$1773,scope$1774,current$1811));;if((($1808$1823=($1807$1816 instanceof Array))&&((t0$1821=$1807$1816.length),((t0$1821>=1)&&($1807$1816[0]==="splice"))))){(prepend$1828=Array.prototype.slice.call($1807$1816,1));(stmts$1777=prepend$1828.concat(stmts$1777));}else{if(($1808$1823&&(($1810$1825=(t0$1821===2))&&($1807$1816[0]==="float")))){(stmt$1834=$1807$1816[1]);(pre$1791=pre$1791.concat(it$0$1786.step_all(context$1773,scope$1774,[stmt$1834])));}else{if(($1810$1825&&($1807$1816[0]==="sink"))){(stmt$1839=$1807$1816[1]);(post$1793=post$1793.concat(it$0$1786.step_all(context$1773,scope$1774,[stmt$1839])));}else{if(($1810$1825&&($1807$1816[0]==="multimacro"))){(m$1844=$1807$1816[1]);(stmts$1777=m$1844(context$1773,scope$1774,current$1811,stmts$1777));}else{(x$1849=$1807$1816);bulk$1792.push(x$1849);}}}}}return pre$1791.concat(bulk$1792).concat(post$1793);});(Expander$915.prototype["expand"]=function(context$1854,scope$1855,expr$1856){var helper$1864;var it$0$1859;(it$0$1859=this);;(helper$1864=track_location$914(function(context$1868,scope$1869,expr$1870){var t0$1901;var other$1918;var $1898$1906;var env$1899;var $index$1965;var $length$1960;var temp$1955;var acc$1950;var newargs$1944;var $index$2011;var $length$2006;var temp$2001;var acc$1996;var newargs$1990;var t0$2055;var newscope$2049;var env$2050;var $index$2112;var $length$2107;var temp$2102;var acc$2097;var $index$2222;var $length$2217;var temp$2212;var acc$2207;var t0$2086;var newscope$2070;var stepscope$2071;var changes$2072;var newargs$2073;var vars$2074;var exp$2075;var $index$2490;var $length$2485;var temp$2480;var other$2564;var t0$2547;var $2540$2542;var is_obj$2401;var obj$2402;var arr$2403;var arr_parts$2404;var obj_parts$2405;var new_arr_part$2406;var new_obj_part$2407;var r$2408;var $index$2607;var $length$2602;var temp$2597;var acc$2592;var newscope$2584;var s$2667;var newscope$2676;var name$2663;var t0$2659;var $index$2711;var $length$2706;var temp$2701;var acc$2696;var other$2731;var type$2687;var args$2688;var tag$2680;var body$2681;var x$2654;var $1874$2655;var bindings$2579;var body$2580;var target$2573;var value$2574;var args$2397;var args$2066;var args$2061;var variable$2039;var s$2040;var value$2041;var body$2042;var args$1986;var args$1940;var f$1934;var arg$1935;var s$1893;var $1875$1888;var $1876$1889;var $1877$1890;var t0$1884;var t1$1885;var t2$1886;var $1873$1879;(expr$1870=it$0$1859.step(context$1868,scope$1869,expr$1870));($1873$1879=expr$1870);;if((($1875$1888=($1873$1879 instanceof Array))&&((t0$1884=$1873$1879.length),(($1877$1890=(t0$1884===2))&&($1873$1879[0]==="symbol"))))){(s$1893=$1873$1879[1]);(t0$1901=expr$1870);if($3055(t0$1901,"env")){(env$1899=t0$1901.env);;}else{$2854(expr$1870,"/home/olivier/git/earl-grey/src/expand.eg",7759,7763);}($1898$1906=env$1899.resolve(scope$1869,s$1893));;if(($1898$1906===(void 0))){throw $2867(["syntax","undeclared"]).create(("Undeclared variable: "+s$1893),({"node":expr$1870}));}else{(other$1918=$1898$1906);return ["bounce",other$1918];}}else{if(($1877$1890&&($1873$1879[0]==="value"))){$1873$1879[1];return expr$1870;}else{if(($1877$1890&&($1873$1879[0]==="variable"))){$1873$1879[1];return expr$1870;}else{if(($1875$1888&&((t0$1884===1)&&($1873$1879[0]==="void")))){return expr$1870;}else{if(($1875$1888&&((t0$1884===3)&&($1873$1879[0]==="send")))){(f$1934=$1873$1879[1]);(arg$1935=$1873$1879[2]);return ["send",helper$1864(["expr","head"],scope$1869,f$1934),helper$1864(["expr","tail"],scope$1869,arg$1935)];}else{if(($1875$1888&&(($1877$1890=(t0$1884>=1))&&($1873$1879[0]==="array")))){(args$1940=Array.prototype.slice.call($1873$1879,1));(newargs$1944=(((acc$1950=[])),(((temp$1955=it$0$1859.step_all(["expr","array"],scope$1869,args$1940))),((($length$1960=temp$1955.length)),((($index$1965=0)),function(){$1947:for(;($index$1965<$length$1960);($index$1965++)){var arg$1981;var m$1973;(m$1973=temp$1955[$index$1965]);;(arg$1981=m$1973);acc$1950.push(helper$1864(["expr","expr"],scope$1869,arg$1981));}}()))),acc$1950));;return ["array"].concat(newargs$1944);}else{if(($1877$1890&&($1873$1879[0]==="object"))){(args$1986=Array.prototype.slice.call($1873$1879,1));(newargs$1990=(((acc$1996=[])),(((temp$2001=it$0$1859.step_all(["expr","object"],scope$1869,args$1986))),((($length$2006=temp$2001.length)),((($index$2011=0)),function(){$1993:for(;($index$2011<$length$2006);($index$2011++)){var k$2029;var v$2030;var t0$2024;var t1$2025;var m$2019;(m$2019=temp$2001[$index$2011]);;(t0$2024=m$2019);if(((t0$2024 instanceof Array)&&((t1$2025=t0$2024.length),((t1$2025===3)&&(t0$2024[0]==="array"))))){(k$2029=t0$2024[1]);(v$2030=t0$2024[2]);acc$1996.push(["array",helper$1864(["expr","expr"],scope$1869,k$2029),helper$1864(["expr","expr"],scope$1869,v$2030)]);}else{$2854(m$2019,"/home/olivier/git/earl-grey/src/expand.eg",8603,8791);;}}}()))),acc$1996));;return ["object"].concat(newargs$1990);}else{if(($1875$1888&&((t0$1884===4)&&(($1873$1879[0]==="bind")&&((t1$1885=$1873$1879[1]),((variable$2039=t1$1885),((t1$1885 instanceof Array)&&((t2$1886=t1$1885.length),((t2$1886===2)&&(t1$1885[0]==="symbol")))))))))){(s$2040=t1$1885[1]);(value$2041=$1873$1879[2]);(body$2042=$1873$1879[3]);(newscope$2049=Scope$912(scope$1869));;(t0$2055=variable$2039);if($3055(t0$2055,"env")){(env$2050=t0$2055.env);;}else{$2854(variable$2039,"/home/olivier/git/earl-grey/src/expand.eg",8934,8942);}env$2050.bind(newscope$2049,s$2040,value$2041);return helper$1864(context$1868,newscope$2049,body$2042);}else{if(($1875$1888&&(($1877$1890=(t0$1884>=1))&&($1873$1879[0]==="splice")))){(args$2061=Array.prototype.slice.call($1873$1879,1));return ["bounce",$3043(["multi"].concat(args$2061),({"override_scope":true}))];}else{if(($1877$1890&&($1873$1879[0]==="multi"))){(args$2066=Array.prototype.slice.call($1873$1879,1));(newscope$2070=function(){if(expr$1870.override_scope){return scope$1869;}else{return Scope$912(scope$1869);}}());;(stepscope$2071=function(){if(expr$1870.nonrecursive){return scope$1869;}else{return newscope$2070;}}());;(changes$2072=false);;(t0$2086=classify$900("newargs","vars",(((acc$2097=[])),(((temp$2102=it$0$1859.step_all(["expr","multi"],stepscope$2071,args$2066))),((($length$2107=temp$2102.length)),((($index$2112=0)),function(){$2088:for(;($index$2112<$length$2107);($index$2112++)){var t0$2157;var env$2155;var t0$2175;var env$2172;var v$2173;var other$2193;var v$2184;var value$2185;var variable$2163;var s$2164;var value$2165;var variable$2146;var s$2147;var value$2148;var opt$2138;var value$2139;var $2090$2130;var $2091$2131;var $2092$2132;var $2093$2133;var $2094$2134;var $2095$2135;var t0$2125;var t1$2126;var t2$2127;var t3$2128;var m$2120;(m$2120=temp$2102[$index$2112]);;(t0$2125=m$2120);if((($2091$2131=(t0$2125 instanceof Array))&&((t1$2126=t0$2125.length),(($2093$2133=(t1$2126===3))&&(t0$2125[0]==="option"))))){(opt$2138=t0$2125[1]);(value$2139=t0$2125[2]);acc$2097.push((newscope$2070.setopt(opt$2138,value$2139),["ignore"]));}else{if(($2093$2133&&((t0$2125[0]==="declare_raw")&&((t2$2127=t0$2125[1]),((variable$2146=t2$2127),((t2$2127 instanceof Array)&&((t3$2128=t2$2127.length),((t3$2128===2)&&(t2$2127[0]==="symbol"))))))))){(s$2147=t2$2127[1]);(value$2148=t0$2125[2]);acc$2097.push((((t0$2157=variable$2146),function(){if($3055(t0$2157,"env")){(env$2155=t0$2157.env);}else{return $2854(variable$2146,"/home/olivier/git/earl-grey/src/expand.eg",9738,9746);}}()),env$2155.bind(newscope$2070,s$2147,value$2148),(changes$2072=true),["ignore"]));}else{if(($2091$2131&&(($2093$2133=((t1$2126>=2)&&(t1$2126<=3)))&&(($2094$2134=(t0$2125[0]==="declare"))&&((t2$2127=t0$2125[1]),((variable$2163=t2$2127),((t2$2127 instanceof Array)&&((t3$2128=t2$2127.length),((t3$2128===2)&&(t2$2127[0]==="symbol")))))))))){(s$2164=t2$2127[1]);(value$2165=function(){if((2>=t1$2126)){return null;}else{return t0$2125[2];}}());acc$2097.push((((t0$2175=variable$2163),function(){if($3055(t0$2175,"env")){(env$2172=t0$2175.env);}else{return $2854(variable$2163,"/home/olivier/git/earl-grey/src/expand.eg",9983,9991);}}()),((v$2173=__lt____lt____colon__$898(["variable",it$0$1859.gensym(s$2164)],variable$2163))),env$2172.bind(newscope$2070,s$2164,v$2173),(changes$2072=true),function(){if(value$2165){return ["splice",["newargs",["assign",v$2173,value$2165]],["vars",v$2173]];}else{return ["vars",v$2173];}}()));}else{if(($2094$2134&&((v$2184=t2$2127),((t2$2127 instanceof Array)&&((t3$2128=t2$2127.length),((t3$2128===2)&&(t2$2127[0]==="variable"))))))){t2$2127[1];(value$2185=function(){if((2>=t1$2126)){return null;}else{return t0$2125[2];}}());acc$2097.push(((changes$2072=true),function(){if(value$2185){return ["splice",["newargs",["assign",v$2184,value$2185]],["vars",v$2184]];}else{return ["vars",v$2184];}}()));}else{(other$2193=m$2120);acc$2097.push(["newargs",other$2193]);}}}}}}()))),acc$2097)));if(($3055(t0$2086,"newargs")&&((newargs$2073=t0$2086.newargs),$3055(t0$2086,"vars")))){(vars$2074=t0$2086.vars);;}else{$2854(classify$900("newargs","vars",(((acc$2207=[])),(((temp$2212=it$0$1859.step_all(["expr","multi"],stepscope$2071,args$2066))),((($length$2217=temp$2212.length)),((($index$2222=0)),function(){$2198:for(;($index$2222<$length$2217);($index$2222++)){var t0$2267;var env$2265;var t0$2285;var env$2282;var v$2283;var other$2303;var v$2294;var value$2295;var variable$2273;var s$2274;var value$2275;var variable$2256;var s$2257;var value$2258;var opt$2248;var value$2249;var $2200$2240;var $2201$2241;var $2202$2242;var $2203$2243;var $2204$2244;var $2205$2245;var t0$2235;var t1$2236;var t2$2237;var t3$2238;var m$2230;(m$2230=temp$2212[$index$2222]);;(t0$2235=m$2230);if((($2201$2241=(t0$2235 instanceof Array))&&((t1$2236=t0$2235.length),(($2203$2243=(t1$2236===3))&&(t0$2235[0]==="option"))))){(opt$2248=t0$2235[1]);(value$2249=t0$2235[2]);acc$2207.push((newscope$2070.setopt(opt$2248,value$2249),["ignore"]));}else{if(($2203$2243&&((t0$2235[0]==="declare_raw")&&((t2$2237=t0$2235[1]),((variable$2256=t2$2237),((t2$2237 instanceof Array)&&((t3$2238=t2$2237.length),((t3$2238===2)&&(t2$2237[0]==="symbol"))))))))){(s$2257=t2$2237[1]);(value$2258=t0$2235[2]);acc$2207.push((((t0$2267=variable$2256),function(){if($3055(t0$2267,"env")){(env$2265=t0$2267.env);}else{return $2854(variable$2256,"/home/olivier/git/earl-grey/src/expand.eg",9738,9746);}}()),env$2265.bind(newscope$2070,s$2257,value$2258),(changes$2072=true),["ignore"]));}else{if(($2201$2241&&(($2203$2243=((t1$2236>=2)&&(t1$2236<=3)))&&(($2204$2244=(t0$2235[0]==="declare"))&&((t2$2237=t0$2235[1]),((variable$2273=t2$2237),((t2$2237 instanceof Array)&&((t3$2238=t2$2237.length),((t3$2238===2)&&(t2$2237[0]==="symbol")))))))))){(s$2274=t2$2237[1]);(value$2275=function(){if((2>=t1$2236)){return null;}else{return t0$2235[2];}}());acc$2207.push((((t0$2285=variable$2273),function(){if($3055(t0$2285,"env")){(env$2282=t0$2285.env);}else{return $2854(variable$2273,"/home/olivier/git/earl-grey/src/expand.eg",9983,9991);}}()),((v$2283=__lt____lt____colon__$898(["variable",it$0$1859.gensym(s$2274)],variable$2273))),env$2282.bind(newscope$2070,s$2274,v$2283),(changes$2072=true),function(){if(value$2275){return ["splice",["newargs",["assign",v$2283,value$2275]],["vars",v$2283]];}else{return ["vars",v$2283];}}()));}else{if(($2204$2244&&((v$2294=t2$2237),((t2$2237 instanceof Array)&&((t3$2238=t2$2237.length),((t3$2238===2)&&(t2$2237[0]==="variable"))))))){t2$2237[1];(value$2295=function(){if((2>=t1$2236)){return null;}else{return t0$2235[2];}}());acc$2207.push(((changes$2072=true),function(){if(value$2295){return ["splice",["newargs",["assign",v$2294,value$2295]],["vars",v$2294]];}else{return ["vars",v$2294];}}()));}else{(other$2303=m$2230);acc$2207.push(["newargs",other$2303]);}}}}}}()))),acc$2207)),"/home/olivier/git/earl-grey/src/expand.eg",9410,10931);}(exp$2075=function(s$2308){var $index$2334;var $length$2329;var temp$2324;var acc$2319;var $index$2376;var $length$2371;var temp$2366;var acc$2361;var stepped$2311;(stepped$2311=(((acc$2319=[])),(((temp$2324=enumerate$903(newargs$2073))),((($length$2329=temp$2324.length)),((($index$2334=0)),function(){$2316:for(;($index$2334<$length$2329);($index$2334++)){var i$2352;var arg$2353;var t0$2347;var t1$2348;var m$2342;(m$2342=temp$2324[$index$2334]);;(t0$2347=m$2342);if(((t0$2347 instanceof Array)&&((t1$2348=t0$2347.length),(t1$2348===2)))){(i$2352=t0$2347[0]);(arg$2353=t0$2347[1]);acc$2319.push(it$0$1859.step(["expr",function(){if((i$2352===(newargs$2073.length-1))){return "expr";}else{return "ignore";}}()],s$2308,arg$2353));}else{$2854(m$2342,"/home/olivier/git/earl-grey/src/expand.eg",11153,11330);;}}}()))),acc$2319));;(acc$2361=[]);;(temp$2366=stepped$2311);;($length$2371=temp$2366.length);;($index$2376=0);;$2312:for(;($index$2376<$length$2371);($index$2376++)){var arg$2392;var m$2384;(m$2384=temp$2366[$index$2376]);;(arg$2392=m$2384);acc$2361.push(helper$1864(["expr","expr"],s$2308,arg$2392));}return acc$2361;});;if(changes$2072){return ["scope",vars$2074,["multi"].concat(exp$2075(newscope$2070))];}else{return ["multi"].concat(exp$2075(scope$1869));}}else{if(($1877$1890&&($1873$1879[0]==="data"))){(args$2397=Array.prototype.slice.call($1873$1879,1));(is_obj$2401=false);;(obj$2402=["object"]);;(arr$2403=["array"]);;(arr_parts$2404=[]);;(obj_parts$2405=[]);;(new_arr_part$2406=function(){var other$2450;var t0$2441;var $2434$2436;($2434$2436=arr$2403);;if((($2434$2436 instanceof Array)&&((t0$2441=$2434$2436.length),((t0$2441===1)&&($2434$2436[0]==="array"))))){return false;}else{(other$2450=$2434$2436);arr_parts$2404.push(arr$2403);return (arr$2403=["array"]);}});;(new_obj_part$2407=function(){var other$2474;var t0$2465;var $2458$2460;($2458$2460=obj$2402);;if((($2458$2460 instanceof Array)&&((t0$2465=$2458$2460.length),((t0$2465===1)&&($2458$2460[0]==="object"))))){return false;}else{(other$2474=$2458$2460);obj_parts$2405.push(obj$2402);return (obj$2402=["object"]);}});;(temp$2480=it$0$1859.step_all(["expr","data"],scope$1869,args$2397));;($length$2485=temp$2480.length);;($index$2490=0);;$2409:for(;($index$2490<$length$2485);($index$2490++)){var other$2536;var expr$2530;var expr$2524;var k$2517;var v$2518;var $2411$2506;var $2412$2507;var $2413$2508;var $2414$2509;var t0$2503;var t1$2504;var m$2498;(m$2498=temp$2480[$index$2490]);;(t0$2503=m$2498);if((($2412$2507=(t0$2503 instanceof Array))&&((t1$2504=t0$2503.length),((t1$2504===1)&&(t0$2503[0]==="assoc"))))){(is_obj$2401=true);}else{if(($2412$2507&&((t1$2504===3)&&(t0$2503[0]==="assoc")))){(k$2517=t0$2503[1]);(v$2518=t0$2503[2]);(is_obj$2401=true);obj$2402.push(["array",k$2517,v$2518]);}else{if(($2412$2507&&(($2414$2509=(t1$2504===2))&&(t0$2503[0]==="dynsplice")))){(expr$2524=t0$2503[1]);new_arr_part$2406();arr_parts$2404.push(expr$2524);}else{if(($2414$2509&&(t0$2503[0]==="objsplice"))){(expr$2530=t0$2503[1]);(is_obj$2401=true);new_obj_part$2407();obj_parts$2405.push(expr$2530);}else{(other$2536=m$2498);arr$2403.push(other$2536);}}}}}new_arr_part$2406();new_obj_part$2407();(r$2408=((($2540$2542=arr_parts$2404)),function(){if((($2540$2542 instanceof Array)&&((t0$2547=$2540$2542.length),((t0$2547===0)&&is_obj$2401)))){return util$899.construct(obj_parts$2405,function(x$2555,rest$2556){return ["send",["symbol","&:"],["data",x$2555,rest$2556]];},["object"]);}else{$2540$2542;if(is_obj$2401){throw $2867(["syntax","array","object"]).create("Cannot mix array and object notations.");}else{(other$2564=$2540$2542);return util$899.construct(arr_parts$2404.reverse(),function(x$2567,rest$2568){return ["send",["send",rest$2568,["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",x$2567]];},["array"]);}}}()));;return helper$1864(context$1868,scope$1869,it$0$1859.mkenv().convert(r$2408));}else{if(($1875$1888&&(($1877$1890=(t0$1884===3))&&($1873$1879[0]==="assign")))){(target$2573=$1873$1879[1]);(value$2574=$1873$1879[2]);return ["assign",helper$1864(["expr","expr"],scope$1869,target$2573),helper$1864(["expr","expr"],scope$1869,value$2574)];}else{if(($1877$1890&&($1873$1879[0]==="lambda"))){(bindings$2579=$1873$1879[1]);(body$2580=$1873$1879[2]);(newscope$2584=Scope$912(scope$1869));;return ["lambda",(((acc$2592=[])),(((temp$2597=bindings$2579)),((($length$2602=temp$2597.length)),((($index$2607=0)),function(){$2588:for(;($index$2607<$length$2602);($index$2607++)){var v$2633;var x$2643;var other$2650;var v$2640;var b$2626;var env$2627;var $2590$2623;var t0$2620;var t1$2621;var m$2615;(m$2615=temp$2597[$index$2607]);;(t0$2620=m$2615);if(((t0$2620 instanceof Array)&&((t1$2621=t0$2620.length),((t1$2621===2)&&((t0$2620[0]==="symbol")&&((b$2626=t0$2620[1]),$3055(t0$2620,"env"))))))){(env$2627=t0$2620.env);acc$2592.push((((v$2633=["variable",it$0$1859.gensym(b$2626)])),(env$2627.bind(newscope$2584,b$2626,v$2633),v$2633)));}else{if((((x$2643=t0$2620)),((x$2643 instanceof Array)&&(x$2643[0]==="variable")))){(v$2640=t0$2620);acc$2592.push(v$2640);}else{(other$2650=m$2615);acc$2592.push(function(){throw $2867(["syntax","lambda","binding"]).create("Not a valid binding.",({"node":other$2650}));}());}}}}()))),acc$2592),helper$1864(["expr","expr"],newscope$2584,body$2580)];}else{if(($1877$1890&&($1873$1879[0]==="use"))){($1874$2655=$1873$1879[1]);(x$2654=$1873$1879[2]);(t0$2659=$1874$2655);if((typeof(t0$2659)==="string")){(name$2663=t0$2659);(s$2667=scope$1869);;$2671:while(s$2667){if((s$2667.name.slice(0,(name$2663.length+1))===(name$2663+"/"))){break $2671;}else{(s$2667=s$2667.parent);}}if(s$2667){return helper$1864(context$1868,s$2667,x$2654);}else{throw $2867(["syntax","noscope"]).create(("Could not find a scope tagged: "+name$2663));}}else{(newscope$2676=$1874$2655);return helper$1864(context$1868,newscope$2676,x$2654);}}else{if(($1877$1890&&(($1873$1879[0]==="tagscope")&&((t1$1885=$1873$1879[1]),(typeof(t1$1885)==="string"))))){(tag$2680=t1$1885);(body$2681=$1873$1879[2]);return helper$1864(context$1868,Scope$912(scope$1869,it$0$1859.gensym((tag$2680+"/"))),body$2681);}else{if(($1875$1888&&((t0$1884>=1)&&((type$2687=$1873$1879[0]),((args$2688=Array.prototype.slice.call($1873$1879,1)),(it$0$1859.generic_nodes.indexOf(type$2687)!==-1)))))){return [type$2687].concat((((acc$2696=[])),(((temp$2701=args$2688)),((($length$2706=temp$2701.length)),((($index$2711=0)),function(){$2693:for(;($index$2711<$length$2706);($index$2711++)){var arg$2727;var m$2719;(m$2719=temp$2701[$index$2711]);;(arg$2727=m$2719);acc$2696.push(helper$1864(["expr","expr"],scope$1869,arg$2727));}}()))),acc$2696));}else{(other$2731=$1873$1879);throw $2867(["syntax","illegal_node"]).create("An illegal node was found.",({"node":other$2731,"context":context$1868}));}}}}}}}}}}}}}}}}}));;return helper$1864(context$1854,scope$1855,expr$1856);});$3043(Expander$915,$3043(((accum$2735=({})),((accum$2735["::name"]="Expander"),accum$2735)),((accum$2739=({})),((accum$2739["::egclass"]=true),accum$2739))));Expander$915;(mac1$916=function(f$2745){return ["macro",function(context$2749,scope$2750,form$2751,$2747$2752){var t0$2756;var t1$2757;var expr$2754;(t0$2756=$2747$2752);if(((t0$2756 instanceof Array)&&((t1$2757=t0$2756.length),((t1$2757===2)&&(t0$2756[0]==="data"))))){(expr$2754=t0$2756[1]);;}else{$2854($2747$2752);}return f$2745(expr$2754);}];});;(__chk_ncache$917=({}));;(__chk_scache$918=({}));;(checker_db$919=function($2771$2773){var v$2809;var v$2822;var s$2818;var n$2805;var $2775$2781;var ph$2776;(ph$2776=$2771$2773);;($2775$2781=ph$2776);;if(($2775$2781===null)){return checker_db$919.null;}else{if(($2775$2781===(void 0))){return checker_db$919.undefined;}else{if(($2775$2781===true)){return checker_db$919.true;}else{if(($2775$2781===false)){return checker_db$919.false;}else{if((typeof($2775$2781)==="number")){(n$2805=$2775$2781);if($859(__chk_ncache$917,n$2805)){return $859(__chk_ncache$917,n$2805);}else{(v$2809=mac1$916(function(x$2813){return ["send",["symbol","==="],["data",x$2813,["value",n$2805]]];}));;(__chk_ncache$917[n$2805]=v$2809);return v$2809;}}else{if((typeof($2775$2781)==="string")){(s$2818=$2775$2781);if(Object.prototype.hasOwnProperty.call(__chk_scache$918,s$2818)){return $859(__chk_scache$918,s$2818);}else{(v$2822=mac1$916(function(x$2826){return ["send",["symbol","==="],["data",x$2826,["value",s$2818]]];}));;(__chk_scache$918[s$2818]=v$2822);return v$2822;}}else{$2854($2775$2781);}}}}}}});;$3043(checker_db$919,({"String":mac1$916(function(x$2833){return ["send",["symbol","==="],["data",["send",["symbol","typeof"],["data",x$2833]],["value","string"]]];}),"Number":mac1$916(function(x$2836){return ["send",["symbol","==="],["data",["send",["symbol","typeof"],["data",x$2836]],["value","number"]]];}),"Array":mac1$916(function(x$2839){return ["send",["symbol","instanceof"],["data",x$2839,["symbol","Array"]]];}),"true":mac1$916(function(x$2842){return x$2842;}),"false":mac1$916(function(x$2845){return ["send",["symbol","not"],["data",["void"],x$2845]];}),"null":mac1$916(function(x$2848){return ["send",["symbol","==="],["data",x$2848,["value",null]]];}),"undefined":mac1$916(function(x$2851){return ["send",["symbol","==="],["data",x$2851,["value",(void 0)]]];})}));(exports["Env"]=Env$913);(exports["Scope"]=Scope$912);(exports["track_location"]=track_location$914);(exports["Expander"]=Expander$915);(exports["GenSym"]=GenSym$906);(exports["gensym"]=gensym$907);(exports["mac1"]=mac1$916);(exports["checker_db"]=checker_db$919);

},{"./location":7,"./pattern":10,"./pp":11,"./util":14}],6:[function(require,module,exports){
var $3242=function(type$3244){var f$3247;(f$3247=type$3244["::check"]);;if((f$3247===(void 0))){return function(value$3252){return (value$3252 instanceof type$3244);};}else{return function(value$3255){return f$3247.call(type$3244,value$3255);};}};
var $3257=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $3258=function($3259$3261){var ph$3265;(ph$3265=$3259$3261);;var $3263$3270;($3263$3270=ph$3265);;var bridge$3264$3275;var x$3279;(bridge$3264$3275=$3263$3270);if((((typeof(bridge$3264$3275)==="string")&&((x$3279=bridge$3264$3275),true))||((typeof(bridge$3264$3275)==="number")&&((x$3279=bridge$3264$3275),true)))){return ["value",x$3279];}else{var other$3286;(other$3286=$3263$3270);return other$3286["::serialize_ast"]();}};
var send$3126;(send$3126=function(obj$3131,$3129$3132){var ph$3136;var msg$3137;var t0$3139;(t0$3139=$3129$3132);(msg$3137=t0$3139);(ph$3136=t0$3139);;var $3134$3143;($3134$3143=ph$3136);;var bridge$3135$3148;(bridge$3135$3148=$3134$3143);if(((typeof(bridge$3135$3148)==="string")||(typeof(bridge$3135$3148)==="number"))){return obj$3131[msg$3137];}else{var other$3156;(other$3156=$3134$3143);return obj$3131["::send"](msg$3137);}});;(Array[":::project"]=function($3159$3161){var ph$3164;var value$3165;var t0$3167;(t0$3167=$3159$3161);(value$3165=t0$3167);(ph$3164=t0$3167);;var $3163$3171;($3163$3171=ph$3164);;if($3242(Array)($3163$3171)){return [true,value$3165];}else{$3163$3171;return [true,[value$3165]];}});(Array.prototype["::check"]=function(value$3185){if((value$3185 instanceof Array)){var i$3190;(i$3190=0);;$3188:for(;(i$3190<this.length);(i$3190++)){if(($3257(this,i$3190)!==$3257(value$3185,i$3190))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$3201){if((value$3201 instanceof Array)){var i$3206;(i$3206=0);;$3204:for(;(i$3206<this.length);(i$3206++)){if(($3257(this,i$3206)!==$3257(value$3201,i$3206))){return [true,[value$3201]];}}return [true,value$3201.slice(this.length)];}else{return [true,[value$3201]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($3258));});(RegExp.prototype["::check"]=function(value$3217){return value$3217.match(this);});(RegExp.prototype[":::project"]=function(value$3220){var $3222$3224;($3222$3224=value$3220.match(this));;var m$3232;if(($3222$3224===null)){(m$3232=$3222$3224);return [false,null];}else{var m$3237;(m$3237=$3222$3224);return [true,m$3237];}});(Function.prototype["::send"]=function(args$3240){return this.apply(this,args$3240);});
var $4122=function(arr$4124){var results$4128;var l$4129;(results$4128=[]);;(l$4129=arr$4124.length);;var i$4137;(i$4137=0);;$4127:for(;(i$4137<l$4129);(i$4137++)){results$4128.push([i$4137,$3257(arr$4124,i$4137)]);}return results$4128;};
var $4144=function(dest$4146,values$4147){var k$4152;(k$4152=null);$4150:for(k$4152 in values$4147){if(values$4147.hasOwnProperty(k$4152)){(dest$4146[k$4152]=values$4147[k$4152]);}}return dest$4146;};
var $3968=function(){var $3969$3971;($3969$3971=function(tags$3975){var it$0$3978;(it$0$3978=function(){if((!$3242($3969$3971)(this))){return Object.create($3969$3971.prototype);}else{return this;}}());;(it$0$3978["tags"]=tags$3975);return it$0$3978;});;($3969$3971.prototype["create"]=function(){var $3987$3989;($3987$3989=arguments);;var t0$3994;var message$3998;var args$3999;(t0$3994=$3987$3989.length);if((t0$3994>=0)){(message$3998=function(){if((0>=t0$3994)){return "";}else{return $3987$3989[0];}}());(args$3999=Array.prototype.slice.call($3987$3989,1));var it$0$4003;(it$0$4003=this);;var e$4008;(e$4008=Error(message$3998));;(e$4008["::tags"]=it$0$4003.tags);(e$4008["args"]=args$3999);var temp$4016;(temp$4016=$4122(args$3999));;var $length$4021;($length$4021=temp$4016.length);;var $index$4026;($index$4026=0);;$4009:for(;($index$4026<$length$4021);($index$4026++)){var m$4034;(m$4034=temp$4016[$index$4026]);;var t0$4039;var t1$4040;var i$4044;var arg$4045;(t0$4039=m$4034);if(((t0$4039 instanceof Array)&&((t1$4040=t0$4039.length),(t1$4040===2)))){(i$4044=t0$4039[0]);(arg$4045=t0$4039[1]);(e$4008[i$4044]=arg$4045);}else{$3955(m$4034);;}}(e$4008["length"]=args$3999.length);(e$4008["name"]=["E"].concat(it$0$4003.tags).join("."));return e$4008;}else{$3955($3987$3989);}});($3969$3971.prototype["::check"]=function(e$4056){var it$0$4059;(it$0$4059=this);;var tags$4064;if(((!e$4056)||(!$3242(Error)(e$4056)))){return false;}(tags$4064=(e$4056["::tags"]||[]));;var temp$4073;(temp$4073=it$0$4059.tags);;var $length$4078;($length$4078=temp$4073.length);;var $index$4083;($index$4083=0);;$4065:for(;($index$4083<$length$4078);($index$4083++)){var m$4091;(m$4091=temp$4073[$index$4083]);;var tag$4099;(tag$4099=m$4091);if((tags$4064.indexOf(tag$4099)===-1)){return false;}else{false;;}}return true;});($3969$3971.prototype["::deconstruct"]=function(e$4107){var it$0$4110;(it$0$4110=this);;return e$4107.args;});$4144($3969$3971,$4144(function(){var accum$4115;(accum$4115=({}));(accum$4115["::name"]="$3969");return accum$4115;}(),function(){var accum$4119;(accum$4119=({}));(accum$4119["::egclass"]=true);return accum$4119;}()));return $3969$3971;}();
var $3955=function(value$3957,url$3958,start$3959,end$3960){var err$3963;(err$3963=$3968(["match"]).create("Could not find a match for value",({"value":value$3957})));;if(url$3958){(err$3963["location"]=["location",url$3958,start$3959,end$3960]);}throw err$3963;};var id$3315;var id_f$3316;var numr$3317;var numr_f$3318;var num$3319;var num_f$3320;var str$3321;var str_f$3322;var op$3323;var op2$3324;var op3$3325;var op4$3326;var op_f$3327;var indent$3328;var indent_f$3329;var cmnt$3330;var cmnt_f$3331;var unkn$3332;var unkn_f$3333;var $3289$3290;var Location$3291;var __lt____lt____colon__$3292;var special_ops$3293;var regexps$3294;var ws_re$3295;var eol_re$3296;var indent_tracker$3297;var process_token$3298;var tokenize$3299;($3289$3290=require("./location"));;(Location$3291=$3289$3290.Location);;(__lt____lt____colon__$3292=$3289$3290["<<:"]);;(special_ops$3293=({"(":"PFX","[":"PFX","{":"PFX",")":"SFX","]":"SFX","}":"SFX",",":"IFX",":":"IFX",".":"PFX","'":"PFX"}));;(regexps$3294=(((id$3315=RegExp("(?:^[a-zA-Z$_](?:[a-zA-Z$_0-9]*))",""))),((id_f$3316=function(m$3340,wsb$3341,wsa$3342,last_op$3343){return ["ID","ID",m$3340[0]];})),((numr$3317=RegExp("(?:^((?:\\d+))[rR]((?:[A-Za-z0-9_]+))(?:(?:\\.((?:[A-Za-z0-9_]+)))?))",""))),((numr_f$3318=function(m$3352,wsb$3353,wsa$3354,last_op$3355){var t0$3363;var t1$3364;var radix$3358;var intp$3359;var frac$3360;var value$3361;(t0$3363=m$3352);if(((t0$3363 instanceof Array)&&((t1$3364=t0$3363.length),(t1$3364===4)))){t0$3363[0];(radix$3358=t0$3363[1]);(intp$3359=t0$3363[2]);(frac$3360=t0$3363[3]);;}else{$3955(m$3352,"/home/olivier/git/earl-grey/src/lex.eg",980,981);}(value$3361=parseInt(intp$3359.replace(RegExp("_","g"),""),radix$3358));;if(frac$3360){(frac$3360=frac$3360.replace(RegExp("_","g"),""));(value$3361=(value$3361+(parseInt(frac$3360,radix$3358)/Math.pow(radix$3358,frac$3360.length))));}return ["ID","NUM",value$3361];})),((num$3319=RegExp("(?:^((?:[0-9_]+))(?:(?:\\.((?:\\d+)))?)(?:(?:[eE]((?:[+-]?)(?:[0-9_]+)))?))",""))),((num_f$3320=function(m$3380,wsb$3381,wsa$3382,last_op$3383){return ["ID","NUM",parseFloat(m$3380[0].replace(RegExp("_","g"),""))];})),((str$3321=RegExp("(?:^\"((?:(?:(?:\\\\\\\\|\\\\\")|[^\"])*))\")",""))),((str_f$3322=function(m$3392,wsb$3393,wsa$3394,last_op$3395){var repl$3398;var r$3399;(repl$3398=({"\\\"":"\"","\\\\":"\\","\\n":"\n"}));;(r$3399=m$3392[1].replace(RegExp("((?:(?:\\\\\"|\\\\\\\\)|\\\\n))","g"),function(m$3406){return $3257(repl$3398,m$3406);}));;return ["ID","STR",r$3399];})),((op$3323=RegExp("(?:^(?:[+\\-*/~\\^<>=%&|?!@#.:']+))",""))),((op2$3324=RegExp("(?:^[\\[\\{\\}\\],])",""))),((op3$3325=RegExp("(?:^(?:(?:(?:(?:(?:(?:(?:(?:(?:(?:with|where)|when)|and)|not)|or)|in)|instanceof)|mod)|each)|as)(?:(?:[+\\-*/~\\^<>=%&|?!@#.:']+)|\\b))",""))),((op4$3326=RegExp("(?:^`((?:[A-Za-z0-9_]+))`)",""))),((op_f$3327=function(m$3425,wsb$3426,wsa$3427,last_op$3428,column$3429){var other$3484;var $3462$3464;var fixity$3455;var width$3456;var $3433$3445;var $3432$3439;var op$3434;(op$3434=(m$3425[1]||m$3425[0]));;($3432$3439=null);;$3432$3439;if((op$3434==="|")){return ["INDENT",(column$3429-1)];}else{if((op$3434 in special_ops$3293)){(fixity$3455=$3257(special_ops$3293,op$3434));;(width$3456=((($3462$3464=fixity$3455)),function(){if(($3462$3464==="IFX")){if((wsb$3426||wsa$3427)){return "wide";}else{return "short";}}else{if(($3462$3464==="SFX")){if(wsb$3426){return "wide";}else{return "short";}}else{if(($3462$3464==="PFX")){if(wsa$3427){return "wide";}else{return "short";}}else{(other$3484=$3462$3464);throw $3968(["syntax","should_never_happen"]).create("unknown fixity");}}}}()));;return ["OP",fixity$3455,width$3456,op$3434];}else{if((wsa$3427&&wsb$3426)){return ["OP",function(){if(last_op$3428){return "PFX";}else{return "IFX";}}(),"wide",op$3434];}else{if(((!wsa$3427)&&(!wsb$3426))){return ["OP",function(){if(last_op$3428){return "PFX";}else{return "IFX";}}(),"short",op$3434];}else{if((wsa$3427&&last_op$3428)){return ["OP","PFX","wide",op$3434];}else{if(wsa$3427){return ["OP","SFX","short",op$3434];}else{if(wsb$3426){return ["OP","PFX","short",op$3434];}else{return ["OP","PFX","short",op$3434];}}}}}}}})),((indent$3328=RegExp("(?:^(?:(?:\n((?: *)))+))",""))),((indent_f$3329=function(m$3517,wsb$3518,wsa$3519,last_op$3520){var ilen$3523;(ilen$3523=m$3517[1].length);;return ["INDENT",ilen$3523];})),((cmnt$3330=RegExp("(?:^;(?:[^\n]*))",""))),((cmnt_f$3331=function(m$3534,wsb$3535,wsa$3536,last_op$3537){return ["IGNORE"];})),((unkn$3332=RegExp("(?:^.)",""))),((unkn_f$3333=function(m$3546,wsb$3547,wsa$3548,last_op$3549){return ["ILLEGAL",m$3546[0]];})),[[op3$3325,op_f$3327],[id$3315,id_f$3316],[numr$3317,numr_f$3318],[num$3319,num_f$3320],[str$3321,str_f$3322],[op$3323,op_f$3327],[op2$3324,op_f$3327],[op4$3326,op_f$3327],[indent$3328,indent_f$3329],[cmnt$3330,cmnt_f$3331],[unkn$3332,unkn_f$3333]]));;(ws_re$3295=RegExp("(?:^(?: *)(?:(?:\n(?: *)\\\\(?: *))*))",""));;(eol_re$3296=RegExp("(?:^(?: *)(?:\n|$))",""));;(indent_tracker$3297=function(){var curr$3565;var stack$3566;var stacks$3567;(curr$3565=false);;(stack$3566=[]);;(stacks$3567=[stack$3566]);;return function($3564$3578){var t0$3591;var rval$3637;var $index$3693;var $length$3688;var temp$3683;var acc$3678;var rval$3672;var other$3713;var fixity$3664;var width$3665;var fixity$3654;var width$3655;var stuff$3649;var new_indent$3611;var $3581$3612;var $3584$3605;var $3585$3606;var $3586$3607;var $3587$3608;var t0$3600;var t1$3601;var bridge$3582$3602;var bridge$3583$3603;var $3580$3595;var ph$3588;var token$3589;(t0$3591=$3564$3578);(token$3589=t0$3591);(ph$3588=t0$3591);;($3580$3595=ph$3588);;if((($3584$3605=($3580$3595 instanceof Array))&&((t0$3600=$3580$3595.length),((t0$3600===2)&&($3580$3595[0]==="INDENT"))))){(t1$3601=$3580$3595[1]);(new_indent$3611=t1$3601);($3581$3612=t1$3601);$3581$3612;if((curr$3565===false)){(curr$3565=new_indent$3611);return [["OP","IFX","wide",","]];}else{if(($3581$3612>curr$3565)){$3257(stack$3566.push(curr$3565),(curr$3565=new_indent$3611));return [["OP","PFX","wide","["]];}else{if(($3581$3612===curr$3565)){return [["OP","IFX","wide",","]];}else{if(($3581$3612<curr$3565)){(rval$3637=[]);;$3641:while(((stack$3566.length>0)&&(new_indent$3611<curr$3565))){(curr$3565=stack$3566.pop());rval$3637.push(["OP","SFX","wide","]"]);}rval$3637.push(["OP","IFX","wide",","]);return rval$3637;}else{$3955($3581$3612,"/home/olivier/git/earl-grey/src/lex.eg",4969,4985);}}}}}else{if(($3584$3605&&((t0$3600>=1)&&($3580$3595[0]==="ID")))){(stuff$3649=Array.prototype.slice.call($3580$3595,1));return [token$3589];}else{if(($3584$3605&&(($3586$3607=(t0$3600===4))&&(($3587$3608=($3580$3595[0]==="OP"))&&((fixity$3654=$3580$3595[1]),((width$3655=$3580$3595[2]),((bridge$3582$3602=$3580$3595[3]),((bridge$3582$3602==="[")||(bridge$3582$3602==="{"))))))))){stack$3566.push(curr$3565);stacks$3567.push(stack$3566);(stack$3566=[]);(curr$3565=false);return [token$3589];}else{if(($3587$3608&&((fixity$3664=$3580$3595[1]),((width$3665=$3580$3595[2]),((bridge$3583$3603=$3580$3595[3]),((bridge$3583$3603==="]")||(bridge$3583$3603==="}"))))))){(rval$3672=(((acc$3678=[])),(((temp$3683=stack$3566)),((($length$3688=temp$3683.length)),((($index$3693=0)),function(){$3675:for(;($index$3693<$length$3688);($index$3693++)){var m$3701;(m$3701=temp$3683[$index$3693]);;m$3701;acc$3678.push(["OP","SFX","short","]"]);}}()))),acc$3678));;(stack$3566=stacks$3567.pop());(curr$3565=stack$3566.pop());rval$3672.push(token$3589);return rval$3672;}else{(other$3713=$3580$3595);return [token$3589];}}}}};});;(process_token$3298=function(src$3719,token$3720,last_op$3721,wsa$3722,wsb$3723,pos$3724,endpos$3725,accum$3726){var t0$3733;var t1$3734;var w$3756;var v$3767;var w$3789;var v$3790;var v$3802;var $3765$3772;var other$3814;var $3729$3740;var type$3730;var result$3731;(t0$3733=token$3720);if(((t0$3733 instanceof Array)&&((t1$3734=t0$3733.length),(t1$3734>=1)))){(type$3730=t0$3733[0]);(result$3731=Array.prototype.slice.call(t0$3733,1));;}else{$3955(token$3720,"/home/olivier/git/earl-grey/src/lex.eg",6493,6498);}__lt____lt____colon__$3292(result$3731,token$3720);($3729$3740=type$3730);;if(($3729$3740==="IGNORE")){return last_op$3721;}else{if(($3729$3740==="ID")){if((!last_op$3721)){(w$3756=["IFX",function(){if(wsb$3723){return "wide";}else{return "short";}}(),"WHITE"]);;(w$3756["location"]=Location$3291(src$3719,pos$3724,pos$3724));accum$3726.push(w$3756);}accum$3726.push(result$3731);return false;}else{if(($3729$3740==="OP")){if(last_op$3721){(v$3767=["VOID"]);;(v$3767["location"]=Location$3291(src$3719,pos$3724,pos$3724));accum$3726.push(v$3767);}($3765$3772=result$3731[0]);;if(($3765$3772==="IFX")){accum$3726.push(result$3731);return true;}else{if(($3765$3772==="PFX")){if((!last_op$3721)){(w$3789=["IFX",function(){if(wsb$3723){return "wide";}else{return "short";}}(),"WHITE"]);;(w$3789["location"]=Location$3291(src$3719,pos$3724,pos$3724));(v$3790=["VOID"]);;(v$3790["location"]=Location$3291(src$3719,pos$3724,pos$3724));accum$3726.push(w$3789);accum$3726.push(v$3790);}accum$3726.push(result$3731);return true;}else{if(($3765$3772==="SFX")){accum$3726.push(result$3731);(v$3802=["VOID"]);;(v$3802["location"]=Location$3291(src$3719,endpos$3725,endpos$3725));accum$3726.push(v$3802);return false;}else{$3955($3765$3772);}}}}else{if(($3729$3740==="ILLEGAL")){throw $3968(["syntax","illegal"]).create("unknown character",({"chr":token$3720}));}else{(other$3814=$3729$3740);throw $3968(["should_never_happen"]).create("unknown token type",({"token":token$3720}));}}}}});;(tokenize$3299=function(src$3820){var v$3949;var text$3823;var last_op$3824;var results$3825;var wsb$3826;var pos$3827;var column$3828;var indent$3829;(text$3823=src$3820.text);;(last_op$3824=true);;(results$3825=[]);;(wsb$3826=text$3823.match(ws_re$3295)[0].length);;(text$3823=text$3823.slice(wsb$3826));(pos$3827=wsb$3826);;(column$3828=0);;(indent$3829=indent_tracker$3297());;$3851:while(text$3823){var i$3856;(i$3856=0);;$3854:for(;(i$3856<regexps$3294.length);(++i$3856)){var t0$3868;var t1$3869;var splits$3895;var $index$3929;var $length$3924;var temp$3919;var skip$3878;var endpos$3879;var wsa$3880;var eol$3881;var bwsb$3882;var bwsa$3883;var token$3884;var tokens$3885;var re$3864;var fn$3865;var m$3866;(t0$3868=$3257(regexps$3294,i$3856));if(((t0$3868 instanceof Array)&&((t1$3869=t0$3868.length),(t1$3869===2)))){(re$3864=t0$3868[0]);(fn$3865=t0$3868[1]);;}else{$3955($3257(regexps$3294,i$3856),"/home/olivier/git/earl-grey/src/lex.eg",8067,8077);}(m$3866=text$3823.match(re$3864));;if(m$3866){(skip$3878=m$3866[0].length);;(endpos$3879=(pos$3827+skip$3878));;(column$3828=(((splits$3895=m$3866[0].split("\n"))),function(){if((splits$3895.length>1)){return $3257(splits$3895,(splits$3895.length-1)).length;}else{return (column$3828+skip$3878);}}()));(text$3823=text$3823.slice(skip$3878));(wsa$3880=text$3823.match(ws_re$3295)[0].length);;(eol$3881=(text$3823.match(eol_re$3296)&&true));;(bwsb$3882=(wsb$3826>0));;(bwsa$3883=function(){if(eol$3881){return bwsb$3882;}else{return (wsa$3880>0);}}());;(token$3884=fn$3865(m$3866,bwsb$3882,bwsa$3883,last_op$3824,column$3828));;(tokens$3885=indent$3829(token$3884));;(temp$3919=tokens$3885);;($length$3924=temp$3919.length);;($index$3929=0);;$3886:for(;($index$3929<$length$3924);($index$3929++)){var x$3945;var m$3937;(m$3937=temp$3919[$index$3929]);;(x$3945=m$3937);(x$3945["location"]=Location$3291(src$3820,pos$3827,endpos$3879));(last_op$3824=process_token$3298(src$3820,x$3945,last_op$3824,bwsa$3883,bwsb$3882,pos$3827,endpos$3879,results$3825));}(text$3823=text$3823.slice(wsa$3880));(column$3828=(column$3828+wsa$3880));(wsb$3826=wsa$3880);(pos$3827=(endpos$3879+wsa$3880));break $3854;}}}if(last_op$3824){(v$3949=["VOID"]);;(v$3949["location"]=[pos$3827,pos$3827]);results$3825.push(v$3949);}return results$3825;});;(exports["tokenize"]=tokenize$3299);

},{"./location":7}],7:[function(require,module,exports){
var $4273=function(type$4275){var f$4278;(f$4278=type$4275["::check"]);;if((f$4278===(void 0))){return function(value$4283){return (value$4283 instanceof type$4275);};}else{return function(value$4286){return f$4278.call(type$4275,value$4286);};}};
var $4288=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $4289=function($4290$4292){var ph$4296;(ph$4296=$4290$4292);;var $4294$4301;($4294$4301=ph$4296);;var bridge$4295$4306;var x$4310;(bridge$4295$4306=$4294$4301);if((((typeof(bridge$4295$4306)==="string")&&((x$4310=bridge$4295$4306),true))||((typeof(bridge$4295$4306)==="number")&&((x$4310=bridge$4295$4306),true)))){return ["value",x$4310];}else{var other$4317;(other$4317=$4294$4301);return other$4317["::serialize_ast"]();}};
var send$4157;(send$4157=function(obj$4162,$4160$4163){var ph$4167;var msg$4168;var t0$4170;(t0$4170=$4160$4163);(msg$4168=t0$4170);(ph$4167=t0$4170);;var $4165$4174;($4165$4174=ph$4167);;var bridge$4166$4179;(bridge$4166$4179=$4165$4174);if(((typeof(bridge$4166$4179)==="string")||(typeof(bridge$4166$4179)==="number"))){return obj$4162[msg$4168];}else{var other$4187;(other$4187=$4165$4174);return obj$4162["::send"](msg$4168);}});;(Array[":::project"]=function($4190$4192){var ph$4195;var value$4196;var t0$4198;(t0$4198=$4190$4192);(value$4196=t0$4198);(ph$4195=t0$4198);;var $4194$4202;($4194$4202=ph$4195);;if($4273(Array)($4194$4202)){return [true,value$4196];}else{$4194$4202;return [true,[value$4196]];}});(Array.prototype["::check"]=function(value$4216){if((value$4216 instanceof Array)){var i$4221;(i$4221=0);;$4219:for(;(i$4221<this.length);(i$4221++)){if(($4288(this,i$4221)!==$4288(value$4216,i$4221))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$4232){if((value$4232 instanceof Array)){var i$4237;(i$4237=0);;$4235:for(;(i$4237<this.length);(i$4237++)){if(($4288(this,i$4237)!==$4288(value$4232,i$4237))){return [true,[value$4232]];}}return [true,value$4232.slice(this.length)];}else{return [true,[value$4232]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($4289));});(RegExp.prototype["::check"]=function(value$4248){return value$4248.match(this);});(RegExp.prototype[":::project"]=function(value$4251){var $4253$4255;($4253$4255=value$4251.match(this));;var m$4263;if(($4253$4255===null)){(m$4263=$4253$4255);return [false,null];}else{var m$4268;(m$4268=$4253$4255);return [true,m$4268];}});(Function.prototype["::send"]=function(args$4271){return this.apply(this,args$4271);});
var $5990=function(arr$5992){var results$5996;var l$5997;(results$5996=[]);;(l$5997=arr$5992.length);;var i$6005;(i$6005=0);;$5995:for(;(i$6005<l$5997);(i$6005++)){results$5996.push([i$6005,$4288(arr$5992,i$6005)]);}return results$5996;};
var $6012=function(dest$6014,values$6015){var k$6020;(k$6020=null);$6018:for(k$6020 in values$6015){if(values$6015.hasOwnProperty(k$6020)){(dest$6014[k$6020]=values$6015[k$6020]);}}return dest$6014;};
var $5836=function(){var $5837$5839;($5837$5839=function(tags$5843){var it$0$5846;(it$0$5846=function(){if((!$4273($5837$5839)(this))){return Object.create($5837$5839.prototype);}else{return this;}}());;(it$0$5846["tags"]=tags$5843);return it$0$5846;});;($5837$5839.prototype["create"]=function(){var $5855$5857;($5855$5857=arguments);;var t0$5862;var message$5866;var args$5867;(t0$5862=$5855$5857.length);if((t0$5862>=0)){(message$5866=function(){if((0>=t0$5862)){return "";}else{return $5855$5857[0];}}());(args$5867=Array.prototype.slice.call($5855$5857,1));var it$0$5871;(it$0$5871=this);;var e$5876;(e$5876=Error(message$5866));;(e$5876["::tags"]=it$0$5871.tags);(e$5876["args"]=args$5867);var temp$5884;(temp$5884=$5990(args$5867));;var $length$5889;($length$5889=temp$5884.length);;var $index$5894;($index$5894=0);;$5877:for(;($index$5894<$length$5889);($index$5894++)){var m$5902;(m$5902=temp$5884[$index$5894]);;var t0$5907;var t1$5908;var i$5912;var arg$5913;(t0$5907=m$5902);if(((t0$5907 instanceof Array)&&((t1$5908=t0$5907.length),(t1$5908===2)))){(i$5912=t0$5907[0]);(arg$5913=t0$5907[1]);(e$5876[i$5912]=arg$5913);}else{$5823(m$5902);;}}(e$5876["length"]=args$5867.length);(e$5876["name"]=["E"].concat(it$0$5871.tags).join("."));return e$5876;}else{$5823($5855$5857);}});($5837$5839.prototype["::check"]=function(e$5924){var it$0$5927;(it$0$5927=this);;var tags$5932;if(((!e$5924)||(!$4273(Error)(e$5924)))){return false;}(tags$5932=(e$5924["::tags"]||[]));;var temp$5941;(temp$5941=it$0$5927.tags);;var $length$5946;($length$5946=temp$5941.length);;var $index$5951;($index$5951=0);;$5933:for(;($index$5951<$length$5946);($index$5951++)){var m$5959;(m$5959=temp$5941[$index$5951]);;var tag$5967;(tag$5967=m$5959);if((tags$5932.indexOf(tag$5967)===-1)){return false;}else{false;;}}return true;});($5837$5839.prototype["::deconstruct"]=function(e$5975){var it$0$5978;(it$0$5978=this);;return e$5975.args;});$6012($5837$5839,$6012(function(){var accum$5983;(accum$5983=({}));(accum$5983["::name"]="$5837");return accum$5983;}(),function(){var accum$5987;(accum$5987=({}));(accum$5987["::egclass"]=true);return accum$5987;}()));return $5837$5839;}();
var $5823=function(value$5825,url$5826,start$5827,end$5828){var err$5831;(err$5831=$5836(["match"]).create("Could not find a match for value",({"value":value$5825})));;if(url$5826){(err$5831["location"]=["location",url$5826,start$5827,end$5828]);}throw err$5831;};
var $6146=function(type$6148){return function(value$6151){var f$6154;(f$6154=type$6148[":::project"]);;if((f$6154===(void 0))){var f$6159;(f$6159=type$6148["::project"]);;if((f$6159===(void 0))){return [true,type$6148(value$6151)];}else{var rval$6164;(rval$6164=false);;try{(rval$6164=[true,f$6159(value$6151)]);}catch(excv$6170){var e$6176;(e$6176=excv$6170);(rval$6164=[false,null]);}return rval$6164;}}else{return f$6154.call(type$6148,value$6151);}};};
var $6024=function(){var $6025$6027;($6025$6027=function($6030$6033,$6031$6034){var classes$6036;var children$6037;var t0$6039;(t0$6039=$6146(Array)($6030$6033));if(t0$6039[0]){(classes$6036=t0$6039[1]);;}else{$5823($6030$6033);}var t0$6044;(t0$6044=$6146(Array)($6031$6034));if(t0$6044[0]){(children$6037=t0$6044[1]);;}else{$5823($6031$6034);}var it$0$6049;(it$0$6049=function(){if((!$4273($6025$6027)(this))){return Object.create($6025$6027.prototype);}else{return this;}}());;(it$0$6049["classes"]=classes$6036.sort());(it$0$6049["children"]=children$6037);return it$0$6049;});;$6012(function(){var accum$6057;(accum$6057=({}));(accum$6057["::check"]=function(x$6061){return ((x$6061&&x$6061.classes)&&x$6061.children);});return accum$6057;}(),$6012(function(){var accum$6064;(accum$6064=({}));(accum$6064["::deconstruct"]=function(x$6068){return [x$6068.classes,x$6068.children];});return accum$6064;}(),$6012(function(){var accum$6071;(accum$6071=({}));(accum$6071["::name"]="$6025");return accum$6071;}(),function(){var accum$6075;(accum$6075=({}));(accum$6075["::egclass"]=true);return accum$6075;}())));($6025$6027.prototype["::check"]=function(n$6081){var it$0$6084;(it$0$6084=this);;var temp$6093;(temp$6093=it$0$6084.classes);;var $length$6098;($length$6098=temp$6093.length);;var $index$6103;($index$6103=0);;$6089:for(;($index$6103<$length$6098);($index$6103++)){var m$6111;(m$6111=temp$6093[$index$6103]);;var c$6119;(c$6119=m$6111);if((n$6081.classes.indexOf(c$6119)===-1)){return false;}else{false;;}}return true;});$6012($6025$6027,$6012(function(){var accum$6125;(accum$6125=({}));(accum$6125["::check"]=function(x$6129){return ((x$6129&&x$6129.classes)&&x$6129.children);});return accum$6125;}(),$6012(function(){var accum$6132;(accum$6132=({}));(accum$6132["::deconstruct"]=function(x$6136){return [x$6136.classes,x$6136.children];});return accum$6132;}(),$6012(function(){var accum$6139;(accum$6139=({}));(accum$6139["::name"]="$6025");return accum$6139;}(),function(){var accum$6143;(accum$6143=({}));(accum$6143["::egclass"]=true);return accum$6143;}()))));return $6025$6027;}();
var $6178=function(from$6180,to$6181){var rval$6185;(rval$6185=[]);;var i$6190;(i$6190=from$6180);;$6184:for(;(i$6190<=to$6181);(i$6190++)){rval$6185.push(i$6190);}return rval$6185;};
var $6197=function($6198$6200,key$6201){var ph$6205;(ph$6205=$6198$6200);;var $6203$6210;($6203$6210=ph$6205);;var bridge$6204$6215;(bridge$6204$6215=$6203$6210);if(((bridge$6204$6215===null)||(bridge$6204$6215===(void 0)))){return false;}else{var x$6223;if((typeof($6203$6210)==="string")){(x$6223=$6203$6210);return (key$6201 in String.prototype);}else{var x$6228;if((typeof($6203$6210)==="number")){(x$6228=$6203$6210);return (key$6201 in Number.prototype);}else{var x$6233;(x$6233=$6203$6210);return (key$6201 in x$6233);}}}};var accum$4464;var accum$4468;var accum$4669;var accum$4673;var $4320$4322;var binsearch$4323;var items$4324;var enumerate$4325;var $4321$4326;var __lt____gt__$4327;var repr$4328;var fs$4329;var Source$4330;var Location$4331;var highlight$4332;var highlight_lines$4333;var clamp$4334;var morsel$4335;var highlight_locations$4336;var highlight_locations_same_source$4337;var merge_locations$4338;var __lt____lt____colon__$4339;var __plus____plus____colon__$4340;var format_error$4341;var display_error$4342;($4320$4322=require("./util"));;(binsearch$4323=$4320$4322.binsearch);;(items$4324=$4320$4322.items);;(enumerate$4325=$4320$4322.enumerate);;($4321$4326=require("./pp"));;(__lt____gt__$4327=$4321$4326["<>"]);;(repr$4328=$4321$4326.repr);;(fs$4329=require("fs"));;(Source$4330=function(){var $index$4410;var $length$4405;var temp$4400;var curr$4392;var it$0$4386;var text$4381;var url$4382;var t0$4377;var $4370$4372;($4370$4372=arguments);;(t0$4377=$4370$4372.length);if(((t0$4377>=1)&&(t0$4377<=2))){(text$4381=$4370$4372[0]);(url$4382=function(){if((1>=t0$4377)){return false;}else{return $4370$4372[1];}}());(it$0$4386=function(){if((!$4273(Source$4330)(this))){return Object.create(Source$4330.prototype);}else{return this;}}());;(it$0$4386["text"]=text$4381);(it$0$4386["url"]=url$4382);(it$0$4386["counts"]=[]);(curr$4392=0);;(temp$4400=text$4381.split("\n"));;($length$4405=temp$4400.length);;($index$4410=0);;$4393:for(;($index$4410<$length$4405);($index$4410++)){var line$4426;var m$4418;(m$4418=temp$4400[$index$4410]);;(line$4426=m$4418);it$0$4386.counts.push(curr$4392);(curr$4392=(curr$4392+(line$4426.length+1)));}it$0$4386.counts.push(curr$4392);(it$0$4386["nlines"]=(it$0$4386.counts.length-1));return it$0$4386;}else{$5823($4370$4372);}});;(Source$4330.prototype["linecol"]=function(pos$4435){var line$4443;var col$4444;var it$0$4438;(it$0$4438=this);;(line$4443=binsearch$4323(it$0$4438.counts,pos$4435));;(col$4444=(pos$4435-$4288(it$0$4438.counts,(line$4443-1))));;return [line$4443,col$4444];});(Source$4330.prototype["highlight_lines"]=function(l1$4454,l2$4455,spans$4456){var it$0$4459;(it$0$4459=this);;return highlight_lines$4333(it$0$4459.text,it$0$4459.counts,[(l1$4454-1),(l2$4455-1)],spans$4456);});$6012(Source$4330,$6012(((accum$4464=({})),((accum$4464["::name"]="Source"),accum$4464)),((accum$4468=({})),((accum$4468["::egclass"]=true),accum$4468))));Source$4330;(Location$4331=function(source$4474,start$4475,end$4476){var it$0$4479;(it$0$4479=function(){if((!$4273(Location$4331)(this))){return Object.create(Location$4331.prototype);}else{return this;}}());;(it$0$4479["source"]=(source$4474||Source$4330("",null)));(it$0$4479["start"]=start$4475);(it$0$4479["end"]=end$4476);return it$0$4479;});;(Location$4331.prototype["text"]=function(){var it$0$4491;(it$0$4491=this);;return it$0$4491.source.text.slice(it$0$4491.start,it$0$4491.end);});(Location$4331.prototype["linerange"]=function(){var l2$4535;var t0$4526;var t1$4527;var l1$4518;var $4501$4519;var t0$4512;var t1$4513;var t2$4514;var $4500$4507;var it$0$4502;(it$0$4502=this);;($4500$4507=it$0$4502.linecol());;if((($4500$4507 instanceof Array)&&((t0$4512=$4500$4507.length),((t0$4512===2)&&((t1$4513=$4500$4507[0]),((t1$4513 instanceof Array)&&((t2$4514=t1$4513.length),(t2$4514===2)))))))){(l1$4518=t1$4513[0]);t1$4513[1];($4501$4519=$4500$4507[1]);if(($4501$4519===null)){return [l1$4518,l1$4518];}else{(t0$4526=$4501$4519);if(((t0$4526 instanceof Array)&&((t1$4527=t0$4526.length),(t1$4527===2)))){(l2$4535=t0$4526[0]);t0$4526[1];return [l1$4518,l2$4535];}else{$5823($4501$4519,"/home/olivier/git/earl-grey/src/location.eg",972,977);}}}else{$5823($4500$4507);}});(Location$4331.prototype["linecol"]=function(){var start$4553;var end$4554;var it$0$4548;(it$0$4548=this);;(start$4553=it$0$4548.source.linecol(it$0$4548.start));;(end$4554=function(){if((it$0$4548.start===it$0$4548.end)){return null;}else{return it$0$4548.source.linecol((it$0$4548.end-1));}}());;return [start$4553,end$4554];});(Location$4331.prototype["ref"]=function(){var otherwise$4637;var $4618$4626;var $4617$4620;var l2$4609;var c2$4610;var t0$4598;var t1$4599;var t2$4600;var t3$4601;var l1$4586;var c1$4587;var $4567$4588;var t0$4578;var t1$4579;var t2$4580;var t3$4581;var t4$4582;var $4566$4573;var it$0$4568;(it$0$4568=this);;($4566$4573=it$0$4568.linecol());;if((($4566$4573 instanceof Array)&&((t0$4578=$4566$4573.length),((t0$4578===2)&&((t1$4579=$4566$4573[0]),((t1$4579 instanceof Array)&&((t2$4580=t1$4579.length),((t2$4580===2)&&((t3$4581=[true,String(t1$4579[0])]),(t3$4581[0]&&((l1$4586=t3$4581[1]),((t4$4582=[true,String(t1$4579[1])]),t4$4582[0])))))))))))){(c1$4587=t4$4582[1]);($4567$4588=$4566$4573[1]);if(($4567$4588===null)){return ((l1$4586+":")+c1$4587);}else{(t0$4598=$4567$4588);if(((t0$4598 instanceof Array)&&((t1$4599=t0$4598.length),((t1$4599===2)&&((t2$4600=[true,String(t0$4598[0])]),(t2$4600[0]&&((l2$4609=t2$4600[1]),((t3$4601=[true,String(t0$4598[1])]),t3$4601[0])))))))){(c2$4610=t3$4601[1]);($4617$4620=null);;$4617$4620;if(((l1$4586===l2$4609)&&(c1$4587===c2$4610))){return ((l1$4586+":")+c1$4587);}else{if((l1$4586===l2$4609)){return ((((l1$4586+":")+c1$4587)+"-")+c2$4610);}else{(otherwise$4637=$4617$4620);return ((((((l1$4586+":")+c1$4587)+"-")+l1$4586)+":")+c2$4610);}}}else{$5823($4567$4588,"/home/olivier/git/earl-grey/src/location.eg",1314,1319);}}}else{$5823($4566$4573);}});(Location$4331.prototype["highlight"]=function(){var it$0$4662;var cls$4657;var context$4658;var t0$4653;var $4646$4648;($4646$4648=arguments);;(t0$4653=$4646$4648.length);if(((t0$4653>=0)&&(t0$4653<=2))){(cls$4657=function(){if((0>=t0$4653)){return "hl1";}else{return $4646$4648[0];}}());(context$4658=function(){if((1>=t0$4653)){return 0;}else{return $4646$4648[1];}}());(it$0$4662=this);;return highlight_locations$4336([[it$0$4662,cls$4657]],context$4658);}else{$5823($4646$4648);}});$6012(Location$4331,$6012(((accum$4669=({})),((accum$4669["::name"]="Location"),accum$4669)),((accum$4673=({})),((accum$4673["::egclass"]=true),accum$4673))));Location$4331;(highlight$4332=function(){var $index$4713;var $length$4708;var temp$4703;var acc$4698;var text$4690;var spans$4691;var offset$4692;var t0$4686;var $4679$4681;($4679$4681=arguments);;(t0$4686=$4679$4681.length);if(((t0$4686>=2)&&(t0$4686<=3))){(text$4690=$4679$4681[0]);(spans$4691=$4679$4681[1]);(offset$4692=function(){if((2>=t0$4686)){return 0;}else{return $4679$4681[2];}}());return $6024([],(((acc$4698=[])),(((temp$4703=morsel$4335(spans$4691))),((($length$4708=temp$4703.length)),((($index$4713=0)),function(){$4695:for(;($index$4713<$length$4708);($index$4713++)){var xstart$4738;var xend$4739;var start$4731;var end$4732;var attributes$4733;var t0$4726;var t1$4727;var m$4721;(m$4721=temp$4703[$index$4713]);;(t0$4726=m$4721);if(((t0$4726 instanceof Array)&&((t1$4727=t0$4726.length),(t1$4727===3)))){(start$4731=t0$4726[0]);(end$4732=t0$4726[1]);(attributes$4733=t0$4726[2]);acc$4698.push((((xstart$4738=Math.max((start$4731-offset$4692),0))),((xend$4739=Math.min((end$4732-offset$4692),text$4690.length))),$6024(attributes$4733.slice(0,1),[text$4690.slice(xstart$4738,xend$4739)])));}else{$5823(m$4721,"/home/olivier/git/earl-grey/src/location.eg",1862,2073);;}}}()))),acc$4698));}else{$5823($4679$4681);}});;(highlight_lines$4333=function(text$4755,linelocs$4756,$4753$4757,spans$4758){var t0$4763;var t1$4764;var $index$4787;var $length$4782;var temp$4777;var acc$4772;var l1$4760;var l2$4761;(t0$4763=$4753$4757);if(((t0$4763 instanceof Array)&&((t1$4764=t0$4763.length),(t1$4764===2)))){(l1$4760=t0$4763[0]);(l2$4761=t0$4763[1]);;}else{$5823($4753$4757);}return $6024(["+span"],(((acc$4772=[])),(((temp$4777=$6178(l1$4760,l2$4761))),((($length$4782=temp$4777.length)),((($index$4787=0)),function(){$4769:for(;($index$4787<$length$4782);($index$4787++)){var start$4806;var end$4807;var lineno$4803;var m$4795;(m$4795=temp$4777[$index$4787]);;(lineno$4803=m$4795);acc$4772.push((((start$4806=$4288(linelocs$4756,lineno$4803))),((end$4807=$4288(linelocs$4756,(lineno$4803+1)))),$6024(["+span"],[$6024(["lineno"],(lineno$4803+1)),$6024(["source"],highlight$4332(text$4755,[[start$4806,end$4807,[]]].concat(clamp$4334(spans$4758,start$4806,end$4807))))])));}}()))),acc$4772));});;(clamp$4334=function(spans$4818,bot$4819,top$4820){var $index$4840;var $length$4835;var temp$4830;var acc$4825;(acc$4825=[]);;(temp$4830=spans$4818);;($length$4835=temp$4830.length);;($index$4840=0);;$4822:for(;($index$4840<$length$4835);($index$4840++)){var start$4858;var end$4859;var attr$4860;var t0$4853;var t1$4854;var m$4848;(m$4848=temp$4830[$index$4840]);;(t0$4853=m$4848);if(((t0$4853 instanceof Array)&&((t1$4854=t0$4853.length),((t1$4854===3)&&((start$4858=t0$4853[0]),((end$4859=t0$4853[1]),((attr$4860=t0$4853[2]),((end$4859>=bot$4819)&&(start$4858<=top$4820))))))))){acc$4825.push([Math.max(start$4858,bot$4819),Math.min(end$4859,top$4820),attr$4860]);}else{false;;}}return acc$4825;});;(morsel$4335=function(spans$4873){var jump$4876;var jumptill$4877;var process$4878;var thespans$4879;(jump$4876=function(active$4883,bot$4884,top$4885){var $index$4913;var $length$4908;var temp$4903;var acc$4898;var $index$4953;var $length$4948;var temp$4943;var e$4888;var attributes$4889;(e$4888=$4288(Math.min,[top$4885].concat((((acc$4898=[])),(((temp$4903=active$4883)),((($length$4908=temp$4903.length)),((($index$4913=0)),function(){$4895:for(;($index$4913<$length$4908);($index$4913++)){var x$4931;var t0$4926;var t1$4927;var m$4921;(m$4921=temp$4903[$index$4913]);;(t0$4926=m$4921);if(((t0$4926 instanceof Array)&&((t1$4927=t0$4926.length),(t1$4927===3)))){t0$4926[0];(x$4931=t0$4926[1]);t0$4926[2];acc$4898.push(x$4931);}else{$5823(m$4921,"/home/olivier/git/earl-grey/src/location.eg",3395,3438);;}}}()))),acc$4898))));;(attributes$4889=[]);;(temp$4943=active$4883);;($length$4948=temp$4943.length);;($index$4953=0);;$4890:for(;($index$4953<$length$4948);($index$4953++)){var X$4971;var t0$4966;var t1$4967;var m$4961;(m$4961=temp$4943[$index$4953]);;(t0$4966=m$4961);if(((t0$4966 instanceof Array)&&((t1$4967=t0$4966.length),(t1$4967===3)))){t0$4966[0];t0$4966[1];(X$4971=t0$4966[2]);(attributes$4889=attributes$4889.concat(X$4971));}else{$5823(m$4961,"/home/olivier/git/earl-grey/src/location.eg",3460,3501);;}}return [e$4888,[bot$4884,e$4888,attributes$4889]];});;(jumptill$4877=function(active$4981,bot$4982,top$4983){var t0$4992;var t1$4993;var $index$5018;var $length$5013;var temp$5008;var acc$5003;var t0$5049;var t1$5050;var newbot$4986;var span$4987;var newactive$4988;var spans$4989;var remainder$4990;if((bot$4982===top$4983)){return [[],active$4981];}else{(t0$4992=jump$4876(active$4981,bot$4982,top$4983));if(((t0$4992 instanceof Array)&&((t1$4993=t0$4992.length),(t1$4993===2)))){(newbot$4986=t0$4992[0]);(span$4987=t0$4992[1]);;}else{$5823(jump$4876(active$4981,bot$4982,top$4983),"/home/olivier/git/earl-grey/src/location.eg",3737,3759);}(newactive$4988=(((acc$5003=[])),(((temp$5008=active$4981)),((($length$5013=temp$5008.length)),((($index$5018=0)),function(){$5000:for(;($index$5018<$length$5013);($index$5018++)){var x$5036;var e$5037;var attr$5038;var t0$5031;var t1$5032;var m$5026;(m$5026=temp$5008[$index$5018]);;(t0$5031=m$5026);(x$5036=t0$5031);if(((t0$5031 instanceof Array)&&((t1$5032=t0$5031.length),((t1$5032===3)&&(t0$5031[0],((e$5037=t0$5031[1]),((attr$5038=t0$5031[2]),(e$5037>newbot$4986)))))))){acc$5003.push(x$5036);}else{false;;}}}()))),acc$5003));;(t0$5049=jumptill$4877(newactive$4988,newbot$4986,top$4983));if(((t0$5049 instanceof Array)&&((t1$5050=t0$5049.length),(t1$5050===2)))){(spans$4989=t0$5049[0]);(remainder$4990=t0$5049[1]);;}else{$5823(jumptill$4877(newactive$4988,newbot$4986,top$4983),"/home/olivier/git/earl-grey/src/location.eg",3882,3914);}return [[span$4987].concat(spans$4989),remainder$4990];}});;(process$4878=function(start$5059,active$5060,rem$5061){var $index$5126;var $length$5121;var temp$5116;var acc$5111;var t0$5155;var t1$5156;var top$5103;var bot$5104;var spans$5105;var t0$5183;var t1$5184;var spans$5180;var newactive$5181;var start$5163;var active$5164;var next$5165;var target$5166;var end$5167;var attr$5168;var rest$5169;var start$5094;var active$5095;var $5064$5079;var $5065$5080;var $5066$5081;var t0$5073;var t1$5074;var t2$5075;var t3$5076;var t4$5077;var $5063$5068;($5063$5068=[start$5059,active$5060,rem$5061]);;if((($5064$5079=($5063$5068 instanceof Array))&&((t0$5073=$5063$5068.length),(($5066$5081=(t0$5073===3))&&($5063$5068[0],((t1$5074=$5063$5068[1]),((t1$5074 instanceof Array)&&((t2$5075=t1$5074.length),((t2$5075===0)&&((t3$5076=$5063$5068[2]),((t3$5076 instanceof Array)&&((t4$5077=t3$5076.length),(t4$5077===0))))))))))))){return [];}else{if(($5066$5081&&((start$5094=$5063$5068[0]),((active$5095=$5063$5068[1]),((t1$5074=$5063$5068[2]),((t1$5074 instanceof Array)&&((t2$5075=t1$5074.length),(t2$5075===0)))))))){(top$5103=$4288(Math.max,(((acc$5111=[])),(((temp$5116=active$5095)),((($length$5121=temp$5116.length)),((($index$5126=0)),function(){$5108:for(;($index$5126<$length$5121);($index$5126++)){var e$5144;var t0$5139;var t1$5140;var m$5134;(m$5134=temp$5116[$index$5126]);;(t0$5139=m$5134);if(((t0$5139 instanceof Array)&&((t1$5140=t0$5139.length),(t1$5140===3)))){t0$5139[0];(e$5144=t0$5139[1]);t0$5139[2];acc$5111.push(e$5144);}else{$5823(m$5134,"/home/olivier/git/earl-grey/src/location.eg",4102,4130);;}}}()))),acc$5111)));;(bot$5104=Math.min(start$5094,top$5103));;(t0$5155=jumptill$4877(active$5095,start$5094,top$5103));if(((t0$5155 instanceof Array)&&((t1$5156=t0$5155.length),(t1$5156===2)))){(spans$5105=t0$5155[0]);t0$5155[1];;}else{$5823(jumptill$4877(active$5095,start$5094,top$5103),"/home/olivier/git/earl-grey/src/location.eg",4189,4217);}return spans$5105;}else{if(($5066$5081&&((start$5163=$5063$5068[0]),((active$5164=$5063$5068[1]),((t1$5074=$5063$5068[2]),((t1$5074 instanceof Array)&&((t2$5075=t1$5074.length),((t2$5075>=1)&&((t3$5076=t1$5074[0]),((next$5165=t3$5076),((t3$5076 instanceof Array)&&((t4$5077=t3$5076.length),(t4$5077===3))))))))))))){(target$5166=t3$5076[0]);(end$5167=t3$5076[1]);(attr$5168=t3$5076[2]);(rest$5169=Array.prototype.slice.call(t1$5074,1));(t0$5183=jumptill$4877(active$5164,start$5163,target$5166));if(((t0$5183 instanceof Array)&&((t1$5184=t0$5183.length),(t1$5184===2)))){(spans$5180=t0$5183[0]);(newactive$5181=t0$5183[1]);;}else{$5823(jumptill$4877(active$5164,start$5163,target$5166),"/home/olivier/git/earl-grey/src/location.eg",4327,4358);}return spans$5180.concat(process$4878(target$5166,[next$5165].concat(newactive$5181),rest$5169));}else{$5823($5063$5068);}}}});;(thespans$4879=spans$4873.sort(function($5194$5197,$5195$5198){var t0$5205;var t1$5206;var t0$5212;var t1$5213;var s1$5200;var e1$5201;var s2$5202;var e2$5203;(t0$5205=$5194$5197);if(((t0$5205 instanceof Array)&&((t1$5206=t0$5205.length),(t1$5206===3)))){(s1$5200=t0$5205[0]);(e1$5201=t0$5205[1]);t0$5205[2];;}else{$5823($5194$5197);}(t0$5212=$5195$5198);if(((t0$5212 instanceof Array)&&((t1$5213=t0$5212.length),(t1$5213===3)))){(s2$5202=t0$5212[0]);(e2$5203=t0$5212[1]);t0$5212[2];;}else{$5823($5195$5198);}if((s1$5200===s2$5202)){return (e1$5201-e2$5203);}else{return (s1$5200-s2$5202);}}));;return process$4878(thespans$4879[0][0],[],thespans$4879);});;(highlight_locations$4336=function(){var $index$5257;var $length$5252;var temp$5247;var $index$5306;var $length$5301;var temp$5296;var acc$5291;var srcs$5239;var locations$5234;var context$5235;var t0$5230;var $5223$5225;($5223$5225=arguments);;(t0$5230=$5223$5225.length);if(((t0$5230>=1)&&(t0$5230<=2))){(locations$5234=$5223$5225[0]);(context$5235=function(){if((1>=t0$5230)){return 0;}else{return $5223$5225[1];}}());(srcs$5239=({}));;(temp$5247=locations$5234);;($length$5252=temp$5247.length);;($index$5257=0);;$5240:for(;($index$5257<$length$5252);($index$5257++)){var key$5281;var loc$5275;var cls$5276;var t0$5270;var t1$5271;var m$5265;(m$5265=temp$5247[$index$5257]);;(t0$5270=m$5265);if(((t0$5270 instanceof Array)&&((t1$5271=t0$5270.length),(t1$5271===2)))){(loc$5275=t0$5270[0]);(cls$5276=t0$5270[1]);(key$5281=String((loc$5275.source&&loc$5275.source.url)));;if((!$4288(srcs$5239,key$5281))){(srcs$5239[key$5281]=[]);}$4288(srcs$5239,key$5281).push([loc$5275,cls$5276]);}else{$5823(m$5265,"/home/olivier/git/earl-grey/src/location.eg",4696,4866);;}}return $6024(["+div"],(((acc$5291=[])),(((temp$5296=items$4324(srcs$5239))),((($length$5301=temp$5296.length)),((($index$5306=0)),function(){$5288:for(;($index$5306<$length$5301);($index$5306++)){var locs$5324;var t0$5319;var t1$5320;var m$5314;(m$5314=temp$5296[$index$5306]);;(t0$5319=m$5314);if(((t0$5319 instanceof Array)&&((t1$5320=t0$5319.length),(t1$5320===2)))){t0$5319[0];(locs$5324=t0$5319[1]);acc$5291.push(highlight_locations_same_source$4337(locs$5324,context$5235));}else{$5823(m$5314,"/home/olivier/git/earl-grey/src/location.eg",4871,4965);;}}}()))),acc$5291));}else{$5823($5223$5225);}});;(highlight_locations_same_source$4337=function(){var $index$5378;var $length$5373;var temp$5368;var acc$5363;var t0$5408;var t1$5409;var $index$5438;var $length$5433;var temp$5428;var acc$5423;var $index$5481;var $length$5476;var temp$5471;var acc$5466;var loc$5352;var src$5353;var l1$5354;var l2$5355;var first$5356;var last$5357;var locations$5347;var context$5348;var t0$5343;var $5336$5338;($5336$5338=arguments);;(t0$5343=$5336$5338.length);if(((t0$5343>=1)&&(t0$5343<=2))){(locations$5347=$5336$5338[0]);(context$5348=function(){if((1>=t0$5343)){return 0;}else{return $5336$5338[1];}}());(loc$5352=merge_locations$4338((((acc$5363=[])),(((temp$5368=locations$5347)),((($length$5373=temp$5368.length)),((($index$5378=0)),function(){$5360:for(;($index$5378<$length$5373);($index$5378++)){var x$5396;var cls$5397;var t0$5391;var t1$5392;var m$5386;(m$5386=temp$5368[$index$5378]);;(t0$5391=m$5386);if(((t0$5391 instanceof Array)&&((t1$5392=t0$5391.length),(t1$5392===2)))){(x$5396=t0$5391[0]);(cls$5397=t0$5391[1]);acc$5363.push(x$5396);}else{$5823(m$5386,"/home/olivier/git/earl-grey/src/location.eg",5048,5076);;}}}()))),acc$5363)));;(src$5353=loc$5352.source);;(t0$5408=loc$5352.linerange());if(((t0$5408 instanceof Array)&&((t1$5409=t0$5408.length),(t1$5409===2)))){(l1$5354=t0$5408[0]);(l2$5355=t0$5408[1]);;}else{$5823(loc$5352.linerange(),"/home/olivier/git/earl-grey/src/location.eg",5112,5127);}(first$5356=Math.max(1,(l1$5354-context$5348)));;(last$5357=Math.min(src$5353.nlines,(l2$5355+context$5348)));;return $6024(["+div","location"],[$6024(["+div","source"],[$6024(["sourcefile"],(src$5353.url||"???")),(((acc$5423=[])),(((temp$5428=locations$5347)),((($length$5433=temp$5428.length)),((($index$5438=0)),function(){$5420:for(;($index$5438<$length$5433);($index$5438++)){var loc$5456;var cls$5457;var t0$5451;var t1$5452;var m$5446;(m$5446=temp$5428[$index$5438]);;(t0$5451=m$5446);if(((t0$5451 instanceof Array)&&((t1$5452=t0$5451.length),(t1$5452===2)))){(loc$5456=t0$5451[0]);(cls$5457=t0$5451[1]);acc$5423.push($6024([cls$5457,"sourcepos"],loc$5456.ref()));}else{$5823(m$5446,"/home/olivier/git/earl-grey/src/location.eg",5296,5359);;}}}()))),acc$5423)]),src$5353.highlight_lines(first$5356,last$5357,(((acc$5466=[])),(((temp$5471=locations$5347)),((($length$5476=temp$5471.length)),((($index$5481=0)),function(){$5463:for(;($index$5481<$length$5476);($index$5481++)){var loc$5499;var cls$5500;var t0$5494;var t1$5495;var m$5489;(m$5489=temp$5471[$index$5481]);;(t0$5494=m$5489);if(((t0$5494 instanceof Array)&&((t1$5495=t0$5494.length),(t1$5495===2)))){(loc$5499=t0$5494[0]);(cls$5500=t0$5494[1]);acc$5466.push([loc$5499.start,loc$5499.end,[cls$5500]]);}else{$5823(m$5489,"/home/olivier/git/earl-grey/src/location.eg",5421,5477);;}}}()))),acc$5466))]);}else{$5823($5336$5338);}});;(merge_locations$4338=function($5511$5513){var $index$5570;var $length$5565;var temp$5560;var acc$5555;var $index$5609;var $length$5604;var temp$5599;var acc$5594;var start$5548;var end$5549;var locs$5544;var loc$5539;var $5516$5530;var $5517$5531;var t0$5528;var $5515$5523;var ph$5518;(ph$5518=$5511$5513);;($5515$5523=ph$5518);;if((($5516$5530=($5515$5523 instanceof Array))&&((t0$5528=$5515$5523.length),(t0$5528===0)))){return Location$4331(null,0,0);}else{if(($5516$5530&&(t0$5528===1))){(loc$5539=$5515$5523[0]);return loc$5539;}else{if(($5516$5530&&(t0$5528>=0))){(locs$5544=Array.prototype.slice.call($5515$5523,0));(start$5548=$4288(Math.min,(((acc$5555=[])),(((temp$5560=locs$5544)),((($length$5565=temp$5560.length)),((($index$5570=0)),function(){$5552:for(;($index$5570<$length$5565);($index$5570++)){var loc$5586;var m$5578;(m$5578=temp$5560[$index$5570]);;(loc$5586=m$5578);acc$5555.push(loc$5586.start);}}()))),acc$5555)));;(end$5549=$4288(Math.max,(((acc$5594=[])),(((temp$5599=locs$5544)),((($length$5604=temp$5599.length)),((($index$5609=0)),function(){$5591:for(;($index$5609<$length$5604);($index$5609++)){var loc$5625;var m$5617;(m$5617=temp$5599[$index$5609]);;(loc$5625=m$5617);acc$5594.push(loc$5625.end);}}()))),acc$5594)));;return Location$4331(locs$5544[0].source,start$5548,end$5549);}else{$5823($5515$5523);}}}});;(__lt____lt____colon__$4339=function(x$5634,y$5635){if((!$4273(Location$4331)(x$5634.location))){(x$5634["location"]=function(){if(((!y$5635)||$4273(Location$4331)(y$5635))){return y$5635;}else{return y$5635.location;}}());}return x$5634;});;(__plus____plus____colon__$4340=function(x$5643,y$5644){var rval$5648;(x$5643=function(){if(((!x$5643)||$4273(Location$4331)(x$5643))){return x$5643;}else{return x$5643.location;}}());(y$5644=function(){if(((!y$5644)||$4273(Location$4331)(y$5644))){return y$5644;}else{return y$5644.location;}}());(rval$5648=false);;try{(rval$5648=merge_locations$4338([x$5643,y$5644]));}catch(excv$5654){var e$5660;(e$5660=excv$5654);(rval$5648=(void 0));}return rval$5648;});;(format_error$4341=function(){var $index$5736;var $length$5731;var temp$5726;var acc$5721;var hls$5711;var locs$5712;var rval$5789;var loc$5805;var data$5785;var other$5811;var url$5778;var start$5779;var end$5780;var loc$5772;var args$5705;var fmt_args$5696;var $5668$5692;var $5669$5693;var $5670$5694;var t0$5688;var t1$5689;var t2$5690;var e$5682;var context$5683;var $5667$5684;var t0$5677;var t1$5678;var $5666$5672;($5666$5672=arguments);;(t0$5677=$5666$5672.length);if(((t0$5677>=1)&&(t0$5677<=2))){(t1$5678=$5666$5672[0]);(e$5682=t1$5678);($5667$5684=t1$5678);(context$5683=function(){if((1>=t0$5677)){return 0;}else{return $5666$5672[1];}}());(fmt_args$5696=function(e$5700){if((e$5700.args&&e$5700.args.length)){return $6024(["error_args"],repr$4328(e$5700.args));}else{return "";}});;(t0$5688=$5667$5684);if(($4273($5836(["syntax"]))(t0$5688)&&($6197(t0$5688,"args")&&((t1$5689=t0$5688.args),((t1$5689 instanceof Array)&&((t2$5690=t1$5689.length),(t2$5690===1))))))){(args$5705=t1$5689[0]);(hls$5711=["hl1","hl2","hl3","hl4"]);;(locs$5712=(((acc$5721=[])),(((temp$5726=enumerate$4325(items$4324(args$5705)))),((($length$5731=temp$5726.length)),((($index$5736=0)),function(){$5718:for(;($index$5736<$length$5731);($index$5736++)){var i$5756;var key$5757;var arg$5758;var t0$5749;var t1$5750;var t2$5751;var t3$5752;var m$5744;(m$5744=temp$5726[$index$5736]);;(t0$5749=m$5744);if(((t0$5749 instanceof Array)&&((t1$5750=t0$5749.length),((t1$5750===2)&&((i$5756=t0$5749[0]),((t2$5751=t0$5749[1]),((t2$5751 instanceof Array)&&((t3$5752=t2$5751.length),((t3$5752===2)&&((key$5757=t2$5751[0]),((arg$5758=t2$5751[1]),(arg$5758&&arg$5758.location)))))))))))){acc$5721.push([arg$5758.location,$4288(hls$5711,(i$5756%4))]);}else{false;;}}}()))),acc$5721));;return $6024(["+div"],[$6024(["error"],[$6024(["error_type"],e$5682.name),$6024(["error_message"],e$5682.message)]),$6024(["error_args","syntax"],repr$4328(args$5705)),highlight_locations$4336(locs$5712,context$5683)]);}else{if((($5669$5693=$6197(t0$5688,"location"))&&((t1$5689=t0$5688.location),$4273(Location$4331)(t1$5689)))){(loc$5772=t1$5689);return $6024(["+div"],[$6024(["error"],[$6024(["error_type"],e$5682.name),$6024(["error_message"],e$5682.message)]),fmt_args$5696(e$5682),highlight_locations$4336([[loc$5772,"hl1"]],context$5683),$6024(["traceback"],(e$5682.stack||""))]);}else{if(($5669$5693&&((t1$5689 instanceof Array)&&((t2$5690=t1$5689.length),((t2$5690===4)&&(t1$5689[0]==="location")))))){(url$5778=t1$5689[1]);(start$5779=t1$5689[2]);(end$5780=t1$5689[3]);(data$5785=(((rval$5789=false)),(function(){try{(rval$5789=fs$4329.readFileSync(url$5778,"utf8"));}catch(excv$5795){var e$5801;(e$5801=excv$5795);(rval$5789=null);}}(),rval$5789)));;if(data$5785){(loc$5805=Location$4331(Source$4330(data$5785,url$5778),start$5779,end$5780));;return $6024(["+div"],[$6024(["error"],[$6024(["error_type"],e$5682.name),$6024(["error_message"],e$5682.message)]),fmt_args$5696(e$5682),highlight_locations$4336([[loc$5805,"hl1"]],context$5683),$6024(["traceback"],($6024([],e$5682.stack)||""))]);}else{return $6024(["+div"],[$6024(["error"],[$6024(["error_type"],e$5682.name),$6024(["error_message"],e$5682.message)]),fmt_args$5696(e$5682),$6024(["traceback"],($6024([],e$5682.stack)||e$5682))]);}}else{(other$5811=$5667$5684);return $6024(["+div"],[$6024(["error"],[$6024(["error_type"],e$5682.name),$6024(["error_message"],e$5682.message)]),fmt_args$5696(e$5682),$6024(["traceback"],$6024([],e$5682.stack))]);}}}}else{$5823($5666$5672);}});;(display_error$4342=function(e$5819){return __lt____gt__$4327(null,format_error$4341(e$5819));});;(exports["Source"]=Source$4330);(exports["Location"]=Location$4331);(exports["highlight"]=highlight$4332);(exports["highlight_locations"]=highlight_locations$4336);(exports["merge_locations"]=merge_locations$4338);(exports["<<:"]=__lt____lt____colon__$4339);(exports["++:"]=__plus____plus____colon__$4340);(exports["format_error"]=format_error$4341);(exports["display_error"]=display_error$4342);

},{"./pp":11,"./util":14,"fs":15}],8:[function(require,module,exports){
var $6352=function(type$6354){var f$6357;(f$6357=type$6354["::check"]);;if((f$6357===(void 0))){return function(value$6362){return (value$6362 instanceof type$6354);};}else{return function(value$6365){return f$6357.call(type$6354,value$6365);};}};
var $6367=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $6368=function($6369$6371){var ph$6375;(ph$6375=$6369$6371);;var $6373$6380;($6373$6380=ph$6375);;var bridge$6374$6385;var x$6389;(bridge$6374$6385=$6373$6380);if((((typeof(bridge$6374$6385)==="string")&&((x$6389=bridge$6374$6385),true))||((typeof(bridge$6374$6385)==="number")&&((x$6389=bridge$6374$6385),true)))){return ["value",x$6389];}else{var other$6396;(other$6396=$6373$6380);return other$6396["::serialize_ast"]();}};
var send$6236;(send$6236=function(obj$6241,$6239$6242){var ph$6246;var msg$6247;var t0$6249;(t0$6249=$6239$6242);(msg$6247=t0$6249);(ph$6246=t0$6249);;var $6244$6253;($6244$6253=ph$6246);;var bridge$6245$6258;(bridge$6245$6258=$6244$6253);if(((typeof(bridge$6245$6258)==="string")||(typeof(bridge$6245$6258)==="number"))){return obj$6241[msg$6247];}else{var other$6266;(other$6266=$6244$6253);return obj$6241["::send"](msg$6247);}});;(Array[":::project"]=function($6269$6271){var ph$6274;var value$6275;var t0$6277;(t0$6277=$6269$6271);(value$6275=t0$6277);(ph$6274=t0$6277);;var $6273$6281;($6273$6281=ph$6274);;if($6352(Array)($6273$6281)){return [true,value$6275];}else{$6273$6281;return [true,[value$6275]];}});(Array.prototype["::check"]=function(value$6295){if((value$6295 instanceof Array)){var i$6300;(i$6300=0);;$6298:for(;(i$6300<this.length);(i$6300++)){if(($6367(this,i$6300)!==$6367(value$6295,i$6300))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$6311){if((value$6311 instanceof Array)){var i$6316;(i$6316=0);;$6314:for(;(i$6316<this.length);(i$6316++)){if(($6367(this,i$6316)!==$6367(value$6311,i$6316))){return [true,[value$6311]];}}return [true,value$6311.slice(this.length)];}else{return [true,[value$6311]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($6368));});(RegExp.prototype["::check"]=function(value$6327){return value$6327.match(this);});(RegExp.prototype[":::project"]=function(value$6330){var $6332$6334;($6332$6334=value$6330.match(this));;var m$6342;if(($6332$6334===null)){(m$6342=$6332$6334);return [false,null];}else{var m$6347;(m$6347=$6332$6334);return [true,m$6347];}});(Function.prototype["::send"]=function(args$6350){return this.apply(this,args$6350);});
var $6823=function(arr$6825){var results$6829;var l$6830;(results$6829=[]);;(l$6830=arr$6825.length);;var i$6838;(i$6838=0);;$6828:for(;(i$6838<l$6830);(i$6838++)){results$6829.push([i$6838,$6367(arr$6825,i$6838)]);}return results$6829;};
var $6845=function(dest$6847,values$6848){var k$6853;(k$6853=null);$6851:for(k$6853 in values$6848){if(values$6848.hasOwnProperty(k$6853)){(dest$6847[k$6853]=values$6848[k$6853]);}}return dest$6847;};
var $6669=function(){var $6670$6672;($6670$6672=function(tags$6676){var it$0$6679;(it$0$6679=function(){if((!$6352($6670$6672)(this))){return Object.create($6670$6672.prototype);}else{return this;}}());;(it$0$6679["tags"]=tags$6676);return it$0$6679;});;($6670$6672.prototype["create"]=function(){var $6688$6690;($6688$6690=arguments);;var t0$6695;var message$6699;var args$6700;(t0$6695=$6688$6690.length);if((t0$6695>=0)){(message$6699=function(){if((0>=t0$6695)){return "";}else{return $6688$6690[0];}}());(args$6700=Array.prototype.slice.call($6688$6690,1));var it$0$6704;(it$0$6704=this);;var e$6709;(e$6709=Error(message$6699));;(e$6709["::tags"]=it$0$6704.tags);(e$6709["args"]=args$6700);var temp$6717;(temp$6717=$6823(args$6700));;var $length$6722;($length$6722=temp$6717.length);;var $index$6727;($index$6727=0);;$6710:for(;($index$6727<$length$6722);($index$6727++)){var m$6735;(m$6735=temp$6717[$index$6727]);;var t0$6740;var t1$6741;var i$6745;var arg$6746;(t0$6740=m$6735);if(((t0$6740 instanceof Array)&&((t1$6741=t0$6740.length),(t1$6741===2)))){(i$6745=t0$6740[0]);(arg$6746=t0$6740[1]);(e$6709[i$6745]=arg$6746);}else{$6656(m$6735);;}}(e$6709["length"]=args$6700.length);(e$6709["name"]=["E"].concat(it$0$6704.tags).join("."));return e$6709;}else{$6656($6688$6690);}});($6670$6672.prototype["::check"]=function(e$6757){var it$0$6760;(it$0$6760=this);;var tags$6765;if(((!e$6757)||(!$6352(Error)(e$6757)))){return false;}(tags$6765=(e$6757["::tags"]||[]));;var temp$6774;(temp$6774=it$0$6760.tags);;var $length$6779;($length$6779=temp$6774.length);;var $index$6784;($index$6784=0);;$6766:for(;($index$6784<$length$6779);($index$6784++)){var m$6792;(m$6792=temp$6774[$index$6784]);;var tag$6800;(tag$6800=m$6792);if((tags$6765.indexOf(tag$6800)===-1)){return false;}else{false;;}}return true;});($6670$6672.prototype["::deconstruct"]=function(e$6808){var it$0$6811;(it$0$6811=this);;return e$6808.args;});$6845($6670$6672,$6845(function(){var accum$6816;(accum$6816=({}));(accum$6816["::name"]="$6670");return accum$6816;}(),function(){var accum$6820;(accum$6820=({}));(accum$6820["::egclass"]=true);return accum$6820;}()));return $6670$6672;}();
var $6656=function(value$6658,url$6659,start$6660,end$6661){var err$6664;(err$6664=$6669(["match"]).create("Could not find a match for value",({"value":value$6658})));;if(url$6659){(err$6664["location"]=["location",url$6659,start$6660,end$6661]);}throw err$6664;};var hoist$6399;var hoistable$6400;var not_hoistable$6401;var hoist_helper$6402;(hoist$6399=function(expr$6406){var t0$6412;var t1$6413;var b$6409;var inner$6410;(t0$6412=hoist_helper$6402(expr$6406));if(((t0$6412 instanceof Array)&&((t1$6413=t0$6412.length),(t1$6413===2)))){(b$6409=t0$6412[0]);(inner$6410=t0$6412[1]);;}else{$6656(hoist_helper$6402(expr$6406),"/home/olivier/git/earl-grey/src/opt.eg",50,68);}return ["scope",inner$6410,b$6409];});;(hoistable$6400=["send","array","object","multi","if","assign","js_break","js_continue","js_return","js_delete","js_throw","js_try","js_new"]);;(not_hoistable$6401=["void","js_while","js_for","js_for_in","js_label"]);;(hoist_helper$6402=function($6427$6429){var t0$6440;var x$6462;var x$6467;var bridge$6433$6459;var x$6472;var t0$6488;var t1$6489;var newbody$6485;var inner$6486;var t0$6504;var t1$6505;var newbody$6501;var inner$6502;var $index$6544;var $length$6539;var temp$6534;var acc$6529;var accum$6519;var newargs$6520;var $index$6603;var $length$6598;var temp$6593;var acc$6588;var newargs$6582;var other$6652;var type$6575;var args$6576;var type$6512;var args$6513;var vars$6496;var body$6497;var vars$6479;var body$6480;var $6434$6452;var $6435$6453;var $6436$6454;var bridge$6432$6449;var t0$6450;var $6431$6444;var ph$6437;var expr$6438;(t0$6440=$6427$6429);(expr$6438=t0$6440);(ph$6437=t0$6440);;($6431$6444=ph$6437);;(bridge$6432$6449=$6431$6444);if((((bridge$6433$6459=bridge$6432$6449),((((x$6462=bridge$6433$6459)),((x$6462 instanceof Array)&&(x$6462[0]==="symbol")))||(((x$6467=bridge$6433$6459)),((x$6467 instanceof Array)&&(x$6467[0]==="value")))))||(((x$6472=bridge$6432$6449)),((x$6472 instanceof Array)&&(x$6472[0]==="variable"))))){return [expr$6438,[]];}else{if((($6434$6452=($6431$6444 instanceof Array))&&((t0$6450=$6431$6444.length),(($6436$6454=(t0$6450===3))&&($6431$6444[0]==="scope"))))){(vars$6479=$6431$6444[1]);(body$6480=$6431$6444[2]);(t0$6488=hoist_helper$6402(body$6480));if(((t0$6488 instanceof Array)&&((t1$6489=t0$6488.length),(t1$6489===2)))){(newbody$6485=t0$6488[0]);(inner$6486=t0$6488[1]);;}else{$6656(hoist_helper$6402(body$6480),"/home/olivier/git/earl-grey/src/opt.eg",447,465);}return [newbody$6485,inner$6486.concat(vars$6479)];}else{if(($6436$6454&&($6431$6444[0]==="lambda"))){(vars$6496=$6431$6444[1]);(body$6497=$6431$6444[2]);(t0$6504=hoist_helper$6402(body$6497));if(((t0$6504 instanceof Array)&&((t1$6505=t0$6504.length),(t1$6505===2)))){(newbody$6501=t0$6504[0]);(inner$6502=t0$6504[1]);;}else{$6656(hoist_helper$6402(body$6497),"/home/olivier/git/earl-grey/src/opt.eg",581,599);}return [["lambda",vars$6496,["scope",inner$6502,newbody$6501]],[]];}else{if(($6434$6452&&(($6436$6454=(t0$6450>=1))&&((type$6512=$6431$6444[0]),((args$6513=Array.prototype.slice.call($6431$6444,1)),(hoistable$6400.indexOf(type$6512)!==-1)))))){(accum$6519=[]);;(newargs$6520=(((acc$6529=[])),(((temp$6534=args$6513)),((($length$6539=temp$6534.length)),((($index$6544=0)),function(){$6526:for(;($index$6544<$length$6539);($index$6544++)){var t0$6566;var t1$6567;var b$6563;var inner$6564;var arg$6560;var m$6552;(m$6552=temp$6534[$index$6544]);;(arg$6560=m$6552);acc$6529.push((((t0$6566=hoist_helper$6402(arg$6560)),function(){if(((t0$6566 instanceof Array)&&((t1$6567=t0$6566.length),(t1$6567===2)))){(b$6563=t0$6566[0]);(inner$6564=t0$6566[1]);}else{return $6656(hoist_helper$6402(arg$6560),"/home/olivier/git/earl-grey/src/opt.eg",779,796);}}()),(accum$6519=accum$6519.concat(inner$6564)),b$6563));}}()))),acc$6529));;return [[type$6512].concat(newargs$6520),accum$6519];}else{if(($6436$6454&&((type$6575=$6431$6444[0]),((args$6576=Array.prototype.slice.call($6431$6444,1)),(not_hoistable$6401.indexOf(type$6575)!==-1))))){(newargs$6582=(((acc$6588=[])),(((temp$6593=args$6576)),((($length$6598=temp$6593.length)),((($index$6603=0)),function(){$6585:for(;($index$6603<$length$6598);($index$6603++)){var t0$6626;var t1$6627;var other$6647;var t0$6638;var $6622$6633;var b$6623;var inner$6624;var arg$6619;var m$6611;(m$6611=temp$6593[$index$6603]);;(arg$6619=m$6611);acc$6588.push((((t0$6626=hoist_helper$6402(arg$6619)),function(){if(((t0$6626 instanceof Array)&&((t1$6627=t0$6626.length),(t1$6627===2)))){(b$6623=t0$6626[0]);(inner$6624=t0$6626[1]);}else{return $6656(hoist_helper$6402(arg$6619),"/home/olivier/git/earl-grey/src/opt.eg",981,998);}}()),((($6622$6633=inner$6624)),function(){if((($6622$6633 instanceof Array)&&((t0$6638=$6622$6633.length),(t0$6638===0)))){return b$6623;}else{(other$6647=$6622$6633);return ["scope",inner$6624,b$6623];}}())));}}()))),acc$6588));;return [[type$6575].concat(newargs$6582),[]];}else{(other$6652=$6431$6444);throw $6669(["syntax","illegal"]).create("Illegal node -- this should not happen.",({"node":other$6652}));}}}}}});;(exports["hoist"]=hoist$6399);

},{}],9:[function(require,module,exports){
var $6974=function(type$6976){var f$6979;(f$6979=type$6976["::check"]);;if((f$6979===(void 0))){return function(value$6984){return (value$6984 instanceof type$6976);};}else{return function(value$6987){return f$6979.call(type$6976,value$6987);};}};
var $6989=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $6990=function($6991$6993){var ph$6997;(ph$6997=$6991$6993);;var $6995$7002;($6995$7002=ph$6997);;var bridge$6996$7007;var x$7011;(bridge$6996$7007=$6995$7002);if((((typeof(bridge$6996$7007)==="string")&&((x$7011=bridge$6996$7007),true))||((typeof(bridge$6996$7007)==="number")&&((x$7011=bridge$6996$7007),true)))){return ["value",x$7011];}else{var other$7018;(other$7018=$6995$7002);return other$7018["::serialize_ast"]();}};
var send$6858;(send$6858=function(obj$6863,$6861$6864){var ph$6868;var msg$6869;var t0$6871;(t0$6871=$6861$6864);(msg$6869=t0$6871);(ph$6868=t0$6871);;var $6866$6875;($6866$6875=ph$6868);;var bridge$6867$6880;(bridge$6867$6880=$6866$6875);if(((typeof(bridge$6867$6880)==="string")||(typeof(bridge$6867$6880)==="number"))){return obj$6863[msg$6869];}else{var other$6888;(other$6888=$6866$6875);return obj$6863["::send"](msg$6869);}});;(Array[":::project"]=function($6891$6893){var ph$6896;var value$6897;var t0$6899;(t0$6899=$6891$6893);(value$6897=t0$6899);(ph$6896=t0$6899);;var $6895$6903;($6895$6903=ph$6896);;if($6974(Array)($6895$6903)){return [true,value$6897];}else{$6895$6903;return [true,[value$6897]];}});(Array.prototype["::check"]=function(value$6917){if((value$6917 instanceof Array)){var i$6922;(i$6922=0);;$6920:for(;(i$6922<this.length);(i$6922++)){if(($6989(this,i$6922)!==$6989(value$6917,i$6922))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$6933){if((value$6933 instanceof Array)){var i$6938;(i$6938=0);;$6936:for(;(i$6938<this.length);(i$6938++)){if(($6989(this,i$6938)!==$6989(value$6933,i$6938))){return [true,[value$6933]];}}return [true,value$6933.slice(this.length)];}else{return [true,[value$6933]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($6990));});(RegExp.prototype["::check"]=function(value$6949){return value$6949.match(this);});(RegExp.prototype[":::project"]=function(value$6952){var $6954$6956;($6954$6956=value$6952.match(this));;var m$6964;if(($6954$6956===null)){(m$6964=$6954$6956);return [false,null];}else{var m$6969;(m$6969=$6954$6956);return [true,m$6969];}});(Function.prototype["::send"]=function(args$6972){return this.apply(this,args$6972);});
var $8028=function(arr$8030){var results$8034;var l$8035;(results$8034=[]);;(l$8035=arr$8030.length);;var i$8043;(i$8043=0);;$8033:for(;(i$8043<l$8035);(i$8043++)){results$8034.push([i$8043,$6989(arr$8030,i$8043)]);}return results$8034;};
var $8050=function(dest$8052,values$8053){var k$8058;(k$8058=null);$8056:for(k$8058 in values$8053){if(values$8053.hasOwnProperty(k$8058)){(dest$8052[k$8058]=values$8053[k$8058]);}}return dest$8052;};
var $7874=function(){var $7875$7877;($7875$7877=function(tags$7881){var it$0$7884;(it$0$7884=function(){if((!$6974($7875$7877)(this))){return Object.create($7875$7877.prototype);}else{return this;}}());;(it$0$7884["tags"]=tags$7881);return it$0$7884;});;($7875$7877.prototype["create"]=function(){var $7893$7895;($7893$7895=arguments);;var t0$7900;var message$7904;var args$7905;(t0$7900=$7893$7895.length);if((t0$7900>=0)){(message$7904=function(){if((0>=t0$7900)){return "";}else{return $7893$7895[0];}}());(args$7905=Array.prototype.slice.call($7893$7895,1));var it$0$7909;(it$0$7909=this);;var e$7914;(e$7914=Error(message$7904));;(e$7914["::tags"]=it$0$7909.tags);(e$7914["args"]=args$7905);var temp$7922;(temp$7922=$8028(args$7905));;var $length$7927;($length$7927=temp$7922.length);;var $index$7932;($index$7932=0);;$7915:for(;($index$7932<$length$7927);($index$7932++)){var m$7940;(m$7940=temp$7922[$index$7932]);;var t0$7945;var t1$7946;var i$7950;var arg$7951;(t0$7945=m$7940);if(((t0$7945 instanceof Array)&&((t1$7946=t0$7945.length),(t1$7946===2)))){(i$7950=t0$7945[0]);(arg$7951=t0$7945[1]);(e$7914[i$7950]=arg$7951);}else{$7861(m$7940);;}}(e$7914["length"]=args$7905.length);(e$7914["name"]=["E"].concat(it$0$7909.tags).join("."));return e$7914;}else{$7861($7893$7895);}});($7875$7877.prototype["::check"]=function(e$7962){var it$0$7965;(it$0$7965=this);;var tags$7970;if(((!e$7962)||(!$6974(Error)(e$7962)))){return false;}(tags$7970=(e$7962["::tags"]||[]));;var temp$7979;(temp$7979=it$0$7965.tags);;var $length$7984;($length$7984=temp$7979.length);;var $index$7989;($index$7989=0);;$7971:for(;($index$7989<$length$7984);($index$7989++)){var m$7997;(m$7997=temp$7979[$index$7989]);;var tag$8005;(tag$8005=m$7997);if((tags$7970.indexOf(tag$8005)===-1)){return false;}else{false;;}}return true;});($7875$7877.prototype["::deconstruct"]=function(e$8013){var it$0$8016;(it$0$8016=this);;return e$8013.args;});$8050($7875$7877,$8050(function(){var accum$8021;(accum$8021=({}));(accum$8021["::name"]="$7875");return accum$8021;}(),function(){var accum$8025;(accum$8025=({}));(accum$8025["::egclass"]=true);return accum$8025;}()));return $7875$7877;}();
var $7861=function(value$7863,url$7864,start$7865,end$7866){var err$7869;(err$7869=$7874(["match"]).create("Could not find a match for value",({"value":value$7863})));;if(url$7864){(err$7869["location"]=["location",url$7864,start$7865,end$7866]);}throw err$7869;};
var $8062=function(type$8064){return function(value$8067){var f$8070;(f$8070=type$8064[":::project"]);;if((f$8070===(void 0))){var f$8075;(f$8075=type$8064["::project"]);;if((f$8075===(void 0))){return [true,type$8064(value$8067)];}else{var rval$8080;(rval$8080=false);;try{(rval$8080=[true,f$8075(value$8067)]);}catch(excv$8086){var e$8092;(e$8092=excv$8086);(rval$8080=[false,null]);}return rval$8080;}}else{return f$8070.call(type$8064,value$8067);}};};var $7021$7022;var __lt____lt____colon__$7023;var __plus____plus____colon__$7024;var transform$7025;var MAX$7026;var order_map$7027;var DONE$7028;var NONE$7029;var LEFT$7030;var RIGHT$7031;var BOTH$7032;var oparse$7033;var consult$7034;var order$7035;var finalize$7036;var parse$7037;($7021$7022=require("./location"));;(__lt____lt____colon__$7023=$7021$7022["<<:"]);;(__plus____plus____colon__$7024=$7021$7022["++:"]);;(transform$7025=function(expr$7050,cb$7051){var rval$7065;var tr$7054;var result$7055;(tr$7054=function(x$7059){return transform$7025(x$7059,cb$7051);});;(result$7055=(((rval$7065=false)),(function(){try{(rval$7065=cb$7051.call(tr$7054,expr$7050));}catch(excv$7071){var name$7111;var args$7112;var v$7106;var s$7101;var $7080$7091;var $7081$7092;var $7082$7093;var t0$7089;var $7079$7084;var e$7077;(e$7077=excv$7071);(rval$7065=((($7079$7084=expr$7050)),function(){if((($7080$7091=($7079$7084 instanceof Array))&&((t0$7089=$7079$7084.length),((t0$7089===1)&&($7079$7084[0]==="void"))))){return ["void"];}else{if(($7080$7091&&(($7082$7093=(t0$7089===2))&&($7079$7084[0]==="symbol")))){(s$7101=$7079$7084[1]);return expr$7050;}else{if(($7082$7093&&($7079$7084[0]==="value"))){(v$7106=$7079$7084[1]);return expr$7050;}else{if(($7080$7091&&(t0$7089>=1))){(name$7111=$7079$7084[0]);(args$7112=Array.prototype.slice.call($7079$7084,1));return [name$7111].concat(args$7112.map(tr$7054));}else{$7861($7079$7084);}}}}}()));}}(),rval$7065)));;return __lt____lt____colon__$7023(result$7055,expr$7050);});;(MAX$7026=(1/0));;(order_map$7027=({"IFX":({"wide":({",":[[15,1],[15,1]],"with":[[15,1999],[15,10]],"each":[[15,11],[15,10]],"each?":[[15,11],[15,10]],"where":[[15,11],[15,10]],"!!":[[15,11],[15,10]],"|>":[[15,11],[15,10]],"->":[[15,11],[15,10]],"=>":[[15,11],[15,10]],"=":[[15,11],[15,10]],":=":[[15,11],[15,10]],"+=":[[15,11],[15,10]],"-=":[[15,11],[15,10]],"*=":[[15,11],[15,10]],"/=":[[15,11],[15,10]],"<<=":[[15,11],[15,10]],">>=":[[15,11],[15,10]],">>>=":[[15,11],[15,10]],"++=":[[15,11],[15,10]],"?=":[[15,11],[15,10]],"or=":[[15,11],[15,10]],"and=":[[15,11],[15,10]],"each=":[[15,11],[15,10]],"%":[[15,11],[15,10]],"when":[[15,100],[15,101]],"||":[[15,110],[15,111]],"&&":[[15,120],[15,121]],"or":[[15,110],[15,111]],"and":[[15,120],[15,121]],"not":[[15,130],[15,131]],"==":[[15,200],[15,201]],"!=":[[15,200],[15,201]],">=":[[15,200],[15,201]],"<=":[[15,200],[15,201]],">":[[15,200],[15,201]],"<":[[15,200],[15,201]],"^.":[[15,400],[15,401]],"|.":[[15,410],[15,411]],"&.":[[15,420],[15,421]],"<<":[[1,500],[1,501]],">>":[[1,500],[1,501]],">>>":[[1,500],[1,501]],"+":[[1,550],[1,551]],"-":[[1,550],[1,551]],"*":[[1,560],[1,561]],"/":[[1,560],[1,561]],"mod":[[1,560],[1,561]],"**":[[1,571],[1,570]],"DEFAULT":[[8,900],[4,901]],"WHITE":[[15,1002],[15,1001]],":":[[15,1001],[15,2]]}),"short":({"DEFAULT":[[15,1800],[15,1801]],"WHITE":[[15,2000],[15,2001]],",":[[15,1],[15,1]],":":[[15,1001],[15,2]]})}),"PFX":({"wide":({"DEFAULT":[[15,MAX$7026],[15,900]],"when":[[15,MAX$7026],[15,101]],"not":[[15,MAX$7026],[15,131]],".":[[15,MAX$7026],[15,3000]],"#":[[15,MAX$7026],[15,3000]],"@":[[15,MAX$7026],[15,3000]],"<>":[[15,MAX$7026],[15,5]],"(":[[15,MAX$7026],[15,1]],"[":[[15,MAX$7026],[15,1]],"{":[[15,MAX$7026],[15,1]]}),"short":({"DEFAULT":[[15,MAX$7026],[15,1901]],".":[[15,MAX$7026],[15,3000]],"#":[[15,MAX$7026],[15,3000]],"@":[[15,MAX$7026],[15,3000]],"(":[[15,MAX$7026],[15,1]],"[":[[15,MAX$7026],[15,1]],"{":[[15,MAX$7026],[15,1]]})}),"SFX":({"wide":({"DEFAULT":[[15,901],[15,MAX$7026]],")":[[15,1],[15,MAX$7026]],"]":[[15,1],[15,MAX$7026]],"}":[[15,1],[15,MAX$7026]]}),"short":({"DEFAULT":[[15,1900],[15,MAX$7026]],")":[[15,1],[15,MAX$7026]],"]":[[15,1],[15,MAX$7026]],"}":[[15,1],[15,MAX$7026]]})})}));;(DONE$7028=-1);;(NONE$7029=0);;(LEFT$7030=1);;(RIGHT$7031=2);;(BOTH$7032=3);;(oparse$7033=function(next$7143,order$7144,finalize$7145){var between$7148;var right_op$7149;var stack$7150;var left_op$7151;var current$7152;(between$7148=finalize$7145(next$7143()));;(right_op$7149=next$7143());;(stack$7150=[]);;(left_op$7151=null);;(current$7152=null);;$7153:while(true){var v$7193;var other$7209;var $7172$7178;var o$7173;(o$7173=function(){if(((!left_op$7151)&&(!right_op$7149))){return DONE$7028;}else{return ((((!left_op$7151)&&RIGHT$7031)||((!right_op$7149)&&LEFT$7030))||order$7144(left_op$7151,right_op$7149));}}());;($7172$7178=o$7173);;if(($7172$7178===DONE$7028)){return between$7148;}else{if(($7172$7178===LEFT$7030)){current$7152.push(between$7148);(between$7148=finalize$7145(current$7152));(v$7193=stack$7150.pop());;(left_op$7151=v$7193[0]);(current$7152=v$7193[1]);}else{if(($7172$7178===RIGHT$7031)){stack$7150.push([left_op$7151,current$7152]);(left_op$7151=right_op$7149);(current$7152=[[right_op$7149],between$7148]);(between$7148=finalize$7145(next$7143()));(right_op$7149=next$7143());}else{if(($7172$7178===BOTH$7032)){current$7152[0].push(right_op$7149);current$7152.push(between$7148);(left_op$7151=right_op$7149);(between$7148=finalize$7145(next$7143()));(right_op$7149=next$7143());}else{(other$7209=$7172$7178);throw $7874(["should_never_happen"]).create("undefined priority",({"left":left_op$7151,"right":right_op$7149}));}}}}}});;(consult$7034=function($7214$7216){var t0$7222;var t1$7223;var map$7229;var fixity$7218;var width$7219;var op$7220;(t0$7222=$7214$7216);if(((t0$7222 instanceof Array)&&((t1$7223=t0$7222.length),(t1$7223===3)))){(fixity$7218=t0$7222[0]);(width$7219=t0$7222[1]);(op$7220=t0$7222[2]);;}else{$7861($7214$7216);}(map$7229=$6989($6989(order_map$7027,fixity$7218),width$7219));;return ($6989(map$7229,op$7220)||map$7229.DEFAULT);});;(order$7035=function(o1$7237,o2$7238){var t0$7248;var t1$7249;var t0$7255;var t1$7256;var $7242$7268;var $7241$7262;var code1$7243;var ord1$7244;var code2$7245;var ord2$7246;(t0$7248=consult$7034(o1$7237)[1]);if(((t0$7248 instanceof Array)&&((t1$7249=t0$7248.length),(t1$7249===2)))){(code1$7243=t0$7248[0]);(ord1$7244=t0$7248[1]);;}else{$7861(consult$7034(o1$7237)[1],"/home/olivier/git/earl-grey/src/parse.eg",6233,6247);}(t0$7255=consult$7034(o2$7238)[0]);if(((t0$7255 instanceof Array)&&((t1$7256=t0$7255.length),(t1$7256===2)))){(code2$7245=t0$7255[0]);(ord2$7246=t0$7255[1]);;}else{$7861(consult$7034(o2$7238)[0],"/home/olivier/git/earl-grey/src/parse.eg",6267,6281);}($7241$7262=null);;$7241$7262;if(((code1$7243&code2$7245)===0)){throw $7874(["syntax","order"]).create("Cannot mix operators in the given order",({"left":o1$7237,"right":o2$7238}));}else{if((ord1$7244>ord2$7246)){return LEFT$7030;}else{if((ord1$7244<ord2$7246)){return RIGHT$7031;}else{if((ord1$7244===ord2$7246)){return BOTH$7032;}else{$7861($7241$7262);}}}}});;(finalize$7036=function($7290$7292){var t0$7301;var $index$7378;var $length$7373;var temp$7368;var $index$7408;var $length$7403;var temp$7398;var $index$7447;var $length$7442;var temp$7437;var acc$7432;var other$7675;var args$7670;var f$7658;var orig_args$7659;var args$7660;var $7633$7645;var $7634$7646;var t0$7641;var t1$7642;var t2$7643;var $7632$7636;var inserted$7528;var result$7529;var f$7686;var other$7745;var x$7738;var $7719$7729;var $7720$7730;var t0$7727;var $7718$7722;var result$7683;var f$7753;var oloc$7820;var abloc$7821;var oabloc$7822;var rval$7823;var a$7815;var b$7816;var $7345$7800;var $7346$7801;var $7347$7802;var $7348$7803;var t0$7793;var t1$7794;var t2$7795;var t3$7796;var t4$7797;var t5$7798;var other$7840;var $7344$7789;var target$7514;var _b$7515;var body$7516;var f$7506;var body$7507;var f$7494;var arg$7495;var body$7496;var $7349$7485;var $7350$7486;var $7351$7487;var $7352$7488;var $7353$7489;var $7354$7490;var $7355$7491;var t0$7474;var t1$7475;var t2$7476;var t3$7477;var t4$7478;var t5$7479;var t6$7480;var t7$7481;var t8$7482;var bridge$7343$7483;var $7342$7469;var sumloc$7356;var orig_ops$7357;var op$7358;var other$7844;var ops$7337;var args$7338;var value$7328;var value$7323;var value$7317;var $7295$7312;var $7296$7313;var $7297$7314;var t0$7310;var $7294$7305;var ph$7298;var token$7299;(t0$7301=$7290$7292);(token$7299=t0$7301);(ph$7298=t0$7301);;($7294$7305=ph$7298);;if((($7295$7312=($7294$7305 instanceof Array))&&((t0$7310=$7294$7305.length),(($7297$7314=(t0$7310===2))&&($7294$7305[0]==="ID"))))){(value$7317=$7294$7305[1]);return __lt____lt____colon__$7023(["symbol",value$7317],token$7299);}else{if(($7297$7314&&($7294$7305[0]==="NUM"))){(value$7323=$7294$7305[1]);return __lt____lt____colon__$7023(["value",value$7323],token$7299);}else{if(($7297$7314&&($7294$7305[0]==="STR"))){(value$7328=$7294$7305[1]);return __lt____lt____colon__$7023(["value",value$7328],token$7299);}else{if(($7295$7312&&((t0$7310===1)&&($7294$7305[0]==="VOID")))){return __lt____lt____colon__$7023(["void"],token$7299);}else{if(($7295$7312&&(t0$7310>=1))){(ops$7337=$7294$7305[0]);(args$7338=Array.prototype.slice.call($7294$7305,1));(sumloc$7356=ops$7337[0].location);;(temp$7368=ops$7337.slice(1));;($length$7373=temp$7368.length);;($index$7378=0);;$7359:for(;($index$7378<$length$7373);($index$7378++)){var op$7394;var m$7386;(m$7386=temp$7368[$index$7378]);;(op$7394=m$7386);(sumloc$7356=__plus____plus____colon__$7024(sumloc$7356,op$7394));}(temp$7398=args$7338);;($length$7403=temp$7398.length);;($index$7408=0);;$7361:for(;($index$7408<$length$7403);($index$7408++)){var arg$7424;var m$7416;(m$7416=temp$7398[$index$7408]);;(arg$7424=m$7416);(sumloc$7356=__plus____plus____colon__$7024(sumloc$7356,arg$7424));}(orig_ops$7357=ops$7337);;(ops$7337=(((acc$7432=[])),(((temp$7437=ops$7337)),((($length$7442=temp$7437.length)),((($index$7447=0)),function(){$7429:for(;($index$7447<$length$7442);($index$7447++)){var o$7463;var m$7455;(m$7455=temp$7437[$index$7447]);;(o$7463=m$7455);acc$7432.push(o$7463[2]);}}()))),acc$7432));(op$7358=ops$7337[0]);;($7342$7469=[ops$7337,args$7338]);;if((($7349$7485=($7342$7469 instanceof Array))&&((t0$7474=$7342$7469.length),(($7351$7487=(t0$7474===2))&&((t1$7475=$7342$7469[0]),(($7353$7489=(t1$7475 instanceof Array))&&((t2$7476=t1$7475.length),((t2$7476===2)&&((t1$7475[0]==="WHITE")&&((t1$7475[1]===":")&&((t3$7477=$7342$7469[1]),((t3$7477 instanceof Array)&&((t4$7478=t3$7477.length),(t4$7478===3)))))))))))))){(f$7494=t3$7477[0]);(arg$7495=t3$7477[1]);(body$7496=t3$7477[2]);return __lt____lt____colon__$7023(["send",f$7494,__lt____lt____colon__$7023(["data",arg$7495,body$7496],__plus____plus____colon__$7024(arg$7495,body$7496))],sumloc$7356);}else{if(($7353$7489&&(($7355$7491=(t2$7476===1))&&((t1$7475[0]===":")&&((t3$7477=$7342$7469[1]),((t3$7477 instanceof Array)&&((t4$7478=t3$7477.length),(t4$7478===2)))))))){(f$7506=t3$7477[0]);(body$7507=t3$7477[1]);return __lt____lt____colon__$7023(["send",f$7506,__lt____lt____colon__$7023(["data",body$7507],body$7507)],sumloc$7356);}else{if(($7355$7491&&((t1$7475[0]==="with")&&((t3$7477=$7342$7469[1]),((t3$7477 instanceof Array)&&((t4$7478=t3$7477.length),((t4$7478===2)&&((target$7514=t3$7477[0]),((t5$7479=t3$7477[1]),((_b$7515=t5$7479),((t6$7480=$8062(["multi"])(t5$7479)),(t6$7480[0]&&((t7$7481=t6$7480[1]),((t8$7482=t7$7481.length),(t8$7482>=0))))))))))))))){(body$7516=Array.prototype.slice.call(t7$7481,0));(inserted$7528=false);;(result$7529=transform$7025(target$7514,function($7535$7537){var t0$7543;var $index$7603;var $length$7598;var temp$7593;var tr$7581;var res$7582;var args$7576;var x$7564;var f$7565;var a$7566;var b$7567;var t0$7552;var t1$7553;var t2$7554;var $7539$7547;var ph$7540;var expr$7541;(t0$7543=$7535$7537);(expr$7541=t0$7543);(ph$7540=t0$7543);;($7539$7547=ph$7540);;if((($7539$7547 instanceof Array)&&((t0$7552=$7539$7547.length),((t0$7552===2)&&(($7539$7547[0]==="symbol")&&($7539$7547[1]==="...")))))){(inserted$7528=true);return __lt____lt____colon__$7023(["multi"].concat(body$7516),_b$7515);}else{(x$7564=$7539$7547);if((x$7564.fromop&&(($7539$7547 instanceof Array)&&((t0$7552=$7539$7547.length),((t0$7552===3)&&(($7539$7547[0]==="send")&&((f$7565=$7539$7547[1]),((t1$7553=$7539$7547[2]),((t1$7553 instanceof Array)&&((t2$7554=t1$7553.length),((t2$7554===3)&&(t1$7553[0]==="data")))))))))))){(a$7566=t1$7553[1]);(b$7567=t1$7553[2]);return ["send",this(f$7565),__lt____lt____colon__$7023(["data",this(a$7566),this(b$7567)],__plus____plus____colon__$7024(a$7566,b$7567))];}else{if((($7539$7547 instanceof Array)&&((t0$7552=$7539$7547.length),((t0$7552>=1)&&($7539$7547[0]==="data"))))){(args$7576=Array.prototype.slice.call($7539$7547,1));(tr$7581=this);;(res$7582=["data"]);;(temp$7593=args$7576);;($length$7598=temp$7593.length);;($index$7603=0);;$7583:for(;($index$7603<$length$7598);($index$7603++)){var other$7627;var t0$7616;var t1$7617;var m$7611;(m$7611=temp$7593[$index$7603]);;(t0$7616=m$7611);if(((t0$7616 instanceof Array)&&((t1$7617=t0$7616.length),((t1$7617===2)&&((t0$7616[0]==="symbol")&&(t0$7616[1]==="...")))))){(inserted$7528=true);(res$7582=res$7582.concat(body$7516));}else{(other$7627=m$7611);res$7582.push(__lt____lt____colon__$7023(tr$7581(other$7627),other$7627));}}return __lt____lt____colon__$7023(res$7582,expr$7541);}else{$7861($7539$7547);}}}}));;if((!inserted$7528)){($7632$7636=target$7514);;if((($7632$7636 instanceof Array)&&((t0$7641=$7632$7636.length),((t0$7641===1)&&($7632$7636[0]==="void"))))){return __lt____lt____colon__$7023(["data"].concat(body$7516),sumloc$7356);}else{$7632$7636;if(target$7514.fromop){return __lt____lt____colon__$7023(["send",target$7514,__lt____lt____colon__$7023(["data"].concat(body$7516),_b$7515)],sumloc$7356);}else{if((($7633$7645=($7632$7636 instanceof Array))&&((t0$7641=$7632$7636.length),((t0$7641===3)&&(($7632$7636[0]==="send")&&((f$7658=$7632$7636[1]),((t1$7642=$7632$7636[2]),((orig_args$7659=t1$7642),((t1$7642 instanceof Array)&&((t2$7643=t1$7642.length),((t2$7643>=1)&&(t1$7642[0]==="data")))))))))))){(args$7660=Array.prototype.slice.call(t1$7642,1));return __lt____lt____colon__$7023(["send",f$7658,__lt____lt____colon__$7023(["data"].concat(args$7660).concat(body$7516),__plus____plus____colon__$7024(orig_args$7659,_b$7515))],sumloc$7356);}else{if(($7633$7645&&((t0$7641>=1)&&($7632$7636[0]==="data")))){(args$7670=Array.prototype.slice.call($7632$7636,1));return __lt____lt____colon__$7023(target$7514.concat(body$7516),sumloc$7356);}else{(other$7675=$7632$7636);return __lt____lt____colon__$7023(["send",target$7514,__lt____lt____colon__$7023(["data"].concat(body$7516),_b$7515)],sumloc$7356);}}}}}else{return __lt____lt____colon__$7023(result$7529,sumloc$7356);}}else{if(($7353$7489&&(($7355$7491=(t2$7476>=1))&&((bridge$7343$7483=t1$7475[0]),((bridge$7343$7483==="[")||(bridge$7343$7483===",")))))){Array.prototype.slice.call(t1$7475,1);$7342$7469[1];if((op$7358==="[")){(args$7338=args$7338.slice(1,-1));}(args$7338=(((f$7686=function($7689$7691){var other$7713;var t0$7704;var $7693$7699;var ph$7694;(ph$7694=$7689$7691);;($7693$7699=ph$7694);;if((($7693$7699 instanceof Array)&&((t0$7704=$7693$7699.length),((t0$7704===1)&&($7693$7699[0]==="void"))))){return false;}else{(other$7713=$7693$7699);return true;}})),args$7338.filter(f$7686)));(result$7683=((($7718$7722=args$7338)),function(){if((($7719$7729=($7718$7722 instanceof Array))&&((t0$7727=$7718$7722.length),(t0$7727===0)))){return ["value",(void 0)];}else{if(($7719$7729&&(t0$7727===1))){(x$7738=$7718$7722[0]);if(((!isNaN(sumloc$7356.start))&&(!isNaN(sumloc$7356.end)))){(x$7738["location"]=sumloc$7356);}return x$7738;}else{(other$7745=$7718$7722);return ["multi"].concat(args$7338);}}}()));;return __lt____lt____colon__$7023(result$7683,sumloc$7356);}else{if(($7355$7491&&(t1$7475[0]==="{"))){Array.prototype.slice.call(t1$7475,1);$7342$7469[1];(f$7753=function($7756$7758){var other$7780;var t0$7771;var $7760$7766;var ph$7761;(ph$7761=$7756$7758);;($7760$7766=ph$7761);;if((($7760$7766 instanceof Array)&&((t0$7771=$7760$7766.length),((t0$7771===1)&&($7760$7766[0]==="void"))))){return false;}else{(other$7780=$7760$7766);return true;}});;return __lt____lt____colon__$7023(["data"].concat(args$7338.slice(1,-1).filter(f$7753)),sumloc$7356);}else{if(($7353$7489&&(($7355$7491=(t2$7476===1))&&(t1$7475[0]==="WHITE")))){$7342$7469[1];return __lt____lt____colon__$7023(["send"].concat(args$7338),sumloc$7356);}else{if($7355$7491){t1$7475[0];($7344$7789=$7342$7469[1]);(t0$7793=$7344$7789);if((($7346$7801=(t0$7793 instanceof Array))&&((t1$7794=t0$7793.length),(($7348$7803=(t1$7794===2))&&((t2$7795=t0$7793[0]),((t2$7795 instanceof Array)&&((t3$7796=t2$7795.length),((t3$7796===1)&&((t2$7795[0]==="void")&&((t4$7797=t0$7793[1]),((t4$7797 instanceof Array)&&((t5$7798=t4$7797.length),((t5$7798===1)&&(t4$7797[0]==="void")))))))))))))){return __lt____lt____colon__$7023(["symbol",op$7358],orig_ops$7357[0]);}else{if($7348$7803){(a$7815=t0$7793[0]);(b$7816=t0$7793[1]);(oloc$7820=orig_ops$7357[0].location);;(abloc$7821=__plus____plus____colon__$7024(a$7815,b$7816));;(oabloc$7822=__plus____plus____colon__$7024(orig_ops$7357[0],abloc$7821));;(rval$7823=__lt____lt____colon__$7023(["send",__lt____lt____colon__$7023(["symbol",op$7358],oloc$7820),__lt____lt____colon__$7023(["data",a$7815,b$7816],abloc$7821)],__plus____plus____colon__$7024(oloc$7820,abloc$7821)));;(rval$7823["fromop"]=true);return rval$7823;}else{$7861($7344$7789,"/home/olivier/git/earl-grey/src/parse.eg",9806,9811);}}}else{(other$7840=$7342$7469);throw $7874(["should_never_happen"]).create("unknown node",({"node":token$7299}));}}}}}}}}else{(other$7844=$7294$7305);throw $7874(["should_never_happen"]).create("unknown node (B)",({"node":token$7299}));}}}}}});;(parse$7037=function(tokens$7850){var next$7853;(next$7853=function(){return tokens$7850.shift();});;return oparse$7033(next$7853,order$7035,finalize$7036);});;(exports["parse"]=parse$7037);(exports["order"]=order$7035);(exports["oparse"]=oparse$7033);(exports["finalize"]=finalize$7036);(exports["DONE"]=DONE$7028);(exports["NONE"]=NONE$7029);(exports["LEFT"]=LEFT$7030);(exports["RIGHT"]=RIGHT$7031);(exports["BOTH"]=BOTH$7032);

},{"./location":7}],10:[function(require,module,exports){
var $8211=function(type$8213){var f$8216;(f$8216=type$8213["::check"]);;if((f$8216===(void 0))){return function(value$8221){return (value$8221 instanceof type$8213);};}else{return function(value$8224){return f$8216.call(type$8213,value$8224);};}};
var $8226=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $8227=function($8228$8230){var ph$8234;(ph$8234=$8228$8230);;var $8232$8239;($8232$8239=ph$8234);;var bridge$8233$8244;var x$8248;(bridge$8233$8244=$8232$8239);if((((typeof(bridge$8233$8244)==="string")&&((x$8248=bridge$8233$8244),true))||((typeof(bridge$8233$8244)==="number")&&((x$8248=bridge$8233$8244),true)))){return ["value",x$8248];}else{var other$8255;(other$8255=$8232$8239);return other$8255["::serialize_ast"]();}};
var send$8095;(send$8095=function(obj$8100,$8098$8101){var ph$8105;var msg$8106;var t0$8108;(t0$8108=$8098$8101);(msg$8106=t0$8108);(ph$8105=t0$8108);;var $8103$8112;($8103$8112=ph$8105);;var bridge$8104$8117;(bridge$8104$8117=$8103$8112);if(((typeof(bridge$8104$8117)==="string")||(typeof(bridge$8104$8117)==="number"))){return obj$8100[msg$8106];}else{var other$8125;(other$8125=$8103$8112);return obj$8100["::send"](msg$8106);}});;(Array[":::project"]=function($8128$8130){var ph$8133;var value$8134;var t0$8136;(t0$8136=$8128$8130);(value$8134=t0$8136);(ph$8133=t0$8136);;var $8132$8140;($8132$8140=ph$8133);;if($8211(Array)($8132$8140)){return [true,value$8134];}else{$8132$8140;return [true,[value$8134]];}});(Array.prototype["::check"]=function(value$8154){if((value$8154 instanceof Array)){var i$8159;(i$8159=0);;$8157:for(;(i$8159<this.length);(i$8159++)){if(($8226(this,i$8159)!==$8226(value$8154,i$8159))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$8170){if((value$8170 instanceof Array)){var i$8175;(i$8175=0);;$8173:for(;(i$8175<this.length);(i$8175++)){if(($8226(this,i$8175)!==$8226(value$8170,i$8175))){return [true,[value$8170]];}}return [true,value$8170.slice(this.length)];}else{return [true,[value$8170]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($8227));});(RegExp.prototype["::check"]=function(value$8186){return value$8186.match(this);});(RegExp.prototype[":::project"]=function(value$8189){var $8191$8193;($8191$8193=value$8189.match(this));;var m$8201;if(($8191$8193===null)){(m$8201=$8191$8193);return [false,null];}else{var m$8206;(m$8206=$8191$8193);return [true,m$8206];}});(Function.prototype["::send"]=function(args$8209){return this.apply(this,args$8209);});
var $11166=function(arr$11168){var results$11172;var l$11173;(results$11172=[]);;(l$11173=arr$11168.length);;var i$11181;(i$11181=0);;$11171:for(;(i$11181<l$11173);(i$11181++)){results$11172.push([i$11181,$8226(arr$11168,i$11181)]);}return results$11172;};
var $11188=function(value$11190,url$11191,start$11192,end$11193){var err$11196;(err$11196=$11012(["match"]).create("Could not find a match for value",({"value":value$11190})));;if(url$11191){(err$11196["location"]=["location",url$11191,start$11192,end$11193]);}throw err$11196;};
var $11201=function(dest$11203,values$11204){var k$11209;(k$11209=null);$11207:for(k$11209 in values$11204){if(values$11204.hasOwnProperty(k$11209)){(dest$11203[k$11209]=values$11204[k$11209]);}}return dest$11203;};
var $11012=function(){var $11013$11015;($11013$11015=function(tags$11019){var it$0$11022;(it$0$11022=function(){if((!$8211($11013$11015)(this))){return Object.create($11013$11015.prototype);}else{return this;}}());;(it$0$11022["tags"]=tags$11019);return it$0$11022;});;($11013$11015.prototype["create"]=function(){var $11031$11033;($11031$11033=arguments);;var t0$11038;var message$11042;var args$11043;(t0$11038=$11031$11033.length);if((t0$11038>=0)){(message$11042=function(){if((0>=t0$11038)){return "";}else{return $11031$11033[0];}}());(args$11043=Array.prototype.slice.call($11031$11033,1));var it$0$11047;(it$0$11047=this);;var e$11052;(e$11052=Error(message$11042));;(e$11052["::tags"]=it$0$11047.tags);(e$11052["args"]=args$11043);var temp$11060;(temp$11060=$11166(args$11043));;var $length$11065;($length$11065=temp$11060.length);;var $index$11070;($index$11070=0);;$11053:for(;($index$11070<$length$11065);($index$11070++)){var m$11078;(m$11078=temp$11060[$index$11070]);;var t0$11083;var t1$11084;var i$11088;var arg$11089;(t0$11083=m$11078);if(((t0$11083 instanceof Array)&&((t1$11084=t0$11083.length),(t1$11084===2)))){(i$11088=t0$11083[0]);(arg$11089=t0$11083[1]);(e$11052[i$11088]=arg$11089);}else{$11188(m$11078);;}}(e$11052["length"]=args$11043.length);(e$11052["name"]=["E"].concat(it$0$11047.tags).join("."));return e$11052;}else{$11188($11031$11033);}});($11013$11015.prototype["::check"]=function(e$11100){var it$0$11103;(it$0$11103=this);;var tags$11108;if(((!e$11100)||(!$8211(Error)(e$11100)))){return false;}(tags$11108=(e$11100["::tags"]||[]));;var temp$11117;(temp$11117=it$0$11103.tags);;var $length$11122;($length$11122=temp$11117.length);;var $index$11127;($index$11127=0);;$11109:for(;($index$11127<$length$11122);($index$11127++)){var m$11135;(m$11135=temp$11117[$index$11127]);;var tag$11143;(tag$11143=m$11135);if((tags$11108.indexOf(tag$11143)===-1)){return false;}else{false;;}}return true;});($11013$11015.prototype["::deconstruct"]=function(e$11151){var it$0$11154;(it$0$11154=this);;return e$11151.args;});$11201($11013$11015,$11201(function(){var accum$11159;(accum$11159=({}));(accum$11159["::name"]="$11013");return accum$11159;}(),function(){var accum$11163;(accum$11163=({}));(accum$11163["::egclass"]=true);return accum$11163;}()));return $11013$11015;}();
var $11213=function($11214$11216,key$11217){var ph$11221;(ph$11221=$11214$11216);;var $11219$11226;($11219$11226=ph$11221);;var bridge$11220$11231;(bridge$11220$11231=$11219$11226);if(((bridge$11220$11231===null)||(bridge$11220$11231===(void 0)))){return false;}else{var x$11239;if((typeof($11219$11226)==="string")){(x$11239=$11219$11226);return (key$11217 in String.prototype);}else{var x$11244;if((typeof($11219$11226)==="number")){(x$11244=$11219$11226);return (key$11217 in Number.prototype);}else{var x$11249;(x$11249=$11219$11226);return (key$11217 in x$11249);}}}};
var $11267=function($11268$11270){var ph$11276;var x$11277;var t0$11279;(t0$11279=$11268$11270);(x$11277=t0$11279);(ph$11276=t0$11279);;var $11272$11283;($11272$11283=ph$11276);;var bridge$11273$11288;(bridge$11273$11288=$11272$11283);if((function(){var bridge$11274$11294;(bridge$11274$11294=bridge$11273$11288);return (function(){var bridge$11275$11297;(bridge$11275$11297=bridge$11274$11294);return ((bridge$11275$11297===(void 0))||(bridge$11275$11297===null));}()||(typeof(bridge$11274$11294)==="string"));}()||(typeof(bridge$11273$11288)==="number"))){return x$11277;}else{if($11213($11272$11283,"::clone")){$11272$11283["::clone"];return x$11277["::clone"]();}else{$11272$11283;if((Object.getPrototypeOf(x$11277)===Object.prototype)){var dest$11310;(dest$11310=({}));;var k$11315;(k$11315=null);$11309:for(k$11315 in x$11277){if(Object.prototype.hasOwnProperty.call(x$11277,k$11315)){(dest$11310[k$11315]=x$11277[k$11315]);}}return dest$11310;}else{var other$11321;(other$11321=$11272$11283);throw $11012(["clone"]).create("Object cannot be cloned",({"obj":x$11277}));}}}};
var $11251=function(a$11253,b$11254){var dest$11258;(dest$11258=$11267(a$11253));;var k$11263;(k$11263=null);$11257:for(k$11263 in b$11254){if(Object.prototype.hasOwnProperty.call(b$11254,k$11263)){(dest$11258[k$11263]=b$11254[k$11263]);}}return dest$11258;};
var $11323=function(type$11325){return function(value$11328){var f$11331;(f$11331=type$11325[":::project"]);;if((f$11331===(void 0))){var f$11336;(f$11336=type$11325["::project"]);;if((f$11336===(void 0))){return [true,type$11325(value$11328)];}else{var rval$11341;(rval$11341=false);;try{(rval$11341=[true,f$11336(value$11328)]);}catch(excv$11347){var e$11353;(e$11353=excv$11347);(rval$11341=[false,null]);}return rval$11341;}}else{return f$11331.call(type$11325,value$11328);}};};
var $11355=function(from$11357,to$11358){var rval$11362;(rval$11362=[]);;var i$11367;(i$11367=from$11357);;$11361:for(;(i$11367<=to$11358);(i$11367++)){rval$11362.push(i$11367);}return rval$11362;};var accum$8970;var accum$8974;var accum$9556;var accum$9560;var $8258$8262;var __lt____gt__$8263;var $8259$8264;var __lt____lt____colon__$8265;var util$8266;var GenSym$8267;var gensym$8268;var zip$8269;var enumerate$8270;var iterkeys$8271;var neighbours$8272;var classify$8273;var classify_contiguous$8274;var identity$8275;var $8261$8276;var checker_db$8277;var PatternParser$8278;var PatternProcessor$8279;var assemble_conditions$8280;var assemble_pattern$8281;var inject_below_uses$8282;var parse_pattern$8283;var checkall$8284;var same_block$8285;var parse_clauses$8286;var opt_clauses$8287;var weave_clauses$8288;($8258$8262=require("./pp"));;(__lt____gt__$8263=$8258$8262["<>"]);;($8259$8264=require("./location"));;(__lt____lt____colon__$8265=$8259$8264["<<:"]);;(util$8266=require("./util"));;(GenSym$8267=util$8266.GenSym);;(gensym$8268=util$8266.gensym);;(zip$8269=util$8266.zip);;(enumerate$8270=util$8266.enumerate);;(iterkeys$8271=util$8266.keys);;(neighbours$8272=util$8266.neighbours);;(classify$8273=util$8266.classify);;(classify_contiguous$8274=util$8266.classify_contiguous);;(identity$8275=util$8266.identity);;($8261$8276=require("./expand"));;(checker_db$8277=$8261$8276.checker_db);;(PatternParser$8278=function(scope$8340,pattern$8341,opt$8342){var it$0$8345;(it$0$8345=function(){if((!$8211(PatternParser$8278)(this))){return Object.create(PatternParser$8278.prototype);}else{return this;}}());;(it$0$8345["opt"]=opt$8342);(it$0$8345["arguments"]=[]);(it$0$8345["vars"]=[]);(it$0$8345["specials"]=({}));(it$0$8345["pattern"]=it$0$8345.expand(scope$8340,pattern$8341,true,it$0$8345.opt.indexable));return it$0$8345;});;(PatternParser$8278.prototype["parse_specs"]=function(scope$8355,specs$8356){var $index$8397;var $length$8392;var temp$8387;var acc$8382;var rest$8364;var has_defaults$8365;var rval$8366;var it$0$8359;(it$0$8359=this);;(rest$8364=(void 0));;(has_defaults$8365=false);;(rval$8366=classify$8273("fw","bw","keys","defaults",(((acc$8382=[])),(((temp$8387=scope$8355.step_all(["pattern"],specs$8356))),((($length$8392=temp$8387.length)),((($index$8397=0)),function(){$8375:for(;($index$8397<$length$8392);($index$8397++)){var v$8449;var v$8444;var variable$8437;var value$8438;var key$8431;var subp$8432;var key$8426;var variable$8419;var $8377$8413;var $8378$8414;var $8379$8415;var $8380$8416;var t0$8410;var t1$8411;var m$8405;(m$8405=temp$8387[$index$8397]);;(t0$8410=m$8405);if((($8378$8414=(t0$8410 instanceof Array))&&((t1$8411=t0$8410.length),(($8380$8416=(t1$8411===2))&&(t0$8410[0]==="dynsplice"))))){(variable$8419=t0$8410[1]);acc$8382.push(((rest$8364=it$0$8359.expand(scope$8355,variable$8419)),["ignore"]));}else{if(($8380$8416&&(t0$8410[0]==="assoc"))){(key$8426=t0$8410[1]);acc$8382.push(["keys",[key$8426,it$0$8359.expand(scope$8355,key$8426)]]);}else{if(($8378$8414&&(($8380$8416=(t1$8411===3))&&(t0$8410[0]==="assoc")))){(key$8431=t0$8410[1]);(subp$8432=t0$8410[2]);acc$8382.push(["keys",[key$8431,it$0$8359.expand(scope$8355,subp$8432)]]);}else{if(($8380$8416&&(t0$8410[0]==="default"))){(variable$8437=t0$8410[1]);(value$8438=t0$8410[2]);acc$8382.push(((has_defaults$8365=true),function(){if(rest$8364){throw $11012(["syntax","pattern"]).create("No default arguments after rest arg.");}else{return ["defaults",[it$0$8359.expand(scope$8355,variable$8437),value$8438]];}}()));}else{(v$8444=m$8405);if(((rest$8364===(void 0))&&(!has_defaults$8365))){acc$8382.push(["fw",it$0$8359.expand(scope$8355,v$8444)]);}else{(v$8449=m$8405);acc$8382.push(["bw",it$0$8359.expand(scope$8355,v$8449)]);}}}}}}}()))),acc$8382)));;(rval$8366["rest"]=rest$8364);return rval$8366;});(PatternParser$8278.prototype["expand"]=function(){var x$8509;var x$8518;var x$8534;var x$8539;var msg$8585;var x$8597;var msg$8610;var msg$8619;var $index$8652;var $length$8647;var temp$8642;var acc$8637;var $index$8756;var $length$8751;var temp$8746;var acc$8741;var $index$8787;var $length$8782;var temp$8777;var t0$8848;var t1$8849;var t2$8850;var $index$8878;var $length$8873;var temp$8868;var acc$8863;var patts$8857;var canon$8676;var normalize$8677;var pps$8678;var vars$8679;var patt$8937;var msg$8958;var other$8955;var keys$8943;var fw$8925;var bw$8926;var defaults$8927;var rest$8928;var $8904$8922;var t0$8915;var t1$8916;var t2$8917;var t3$8918;var t4$8919;var t5$8920;var $8903$8910;var specs$8905;var other$8964;var args$8899;var xs$8672;var xs$8631;var x$8625;var f$8605;var arg$8606;var f$8591;var arguments$8592;var f$8578;var arg$8579;var checker$8572;var subp$8573;var projector$8566;var subp$8567;var condition$8560;var subp$8561;var v$8555;var v$8547;var type$8525;var $8487$8501;var $8488$8502;var $8489$8503;var $8490$8504;var t0$8497;var bridge$8486$8498;var t1$8499;var $8485$8492;var expr$8478;var rval$8479;var it$0$8473;var scope$8466;var pattern$8467;var toplevel$8468;var checked$8469;var t0$8462;var $8455$8457;($8455$8457=arguments);;(t0$8462=$8455$8457.length);if(((t0$8462>=2)&&(t0$8462<=4))){(scope$8466=$8455$8457[0]);(pattern$8467=$8455$8457[1]);(toplevel$8468=function(){if((2>=t0$8462)){return false;}else{return $8455$8457[2];}}());(checked$8469=function(){if((3>=t0$8462)){return false;}else{return $8455$8457[3];}}());(it$0$8473=this);;(expr$8478=scope$8466.step(["pattern"],pattern$8467));;(rval$8479=((($8485$8492=expr$8478)),function(){if((((x$8509=$8485$8492)),((x$8509 instanceof Array)&&(x$8509[0]==="void")))){return ["check",checker_db$8277.null,["ignore"]];}else{if((((x$8518=$8485$8492)),((x$8518 instanceof Array)&&(x$8518[0]==="ignore")))){return expr$8478;}else{if((($8485$8492 instanceof Array)&&((t0$8497=$8485$8492.length),((t0$8497===2)&&($8485$8492[0]==="special"))))){(type$8525=$8485$8492[1]);(it$0$8473.specials[type$8525]=true);return expr$8478;}else{(bridge$8486$8498=$8485$8492);if(((((x$8534=bridge$8486$8498)),((x$8534 instanceof Array)&&(x$8534[0]==="symbol")))||(((x$8539=bridge$8486$8498)),((x$8539 instanceof Array)&&(x$8539[0]==="variable"))))){it$0$8473.vars.push(expr$8478);return ["assign",expr$8478];}else{if((($8487$8501=($8485$8492 instanceof Array))&&((t0$8497=$8485$8492.length),(($8489$8503=(t0$8497===2))&&(($8490$8504=($8485$8492[0]==="value"))&&((v$8547=$8485$8492[1]),it$0$8473.opt.strings_as_variables)))))){it$0$8473.vars.push(expr$8478);return ["assign",expr$8478];}else{if($8490$8504){(v$8555=$8485$8492[1]);return ["check",checker_db$8277(v$8555),["ignore"]];}else{if(($8487$8501&&(($8489$8503=(t0$8497===3))&&($8485$8492[0]==="test")))){(condition$8560=$8485$8492[1]);(subp$8561=$8485$8492[2]);return ["test",condition$8560,it$0$8473.expand(scope$8466,subp$8561,toplevel$8468,false)];}else{if(($8489$8503&&($8485$8492[0]==="project"))){(projector$8566=$8485$8492[1]);(subp$8567=$8485$8492[2]);return ["project",projector$8566,it$0$8473.expand(scope$8466,subp$8567,toplevel$8468,true)];}else{if(($8489$8503&&($8485$8492[0]==="check"))){(checker$8572=$8485$8492[1]);(subp$8573=$8485$8492[2]);return ["check",checker$8572,it$0$8473.expand(scope$8466,subp$8573,toplevel$8468,true)];}else{if(($8489$8503&&(($8490$8504=($8485$8492[0]==="send"))&&((f$8578=$8485$8492[1]),((arg$8579=$8485$8492[2]),(!toplevel$8468)))))){(msg$8585="Function arguments can only be declared as a top level pattern.");;throw $11012(["syntax","pattern"]).create(msg$8585,({"node":expr$8478,"arg":arg$8579}));}else{if(($8490$8504&&((f$8591=$8485$8492[1]),((t1$8499=$8485$8492[2]),(((x$8597=t1$8499)),((x$8597 instanceof Array)&&(x$8597[0]==="data"))))))){(arguments$8592=t1$8499);it$0$8473.arguments.unshift(arguments$8592);return it$0$8473.expand(scope$8466,f$8591,true,false);}else{if($8490$8504){(f$8605=$8485$8492[1]);(arg$8606=$8485$8492[2]);(msg$8610=["Function must be declared with an array of arguments","(did you mean to use ':='?)"].join(" "));;throw $11012(["syntax","pattern"]).create(msg$8610,({"node":expr$8478,"arg":arg$8606}));}else{$8485$8492;if((!it$0$8473.opt.allow_nested)){(msg$8619="Nested patterns are not allowed here.");;throw $11012(["syntax","pattern"]).create(msg$8619,({"node":expr$8478}));}else{if((($8487$8501=($8485$8492 instanceof Array))&&((t0$8497=$8485$8492.length),((t0$8497===2)&&($8485$8492[0]==="neg"))))){(x$8625=$8485$8492[1]);return ["neg",it$0$8473.expand(scope$8466,x$8625)];}else{if(($8487$8501&&(($8489$8503=(t0$8497>=1))&&($8485$8492[0]==="all")))){(xs$8631=Array.prototype.slice.call($8485$8492,1));return ["all"].concat((((acc$8637=[])),(((temp$8642=xs$8631)),((($length$8647=temp$8642.length)),((($index$8652=0)),function(){$8634:for(;($index$8652<$length$8647);($index$8652++)){var x$8668;var m$8660;(m$8660=temp$8642[$index$8652]);;(x$8668=m$8660);acc$8637.push(it$0$8473.expand(scope$8466,x$8668));}}()))),acc$8637));}else{if(($8489$8503&&($8485$8492[0]==="any"))){(xs$8672=Array.prototype.slice.call($8485$8492,1));(canon$8676=function(all$8685){return all$8685.sort().join(",");});;(normalize$8677=function(vars$8691){var $index$8711;var $length$8706;var temp$8701;var acc$8696;return canon$8676((((acc$8696=[])),(((temp$8701=vars$8691)),((($length$8706=temp$8701.length)),((($index$8711=0)),function(){$8693:for(;($index$8711<$length$8706);($index$8711++)){var v$8729;var t0$8724;var t1$8725;var m$8719;(m$8719=temp$8701[$index$8711]);;(t0$8724=m$8719);if(((t0$8724 instanceof Array)&&((t1$8725=t0$8724.length),((t1$8725===2)&&(t0$8724[0]==="symbol"))))){(v$8729=t0$8724[1]);acc$8696.push(v$8729);}else{$11188(m$8719,"/home/olivier/git/earl-grey/src/pattern.eg",3447,3504);;}}}()))),acc$8696));});;(pps$8678=(((acc$8741=[])),(((temp$8746=xs$8672)),((($length$8751=temp$8746.length)),((($index$8756=0)),function(){$8738:for(;($index$8756<$length$8751);($index$8756++)){var x$8772;var m$8764;(m$8764=temp$8746[$index$8756]);;(x$8772=m$8764);acc$8741.push(PatternParser$8278(scope$8466,x$8772,it$0$8473.opt));}}()))),acc$8741));;(temp$8777=neighbours$8272(pps$8678));;($length$8782=temp$8777.length);;($index$8787=0);;$8680:for(;($index$8787<$length$8782);($index$8787++)){var $index$8825;var $length$8820;var temp$8815;var pp1$8805;var pp2$8806;var t0$8800;var t1$8801;var m$8795;(m$8795=temp$8777[$index$8787]);;(t0$8800=m$8795);if(((t0$8800 instanceof Array)&&((t1$8801=t0$8800.length),(t1$8801===2)))){(pp1$8805=t0$8800[0]);(pp2$8806=t0$8800[1]);(temp$8815=pps$8678);;($length$8820=temp$8815.length);;($index$8825=0);;$8811:for(;($index$8825<$length$8820);($index$8825++)){var pp$8841;var m$8833;(m$8833=temp$8815[$index$8825]);;(pp$8841=m$8833);normalize$8677(pp$8841.vars);}if((normalize$8677(pp1$8805.vars)!==normalize$8677(pp2$8806.vars))){throw $11012(["syntax","pattern"]).create("Both branches of 'or' must contain the same variables",({"vars1":__lt____lt____colon__$8265(pp1$8805.vars.sort(),pp1$8805.pattern),"vars2":__lt____lt____colon__$8265(pp2$8806.vars.sort(),pp2$8806.pattern)}));}if((canon$8676(iterkeys$8271(pp1$8805.specials))!==canon$8676(iterkeys$8271(pp2$8806.specials)))){throw $11012(["syntax","pattern"]).create("Both branches of 'or' must contain the same special tokens",({"special1":__lt____lt____colon__$8265(iterkeys$8271(pp1$8805.specials).sort(),pp1$8805.pattern),"special2":__lt____lt____colon__$8265(iterkeys$8271(pp2$8806.specials).sort(),pp2$8806.pattern)}));}}else{$11188(m$8795,"/home/olivier/git/earl-grey/src/pattern.eg",3580,4393);;}}(t0$8848=pps$8678);if(((t0$8848 instanceof Array)&&((t1$8849=t0$8848.length),((t1$8849>=1)&&((t2$8850=t0$8848[0]),$11213(t2$8850,"vars")))))){(vars$8679=t2$8850.vars);Array.prototype.slice.call(t0$8848,1);;}else{$11188(pps$8678,"/home/olivier/git/earl-grey/src/pattern.eg",4410,4413);}(it$0$8473["vars"]=it$0$8473.vars.concat(vars$8679));(patts$8857=(((acc$8863=[])),(((temp$8868=pps$8678)),((($length$8873=temp$8868.length)),((($index$8878=0)),function(){$8860:for(;($index$8878<$length$8873);($index$8878++)){var pp$8894;var m$8886;(m$8886=temp$8868[$index$8878]);;(pp$8894=m$8886);acc$8863.push(pp$8894.pattern);}}()))),acc$8863));;return ["any"].concat(patts$8857);}else{if(($8489$8503&&($8485$8492[0]==="data"))){(args$8899=Array.prototype.slice.call($8485$8492,1));(specs$8905=it$0$8473.parse_specs(scope$8466,args$8899));;($8903$8910=specs$8905);;if((($8904$8922=$11213($8903$8910,"keys"))&&((t0$8915=$8903$8910.keys),((t0$8915 instanceof Array)&&((t1$8916=t0$8915.length),((t1$8916===0)&&($11213($8903$8910,"fw")&&((fw$8925=$8903$8910.fw),($11213($8903$8910,"bw")&&((bw$8926=$8903$8910.bw),($11213($8903$8910,"defaults")&&((defaults$8927=$8903$8910.defaults),$11213($8903$8910,"rest"))))))))))))){(rest$8928=$8903$8910.rest);(patt$8937=__lt____lt____colon__$8265(["array_pattern",fw$8925,bw$8926,defaults$8927,rest$8928],pattern$8467));;if(checked$8469){return patt$8937;}else{return ["check",checker_db$8277.Array,patt$8937];}}else{if(($8904$8922&&((keys$8943=$8903$8910.keys),($11213($8903$8910,"fw")&&((t0$8915=$8903$8910.fw),((t0$8915 instanceof Array)&&((t1$8916=t0$8915.length),((t1$8916===0)&&($11213($8903$8910,"bw")&&((t2$8917=$8903$8910.bw),((t2$8917 instanceof Array)&&((t3$8918=t2$8917.length),((t3$8918===0)&&($11213($8903$8910,"defaults")&&((t4$8919=$8903$8910.defaults),((t4$8919 instanceof Array)&&((t5$8920=t4$8919.length),((t5$8920===0)&&($11213($8903$8910,"rest")&&($8903$8910.rest===(void 0))))))))))))))))))))){return ["object_pattern"].concat(keys$8943);}else{(other$8955=$8903$8910);(msg$8958="Pattern must be an array or an object.");;throw $11012(["syntax","pattern"]).create(msg$8958,({"node":expr$8478,"specs":specs$8905}));}}}else{(other$8964=$8485$8492);throw $11012(["syntax","pattern"]).create("Illegal pattern",({"node":other$8964}));}}}}}}}}}}}}}}}}}}()));;return (it$0$8473.opt.wrap_pattern||identity$8275)(__lt____lt____colon__$8265(rval$8479,pattern$8467),toplevel$8468);}else{$11188($8455$8457);}});$11201(PatternParser$8278,$11201(((accum$8970=({})),((accum$8970["::name"]="PatternParser"),accum$8970)),((accum$8974=({})),((accum$8974["::egclass"]=true),accum$8974))));PatternParser$8278;(PatternProcessor$8279=function(){var it$0$8982;(it$0$8982=function(){if((!$8211(PatternProcessor$8279)(this))){return Object.create(PatternProcessor$8279.prototype);}else{return this;}}());;(it$0$8982["temps"]=[]);(it$0$8982["parts"]=[]);(it$0$8982["gen"]=GenSym$8267("t"));return it$0$8982;});;(PatternProcessor$8279.prototype["do"]=function(part$8992){var it$0$8995;(it$0$8995=this);;return it$0$8995.parts.push(["do",part$8992]);});(PatternProcessor$8279.prototype["check"]=function(){var it$0$9018;var part$9013;var tags$9014;var t0$9009;var $9002$9004;($9002$9004=arguments);;(t0$9009=$9002$9004.length);if(((t0$9009>=1)&&(t0$9009<=2))){(part$9013=$9002$9004[0]);(tags$9014=function(){if((1>=t0$9009)){return ({});}else{return $9002$9004[1];}}());(it$0$9018=this);;return it$0$9018.parts.push($11251(["check",part$9013],tags$9014));}else{$11188($9002$9004);}});(PatternProcessor$8279.prototype["temp"]=function(){var x$9061;var x$9066;var init$9073;var bridge$9044$9055;var $9043$9050;var it$0$9045;var x$9038;var v$9039;var t0$9034;var $9027$9029;($9027$9029=arguments);;(t0$9034=$9027$9029.length);if(((t0$9034>=1)&&(t0$9034<=2))){(x$9038=$9027$9029[0]);(v$9039=function(){if((1>=t0$9034)){return null;}else{return $9027$9029[1];}}());(it$0$9045=this);;($9043$9050=x$9038);;(bridge$9044$9055=$9043$9050);if((((((x$9061=bridge$9044$9055)),((x$9061 instanceof Array)&&(x$9061[0]==="variable")))||(((x$9066=bridge$9044$9055)),((x$9066 instanceof Array)&&(x$9066[0]==="symbol"))))&&($11213($9043$9050,"single_assignment")&&($9043$9050.single_assignment&&(!v$9039))))){return x$9038;}else{(init$9073=$9043$9050);(v$9039=(v$9039||["symbol",it$0$9045.gen()]));(v$9039["single_assignment"]=true);it$0$9045.temps.push(v$9039);it$0$9045.do(["send",["symbol",":="],["data",v$9039,init$9073]]);return v$9039;}}else{$11188($9027$9029);}});(PatternProcessor$8279.prototype["process"]=function(pattern$9081,rhs$9082,fns$9083){var x$9115;var x$9144;var t$9156;var t$9167;var pp$9177;var $index$9205;var $length$9200;var temp$9195;var t$9187;var $index$9263;var $length$9258;var temp$9253;var acc$9248;var fn$9234;var parts$9235;var t$9229;var $index$9315;var $length$9310;var temp$9305;var acc$9300;var t$9293;var otherwise$9414;var $9396$9398;var $index$9428;var $length$9423;var temp$9418;var $index$9465;var $length$9460;var temp$9455;var end$9507;var pos$9502;var $index$9527;var $length$9522;var temp$9517;var acc$9512;var nfw$9354;var nbw$9355;var ndflt$9356;var extract_length$9357;var check_length$9358;var lo$9359;var hi$9360;var t$9361;var len$9362;var fw$9347;var bw$9348;var dflt$9349;var rest$9350;var subp$9289;var xs$9225;var xs$9183;var patt$9173;var projector$9162;var subp$9163;var checker$9151;var subp$9152;var checker$9140;var condition$9133;var subp$9134;var kind$9128;var sym$9122;var $9095$9107;var $9096$9108;var $9097$9109;var $9098$9110;var t0$9105;var $9094$9100;var rval$9091;var it$0$9086;(it$0$9086=this);;(rval$9091=((($9094$9100=pattern$9081)),function(){if((((x$9115=$9094$9100)),((x$9115 instanceof Array)&&(x$9115[0]==="ignore")))){return it$0$9086.do(rhs$9082);}else{if((($9095$9107=($9094$9100 instanceof Array))&&((t0$9105=$9094$9100.length),(($9097$9109=(t0$9105===2))&&($9094$9100[0]==="assign"))))){(sym$9122=$9094$9100[1]);return it$0$9086.parts.push(fns$9083.assign(sym$9122,rhs$9082));}else{if(($9097$9109&&($9094$9100[0]==="special"))){(kind$9128=$9094$9100[1]);return it$0$9086.process(fns$9083.special(pattern$9081,rhs$9082),rhs$9082,fns$9083);}else{if(($9095$9107&&(($9097$9109=(t0$9105===3))&&($9094$9100[0]==="test")))){(condition$9133=$9094$9100[1]);(subp$9134=$9094$9100[2]);it$0$9086.process(subp$9134,rhs$9082,fns$9083);return it$0$9086.check(condition$9133,({"test":true}));}else{if(($9097$9109&&(($9098$9110=($9094$9100[0]==="check"))&&((checker$9140=$9094$9100[1]),(((x$9144=$9094$9100[2])),((x$9144 instanceof Array)&&(x$9144[0]==="ignore"))))))){return it$0$9086.check(["send",checker$9140,["data",rhs$9082]]);}else{if($9098$9110){(checker$9151=$9094$9100[1]);(subp$9152=$9094$9100[2]);(t$9156=it$0$9086.temp(rhs$9082));;it$0$9086.check(["send",checker$9151,["data",t$9156]]);return it$0$9086.process(subp$9152,t$9156,fns$9083);}else{if(($9097$9109&&($9094$9100[0]==="project"))){(projector$9162=$9094$9100[1]);(subp$9163=$9094$9100[2]);(t$9167=it$0$9086.temp(["send",projector$9162,["data",rhs$9082]]));;it$0$9086.check(["send",t$9167,["value",0]]);return it$0$9086.process(subp$9163,["send",t$9167,["value",1]],fns$9083);}else{if(($9095$9107&&((t0$9105===2)&&($9094$9100[0]==="neg")))){(patt$9173=$9094$9100[1]);return it$0$9086.check(["send",["symbol","not"],["data",["void"],(((pp$9177=PatternProcessor$8279())),pp$9177.process(patt$9173,rhs$9082,fns$9083),assemble_conditions$8280(pp$9177))]]);}else{if(($9095$9107&&(($9097$9109=(t0$9105>=1))&&($9094$9100[0]==="all")))){(xs$9183=Array.prototype.slice.call($9094$9100,1));(t$9187=it$0$9086.temp(rhs$9082));;(temp$9195=xs$9183);;($length$9200=temp$9195.length);;($index$9205=0);;$9188:for(;($index$9205<$length$9200);($index$9205++)){var x$9221;var m$9213;(m$9213=temp$9195[$index$9205]);;(x$9221=m$9213);it$0$9086.process(x$9221,t$9187,fns$9083);}return null;}else{if(($9097$9109&&($9094$9100[0]==="any"))){(xs$9225=Array.prototype.slice.call($9094$9100,1));(t$9229=it$0$9086.temp(rhs$9082,["symbol",gensym$8268("bridge")]));;return it$0$9086.check((((fn$9234=function(x$9239,rest$9240){return ["send",["symbol","or"],["data",x$9239,rest$9240]];})),((parts$9235=(((acc$9248=[])),(((temp$9253=xs$9225)),((($length$9258=temp$9253.length)),((($index$9263=0)),function(){$9245:for(;($index$9263<$length$9258);($index$9263++)){var pp$9282;var x$9279;var m$9271;(m$9271=temp$9253[$index$9263]);;(x$9279=m$9271);acc$9248.push((((pp$9282=PatternProcessor$8279())),pp$9282.process(x$9279,t$9229,fns$9083),assemble_conditions$8280(pp$9282)));}}()))),acc$9248))),util$8266.construct(parts$9235,fn$9234,["symbol","false"])));}else{if(($9097$9109&&($9094$9100[0]==="object_pattern"))){(subp$9289=Array.prototype.slice.call($9094$9100,1));(t$9293=it$0$9086.temp(rhs$9082));;(acc$9300=[]);;(temp$9305=subp$9289);;($length$9310=temp$9305.length);;($index$9315=0);;$9294:for(;($index$9315<$length$9310);($index$9315++)){var k$9335;var v$9336;var t0$9328;var t1$9329;var t2$9330;var t3$9331;var m$9323;(m$9323=temp$9305[$index$9315]);;(t0$9328=m$9323);if(((t0$9328 instanceof Array)&&((t1$9329=t0$9328.length),((t1$9329===2)&&((t2$9330=t0$9328[0]),((t2$9330 instanceof Array)&&((t3$9331=t2$9330.length),((t3$9331===2)&&(t2$9330[0]==="value"))))))))){(k$9335=t2$9330[1]);(v$9336=t0$9328[1]);acc$9300.push((it$0$9086.check(["send",["symbol","___hasprop"],["data",t$9293,["value",k$9335]]]),it$0$9086.process(v$9336,["send",t$9293,["value",k$9335]],fns$9083)));}else{$11188(m$9323,"/home/olivier/git/earl-grey/src/pattern.eg",7617,7749);;}}return acc$9300;}else{if(($9095$9107&&((t0$9105===5)&&($9094$9100[0]==="array_pattern")))){(fw$9347=$9094$9100[1]);(bw$9348=$9094$9100[2]);(dflt$9349=$9094$9100[3]);(rest$9350=$9094$9100[4]);(nfw$9354=fw$9347.length);;(nbw$9355=bw$9348.length);;(ndflt$9356=dflt$9349.length);;(extract_length$9357=true);;(check_length$9358=true);;(lo$9359=(nfw$9354+nbw$9355));;(hi$9360=(lo$9359+ndflt$9356));;(t$9361=it$0$9086.temp(rhs$9082));;(len$9362=it$0$9086.temp(["send",t$9361,["send",["symbol","."],["data",["void"],["symbol","length"]]]]));;it$0$9086.check(((($9396$9398=rest$9350)),function(){if($9396$9398){return ["send",["symbol",">="],["data",len$9362,["value",lo$9359]]];}else{$9396$9398;if((lo$9359===hi$9360)){return ["send",["symbol","==="],["data",len$9362,["value",lo$9359]]];}else{(otherwise$9414=$9396$9398);return ["send",["symbol","and"],["data",["send",["symbol",">="],["data",len$9362,["value",lo$9359]]],["send",["symbol","<="],["data",len$9362,["value",hi$9360]]]]];}}}()));(temp$9418=enumerate$8270(fw$9347));;($length$9423=temp$9418.length);;($index$9428=0);;$9363:for(;($index$9428<$length$9423);($index$9428++)){var i$9446;var m$9447;var t0$9441;var t1$9442;var m$9436;(m$9436=temp$9418[$index$9428]);;(t0$9441=m$9436);if(((t0$9441 instanceof Array)&&((t1$9442=t0$9441.length),(t1$9442===2)))){(i$9446=t0$9441[0]);(m$9447=t0$9441[1]);it$0$9086.process(m$9447,["send",t$9361,["value",i$9446]],fns$9083);}else{$11188(m$9436,"/home/olivier/git/earl-grey/src/pattern.eg",8481,8567);;}}(temp$9455=enumerate$8270(dflt$9349));;($length$9460=temp$9455.length);;($index$9465=0);;$9365:for(;($index$9465<$length$9460);($index$9465++)){var idx$9495;var i$9485;var patt$9486;var value$9487;var t0$9478;var t1$9479;var t2$9480;var t3$9481;var m$9473;(m$9473=temp$9455[$index$9465]);;(t0$9478=m$9473);if(((t0$9478 instanceof Array)&&((t1$9479=t0$9478.length),((t1$9479===2)&&((i$9485=t0$9478[0]),((t2$9480=t0$9478[1]),((t2$9480 instanceof Array)&&((t3$9481=t2$9480.length),(t3$9481===2))))))))){(patt$9486=t2$9480[0]);(value$9487=t2$9480[1]);(idx$9495=(i$9485+nfw$9354));;it$0$9086.process(patt$9486,["send",["symbol","if"],["data",["send",["symbol",">="],["data",["value",(idx$9495+nbw$9355)],len$9362]],value$9487,["send",t$9361,["value",idx$9495]]]],fns$9083);}else{$11188(m$9473,"/home/olivier/git/earl-grey/src/pattern.eg",8567,8736);;}}if((rest$9350!==(void 0))){(pos$9502=(nfw$9354+ndflt$9356));;(end$9507=function(){if((nbw$9355>0)){return [["value",(-nbw$9355)]];}else{return [];}}());;it$0$9086.process(rest$9350,["send",["send",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","slice"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",t$9361,["value",pos$9502]].concat(end$9507)],fns$9083);}else{[];}(acc$9512=[]);;(temp$9517=enumerate$8270(bw$9348));;($length$9522=temp$9517.length);;($index$9527=0);;$9367:for(;($index$9527<$length$9522);($index$9527++)){var i$9545;var m$9546;var t0$9540;var t1$9541;var m$9535;(m$9535=temp$9517[$index$9527]);;(t0$9540=m$9535);if(((t0$9540 instanceof Array)&&((t1$9541=t0$9540.length),(t1$9541===2)))){(i$9545=t0$9540[0]);(m$9546=t0$9540[1]);acc$9512.push(it$0$9086.process(m$9546,["send",["symbol","___js_fetch"],["data",t$9361,["send",["symbol","-"],["data",len$9362,["value",(nbw$9355-i$9545)]]]]],fns$9083));}else{$11188(m$9535,"/home/olivier/git/earl-grey/src/pattern.eg",9187,9293);;}}return acc$9512;}else{$11188($9094$9100);}}}}}}}}}}}}}()));;return rval$9091;});$11201(PatternProcessor$8279,$11201(((accum$9556=({})),((accum$9556["::name"]="PatternProcessor"),accum$9556)),((accum$9560=({})),((accum$9560["::egclass"]=true),accum$9560))));PatternProcessor$8279;(assemble_conditions$8280=function(pp$9566){var $index$9648;var $length$9643;var temp$9638;var acc$9633;var decls$9627;var construct$9569;(construct$9569=function($9572$9574){var x$9617;var rest$9618;var x$9610;var x$9602;var rest$9603;var $9577$9593;var $9578$9594;var t0$9589;var t1$9590;var t2$9591;var $9576$9584;var ph$9579;(ph$9579=$9572$9574);;($9576$9584=ph$9579);;if((($9577$9593=($9576$9584 instanceof Array))&&((t0$9589=$9576$9584.length),(t0$9589===0)))){return ["value",true];}else{if(($9577$9593&&((t0$9589>=1)&&((t1$9590=$9576$9584[0]),((t1$9590 instanceof Array)&&((t2$9591=t1$9590.length),((t2$9591===2)&&(t1$9590[0]==="do")))))))){(x$9602=t1$9590[1]);(rest$9603=Array.prototype.slice.call($9576$9584,1));return ["multi",x$9602,construct$9569(rest$9603)];}else{if(($9577$9593&&((t0$9589===1)&&((t1$9590=$9576$9584[0]),((t1$9590 instanceof Array)&&((t2$9591=t1$9590.length),((t2$9591===2)&&(t1$9590[0]==="check")))))))){(x$9610=t1$9590[1]);return x$9610;}else{if(($9577$9593&&((t0$9589>=1)&&((t1$9590=$9576$9584[0]),((t1$9590 instanceof Array)&&((t2$9591=t1$9590.length),((t2$9591===2)&&(t1$9590[0]==="check")))))))){(x$9617=t1$9590[1]);(rest$9618=Array.prototype.slice.call($9576$9584,1));return ["send",["symbol","and"],["data",x$9617,construct$9569(rest$9618)]];}else{$11188($9576$9584);}}}}});;if(pp$9566.temps.length){(decls$9627=(((acc$9633=[])),(((temp$9638=pp$9566.temps)),((($length$9643=temp$9638.length)),((($index$9648=0)),function(){$9630:for(;($index$9648<$length$9643);($index$9648++)){var t$9664;var m$9656;(m$9656=temp$9638[$index$9648]);;(t$9664=m$9656);acc$9633.push(["declare",t$9664]);}}()))),acc$9633));;return ["multi"].concat(decls$9627).concat([construct$9569(pp$9566.parts)]);}else{return construct$9569(pp$9566.parts);}});;(assemble_pattern$8281=function(){var $index$9718;var $length$9713;var temp$9708;var $index$9767;var $length$9762;var temp$9757;var test$9860;var lead$9688;var trail$9689;var construct$9690;var parts$9682;var t$9683;var f$9684;var t0$9678;var $9671$9673;($9671$9673=arguments);;(t0$9678=$9671$9673.length);if(((t0$9678>=2)&&(t0$9678<=3))){(parts$9682=$9671$9673[0]);(t$9683=$9671$9673[1]);(f$9684=function(){if((2>=t0$9678)){return null;}else{return $9671$9673[2];}}());(lead$9688=[]);;(temp$9708=parts$9682.slice(0));;($length$9713=temp$9708.length);;($index$9718=0);;$9691:for(;($index$9718<$length$9713);($index$9718++)){var x$9747;var x$9740;var $9693$9734;var $9694$9735;var $9695$9736;var $9696$9737;var t0$9731;var t1$9732;var m$9726;(m$9726=temp$9708[$index$9718]);;(t0$9731=m$9726);if((($9694$9735=(t0$9731 instanceof Array))&&((t1$9732=t0$9731.length),(($9696$9737=(t1$9732===2))&&(t0$9731[0]==="do"))))){(x$9740=t0$9731[1]);lead$9688.push(x$9740);parts$9682.shift();}else{if(($9696$9737&&(t0$9731[0]==="check"))){(x$9747=t0$9731[1]);break $9691;}else{$11188(m$9726,"/home/olivier/git/earl-grey/src/pattern.eg",9799,9909);;}}}(trail$9689=[]);;(temp$9757=parts$9682.slice(0).reverse());;($length$9762=temp$9757.length);;($index$9767=0);;$9697:for(;($index$9767<$length$9762);($index$9767++)){var x$9796;var x$9789;var $9699$9783;var $9700$9784;var $9701$9785;var $9702$9786;var t0$9780;var t1$9781;var m$9775;(m$9775=temp$9757[$index$9767]);;(t0$9780=m$9775);if((($9700$9784=(t0$9780 instanceof Array))&&((t1$9781=t0$9780.length),(($9702$9786=(t1$9781===2))&&(t0$9780[0]==="do"))))){(x$9789=t0$9780[1]);trail$9689.unshift(x$9789);parts$9682.pop();}else{if(($9702$9786&&(t0$9780[0]==="check"))){(x$9796=t0$9780[1]);break $9697;}else{$11188(m$9775,"/home/olivier/git/earl-grey/src/pattern.eg",9923,10045);;}}}(construct$9690=function($9803$9805){var other$9856;var x$9848;var rest$9849;var x$9841;var x$9833;var rest$9834;var $9808$9824;var $9809$9825;var t0$9820;var t1$9821;var t2$9822;var $9807$9815;var ph$9810;(ph$9810=$9803$9805);;($9807$9815=ph$9810);;if((($9808$9824=($9807$9815 instanceof Array))&&((t0$9820=$9807$9815.length),(t0$9820===0)))){return ["value",true];}else{if(($9808$9824&&((t0$9820>=1)&&((t1$9821=$9807$9815[0]),((t1$9821 instanceof Array)&&((t2$9822=t1$9821.length),((t2$9822===2)&&(t1$9821[0]==="do")))))))){(x$9833=t1$9821[1]);(rest$9834=Array.prototype.slice.call($9807$9815,1));return ["multi",x$9833,construct$9690(rest$9834)];}else{if(($9808$9824&&((t0$9820===1)&&((t1$9821=$9807$9815[0]),((t1$9821 instanceof Array)&&((t2$9822=t1$9821.length),((t2$9822===2)&&(t1$9821[0]==="check")))))))){(x$9841=t1$9821[1]);return x$9841;}else{if(($9808$9824&&((t0$9820>=1)&&((t1$9821=$9807$9815[0]),((t1$9821 instanceof Array)&&((t2$9822=t1$9821.length),((t2$9822===2)&&(t1$9821[0]==="check")))))))){(x$9848=t1$9821[1]);(rest$9849=Array.prototype.slice.call($9807$9815,1));return ["send",["symbol","and"],["data",x$9848,construct$9690(rest$9849)]];}else{(other$9856=$9807$9815);throw $11012(["oops"]).create("?!?",other$9856);}}}}});;if(parts$9682.length){(test$9860=construct$9690(parts$9682));;return ["multi"].concat(lead$9688).concat([function(){if(f$9684){return ["send",["symbol","if"],["data",test$9860,["multi"].concat(trail$9689).concat([t$9683]),f$9684]];}else{return ["send",["symbol","if"],["data",test$9860,["multi"].concat(trail$9689).concat([t$9683])]];}}()]);}else{return ["multi"].concat(lead$9688).concat(trail$9689).concat([t$9683]);}}else{$11188($9671$9673);}});;(inject_below_uses$8282=function($9869$9871,fn$9872){var other$9896;var scope$9889;var x$9890;var t0$9885;var $9874$9880;var ph$9875;(ph$9875=$9869$9871);;($9874$9880=ph$9875);;if((($9874$9880 instanceof Array)&&((t0$9885=$9874$9880.length),((t0$9885===3)&&($9874$9880[0]==="use"))))){(scope$9889=$9874$9880[1]);(x$9890=$9874$9880[2]);return ["use",scope$9889,inject_below_uses$8282(x$9890,fn$9872)];}else{(other$9896=$9874$9880);return fn$9872(other$9896);}});;(parse_pattern$8283=function(scope$9902,pattern$9903,rhs$9904,opt$9905){var t0$9916;var $index$9955;var $length$9950;var temp$9945;var acc$9940;var parse$9908;var target$9909;var proc$9910;(parse$9908=PatternParser$8278(scope$9902,pattern$9903,opt$9905));;if(((!opt$9905.allow_arguments)&&parse$9908.arguments.length)){throw $11012(["syntax","pattern","arguments"]).create("Arguments cannot be declared in this pattern",({"args":parse$9908.arguments[0]}));}(t0$9916=$11323((opt$9905.wrap_target||identity$8275))(function(){if(parse$9908.arguments.length){return inject_below_uses$8282(rhs$9904,function(x$9919){return util$8266.construct(parse$9908.arguments.concat([x$9919]),function(args$9922,rest$9923){return ["send",["symbol","->"],["data",args$9922,rest$9923]];});});}else{return rhs$9904;}}()));if(t0$9916[0]){(target$9909=t0$9916[1]);;}else{$11188(function(){if(parse$9908.arguments.length){return inject_below_uses$8282(rhs$9904,function(x$9928){return util$8266.construct(parse$9908.arguments.concat([x$9928]),function(args$9931,rest$9932){return ["send",["symbol","->"],["data",args$9931,rest$9932]];});});}else{return rhs$9904;}}(),"/home/olivier/git/earl-grey/src/pattern.eg",11438,11871);}(proc$9910=PatternProcessor$8279());;proc$9910.process(parse$9908.pattern,target$9909,opt$9905);if(opt$9905.finalize){return ["splice"].concat(opt$9905.declare(parse$9908.vars)).concat([["multi"].concat((((acc$9940=[])),(((temp$9945=proc$9910.temps)),((($length$9950=temp$9945.length)),((($index$9955=0)),function(){$9937:for(;($index$9955<$length$9950);($index$9955++)){var t$9971;var m$9963;(m$9963=temp$9945[$index$9955]);;(t$9971=m$9963);acc$9940.push(["declare",t$9971]);}}()))),acc$9940)).concat([assemble_pattern$8281(proc$9910.parts,opt$9905.success(target$9909),opt$9905.failure(target$9909))])]);}else{return [parse$9908.vars,proc$9910.temps,proc$9910.parts];}});;(checkall$8284=["send","data","multi","assign","void","check","do"]);;(same_block$8285=function($9979$9981,ban1$9982,ban2$9983){var $index$10084;var $length$10079;var temp$10074;var other$10105;var type1$10057;var args1$10058;var type2$10059;var args2$10060;var m1$10048;var m2$10049;var v1$10039;var v2$10040;var s1$10030;var s2$10031;var v1$10018;var v2$10019;var $9986$10009;var $9987$10010;var $9988$10011;var $9989$10012;var $9990$10013;var $9991$10014;var $9992$10015;var t0$10003;var t1$10004;var t2$10005;var t3$10006;var t4$10007;var $9985$9998;var ph$9993;(ph$9993=$9979$9981);;($9985$9998=ph$9993);;if((($9986$10009=($9985$9998 instanceof Array))&&((t0$10003=$9985$9998.length),(($9988$10011=(t0$10003===2))&&((t1$10004=$9985$9998[0]),(($9990$10013=(t1$10004 instanceof Array))&&((t2$10005=t1$10004.length),(($9992$10015=(t2$10005===2))&&((t1$10004[0]==="variable")&&((v1$10018=t1$10004[1]),((t3$10006=$9985$9998[1]),((t3$10006 instanceof Array)&&((t4$10007=t3$10006.length),((t4$10007===2)&&(t3$10006[0]==="variable"))))))))))))))){(v2$10019=t3$10006[1]);return (v1$10018===v2$10019);}else{if(($9992$10015&&((t1$10004[0]==="symbol")&&((s1$10030=t1$10004[1]),((t3$10006=$9985$9998[1]),((t3$10006 instanceof Array)&&((t4$10007=t3$10006.length),((t4$10007===2)&&(t3$10006[0]==="symbol"))))))))){(s2$10031=t3$10006[1]);return (((!$8226(ban1$9982,s1$10030))&&(!$8226(ban2$9983,s2$10031)))&&(s1$10030===s2$10031));}else{if(($9992$10015&&((t1$10004[0]==="value")&&((v1$10039=t1$10004[1]),((t3$10006=$9985$9998[1]),((t3$10006 instanceof Array)&&((t4$10007=t3$10006.length),((t4$10007===2)&&(t3$10006[0]==="value"))))))))){(v2$10040=t3$10006[1]);return (v1$10039===v2$10040);}else{if(($9992$10015&&((t1$10004[0]==="macro")&&((m1$10048=t1$10004[1]),((t3$10006=$9985$9998[1]),((t3$10006 instanceof Array)&&((t4$10007=t3$10006.length),((t4$10007===2)&&(t3$10006[0]==="macro"))))))))){(m2$10049=t3$10006[1]);return (m1$10048===m2$10049);}else{if(($9990$10013&&((t2$10005>=1)&&((type1$10057=t1$10004[0]),((args1$10058=Array.prototype.slice.call(t1$10004,1)),((t3$10006=$9985$9998[1]),((t3$10006 instanceof Array)&&((t4$10007=t3$10006.length),((t4$10007>=1)&&((type2$10059=t3$10006[0]),((args2$10060=Array.prototype.slice.call(t3$10006,1)),(checkall$8284.indexOf(type1$10057)!==-1)))))))))))){if(((type1$10057===type2$10059)&&(args1$10058.length===args2$10060.length))){(temp$10074=zip$8269(args1$10058,args2$10060));;($length$10079=temp$10074.length);;($index$10084=0);;$10070:for(;($index$10084<$length$10079);($index$10084++)){var pair$10100;var m$10092;(m$10092=temp$10074[$index$10084]);;(pair$10100=m$10092);if((!same_block$8285(pair$10100,ban1$9982,ban2$9983))){return false;}}return true;}else{return false;}}else{(other$10105=$9985$9998);return false;}}}}}});;(parse_clauses$8286=function(scope$10111,target$10112,stmts$10113,opt$10114){var $index$10144;var $length$10139;var temp$10134;var acc$10129;var $index$10320;var $length$10315;var temp$10310;var acc$10305;var $index$10367;var $length$10362;var temp$10357;var acc$10352;var decls$10346;var all_temps$10117;var the_parts$10118;var unique_temps$10119;(all_temps$10117=[]);;(the_parts$10118=(((acc$10129=[])),(((temp$10134=scope$10111.step_all(["clause"],stmts$10113))),((($length$10139=temp$10134.length)),((($index$10144=0)),function(){$10125:for(;($index$10144<$length$10139);($index$10144++)){var accum$10219;var accum$10230;var t0$10215;var t1$10216;var $index$10253;var $length$10248;var temp$10243;var bod$10280;var placeholder$10169;var special_fn$10170;var vars$10171;var temps$10172;var blocks$10173;var vars2$10174;var x$10289;var other$10296;var b$10286;var pattern$10163;var body$10164;var $10127$10160;var t0$10157;var t1$10158;var m$10152;(m$10152=temp$10134[$index$10144]);;(t0$10157=m$10152);if(((t0$10157 instanceof Array)&&((t1$10158=t0$10157.length),((t1$10158===3)&&(t0$10157[0]==="clause"))))){(pattern$10163=t0$10157[1]);(body$10164=t0$10157[2]);acc$10129.push((((placeholder$10169=(void 0))),((special_fn$10170=function($10182$10184,value$10185){var t0$10191;var t1$10192;var other$10211;var $10187$10198;var ph$10188;var expr$10189;(t0$10191=$10182$10184);if(((t0$10191 instanceof Array)&&((t1$10192=t0$10191.length),((t1$10192===2)&&(t0$10191[0]==="special"))))){(ph$10188=t0$10191[1]);(expr$10189=t0$10191);;}else{$11188($10182$10184);}($10187$10198=ph$10188);;if(($10187$10198==="match")){(placeholder$10169=__lt____lt____colon__$8265(["symbol",scope$10111.gensym("ph")],expr$10189));return ["assign",placeholder$10169];}else{(other$10211=$10187$10198);throw $11012(["syntax","pattern","special"]).create("Special token cannot be used here",({"special":expr$10189}));}})),((t0$10215=parse_pattern$8283(scope$10111,pattern$10163,target$10112,$11251(opt$10114,$11201(({"allow_arguments":false,"allow_nested":true,"special":special_fn$10170}),$11201(((accum$10219=({})),((accum$10219["assign"]=function(v$10223,value$10224){return ["do",__lt____lt____colon__$8265(["assign",v$10223,value$10224],v$10223)];}),accum$10219)),({"finalize":false})))))),function(){if(((t0$10215 instanceof Array)&&((t1$10216=t0$10215.length),(t1$10216===3)))){(vars$10171=t0$10215[0]);(temps$10172=t0$10215[1]);(blocks$10173=t0$10215[2]);}else{return $11188(parse_pattern$8283(scope$10111,pattern$10163,target$10112,$11251(opt$10114,$11201(({"allow_arguments":false,"allow_nested":true,"special":special_fn$10170}),$11201(((accum$10230=({})),((accum$10230["assign"]=function(v$10234,value$10235){return ["do",__lt____lt____colon__$8265(["assign",v$10234,value$10235],v$10234)];}),accum$10230)),({"finalize":false}))))),"/home/olivier/git/earl-grey/src/pattern.eg",13491,13838);}}()),(all_temps$10117=all_temps$10117.concat(temps$10172)),function(){if(placeholder$10169){return vars$10171.push(placeholder$10169);}}(),((vars2$10174=({}))),(((temp$10243=vars$10171)),((($length$10248=temp$10243.length)),((($index$10253=0)),function(){$10175:for(;($index$10253<$length$10248);($index$10253++)){var other$10277;var xxx$10271;var t0$10266;var t1$10267;var m$10261;(m$10261=temp$10243[$index$10253]);;(t0$10266=m$10261);if(((t0$10266 instanceof Array)&&((t1$10267=t0$10266.length),((t1$10267===2)&&(t0$10266[0]==="symbol"))))){(xxx$10271=t0$10266[1]);(vars2$10174[xxx$10271]=true);}else{(other$10277=m$10261);throw $11012(["syntax","unexpected"]).create();}}}()))),(((bod$10280=function(){if(placeholder$10169){return parse_clauses$8286(scope$10111,placeholder$10169,$11323(["multi"])(body$10164)[1],opt$10114);}else{if(opt$10114.wrap){return opt$10114.wrap(body$10164);}else{return body$10164;}}}())),["clause",vars$10171,vars2$10174,blocks$10173,bod$10280])));}else{if((((x$10289=t0$10157)),((x$10289 instanceof Array)&&(x$10289[0]==="block")))){(b$10286=t0$10157);acc$10129.push(b$10286);}else{(other$10296=m$10152);acc$10129.push(function(){throw $11012(["syntax","clause"]).create("Illegal clause",({"clause":other$10296}));}());}}}}()))),acc$10129));;if(opt$10114.fallback){the_parts$10118.push(["block",opt$10114.fallback(target$10112)]);}(unique_temps$10119=iterkeys$8271(util$8266.set((((acc$10305=[])),(((temp$10310=all_temps$10117)),((($length$10315=temp$10310.length)),((($index$10320=0)),function(){$10302:for(;($index$10320<$length$10315);($index$10320++)){var t$10338;var t0$10333;var t1$10334;var m$10328;(m$10328=temp$10310[$index$10320]);;(t0$10333=m$10328);if(((t0$10333 instanceof Array)&&((t1$10334=t0$10333.length),((t1$10334===2)&&(t0$10333[0]==="symbol"))))){(t$10338=t0$10333[1]);acc$10305.push(t$10338);}else{$11188(m$10328,"/home/olivier/git/earl-grey/src/pattern.eg",14650,14680);;}}}()))),acc$10305))));;(decls$10346=(((acc$10352=[])),(((temp$10357=unique_temps$10119)),((($length$10362=temp$10357.length)),((($index$10367=0)),function(){$10349:for(;($index$10367<$length$10362);($index$10367++)){var t$10383;var m$10375;(m$10375=temp$10357[$index$10367]);;(t$10383=m$10375);acc$10352.push(["declare",["symbol",t$10383]]);}}()))),acc$10352));;return ["multi"].concat(decls$10346).concat([weave_clauses$8288(the_parts$10118)]);});;(opt_clauses$8287=function(clauses$10390){var $index$10419;var $length$10414;var temp$10409;var acc$10404;var $index$10554;var $length$10549;var temp$10544;var acc$10539;var $index$10599;var $length$10594;var temp$10589;var acc$10584;var $index$10643;var $length$10638;var temp$10633;var acc$10628;var shares$10393;var max$10394;var temps$10395;var shared_last$10396;var idx_last$10397;var new_clauses$10398;(shares$10393=(((acc$10404=[])),(((temp$10409=enumerate$8270(clauses$10390.slice(1)))),((($length$10414=temp$10409.length)),((($index$10419=0)),function(){$10401:for(;($index$10419<$length$10414);($index$10419++)){var t0$10458;var t1$10459;var $index$10482;var $length$10477;var temp$10472;var varsd0$10451;var blocks0$10452;var share$10453;var idx$10454;var i$10439;var vars$10440;var varsd$10441;var blocks$10442;var body$10443;var t0$10432;var t1$10433;var t2$10434;var t3$10435;var m$10427;(m$10427=temp$10409[$index$10419]);;(t0$10432=m$10427);if(((t0$10432 instanceof Array)&&((t1$10433=t0$10432.length),((t1$10433===2)&&((i$10439=t0$10432[0]),((t2$10434=t0$10432[1]),((t2$10434 instanceof Array)&&((t3$10435=t2$10434.length),((t3$10435===5)&&(t2$10434[0]==="clause")))))))))){(vars$10440=t2$10434[1]);(varsd$10441=t2$10434[2]);(blocks$10442=t2$10434[3]);(body$10443=t2$10434[4]);acc$10404.push((((t0$10458=$8226(clauses$10390,i$10439)),function(){if(((t0$10458 instanceof Array)&&((t1$10459=t0$10458.length),((t1$10459===5)&&(t0$10458[0]==="clause"))))){t0$10458[1];(varsd0$10451=t0$10458[2]);(blocks0$10452=t0$10458[3]);t0$10458[4];}else{return $11188($8226(clauses$10390,i$10439),"/home/olivier/git/earl-grey/src/pattern.eg",14953,14963);}}()),((share$10453=0)),((idx$10454=0)),(((temp$10472=blocks$10442)),((($length$10477=temp$10472.length)),((($index$10482=0)),function(){$10455:for(;($index$10482<$length$10477);($index$10482++)){var x$10513;var x$10522;var other$10529;var $10501$10503;var b$10498;var m$10490;(m$10490=temp$10472[$index$10482]);;(b$10498=m$10490);if(same_block$8285([$8226(blocks0$10452,share$10453),b$10498],varsd0$10451,varsd$10441)){(share$10453++);($10501$10503=b$10498);;if((((x$10513=$10501$10503)),((x$10513 instanceof Array)&&(x$10513[0]==="do")))){null;}else{if((((x$10522=$10501$10503)),((x$10522 instanceof Array)&&(x$10522[0]==="check")))){(idx$10454=share$10453);}else{(other$10529=$10501$10503);__lt____gt__$8263(null,other$10529);}}}else{break $10455;}}}()))),[share$10453,idx$10454]));}else{$11188(m$10427,"/home/olivier/git/earl-grey/src/pattern.eg",14829,15350);;}}}()))),acc$10404));;(max$10394=$8226(Math.max,(((acc$10539=[])),(((temp$10544=shares$10393)),((($length$10549=temp$10544.length)),((($index$10554=0)),function(){$10536:for(;($index$10554<$length$10549);($index$10554++)){var x$10572;var t0$10567;var t1$10568;var m$10562;(m$10562=temp$10544[$index$10554]);;(t0$10567=m$10562);if(((t0$10567 instanceof Array)&&((t1$10568=t0$10567.length),(t1$10568===2)))){(x$10572=t0$10567[0]);t0$10567[1];acc$10539.push(x$10572);}else{$11188(m$10562,"/home/olivier/git/earl-grey/src/pattern.eg",15364,15389);;}}}()))),acc$10539)));;shares$10393.push([0,0]);(temps$10395=(((acc$10584=[])),(((temp$10589=$11355(1,max$10394))),((($length$10594=temp$10589.length)),((($index$10599=0)),function(){$10581:for(;($index$10599<$length$10594);($index$10599++)){var m$10607;(m$10607=temp$10589[$index$10599]);;m$10607;acc$10584.push(["symbol",gensym$8268()]);}}()))),acc$10584));;(shared_last$10396=0);;(idx_last$10397=0);;(new_clauses$10398=(((acc$10628=[])),(((temp$10633=enumerate$8270(clauses$10390))),((($length$10638=temp$10633.length)),((($index$10643=0)),function(){$10625:for(;($index$10643<$length$10638);($index$10643++)){var t0$10681;var t1$10682;var $index$10717;var $length$10712;var temp$10707;var acc$10702;var rest$10766;var newblocks$10762;var share$10675;var idx$10676;var shared$10677;var n_to_share$10678;var to_share$10679;var other$10773;var i$10663;var vars$10664;var varsd$10665;var blocks$10666;var body$10667;var t0$10656;var t1$10657;var t2$10658;var t3$10659;var m$10651;(m$10651=temp$10633[$index$10643]);;(t0$10656=m$10651);if(((t0$10656 instanceof Array)&&((t1$10657=t0$10656.length),((t1$10657===2)&&((i$10663=t0$10656[0]),((t2$10658=t0$10656[1]),((t2$10658 instanceof Array)&&((t3$10659=t2$10658.length),((t3$10659===5)&&(t2$10658[0]==="clause")))))))))){(vars$10664=t2$10658[1]);(varsd$10665=t2$10658[2]);(blocks$10666=t2$10658[3]);(body$10667=t2$10658[4]);acc$10628.push((((t0$10681=$8226(shares$10393,i$10663)),function(){if(((t0$10681 instanceof Array)&&((t1$10682=t0$10681.length),(t1$10682===2)))){(share$10675=t0$10681[0]);(idx$10676=t0$10681[1]);}else{return $11188($8226(shares$10393,i$10663),"/home/olivier/git/earl-grey/src/pattern.eg",15614,15623);}}()),((shared$10677=function(){if(idx_last$10397){return [["check",$8226(temps$10395,(idx_last$10397-1))]];}else{return [];}}())),((n_to_share$10678=Math.max(shared_last$10396,share$10675))),((to_share$10679=(((acc$10702=[])),(((temp$10707=enumerate$8270(blocks$10666.slice(shared_last$10396,n_to_share$10678)))),((($length$10712=temp$10707.length)),((($index$10717=0)),function(){$10695:for(;($index$10717<$length$10712);($index$10717++)){var j$10751;var x$10752;var j$10741;var x$10742;var $10697$10735;var $10698$10736;var $10699$10737;var $10700$10738;var t0$10730;var t1$10731;var t2$10732;var t3$10733;var m$10725;(m$10725=temp$10707[$index$10717]);;(t0$10730=m$10725);if((($10698$10736=(t0$10730 instanceof Array))&&((t1$10731=t0$10730.length),(($10700$10738=(t1$10731===2))&&((j$10741=t0$10730[0]),((t2$10732=t0$10730[1]),((t2$10732 instanceof Array)&&((t3$10733=t2$10732.length),((t3$10733===2)&&(t2$10732[0]==="check")))))))))){(x$10742=t2$10732[1]);acc$10702.push(["check",["assign",$8226(temps$10395,(shared_last$10396+j$10741)),x$10742]]);}else{if(($10700$10738&&((j$10751=t0$10730[0]),((t2$10732=t0$10730[1]),((t2$10732 instanceof Array)&&((t3$10733=t2$10732.length),((t3$10733===2)&&(t2$10732[0]==="do")))))))){(x$10752=t2$10732[1]);acc$10702.push(["do",x$10752]);}else{$11188(m$10725,"/home/olivier/git/earl-grey/src/pattern.eg",15762,15933);;}}}}()))),acc$10702))),(shared_last$10396=share$10675),(idx_last$10397=idx$10676),(((newblocks$10762=(((rest$10766=blocks$10666.slice(n_to_share$10678))),shared$10677.concat(to_share$10679).concat(rest$10766)))),["clause",vars$10664,varsd$10665,newblocks$10762,body$10667])));}else{(other$10773=m$10651);acc$10628.push(function(){throw $11012(["oops"]).create("what",({"value":other$10773}));}());}}}()))),acc$10628));;return [temps$10395,new_clauses$10398];});;(weave_clauses$8288=function(parts$10780){var $index$10826;var $length$10821;var temp$10816;var $index$10992;var $length$10987;var temp$10982;var acc$10977;var groups$10783;var reassemble$10784;var new_temps$10785;var helper$10786;(groups$10783=classify_contiguous$8274(parts$10780,function($10795$10797){var t0$10801;var t1$10802;var cls$10799;(t0$10801=$10795$10797);if(((t0$10801 instanceof Array)&&((t1$10802=t0$10801.length),(t1$10802>=1)))){(cls$10799=t0$10801[0]);Array.prototype.slice.call(t0$10801,1);;}else{$11188($10795$10797);}return cls$10799;}));;(reassemble$10784=[]);;(new_temps$10785=[]);;(temp$10816=groups$10783);;($length$10821=temp$10816.length);;($index$10826=0);;$10787:for(;($index$10826<$length$10821);($index$10826++)){var t0$10856;var t1$10857;var ts$10853;var new_clauses$10854;var elems$10864;var elems$10848;var $10789$10842;var $10790$10843;var $10791$10844;var $10792$10845;var t0$10839;var t1$10840;var m$10834;(m$10834=temp$10816[$index$10826]);;(t0$10839=m$10834);if((($10790$10843=(t0$10839 instanceof Array))&&((t1$10840=t0$10839.length),(($10792$10845=(t1$10840>=1))&&(t0$10839[0]==="clause"))))){(elems$10848=Array.prototype.slice.call(t0$10839,1));(t0$10856=opt_clauses$8287(elems$10848));if(((t0$10856 instanceof Array)&&((t1$10857=t0$10856.length),(t1$10857===2)))){(ts$10853=t0$10856[0]);(new_clauses$10854=t0$10856[1]);;}else{$11188(opt_clauses$8287(elems$10848),"/home/olivier/git/earl-grey/src/pattern.eg",16428,16446);}(new_temps$10785=new_temps$10785.concat(ts$10853));(reassemble$10784=reassemble$10784.concat(new_clauses$10854));}else{if(($10792$10845&&(t0$10839[0]==="block"))){(elems$10864=Array.prototype.slice.call(t0$10839,1));(reassemble$10784=reassemble$10784.concat(elems$10864));}else{$11188(m$10834,"/home/olivier/git/earl-grey/src/pattern.eg",16362,16567);;}}}(helper$10786=function($10871$10873){var $index$10952;var $length$10947;var temp$10942;var acc$10937;var decls$10931;var vars$10923;var varsd$10924;var blocks$10925;var body$10926;var rest$10927;var body$10912;var rest$10913;var $10876$10899;var $10877$10900;var $10878$10901;var $10879$10902;var $10880$10903;var $10881$10904;var t0$10892;var t1$10893;var t2$10894;var t3$10895;var t4$10896;var t5$10897;var $10875$10887;var ph$10882;(ph$10882=$10871$10873);;($10875$10887=ph$10882);;if((($10876$10899=($10875$10887 instanceof Array))&&((t0$10892=$10875$10887.length),(t0$10892===0)))){return ["multi"];}else{if(($10876$10899&&(($10878$10901=(t0$10892>=1))&&((t1$10893=$10875$10887[0]),(($10880$10903=(t1$10893 instanceof Array))&&((t2$10894=t1$10893.length),((t2$10894===2)&&((t1$10893[0]==="block")&&((t3$10895=$11323(["multi"])(t1$10893[1])),(t3$10895[0]&&((t4$10896=t3$10895[1]),((t5$10897=t4$10896.length),(t5$10897>=0))))))))))))){(body$10912=Array.prototype.slice.call(t4$10896,0));(rest$10913=Array.prototype.slice.call($10875$10887,1));return ["multi"].concat(body$10912).concat([helper$10786(rest$10913)]);}else{if(($10880$10903&&((t2$10894===5)&&(t1$10893[0]==="clause")))){(vars$10923=t1$10893[1]);(varsd$10924=t1$10893[2]);(blocks$10925=t1$10893[3]);(body$10926=t1$10893[4]);(rest$10927=Array.prototype.slice.call($10875$10887,1));(decls$10931=(((acc$10937=[])),(((temp$10942=vars$10923)),((($length$10947=temp$10942.length)),((($index$10952=0)),function(){$10934:for(;($index$10952<$length$10947);($index$10952++)){var v$10968;var m$10960;(m$10960=temp$10942[$index$10952]);;(v$10968=m$10960);acc$10937.push(["declare",v$10968]);}}()))),acc$10937));;return ["tagscope","back",["multi"].concat(decls$10931).concat([assemble_pattern$8281(blocks$10925,body$10926,["use","back",helper$10786(rest$10927)])])];}else{$11188($10875$10887);}}}});;return ["multi"].concat((((acc$10977=[])),(((temp$10982=new_temps$10785)),((($length$10987=temp$10982.length)),((($index$10992=0)),function(){$10974:for(;($index$10992<$length$10987);($index$10992++)){var t$11008;var m$11000;(m$11000=temp$10982[$index$10992]);;(t$11008=m$11000);acc$10977.push(["declare",t$11008]);}}()))),acc$10977)).concat([helper$10786(reassemble$10784)]);});;(exports["PatternParser"]=PatternParser$8278);(exports["PatternProcessor"]=PatternProcessor$8279);(exports["parse_clauses"]=parse_clauses$8286);(exports["parse_pattern"]=parse_pattern$8283);

},{"./expand":5,"./location":7,"./pp":11,"./util":14}],11:[function(require,module,exports){
var $11491=function(type$11493){var f$11496;(f$11496=type$11493["::check"]);;if((f$11496===(void 0))){return function(value$11501){return (value$11501 instanceof type$11493);};}else{return function(value$11504){return f$11496.call(type$11493,value$11504);};}};
var $11506=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $11507=function($11508$11510){var ph$11514;(ph$11514=$11508$11510);;var $11512$11519;($11512$11519=ph$11514);;var bridge$11513$11524;var x$11528;(bridge$11513$11524=$11512$11519);if((((typeof(bridge$11513$11524)==="string")&&((x$11528=bridge$11513$11524),true))||((typeof(bridge$11513$11524)==="number")&&((x$11528=bridge$11513$11524),true)))){return ["value",x$11528];}else{var other$11535;(other$11535=$11512$11519);return other$11535["::serialize_ast"]();}};
var send$11375;(send$11375=function(obj$11380,$11378$11381){var ph$11385;var msg$11386;var t0$11388;(t0$11388=$11378$11381);(msg$11386=t0$11388);(ph$11385=t0$11388);;var $11383$11392;($11383$11392=ph$11385);;var bridge$11384$11397;(bridge$11384$11397=$11383$11392);if(((typeof(bridge$11384$11397)==="string")||(typeof(bridge$11384$11397)==="number"))){return obj$11380[msg$11386];}else{var other$11405;(other$11405=$11383$11392);return obj$11380["::send"](msg$11386);}});;(Array[":::project"]=function($11408$11410){var ph$11413;var value$11414;var t0$11416;(t0$11416=$11408$11410);(value$11414=t0$11416);(ph$11413=t0$11416);;var $11412$11420;($11412$11420=ph$11413);;if($11491(Array)($11412$11420)){return [true,value$11414];}else{$11412$11420;return [true,[value$11414]];}});(Array.prototype["::check"]=function(value$11434){if((value$11434 instanceof Array)){var i$11439;(i$11439=0);;$11437:for(;(i$11439<this.length);(i$11439++)){if(($11506(this,i$11439)!==$11506(value$11434,i$11439))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$11450){if((value$11450 instanceof Array)){var i$11455;(i$11455=0);;$11453:for(;(i$11455<this.length);(i$11455++)){if(($11506(this,i$11455)!==$11506(value$11450,i$11455))){return [true,[value$11450]];}}return [true,value$11450.slice(this.length)];}else{return [true,[value$11450]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($11507));});(RegExp.prototype["::check"]=function(value$11466){return value$11466.match(this);});(RegExp.prototype[":::project"]=function(value$11469){var $11471$11473;($11471$11473=value$11469.match(this));;var m$11481;if(($11471$11473===null)){(m$11481=$11471$11473);return [false,null];}else{var m$11486;(m$11486=$11471$11473);return [true,m$11486];}});(Function.prototype["::send"]=function(args$11489){return this.apply(this,args$11489);});
var $12262=function(type$12264){return function(value$12267){var f$12270;(f$12270=type$12264[":::project"]);;if((f$12270===(void 0))){var f$12275;(f$12275=type$12264["::project"]);;if((f$12275===(void 0))){return [true,type$12264(value$12267)];}else{var rval$12280;(rval$12280=false);;try{(rval$12280=[true,f$12275(value$12267)]);}catch(excv$12286){var e$12292;(e$12292=excv$12286);(rval$12280=[false,null]);}return rval$12280;}}else{return f$12270.call(type$12264,value$12267);}};};
var $12461=function(arr$12463){var results$12467;var l$12468;(results$12467=[]);;(l$12468=arr$12463.length);;var i$12476;(i$12476=0);;$12466:for(;(i$12476<l$12468);(i$12476++)){results$12467.push([i$12476,$11506(arr$12463,i$12476)]);}return results$12467;};
var $12483=function(dest$12485,values$12486){var k$12491;(k$12491=null);$12489:for(k$12491 in values$12486){if(values$12486.hasOwnProperty(k$12491)){(dest$12485[k$12491]=values$12486[k$12491]);}}return dest$12485;};
var $12307=function(){var $12308$12310;($12308$12310=function(tags$12314){var it$0$12317;(it$0$12317=function(){if((!$11491($12308$12310)(this))){return Object.create($12308$12310.prototype);}else{return this;}}());;(it$0$12317["tags"]=tags$12314);return it$0$12317;});;($12308$12310.prototype["create"]=function(){var $12326$12328;($12326$12328=arguments);;var t0$12333;var message$12337;var args$12338;(t0$12333=$12326$12328.length);if((t0$12333>=0)){(message$12337=function(){if((0>=t0$12333)){return "";}else{return $12326$12328[0];}}());(args$12338=Array.prototype.slice.call($12326$12328,1));var it$0$12342;(it$0$12342=this);;var e$12347;(e$12347=Error(message$12337));;(e$12347["::tags"]=it$0$12342.tags);(e$12347["args"]=args$12338);var temp$12355;(temp$12355=$12461(args$12338));;var $length$12360;($length$12360=temp$12355.length);;var $index$12365;($index$12365=0);;$12348:for(;($index$12365<$length$12360);($index$12365++)){var m$12373;(m$12373=temp$12355[$index$12365]);;var t0$12378;var t1$12379;var i$12383;var arg$12384;(t0$12378=m$12373);if(((t0$12378 instanceof Array)&&((t1$12379=t0$12378.length),(t1$12379===2)))){(i$12383=t0$12378[0]);(arg$12384=t0$12378[1]);(e$12347[i$12383]=arg$12384);}else{$12294(m$12373);;}}(e$12347["length"]=args$12338.length);(e$12347["name"]=["E"].concat(it$0$12342.tags).join("."));return e$12347;}else{$12294($12326$12328);}});($12308$12310.prototype["::check"]=function(e$12395){var it$0$12398;(it$0$12398=this);;var tags$12403;if(((!e$12395)||(!$11491(Error)(e$12395)))){return false;}(tags$12403=(e$12395["::tags"]||[]));;var temp$12412;(temp$12412=it$0$12398.tags);;var $length$12417;($length$12417=temp$12412.length);;var $index$12422;($index$12422=0);;$12404:for(;($index$12422<$length$12417);($index$12422++)){var m$12430;(m$12430=temp$12412[$index$12422]);;var tag$12438;(tag$12438=m$12430);if((tags$12403.indexOf(tag$12438)===-1)){return false;}else{false;;}}return true;});($12308$12310.prototype["::deconstruct"]=function(e$12446){var it$0$12449;(it$0$12449=this);;return e$12446.args;});$12483($12308$12310,$12483(function(){var accum$12454;(accum$12454=({}));(accum$12454["::name"]="$12308");return accum$12454;}(),function(){var accum$12458;(accum$12458=({}));(accum$12458["::egclass"]=true);return accum$12458;}()));return $12308$12310;}();
var $12294=function(value$12296,url$12297,start$12298,end$12299){var err$12302;(err$12302=$12307(["match"]).create("Could not find a match for value",({"value":value$12296})));;if(url$12297){(err$12302["location"]=["location",url$12297,start$12298,end$12299]);}throw err$12302;};
var $12140=function(){var $12141$12143;($12141$12143=function($12146$12149,$12147$12150){var classes$12152;var children$12153;var t0$12155;(t0$12155=$12262(Array)($12146$12149));if(t0$12155[0]){(classes$12152=t0$12155[1]);;}else{$12294($12146$12149);}var t0$12160;(t0$12160=$12262(Array)($12147$12150));if(t0$12160[0]){(children$12153=t0$12160[1]);;}else{$12294($12147$12150);}var it$0$12165;(it$0$12165=function(){if((!$11491($12141$12143)(this))){return Object.create($12141$12143.prototype);}else{return this;}}());;(it$0$12165["classes"]=classes$12152.sort());(it$0$12165["children"]=children$12153);return it$0$12165;});;$12483(function(){var accum$12173;(accum$12173=({}));(accum$12173["::check"]=function(x$12177){return ((x$12177&&x$12177.classes)&&x$12177.children);});return accum$12173;}(),$12483(function(){var accum$12180;(accum$12180=({}));(accum$12180["::deconstruct"]=function(x$12184){return [x$12184.classes,x$12184.children];});return accum$12180;}(),$12483(function(){var accum$12187;(accum$12187=({}));(accum$12187["::name"]="$12141");return accum$12187;}(),function(){var accum$12191;(accum$12191=({}));(accum$12191["::egclass"]=true);return accum$12191;}())));($12141$12143.prototype["::check"]=function(n$12197){var it$0$12200;(it$0$12200=this);;var temp$12209;(temp$12209=it$0$12200.classes);;var $length$12214;($length$12214=temp$12209.length);;var $index$12219;($index$12219=0);;$12205:for(;($index$12219<$length$12214);($index$12219++)){var m$12227;(m$12227=temp$12209[$index$12219]);;var c$12235;(c$12235=m$12227);if((n$12197.classes.indexOf(c$12235)===-1)){return false;}else{false;;}}return true;});$12483($12141$12143,$12483(function(){var accum$12241;(accum$12241=({}));(accum$12241["::check"]=function(x$12245){return ((x$12245&&x$12245.classes)&&x$12245.children);});return accum$12241;}(),$12483(function(){var accum$12248;(accum$12248=({}));(accum$12248["::deconstruct"]=function(x$12252){return [x$12252.classes,x$12252.children];});return accum$12248;}(),$12483(function(){var accum$12255;(accum$12255=({}));(accum$12255["::name"]="$12141");return accum$12255;}(),function(){var accum$12259;(accum$12259=({}));(accum$12259["::egclass"]=true);return accum$12259;}()))));return $12141$12143;}();
var $12495=function($12496$12498,key$12499){var ph$12503;(ph$12503=$12496$12498);;var $12501$12508;($12501$12508=ph$12503);;var bridge$12502$12513;(bridge$12502$12513=$12501$12508);if(((bridge$12502$12513===null)||(bridge$12502$12513===(void 0)))){return false;}else{var x$12521;if((typeof($12501$12508)==="string")){(x$12521=$12501$12508);return (key$12499 in String.prototype);}else{var x$12526;if((typeof($12501$12508)==="number")){(x$12526=$12501$12508);return (key$12499 in Number.prototype);}else{var x$12531;(x$12531=$12501$12508);return (key$12499 in x$12531);}}}};var $11538$11539;var items$11540;var pr_terminus$11541;var pr$11542;var __lt____gt__$11543;var repr$11544;var escape_html$11545;var quotify$11546;var HTML$11547;($11538$11539=require("./util"));;(items$11540=$11538$11539.items);;(pr_terminus$11541=function(node$11557){var r$11560;var pre$11561;var post$11562;(r$11560=HTML$11547(node$11557,"span"));;(pre$11561=(String.fromCharCode(27)+"[?0;7y+h <div class=\"ug\">"));;(post$11562=("</div>"+String.fromCharCode(7)));;return console.log(((pre$11561+r$11560)+post$11562));});;(pr$11542=function($11575$11577,r$11578){var x$11599;var n$11594;var $11580$11586;var ph$11581;(ph$11581=$11575$11577);;($11580$11586=ph$11581);;if($11491($12140)($11580$11586)){(n$11594=$11580$11586);return pr_terminus$11541(n$11594);}else{(x$11599=$11580$11586);return pr_terminus$11541((r$11578||repr$11544)(x$11599));}});;(__lt____gt__$11543=function($11604$11606,x$11607){if(($11604$11606===null)){;}else{$12294($11604$11606);}return pr$11542(x$11607);});;(repr$11544=function(){var $index$11692;var $length$11687;var temp$11682;var acc$11677;var $index$11736;var $length$11731;var temp$11726;var acc$11721;var other$11763;var entries$11671;var $11619$11644;var t0$11642;var x$11632;var recur$11633;var $11618$11634;var t0$11626;var t1$11627;var t2$11628;var $11617$11621;($11617$11621=arguments);;(t0$11626=$11617$11621.length);if((((t0$11626>=1)&&(t0$11626<=2))&&((t1$11627=$11617$11621[0]),((x$11632=t1$11627),(($11618$11634=t1$11627),((t2$11628=function(){if((1>=t0$11626)){return repr$11544;}else{return $11617$11621[1];}}()),$11491(Function)(t2$11628))))))){(recur$11633=t2$11628);if(($11618$11634===true)){return $12140(["special","true"],"true");}else{if(($11618$11634===false)){return $12140(["special","false"],"false");}else{if(($11618$11634===null)){return $12140(["special","nil"],"null");}else{if(($11618$11634===(void 0))){return $12140(["special","nil"],"undefined");}else{if((typeof($11618$11634)==="number")){return $12140(["num"],String(x$11632));}else{if((typeof($11618$11634)==="string")){return $12140(["str"],x$11632);}else{(t0$11642=$11618$11634);if($11491(Array)(t0$11642)){(entries$11671=t0$11642);return $12140(["sequence"],(((acc$11677=[])),(((temp$11682=entries$11671)),((($length$11687=temp$11682.length)),((($index$11692=0)),function(){$11674:for(;($index$11692<$length$11687);($index$11692++)){var x$11708;var m$11700;(m$11700=temp$11682[$index$11692]);;(x$11708=m$11700);acc$11677.push(recur$11633(x$11708,repr$11544));}}()))),acc$11677));}else{$11618$11634;if(x$11632["::repr"]){return x$11632["::repr"](recur$11633);}else{if((Object.getPrototypeOf(x$11632)===Object.prototype)){return $12140(["+table","object"],(((acc$11721=[])),(((temp$11726=items$11540(x$11632))),((($length$11731=temp$11726.length)),((($index$11736=0)),function(){$11718:for(;($index$11736<$length$11731);($index$11736++)){var k$11754;var v$11755;var t0$11749;var t1$11750;var m$11744;(m$11744=temp$11726[$index$11736]);;(t0$11749=m$11744);if(((t0$11749 instanceof Array)&&((t1$11750=t0$11749.length),(t1$11750===2)))){(k$11754=t0$11749[0]);(v$11755=t0$11749[1]);acc$11721.push($12140(["+tr"],[$12140(["+th"],recur$11633(k$11754,repr$11544)),$12140(["+td"],recur$11633(v$11755,repr$11544))]));}else{$12294(m$11744,"/home/olivier/git/earl-grey/src/pp.eg",950,1074);;}}}()))),acc$11721));}else{(other$11763=$11618$11634);return $12140(["unknown"],other$11763.toString());}}}}}}}}}}else{$12294($11617$11621);}});;(escape_html$11545=function($11770$11772){var t0$11776;var repl$11781;var s$11774;(t0$11776=[true,String($11770$11772)]);if(t0$11776[0]){(s$11774=t0$11776[1]);;}else{$12294($11770$11772);}(repl$11781=({"&":"&amp;","<":"&lt;",">":"&gt;"}));;return s$11774.replace(RegExp("[&<>]","g"),function(x$11786){return $11506(repl$11781,x$11786);});});;(quotify$11546=function($11791$11793){var t0$11797;var s$11795;(t0$11797=[true,String($11791$11793)]);if(t0$11797[0]){(s$11795=t0$11797[1]);;}else{$12294($11791$11793);}return s$11795.replace(RegExp("[\"\\\\]","g"),function(x$11802){return ("\\"+x$11802);});});;(HTML$11547=function($11807$11809,default_tag$11810){var $index$11853;var $length$11848;var temp$11843;var acc$11838;var $index$11918;var $length$11913;var temp$11908;var $index$11995;var $length$11990;var temp$11985;var acc$11980;var $index$12050;var $length$12045;var temp$12040;var acc$12035;var $index$12096;var $length$12091;var temp$12086;var acc$12081;var other$12076;var $12020$12022;var x$12130;var other$12127;var $11879$12115;var tag$11880;var _classes$11881;var id$11882;var kv$11883;var sub$11884;var accum$11885;var other$12136;var classes$11873;var children$11874;var children$11831;var s$11826;var $11812$11818;var ph$11813;(ph$11813=$11807$11809);;($11812$11818=ph$11813);;if((typeof($11812$11818)==="string")){(s$11826=$11812$11818);return escape_html$11545(s$11826);}else{if($11491(Array)($11812$11818)){(children$11831=$11812$11818);return (((acc$11838=[])),(((temp$11843=children$11831)),((($length$11848=temp$11843.length)),((($index$11853=0)),function(){$11835:for(;($index$11853<$length$11848);($index$11853++)){var child$11869;var m$11861;(m$11861=temp$11843[$index$11853]);;(child$11869=m$11861);acc$11838.push(HTML$11547(child$11869,default_tag$11810));}}()))),acc$11838).join("");}else{if(($11491($12140)($11812$11818)&&($12495($11812$11818,"classes")&&((classes$11873=$11812$11818.classes),$12495($11812$11818,"children"))))){(children$11874=$11812$11818.children);(tag$11880=(default_tag$11810||"span"));;(_classes$11881=[]);;(id$11882=null);;(kv$11883=[]);;(sub$11884=[]);;(temp$11908=classes$11873);;($length$11913=temp$11908.length);;($index$11918=0);;$11886:for(;($index$11918<$length$11913);($index$11918++)){var s$11966;var m$11959;var m$11952;var k$11947;var k$11940;var v$11941;var $11888$11935;var $11889$11936;var $11890$11937;var t0$11931;var t1$11932;var t2$11933;var m$11926;(m$11926=temp$11908[$index$11918]);;(t0$11931=m$11926);if((($11889$11936=(t0$11931 instanceof Array))&&((t1$11932=t0$11931.length),((t1$11932===3)&&(t0$11931[0]==="assoc"))))){(k$11940=t0$11931[1]);(v$11941=t0$11931[2]);kv$11883.push([k$11940,v$11941]);}else{if(($11889$11936&&((t1$11932===2)&&(t0$11931[0]==="assoc")))){(k$11947=t0$11931[1]);kv$11883.push([k$11947,(void 0)]);}else{(t0$11931=$12262(RegExp("(?:^\\+((?:.*)))",""))(m$11926));if((t0$11931[0]&&((t1$11932=t0$11931[1]),((t2$11933=t1$11932.length),(t2$11933===2))))){t1$11932[0];(m$11952=t1$11932[1]);(tag$11880=m$11952);}else{(t0$11931=$12262(RegExp("(?:^#((?:.*)))",""))(m$11926));if((t0$11931[0]&&((t1$11932=t0$11931[1]),((t2$11933=t1$11932.length),(t2$11933===2))))){t1$11932[0];(m$11959=t1$11932[1]);(id$11882=m$11959);}else{(t0$11931=m$11926);if((typeof(t0$11931)==="string")){(s$11966=t0$11931);_classes$11881.push(s$11966);}else{$12294(m$11926,"/home/olivier/git/earl-grey/src/pp.eg",1851,2172);;}}}}}}(accum$11885=function(){if((tag$11880==="raw")){return [];}else{return ["<",tag$11880];}}());;if(id$11882){(accum$11885=accum$11885.concat(" id=\"",id$11882,"\""));}if(_classes$11881.length){(accum$11885=accum$11885.concat(" class=\"",quotify$11546(_classes$11881.join(" ")),"\""));}if(kv$11883){(acc$11980=[]);;(temp$11985=kv$11883);;($length$11990=temp$11985.length);;($index$11995=0);;$11977:for(;($index$11995<$length$11990);($index$11995++)){var k$12013;var v$12014;var t0$12008;var t1$12009;var m$12003;(m$12003=temp$11985[$index$11995]);;(t0$12008=m$12003);if(((t0$12008 instanceof Array)&&((t1$12009=t0$12008.length),(t1$12009===2)))){(k$12013=t0$12008[0]);(v$12014=t0$12008[1]);acc$11980.push((accum$11885=accum$11885.concat(function(){if((v$12014!==null)){return [" ",k$12013,"=\"",quotify$11546(v$12014),"\""];}else{return [" ",k$12013];}}())));}else{$12294(m$12003,"/home/olivier/git/earl-grey/src/pp.eg",2426,2623);;}}acc$11980;}(children$11874=((($12020$12022=tag$11880)),function(){if(($12020$12022==="raw")){(acc$12035=[]);;(temp$12040=children$11874);;($length$12045=temp$12040.length);;($index$12050=0);;$12032:for(;($index$12050<$length$12045);($index$12050++)){var c$12072;var s$12067;var t0$12063;var m$12058;(m$12058=temp$12040[$index$12050]);;(t0$12063=m$12058);if((typeof(t0$12063)==="string")){(s$12067=t0$12063);acc$12035.push(s$12067);}else{(c$12072=m$12058);acc$12035.push(HTML$11547(c$12072,default_tag$11810));}}return acc$12035;}else{(other$12076=$12020$12022);(acc$12081=[]);;(temp$12086=children$11874);;($length$12091=temp$12086.length);;($index$12096=0);;$12078:for(;($index$12096<$length$12091);($index$12096++)){var c$12112;var m$12104;(m$12104=temp$12086[$index$12096]);;(c$12112=m$12104);acc$12081.push(HTML$11547(c$12112,default_tag$11810));}return acc$12081;}}()));($11879$12115=tag$11880);;if(($11879$12115==="raw")){return accum$11885.concat(children$11874).join("");}else{(other$12127=$11879$12115);(x$12130=[">"].concat(children$11874).concat(["</",tag$11880,">"]));;return accum$11885.concat(x$12130).join("");}}else{(other$12136=$11812$11818);return HTML$11547([true,String(other$12136)][1],default_tag$11810);}}}});;(exports["pr_terminus"]=pr_terminus$11541);(exports["pr"]=pr$11542);(exports["<>"]=__lt____gt__$11543);(exports["repr"]=repr$11544);

},{"./util":14}],12:[function(require,module,exports){
var $13665=function(type$13667){var f$13670;(f$13670=type$13667["::check"]);;if((f$13670===(void 0))){return function(value$13675){return (value$13675 instanceof type$13667);};}else{return function(value$13678){return f$13670.call(type$13667,value$13678);};}};
var $13680=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $13681=function($13682$13684){var ph$13688;(ph$13688=$13682$13684);;var $13686$13693;($13686$13693=ph$13688);;var bridge$13687$13698;var x$13702;(bridge$13687$13698=$13686$13693);if((((typeof(bridge$13687$13698)==="string")&&((x$13702=bridge$13687$13698),true))||((typeof(bridge$13687$13698)==="number")&&((x$13702=bridge$13687$13698),true)))){return ["value",x$13702];}else{var other$13709;(other$13709=$13686$13693);return other$13709["::serialize_ast"]();}};
var send$13549;(send$13549=function(obj$13554,$13552$13555){var ph$13559;var msg$13560;var t0$13562;(t0$13562=$13552$13555);(msg$13560=t0$13562);(ph$13559=t0$13562);;var $13557$13566;($13557$13566=ph$13559);;var bridge$13558$13571;(bridge$13558$13571=$13557$13566);if(((typeof(bridge$13558$13571)==="string")||(typeof(bridge$13558$13571)==="number"))){return obj$13554[msg$13560];}else{var other$13579;(other$13579=$13557$13566);return obj$13554["::send"](msg$13560);}});;(Array[":::project"]=function($13582$13584){var ph$13587;var value$13588;var t0$13590;(t0$13590=$13582$13584);(value$13588=t0$13590);(ph$13587=t0$13590);;var $13586$13594;($13586$13594=ph$13587);;if($13665(Array)($13586$13594)){return [true,value$13588];}else{$13586$13594;return [true,[value$13588]];}});(Array.prototype["::check"]=function(value$13608){if((value$13608 instanceof Array)){var i$13613;(i$13613=0);;$13611:for(;(i$13613<this.length);(i$13613++)){if(($13680(this,i$13613)!==$13680(value$13608,i$13613))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$13624){if((value$13624 instanceof Array)){var i$13629;(i$13629=0);;$13627:for(;(i$13629<this.length);(i$13629++)){if(($13680(this,i$13629)!==$13680(value$13624,i$13629))){return [true,[value$13624]];}}return [true,value$13624.slice(this.length)];}else{return [true,[value$13624]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($13681));});(RegExp.prototype["::check"]=function(value$13640){return value$13640.match(this);});(RegExp.prototype[":::project"]=function(value$13643){var $13645$13647;($13645$13647=value$13643.match(this));;var m$13655;if(($13645$13647===null)){(m$13655=$13645$13647);return [false,null];}else{var m$13660;(m$13660=$13645$13647);return [true,m$13660];}});(Function.prototype["::send"]=function(args$13663){return this.apply(this,args$13663);});
var $19812=function(dest$19814,values$19815){var k$19820;(k$19820=null);$19818:for(k$19820 in values$19815){if(values$19815.hasOwnProperty(k$19820)){(dest$19814[k$19820]=values$19815[k$19820]);}}return dest$19814;};
var $19824=function($19825$19827,key$19828){var ph$19832;(ph$19832=$19825$19827);;var $19830$19837;($19830$19837=ph$19832);;var bridge$19831$19842;(bridge$19831$19842=$19830$19837);if(((bridge$19831$19842===null)||(bridge$19831$19842===(void 0)))){return false;}else{var x$19850;if((typeof($19830$19837)==="string")){(x$19850=$19830$19837);return (key$19828 in String.prototype);}else{var x$19855;if((typeof($19830$19837)==="number")){(x$19855=$19830$19837);return (key$19828 in Number.prototype);}else{var x$19860;(x$19860=$19830$19837);return (key$19828 in x$19860);}}}};
var $20016=function(arr$20018){var results$20022;var l$20023;(results$20022=[]);;(l$20023=arr$20018.length);;var i$20031;(i$20031=0);;$20021:for(;(i$20031<l$20023);(i$20031++)){results$20022.push([i$20031,$13680(arr$20018,i$20031)]);}return results$20022;};
var $20038=function(value$20040,url$20041,start$20042,end$20043){var err$20046;(err$20046=$19862(["match"]).create("Could not find a match for value",({"value":value$20040})));;if(url$20041){(err$20046["location"]=["location",url$20041,start$20042,end$20043]);}throw err$20046;};
var $19862=function(){var $19863$19865;($19863$19865=function(tags$19869){var it$0$19872;(it$0$19872=function(){if((!$13665($19863$19865)(this))){return Object.create($19863$19865.prototype);}else{return this;}}());;(it$0$19872["tags"]=tags$19869);return it$0$19872;});;($19863$19865.prototype["create"]=function(){var $19881$19883;($19881$19883=arguments);;var t0$19888;var message$19892;var args$19893;(t0$19888=$19881$19883.length);if((t0$19888>=0)){(message$19892=function(){if((0>=t0$19888)){return "";}else{return $19881$19883[0];}}());(args$19893=Array.prototype.slice.call($19881$19883,1));var it$0$19897;(it$0$19897=this);;var e$19902;(e$19902=Error(message$19892));;(e$19902["::tags"]=it$0$19897.tags);(e$19902["args"]=args$19893);var temp$19910;(temp$19910=$20016(args$19893));;var $length$19915;($length$19915=temp$19910.length);;var $index$19920;($index$19920=0);;$19903:for(;($index$19920<$length$19915);($index$19920++)){var m$19928;(m$19928=temp$19910[$index$19920]);;var t0$19933;var t1$19934;var i$19938;var arg$19939;(t0$19933=m$19928);if(((t0$19933 instanceof Array)&&((t1$19934=t0$19933.length),(t1$19934===2)))){(i$19938=t0$19933[0]);(arg$19939=t0$19933[1]);(e$19902[i$19938]=arg$19939);}else{$20038(m$19928);;}}(e$19902["length"]=args$19893.length);(e$19902["name"]=["E"].concat(it$0$19897.tags).join("."));return e$19902;}else{$20038($19881$19883);}});($19863$19865.prototype["::check"]=function(e$19950){var it$0$19953;(it$0$19953=this);;var tags$19958;if(((!e$19950)||(!$13665(Error)(e$19950)))){return false;}(tags$19958=(e$19950["::tags"]||[]));;var temp$19967;(temp$19967=it$0$19953.tags);;var $length$19972;($length$19972=temp$19967.length);;var $index$19977;($index$19977=0);;$19959:for(;($index$19977<$length$19972);($index$19977++)){var m$19985;(m$19985=temp$19967[$index$19977]);;var tag$19993;(tag$19993=m$19985);if((tags$19958.indexOf(tag$19993)===-1)){return false;}else{false;;}}return true;});($19863$19865.prototype["::deconstruct"]=function(e$20001){var it$0$20004;(it$0$20004=this);;return e$20001.args;});$19812($19863$19865,$19812(function(){var accum$20009;(accum$20009=({}));(accum$20009["::name"]="$19863");return accum$20009;}(),function(){var accum$20013;(accum$20013=({}));(accum$20013["::egclass"]=true);return accum$20013;}()));return $19863$19865;}();
var $20067=function($20068$20070){var ph$20076;var x$20077;var t0$20079;(t0$20079=$20068$20070);(x$20077=t0$20079);(ph$20076=t0$20079);;var $20072$20083;($20072$20083=ph$20076);;var bridge$20073$20088;(bridge$20073$20088=$20072$20083);if((function(){var bridge$20074$20094;(bridge$20074$20094=bridge$20073$20088);return (function(){var bridge$20075$20097;(bridge$20075$20097=bridge$20074$20094);return ((bridge$20075$20097===(void 0))||(bridge$20075$20097===null));}()||(typeof(bridge$20074$20094)==="string"));}()||(typeof(bridge$20073$20088)==="number"))){return x$20077;}else{if($19824($20072$20083,"::clone")){$20072$20083["::clone"];return x$20077["::clone"]();}else{$20072$20083;if((Object.getPrototypeOf(x$20077)===Object.prototype)){var dest$20110;(dest$20110=({}));;var k$20115;(k$20115=null);$20109:for(k$20115 in x$20077){if(Object.prototype.hasOwnProperty.call(x$20077,k$20115)){(dest$20110[k$20115]=x$20077[k$20115]);}}return dest$20110;}else{var other$20121;(other$20121=$20072$20083);throw $19862(["clone"]).create("Object cannot be cloned",({"obj":x$20077}));}}}};
var $20051=function(a$20053,b$20054){var dest$20058;(dest$20058=$20067(a$20053));;var k$20063;(k$20063=null);$20057:for(k$20063 in b$20054){if(Object.prototype.hasOwnProperty.call(b$20054,k$20063)){(dest$20058[k$20063]=b$20054[k$20063]);}}return dest$20058;};
var $20123=function(type$20125){return function(value$20128){var f$20131;(f$20131=type$20125[":::project"]);;if((f$20131===(void 0))){var f$20136;(f$20136=type$20125["::project"]);;if((f$20136===(void 0))){return [true,type$20125(value$20128)];}else{var rval$20141;(rval$20141=false);;try{(rval$20141=[true,f$20136(value$20128)]);}catch(excv$20147){var e$20153;(e$20153=excv$20147);(rval$20141=[false,null]);}return rval$20141;}}else{return f$20131.call(type$20125,value$20128);}};};
var $20155=function(obj$20157){var results$20161;(results$20161=[]);;var k$20166;(k$20166=null);$20160:for(k$20166 in obj$20157){if(Object.prototype.hasOwnProperty.call(obj$20157,k$20166)){results$20161.push([k$20166,$13680(obj$20157,k$20166)]);}}return results$20161;};var accum$13862;var accum$13866;var $index$13903;var $length$13898;var temp$13893;var accum$14487;var accum$14495;var accum$14538;var accum$14549;var accum$14556;var accum$14580;var accum$14587;var accum$14598;var accum$14844;var accum$14898;var accum$14962;var accum$15024;var accum$15044;var accum$15116;var accum$15200;var accum$15228;var accum$15278;var accum$15325;var accum$15372;var accum$15410;var accum$15516;var accum$15623;var accum$15752;var accum$15772;var accum$16176;var accum$16312;var accum$16403;var t0$16475;var accum$16473;var t0$16621;var accum$16619;var t0$16675;var accum$16673;var t0$16817;var accum$16815;var t0$17057;var accum$17055;var accum$17217;var t0$17354;var accum$17352;var t0$17480;var accum$17478;var accum$17526;var t0$17548;var accum$17546;var t0$17564;var accum$17562;var t0$17580;var accum$17578;var t0$17596;var accum$17594;var accum$17610;var accum$17735;var accum$17850;var accum$17988;var accum$18183;var accum$18282;var accum$18627;var accum$18826;var $index$18901;var $length$18896;var temp$14840;var accum$19658;var accum$19662;var mac$19672;var $index$19783;var $length$19778;var temp$19773;var $13712$13717;var __lt____gt__$13718;var $13713$13719;var __lt____lt____colon__$13720;var util$13721;var neighbours$13722;var zip$13723;var uuid$13724;var $13715$13725;var PatternParser$13726;var PatternProcessor$13727;var parse_pattern$13728;var parse_clauses$13729;var mt$13730;var Expander$13731;var Scope$13732;var Env$13733;var nullenv$13734;var mac1$13735;var checker_db$13736;var generic_nodes$13737;var Embedded$13738;var stdenv$13739;var mkstdenv$13740;var expander$13741;var expand$13742;var topscope$13743;var embed_location$13744;var error_embed_location$13745;var match_error$13746;var drop_ctx$13747;var expr_mac$13748;var overridable$13749;var protected_value$13750;var setup_label$13751;var break_mac$13752;var continue_mac$13753;var var_operator$13754;var accum_flags$13755;var pattern_constructors$13756;var disregard_specials$13757;var pattern_handlers$13758;var build_loop$13759;var partial_pattern$13760;var make_assigner$13761;var blocktest_wrap$13762;var blocktest_mac$13763;var qqstruct$13764;var qq$13765;var RegexBuilder$13766;var build_regexp$13767;var errf_macro$13768;var stdprelude$13769;($13712$13717=require("./pp"));;(__lt____gt__$13718=$13712$13717["<>"]);;($13713$13719=require("./location"));;(__lt____lt____colon__$13720=$13713$13719["<<:"]);;(util$13721=require("./util"));;(neighbours$13722=util$13721.neighbours);;(zip$13723=util$13721.zip);;(uuid$13724=util$13721.uuid);;($13715$13725=require("./pattern"));;(PatternParser$13726=$13715$13725.PatternParser);;(PatternProcessor$13727=$13715$13725.PatternProcessor);;(parse_pattern$13728=$13715$13725.parse_pattern);;(parse_clauses$13729=$13715$13725.parse_clauses);;(mt$13730=require("./expand"));;(Expander$13731=mt$13730.Expander);;(Scope$13732=mt$13730.Scope);;(Env$13733=mt$13730.Env);;(nullenv$13734=mt$13730.nullenv);;(mac1$13735=mt$13730["mac1"]);;(checker_db$13736=mt$13730.checker_db);;(generic_nodes$13737=["if","js_while","js_for","js_for_in","js_label","js_break","js_continue","js_return","js_delete","js_throw","js_try","js_new"]);;(Embedded$13738=function(code$13842){var it$0$13845;(it$0$13845=function(){if((!$13665(Embedded$13738)(this))){return Object.create(Embedded$13738.prototype);}else{return this;}}());;(it$0$13845["code"]=mkstdenv$13740().convert(code$13842));(it$0$13845["::id"]=uuid$13724());return it$0$13845;});;(Embedded$13738.prototype["::serialize_ast"]=function(){var it$0$13857;(it$0$13857=this);;return expand$13742(["top"],topscope$13743,it$0$13857.code);});$19812(Embedded$13738,$19812(((accum$13862=({})),((accum$13862["::name"]="Embedded"),accum$13862)),((accum$13866=({})),((accum$13866["::egclass"]=true),accum$13866))));Embedded$13738;(stdenv$13739=Env$13733());;(mkstdenv$13740=function(){var e$13877;(e$13877=Env$13733());;(e$13877.scopes["top"]=stdenv$13739.scopes.top);return e$13877;});;(expander$13741=Expander$13731(mkstdenv$13740,generic_nodes$13737));;(expand$13742=expander$13741.expand.bind(expander$13741));;(topscope$13743=Scope$13732(null,"top",expander$13741));;(temp$13893=["+","-","*","/","mod","&.","|.","^.","and","or","not","===","!==","<",">","<=",">=","<<",">>",">>>","in","instanceof","--","++","true","false","null","undefined","typeof","String","Array","Number","Object","RegExp","Function","parseInt","parseFloat","Math","Error","TypeError","ReferenceError","console","process","eval","setTimeout","clearTimeout","___js_fetch","___node","arguments","this","exports"]);;($length$13898=temp$13893.length);;($index$13903=0);;$13770:for(;($index$13903<$length$13898);($index$13903++)){var k$13919;var m$13911;(m$13911=temp$13893[$index$13903]);;(k$13919=m$13911);stdenv$13739.bind(topscope$13743,k$13919,["variable",k$13919]);}(embed_location$13744=function($13923$13925){var other$13954;var url$13943;var start$13944;var end$13945;var t0$13938;var t1$13939;var $13927$13933;var ph$13928;(ph$13928=$13923$13925);;($13927$13933=ph$13928);;if(($19824($13927$13933,"location")&&((t0$13938=$13927$13933.location),($19824(t0$13938,"source")&&((t1$13939=t0$13938.source),($19824(t1$13939,"url")&&((url$13943=t1$13939.url),($19824(t0$13938,"start")&&((start$13944=t0$13938.start),$19824(t0$13938,"end")))))))))){(end$13945=t0$13938.end);return ["send",["send",["symbol","#"],["data",["void"],["symbol","location"]]],["data",["value",url$13943],["value",start$13944],["value",end$13945]]];}else{(other$13954=$13927$13933);return ["send",["send",["symbol","#"],["data",["void"],["symbol","location"]]],["data",["symbol","null"],["value",0],["value",0]]];}});;(error_embed_location$13745=function(error$13960,target$13961){return ["send",["symbol","throw"],["send",["symbol","&:"],["data",error$13960,["data",["send",["symbol","="],["data",["symbol","location"],embed_location$13744(target$13961)]]]]]];});;(match_error$13746=function($13966$13968){var t0$13974;var other$13999;var url$13988;var start$13989;var end$13990;var t0$13983;var t1$13984;var $13970$13978;var ph$13971;var target$13972;(t0$13974=$13966$13968);(target$13972=t0$13974);(ph$13971=t0$13974);;($13970$13978=ph$13971);;if(($19824($13970$13978,"location")&&((t0$13983=$13970$13978.location),($19824(t0$13983,"source")&&((t1$13984=t0$13983.source),($19824(t1$13984,"url")&&((url$13988=t1$13984.url),($19824(t0$13983,"start")&&((start$13989=t0$13983.start),$19824(t0$13983,"end")))))))))){(end$13990=t0$13983.end);return ["send",["symbol","___match_error"],["data",target$13972,["value",url$13988],["value",start$13989],["value",end$13990]]];}else{(other$13999=$13970$13978);return ["send",["symbol","___match_error"],["data",other$13999]];}});;(drop_ctx$13747=function(f$14005){return function(context$14008,scope$14009,form$14010,arg$14011){var rval$14014;(rval$14014=false);;try{(rval$14014=f$14005(context$14008,scope$14009,form$14010,arg$14011));}catch(excv$14020){var t0$14037;var e$14042;var t0$14023;var t1$14024;var t2$14025;var t3$14026;var t4$14027;(t0$14023=excv$14020);if(($13665($19862(["match"]))(t0$14023)&&($19824(t0$14023,"args")&&((t1$14024=t0$14023.args),((t1$14024 instanceof Array)&&((t2$14025=t1$14024.length),((t2$14025===1)&&((t3$14026=t1$14024[0]),($19824(t3$14026,"value")&&((t4$14027=t3$14026.value),((t4$14027===context$14008)&&(!((t4$14027 instanceof Array)&&((t0$14037=t4$14027.length),((t0$14037===2)&&((t4$14027[0]==="expr")&&(t4$14027[1]==="expr"))))))))))))))))){(rval$14014=["nostep",form$14010]);}else{(e$14042=excv$14020);(rval$14014=function(){throw e$14042;}());}}return rval$14014;};});;(expr_mac$13748=function(f$14048){return function($14050$14052,scope$14053,form$14054,arg$14055){var t0$14075;var t0$14078;var otherwise$14083;var bridge$14058$14069;var $14057$14064;var ph$14059;(ph$14059=$14050$14052);;($14057$14064=ph$14059);;(bridge$14058$14069=$14057$14064);if((((bridge$14058$14069 instanceof Array)&&((t0$14075=bridge$14058$14069.length),((t0$14075===2)&&((bridge$14058$14069[0]==="expr")&&(bridge$14058$14069[1]==="expr")))))||((bridge$14058$14069 instanceof Array)&&((t0$14078=bridge$14058$14069.length),((t0$14078===2)&&((bridge$14058$14069[0]==="expr")&&(bridge$14058$14069[1]==="head"))))))){return f$14048(scope$14053,form$14054,arg$14055);}else{(otherwise$14083=$14057$14064);return ["nostep",form$14054];}};});;(overridable$13749=function(f$14089){return function($14091$14093,scope$14094,form$14095,arg$14096){var t0$14102;var x$14117;var other$14129;var t0$14111;var $14098$14106;var ph$14099;var context$14100;(t0$14102=$14091$14093);(context$14100=t0$14102);(ph$14099=t0$14102);;($14098$14106=ph$14099);;if((((x$14117=$14098$14106)),((x$14117 instanceof Array)&&(x$14117[0]==="pattern")))){return ["nostep",form$14095];}else{if((($14098$14106 instanceof Array)&&((t0$14111=$14098$14106.length),((t0$14111===2)&&(($14098$14106[0]==="expr")&&($14098$14106[1]==="multi")))))){return ["nostep",form$14095];}else{(other$14129=$14098$14106);return f$14089(context$14100,scope$14094,form$14095,arg$14096);}}};});;(protected_value$13750=function(name$14135,value$14136){return function($14138$14140,scope$14141,form$14142,arg$14143){var x$14161;var other$14186;var t0$14177;var $14170$14172;var other$14168;var $14145$14151;var ph$14146;(ph$14146=$14138$14140);;($14145$14151=ph$14146);;if((((x$14161=$14145$14151)),((x$14161 instanceof Array)&&(x$14161[0]==="pattern")))){throw $19862(["syntax","pattern"]).create((("'"+name$14135)+"' is not a valid pattern and cannot be redeclared"));}else{(other$14168=$14145$14151);($14170$14172=arg$14143);;if((($14170$14172 instanceof Array)&&((t0$14177=$14170$14172.length),((t0$14177===1)&&($14170$14172[0]==="void"))))){return ["value",value$14136];}else{(other$14186=$14170$14172);return ["send",["value",value$14136],arg$14143];}}};});;(setup_label$13751=function(label$14192,env$14193,body$14194){return ["bind",$20051(["symbol","break"],({"env":env$14193})),["macro",break_mac$13752(label$14192)],["bind",$20051(["symbol","continue"],({"env":env$14193})),["macro",continue_mac$13753(label$14192)],["js_label",["value",label$14192],body$14194]]];});;(break_mac$13752=function(default_label$14200){return overridable$13749(function(context$14204,scope$14205,form$14206,$14202$14207){var t0$14217;var v$14248;var v$14243;var $14210$14228;var $14211$14229;var $14212$14230;var $14213$14231;var t0$14226;var $14209$14221;var ph$14214;var expr$14215;(t0$14217=$14202$14207);(expr$14215=t0$14217);(ph$14214=t0$14217);;($14209$14221=ph$14214);;if((($14210$14228=($14209$14221 instanceof Array))&&((t0$14226=$14209$14221.length),(($14212$14230=(t0$14226===1))&&(($14213$14231=($14209$14221[0]==="void"))&&default_label$14200))))){return ["js_break",["value",default_label$14200]];}else{if($14213$14231){return ["js_break"];}else{if(($14210$14228&&(($14212$14230=(t0$14226===2))&&($14209$14221[0]==="value")))){(v$14243=$14209$14221[1]);return ["js_break",expr$14215];}else{if(($14212$14230&&($14209$14221[0]==="symbol"))){(v$14248=$14209$14221[1]);return ["js_break",["value",v$14248]];}else{$20038($14209$14221);}}}}});});;(continue_mac$13753=function(default_label$14257){return overridable$13749(function(context$14261,scope$14262,form$14263,$14259$14264){var t0$14274;var v$14305;var v$14300;var $14267$14285;var $14268$14286;var $14269$14287;var $14270$14288;var t0$14283;var $14266$14278;var ph$14271;var expr$14272;(t0$14274=$14259$14264);(expr$14272=t0$14274);(ph$14271=t0$14274);;($14266$14278=ph$14271);;if((($14267$14285=($14266$14278 instanceof Array))&&((t0$14283=$14266$14278.length),(($14269$14287=(t0$14283===1))&&(($14270$14288=($14266$14278[0]==="void"))&&default_label$14257))))){return ["js_continue",["value",default_label$14257]];}else{if($14270$14288){return ["js_continue"];}else{if(($14267$14285&&(($14269$14287=(t0$14283===2))&&($14266$14278[0]==="value")))){(v$14300=$14266$14278[1]);return ["js_continue",expr$14272];}else{if(($14269$14287&&($14266$14278[0]==="symbol"))){(v$14305=$14266$14278[1]);return ["js_continue",["value",v$14305]];}else{$20038($14266$14278);}}}}});});;(var_operator$13754=function(name$14314){return function(context$14317,scope$14318,form$14319,expr$14320){var t0$14330;var x$14357;var other$14374;var s$14368;var t0$14363;var t1$14364;var $14324$14354;var $14325$14345;var $14326$14346;var t0$14343;var $14323$14338;var env$14327;var sym$14328;(t0$14330=form$14319);if($19824(t0$14330,"env")){(env$14327=t0$14330.env);;}else{$20038(form$14319,"/home/olivier/git/earl-grey/src/stdenv.eg",3498,3502);}(sym$14328=$20051(["symbol",name$14314],({"env":env$14327})));;($14323$14338=expr$14320);;if((($14325$14345=($14323$14338 instanceof Array))&&((t0$14343=$14323$14338.length),((t0$14343===1)&&($14323$14338[0]==="void"))))){return sym$14328;}else{if(($14325$14345&&((t0$14343===3)&&(($14323$14338[0]==="data")&&(((x$14357=$14323$14338[1])),((x$14357 instanceof Array)&&(x$14357[0]==="void"))))))){($14324$14354=$14323$14338[2]);(t0$14363=$14324$14354);if(((t0$14363 instanceof Array)&&((t1$14364=t0$14363.length),((t1$14364===2)&&(t0$14363[0]==="symbol"))))){(s$14368=t0$14363[1]);return ["send",sym$14328,["value",s$14368]];}else{(other$14374=$14324$14354);return ["send",sym$14328,other$14374];}}else{$20038($14323$14338);}}};});;(accum_flags$13755=function(){var make$14398;var mac$14393;var also_values$14394;var t0$14389;var $14382$14384;($14382$14384=arguments);;(t0$14389=$14382$14384.length);if(((t0$14389>=1)&&(t0$14389<=2))){(mac$14393=$14382$14384[0]);(also_values$14394=function(){if((1>=t0$14389)){return true;}else{return $14382$14384[1];}}());(make$14398=function(flags$14402){return function(context$14406,scope$14407,form$14408,$14404$14409){var other$14458;var flag$14445;var flag$14438;var $14412$14434;var $14413$14435;var t0$14424;var t1$14425;var t2$14426;var t3$14427;var t4$14428;var t5$14429;var t6$14430;var t7$14431;var t8$14432;var $14411$14419;var ph$14414;(ph$14414=$14404$14409);;($14411$14419=ph$14414);;if((($14412$14434=($14411$14419 instanceof Array))&&((t0$14424=$14411$14419.length),((t0$14424===2)&&(($14411$14419[0]==="value")&&((flag$14438=$14411$14419[1]),also_values$14394)))))){return ["macro",make$14398(flags$14402.concat([flag$14438]))];}else{if(($14412$14434&&((t0$14424===3)&&(($14411$14419[0]==="send")&&((t1$14425=$14411$14419[1]),((t1$14425 instanceof Array)&&((t2$14426=t1$14425.length),((t2$14426===2)&&((t1$14425[0]==="symbol")&&((t1$14425[1]===".")&&((t3$14427=$14411$14419[2]),((t3$14427 instanceof Array)&&((t4$14428=t3$14427.length),((t4$14428===3)&&((t3$14427[0]==="data")&&((t5$14429=t3$14427[1]),((t5$14429 instanceof Array)&&((t6$14430=t5$14429.length),((t6$14430===1)&&((t5$14429[0]==="void")&&((t7$14431=t3$14427[2]),((t7$14431 instanceof Array)&&((t8$14432=t7$14431.length),((t8$14432===2)&&(t7$14431[0]==="symbol"))))))))))))))))))))))))){(flag$14445=t7$14431[1]);return ["macro",make$14398(flags$14402.concat([flag$14445]))];}else{(other$14458=$14411$14419);return mac$14393(context$14406,scope$14407,form$14408,other$14458,flags$14402);}}};});;return make$14398([]);}else{$20038($14382$14384);}});;(pattern_constructors$13756=({}));;(disregard_specials$13757=function($14469$14471,value$14472){var t0$14477;var t1$14478;var kind$14474;var expr$14475;(t0$14477=$14469$14471);if(((t0$14477 instanceof Array)&&((t1$14478=t0$14477.length),((t1$14478===2)&&(t0$14477[0]==="special"))))){(kind$14474=t0$14477[1]);(expr$14475=t0$14477);;}else{$20038($14469$14471);}throw $19862(["syntax","pattern","special"]).create("Special token cannot be used here",({"special":expr$14475}));});;(pattern_handlers$13758=({"declare_variables":$19812(({"allow_nested":true,"allow_arguments":true,"special":disregard_specials$13757}),$19812(((accum$14487=({})),((accum$14487["assign"]=function(v$14491,value$14492){return ["do",__lt____lt____colon__$13720(["assign",v$14491,value$14492],v$14491)];}),accum$14487)),$19812(({"finalize":true}),$19812(((accum$14495=({})),((accum$14495["declare"]=function(vars$14499){var $index$14519;var $length$14514;var temp$14509;var acc$14504;(acc$14504=[]);;(temp$14509=vars$14499);;($length$14514=temp$14509.length);;($index$14519=0);;$14501:for(;($index$14519<$length$14514);($index$14519++)){var v$14535;var m$14527;(m$14527=temp$14509[$index$14519]);;(v$14535=m$14527);acc$14504.push(["declare",v$14535]);}return acc$14504;}),accum$14495)),$19812(((accum$14538=({})),((accum$14538["success"]=function($14541$14543){$14541$14543;;return ["multi"];}),accum$14538)),((accum$14549=({})),((accum$14549["failure"]=function(target$14553){return match_error$13746(target$14553);}),accum$14549))))))),"build_object":$19812(({"strings_as_variables":true,"allow_nested":true,"allow_arguments":true,"special":disregard_specials$13757}),$19812(((accum$14556=({})),((accum$14556["assign"]=function($14559$14562,value$14563){var t0$14570;var t0$14574;var bridge$14560$14567;var v$14565;(bridge$14560$14567=$14559$14562);if((((bridge$14560$14567 instanceof Array)&&((t0$14570=bridge$14560$14567.length),((t0$14570===2)&&((bridge$14560$14567[0]==="symbol")&&((v$14565=bridge$14560$14567[1]),true)))))||((bridge$14560$14567 instanceof Array)&&((t0$14574=bridge$14560$14567.length),((t0$14574===2)&&((bridge$14560$14567[0]==="value")&&((v$14565=bridge$14560$14567[1]),true))))))){;}else{$20038($14559$14562);}return ["do",__lt____lt____colon__$13720(["assign",["send",["symbol","accum"],["value",v$14565]],value$14563],v$14565)];}),accum$14556)),$19812(({"finalize":true}),$19812(((accum$14580=({})),((accum$14580["declare"]=function(vars$14584){return [["declare",["symbol","accum"],["data",["symbol","="]]]];}),accum$14580)),$19812(((accum$14587=({})),((accum$14587["success"]=function($14590$14592){$14590$14592;;return ["symbol","accum"];}),accum$14587)),((accum$14598=({})),((accum$14598["failure"]=function(target$14602){return match_error$13746(target$14602);}),accum$14598)))))))}));;(build_loop$13759=function(scope$14608,env$14609,form$14610,li$14611,clauses$14612,wrap$14613,pre$14614,post$14615,opt$14616){var t0$14636;var t0$14673;var accum$14716;var lbl$14619;var i$14620;var len$14621;var first_mac$14622;var last_mac$14623;var newscope$14624;var m$14625;(lbl$14619=function(){if(env$14609){return $20051(["value",scope$14608.gensym()],({"env":env$14609}));}else{return ["value",scope$14608.gensym()];}}());;(i$14620=$20051(["symbol","$index"],({"env":env$14609})));;(len$14621=$20051(["symbol","$length"],({"env":env$14609})));;(t0$14636=$20123(drop_ctx$13747)(function($14638$14640,scope$14641,form$14642,subp$14643){var x$14648;if((((x$14648=$14638$14640)),((x$14648 instanceof Array)&&(x$14648[0]==="pattern")))){;}else{$20038($14638$14640);}return ["test",["send",["symbol","==="],["data",i$14620,["value",0]]],subp$14643];}));if(t0$14636[0]){(first_mac$14622=t0$14636[1]);;}else{$20038(function($14656$14658,scope$14659,form$14660,subp$14661){var x$14666;if((((x$14666=$14656$14658)),((x$14666 instanceof Array)&&(x$14666[0]==="pattern")))){;}else{$20038($14656$14658);}return ["test",["send",["symbol","==="],["data",i$14620,["value",0]]],subp$14661];});}(t0$14673=$20123(drop_ctx$13747)(function($14675$14677,scope$14678,form$14679,subp$14680){var x$14685;if((((x$14685=$14675$14677)),((x$14685 instanceof Array)&&(x$14685[0]==="pattern")))){;}else{$20038($14675$14677);}return ["test",["send",["symbol","==="],["data",i$14620,["send",["symbol","-"],["data",len$14621,["value",1]]]]],subp$14680];}));if(t0$14673[0]){(last_mac$14623=t0$14673[1]);;}else{$20038(function($14693$14695,scope$14696,form$14697,subp$14698){var x$14703;if((((x$14703=$14693$14695)),((x$14703 instanceof Array)&&(x$14703[0]==="pattern")))){;}else{$20038($14693$14695);}return ["test",["send",["symbol","==="],["data",i$14620,["send",["symbol","-"],["data",len$14621,["value",1]]]]],subp$14698];});}(newscope$14624=Scope$13732(scope$14608));;env$14609.bind(newscope$14624,"first",["macro",first_mac$14622]);env$14609.bind(newscope$14624,"last",["macro",last_mac$14623]);(m$14625=__lt____lt____colon__$13720(["symbol","m"],form$14610));;return ["multi",pre$14614,["send",["symbol","let"],["data",["multi",["send",["symbol","="],["data",["symbol","temp"],li$14611]],["send",["symbol","="],["data",len$14621,["send",["symbol","temp"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]]],["send",["send",["symbol","for"],lbl$14619],["data",["multi",["send",["symbol","="],["data",i$14620,["value",0]]],["send",["symbol","<"],["data",i$14620,len$14621]],["send",["symbol","++"],["data",i$14620,["void"]]]],["multi",["send",["symbol","="],["data",m$14625,["send",["symbol","___js_fetch"],["data",["symbol","temp"],i$14620]]]],parse_clauses$13729(newscope$14624,m$14625,clauses$14612,$20051(opt$14616,((accum$14716=({})),((accum$14716["wrap"]=function(x$14720){return wrap$14613(x$14720,i$14620);}),accum$14716))))]]]]],post$14615];});;(partial_pattern$13760=function(operator$14726){var x$14744;var $14732$14734;var op$14729;(op$14729=((($14732$14734=operator$14726)),function(){if((((x$14744=$14732$14734)),((x$14744 instanceof Array)&&(x$14744[0]==="symbol")))){return operator$14726;}else{if((typeof($14732$14734)==="string")){return ["variable",operator$14726];}else{$20038($14732$14734);}}}()));;return function(context$14757,scope$14758,form$14759,expr$14760){var x$14787;var m$14797;var other$14813;var val$14783;var $14763$14778;var $14764$14779;var $14765$14780;var t0$14772;var t1$14773;var t2$14774;var t3$14775;var t4$14776;var $14762$14767;($14762$14767=[context$14757,expr$14760]);;if((($14763$14778=($14762$14767 instanceof Array))&&((t0$14772=$14762$14767.length),(($14765$14780=(t0$14772===2))&&((((x$14787=$14762$14767[0])),((x$14787 instanceof Array)&&(x$14787[0]==="pattern")))&&((t1$14773=$14762$14767[1]),((t1$14773 instanceof Array)&&((t2$14774=t1$14773.length),((t2$14774===3)&&((t1$14773[0]==="data")&&((t3$14775=t1$14773[1]),((t3$14775 instanceof Array)&&((t4$14776=t3$14775.length),((t4$14776===1)&&(t3$14775[0]==="void"))))))))))))))){(val$14783=t1$14773[2]);(m$14797=mac1$13735(function(x$14801){return ["send",op$14729,["data",x$14801,val$14783]];}));;return ["check",m$14797,["ignore"]];}else{if(($14765$14780&&($14762$14767[0],((t1$14773=$14762$14767[1]),((t1$14773 instanceof Array)&&((t2$14774=t1$14773.length),((t2$14774===1)&&(t1$14773[0]==="void")))))))){return op$14729;}else{(other$14813=$14762$14767);return ["send",op$14729,expr$14760];}}};});;(make_assigner$13761=function(op$14819){return function(context$14823,scope$14824,form$14825,$14821$14826){var t0$14831;var t1$14832;var a$14828;var b$14829;(t0$14831=$14821$14826);if(((t0$14831 instanceof Array)&&((t1$14832=t0$14831.length),((t1$14832===3)&&(t0$14831[0]==="data"))))){(a$14828=t0$14831[1]);(b$14829=t0$14831[2]);;}else{$20038($14821$14826);}return ["assign",a$14828,["send",["symbol",op$14819],["data",a$14828,b$14829]]];};});;(temp$14840=$20155($19812(({"true":protected_value$13750("true",true),"false":protected_value$13750("false",false),"null":protected_value$13750("null",null),"undefined":protected_value$13750("undefined",(void 0)),"===":partial_pattern$13760("==="),"!==":partial_pattern$13760("!=="),"==":partial_pattern$13760(["symbol","___equal"]),"!=":partial_pattern$13760(["symbol","___nequal"]),"<=":partial_pattern$13760("<="),">=":partial_pattern$13760(">="),"<":partial_pattern$13760("<"),">":partial_pattern$13760(">")}),$19812(((accum$14844=({})),((accum$14844["-"]=function(context$14849,scope$14850,form$14851,$14847$14852){var t0$14860;var other$14895;var n$14880;var $14855$14876;var $14856$14877;var t0$14869;var t1$14870;var t2$14871;var t3$14872;var t4$14873;var t5$14874;var $14854$14864;var ph$14857;var expr$14858;(t0$14860=$14847$14852);(expr$14858=t0$14860);(ph$14857=t0$14860);;($14854$14864=ph$14857);;if((($14855$14876=($14854$14864 instanceof Array))&&((t0$14869=$14854$14864.length),((t0$14869===3)&&(($14854$14864[0]==="data")&&((t1$14870=$14854$14864[1]),((t1$14870 instanceof Array)&&((t2$14871=t1$14870.length),((t2$14871===1)&&((t1$14870[0]==="void")&&((t3$14872=$14854$14864[2]),((t3$14872 instanceof Array)&&((t4$14873=t3$14872.length),((t4$14873===2)&&((t3$14872[0]==="value")&&((t5$14874=t3$14872[1]),(typeof(t5$14874)==="number"))))))))))))))))){(n$14880=t5$14874);return ["value",(-n$14880)];}else{if(($14855$14876&&((t0$14869===1)&&($14854$14864[0]==="void")))){return ["variable","-"];}else{(other$14895=$14854$14864);return ["send",["variable","-"],expr$14858];}}}),accum$14844)),$19812(((accum$14898=({})),((accum$14898["++"]=function(context$14903,scope$14904,form$14905,$14901$14906){var other$14959;var x$14949;var y$14950;var x$14941;var x$14933;var $14909$14927;var $14910$14928;var $14911$14929;var $14912$14930;var t0$14923;var t1$14924;var t2$14925;var $14908$14918;var ph$14913;(ph$14913=$14901$14906);;($14908$14918=ph$14913);;if((($14909$14927=($14908$14918 instanceof Array))&&((t0$14923=$14908$14918.length),(($14911$14929=(t0$14923===3))&&(($14912$14930=($14908$14918[0]==="data"))&&((t1$14924=$14908$14918[1]),((t1$14924 instanceof Array)&&((t2$14925=t1$14924.length),((t2$14925===1)&&(t1$14924[0]==="void")))))))))){(x$14933=$14908$14918[2]);return ["send",["variable","++"],["data",["void"],x$14933]];}else{if(($14912$14930&&((x$14941=$14908$14918[1]),((t1$14924=$14908$14918[2]),((t1$14924 instanceof Array)&&((t2$14925=t1$14924.length),((t2$14925===1)&&(t1$14924[0]==="void")))))))){return ["send",["variable","++"],["data",x$14941,["void"]]];}else{if($14912$14930){(x$14949=$14908$14918[1]);(y$14950=$14908$14918[2]);return ["send",["send",x$14949,["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",y$14950]];}else{if(($14909$14927&&((t0$14923===1)&&($14908$14918[0]==="void")))){return ["send",["symbol","->"],["data",["data",["symbol","x"],["symbol","y"]],["send",["send",["symbol","x"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",["symbol","y"]]]]];}else{(other$14959=$14908$14918);return ["send",["symbol","___build_array"],["data",other$14959]];}}}}}),accum$14898)),$19812(((accum$14962=({})),((accum$14962[".."]=function(context$14967,scope$14968,form$14969,$14965$14970){var x$15013;var y$15014;var x$15005;var x$14997;var $14973$14991;var $14974$14992;var $14975$14993;var $14976$14994;var t0$14987;var t1$14988;var t2$14989;var $14972$14982;var ph$14977;(ph$14977=$14965$14970);;($14972$14982=ph$14977);;if((($14973$14991=($14972$14982 instanceof Array))&&((t0$14987=$14972$14982.length),(($14975$14993=(t0$14987===3))&&(($14976$14994=($14972$14982[0]==="data"))&&((t1$14988=$14972$14982[1]),((t1$14988 instanceof Array)&&((t2$14989=t1$14988.length),((t2$14989===1)&&(t1$14988[0]==="void")))))))))){(x$14997=$14972$14982[2]);return ["send",["symbol","range"],["data",["value",1],x$14997]];}else{if(($14976$14994&&((x$15005=$14972$14982[1]),((t1$14988=$14972$14982[2]),((t1$14988 instanceof Array)&&((t2$14989=t1$14988.length),((t2$14989===1)&&(t1$14988[0]==="void")))))))){return ["send",["symbol","range"],["data",x$15005]];}else{if($14976$14994){(x$15013=$14972$14982[1]);(y$15014=$14972$14982[2]);return ["send",["symbol","range"],["data",x$15013,y$15014]];}else{if(($14973$14991&&((t0$14987===1)&&($14972$14982[0]==="void")))){return ["symbol","range"];}else{$20038($14972$14982);}}}}}),accum$14962)),$19812(((accum$15024=({})),((accum$15024["//"]=function(context$15029,scope$15030,form$15031,$15027$15032){var t0$15037;var t1$15038;var a$15034;var b$15035;(t0$15037=$15027$15032);if(((t0$15037 instanceof Array)&&((t1$15038=t0$15037.length),((t1$15038===3)&&(t0$15037[0]==="data"))))){(a$15034=t0$15037[1]);(b$15035=t0$15037[2]);;}else{$20038($15027$15032);}return ["send",["send",["symbol","Math"],["send",["symbol","."],["data",["void"],["symbol","floor"]]]],["data",["send",["symbol","/"],["data",a$15034,b$15035]]]];}),accum$15024)),$19812(((accum$15044=({})),((accum$15044["*"]=function(context$15048,scope$15049,form$15050,expr$15051){var x$15079;var x$15092;var t0$15097;var other$15113;var val$15088;var $15055$15071;var $15056$15072;var $15057$15073;var t0$15064;var t1$15065;var t2$15066;var bridge$15054$15067;var t3$15068;var t4$15069;var $15053$15059;($15053$15059=[context$15048,expr$15051]);;if((($15055$15071=($15053$15059 instanceof Array))&&((t0$15064=$15053$15059.length),(($15057$15073=(t0$15064===2))&&((((x$15079=$15053$15059[0])),((x$15079 instanceof Array)&&(x$15079[0]==="pattern")))&&((t1$15065=$15053$15059[1]),((t1$15065 instanceof Array)&&((t2$15066=t1$15065.length),((t2$15066===1)&&(t1$15065[0]==="void")))))))))){return ["dynsplice",["ignore"]];}else{if(($15057$15073&&((bridge$15054$15067=$15053$15059[0]),(((((x$15092=bridge$15054$15067)),((x$15092 instanceof Array)&&(x$15092[0]==="pattern")))||((bridge$15054$15067 instanceof Array)&&((t0$15097=bridge$15054$15067.length),((t0$15097===2)&&((bridge$15054$15067[0]==="expr")&&(bridge$15054$15067[1]==="data"))))))&&((t1$15065=$15053$15059[1]),((t1$15065 instanceof Array)&&((t2$15066=t1$15065.length),((t2$15066===3)&&((t1$15065[0]==="data")&&((t3$15068=t1$15065[1]),((t3$15068 instanceof Array)&&((t4$15069=t3$15068.length),((t4$15069===1)&&(t3$15068[0]==="void")))))))))))))){(val$15088=t1$15065[2]);return ["dynsplice",val$15088];}else{if(($15057$15073&&($15053$15059[0],((t1$15065=$15053$15059[1]),((t1$15065 instanceof Array)&&((t2$15066=t1$15065.length),((t2$15066===1)&&(t1$15065[0]==="void")))))))){return ["variable","*"];}else{(other$15113=$15053$15059);return ["send",["variable","*"],expr$15051];}}}}),accum$15044)),$19812(((accum$15116=({})),((accum$15116["**"]=function(context$15120,scope$15121,form$15122,expr$15123){var x$15159;var x$15172;var t0$15177;var a$15193;var b$15194;var val$15168;var $15127$15147;var $15128$15148;var $15129$15149;var $15130$15150;var $15131$15151;var $15132$15152;var $15133$15153;var t0$15140;var t1$15141;var t2$15142;var bridge$15126$15143;var t3$15144;var t4$15145;var $15125$15135;($15125$15135=[context$15120,expr$15123]);;if((($15127$15147=($15125$15135 instanceof Array))&&((t0$15140=$15125$15135.length),(($15129$15149=(t0$15140===2))&&((((x$15159=$15125$15135[0])),((x$15159 instanceof Array)&&(x$15159[0]==="pattern")))&&((t1$15141=$15125$15135[1]),((t1$15141 instanceof Array)&&((t2$15142=t1$15141.length),((t2$15142===1)&&(t1$15141[0]==="void")))))))))){return ["objsplice",["ignore"]];}else{if(($15129$15149&&((bridge$15126$15143=$15125$15135[0]),(((((x$15172=bridge$15126$15143)),((x$15172 instanceof Array)&&(x$15172[0]==="pattern")))||((bridge$15126$15143 instanceof Array)&&((t0$15177=bridge$15126$15143.length),((t0$15177===2)&&((bridge$15126$15143[0]==="expr")&&(bridge$15126$15143[1]==="data"))))))&&((t1$15141=$15125$15135[1]),((t1$15141 instanceof Array)&&((t2$15142=t1$15141.length),((t2$15142===3)&&((t1$15141[0]==="data")&&((t3$15144=t1$15141[1]),((t3$15144 instanceof Array)&&((t4$15145=t3$15144.length),((t4$15145===1)&&(t3$15144[0]==="void")))))))))))))){(val$15168=t1$15141[2]);return ["objsplice",val$15168];}else{if(($15129$15149&&($15125$15135[0],((t1$15141=$15125$15135[1]),(($15132$15152=(t1$15141 instanceof Array))&&((t2$15142=t1$15141.length),((t2$15142===1)&&(t1$15141[0]==="void")))))))){return ["send",["symbol","Math"],["send",["symbol","."],["data",["void"],["symbol","pow"]]]];}else{if(($15132$15152&&((t2$15142===3)&&(t1$15141[0]==="data")))){(a$15193=t1$15141[1]);(b$15194=t1$15141[2]);return ["send",["send",["symbol","Math"],["send",["symbol","."],["data",["void"],["symbol","pow"]]]],["data",a$15193,b$15194]];}else{$20038($15125$15135);}}}}}),accum$15116)),$19812(((accum$15200=({})),((accum$15200["_"]=function($15203$15206,scope$15207,form$15208,$15204$15209){var x$15214;var t0$15221;var t1$15222;if((((x$15214=$15203$15206)),((x$15214 instanceof Array)&&(x$15214[0]==="pattern")))){;}else{$20038($15203$15206);}(t0$15221=$15204$15209);if(((t0$15221 instanceof Array)&&((t1$15222=t0$15221.length),((t1$15222===1)&&(t0$15221[0]==="void"))))){;}else{$20038($15204$15209);}return ["ignore"];}),accum$15200)),$19812(((accum$15228=({})),((accum$15228["not"]=function($15231$15234,scope$15235,form$15236,$15232$15237){var t0$15247;var t1$15248;var t2$15249;var t3$15250;var x$15268;var other$15275;var $15239$15258;var ph$15240;var rhs$15241;var arg$15242;(ph$15240=$15231$15234);;(t0$15247=$15232$15237);if(((t0$15247 instanceof Array)&&((t1$15248=t0$15247.length),((t1$15248===3)&&((t0$15247[0]==="data")&&((t2$15249=t0$15247[1]),((t2$15249 instanceof Array)&&((t3$15250=t2$15249.length),((t3$15250===1)&&(t2$15249[0]==="void")))))))))){(rhs$15241=t0$15247[2]);(arg$15242=t0$15247);;}else{$20038($15232$15237);}($15239$15258=ph$15240);;if((((x$15268=$15239$15258)),((x$15268 instanceof Array)&&(x$15268[0]==="pattern")))){return ["neg",rhs$15241];}else{(other$15275=$15239$15258);return ["send",["variable","not"],arg$15242];}}),accum$15228)),$19812(((accum$15278=({})),((accum$15278["and"]=function($15281$15284,scope$15285,form$15286,$15282$15287){var t0$15298;var t1$15299;var x$15315;var other$15322;var $15289$15305;var ph$15290;var lhs$15291;var rhs$15292;var arg$15293;(ph$15290=$15281$15284);;(t0$15298=$15282$15287);if(((t0$15298 instanceof Array)&&((t1$15299=t0$15298.length),((t1$15299===3)&&(t0$15298[0]==="data"))))){(lhs$15291=t0$15298[1]);(rhs$15292=t0$15298[2]);(arg$15293=t0$15298);;}else{$20038($15282$15287);}($15289$15305=ph$15290);;if((((x$15315=$15289$15305)),((x$15315 instanceof Array)&&(x$15315[0]==="pattern")))){return ["all",lhs$15291,rhs$15292];}else{(other$15322=$15289$15305);return ["send",["variable","and"],arg$15293];}}),accum$15278)),$19812(((accum$15325=({})),((accum$15325["or"]=function($15328$15331,scope$15332,form$15333,$15329$15334){var t0$15345;var t1$15346;var x$15362;var other$15369;var $15336$15352;var ph$15337;var lhs$15338;var rhs$15339;var arg$15340;(ph$15337=$15328$15331);;(t0$15345=$15329$15334);if(((t0$15345 instanceof Array)&&((t1$15346=t0$15345.length),((t1$15346===3)&&(t0$15345[0]==="data"))))){(lhs$15338=t0$15345[1]);(rhs$15339=t0$15345[2]);(arg$15340=t0$15345);;}else{$20038($15329$15334);}($15336$15352=ph$15337);;if((((x$15362=$15336$15352)),((x$15362 instanceof Array)&&(x$15362[0]==="pattern")))){return ["any",lhs$15338,rhs$15339];}else{(other$15369=$15336$15352);return ["send",["variable","or"],arg$15340];}}),accum$15325)),$19812(((accum$15372=({})),((accum$15372["when"]=function(context$15377,scope$15378,form$15379,$15375$15380){var t0$15386;var t1$15387;var other$15407;var t0$15398;var $15382$15393;var ph$15383;var condition$15384;(t0$15386=$15375$15380);if(((t0$15386 instanceof Array)&&((t1$15387=t0$15386.length),((t1$15387===3)&&(t0$15386[0]==="data"))))){(ph$15383=t0$15386[1]);(condition$15384=t0$15386[2]);;}else{$20038($15375$15380);}($15382$15393=ph$15383);;if((($15382$15393 instanceof Array)&&((t0$15398=$15382$15393.length),((t0$15398===1)&&($15382$15393[0]==="void"))))){return ["test",condition$15384,["ignore"]];}else{(other$15407=$15382$15393);return ["test",condition$15384,other$15407];}}),accum$15372)),$19812(((accum$15410=({})),((accum$15410["."]=function(context$15415,scope$15416,form$15417,$15413$15418){var t0$15422;var t1$15423;var t2$15424;var t3$15425;var f$15433;var expr$15420;(t0$15422=$15413$15418);if(((t0$15422 instanceof Array)&&((t1$15423=t0$15422.length),((t1$15423===3)&&((t0$15422[0]==="data")&&((t2$15424=t0$15422[1]),((t2$15424 instanceof Array)&&((t3$15425=t2$15424.length),((t3$15425===1)&&(t2$15424[0]==="void")))))))))){(expr$15420=t0$15422[2]);;}else{$20038($15413$15418);}(f$15433=function($15436$15438){var t0$15460;var t0$15464;var $index$15492;var $length$15487;var temp$15482;var acc$15477;var other$15512;var args$15470;var x$15457;var bridge$15441$15452;var t0$15453;var $15440$15447;var ph$15442;(ph$15442=$15436$15438);;($15440$15447=ph$15442);;(bridge$15441$15452=$15440$15447);if((((bridge$15441$15452 instanceof Array)&&((t0$15460=bridge$15441$15452.length),((t0$15460===2)&&((bridge$15441$15452[0]==="symbol")&&((x$15457=bridge$15441$15452[1]),true)))))||((bridge$15441$15452 instanceof Array)&&((t0$15464=bridge$15441$15452.length),((t0$15464===2)&&((bridge$15441$15452[0]==="value")&&((x$15457=bridge$15441$15452[1]),true))))))){return ["value",x$15457];}else{if((($15440$15447 instanceof Array)&&((t0$15453=$15440$15447.length),((t0$15453>=1)&&($15440$15447[0]==="data"))))){(args$15470=Array.prototype.slice.call($15440$15447,1));return ["data"].concat((((acc$15477=[])),(((temp$15482=args$15470)),((($length$15487=temp$15482.length)),((($index$15492=0)),function(){$15474:for(;($index$15492<$length$15487);($index$15492++)){var arg$15508;var m$15500;(m$15500=temp$15482[$index$15492]);;(arg$15508=m$15500);acc$15477.push(f$15433(arg$15508));}}()))),acc$15477));}else{(other$15512=$15440$15447);throw $19862(["syntax","dot"]).create("Argument to '.' must be a symbol or an array",({"argument":other$15512}));}}});;return f$15433(expr$15420);}),accum$15410)),$19812(((accum$15516=({})),((accum$15516["="]=function(context$15520,scope$15521,form$15522,expr$15523){var t0$15551;var t1$15552;var lhs$15548;var rhs$15549;var lhs$15595;var rhs$15596;var s$15587;var rhs$15588;var $15562$15576;var $15563$15577;var $15564$15578;var $15565$15579;var t0$15572;var t1$15573;var t2$15574;var $15561$15567;var x$15605;var t0$15614;var t1$15615;var lhs$15611;var rhs$15612;var $15526$15538;var $15527$15539;var $15528$15540;var $15529$15541;var t0$15536;var $15525$15531;($15525$15531=context$15520);;if((($15526$15538=($15525$15531 instanceof Array))&&((t0$15536=$15525$15531.length),(($15528$15540=(t0$15536===2))&&(($15529$15541=($15525$15531[0]==="expr"))&&($15525$15531[1]==="multi")))))){(t0$15551=expr$15523);if(((t0$15551 instanceof Array)&&((t1$15552=t0$15551.length),((t1$15552===3)&&(t0$15551[0]==="data"))))){(lhs$15548=t0$15551[1]);(rhs$15549=t0$15551[2]);;}else{$20038(expr$15523,"/home/olivier/git/earl-grey/src/stdenv.eg",10464,10468);}return parse_pattern$13728(scope$15521,lhs$15548,__lt____lt____colon__$13720(["use",scope$15521,rhs$15549],rhs$15549),pattern_handlers$13758.declare_variables);}else{if(($15529$15541&&($15525$15531[1]==="data"))){($15561$15567=expr$15523);;if((($15562$15576=($15561$15567 instanceof Array))&&((t0$15572=$15561$15567.length),((t0$15572===1)&&($15561$15567[0]==="void"))))){return ["assoc"];}else{if(($15562$15576&&(($15564$15578=(t0$15572===3))&&(($15565$15579=($15561$15567[0]==="data"))&&((t1$15573=$15561$15567[1]),((t1$15573 instanceof Array)&&((t2$15574=t1$15573.length),((t2$15574===2)&&(t1$15573[0]==="symbol"))))))))){(s$15587=t1$15573[1]);(rhs$15588=$15561$15567[2]);return ["assoc",["value",s$15587],rhs$15588];}else{if($15565$15579){(lhs$15595=$15561$15567[1]);(rhs$15596=$15561$15567[2]);return ["objsplice",["multi",parse_pattern$13728(scope$15521,lhs$15595,__lt____lt____colon__$13720(["use",scope$15521,rhs$15596],rhs$15596),pattern_handlers$13758.build_object)]];}else{$20038($15561$15567);}}}}else{if((((x$15605=$15525$15531)),((x$15605 instanceof Array)&&(x$15605[0]==="pattern")))){(t0$15614=expr$15523);if(((t0$15614 instanceof Array)&&((t1$15615=t0$15614.length),((t1$15615===3)&&(t0$15614[0]==="data"))))){(lhs$15611=t0$15614[1]);(rhs$15612=t0$15614[2]);;}else{$20038(expr$15523,"/home/olivier/git/earl-grey/src/stdenv.eg",11101,11105);}return ["default",lhs$15611,rhs$15612];}else{$20038($15525$15531);}}}}),accum$15516)),$19812(((accum$15623=({})),((accum$15623["=>"]=function($15626$15630,scope$15631,$15627$15632,$15628$15633){var t0$15644;var t0$15649;var t1$15650;var x$15666;var x$15696;var t0$15702;var t0$15706;var t0$15717;var t0$15721;var k$15712;var rhs$15713;var k$15692;var $15674$15687;var $15675$15688;var $15676$15689;var t0$15683;var bridge$15672$15684;var bridge$15673$15685;var $15671$15678;var x$15731;var t0$15739;var t1$15740;var t2$15741;var stmts$15737;var other$15749;var $15635$15656;var ph$15636;var env$15637;var lhs$15638;var rhs$15639;(ph$15636=$15626$15630);;(t0$15644=$15627$15632);if($19824(t0$15644,"env")){(env$15637=t0$15644.env);;}else{$20038($15627$15632);}(t0$15649=$15628$15633);if(((t0$15649 instanceof Array)&&((t1$15650=t0$15649.length),((t1$15650===3)&&(t0$15649[0]==="data"))))){(lhs$15638=t0$15649[1]);(rhs$15639=t0$15649[2]);;}else{$20038($15628$15633);}($15635$15656=ph$15636);;if((((x$15666=$15635$15656)),((x$15666 instanceof Array)&&(x$15666[0]==="pattern")))){($15671$15678=[lhs$15638,rhs$15639]);;if((($15674$15687=($15671$15678 instanceof Array))&&((t0$15683=$15671$15678.length),(($15676$15689=(t0$15683===2))&&((((x$15696=$15671$15678[0])),((x$15696 instanceof Array)&&(x$15696[0]==="void")))&&((bridge$15672$15684=$15671$15678[1]),(((bridge$15672$15684 instanceof Array)&&((t0$15702=bridge$15672$15684.length),((t0$15702===2)&&((bridge$15672$15684[0]==="symbol")&&((k$15692=bridge$15672$15684[1]),true)))))||((bridge$15672$15684 instanceof Array)&&((t0$15706=bridge$15672$15684.length),((t0$15706===2)&&((bridge$15672$15684[0]==="value")&&((k$15692=bridge$15672$15684[1]),true)))))))))))){return ["assoc",["value",k$15692],$20051(["symbol",k$15692],({"env":env$15637}))];}else{if(($15676$15689&&((bridge$15673$15685=$15671$15678[0]),(((bridge$15673$15685 instanceof Array)&&((t0$15717=bridge$15673$15685.length),((t0$15717===2)&&((bridge$15673$15685[0]==="symbol")&&((k$15712=bridge$15673$15685[1]),true)))))||((bridge$15673$15685 instanceof Array)&&((t0$15721=bridge$15673$15685.length),((t0$15721===2)&&((bridge$15673$15685[0]==="value")&&((k$15712=bridge$15673$15685[1]),true))))))))){(rhs$15713=$15671$15678[1]);return ["assoc",["value",k$15712],rhs$15713];}else{$20038($15671$15678);}}}else{if((((x$15731=$15635$15656)),((x$15731 instanceof Array)&&(x$15731[0]==="test")))){(t0$15739=$20123(["multi"])(rhs$15639));if((t0$15739[0]&&((t1$15740=t0$15739[1]),((t2$15741=t1$15740.length),(t2$15741>=0))))){(stmts$15737=Array.prototype.slice.call(t1$15740,0));;}else{$20038(rhs$15639,"/home/olivier/git/earl-grey/src/stdenv.eg",11578,11581);}return ["blocktest",lhs$15638,stmts$15737];}else{(other$15749=$15635$15656);return ["assoc",lhs$15638,rhs$15639];}}}),accum$15623)),$19812(((accum$15752=({})),((accum$15752[":="]=function(context$15757,scope$15758,form$15759,$15755$15760){var t0$15765;var t1$15766;var lhs$15762;var rhs$15763;(t0$15765=$15755$15760);if(((t0$15765 instanceof Array)&&((t1$15766=t0$15765.length),((t1$15766===3)&&(t0$15765[0]==="data"))))){(lhs$15762=t0$15765[1]);(rhs$15763=t0$15765[2]);;}else{$20038($15755$15760);}return ["assign",lhs$15762,rhs$15763];}),accum$15752)),$19812(({"+=":make_assigner$13761("+"),"-=":make_assigner$13761("-"),"*=":make_assigner$13761("*"),"/=":make_assigner$13761("/"),"<<=":make_assigner$13761("<<"),">>=":make_assigner$13761(">>"),">>>=":make_assigner$13761(">>>"),"++=":make_assigner$13761("++"),"?=":make_assigner$13761("match"),"or=":make_assigner$13761("or"),"and=":make_assigner$13761("and"),"each=":make_assigner$13761("each")}),$19812(((accum$15772=({})),((accum$15772["->"]=function($15775$15777,scope$15778,form$15779,expr$15780){var x$15798;var t0$15807;var t1$15808;var lhs$15804;var rhs$15805;var $index$15912;var $length$15907;var temp$15902;var acc$15897;var decls$15886;var newargs$15887;var body$16003;var a$15998;var other$15995;var fw$15876;var t0$15868;var t1$15869;var t2$15870;var t3$15871;var t4$15872;var $15857$15863;var pp$15858;var other$16015;var args$16009;var rhs$16010;var args$15848;var arg$15849;var rhs$15850;var $15818$15837;var $15819$15838;var $15820$15839;var $15821$15840;var $15822$15841;var $15823$15842;var $15824$15843;var $15825$15844;var $15826$15845;var t0$15833;var t1$15834;var t2$15835;var $15817$15828;var other$15815;var $15782$15788;var ph$15783;(ph$15783=$15775$15777);;($15782$15788=ph$15783);;if((((x$15798=$15782$15788)),((x$15798 instanceof Array)&&(x$15798[0]==="clause")))){(t0$15807=expr$15780);if(((t0$15807 instanceof Array)&&((t1$15808=t0$15807.length),((t1$15808===3)&&(t0$15807[0]==="data"))))){(lhs$15804=t0$15807[1]);(rhs$15805=t0$15807[2]);;}else{$20038(expr$15780,"/home/olivier/git/earl-grey/src/stdenv.eg",12198,12202);}return ["clause",lhs$15804,rhs$15805];}else{(other$15815=$15782$15788);($15817$15828=expr$15780);;if((($15818$15837=($15817$15828 instanceof Array))&&((t0$15833=$15817$15828.length),(($15820$15839=(t0$15833===3))&&(($15821$15840=($15817$15828[0]==="data"))&&((t1$15834=$15817$15828[1]),(($15823$15842=(t1$15834 instanceof Array))&&((t2$15835=t1$15834.length),(($15825$15844=(t2$15835>=1))&&($15826$15845=(t1$15834[0]==="data"))))))))))){(args$15848=Array.prototype.slice.call(t1$15834,1));(arg$15849=t1$15834);(rhs$15850=$15817$15828[2]);(pp$15858=PatternParser$13726(scope$15778,arg$15849,({"indexable":true,"allow_nested":true})));;($15857$15863=pp$15858.pattern);;if((($15857$15863 instanceof Array)&&((t0$15868=$15857$15863.length),((t0$15868===5)&&(($15857$15863[0]==="array_pattern")&&((fw$15876=$15857$15863[1]),((t1$15869=$15857$15863[2]),((t1$15869 instanceof Array)&&((t2$15870=t1$15869.length),((t2$15870===0)&&((t3$15871=$15857$15863[3]),((t3$15871 instanceof Array)&&((t4$15872=t3$15871.length),((t4$15872===0)&&($15857$15863[4]===(void 0)))))))))))))))){(decls$15886=function(){if(pp$15858.specials.match){return [["declare",["symbol","ph"]]];}else{return [];}}());;(newargs$15887=(((acc$15897=[])),(((temp$15902=zip$13723(fw$15876,args$15848))),((($length$15907=temp$15902.length)),((($index$15912=0)),function(){$15893:for(;($index$15912<$length$15907);($index$15912++)){var newv$15956;var other$15953;var expr$15943;var v$15944;var t0$15936;var t1$15937;var t2$15938;var t3$15939;var arg$15930;var $15895$15931;var t0$15925;var t1$15926;var m$15920;(m$15920=temp$15902[$index$15912]);;(t0$15925=m$15920);if(((t0$15925 instanceof Array)&&((t1$15926=t0$15925.length),(t1$15926===2)))){($15895$15931=t0$15925[0]);(arg$15930=t0$15925[1]);(t0$15936=$15895$15931);if(((t0$15936 instanceof Array)&&((t1$15937=t0$15936.length),((t1$15937===2)&&((t0$15936[0]==="assign")&&((t2$15938=t0$15936[1]),((expr$15943=t2$15938),((t2$15938 instanceof Array)&&((t3$15939=t2$15938.length),((t3$15939===2)&&(t2$15938[0]==="symbol"))))))))))){(v$15944=t2$15938[1]);acc$15897.push(expr$15943);}else{(other$15953=$15895$15931);acc$15897.push((((newv$15956=$20051(["symbol",scope$15778.gensym("temp")],({"env":stdenv$13739})))),decls$15886.push(parse_pattern$13728(scope$15778,arg$15930,newv$15956,$20051(pattern_handlers$13758.declare_variables,({"special":function($15960$15962,value$15963){var t0$15969;var t1$15970;var other$15988;var $15965$15976;var ph$15966;var expr$15967;(t0$15969=$15960$15962);if(((t0$15969 instanceof Array)&&((t1$15970=t0$15969.length),((t1$15970===2)&&(t0$15969[0]==="special"))))){(ph$15966=t0$15969[1]);(expr$15967=t0$15969);;}else{$20038($15960$15962);}($15965$15976=ph$15966);;if(($15965$15976==="match")){return ["assign",["symbol","ph"]];}else{(other$15988=$15965$15976);throw $19862(["syntax","pattern","special"]).create("Special token cannot be used here",({"special":expr$15967}));}}})))),newv$15956));}}else{$20038(m$15920,"/home/olivier/git/earl-grey/src/stdenv.eg",12674,13636);;}}}()))),acc$15897));;return ["lambda",newargs$15887,["multi"].concat(decls$15886).concat([function(){if(pp$15858.specials.match){return ["send",["symbol","match"],["data",["symbol","ph"],rhs$15850]];}else{return rhs$15850;}}()])];}else{(other$15995=$15857$15863);(a$15998=__lt____lt____colon__$13720(["symbol","arguments"],arg$15849));;(body$16003=["send",["send",["symbol","match"],["send",["symbol","."],["data",["void"],["symbol","indexable"]]]],["data",a$15998,["send",["symbol","->"],["data",arg$15849,rhs$15850]]]]);;return ["lambda",[],body$16003];}}else{if($15826$15845){(args$16009=Array.prototype.slice.call(t1$15834,1));(rhs$16010=$15817$15828[2]);return ["lambda",args$16009,rhs$16010];}else{(other$16015=$15817$15828);throw $19862(["syntax","lambda"]).create("Bad lambda syntax",({"node":other$16015}));}}}}),accum$15772)),$19812(({"match":accum_flags$13755(function($16017$16019,scope$16020,form$16021,expr$16022,flags$16023){var x$16041;var other$16062;var t0$16053;var $16046$16048;var v$16110;var b$16111;var b$16101;var $16084$16097;var $16085$16098;var t0$16092;var t1$16093;var t2$16094;var t3$16095;var $16083$16087;var v$16150;var b$16151;var b$16141;var $16124$16137;var $16125$16138;var t0$16132;var t1$16133;var t2$16134;var t3$16135;var $16123$16127;var t0$16080;var t1$16081;var accum$16165;var mbody$16161;var opt$16069;var to_match$16070;var value$16071;var body$16072;var other$16066;var $16025$16031;var ph$16026;(ph$16026=$16017$16019);;($16025$16031=ph$16026);;if((((x$16041=$16025$16031)),((x$16041 instanceof Array)&&(x$16041[0]==="pattern")))){($16046$16048=expr$16022);;if((($16046$16048 instanceof Array)&&((t0$16053=$16046$16048.length),((t0$16053===1)&&($16046$16048[0]==="void"))))){return ["special","match"];}else{(other$16062=$16046$16048);return ["all",__lt____lt____colon__$13720(other$16062,expr$16022),__lt____lt____colon__$13720(["special","match"],form$16021)];}}else{(other$16066=$16025$16031);(opt$16069=util$13721.set(flags$16023));;(to_match$16070=$20051(["symbol",scope$16020.gensym("m")],({"single_assignment":true})));;(t0$16080=((($16083$16087=expr$16022)),function(){if((($16084$16097=($16083$16087 instanceof Array))&&((t0$16092=$16083$16087.length),((t0$16092===2)&&(($16083$16087[0]==="data")&&((t1$16093=$20123(["multi"])($16083$16087[1])),(t1$16093[0]&&((t2$16094=t1$16093[1]),((t3$16095=t2$16094.length),(t3$16095>=0)))))))))){(b$16101=Array.prototype.slice.call(t2$16094,0));return [["value",null],b$16101];}else{if(($16084$16097&&((t0$16092===3)&&(($16083$16087[0]==="data")&&((v$16110=$16083$16087[1]),((t1$16093=$20123(["multi"])($16083$16087[2])),(t1$16093[0]&&((t2$16094=t1$16093[1]),((t3$16095=t2$16094.length),(t3$16095>=0)))))))))){(b$16111=Array.prototype.slice.call(t2$16094,0));return [v$16110,b$16111];}else{$20038($16083$16087);}}}()));if(((t0$16080 instanceof Array)&&((t1$16081=t0$16080.length),(t1$16081===2)))){(value$16071=t0$16080[0]);(body$16072=t0$16080[1]);;}else{$20038(((($16123$16127=expr$16022)),function(){if((($16124$16137=($16123$16127 instanceof Array))&&((t0$16132=$16123$16127.length),((t0$16132===2)&&(($16123$16127[0]==="data")&&((t1$16133=$20123(["multi"])($16123$16127[1])),(t1$16133[0]&&((t2$16134=t1$16133[1]),((t3$16135=t2$16134.length),(t3$16135>=0)))))))))){(b$16141=Array.prototype.slice.call(t2$16134,0));return [["value",null],b$16141];}else{if(($16124$16137&&((t0$16132===3)&&(($16123$16127[0]==="data")&&((v$16150=$16123$16127[1]),((t1$16133=$20123(["multi"])($16123$16127[2])),(t1$16133[0]&&((t2$16134=t1$16133[1]),((t3$16135=t2$16134.length),(t3$16135>=0)))))))))){(b$16151=Array.prototype.slice.call(t2$16134,0));return [v$16150,b$16151];}else{$20038($16123$16127);}}}()),"/home/olivier/git/earl-grey/src/stdenv.eg",14569,14688);}(mbody$16161=parse_clauses$13729(scope$16020,to_match$16070,body$16072,$20051(opt$16069,$19812(((accum$16165=({})),((accum$16165["fallback"]=function(target$16169){return match_error$13746(target$16169);}),accum$16165)),({"wrap":function(x$16172){return x$16172;}})))));;return ["send",["symbol","let"],["data",["send",["symbol","="],["data",to_match$16070,value$16071]],mbody$16161]];}})}),$19812(((accum$16176=({})),((accum$16176["each"]=function($16179$16183,scope$16184,$16180$16185,$16181$16186){var t0$16202;var t0$16207;var t1$16208;var t2$16209;var t3$16210;var t4$16211;var x$16287;var other$16306;var ends_with_test$16233;var _build_loop$16234;var $16189$16228;var $16190$16229;var $16191$16230;var $16192$16231;var t0$16226;var $16188$16221;var ph$16193;var form$16194;var env$16195;var li$16196;var clauses$16197;(ph$16193=$16179$16183);;(t0$16202=$16180$16185);(form$16194=t0$16202);if($19824(t0$16202,"env")){(env$16195=t0$16202.env);;}else{$20038($16180$16185);}(t0$16207=$16181$16186);if(((t0$16207 instanceof Array)&&((t1$16208=t0$16207.length),((t1$16208===3)&&((t0$16207[0]==="data")&&((li$16196=t0$16207[1]),((t2$16209=$20123(["multi"])(t0$16207[2])),(t2$16209[0]&&((t3$16210=t2$16209[1]),((t4$16211=t3$16210.length),(t4$16211>=0))))))))))){(clauses$16197=Array.prototype.slice.call(t3$16210,0));;}else{$20038($16181$16186);}($16188$16221=ph$16193);;(ends_with_test$16233=false);;(_build_loop$16234=function(wrap$16241,pre$16242,post$16243){var accum$16246;var accum$16276;return build_loop$13759(scope$16184,env$16195,form$16194,li$16196,clauses$16197,wrap$16241,pre$16242,post$16243,$19812(((accum$16246=({})),((accum$16246["wrap_pattern"]=function(x$16250,toplevel$16251){var x$16266;var other$16273;var $16254$16256;(ends_with_test$16233=((($16254$16256=x$16250)),function(){if((((x$16266=$16254$16256)),((x$16266 instanceof Array)&&(x$16266[0]==="test")))){return toplevel$16251;}else{(other$16273=$16254$16256);return false;}}()));return x$16250;}),accum$16246)),((accum$16276=({})),((accum$16276["fallback"]=function(target$16280){if(ends_with_test$16233){return ["symbol","false"];}else{return match_error$13746(target$16280);}}),accum$16276))));});;if((((x$16287=$16188$16221)),((x$16287 instanceof Array)&&(x$16287[0]==="test")))){return $20051(["test_factory",li$16196,clauses$16197],({"env":env$16195}));}else{if((($16189$16228=($16188$16221 instanceof Array))&&((t0$16226=$16188$16221.length),(($16191$16230=(t0$16226===2))&&(($16192$16231=($16188$16221[0]==="expr"))&&($16188$16221[1]==="multi")))))){return ["nostep",form$16194];}else{if(($16192$16231&&($16188$16221[1]==="ignore"))){return _build_loop$16234(function(x$16302){return x$16302;},["splice"],["splice"]);}else{(other$16306=$16188$16221);return _build_loop$16234(function(x$16309){return ["send",["send",["symbol","acc"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",x$16309]];},["send",["symbol","="],["data",["symbol","acc"],["data"]]],["symbol","acc"]);}}}}),accum$16176)),$19812(((accum$16312=({})),((accum$16312["each?"]=function($16315$16319,scope$16320,$16316$16321,$16317$16322){var t0$16338;var t0$16343;var t1$16344;var t2$16345;var t3$16346;var t4$16347;var x$16372;var other$16394;var $16325$16364;var $16326$16365;var $16327$16366;var $16328$16367;var t0$16362;var $16324$16357;var ph$16329;var form$16330;var env$16331;var li$16332;var clauses$16333;(ph$16329=$16315$16319);;(t0$16338=$16316$16321);(form$16330=t0$16338);if($19824(t0$16338,"env")){(env$16331=t0$16338.env);;}else{$20038($16316$16321);}(t0$16343=$16317$16322);if(((t0$16343 instanceof Array)&&((t1$16344=t0$16343.length),((t1$16344===3)&&((t0$16343[0]==="data")&&((li$16332=t0$16343[1]),((t2$16345=$20123(["multi"])(t0$16343[2])),(t2$16345[0]&&((t3$16346=t2$16345[1]),((t4$16347=t3$16346.length),(t4$16347>=0))))))))))){(clauses$16333=Array.prototype.slice.call(t3$16346,0));;}else{$20038($16317$16322);}($16324$16357=ph$16329);;if((((x$16372=$16324$16357)),((x$16372 instanceof Array)&&(x$16372[0]==="test")))){return $20051(["test_factory",li$16332,clauses$16333],({"env":env$16331}));}else{if((($16325$16364=($16324$16357 instanceof Array))&&((t0$16362=$16324$16357.length),(($16327$16366=(t0$16362===2))&&(($16328$16367=($16324$16357[0]==="expr"))&&($16324$16357[1]==="multi")))))){return ["nostep",form$16330];}else{if(($16328$16367&&($16324$16357[1]==="ignore"))){return build_loop$13759(scope$16320,env$16331,form$16330,li$16332,clauses$16333,function(x$16387){return x$16387;},["splice"],["splice"],({"fallback":function(target$16390){return ["symbol","false"];}}));}else{(other$16394=$16324$16357);return build_loop$13759(scope$16320,env$16331,form$16330,li$16332,clauses$16333,function(x$16397){return ["send",["send",["symbol","acc"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",x$16397]];},["send",["symbol","="],["data",["symbol","acc"],["data"]]],["symbol","acc"],({"fallback":function(target$16400){return ["symbol","false"];}}));}}}}),accum$16312)),$19812(((accum$16403=({})),((accum$16403["!!"]=function($16406$16409,scope$16410,form$16411,$16407$16412){var t0$16426;var t1$16427;var t2$16428;var t3$16429;var t4$16430;var other$16466;var $16415$16447;var $16416$16448;var $16417$16449;var $16418$16450;var t0$16445;var $16414$16440;var ph$16419;var expr$16420;var clauses$16421;(ph$16419=$16406$16409);;(t0$16426=$16407$16412);if(((t0$16426 instanceof Array)&&((t1$16427=t0$16426.length),((t1$16427===3)&&((t0$16426[0]==="data")&&((expr$16420=t0$16426[1]),((t2$16428=$20123(["multi"])(t0$16426[2])),(t2$16428[0]&&((t3$16429=t2$16428[1]),((t4$16430=t3$16429.length),(t4$16430>=0))))))))))){(clauses$16421=Array.prototype.slice.call(t3$16429,0));;}else{$20038($16407$16412);}($16414$16440=ph$16419);;if((($16415$16447=($16414$16440 instanceof Array))&&((t0$16445=$16414$16440.length),(($16417$16449=(t0$16445===2))&&(($16418$16450=($16414$16440[0]==="expr"))&&($16414$16440[1]==="multi")))))){return ["nostep",form$16411];}else{if(($16418$16450&&($16414$16440[1]==="ignore"))){clauses$16421.push(mkstdenv$13740().convert(["send",["symbol","->"],["data",["symbol","e"],["send",["symbol","throw"],["symbol","e"]]]]));return ["js_try",expr$16420,["send",["symbol","->"],["data",["data",["symbol","excv"]],parse_clauses$13729(scope$16410,["symbol","excv"],clauses$16421,({"wrap":function(x$16462){return x$16462;}}))]],["void"]];}else{(other$16466=$16414$16440);clauses$16421.push(mkstdenv$13740().convert(["send",["symbol","->"],["data",["symbol","e"],["send",["symbol","throw"],["symbol","e"]]]]));return ["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","rval"],["symbol","false"]]],["multi",["js_try",["send",["symbol",":="],["data",["symbol","rval"],expr$16420]],["send",["symbol","->"],["data",["data",["symbol","excv"]],parse_clauses$13729(scope$16410,["symbol","excv"],clauses$16421,({"wrap":function(x$16470){return ["send",["symbol",":="],["data",["symbol","rval"],x$16470]];}}))]],["void"]],["symbol","rval"]]]];}}}),accum$16403)),$19812(({"@":var_operator$13754(expander$13741.gensym("it"))}),$19812(((accum$16473=({})),((t0$16475=$20123(expr_mac$13748)(function(scope$16479,form$16480,$16477$16481){var t0$16487;var t1$16488;var t2$16489;var t3$16490;var t4$16491;var t5$16492;var it$16504;var construct$16505;var defn$16483;var env$16484;var body$16485;(t0$16487=$16477$16481);if(((t0$16487 instanceof Array)&&((t1$16488=t0$16487.length),((t1$16488===3)&&((t0$16487[0]==="data")&&((t2$16489=t0$16487[1]),((defn$16483=t2$16489),($19824(t2$16489,"env")&&((env$16484=t2$16489.env),((t3$16490=$20123(["multi"])(t0$16487[2])),(t3$16490[0]&&((t4$16491=t3$16490[1]),((t5$16492=t4$16491.length),(t5$16492>=0)))))))))))))){(body$16485=Array.prototype.slice.call(t4$16491,0));;}else{$20038($16477$16481);}(it$16504=$20051(["symbol","@"],({"env":env$16484})));;(construct$16505=function($16511$16513){var x$16540;var rest$16541;var x$16534;var $16516$16530;var $16517$16531;var t0$16528;var $16515$16523;var ph$16518;(ph$16518=$16511$16513);;($16515$16523=ph$16518);;if((($16516$16530=($16515$16523 instanceof Array))&&((t0$16528=$16515$16523.length),(t0$16528===1)))){(x$16534=$16515$16523[0]);return x$16534;}else{if(($16516$16530&&(t0$16528>=1))){(x$16540=$16515$16523[0]);(rest$16541=Array.prototype.slice.call($16515$16523,1));return ["send",["symbol","let"],["data",["send",["symbol","="],["data",it$16504,x$16540]],construct$16505(rest$16541)]];}else{$20038($16515$16523);}}});;return construct$16505([defn$16483].concat(body$16485));})),function(){if(t0$16475[0]){(accum$16473["chain"]=t0$16475[1]);return accum$16473;}else{return $20038(function(scope$16550,form$16551,$16548$16552){var t0$16558;var t1$16559;var t2$16560;var t3$16561;var t4$16562;var t5$16563;var it$16575;var construct$16576;var defn$16554;var env$16555;var body$16556;(t0$16558=$16548$16552);if(((t0$16558 instanceof Array)&&((t1$16559=t0$16558.length),((t1$16559===3)&&((t0$16558[0]==="data")&&((t2$16560=t0$16558[1]),((defn$16554=t2$16560),($19824(t2$16560,"env")&&((env$16555=t2$16560.env),((t3$16561=$20123(["multi"])(t0$16558[2])),(t3$16561[0]&&((t4$16562=t3$16561[1]),((t5$16563=t4$16562.length),(t5$16563>=0)))))))))))))){(body$16556=Array.prototype.slice.call(t4$16562,0));;}else{$20038($16548$16552);}(it$16575=$20051(["symbol","@"],({"env":env$16555})));;(construct$16576=function($16582$16584){var x$16611;var rest$16612;var x$16605;var $16587$16601;var $16588$16602;var t0$16599;var $16586$16594;var ph$16589;(ph$16589=$16582$16584);;($16586$16594=ph$16589);;if((($16587$16601=($16586$16594 instanceof Array))&&((t0$16599=$16586$16594.length),(t0$16599===1)))){(x$16605=$16586$16594[0]);return x$16605;}else{if(($16587$16601&&(t0$16599>=1))){(x$16611=$16586$16594[0]);(rest$16612=Array.prototype.slice.call($16586$16594,1));return ["send",["symbol","let"],["data",["send",["symbol","="],["data",it$16575,x$16611]],construct$16576(rest$16612)]];}else{$20038($16586$16594);}}});;return construct$16576([defn$16554].concat(body$16556));});}}())),$19812(((accum$16619=({})),((t0$16621=$20123(expr_mac$13748)(function(scope$16625,form$16626,$16623$16627){var t0$16633;var t1$16634;var t2$16635;var it$16643;var defn$16629;var env$16630;var body$16631;(t0$16633=$16623$16627);if(((t0$16633 instanceof Array)&&((t1$16634=t0$16633.length),((t1$16634===3)&&((t0$16633[0]==="data")&&((t2$16635=t0$16633[1]),((defn$16629=t2$16635),$19824(t2$16635,"env")))))))){(env$16630=t2$16635.env);(body$16631=t0$16633[2]);;}else{$20038($16623$16627);}(it$16643=$20051(["symbol","@"],({"env":env$16630})));;return ["send",["symbol","let"],["data",["send",["symbol","="],["data",it$16643,defn$16629]],body$16631]];})),function(){if(t0$16621[0]){(accum$16619["using"]=t0$16621[1]);return accum$16619;}else{return $20038(function(scope$16650,form$16651,$16648$16652){var t0$16658;var t1$16659;var t2$16660;var it$16668;var defn$16654;var env$16655;var body$16656;(t0$16658=$16648$16652);if(((t0$16658 instanceof Array)&&((t1$16659=t0$16658.length),((t1$16659===3)&&((t0$16658[0]==="data")&&((t2$16660=t0$16658[1]),((defn$16654=t2$16660),$19824(t2$16660,"env")))))))){(env$16655=t2$16660.env);(body$16656=t0$16658[2]);;}else{$20038($16648$16652);}(it$16668=$20051(["symbol","@"],({"env":env$16655})));;return ["send",["symbol","let"],["data",["send",["symbol","="],["data",it$16668,defn$16654]],body$16656]];});}}())),$19812(((accum$16673=({})),((t0$16675=$20123(overridable$13749)(function($16677$16680,scope$16681,form$16682,$16678$16683){var t0$16692;var t1$16693;var x$16709;var x$16718;var t0$16726;var t1$16727;var t2$16728;var stmts$16724;var x$16738;var $16685$16699;var ph$16686;var body$16687;(ph$16686=$16677$16680);;(t0$16692=$16678$16683);if(((t0$16692 instanceof Array)&&((t1$16693=t0$16692.length),((t1$16693===2)&&(t0$16692[0]==="data"))))){(body$16687=t0$16692[1]);;}else{$20038($16678$16683);}($16685$16699=ph$16686);;if((((x$16709=$16685$16699)),((x$16709 instanceof Array)&&(x$16709[0]==="clause")))){return ["block",body$16687];}else{if((((x$16718=$16685$16699)),((x$16718 instanceof Array)&&(x$16718[0]==="test")))){(t0$16726=$20123(["multi"])(body$16687));if((t0$16726[0]&&((t1$16727=t0$16726[1]),((t2$16728=t1$16727.length),(t2$16728>=0))))){(stmts$16724=Array.prototype.slice.call(t1$16727,0));;}else{$20038(body$16687,"/home/olivier/git/earl-grey/src/stdenv.eg",19041,19045);}return ["do",["splice"].concat(stmts$16724)];}else{if((((x$16738=$16685$16699)),((x$16738 instanceof Array)&&(x$16738[0]==="expr")))){return ["multi",body$16687];}else{$20038($16685$16699);}}}})),function(){if(t0$16675[0]){(accum$16673["do"]=t0$16675[1]);return accum$16673;}else{return $20038(function($16746$16749,scope$16750,form$16751,$16747$16752){var t0$16761;var t1$16762;var x$16778;var x$16787;var t0$16795;var t1$16796;var t2$16797;var stmts$16793;var x$16807;var $16754$16768;var ph$16755;var body$16756;(ph$16755=$16746$16749);;(t0$16761=$16747$16752);if(((t0$16761 instanceof Array)&&((t1$16762=t0$16761.length),((t1$16762===2)&&(t0$16761[0]==="data"))))){(body$16756=t0$16761[1]);;}else{$20038($16747$16752);}($16754$16768=ph$16755);;if((((x$16778=$16754$16768)),((x$16778 instanceof Array)&&(x$16778[0]==="clause")))){return ["block",body$16756];}else{if((((x$16787=$16754$16768)),((x$16787 instanceof Array)&&(x$16787[0]==="test")))){(t0$16795=$20123(["multi"])(body$16756));if((t0$16795[0]&&((t1$16796=t0$16795[1]),((t2$16797=t1$16796.length),(t2$16797>=0))))){(stmts$16793=Array.prototype.slice.call(t1$16796,0));;}else{$20038(body$16756,"/home/olivier/git/earl-grey/src/stdenv.eg",19041,19045);}return ["do",["splice"].concat(stmts$16793)];}else{if((((x$16807=$16754$16768)),((x$16807 instanceof Array)&&(x$16807[0]==="expr")))){return ["multi",body$16756];}else{$20038($16754$16768);}}}});}}())),$19812(((accum$16815=({})),((t0$16817=$20123(expr_mac$13748)(function(scope$16821,form$16822,$16819$16823){var other$16932;var s1$16919;var b$16920;var a$16900;var b$16901;var a$16888;var $16827$16883;var $16828$16884;var $16829$16885;var t0$16868;var t1$16869;var t2$16870;var t3$16871;var t4$16872;var t5$16873;var t6$16874;var t7$16875;var t8$16876;var t9$16877;var t10$16878;var t11$16879;var t12$16880;var t13$16881;var test$16859;var $16826$16860;var test$16851;var a$16852;var b$16853;var $16830$16847;var $16831$16848;var t0$16842;var t1$16843;var t2$16844;var t3$16845;var $16825$16837;var ph$16832;(ph$16832=$16819$16823);;($16825$16837=ph$16832);;if((($16830$16847=($16825$16837 instanceof Array))&&((t0$16842=$16825$16837.length),((t0$16842===4)&&($16825$16837[0]==="data"))))){(test$16851=$16825$16837[1]);(a$16852=$16825$16837[2]);(b$16853=$16825$16837[3]);return ["if",test$16851,a$16852,b$16853];}else{if(($16830$16847&&((t0$16842===3)&&(($16825$16837[0]==="data")&&((test$16859=$16825$16837[1]),((t1$16843=$20123(["multi"])($16825$16837[2])),(t1$16843[0]&&((t2$16844=t1$16843[1]),((t3$16845=t2$16844.length),(t3$16845>=0)))))))))){($16826$16860=Array.prototype.slice.call(t2$16844,0));(t0$16868=$16826$16860);if((($16828$16884=(t0$16868 instanceof Array))&&((t1$16869=t0$16868.length),((t1$16869===1)&&((t2$16870=t0$16868[0]),((t2$16870 instanceof Array)&&((t3$16871=t2$16870.length),((t3$16871===3)&&((t2$16870[0]==="send")&&((t4$16872=t2$16870[1]),((t4$16872 instanceof Array)&&((t5$16873=t4$16872.length),((t5$16873===2)&&((t4$16872[0]==="symbol")&&((t4$16872[1]==="then")&&((t6$16874=t2$16870[2]),((t6$16874 instanceof Array)&&((t7$16875=t6$16874.length),((t7$16875===2)&&(t6$16874[0]==="data")))))))))))))))))))){(a$16888=t6$16874[1]);return ["if",test$16859,a$16888,["value",(void 0)]];}else{if(($16828$16884&&((t1$16869===2)&&((t2$16870=t0$16868[0]),((t2$16870 instanceof Array)&&((t3$16871=t2$16870.length),((t3$16871===3)&&((t2$16870[0]==="send")&&((t4$16872=t2$16870[1]),((t4$16872 instanceof Array)&&((t5$16873=t4$16872.length),((t5$16873===2)&&((t4$16872[0]==="symbol")&&((t4$16872[1]==="then")&&((t6$16874=t2$16870[2]),((t6$16874 instanceof Array)&&((t7$16875=t6$16874.length),((t7$16875===2)&&((t6$16874[0]==="data")&&((a$16900=t6$16874[1]),((t8$16876=t0$16868[1]),((t8$16876 instanceof Array)&&((t9$16877=t8$16876.length),((t9$16877===3)&&((t8$16876[0]==="send")&&((t10$16878=t8$16876[1]),((t10$16878 instanceof Array)&&((t11$16879=t10$16878.length),((t11$16879===2)&&((t10$16878[0]==="symbol")&&((t10$16878[1]==="else")&&((t12$16880=t8$16876[2]),((t12$16880 instanceof Array)&&((t13$16881=t12$16880.length),((t13$16881===2)&&(t12$16880[0]==="data")))))))))))))))))))))))))))))))))))){(b$16901=t12$16880[1]);return ["if",test$16859,a$16900,b$16901];}else{if(($16828$16884&&((t1$16869>=1)&&((s1$16919=Array.prototype.slice.call(t0$16868,0,-1)),((t2$16870=t0$16868[(t1$16869-1)]),((t2$16870 instanceof Array)&&((t3$16871=t2$16870.length),((t3$16871===3)&&((t2$16870[0]==="send")&&((t4$16872=t2$16870[1]),((t4$16872 instanceof Array)&&((t5$16873=t4$16872.length),((t5$16873===2)&&((t4$16872[0]==="symbol")&&((t4$16872[1]==="else")&&((t6$16874=t2$16870[2]),((t6$16874 instanceof Array)&&((t7$16875=t6$16874.length),((t7$16875===2)&&(t6$16874[0]==="data")))))))))))))))))))){(b$16920=t6$16874[1]);return ["if",test$16859,["multi"].concat(s1$16919),b$16920];}else{(other$16932=$16826$16860);return ["if",test$16859,["multi"].concat(other$16932),["value",(void 0)]];}}}}else{$20038($16825$16837);}}})),function(){if(t0$16817[0]){(accum$16815["if"]=t0$16817[1]);return accum$16815;}else{return $20038(function(scope$16939,form$16940,$16937$16941){var other$17050;var s1$17037;var b$17038;var a$17018;var b$17019;var a$17006;var $16945$17001;var $16946$17002;var $16947$17003;var t0$16986;var t1$16987;var t2$16988;var t3$16989;var t4$16990;var t5$16991;var t6$16992;var t7$16993;var t8$16994;var t9$16995;var t10$16996;var t11$16997;var t12$16998;var t13$16999;var test$16977;var $16944$16978;var test$16969;var a$16970;var b$16971;var $16948$16965;var $16949$16966;var t0$16960;var t1$16961;var t2$16962;var t3$16963;var $16943$16955;var ph$16950;(ph$16950=$16937$16941);;($16943$16955=ph$16950);;if((($16948$16965=($16943$16955 instanceof Array))&&((t0$16960=$16943$16955.length),((t0$16960===4)&&($16943$16955[0]==="data"))))){(test$16969=$16943$16955[1]);(a$16970=$16943$16955[2]);(b$16971=$16943$16955[3]);return ["if",test$16969,a$16970,b$16971];}else{if(($16948$16965&&((t0$16960===3)&&(($16943$16955[0]==="data")&&((test$16977=$16943$16955[1]),((t1$16961=$20123(["multi"])($16943$16955[2])),(t1$16961[0]&&((t2$16962=t1$16961[1]),((t3$16963=t2$16962.length),(t3$16963>=0)))))))))){($16944$16978=Array.prototype.slice.call(t2$16962,0));(t0$16986=$16944$16978);if((($16946$17002=(t0$16986 instanceof Array))&&((t1$16987=t0$16986.length),((t1$16987===1)&&((t2$16988=t0$16986[0]),((t2$16988 instanceof Array)&&((t3$16989=t2$16988.length),((t3$16989===3)&&((t2$16988[0]==="send")&&((t4$16990=t2$16988[1]),((t4$16990 instanceof Array)&&((t5$16991=t4$16990.length),((t5$16991===2)&&((t4$16990[0]==="symbol")&&((t4$16990[1]==="then")&&((t6$16992=t2$16988[2]),((t6$16992 instanceof Array)&&((t7$16993=t6$16992.length),((t7$16993===2)&&(t6$16992[0]==="data")))))))))))))))))))){(a$17006=t6$16992[1]);return ["if",test$16977,a$17006,["value",(void 0)]];}else{if(($16946$17002&&((t1$16987===2)&&((t2$16988=t0$16986[0]),((t2$16988 instanceof Array)&&((t3$16989=t2$16988.length),((t3$16989===3)&&((t2$16988[0]==="send")&&((t4$16990=t2$16988[1]),((t4$16990 instanceof Array)&&((t5$16991=t4$16990.length),((t5$16991===2)&&((t4$16990[0]==="symbol")&&((t4$16990[1]==="then")&&((t6$16992=t2$16988[2]),((t6$16992 instanceof Array)&&((t7$16993=t6$16992.length),((t7$16993===2)&&((t6$16992[0]==="data")&&((a$17018=t6$16992[1]),((t8$16994=t0$16986[1]),((t8$16994 instanceof Array)&&((t9$16995=t8$16994.length),((t9$16995===3)&&((t8$16994[0]==="send")&&((t10$16996=t8$16994[1]),((t10$16996 instanceof Array)&&((t11$16997=t10$16996.length),((t11$16997===2)&&((t10$16996[0]==="symbol")&&((t10$16996[1]==="else")&&((t12$16998=t8$16994[2]),((t12$16998 instanceof Array)&&((t13$16999=t12$16998.length),((t13$16999===2)&&(t12$16998[0]==="data")))))))))))))))))))))))))))))))))))){(b$17019=t12$16998[1]);return ["if",test$16977,a$17018,b$17019];}else{if(($16946$17002&&((t1$16987>=1)&&((s1$17037=Array.prototype.slice.call(t0$16986,0,-1)),((t2$16988=t0$16986[(t1$16987-1)]),((t2$16988 instanceof Array)&&((t3$16989=t2$16988.length),((t3$16989===3)&&((t2$16988[0]==="send")&&((t4$16990=t2$16988[1]),((t4$16990 instanceof Array)&&((t5$16991=t4$16990.length),((t5$16991===2)&&((t4$16990[0]==="symbol")&&((t4$16990[1]==="else")&&((t6$16992=t2$16988[2]),((t6$16992 instanceof Array)&&((t7$16993=t6$16992.length),((t7$16993===2)&&(t6$16992[0]==="data")))))))))))))))))))){(b$17038=t6$16992[1]);return ["if",test$16977,["multi"].concat(s1$17037),b$17038];}else{(other$17050=$16944$16978);return ["if",test$16977,["multi"].concat(other$17050),["value",(void 0)]];}}}}else{$20038($16943$16955);}}});}}())),$19812(((accum$17055=({})),((t0$17057=$20123(expr_mac$13748)(function(scope$17061,form$17062,$17059$17063){var t0$17070;var t0$17088;var t1$17089;var t2$17090;var t3$17091;var t4$17092;var t5$17093;var t6$17094;var t7$17095;var t8$17096;var t0$17108;var test$17130;var body$17131;var label$17085;var bridge$17066$17080;var t0$17081;var $17065$17075;var ph$17067;var env$17068;(t0$17070=$17059$17063);if($19824(t0$17070,"env")){(env$17068=t0$17070.env);(ph$17067=t0$17070);;}else{$20038($17059$17063);}($17065$17075=ph$17067);;(bridge$17066$17080=$17065$17075);if((((bridge$17066$17080 instanceof Array)&&((t0$17088=bridge$17066$17080.length),((t0$17088===3)&&((bridge$17066$17080[0]==="send")&&((t1$17089=bridge$17066$17080[1]),((t1$17089 instanceof Array)&&((t2$17090=t1$17089.length),((t2$17090===2)&&((t1$17089[0]==="symbol")&&((t1$17089[1]===".")&&((t3$17091=bridge$17066$17080[2]),((t3$17091 instanceof Array)&&((t4$17092=t3$17091.length),((t4$17092===3)&&((t3$17091[0]==="data")&&((t5$17093=t3$17091[1]),((t5$17093 instanceof Array)&&((t6$17094=t5$17093.length),((t6$17094===1)&&((t5$17093[0]==="void")&&((t7$17095=t3$17091[2]),((t7$17095 instanceof Array)&&((t8$17096=t7$17095.length),((t8$17096===2)&&((t7$17095[0]==="symbol")&&((label$17085=t7$17095[1]),true))))))))))))))))))))))))))||((bridge$17066$17080 instanceof Array)&&((t0$17108=bridge$17066$17080.length),((t0$17108===2)&&((bridge$17066$17080[0]==="value")&&((label$17085=bridge$17066$17080[1]),true))))))){return ["macro",function(context$17114,scope$17115,form$17116,$17112$17117){var t0$17122;var t1$17123;var test$17119;var body$17120;(t0$17122=$17112$17117);if(((t0$17122 instanceof Array)&&((t1$17123=t0$17122.length),((t1$17123===3)&&(t0$17122[0]==="data"))))){(test$17119=t0$17122[1]);(body$17120=t0$17122[2]);;}else{$20038($17112$17117);}return setup_label$13751(label$17085,env$17068,["js_while",test$17119,body$17120]);}];}else{if((($17065$17075 instanceof Array)&&((t0$17081=$17065$17075.length),((t0$17081===3)&&($17065$17075[0]==="data"))))){(test$17130=$17065$17075[1]);(body$17131=$17065$17075[2]);return setup_label$13751(scope$17061.gensym(),env$17068,["js_while",test$17130,body$17131]);}else{$20038($17065$17075);}}})),function(){if(t0$17057[0]){(accum$17055["while"]=t0$17057[1]);return accum$17055;}else{return $20038(function(scope$17140,form$17141,$17138$17142){var t0$17149;var t0$17167;var t1$17168;var t2$17169;var t3$17170;var t4$17171;var t5$17172;var t6$17173;var t7$17174;var t8$17175;var t0$17187;var test$17209;var body$17210;var label$17164;var bridge$17145$17159;var t0$17160;var $17144$17154;var ph$17146;var env$17147;(t0$17149=$17138$17142);if($19824(t0$17149,"env")){(env$17147=t0$17149.env);(ph$17146=t0$17149);;}else{$20038($17138$17142);}($17144$17154=ph$17146);;(bridge$17145$17159=$17144$17154);if((((bridge$17145$17159 instanceof Array)&&((t0$17167=bridge$17145$17159.length),((t0$17167===3)&&((bridge$17145$17159[0]==="send")&&((t1$17168=bridge$17145$17159[1]),((t1$17168 instanceof Array)&&((t2$17169=t1$17168.length),((t2$17169===2)&&((t1$17168[0]==="symbol")&&((t1$17168[1]===".")&&((t3$17170=bridge$17145$17159[2]),((t3$17170 instanceof Array)&&((t4$17171=t3$17170.length),((t4$17171===3)&&((t3$17170[0]==="data")&&((t5$17172=t3$17170[1]),((t5$17172 instanceof Array)&&((t6$17173=t5$17172.length),((t6$17173===1)&&((t5$17172[0]==="void")&&((t7$17174=t3$17170[2]),((t7$17174 instanceof Array)&&((t8$17175=t7$17174.length),((t8$17175===2)&&((t7$17174[0]==="symbol")&&((label$17164=t7$17174[1]),true))))))))))))))))))))))))))||((bridge$17145$17159 instanceof Array)&&((t0$17187=bridge$17145$17159.length),((t0$17187===2)&&((bridge$17145$17159[0]==="value")&&((label$17164=bridge$17145$17159[1]),true))))))){return ["macro",function(context$17193,scope$17194,form$17195,$17191$17196){var t0$17201;var t1$17202;var test$17198;var body$17199;(t0$17201=$17191$17196);if(((t0$17201 instanceof Array)&&((t1$17202=t0$17201.length),((t1$17202===3)&&(t0$17201[0]==="data"))))){(test$17198=t0$17201[1]);(body$17199=t0$17201[2]);;}else{$20038($17191$17196);}return setup_label$13751(label$17164,env$17147,["js_while",test$17198,body$17199]);}];}else{if((($17144$17154 instanceof Array)&&((t0$17160=$17144$17154.length),((t0$17160===3)&&($17144$17154[0]==="data"))))){(test$17209=$17144$17154[1]);(body$17210=$17144$17154[2]);return setup_label$13751(scope$17140.gensym(),env$17147,["js_while",test$17209,body$17210]);}else{$20038($17144$17154);}}});}}())),$19812(((accum$17217=({})),((accum$17217["for"]=function(context$17222,scope$17223,form$17224,$17220$17225){var t0$17232;var t0$17302;var t1$17303;var t2$17304;var t3$17305;var t4$17306;var t5$17307;var t6$17308;var t7$17309;var t8$17310;var t0$17322;var spec$17344;var body$17345;var label$17299;var setup_for$17245;var bridge$17228$17241;var t0$17242;var $17227$17236;var ph$17229;var expr$17230;(t0$17232=$17220$17225);(expr$17230=t0$17232);(ph$17229=t0$17232);;($17227$17236=ph$17229);;(setup_for$17245=function(label$17250,env$17251,$17248$17252,body$17253){var a$17286;var b$17287;var a$17278;var b$17279;var c$17280;var $17256$17274;var $17257$17275;var t0$17268;var t1$17269;var t2$17270;var t3$17271;var t4$17272;var $17255$17263;var ph$17258;(ph$17258=$17248$17252);;($17255$17263=ph$17258);;if((($17256$17274=($17255$17263 instanceof Array))&&((t0$17268=$17255$17263.length),((t0$17268===4)&&($17255$17263[0]==="multi"))))){(a$17278=$17255$17263[1]);(b$17279=$17255$17263[2]);(c$17280=$17255$17263[3]);return ["multi",a$17278,setup_label$13751(label$17250,env$17251,["js_for",["multi"],b$17279,c$17280,body$17253])];}else{if(($17256$17274&&((t0$17268===3)&&(($17255$17263[0]==="send")&&((t1$17269=$17255$17263[1]),((t1$17269 instanceof Array)&&((t2$17270=t1$17269.length),((t2$17270===2)&&((t1$17269[0]==="symbol")&&((t1$17269[1]==="in")&&((t3$17271=$17255$17263[2]),((t3$17271 instanceof Array)&&((t4$17272=t3$17271.length),((t4$17272===3)&&(t3$17271[0]==="data"))))))))))))))){(a$17286=t3$17271[1]);(b$17287=t3$17271[2]);return ["multi",["declare",a$17286,["value",null]],setup_label$13751(label$17250,env$17251,["js_for_in",a$17286,b$17287,body$17253])];}else{$20038($17255$17263);}}});;(bridge$17228$17241=$17227$17236);if((((bridge$17228$17241 instanceof Array)&&((t0$17302=bridge$17228$17241.length),((t0$17302===3)&&((bridge$17228$17241[0]==="send")&&((t1$17303=bridge$17228$17241[1]),((t1$17303 instanceof Array)&&((t2$17304=t1$17303.length),((t2$17304===2)&&((t1$17303[0]==="symbol")&&((t1$17303[1]===".")&&((t3$17305=bridge$17228$17241[2]),((t3$17305 instanceof Array)&&((t4$17306=t3$17305.length),((t4$17306===3)&&((t3$17305[0]==="data")&&((t5$17307=t3$17305[1]),((t5$17307 instanceof Array)&&((t6$17308=t5$17307.length),((t6$17308===1)&&((t5$17307[0]==="void")&&((t7$17309=t3$17305[2]),((t7$17309 instanceof Array)&&((t8$17310=t7$17309.length),((t8$17310===2)&&((t7$17309[0]==="symbol")&&((label$17299=t7$17309[1]),true))))))))))))))))))))))))))||((bridge$17228$17241 instanceof Array)&&((t0$17322=bridge$17228$17241.length),((t0$17322===2)&&((bridge$17228$17241[0]==="value")&&((label$17299=bridge$17228$17241[1]),true))))))){return ["macro",function(context$17328,scope$17329,form$17330,$17326$17331){var t0$17336;var t1$17337;var spec$17333;var body$17334;(t0$17336=$17326$17331);if(((t0$17336 instanceof Array)&&((t1$17337=t0$17336.length),((t1$17337===3)&&(t0$17336[0]==="data"))))){(spec$17333=t0$17336[1]);(body$17334=t0$17336[2]);;}else{$20038($17326$17331);}return setup_for$17245(label$17299,expr$17230.env,spec$17333,body$17334);}];}else{if((($17227$17236 instanceof Array)&&((t0$17242=$17227$17236.length),((t0$17242===3)&&($17227$17236[0]==="data"))))){(spec$17344=$17227$17236[1]);(body$17345=$17227$17236[2]);return setup_for$17245(scope$17223.gensym(),form$17224.env,spec$17344,body$17345);}else{$20038($17227$17236);}}}),accum$17217)),$19812(((accum$17352=({})),((t0$17354=$20123(expr_mac$13748)(function(scope$17358,form$17359,$17356$17360){var t0$17365;var t1$17366;var t2$17367;var t3$17368;var t4$17369;var construct$17378;var bindings$17362;var body$17363;(t0$17365=$17356$17360);if(((t0$17365 instanceof Array)&&((t1$17366=t0$17365.length),((t1$17366===3)&&((t0$17365[0]==="data")&&((t2$17367=$20123(["multi"])(t0$17365[1])),(t2$17367[0]&&((t3$17368=t2$17367[1]),((t4$17369=t3$17368.length),(t4$17369>=0)))))))))){(bindings$17362=Array.prototype.slice.call(t3$17368,0));(body$17363=t0$17365[2]);;}else{$20038($17356$17360);}(construct$17378=function($17381$17383){var x$17409;var xs$17410;var $17386$17400;var $17387$17401;var t0$17398;var $17385$17393;var ph$17388;(ph$17388=$17381$17383);;($17385$17393=ph$17388);;if((($17386$17400=($17385$17393 instanceof Array))&&((t0$17398=$17385$17393.length),(t0$17398===0)))){return body$17363;}else{if(($17386$17400&&(t0$17398>=1))){(x$17409=$17385$17393[0]);(xs$17410=Array.prototype.slice.call($17385$17393,1));return $20051(["multi",x$17409,construct$17378(xs$17410)],({"nonrecursive":true}));}else{$20038($17385$17393);}}});;return construct$17378(bindings$17362);})),function(){if(t0$17354[0]){(accum$17352["let"]=t0$17354[1]);return accum$17352;}else{return $20038(function(scope$17419,form$17420,$17417$17421){var t0$17426;var t1$17427;var t2$17428;var t3$17429;var t4$17430;var construct$17439;var bindings$17423;var body$17424;(t0$17426=$17417$17421);if(((t0$17426 instanceof Array)&&((t1$17427=t0$17426.length),((t1$17427===3)&&((t0$17426[0]==="data")&&((t2$17428=$20123(["multi"])(t0$17426[1])),(t2$17428[0]&&((t3$17429=t2$17428[1]),((t4$17430=t3$17429.length),(t4$17430>=0)))))))))){(bindings$17423=Array.prototype.slice.call(t3$17429,0));(body$17424=t0$17426[2]);;}else{$20038($17417$17421);}(construct$17439=function($17442$17444){var x$17470;var xs$17471;var $17447$17461;var $17448$17462;var t0$17459;var $17446$17454;var ph$17449;(ph$17449=$17442$17444);;($17446$17454=ph$17449);;if((($17447$17461=($17446$17454 instanceof Array))&&((t0$17459=$17446$17454.length),(t0$17459===0)))){return body$17424;}else{if(($17447$17461&&(t0$17459>=1))){(x$17470=$17446$17454[0]);(xs$17471=Array.prototype.slice.call($17446$17454,1));return $20051(["multi",x$17470,construct$17439(xs$17471)],({"nonrecursive":true}));}else{$20038($17446$17454);}}});;return construct$17439(bindings$17423);});}}())),$19812(((accum$17478=({})),((t0$17480=$20123(expr_mac$13748)(function(scope$17484,form$17485,$17482$17486){var t0$17491;var t1$17492;var t2$17493;var t3$17494;var t4$17495;var bindings$17488;var body$17489;(t0$17491=$17482$17486);if(((t0$17491 instanceof Array)&&((t1$17492=t0$17491.length),((t1$17492===3)&&((t0$17491[0]==="data")&&((t2$17493=$20123(["multi"])(t0$17491[1])),(t2$17493[0]&&((t3$17494=t2$17493[1]),((t4$17495=t3$17494.length),(t4$17495>=0)))))))))){(bindings$17488=Array.prototype.slice.call(t3$17494,0));(body$17489=t0$17491[2]);;}else{$20038($17482$17486);}return ["multi"].concat(bindings$17488).concat([body$17489]);})),function(){if(t0$17480[0]){(accum$17478["letrec"]=t0$17480[1]);return accum$17478;}else{return $20038(function(scope$17506,form$17507,$17504$17508){var t0$17513;var t1$17514;var t2$17515;var t3$17516;var t4$17517;var bindings$17510;var body$17511;(t0$17513=$17504$17508);if(((t0$17513 instanceof Array)&&((t1$17514=t0$17513.length),((t1$17514===3)&&((t0$17513[0]==="data")&&((t2$17515=$20123(["multi"])(t0$17513[1])),(t2$17515[0]&&((t3$17516=t2$17515[1]),((t4$17517=t3$17516.length),(t4$17517>=0)))))))))){(bindings$17510=Array.prototype.slice.call(t3$17516,0));(body$17511=t0$17513[2]);;}else{$20038($17504$17508);}return ["multi"].concat(bindings$17510).concat([body$17511]);});}}())),$19812(((accum$17526=({})),((accum$17526["where"]=function(context$17531,scope$17532,form$17533,$17529$17534){var t0$17539;var t1$17540;var body$17536;var bindings$17537;(t0$17539=$17529$17534);if(((t0$17539 instanceof Array)&&((t1$17540=t0$17539.length),((t1$17540===3)&&(t0$17539[0]==="data"))))){(body$17536=t0$17539[1]);(bindings$17537=t0$17539[2]);;}else{$20038($17529$17534);}return ["send",["symbol","letrec"],["data",bindings$17537,body$17536]];}),accum$17526)),$19812(({"break":break_mac$13752(null),"continue":continue_mac$13753(null)}),$19812(((accum$17546=({})),((t0$17548=$20123(expr_mac$13748)(function(scope$17551,form$17552,arg$17553){return ["js_throw",arg$17553];})),function(){if(t0$17548[0]){(accum$17546["throw"]=t0$17548[1]);return accum$17546;}else{return $20038(function(scope$17557,form$17558,arg$17559){return ["js_throw",arg$17559];});}}())),$19812(((accum$17562=({})),((t0$17564=$20123(expr_mac$13748)(function(scope$17567,form$17568,arg$17569){return ["js_return",arg$17569];})),function(){if(t0$17564[0]){(accum$17562["return"]=t0$17564[1]);return accum$17562;}else{return $20038(function(scope$17573,form$17574,arg$17575){return ["js_return",arg$17575];});}}())),$19812(((accum$17578=({})),((t0$17580=$20123(expr_mac$13748)(function(scope$17583,form$17584,arg$17585){return ["js_new",arg$17585];})),function(){if(t0$17580[0]){(accum$17578["new"]=t0$17580[1]);return accum$17578;}else{return $20038(function(scope$17589,form$17590,arg$17591){return ["js_new",arg$17591];});}}())),$19812(((accum$17594=({})),((t0$17596=$20123(expr_mac$13748)(function(scope$17599,form$17600,arg$17601){return ["js_delete",arg$17601];})),function(){if(t0$17596[0]){(accum$17594["delete"]=t0$17596[1]);return accum$17594;}else{return $20038(function(scope$17605,form$17606,arg$17607){return ["js_delete",arg$17607];});}}())),$19812(((accum$17610=({})),((accum$17610["?"]=function(context$17615,scope$17616,form$17617,$17613$17618){var t0$17622;var t1$17623;var t2$17624;var t3$17625;var other$17681;var $17638$17650;var $17639$17651;var $17640$17652;var $17641$17653;var t0$17648;var $17637$17643;var checker$17634;var expr$17620;(t0$17622=$17613$17618);if(((t0$17622 instanceof Array)&&((t1$17623=t0$17622.length),((t1$17623===3)&&((t0$17622[0]==="data")&&((expr$17620=t0$17622[1]),((t2$17624=t0$17622[2]),((t2$17624 instanceof Array)&&((t3$17625=t2$17624.length),((t3$17625===1)&&(t2$17624[0]==="void"))))))))))){;}else{$20038($17613$17618);}(checker$17634=((($17637$17643=expr$17620)),function(){if((($17638$17650=($17637$17643 instanceof Array))&&((t0$17648=$17637$17643.length),(($17640$17652=(t0$17648===2))&&(($17641$17653=($17637$17643[0]==="symbol"))&&($17637$17643[1]==="String")))))){return checker_db$13736.String;}else{if(($17641$17653&&($17637$17643[1]==="Number"))){return checker_db$13736.Number;}else{if(($17641$17653&&($17637$17643[1]==="true"))){return checker_db$13736.true;}else{if(($17641$17653&&($17637$17643[1]==="false"))){return checker_db$13736.false;}else{if(($17641$17653&&($17637$17643[1]==="null"))){return checker_db$13736.null;}else{if(($17641$17653&&($17637$17643[1]==="undefined"))){return checker_db$13736.undefined;}else{(other$17681=$17637$17643);return ["send",["symbol","___checker"],["data",expr$17620]];}}}}}}}()));;return ["macro",function($17684$17686,env$17687,form$17688,expr$17689){var x$17707;var other$17728;var t0$17719;var $17712$17714;var other$17732;var $17691$17697;var ph$17692;(ph$17692=$17684$17686);;($17691$17697=ph$17692);;if((((x$17707=$17691$17697)),((x$17707 instanceof Array)&&(x$17707[0]==="pattern")))){($17712$17714=expr$17689);;if((($17712$17714 instanceof Array)&&((t0$17719=$17712$17714.length),((t0$17719===1)&&($17712$17714[0]==="void"))))){return ["check",checker$17634,["ignore"]];}else{(other$17728=$17712$17714);return ["check",checker$17634,expr$17689];}}else{(other$17732=$17691$17697);return ["send",checker$17634,["data",expr$17689]];}}];}),accum$17610)),$19812(((accum$17735=({})),((accum$17735["!"]=function(context$17740,scope$17741,form$17742,$17738$17743){var t0$17747;var t1$17748;var t2$17749;var t3$17750;var other$17796;var $17763$17775;var $17764$17776;var $17765$17777;var $17766$17778;var t0$17773;var $17762$17768;var projector$17759;var expr$17745;(t0$17747=$17738$17743);if(((t0$17747 instanceof Array)&&((t1$17748=t0$17747.length),((t1$17748===3)&&((t0$17747[0]==="data")&&((expr$17745=t0$17747[1]),((t2$17749=t0$17747[2]),((t2$17749 instanceof Array)&&((t3$17750=t2$17749.length),((t3$17750===1)&&(t2$17749[0]==="void"))))))))))){;}else{$20038($17738$17743);}(projector$17759=((($17762$17768=expr$17745)),function(){if((($17763$17775=($17762$17768 instanceof Array))&&((t0$17773=$17762$17768.length),(($17765$17777=(t0$17773===2))&&(($17766$17778=($17762$17768[0]==="symbol"))&&($17762$17768[1]==="String")))))){return mac1$13735(function(x$17785){return ["data",["symbol","true"],["send",["symbol","String"],["data",x$17785]]];});}else{if(($17766$17778&&($17762$17768[1]==="Number"))){return mac1$13735(function(x$17792){return ["data",["symbol","true"],["send",["symbol","parseFloat"],["data",x$17792]]];});}else{(other$17796=$17762$17768);return ["send",["symbol","___projector"],["data",expr$17745]];}}}()));;return ["macro",function($17799$17801,env$17802,form$17803,expr$17804){var x$17822;var other$17843;var t0$17834;var $17827$17829;var other$17847;var $17806$17812;var ph$17807;(ph$17807=$17799$17801);;($17806$17812=ph$17807);;if((((x$17822=$17806$17812)),((x$17822 instanceof Array)&&(x$17822[0]==="pattern")))){($17827$17829=expr$17804);;if((($17827$17829 instanceof Array)&&((t0$17834=$17827$17829.length),((t0$17834===1)&&($17827$17829[0]==="void"))))){return ["project",projector$17759,["ignore"]];}else{(other$17843=$17827$17829);return ["project",projector$17759,expr$17804];}}else{(other$17847=$17806$17812);return ["send",["send",projector$17759,["data",expr$17804]],["value",1]];}}];}),accum$17735)),$19812(((accum$17850=({})),((accum$17850["#"]=function(context$17855,scope$17856,form$17857,$17853$17858){var t0$17862;var t1$17863;var t2$17864;var t3$17865;var t4$17866;var t5$17867;var f$17878;var tag$17860;(t0$17862=$17853$17858);if(((t0$17862 instanceof Array)&&((t1$17863=t0$17862.length),((t1$17863===3)&&((t0$17862[0]==="data")&&((t2$17864=t0$17862[1]),((t2$17864 instanceof Array)&&((t3$17865=t2$17864.length),((t3$17865===1)&&((t2$17864[0]==="void")&&((t4$17866=t0$17862[2]),((t4$17866 instanceof Array)&&((t5$17867=t4$17866.length),((t5$17867===2)&&(t4$17866[0]==="symbol"))))))))))))))){(tag$17860=t4$17866[1]);;}else{$20038($17853$17858);}(tag$17860=["value",tag$17860]);(f$17878=function($17881$17883,scope$17884,form$17885,expr$17886){var x$17904;var other$17954;var subp$17944;var $17911$17940;var $17912$17941;var t0$17938;var $17910$17933;var checker_mac$17913;var other$17984;var args$17979;var $17960$17970;var $17961$17971;var t0$17968;var $17959$17963;var $17888$17894;var ph$17889;(ph$17889=$17881$17883);;($17888$17894=ph$17889);;if((((x$17904=$17888$17894)),((x$17904 instanceof Array)&&(x$17904[0]==="pattern")))){(checker_mac$17913=["macro",function(context$17918,scope$17919,form$17920,$17916$17921){var t0$17925;var t1$17926;var expr$17923;(t0$17925=$17916$17921);if(((t0$17925 instanceof Array)&&((t1$17926=t0$17925.length),((t1$17926===2)&&(t0$17925[0]==="data"))))){(expr$17923=t0$17925[1]);;}else{$20038($17916$17921);}return ["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","x"],expr$17923]],["send",["symbol","and"],["data",["send",["symbol","instanceof"],["data",["symbol","x"],["symbol","Array"]]],["send",["symbol","==="],["data",["send",["symbol","x"],["value",0]],tag$17860]]]]]];}]);;($17910$17933=expr$17886);;if((($17911$17940=($17910$17933 instanceof Array))&&((t0$17938=$17910$17933.length),((t0$17938>=1)&&($17910$17933[0]==="data"))))){(subp$17944=Array.prototype.slice.call($17910$17933,1));return ["data",tag$17860].concat(subp$17944);}else{if(($17911$17940&&((t0$17938===1)&&($17910$17933[0]==="void")))){return ["check",checker_mac$17913,["ignore"]];}else{(other$17954=$17910$17933);return ["check",checker_mac$17913,expr$17886];}}}else{$17888$17894;($17959$17963=expr$17886);;if((($17960$17970=($17959$17963 instanceof Array))&&((t0$17968=$17959$17963.length),((t0$17968===1)&&($17959$17963[0]==="void"))))){return ["data",tag$17860];}else{if(($17960$17970&&((t0$17968>=1)&&($17959$17963[0]==="data")))){(args$17979=Array.prototype.slice.call($17959$17963,1));return ["data",tag$17860].concat(args$17979);}else{(other$17984=$17959$17963);return ["send",["data",tag$17860],other$17984];}}}});;return ["macro",f$17878];}),accum$17850)),$19812(((accum$17988=({})),((accum$17988["require"]=function(context$17993,scope$17994,form$17995,$17991$17996){var t0$18000;var t1$18001;var req$18007;var stmts$18008;var topfetch$18009;var produce$18010;var expr$17998;(t0$18000=$17991$17996);if(((t0$18000 instanceof Array)&&((t1$18001=t0$18000.length),((t1$18001===2)&&(t0$18000[0]==="data"))))){(expr$17998=t0$18000[1]);;}else{$20038($17991$17996);}(req$18007=["variable","require"]);;(stmts$18008=[]);;(topfetch$18009=function(pkg$18020,v$18021){stmts$18008.push(["send",["symbol","="],["data",v$18021,["send",req$18007,["data",pkg$18020]]]]);return v$18021;});;(produce$18010=function($18027$18029,fetch$18030){var t0$18046;var t0$18090;var t0$18094;var $index$18116;var $length$18111;var temp$18106;var acc$18101;var pkgv$18171;var pkg$18164;var subp$18165;var pkg$18148;var s$18149;var name$18136;var subp$18087;var s$18081;var s$18075;var $18034$18064;var $18035$18065;var $18036$18066;var $18037$18067;var $18038$18068;var $18039$18069;var $18040$18070;var $18041$18071;var $18042$18072;var t0$18055;var t1$18056;var bridge$18033$18057;var t2$18058;var t3$18059;var t4$18060;var t5$18061;var t6$18062;var $18032$18050;var ph$18043;var expr$18044;(t0$18046=$18027$18029);(expr$18044=t0$18046);(ph$18043=t0$18046);;($18032$18050=ph$18043);;if((($18034$18064=($18032$18050 instanceof Array))&&((t0$18055=$18032$18050.length),(($18036$18066=(t0$18055===2))&&($18032$18050[0]==="symbol"))))){(s$18075=$18032$18050[1]);return fetch$18030(["value",s$18075],expr$18044);}else{if(($18036$18066&&(($18032$18050[0]==="value")&&((t1$18056=$18032$18050[1]),(typeof(t1$18056)==="string"))))){(s$18081=t1$18056);return fetch$18030(expr$18044,["symbol",scope$17994.gensym()]);}else{(bridge$18033$18057=$18032$18050);if((((bridge$18033$18057 instanceof Array)&&((t0$18090=bridge$18033$18057.length),((t0$18090>=1)&&((bridge$18033$18057[0]==="multi")&&((subp$18087=Array.prototype.slice.call(bridge$18033$18057,1)),true)))))||((bridge$18033$18057 instanceof Array)&&((t0$18094=bridge$18033$18057.length),((t0$18094>=1)&&((bridge$18033$18057[0]==="data")&&((subp$18087=Array.prototype.slice.call(bridge$18033$18057,1)),true))))))){(acc$18101=[]);;(temp$18106=subp$18087);;($length$18111=temp$18106.length);;($index$18116=0);;$18098:for(;($index$18116<$length$18111);($index$18116++)){var p$18132;var m$18124;(m$18124=temp$18106[$index$18116]);;(p$18132=m$18124);acc$18101.push(produce$18010(p$18132,fetch$18030));}return acc$18101;}else{if((($18034$18064=($18032$18050 instanceof Array))&&((t0$18055=$18032$18050.length),(($18036$18066=(t0$18055===3))&&(($18037$18067=($18032$18050[0]==="send"))&&((t1$18056=$18032$18050[1]),(($18039$18069=(t1$18056 instanceof Array))&&((t2$18058=t1$18056.length),(($18041$18071=(t2$18058===2))&&(($18042$18072=(t1$18056[0]==="symbol"))&&((t1$18056[1]==="^")&&((t3$18059=$18032$18050[2]),((t3$18059 instanceof Array)&&((t4$18060=t3$18059.length),((t4$18060===3)&&((t3$18059[0]==="data")&&((t5$18061=t3$18059[1]),((t5$18061 instanceof Array)&&((t6$18062=t5$18061.length),((t6$18062===1)&&(t5$18061[0]==="void"))))))))))))))))))))){(name$18136=t3$18059[2]);return fetch$18030(name$18136,["symbol",scope$17994.gensym()]);}else{if(($18042$18072&&((t1$18056[1]==="as")&&((t3$18059=$18032$18050[2]),((t3$18059 instanceof Array)&&((t4$18060=t3$18059.length),((t4$18060===3)&&(t3$18059[0]==="data")))))))){(pkg$18148=t3$18059[1]);(s$18149=t3$18059[2]);return produce$18010(pkg$18148,function(the_pkg$18156,$18154$18157){$18154$18157;;return fetch$18030(the_pkg$18156,s$18149);});}else{if(($18042$18072&&((t1$18056[1]==="->")&&((t3$18059=$18032$18050[2]),((t3$18059 instanceof Array)&&((t4$18060=t3$18059.length),((t4$18060===3)&&(t3$18059[0]==="data")))))))){(pkg$18164=t3$18059[1]);(subp$18165=t3$18059[2]);(pkgv$18171=produce$18010(pkg$18164,fetch$18030));;return produce$18010(subp$18165,function(pkg$18176,v$18177){return stmts$18008.push(["send",["symbol","="],["data",v$18177,["send",pkgv$18171,pkg$18176]]]);});}else{$20038($18032$18050);}}}}}}});;produce$18010(expr$17998,topfetch$18009);return ["splice"].concat(stmts$18008);}),accum$17988)),$19812(((accum$18183=({})),((accum$18183["provide"]=function(context$18188,scope$18189,form$18190,$18186$18191){var t0$18195;var t1$18196;var t2$18197;var t3$18198;var t4$18199;var $index$18227;var $length$18222;var temp$18217;var acc$18212;var expr$18193;(t0$18195=$18186$18191);if(((t0$18195 instanceof Array)&&((t1$18196=t0$18195.length),((t1$18196===2)&&((t0$18195[0]==="data")&&((t2$18197=$20123(["multi"])(t0$18195[1])),(t2$18197[0]&&((t3$18198=t2$18197[1]),((t4$18199=t3$18198.length),(t4$18199>=0)))))))))){(expr$18193=Array.prototype.slice.call(t3$18198,0));;}else{$20038($18186$18191);}return ["sink",["multi"].concat((((acc$18212=[])),(((temp$18217=expr$18193)),((($length$18222=temp$18217.length)),((($index$18227=0)),function(){$18207:for(;($index$18227<$length$18222);($index$18227++)){var t0$18269;var t0$18273;var other$18279;var s$18258;var name$18259;var s$18251;var name$18252;var $18210$18248;var t0$18240;var t1$18241;var t2$18242;var t3$18243;var t4$18244;var t5$18245;var bridge$18209$18246;var m$18235;(m$18235=temp$18217[$index$18227]);;(t0$18240=m$18235);(s$18251=t0$18240);if(((t0$18240 instanceof Array)&&((t1$18241=t0$18240.length),((t1$18241===2)&&(t0$18240[0]==="symbol"))))){(name$18252=t0$18240[1]);acc$18212.push(["send",["symbol",":="],["data",["send",["symbol","exports"],["value",name$18252]],s$18251]]);}else{if(((t0$18240 instanceof Array)&&((t1$18241=t0$18240.length),((t1$18241===3)&&((t0$18240[0]==="send")&&((t2$18242=t0$18240[1]),((t2$18242 instanceof Array)&&((t3$18243=t2$18242.length),((t3$18243===2)&&((t2$18242[0]==="symbol")&&((t2$18242[1]==="as")&&((t4$18244=t0$18240[2]),((t4$18244 instanceof Array)&&((t5$18245=t4$18244.length),((t5$18245===3)&&((t4$18244[0]==="data")&&((s$18258=t4$18244[1]),((bridge$18209$18246=t4$18244[2]),(((bridge$18209$18246 instanceof Array)&&((t0$18269=bridge$18209$18246.length),((t0$18269===2)&&((bridge$18209$18246[0]==="symbol")&&((name$18259=bridge$18209$18246[1]),true)))))||((bridge$18209$18246 instanceof Array)&&((t0$18273=bridge$18209$18246.length),((t0$18273===2)&&((bridge$18209$18246[0]==="value")&&((name$18259=bridge$18209$18246[1]),true)))))))))))))))))))))))){acc$18212.push(["send",["symbol",":="],["data",["send",["symbol","exports"],["value",name$18259]],s$18258]]);}else{(other$18279=m$18235);acc$18212.push(function(){throw $19862(["syntax","provide"]).create("Each clause of provide must be 'sym' or 'sym as name'");}());}}}}()))),acc$18212))];}),accum$18183)),$19812(((accum$18282=({})),((accum$18282["class"]=function(context$18287,scope$18288,$18285$18289,expr$18290){var t0$18294;var stmts$18618;var name$18607;var stmts$18608;var $18300$18603;var $18301$18604;var t0$18598;var t1$18599;var t2$18600;var t3$18601;var $18299$18593;var helper$18302;var env$18292;(t0$18294=$18285$18289);if($19824(t0$18294,"env")){(env$18292=t0$18294.env);;}else{$20038($18285$18289);}(helper$18302=function(name$18306,stmts$18307){var $index$18345;var $length$18340;var temp$18335;var acc$18330;var t0$18547;var t1$18548;var t0$18557;var env2$18554;var it$18555;var t0$18565;var t1$18566;var other$18589;var t0$18580;var $18310$18575;var statics$18311;var ctor$18312;var new_stmts$18313;var ctor_args$18314;var ctor_body$18315;var name_str$18316;var node$18317;(statics$18311=["data",["symbol","="]]);;(ctor$18312=[["data"],$20051(["multi"],({"env":env$18292}))]);;(new_stmts$18313=(((acc$18330=[])),(((temp$18335=stmts$18307)),((($length$18340=temp$18335.length)),((($index$18345=0)),function(){$18326:for(;($index$18345<$length$18340);($index$18345++)){var t0$18388;var t1$18389;var t2$18390;var t3$18391;var t4$18392;var t5$18393;var t6$18394;var t7$18395;var t8$18396;var t0$18409;var t1$18410;var t2$18411;var t3$18412;var t4$18413;var t5$18414;var t6$18415;var t7$18416;var t8$18417;var t9$18418;var t10$18419;var t11$18420;var t12$18421;var accum$18451;var accum$18475;var accum$18482;var accum$18533;var lhs$18441;var rhs$18442;var args$18384;var body$18385;var methods$18371;var t0$18358;var t1$18359;var t2$18360;var t3$18361;var t4$18362;var t5$18363;var t6$18364;var t7$18365;var t8$18366;var bridge$18328$18367;var m$18353;(m$18353=temp$18335[$index$18345]);;(t0$18358=m$18353);if(((t0$18358 instanceof Array)&&((t1$18359=t0$18358.length),((t1$18359===3)&&((t0$18358[0]==="send")&&((t2$18360=t0$18358[1]),((t2$18360 instanceof Array)&&((t3$18361=t2$18360.length),((t3$18361===2)&&((t2$18360[0]==="symbol")&&((t2$18360[1]==="static")&&((t4$18362=t0$18358[2]),((t4$18362 instanceof Array)&&((t5$18363=t4$18362.length),((t5$18363===2)&&((t4$18362[0]==="data")&&((t6$18364=$20123(["multi"])(t4$18362[1])),(t6$18364[0]&&((t7$18365=t6$18364[1]),((t8$18366=t7$18365.length),(t8$18366>=0))))))))))))))))))))){(methods$18371=Array.prototype.slice.call(t7$18365,0));acc$18330.push((statics$18311=statics$18311.concat(methods$18371)));}else{(bridge$18328$18367=m$18353);if((((bridge$18328$18367 instanceof Array)&&((t0$18388=bridge$18328$18367.length),((t0$18388===3)&&((bridge$18328$18367[0]==="send")&&((t1$18389=bridge$18328$18367[1]),((t1$18389 instanceof Array)&&((t2$18390=t1$18389.length),((t2$18390===2)&&((t1$18389[0]==="symbol")&&((t1$18389[1]==="=")&&((t3$18391=bridge$18328$18367[2]),((t3$18391 instanceof Array)&&((t4$18392=t3$18391.length),((t4$18392===3)&&((t3$18391[0]==="data")&&((t5$18393=t3$18391[1]),((t5$18393 instanceof Array)&&((t6$18394=t5$18393.length),((t6$18394===3)&&((t5$18393[0]==="send")&&((t7$18395=t5$18393[1]),((t7$18395 instanceof Array)&&((t8$18396=t7$18395.length),((t8$18396===2)&&((t7$18395[0]==="symbol")&&((t7$18395[1]==="constructor")&&((args$18384=t5$18393[2]),((body$18385=t3$18391[2]),true))))))))))))))))))))))))))))||((bridge$18328$18367 instanceof Array)&&((t0$18409=bridge$18328$18367.length),((t0$18409===3)&&((bridge$18328$18367[0]==="send")&&((t1$18410=bridge$18328$18367[1]),((t1$18410 instanceof Array)&&((t2$18411=t1$18410.length),((t2$18411===2)&&((t1$18410[0]==="symbol")&&((t1$18410[1]==="=")&&((t3$18412=bridge$18328$18367[2]),((t3$18412 instanceof Array)&&((t4$18413=t3$18412.length),((t4$18413===3)&&((t3$18412[0]==="data")&&((t5$18414=t3$18412[1]),((t5$18414 instanceof Array)&&((t6$18415=t5$18414.length),((t6$18415===2)&&((t5$18414[0]==="symbol")&&((t5$18414[1]==="constructor")&&((t7$18416=t3$18412[2]),((t7$18416 instanceof Array)&&((t8$18417=t7$18416.length),((t8$18417===3)&&((t7$18416[0]==="send")&&((t9$18418=t7$18416[1]),((t9$18418 instanceof Array)&&((t10$18419=t9$18418.length),((t10$18419===2)&&((t9$18418[0]==="symbol")&&((t9$18418[1]==="->")&&((t11$18420=t7$18416[2]),((t11$18420 instanceof Array)&&((t12$18421=t11$18420.length),((t12$18421===3)&&((t11$18420[0]==="data")&&((args$18384=t11$18420[1]),((body$18385=t11$18420[2]),true))))))))))))))))))))))))))))))))))))))))){acc$18330.push(((ctor$18312=[args$18384,body$18385]),["splice"]));}else{(t0$18358=m$18353);if(((t0$18358 instanceof Array)&&((t1$18359=t0$18358.length),((t1$18359===3)&&((t0$18358[0]==="send")&&((t2$18360=t0$18358[1]),((t2$18360 instanceof Array)&&((t3$18361=t2$18360.length),((t3$18361===2)&&((t2$18360[0]==="symbol")&&((t2$18360[1]==="=")&&((t4$18362=t0$18358[2]),((t4$18362 instanceof Array)&&((t5$18363=t4$18362.length),((t5$18363===3)&&(t4$18362[0]==="data")))))))))))))))){(lhs$18441=t4$18362[1]);(rhs$18442=t4$18362[2]);acc$18330.push(parse_pattern$13728(scope$18288,lhs$18441,rhs$18442,$20051(pattern_handlers$13758.build_object,$19812(({"allow_nested":false}),$19812(((accum$18451=({})),((accum$18451["assign"]=function($18454$18457,value$18458){var t0$18465;var t0$18469;var bridge$18455$18462;var v$18460;(bridge$18455$18462=$18454$18457);if((((bridge$18455$18462 instanceof Array)&&((t0$18465=bridge$18455$18462.length),((t0$18465===2)&&((bridge$18455$18462[0]==="symbol")&&((v$18460=bridge$18455$18462[1]),true)))))||((bridge$18455$18462 instanceof Array)&&((t0$18469=bridge$18455$18462.length),((t0$18469===2)&&((bridge$18455$18462[0]==="value")&&((v$18460=bridge$18455$18462[1]),true))))))){;}else{$20038($18454$18457);}return ["do",__lt____lt____colon__$13720(["assign",["send",["send",name$18306,["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value",v$18460]],value$18458],v$18460)];}),accum$18451)),$19812(((accum$18475=({})),((accum$18475["declare"]=function(vars$18479){return [];}),accum$18475)),$19812(((accum$18482=({})),((accum$18482["wrap_target"]=function($18485$18487){var t0$18521;var env$18518;var it$18519;var other$18530;var args$18508;var body$18509;var t0$18500;var t1$18501;var t2$18502;var t3$18503;var t4$18504;var $18489$18495;var ph$18490;(ph$18490=$18485$18487);;($18489$18495=ph$18490);;if((($18489$18495 instanceof Array)&&((t0$18500=$18489$18495.length),((t0$18500===3)&&(($18489$18495[0]==="send")&&((t1$18501=$18489$18495[1]),((t1$18501 instanceof Array)&&((t2$18502=t1$18501.length),((t2$18502===2)&&((t1$18501[0]==="symbol")&&((t1$18501[1]==="->")&&((t3$18503=$18489$18495[2]),((t3$18503 instanceof Array)&&((t4$18504=t3$18503.length),((t4$18504===3)&&(t3$18503[0]==="data")))))))))))))))){(args$18508=t3$18503[1]);(body$18509=t3$18503[2]);(t0$18521=body$18509);if($19824(t0$18521,"env")){(env$18518=t0$18521.env);;}else{$20038(body$18509,"/home/olivier/git/earl-grey/src/stdenv.eg",25878,25882);}(it$18519=$20051(["symbol","@"],({"env":env$18518})));;return ["send",["symbol","->"],["data",args$18508,["send",["symbol","let"],["data",["send",["symbol","="],["data",it$18519,["symbol","this"]]],body$18509]]]];}else{(other$18530=$18489$18495);return other$18530;}}),accum$18482)),((accum$18533=({})),((accum$18533["success"]=function($18536$18538){$18536$18538;;return ["splice"];}),accum$18533)))))))));}else{$20038(m$18353,"/home/olivier/git/earl-grey/src/stdenv.eg",25157,26213);;}}}}}()))),acc$18330));;(t0$18547=ctor$18312);if(((t0$18547 instanceof Array)&&((t1$18548=t0$18547.length),(t1$18548===2)))){(ctor_args$18314=t0$18547[0]);(ctor_body$18315=t0$18547[1]);;}else{$20038(ctor$18312,"/home/olivier/git/earl-grey/src/stdenv.eg",26238,26242);}(ctor_body$18315=(((t0$18557=ctor_body$18315),function(){if($19824(t0$18557,"env")){(env2$18554=t0$18557.env);}else{return $20038(ctor_body$18315,"/home/olivier/git/earl-grey/src/stdenv.eg",26293,26302);}}()),((it$18555=$20051(["symbol","@"],({"env":env2$18554})))),["send",["symbol","let"],["data",["send",["symbol","="],["data",it$18555,["send",["symbol","if"],["data",["send",["symbol","not"],["data",["void"],["send",["send",["symbol","?"],["data",name$18306,["void"]]],["symbol","this"]]]],["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","create"]]]],["data",["send",name$18306,["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]],["symbol","this"]]]]],["multi",ctor_body$18315,it$18555]]]));(t0$18565=name$18306);if(((t0$18565 instanceof Array)&&((t1$18566=t0$18565.length),((t1$18566===2)&&(t0$18565[0]==="symbol"))))){(name_str$18316=t0$18565[1]);;}else{$20038(name$18306,"/home/olivier/git/earl-grey/src/stdenv.eg",26518,26522);}statics$18311.push(["send",["symbol","="],["data",["value","::name"],["value",name_str$18316]]]);statics$18311.push(["send",["symbol","="],["data",["value","::egclass"],["symbol","true"]]]);(node$18317=["splice",["send",["symbol","="],["data",name$18306,["send",["symbol","->"],["data",ctor_args$18314,ctor_body$18315]]]]].concat(new_stmts$18313).concat([["send",["symbol","&:"],["data",name$18306,statics$18311]],name$18306]));;($18310$18575=context$18287);;if((($18310$18575 instanceof Array)&&((t0$18580=$18310$18575.length),((t0$18580===2)&&(($18310$18575[0]==="expr")&&($18310$18575[1]==="multi")))))){return node$18317;}else{(other$18589=$18310$18575);return ["multi",node$18317];}});;($18299$18593=expr$18290);;if((($18300$18603=($18299$18593 instanceof Array))&&((t0$18598=$18299$18593.length),((t0$18598===3)&&(($18299$18593[0]==="data")&&((name$18607=$18299$18593[1]),((t1$18599=$20123(["multi"])($18299$18593[2])),(t1$18599[0]&&((t2$18600=t1$18599[1]),((t3$18601=t2$18600.length),(t3$18601>=0))))))))))){(stmts$18608=Array.prototype.slice.call(t2$18600,0));return helper$18302(name$18607,stmts$18608);}else{if(($18300$18603&&((t0$18598===2)&&(($18299$18593[0]==="data")&&((t1$18599=$20123(["multi"])($18299$18593[1])),(t1$18599[0]&&((t2$18600=t1$18599[1]),((t3$18601=t2$18600.length),(t3$18601>=0))))))))){(stmts$18618=Array.prototype.slice.call(t2$18600,0));return helper$18302(["symbol",scope$18288.gensym()],stmts$18618);}else{$20038($18299$18593);}}}),accum$18282)),$19812(((accum$18627=({})),((accum$18627["%"]=function(context$18632,scope$18633,form$18634,$18630$18635){var t0$18640;var t1$18641;var x$18823;var args$18818;var $18799$18809;var $18800$18810;var t0$18807;var $18798$18802;var tags$18647;var parse$18648;var descr$18637;var contents$18638;(t0$18640=$18630$18635);if(((t0$18640 instanceof Array)&&((t1$18641=t0$18640.length),((t1$18641===3)&&(t0$18640[0]==="data"))))){(descr$18637=t0$18640[1]);(contents$18638=t0$18640[2]);;}else{$20038($18630$18635);}(tags$18647=["data"]);;(parse$18648=function($18654$18656){var t0$18675;var t0$18732;var t0$18736;var t0$18750;var t0$18754;var t0$18767;var t0$18771;var t0$18787;var t0$18791;var args$18784;var expr$18777;var rest$18778;var prop$18760;var value$18761;var x$18742;var x$18722;var x$18717;var s$18712;var $18663$18696;var $18664$18697;var $18665$18698;var $18666$18699;var $18667$18700;var $18668$18701;var $18669$18702;var $18670$18703;var $18671$18704;var t0$18684;var t1$18685;var t2$18686;var t3$18687;var t4$18688;var t5$18689;var t6$18690;var bridge$18659$18691;var bridge$18660$18692;var bridge$18661$18693;var bridge$18662$18694;var $18658$18679;var ph$18672;var toparse$18673;(t0$18675=$18654$18656);(toparse$18673=t0$18675);(ph$18672=t0$18675);;($18658$18679=ph$18672);;if((($18663$18696=($18658$18679 instanceof Array))&&((t0$18684=$18658$18679.length),((t0$18684===1)&&($18658$18679[0]==="void"))))){return null;}else{if(($18663$18696&&(($18665$18698=(t0$18684===2))&&($18658$18679[0]==="symbol")))){(s$18712=$18658$18679[1]);return tags$18647.push(["value",("+"+s$18712)]);}else{if(($18665$18698&&($18658$18679[0]==="value"))){(x$18717=$18658$18679[1]);return tags$18647.push(["value",("+"+x$18717)]);}else{if(($18663$18696&&(($18665$18698=(t0$18684===3))&&(($18666$18699=($18658$18679[0]==="send"))&&((t1$18685=$18658$18679[1]),(($18668$18701=(t1$18685 instanceof Array))&&((t2$18686=t1$18685.length),(($18670$18703=(t2$18686===2))&&(($18671$18704=(t1$18685[0]==="symbol"))&&((t1$18685[1]===".")&&((t3$18687=$18658$18679[2]),((t3$18687 instanceof Array)&&((t4$18688=t3$18687.length),((t4$18688===3)&&((t3$18687[0]==="data")&&((t5$18689=t3$18687[1]),((t5$18689 instanceof Array)&&((t6$18690=t5$18689.length),((t6$18690===1)&&((t5$18689[0]==="void")&&((bridge$18659$18691=t3$18687[2]),(((bridge$18659$18691 instanceof Array)&&((t0$18732=bridge$18659$18691.length),((t0$18732===2)&&((bridge$18659$18691[0]==="symbol")&&((x$18722=bridge$18659$18691[1]),true)))))||((bridge$18659$18691 instanceof Array)&&((t0$18736=bridge$18659$18691.length),((t0$18736===2)&&((bridge$18659$18691[0]==="value")&&((x$18722=bridge$18659$18691[1]),true))))))))))))))))))))))))))){return tags$18647.push(["value",x$18722]);}else{if(($18671$18704&&((t1$18685[1]==="#")&&((t3$18687=$18658$18679[2]),((t3$18687 instanceof Array)&&((t4$18688=t3$18687.length),((t4$18688===3)&&((t3$18687[0]==="data")&&((t5$18689=t3$18687[1]),((t5$18689 instanceof Array)&&((t6$18690=t5$18689.length),((t6$18690===1)&&((t5$18689[0]==="void")&&((bridge$18660$18692=t3$18687[2]),(((bridge$18660$18692 instanceof Array)&&((t0$18750=bridge$18660$18692.length),((t0$18750===2)&&((bridge$18660$18692[0]==="symbol")&&((x$18742=bridge$18660$18692[1]),true)))))||((bridge$18660$18692 instanceof Array)&&((t0$18754=bridge$18660$18692.length),((t0$18754===2)&&((bridge$18660$18692[0]==="value")&&((x$18742=bridge$18660$18692[1]),true)))))))))))))))))))){return tags$18647.push(["value",("#"+x$18742)]);}else{if(($18671$18704&&((t1$18685[1]==="=")&&((t3$18687=$18658$18679[2]),((t3$18687 instanceof Array)&&((t4$18688=t3$18687.length),((t4$18688===3)&&((t3$18687[0]==="data")&&((bridge$18661$18693=t3$18687[1]),(((bridge$18661$18693 instanceof Array)&&((t0$18767=bridge$18661$18693.length),((t0$18767===2)&&((bridge$18661$18693[0]==="symbol")&&((prop$18760=bridge$18661$18693[1]),true)))))||((bridge$18661$18693 instanceof Array)&&((t0$18771=bridge$18661$18693.length),((t0$18771===2)&&((bridge$18661$18693[0]==="value")&&((prop$18760=bridge$18661$18693[1]),true))))))))))))))){(value$18761=t3$18687[2]);return tags$18647.push(["send",["send",["symbol","#"],["data",["void"],["symbol","assoc"]]],["data",["value",prop$18760],value$18761]]);}else{if($18666$18699){(expr$18777=$18658$18679[1]);(rest$18778=$18658$18679[2]);parse$18648(expr$18777);return parse$18648(rest$18778);}else{(bridge$18662$18694=$18658$18679);if((((bridge$18662$18694 instanceof Array)&&((t0$18787=bridge$18662$18694.length),((t0$18787>=1)&&((bridge$18662$18694[0]==="multi")&&((args$18784=Array.prototype.slice.call(bridge$18662$18694,1)),true)))))||((bridge$18662$18694 instanceof Array)&&((t0$18791=bridge$18662$18694.length),((t0$18791>=1)&&((bridge$18662$18694[0]==="data")&&((args$18784=Array.prototype.slice.call(bridge$18662$18694,1)),true))))))){return args$18784.forEach(parse$18648);}else{$20038($18658$18679);}}}}}}}}});;parse$18648(descr$18637);(contents$18638=((($18798$18802=contents$18638)),function(){if((($18799$18809=($18798$18802 instanceof Array))&&((t0$18807=$18798$18802.length),((t0$18807===1)&&($18798$18802[0]==="void"))))){return ["data"];}else{if(($18799$18809&&((t0$18807>=1)&&($18798$18802[0]==="multi")))){(args$18818=Array.prototype.slice.call($18798$18802,1));return ["data"].concat(args$18818);}else{(x$18823=$18798$18802);return x$18823;}}}()));return ["send",["symbol","Node"],["data",tags$18647,contents$18638]];}),accum$18627)),((accum$18826=({})),((accum$18826["globals"]=function(context$18831,scope$18832,form$18833,$18829$18834){var t0$18838;var t1$18839;var t2$18840;var t3$18841;var t4$18842;var $index$18869;var $length$18864;var temp$18859;var acc$18854;var vars$18836;(t0$18838=$18829$18834);if(((t0$18838 instanceof Array)&&((t1$18839=t0$18838.length),((t1$18839===2)&&((t0$18838[0]==="data")&&((t2$18840=$20123(["multi"])(t0$18838[1])),(t2$18840[0]&&((t3$18841=t2$18840[1]),((t4$18842=t3$18841.length),(t4$18842>=0)))))))))){(vars$18836=Array.prototype.slice.call(t3$18841,0));;}else{$20038($18829$18834);}return ["splice"].concat((((acc$18854=[])),(((temp$18859=vars$18836)),((($length$18864=temp$18859.length)),((($index$18869=0)),function(){$18851:for(;($index$18869<$length$18864);($index$18869++)){var var$18887;var s$18888;var t0$18882;var t1$18883;var m$18877;(m$18877=temp$18859[$index$18869]);;(t0$18882=m$18877);(var$18887=t0$18882);if(((t0$18882 instanceof Array)&&((t1$18883=t0$18882.length),((t1$18883===2)&&(t0$18882[0]==="symbol"))))){(s$18888=t0$18882[1]);acc$18854.push(["declare_raw",var$18887,["variable",s$18888]]);}else{$20038(m$18877,"/home/olivier/git/earl-grey/src/stdenv.eg",28161,28238);;}}}()))),acc$18854));}),accum$18826))))))))))))))))))))))))))))))))))))))))))))))));;($length$18896=temp$14840.length);;($index$18901=0);;$13772:for(;($index$18901<$length$18896);($index$18901++)){var k$18919;var v$18920;var t0$18914;var t1$18915;var m$18909;(m$18909=temp$14840[$index$18901]);;(t0$18914=m$18909);if(((t0$18914 instanceof Array)&&((t1$18915=t0$18914.length),(t1$18915===2)))){(k$18919=t0$18914[0]);(v$18920=t0$18914[1]);stdenv$13739.bind(topscope$13743,k$18919,["macro",v$18920]);}else{$20038(m$18909,"/home/olivier/git/earl-grey/src/stdenv.eg",7379,7444);;}}(blocktest_wrap$13762=function(expr$18929){return ["multi",["send",["symbol","="],["data",["symbol","value"],["send",["symbol","!!"],["data",["multi",["send",["symbol","match"],["data",expr$18929,["multi",["send",["symbol","->"],["data",["send",["send",["symbol","?"],["data",["symbol","true"],["void"]]],["symbol","x"]],["send",["send",["symbol","#"],["data",["void"],["symbol","success"]]],["data",["symbol","x"]]]]],["send",["symbol","->"],["data",["send",["send",["symbol","?"],["data",["symbol","false"],["void"]]],["symbol","x"]],["send",["send",["symbol","#"],["data",["void"],["symbol","failure"]]],["data",["symbol","x"]]]]]]]]],["send",["symbol","->"],["data",["symbol","e"],["send",["send",["symbol","#"],["data",["void"],["symbol","error"]]],["data",["symbol","e"]]]]]]]]],["send",["send",["symbol","acc"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",["send",["send",["symbol","#"],["data",["void"],["symbol","test_result"]]],["data",["symbol","label"],["symbol","value"]]]]]];});;(blocktest_mac$13763=function(scope$18935,tests$18936){var $index$18972;var $length$18967;var temp$18962;var acc$18957;var exptests$18939;var n$18940;var stmts$18941;(exptests$18939=$20016(scope$18935.step_all(["test"],tests$18936)));;(n$18940=exptests$18939.length);;(stmts$18941=(((acc$18957=[])),(((temp$18962=exptests$18939)),((($length$18967=temp$18962.length)),((($index$18972=0)),function(){$18950:for(;($index$18972<$length$18967);($index$18972++)){var wrap$19028;var fall$19029;var lbl$19050;var i$19045;var expr$19046;var i$19016;var elements$19017;var clauses$19018;var env$19019;var i$19006;var more_labels$19007;var more_tests$19008;var i$18996;var stmt$18997;var $18952$18990;var $18953$18991;var $18954$18992;var $18955$18993;var t0$18985;var t1$18986;var t2$18987;var t3$18988;var m$18980;(m$18980=temp$18962[$index$18972]);;(t0$18985=m$18980);if((($18953$18991=(t0$18985 instanceof Array))&&((t1$18986=t0$18985.length),(($18955$18993=(t1$18986===2))&&((i$18996=t0$18985[0]),((t2$18987=t0$18985[1]),((t2$18987 instanceof Array)&&((t3$18988=t2$18987.length),((t3$18988===2)&&(t2$18987[0]==="do")))))))))){(stmt$18997=t2$18987[1]);acc$18957.push(stmt$18997);}else{if(($18955$18993&&((i$19006=t0$18985[0]),((t2$18987=t0$18985[1]),((t2$18987 instanceof Array)&&((t3$18988=t2$18987.length),((t3$18988===3)&&(t2$18987[0]==="blocktest")))))))){(more_labels$19007=t2$18987[1]);(more_tests$19008=t2$18987[2]);acc$18957.push(["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","label"],["send",["send",["symbol","label"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",["send",["send",["symbol","!"],["data",["symbol","Array"],["void"]]],more_labels$19007]]]]],["send",["symbol",":="],["data",["symbol","acc"],["send",["send",["symbol","acc"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",blocktest_mac$13763(scope$18935,more_tests$19008)]]]]]]);}else{if(($18955$18993&&((i$19016=t0$18985[0]),((t2$18987=t0$18985[1]),((t2$18987 instanceof Array)&&((t3$18988=t2$18987.length),((t3$18988===3)&&((t2$18987[0]==="test_factory")&&((elements$19017=t2$18987[1]),((clauses$19018=t2$18987[2]),$19824(t2$18987,"env"))))))))))){(env$19019=t2$18987.env);acc$18957.push((((wrap$19028=function(expr$19033,index$19034){return ["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","label"],["send",["send",["symbol","label"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",["data",index$19034]]]]],blocktest_wrap$13762(expr$19033)]];})),((fall$19029=function(target$19040){return match_error$13746(target$19040);})),build_loop$13759(scope$18935,env$19019,["void"],elements$19017,clauses$19018,wrap$19028,["splice"],["splice"],({"fallback":fall$19029}))));}else{if($18955$18993){(i$19045=t0$18985[0]);(expr$19046=t0$18985[1]);acc$18957.push((((lbl$19050=function(){if((n$18940===1)){return ["data"];}else{return ["data",["value",i$19045]];}}())),["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","label"],["send",["send",["symbol","label"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",lbl$19050]]]],blocktest_wrap$13762(expr$19046)]]));}else{$20038(m$18980,"/home/olivier/git/earl-grey/src/stdenv.eg",28575,29381);;}}}}}}()))),acc$18957));;return ["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","acc"],["data"]]],["send",["symbol","!!"],["data",["multi"].concat(stmts$18941).concat([["symbol","acc"]]),["send",["symbol","->"],["data",["symbol","e"],["send",["send",["symbol","acc"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",["data",["send",["send",["symbol","#"],["data",["void"],["symbol","error"]]],["data",["symbol","label"],["symbol","e"]]]]]]]]]]]];});;stdenv$13739.bind(topscope$13743,"blocktest",["macro",function(context$19060,scope$19061,form$19062,$19058$19063){var t0$19070;var t1$19071;var labels$19100;var tests$19101;var tests$19091;var $19066$19087;var $19067$19088;var t0$19082;var t1$19083;var t2$19084;var t3$19085;var $19065$19077;var args$19068;(t0$19070=$19058$19063);if(((t0$19070 instanceof Array)&&((t1$19071=t0$19070.length),((t1$19071>=1)&&(t0$19070[0]==="data"))))){(args$19068=Array.prototype.slice.call(t0$19070,1));;}else{$20038($19058$19063);}($19065$19077=args$19068);;if((($19066$19087=($19065$19077 instanceof Array))&&((t0$19082=$19065$19077.length),((t0$19082===1)&&((t1$19083=$20123(["multi"])($19065$19077[0])),(t1$19083[0]&&((t2$19084=t1$19083[1]),((t3$19085=t2$19084.length),(t3$19085>=0))))))))){(tests$19091=Array.prototype.slice.call(t2$19084,0));return ["multi",["send",["symbol","="],["data",["symbol","label"],["data"]]],blocktest_mac$13763(scope$19061,tests$19091)];}else{if(($19066$19087&&((t0$19082===2)&&((labels$19100=$19065$19077[0]),((t1$19083=$20123(["multi"])($19065$19077[1])),(t1$19083[0]&&((t2$19084=t1$19083[1]),((t3$19085=t2$19084.length),(t3$19085>=0))))))))){(tests$19101=Array.prototype.slice.call(t2$19084,0));return ["multi",["send",["symbol","="],["data",["symbol","label"],["send",["send",["symbol","!"],["data",["symbol","Array"],["void"]]],labels$19100]]],blocktest_mac$13763(scope$19061,tests$19101)];}else{$20038($19065$19077);}}}]);(qqstruct$13764=function(name$19113,args$19114){return ["data",["value",name$19113]].concat(args$19114);});;(qq$13765=function($19119$19121){var t0$19136;var $index$19230;var $length$19225;var temp$19220;var acc$19215;var name$19208;var args$19209;var insert$19199;var insert$19190;var insert$19179;var v$19174;var s$19164;var $19124$19153;var $19125$19154;var $19126$19155;var $19127$19156;var $19128$19157;var $19129$19158;var $19130$19159;var $19131$19160;var $19132$19161;var t0$19145;var t1$19146;var t2$19147;var t3$19148;var t4$19149;var t5$19150;var t6$19151;var $19123$19140;var ph$19133;var expr$19134;(t0$19136=$19119$19121);(expr$19134=t0$19136);(ph$19133=t0$19136);;($19123$19140=ph$19133);;if((($19124$19153=($19123$19140 instanceof Array))&&((t0$19145=$19123$19140.length),((t0$19145===2)&&($19123$19140[0]==="symbol"))))){(s$19164=$19123$19140[1]);return qqstruct$13764("symbol",[["value",s$19164]]);}else{if(($19124$19153&&((t0$19145===1)&&($19123$19140[0]==="void")))){return qqstruct$13764("void",[]);}else{if(($19124$19153&&((t0$19145===2)&&($19123$19140[0]==="value")))){(v$19174=$19123$19140[1]);return qqstruct$13764("value",[expr$19134]);}else{if(($19124$19153&&(($19126$19155=(t0$19145===3))&&(($19127$19156=($19123$19140[0]==="send"))&&((t1$19146=$19123$19140[1]),(($19129$19158=(t1$19146 instanceof Array))&&((t2$19147=t1$19146.length),(($19131$19160=(t2$19147===2))&&(($19132$19161=(t1$19146[0]==="symbol"))&&((t1$19146[1]==="^")&&((t3$19148=$19123$19140[2]),((t3$19148 instanceof Array)&&((t4$19149=t3$19148.length),((t4$19149===3)&&((t3$19148[0]==="data")&&((t5$19150=t3$19148[1]),((t5$19150 instanceof Array)&&((t6$19151=t5$19150.length),((t6$19151===1)&&(t5$19150[0]==="void")))))))))))))))))))){(insert$19179=t3$19148[2]);return insert$19179;}else{if(($19132$19161&&((t1$19146[1]==="^=")&&((t3$19148=$19123$19140[2]),((t3$19148 instanceof Array)&&((t4$19149=t3$19148.length),((t4$19149===3)&&((t3$19148[0]==="data")&&((t5$19150=t3$19148[1]),((t5$19150 instanceof Array)&&((t6$19151=t5$19150.length),((t6$19151===1)&&(t5$19150[0]==="void"))))))))))))){(insert$19190=t3$19148[2]);return qqstruct$13764("value",[insert$19190]);}else{if(($19132$19161&&((t1$19146[1]==="^*")&&((t3$19148=$19123$19140[2]),((t3$19148 instanceof Array)&&((t4$19149=t3$19148.length),((t4$19149===3)&&((t3$19148[0]==="data")&&((t5$19150=t3$19148[1]),((t5$19150 instanceof Array)&&((t6$19151=t5$19150.length),((t6$19151===1)&&(t5$19150[0]==="void"))))))))))))){(insert$19199=t3$19148[2]);return ["send",["symbol","*"],["data",["void"],insert$19199]];}else{if(($19124$19153&&(t0$19145>=1))){(name$19208=$19123$19140[0]);(args$19209=Array.prototype.slice.call($19123$19140,1));return qqstruct$13764(name$19208,(((acc$19215=[])),(((temp$19220=args$19209)),((($length$19225=temp$19220.length)),((($index$19230=0)),function(){$19212:for(;($index$19230<$length$19225);($index$19230++)){var arg$19246;var m$19238;(m$19238=temp$19220[$index$19230]);;(arg$19246=m$19238);acc$19215.push(qq$13765(arg$19246));}}()))),acc$19215));}else{$20038($19123$19140);}}}}}}}});;stdenv$13739.bind(topscope$13743,"'",["macro",function(context$19253,scope$19254,form$19255,$19251$19256){var t0$19260;var t1$19261;var t2$19262;var t3$19263;var expr$19258;(t0$19260=$19251$19256);if(((t0$19260 instanceof Array)&&((t1$19261=t0$19260.length),((t1$19261===3)&&((t0$19260[0]==="data")&&((t2$19262=t0$19260[1]),((t2$19262 instanceof Array)&&((t3$19263=t2$19262.length),((t3$19263===1)&&(t2$19262[0]==="void")))))))))){(expr$19258=t0$19260[2]);;}else{$20038($19251$19256);}return qq$13765(expr$19258);}]);(RegexBuilder$13766=function(){var it$0$19275;(it$0$19275=function(){if((!$13665(RegexBuilder$13766)(this))){return Object.create(RegexBuilder$13766.prototype);}else{return this;}}());;;return it$0$19275;});;(RegexBuilder$13766.prototype["wrap"]=function(x$19285){var it$0$19288;(it$0$19288=this);;return (("(?:"+x$19285)+")");});(RegexBuilder$13766.prototype["quote"]=function(x$19295){var it$0$19298;(it$0$19298=this);;return x$19295.replace(RegExp("([.?*+\\^$\\[\\]\\(\\)\\{\\}|\\\\])","g"),"\\$1");});(RegexBuilder$13766.prototype["quote_charset"]=function(x$19305){var it$0$19308;(it$0$19308=this);;return x$19305.replace(RegExp("([\\[\\]\\(\\)\\{\\}\\^])","g"),"\\$1");});(RegexBuilder$13766.prototype["build"]=function(expr$19315){var t0$19457;var t1$19458;var t0$19469;var t1$19470;var t0$19481;var t1$19482;var t0$19494;var t1$19495;var t0$19501;var t1$19502;var x$19508;var v$19492;var t0$19519;var t1$19520;var t0$19526;var t1$19527;var t2$19528;var t3$19529;var t4$19530;var t5$19531;var t6$19532;var t7$19533;var t8$19534;var t9$19535;var x$19549;var v$19517;var $index$19586;var $length$19581;var temp$19576;var acc$19571;var $index$19635;var $length$19630;var temp$19625;var acc$19620;var other$19655;var args$19606;var args$19557;var a$19433;var b$19434;var $19320$19435;var s$19424;var x$19419;var $19319$19357;var $19321$19346;var $19322$19347;var $19323$19348;var $19324$19349;var $19325$19350;var $19326$19351;var $19327$19352;var $19328$19353;var $19329$19354;var t0$19340;var t1$19341;var t2$19342;var t3$19343;var t4$19344;var $19318$19335;var it$0$19330;(it$0$19330=this);;($19318$19335=expr$19315);;if((($19321$19346=($19318$19335 instanceof Array))&&((t0$19340=$19318$19335.length),(($19323$19348=(t0$19340===2))&&($19318$19335[0]==="symbol"))))){($19319$19357=$19318$19335[1]);if(($19319$19357==="any")){return ".";}else{if(($19319$19357==="start")){return "^";}else{if(($19319$19357==="end")){return "$";}else{if(($19319$19357==="alpha")){return "\\a";}else{if(($19319$19357==="digit")){return "\\d";}else{if(($19319$19357==="word")){return "\\w";}else{if(($19319$19357==="space")){return "\\s";}else{if(($19319$19357==="boundary")){return "\\b";}else{if(($19319$19357==="a")){return "\\a";}else{if(($19319$19357==="d")){return "\\d";}else{if(($19319$19357==="w")){return "\\w";}else{if(($19319$19357==="s")){return "\\s";}else{if(($19319$19357==="b")){return "\\b";}else{$20038($19319$19357,"/home/olivier/git/earl-grey/src/stdenv.eg",30675,30680);}}}}}}}}}}}}}}else{if(($19323$19348&&($19318$19335[0]==="value"))){(x$19419=$19318$19335[1]);return it$0$19330.quote(x$19419);}else{if(($19321$19346&&(($19323$19348=(t0$19340===3))&&(($19324$19349=($19318$19335[0]==="send"))&&((t1$19341=$19318$19335[1]),(($19326$19351=(t1$19341 instanceof Array))&&((t2$19342=t1$19341.length),(($19328$19353=(t2$19342===2))&&(($19329$19354=(t1$19341[0]==="symbol"))&&((t1$19341[1]==="raw")&&((t3$19343=$19318$19335[2]),((t3$19343 instanceof Array)&&((t4$19344=t3$19343.length),((t4$19344===2)&&(t3$19343[0]==="value"))))))))))))))){(s$19424=t3$19343[1]);return s$19424;}else{if(($19329$19354&&(($19320$19435=t1$19341[1]),((t3$19343=$19318$19335[2]),((t3$19343 instanceof Array)&&((t4$19344=t3$19343.length),((t4$19344===3)&&(t3$19343[0]==="data")))))))){(a$19433=t3$19343[1]);(b$19434=t3$19343[2]);if(($19320$19435==="||")){return it$0$19330.wrap(((it$0$19330.build(a$19433)+"|")+it$0$19330.build(b$19434)));}else{if(($19320$19435==="or")){return it$0$19330.wrap(((it$0$19330.build(a$19433)+"|")+it$0$19330.build(b$19434)));}else{if(($19320$19435==="*")){(t0$19457=a$19433);if(((t0$19457 instanceof Array)&&((t1$19458=t0$19457.length),((t1$19458===1)&&(t0$19457[0]==="void"))))){;}else{$20038(a$19433,"/home/olivier/git/earl-grey/src/stdenv.eg",31347,31348);}return it$0$19330.wrap((it$0$19330.build(b$19434)+"*"));}else{if(($19320$19435==="+")){(t0$19469=a$19433);if(((t0$19469 instanceof Array)&&((t1$19470=t0$19469.length),((t1$19470===1)&&(t0$19469[0]==="void"))))){;}else{$20038(a$19433,"/home/olivier/git/earl-grey/src/stdenv.eg",31431,31432);}return it$0$19330.wrap((it$0$19330.build(b$19434)+"+"));}else{if(($19320$19435==="?")){(t0$19481=a$19433);if(((t0$19481 instanceof Array)&&((t1$19482=t0$19481.length),((t1$19482===1)&&(t0$19481[0]==="void"))))){;}else{$20038(a$19433,"/home/olivier/git/earl-grey/src/stdenv.eg",31515,31516);}return it$0$19330.wrap((it$0$19330.build(b$19434)+"?"));}else{if(($19320$19435==="in")){(t0$19494=a$19433);if(((t0$19494 instanceof Array)&&((t1$19495=t0$19494.length),((t1$19495===1)&&(t0$19494[0]==="void"))))){;}else{$20038(a$19433,"/home/olivier/git/earl-grey/src/stdenv.eg",31600,31601);}(t0$19501=b$19434);if(((t0$19501 instanceof Array)&&((t1$19502=t0$19501.length),((t1$19502===2)&&(t0$19501[0]==="value"))))){(v$19492=t0$19501[1]);;}else{$20038(b$19434,"/home/olivier/git/earl-grey/src/stdenv.eg",31629,31630);}(x$19508=it$0$19330.quote_charset(v$19492));;return (("["+x$19508)+"]");}else{if(($19320$19435==="not")){(t0$19519=a$19433);if(((t0$19519 instanceof Array)&&((t1$19520=t0$19519.length),((t1$19520===1)&&(t0$19519[0]==="void"))))){;}else{$20038(a$19433,"/home/olivier/git/earl-grey/src/stdenv.eg",31754,31755);}(t0$19526=b$19434);if(((t0$19526 instanceof Array)&&((t1$19527=t0$19526.length),((t1$19527===3)&&((t0$19526[0]==="send")&&((t2$19528=t0$19526[1]),((t2$19528 instanceof Array)&&((t3$19529=t2$19528.length),((t3$19529===2)&&((t2$19528[0]==="symbol")&&((t2$19528[1]==="in")&&((t4$19530=t0$19526[2]),((t4$19530 instanceof Array)&&((t5$19531=t4$19530.length),((t5$19531===3)&&((t4$19530[0]==="data")&&((t6$19532=t4$19530[1]),((t6$19532 instanceof Array)&&((t7$19533=t6$19532.length),((t7$19533===1)&&((t6$19532[0]==="void")&&((t8$19534=t4$19530[2]),((t8$19534 instanceof Array)&&((t9$19535=t8$19534.length),((t9$19535===2)&&(t8$19534[0]==="value")))))))))))))))))))))))))){(v$19517=t8$19534[1]);;}else{$20038(b$19434,"/home/olivier/git/earl-grey/src/stdenv.eg",31821,31822);}(x$19549=it$0$19330.quote_charset(v$19517));;return (("[^"+x$19549)+"]");}else{$20038($19320$19435,"/home/olivier/git/earl-grey/src/stdenv.eg",31139,31144);}}}}}}}}else{if(($19321$19346&&(($19323$19348=(t0$19340>=1))&&($19318$19335[0]==="data")))){(args$19557=Array.prototype.slice.call($19318$19335,1));return (("("+(((acc$19571=[])),(((temp$19576=args$19557)),((($length$19581=temp$19576.length)),((($index$19586=0)),function(){$19568:for(;($index$19586<$length$19581);($index$19586++)){var arg$19602;var m$19594;(m$19594=temp$19576[$index$19586]);;(arg$19602=m$19594);acc$19571.push(it$0$19330.build(arg$19602));}}()))),acc$19571).join(""))+")");}else{if(($19323$19348&&($19318$19335[0]==="multi"))){(args$19606=Array.prototype.slice.call($19318$19335,1));return (("(?:"+(((acc$19620=[])),(((temp$19625=args$19606)),((($length$19630=temp$19625.length)),((($index$19635=0)),function(){$19617:for(;($index$19635<$length$19630);($index$19635++)){var arg$19651;var m$19643;(m$19643=temp$19625[$index$19635]);;(arg$19651=m$19643);acc$19620.push(it$0$19330.build(arg$19651));}}()))),acc$19620).join(""))+")");}else{(other$19655=$19318$19335);return $19862(["syntax","regexp"]).create("Illegal regular expression",({"expr":expr$19315}));}}}}}}});$19812(RegexBuilder$13766,$19812(((accum$19658=({})),((accum$19658["::name"]="RegexBuilder"),accum$19658)),((accum$19662=({})),((accum$19662["::egclass"]=true),accum$19662))));RegexBuilder$13766;(build_regexp$13767=function(x$19668){return RegexBuilder$13766().build(x$19668);});;(mac$19672=function(context$19677,scope$19678,form$19679,$19675$19680,flags$19681){var arg$19715;var v$19708;var $19684$19704;var $19685$19705;var t0$19696;var t1$19697;var t2$19698;var t3$19699;var t4$19700;var t5$19701;var t6$19702;var $19683$19691;var ph$19686;(ph$19686=$19675$19680);;($19683$19691=ph$19686);;if((($19684$19704=($19683$19691 instanceof Array))&&((t0$19696=$19683$19691.length),((t0$19696===2)&&(($19683$19691[0]==="value")&&((t1$19697=$19683$19691[1]),(typeof(t1$19697)==="string"))))))){(v$19708=t1$19697);return ["send",["symbol","RegExp"],["data",["value",v$19708],["value",flags$19681.join("")]]];}else{if(($19684$19704&&((t0$19696===3)&&(($19683$19691[0]==="send")&&((t1$19697=$19683$19691[1]),((t1$19697 instanceof Array)&&((t2$19698=t1$19697.length),((t2$19698===2)&&((t1$19697[0]==="symbol")&&((t1$19697[1]==="'")&&((t3$19699=$19683$19691[2]),((t3$19699 instanceof Array)&&((t4$19700=t3$19699.length),((t4$19700===3)&&((t3$19699[0]==="data")&&((t5$19701=t3$19699[1]),((t5$19701 instanceof Array)&&((t6$19702=t5$19701.length),((t6$19702===1)&&(t5$19701[0]==="void")))))))))))))))))))){(arg$19715=t3$19699[2]);return ["send",["symbol","RegExp"],["data",["value",build_regexp$13767(arg$19715)],["value",flags$19681.join("")]]];}else{$20038($19683$19691);}}});;stdenv$13739.bind(topscope$13743,"R",["macro",accum_flags$13755(mac$19672,false)]);(errf_macro$13768=function(tags$19730){return function(context$19734,scope$19735,form$19736,$19732$19737){var other$19768;var args$19763;var $19740$19754;var $19741$19755;var t0$19752;var $19739$19747;var ph$19742;(ph$19742=$19732$19737);;($19739$19747=ph$19742);;if((($19740$19754=($19739$19747 instanceof Array))&&((t0$19752=$19739$19747.length),((t0$19752===1)&&($19739$19747[0]==="void"))))){return ["send",["symbol","ErrorFactory"],["data",["data"].concat(tags$19730)]];}else{if(($19740$19754&&((t0$19752>=1)&&($19739$19747[0]==="data")))){(args$19763=Array.prototype.slice.call($19739$19747,1));return ["send",["send",["send",["symbol","ErrorFactory"],["data",["data"].concat(tags$19730)]],["send",["symbol","."],["data",["void"],["symbol","create"]]]],["data"].concat(args$19763)];}else{(other$19768=$19739$19747);return ["macro",errf_macro$13768(tags$19730.concat([other$19768]))];}}};});;stdenv$13739.bind(topscope$13743,"E",["macro",errf_macro$13768([])]);(temp$19773=$20155(({"___build_array":Embedded$13738(["send",["symbol","->"],["data",["data",["symbol","arrays"]],["multi",["send",["symbol","="],["data",["symbol","results"],["data"]]],["send",["symbol","each"],["data",["symbol","arrays"],["send",["symbol","->"],["data",["symbol","a"],["send",["symbol",":="],["data",["symbol","results"],["send",["send",["symbol","results"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",["symbol","a"]]]]]]]]],["symbol","results"]]]]),"object":Embedded$13738(["send",["symbol","->"],["data",["data",["symbol","pairs"]],["multi",["send",["symbol","="],["data",["symbol","rval"],["data",["symbol","="]]]],["send",["symbol","each"],["data",["symbol","pairs"],["send",["symbol","->"],["data",["data",["symbol","k"],["symbol","v"]],["send",["symbol",":="],["data",["send",["symbol","rval"],["symbol","k"]],["symbol","v"]]]]]]],["symbol","rval"]]]]),"items":Embedded$13738(["send",["symbol","->"],["data",["data",["symbol","obj"]],["multi",["send",["symbol","="],["data",["symbol","results"],["data"]]],["send",["symbol","for"],["data",["send",["symbol","in"],["data",["symbol","k"],["symbol","obj"]]],["send",["symbol","if"],["data",["send",["send",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","hasOwnProperty"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","obj"],["symbol","k"]]],["send",["send",["symbol","results"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",["data",["symbol","k"],["send",["symbol","obj"],["symbol","k"]]]]]]]]],["symbol","results"]]]]),"keys":Embedded$13738(["send",["symbol","->"],["data",["data",["symbol","obj"]],["multi",["send",["symbol","="],["data",["symbol","results"],["data"]]],["send",["symbol","for"],["data",["send",["symbol","in"],["data",["symbol","k"],["symbol","obj"]]],["send",["symbol","if"],["data",["send",["send",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","hasOwnProperty"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","obj"],["symbol","k"]]],["send",["send",["symbol","results"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",["symbol","k"]]]]]]],["symbol","results"]]]]),"enumerate":Embedded$13738(["send",["symbol","->"],["data",["data",["symbol","arr"]],["multi",["send",["symbol","="],["data",["symbol","results"],["data"]]],["send",["symbol","="],["data",["symbol","l"],["send",["symbol","arr"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]],["send",["symbol","for"],["data",["multi",["send",["symbol","="],["data",["symbol","i"],["value",0]]],["send",["symbol","<"],["data",["symbol","i"],["symbol","l"]]],["send",["symbol","++"],["data",["symbol","i"],["void"]]]],["send",["send",["symbol","results"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",["data",["symbol","i"],["send",["symbol","arr"],["symbol","i"]]]]]]],["symbol","results"]]]]),"zip":Embedded$13738(["send",["symbol","->"],["data",["data",["symbol","xs"],["symbol","ys"]],["send",["symbol","each"],["data",["send",["symbol","enumerate"],["data",["symbol","xs"]]],["send",["symbol","->"],["data",["data",["symbol","i"],["symbol","x"]],["data",["symbol","x"],["send",["symbol","ys"],["symbol","i"]]]]]]]]]),"predicate":Embedded$13738(["send",["symbol","->"],["data",["data",["symbol","f"]],["multi",["send",["symbol",":="],["data",["send",["symbol","f"],["value","::check"]],["symbol","f"]]],["symbol","f"]]]]),"___nequal":Embedded$13738(["send",["symbol","->"],["data",["data",["symbol","x"],["symbol","y"]],["send",["symbol","not"],["data",["void"],["send",["symbol","=="],["data",["symbol","x"],["symbol","y"]]]]]]]),"___equal":Embedded$13738(["send",["symbol","->"],["data",["data",["send",["symbol","match"],["symbol","a"]],["symbol","b"]],["multi",["send",["symbol","->"],["data",["send",["symbol","==="],["data",["void"],["symbol","b"]]],["symbol","true"]]],["send",["symbol","->"],["data",["send",["symbol","or"],["data",["send",["symbol","or"],["data",["send",["symbol","or"],["data",["send",["symbol","?"],["data",["symbol","Number"],["void"]]],["send",["symbol","?"],["data",["symbol","String"],["void"]]]]],["send",["symbol","?"],["data",["symbol","null"],["void"]]]]],["send",["symbol","?"],["data",["symbol","undefined"],["void"]]]]],["symbol","false"]]],["send",["symbol","->"],["data",["send",["symbol","?"],["data",["symbol","Array"],["void"]]],["multi",["send",["symbol","if"],["data",["send",["symbol","or"],["data",["send",["symbol","not"],["data",["void"],["send",["send",["symbol","?"],["data",["symbol","Array"],["void"]]],["symbol","b"]]]],["send",["symbol","!=="],["data",["send",["symbol","a"],["send",["symbol","."],["data",["void"],["symbol","length"]]]],["send",["symbol","b"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]]]],["send",["symbol","return"],["symbol","false"]]]],["send",["symbol","for"],["data",["multi",["send",["symbol","="],["data",["symbol","i"],["value",0]]],["send",["symbol","<"],["data",["symbol","i"],["send",["symbol","a"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]],["send",["symbol","++"],["data",["symbol","i"],["void"]]]],["send",["symbol","if"],["data",["send",["symbol","not"],["data",["void"],["send",["symbol","=="],["data",["send",["symbol","___js_fetch"],["data",["symbol","a"],["symbol","i"]]],["send",["symbol","___js_fetch"],["data",["symbol","b"],["symbol","i"]]]]]]],["send",["symbol","return"],["symbol","false"]]]]]],["symbol","true"]]]],["send",["symbol","->"],["data",["send",["symbol","when"],["data",["void"],["send",["symbol","and"],["data",["send",["symbol","==="],["data",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","getPrototypeOf"]]]],["data",["symbol","a"]]],["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]],["send",["symbol","==="],["data",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","getPrototypeOf"]]]],["data",["symbol","b"]]],["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]]]]]],["multi",["send",["symbol","="],["data",["symbol","ka"],["send",["symbol","keys"],["data",["symbol","a"]]]]],["send",["symbol","if"],["data",["send",["symbol","not"],["data",["void"],["send",["symbol","=="],["data",["send",["send",["symbol","ka"],["send",["symbol","."],["data",["void"],["symbol","sort"]]]],["data"]],["send",["send",["send",["symbol","keys"],["data",["symbol","b"]]],["send",["symbol","."],["data",["void"],["symbol","sort"]]]],["data"]]]]]],["send",["symbol","return"],["symbol","false"]]]],["send",["symbol","each"],["data",["symbol","ka"],["send",["symbol","->"],["data",["symbol","k"],["send",["symbol","if"],["data",["send",["symbol","not"],["data",["void"],["send",["symbol","=="],["data",["send",["symbol","___js_fetch"],["data",["symbol","a"],["symbol","k"]]],["send",["symbol","___js_fetch"],["data",["symbol","b"],["symbol","k"]]]]]]],["send",["symbol","return"],["symbol","false"]]]]]]]],["symbol","true"]]]],["send",["symbol","->"],["data",["data",["send",["symbol","=>"],["data",["value","::serialize"],["symbol","_"]]]],["send",["symbol","match"],["data",["symbol","b"],["multi",["send",["symbol","->"],["data",["data",["send",["symbol","=>"],["data",["value","::serialize"],["symbol","_"]]]],["send",["symbol","=="],["data",["send",["send",["symbol","a"],["value","::serialize"]],["data"]],["send",["send",["symbol","b"],["value","::serialize"]],["data"]]]]]],["send",["symbol","->"],["data",["symbol","otherwise"],["symbol","false"]]]]]]]],["send",["symbol","->"],["data",["symbol","otherwise"],["symbol","false"]]]]]]),"&:":Embedded$13738(["send",["symbol","->"],["data",["data",["symbol","dest"],["symbol","values"]],["multi",["send",["symbol","for"],["data",["send",["symbol","in"],["data",["symbol","k"],["symbol","values"]]],["send",["symbol","if"],["data",["send",["send",["symbol","values"],["send",["symbol","."],["data",["void"],["symbol","hasOwnProperty"]]]],["data",["symbol","k"]]],["send",["symbol",":="],["data",["send",["symbol","dest"],["symbol","k"]],["send",["symbol","___js_fetch"],["data",["symbol","values"],["symbol","k"]]]]]]]]],["symbol","dest"]]]]),"&":Embedded$13738(["send",["symbol","->"],["data",["data",["symbol","a"],["symbol","b"]],["multi",["send",["symbol","="],["data",["symbol","dest"],["send",["symbol","clone"],["data",["symbol","a"]]]]],["send",["symbol","for"],["data",["send",["symbol","in"],["data",["symbol","k"],["symbol","b"]]],["send",["symbol","if"],["data",["send",["send",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","hasOwnProperty"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","b"],["symbol","k"]]],["send",["symbol",":="],["data",["send",["symbol","dest"],["symbol","k"]],["send",["symbol","___js_fetch"],["data",["symbol","b"],["symbol","k"]]]]]]]]],["symbol","dest"]]]]),"&+":Embedded$13738(["send",["symbol","->"],["data",["data",["symbol","a"],["symbol","b"]],["multi",["send",["symbol","="],["data",["symbol","dest"],["send",["symbol","clone"],["data",["symbol","a"]]]]],["send",["symbol","for"],["data",["send",["symbol","in"],["data",["symbol","k"],["symbol","b"]]],["send",["symbol","if"],["data",["send",["send",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","hasOwnProperty"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","b"],["symbol","k"]]],["send",["symbol",":="],["data",["send",["symbol","dest"],["symbol","k"]],["send",["symbol","___js_fetch"],["data",["symbol","b"],["symbol","k"]]]]]]]]],["symbol","dest"]]]]),"clone":Embedded$13738(["send",["symbol","->"],["data",["data",["send",["symbol","match"],["symbol","x"]]],["multi",["send",["symbol","->"],["data",["send",["symbol","or"],["data",["send",["symbol","or"],["data",["send",["symbol","or"],["data",["send",["symbol","?"],["data",["symbol","undefined"],["void"]]],["send",["symbol","?"],["data",["symbol","null"],["void"]]]]],["send",["symbol","?"],["data",["symbol","String"],["void"]]]]],["send",["symbol","?"],["data",["symbol","Number"],["void"]]]]],["symbol","x"]]],["send",["symbol","->"],["data",["data",["send",["symbol","=>"],["data",["value","::clone"],["symbol","_"]]]],["send",["send",["symbol","x"],["value","::clone"]],["data"]]]],["send",["symbol","->"],["data",["send",["symbol","when"],["data",["void"],["send",["symbol","==="],["data",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","getPrototypeOf"]]]],["data",["symbol","x"]]],["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]]]],["multi",["send",["symbol","="],["data",["symbol","dest"],["data",["symbol","="]]]],["send",["symbol","for"],["data",["send",["symbol","in"],["data",["symbol","k"],["symbol","x"]]],["send",["symbol","if"],["data",["send",["send",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","hasOwnProperty"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","x"],["symbol","k"]]],["send",["symbol",":="],["data",["send",["symbol","dest"],["symbol","k"]],["send",["symbol","___js_fetch"],["data",["symbol","x"],["symbol","k"]]]]]]]]],["symbol","dest"]]]],["send",["symbol","->"],["data",["symbol","other"],["send",["symbol","throw"],["send",["send",["symbol","E"],["send",["symbol","."],["data",["void"],["symbol","clone"]]]],["data",["value","Object cannot be cloned"],["data",["send",["symbol","="],["data",["symbol","obj"],["symbol","x"]]]]]]]]]]]]),"___checker":Embedded$13738(["send",["symbol","->"],["data",["data",["symbol","type"]],["multi",["send",["symbol","="],["data",["symbol","f"],["send",["symbol","type"],["value","::check"]]]],["send",["symbol","if"],["data",["send",["symbol","==="],["data",["symbol","f"],["symbol","undefined"]]],["multi",["send",["symbol","then"],["data",["send",["symbol","->"],["data",["data",["symbol","value"]],["send",["symbol","instanceof"],["data",["symbol","value"],["symbol","type"]]]]]]],["send",["symbol","else"],["data",["send",["symbol","->"],["data",["data",["symbol","value"]],["send",["send",["symbol","f"],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","type"],["symbol","value"]]]]]]]]]]]]]),"___projector":Embedded$13738(["send",["symbol","->"],["data",["data",["symbol","type"]],["send",["symbol","->"],["data",["data",["symbol","value"]],["multi",["send",["symbol","="],["data",["symbol","f"],["send",["symbol","type"],["value",":::project"]]]],["send",["symbol","if"],["data",["send",["symbol","==="],["data",["symbol","f"],["symbol","undefined"]]],["multi",["send",["symbol","then"],["data",["multi",["send",["symbol","="],["data",["symbol","f"],["send",["symbol","type"],["value","::project"]]]],["send",["symbol","if"],["data",["send",["symbol","==="],["data",["symbol","f"],["symbol","undefined"]]],["multi",["send",["symbol","then"],["data",["data",["symbol","true"],["send",["symbol","type"],["data",["symbol","value"]]]]]],["send",["symbol","else"],["data",["send",["symbol","!!"],["data",["data",["symbol","true"],["send",["symbol","f"],["data",["symbol","value"]]]],["send",["symbol","->"],["data",["symbol","e"],["data",["symbol","false"],["symbol","null"]]]]]]]]]]]]]],["send",["symbol","else"],["data",["send",["send",["symbol","f"],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","type"],["symbol","value"]]]]]]]]]]]]]),"___hasprop":Embedded$13738(["send",["symbol","->"],["data",["data",["symbol","match"],["symbol","key"]],["multi",["send",["symbol","->"],["data",["send",["symbol","or"],["data",["send",["symbol","?"],["data",["symbol","null"],["void"]]],["send",["symbol","?"],["data",["symbol","undefined"],["void"]]]]],["symbol","false"]]],["send",["symbol","->"],["data",["send",["send",["symbol","?"],["data",["symbol","String"],["void"]]],["symbol","x"]],["send",["symbol","in"],["data",["symbol","key"],["send",["symbol","String"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]]]],["send",["symbol","->"],["data",["send",["send",["symbol","?"],["data",["symbol","Number"],["void"]]],["symbol","x"]],["send",["symbol","in"],["data",["symbol","key"],["send",["symbol","Number"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]]]],["send",["symbol","->"],["data",["symbol","x"],["send",["symbol","in"],["data",["symbol","key"],["symbol","x"]]]]]]]]),"range":Embedded$13738(["send",["symbol","->"],["data",["data",["symbol","from"],["symbol","to"]],["multi",["send",["symbol","="],["data",["symbol","rval"],["data"]]],["send",["symbol","for"],["data",["multi",["send",["symbol","="],["data",["symbol","i"],["symbol","from"]]],["send",["symbol","<="],["data",["symbol","i"],["symbol","to"]]],["send",["symbol","++"],["data",["symbol","i"],["void"]]]],["send",["send",["symbol","rval"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",["symbol","i"]]]]],["symbol","rval"]]]]),"___serialize_ast":Embedded$13738(["send",["symbol","->"],["data",["data",["symbol","match"]],["multi",["send",["symbol","->"],["data",["send",["symbol","or"],["data",["send",["send",["symbol","?"],["data",["symbol","String"],["void"]]],["symbol","x"]],["send",["send",["symbol","?"],["data",["symbol","Number"],["void"]]],["symbol","x"]]]],["send",["send",["symbol","#"],["data",["void"],["symbol","value"]]],["data",["symbol","x"]]]]],["send",["symbol","->"],["data",["symbol","other"],["send",["send",["symbol","other"],["value","::serialize_ast"]],["data"]]]]]]]),"___match_error":Embedded$13738(["send",["symbol","->"],["data",["data",["symbol","value"],["symbol","url"],["symbol","start"],["symbol","end"]],["multi",["send",["symbol","="],["data",["symbol","err"],["send",["send",["symbol","E"],["send",["symbol","."],["data",["void"],["symbol","match"]]]],["data",["value","Could not find a match for value"],["data",["send",["symbol","="],["data",["symbol","value"],["symbol","value"]]]]]]]],["send",["symbol","if"],["data",["symbol","url"],["send",["symbol",":="],["data",["send",["symbol","err"],["send",["symbol","."],["data",["void"],["symbol","location"]]]],["send",["send",["symbol","#"],["data",["void"],["symbol","location"]]],["data",["symbol","url"],["symbol","start"],["symbol","end"]]]]]]],["send",["symbol","throw"],["symbol","err"]]]]]),"ErrorFactory":Embedded$13738(["send",["symbol","class"],["data",["multi",["send",["symbol","="],["data",["send",["symbol","constructor"],["data",["symbol","tags"]]],["send",["symbol",":="],["data",["send",["symbol","@"],["data",["void"],["symbol","tags"]]],["symbol","tags"]]]]],["send",["symbol","="],["data",["send",["symbol","create"],["data",["send",["symbol","="],["data",["symbol","message"],["value",""]]],["send",["symbol","*"],["data",["void"],["symbol","args"]]]]],["multi",["send",["symbol","="],["data",["symbol","e"],["send",["symbol","Error"],["data",["symbol","message"]]]]],["send",["symbol",":="],["data",["send",["symbol","e"],["value","::tags"]],["send",["symbol","@"],["data",["void"],["symbol","tags"]]]]],["send",["symbol",":="],["data",["send",["symbol","e"],["send",["symbol","."],["data",["void"],["symbol","args"]]]],["symbol","args"]]],["send",["symbol","each"],["data",["send",["symbol","enumerate"],["data",["symbol","args"]]],["send",["symbol","->"],["data",["data",["symbol","i"],["symbol","arg"]],["send",["symbol",":="],["data",["send",["symbol","e"],["symbol","i"]],["symbol","arg"]]]]]]],["send",["symbol",":="],["data",["send",["symbol","e"],["send",["symbol","."],["data",["void"],["symbol","length"]]]],["send",["symbol","args"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]],["send",["symbol",":="],["data",["send",["symbol","e"],["send",["symbol","."],["data",["void"],["symbol","name"]]]],["send",["send",["send",["symbol","++"],["data",["data",["send",["symbol","."],["data",["void"],["symbol","E"]]]],["send",["symbol","@"],["data",["void"],["symbol","tags"]]]]],["send",["symbol","."],["data",["void"],["symbol","join"]]]],["data",["value","."]]]]],["symbol","e"]]]],["send",["symbol","="],["data",["send",["value","::check"],["data",["symbol","e"]]],["multi",["send",["symbol","if"],["data",["send",["symbol","or"],["data",["send",["symbol","not"],["data",["void"],["symbol","e"]]],["send",["symbol","not"],["data",["void"],["send",["send",["symbol","?"],["data",["symbol","Error"],["void"]]],["symbol","e"]]]]]],["send",["symbol","return"],["symbol","false"]]]],["send",["symbol","="],["data",["symbol","tags"],["send",["symbol","or"],["data",["send",["symbol","e"],["value","::tags"]],["data"]]]]],["send",["symbol","each?"],["data",["send",["symbol","@"],["data",["void"],["symbol","tags"]]],["send",["symbol","->"],["data",["send",["symbol","when"],["data",["symbol","tag"],["send",["symbol","==="],["data",["send",["send",["symbol","tags"],["send",["symbol","."],["data",["void"],["symbol","indexOf"]]]],["data",["symbol","tag"]]],["send",["symbol","-"],["data",["void"],["value",1]]]]]]],["send",["symbol","return"],["symbol","false"]]]]]],["symbol","true"]]]],["send",["symbol","="],["data",["send",["value","::deconstruct"],["data",["symbol","e"]]],["send",["symbol","e"],["send",["symbol","."],["data",["void"],["symbol","args"]]]]]]]]]),"Node":Embedded$13738(["send",["symbol","class"],["data",["multi",["send",["symbol","static"],["data",["multi",["send",["symbol","="],["data",["send",["value","::check"],["data",["symbol","x"]]],["send",["symbol","and"],["data",["send",["symbol","and"],["data",["symbol","x"],["send",["symbol","x"],["send",["symbol","."],["data",["void"],["symbol","classes"]]]]]],["send",["symbol","x"],["send",["symbol","."],["data",["void"],["symbol","children"]]]]]]]],["send",["symbol","="],["data",["send",["value","::deconstruct"],["data",["symbol","x"]]],["data",["send",["symbol","x"],["send",["symbol","."],["data",["void"],["symbol","classes"]]]],["send",["symbol","x"],["send",["symbol","."],["data",["void"],["symbol","children"]]]]]]]]]],["send",["symbol","="],["data",["send",["symbol","constructor"],["data",["send",["send",["symbol","!"],["data",["symbol","Array"],["void"]]],["symbol","classes"]],["send",["send",["symbol","!"],["data",["symbol","Array"],["void"]]],["symbol","children"]]]],["multi",["send",["symbol",":="],["data",["send",["symbol","@"],["data",["void"],["symbol","classes"]]],["send",["send",["symbol","classes"],["send",["symbol","."],["data",["void"],["symbol","sort"]]]],["data"]]]],["send",["symbol",":="],["data",["send",["symbol","@"],["data",["void"],["symbol","children"]]],["symbol","children"]]]]]],["send",["symbol","="],["data",["send",["value","::check"],["data",["symbol","n"]]],["multi",["send",["symbol","each?"],["data",["send",["symbol","@"],["data",["void"],["symbol","classes"]]],["send",["symbol","->"],["data",["send",["symbol","when"],["data",["symbol","c"],["send",["symbol","==="],["data",["send",["send",["send",["symbol","n"],["send",["symbol","."],["data",["void"],["symbol","classes"]]]],["send",["symbol","."],["data",["void"],["symbol","indexOf"]]]],["data",["symbol","c"]]],["send",["symbol","-"],["data",["void"],["value",1]]]]]]],["send",["symbol","return"],["symbol","false"]]]]]],["symbol","true"]]]]]]])})));;($length$19778=temp$19773.length);;($index$19783=0);;$13774:for(;($index$19783<$length$19778);($index$19783++)){var k$19801;var v$19802;var t0$19796;var t1$19797;var m$19791;(m$19791=temp$19773[$index$19783]);;(t0$19796=m$19791);if(((t0$19796 instanceof Array)&&((t1$19797=t0$19796.length),(t1$19797===2)))){(k$19801=t0$19796[0]);(v$19802=t0$19796[1]);stdenv$13739.bind(topscope$13743,k$19801,["value",v$19802]);}else{$20038(m$19791,"/home/olivier/git/earl-grey/src/stdenv.eg",32906,32971);;}}(stdprelude$13769=Embedded$13738(["multi",["send",["symbol","="],["data",["send",["symbol","send"],["data",["symbol","obj"],["send",["symbol","match"],["symbol","msg"]]]],["multi",["send",["symbol","->"],["data",["send",["symbol","or"],["data",["send",["symbol","?"],["data",["symbol","String"],["void"]]],["send",["symbol","?"],["data",["symbol","Number"],["void"]]]]],["send",["symbol","___js_fetch"],["data",["symbol","obj"],["symbol","msg"]]]]],["send",["symbol","->"],["data",["symbol","other"],["send",["send",["symbol","obj"],["value","::send"]],["data",["symbol","msg"]]]]]]]],["send",["symbol",":="],["data",["send",["symbol","Array"],["value",":::project"]],["send",["symbol","->"],["data",["data",["send",["symbol","match"],["symbol","value"]]],["multi",["send",["symbol","->"],["data",["send",["symbol","?"],["data",["symbol","Array"],["void"]]],["data",["symbol","true"],["symbol","value"]]]],["send",["symbol","->"],["data",["symbol","_"],["data",["symbol","true"],["data",["symbol","value"]]]]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value","::check"]],["send",["symbol","->"],["data",["data",["symbol","value"]],["send",["symbol","if"],["data",["send",["symbol","instanceof"],["data",["symbol","value"],["symbol","Array"]]],["multi",["send",["symbol","then"],["data",["multi",["send",["symbol","for"],["data",["multi",["send",["symbol","="],["data",["symbol","i"],["value",0]]],["send",["symbol","<"],["data",["symbol","i"],["send",["symbol","this"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]],["send",["symbol","++"],["data",["symbol","i"],["void"]]]],["send",["symbol","if"],["data",["send",["symbol","!=="],["data",["send",["symbol","this"],["symbol","i"]],["send",["symbol","value"],["symbol","i"]]]],["send",["symbol","return"],["symbol","false"]]]]]],["symbol","true"]]]],["send",["symbol","else"],["data",["symbol","false"]]]]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value","::clone"]],["send",["symbol","->"],["data",["data"],["send",["send",["symbol","this"],["send",["symbol","."],["data",["void"],["symbol","slice"]]]],["data",["value",0]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value",":::project"]],["send",["symbol","->"],["data",["data",["symbol","value"]],["send",["symbol","if"],["data",["send",["symbol","instanceof"],["data",["symbol","value"],["symbol","Array"]]],["multi",["send",["symbol","then"],["data",["multi",["send",["symbol","for"],["data",["multi",["send",["symbol","="],["data",["symbol","i"],["value",0]]],["send",["symbol","<"],["data",["symbol","i"],["send",["symbol","this"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]],["send",["symbol","++"],["data",["symbol","i"],["void"]]]],["send",["symbol","if"],["data",["send",["symbol","!=="],["data",["send",["symbol","this"],["symbol","i"]],["send",["symbol","value"],["symbol","i"]]]],["send",["symbol","return"],["data",["symbol","true"],["data",["symbol","value"]]]]]]]],["data",["symbol","true"],["send",["send",["symbol","value"],["send",["symbol","."],["data",["void"],["symbol","slice"]]]],["data",["send",["symbol","this"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]]]]]],["send",["symbol","else"],["data",["data",["symbol","true"],["data",["symbol","value"]]]]]]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value","::serialize_ast"]],["send",["symbol","->"],["data",["data"],["send",["send",["symbol","#"],["data",["void"],["symbol","array"]]],["data",["send",["symbol","*"],["data",["void"],["send",["send",["symbol","this"],["send",["symbol","."],["data",["void"],["symbol","map"]]]],["data",["symbol","___serialize_ast"]]]]]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","RegExp"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value","::check"]],["send",["symbol","->"],["data",["data",["symbol","value"]],["send",["send",["symbol","value"],["send",["symbol","."],["data",["void"],["symbol","match"]]]],["data",["symbol","this"]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","RegExp"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value",":::project"]],["send",["symbol","->"],["data",["data",["symbol","value"]],["send",["symbol","match"],["data",["send",["send",["symbol","value"],["send",["symbol","."],["data",["void"],["symbol","match"]]]],["data",["symbol","this"]]],["multi",["send",["symbol","->"],["data",["send",["send",["symbol","?"],["data",["symbol","null"],["void"]]],["symbol","m"]],["data",["symbol","false"],["symbol","null"]]]],["send",["symbol","->"],["data",["symbol","m"],["data",["symbol","true"],["symbol","m"]]]]]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","Function"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value","::send"]],["send",["symbol","->"],["data",["data",["symbol","args"]],["send",["send",["symbol","this"],["send",["symbol","."],["data",["void"],["symbol","apply"]]]],["data",["symbol","this"],["symbol","args"]]]]]]]]));;(expander$13741["utils"]=({"var_operator":var_operator$13754}));(exports["topscope"]=topscope$13743);(exports["stdenv"]=stdenv$13739);(exports["expander"]=expander$13741);(exports["expand"]=expand$13742);(exports["stdprelude"]=stdprelude$13769);

},{"./expand":5,"./location":7,"./pattern":10,"./pp":11,"./util":14}],13:[function(require,module,exports){
var $20287=function(type$20289){var f$20292;(f$20292=type$20289["::check"]);;if((f$20292===(void 0))){return function(value$20297){return (value$20297 instanceof type$20289);};}else{return function(value$20300){return f$20292.call(type$20289,value$20300);};}};
var $20302=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $20303=function($20304$20306){var ph$20310;(ph$20310=$20304$20306);;var $20308$20315;($20308$20315=ph$20310);;var bridge$20309$20320;var x$20324;(bridge$20309$20320=$20308$20315);if((((typeof(bridge$20309$20320)==="string")&&((x$20324=bridge$20309$20320),true))||((typeof(bridge$20309$20320)==="number")&&((x$20324=bridge$20309$20320),true)))){return ["value",x$20324];}else{var other$20331;(other$20331=$20308$20315);return other$20331["::serialize_ast"]();}};
var send$20171;(send$20171=function(obj$20176,$20174$20177){var ph$20181;var msg$20182;var t0$20184;(t0$20184=$20174$20177);(msg$20182=t0$20184);(ph$20181=t0$20184);;var $20179$20188;($20179$20188=ph$20181);;var bridge$20180$20193;(bridge$20180$20193=$20179$20188);if(((typeof(bridge$20180$20193)==="string")||(typeof(bridge$20180$20193)==="number"))){return obj$20176[msg$20182];}else{var other$20201;(other$20201=$20179$20188);return obj$20176["::send"](msg$20182);}});;(Array[":::project"]=function($20204$20206){var ph$20209;var value$20210;var t0$20212;(t0$20212=$20204$20206);(value$20210=t0$20212);(ph$20209=t0$20212);;var $20208$20216;($20208$20216=ph$20209);;if($20287(Array)($20208$20216)){return [true,value$20210];}else{$20208$20216;return [true,[value$20210]];}});(Array.prototype["::check"]=function(value$20230){if((value$20230 instanceof Array)){var i$20235;(i$20235=0);;$20233:for(;(i$20235<this.length);(i$20235++)){if(($20302(this,i$20235)!==$20302(value$20230,i$20235))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$20246){if((value$20246 instanceof Array)){var i$20251;(i$20251=0);;$20249:for(;(i$20251<this.length);(i$20251++)){if(($20302(this,i$20251)!==$20302(value$20246,i$20251))){return [true,[value$20246]];}}return [true,value$20246.slice(this.length)];}else{return [true,[value$20246]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($20303));});(RegExp.prototype["::check"]=function(value$20262){return value$20262.match(this);});(RegExp.prototype[":::project"]=function(value$20265){var $20267$20269;($20267$20269=value$20265.match(this));;var m$20277;if(($20267$20269===null)){(m$20277=$20267$20269);return [false,null];}else{var m$20282;(m$20282=$20267$20269);return [true,m$20282];}});(Function.prototype["::send"]=function(args$20285){return this.apply(this,args$20285);});
var $21923=function(arr$21925){var results$21929;var l$21930;(results$21929=[]);;(l$21930=arr$21925.length);;var i$21938;(i$21938=0);;$21928:for(;(i$21938<l$21930);(i$21938++)){results$21929.push([i$21938,$20302(arr$21925,i$21938)]);}return results$21929;};
var $21945=function(dest$21947,values$21948){var k$21953;(k$21953=null);$21951:for(k$21953 in values$21948){if(values$21948.hasOwnProperty(k$21953)){(dest$21947[k$21953]=values$21948[k$21953]);}}return dest$21947;};
var $21769=function(){var $21770$21772;($21770$21772=function(tags$21776){var it$0$21779;(it$0$21779=function(){if((!$20287($21770$21772)(this))){return Object.create($21770$21772.prototype);}else{return this;}}());;(it$0$21779["tags"]=tags$21776);return it$0$21779;});;($21770$21772.prototype["create"]=function(){var $21788$21790;($21788$21790=arguments);;var t0$21795;var message$21799;var args$21800;(t0$21795=$21788$21790.length);if((t0$21795>=0)){(message$21799=function(){if((0>=t0$21795)){return "";}else{return $21788$21790[0];}}());(args$21800=Array.prototype.slice.call($21788$21790,1));var it$0$21804;(it$0$21804=this);;var e$21809;(e$21809=Error(message$21799));;(e$21809["::tags"]=it$0$21804.tags);(e$21809["args"]=args$21800);var temp$21817;(temp$21817=$21923(args$21800));;var $length$21822;($length$21822=temp$21817.length);;var $index$21827;($index$21827=0);;$21810:for(;($index$21827<$length$21822);($index$21827++)){var m$21835;(m$21835=temp$21817[$index$21827]);;var t0$21840;var t1$21841;var i$21845;var arg$21846;(t0$21840=m$21835);if(((t0$21840 instanceof Array)&&((t1$21841=t0$21840.length),(t1$21841===2)))){(i$21845=t0$21840[0]);(arg$21846=t0$21840[1]);(e$21809[i$21845]=arg$21846);}else{$21756(m$21835);;}}(e$21809["length"]=args$21800.length);(e$21809["name"]=["E"].concat(it$0$21804.tags).join("."));return e$21809;}else{$21756($21788$21790);}});($21770$21772.prototype["::check"]=function(e$21857){var it$0$21860;(it$0$21860=this);;var tags$21865;if(((!e$21857)||(!$20287(Error)(e$21857)))){return false;}(tags$21865=(e$21857["::tags"]||[]));;var temp$21874;(temp$21874=it$0$21860.tags);;var $length$21879;($length$21879=temp$21874.length);;var $index$21884;($index$21884=0);;$21866:for(;($index$21884<$length$21879);($index$21884++)){var m$21892;(m$21892=temp$21874[$index$21884]);;var tag$21900;(tag$21900=m$21892);if((tags$21865.indexOf(tag$21900)===-1)){return false;}else{false;;}}return true;});($21770$21772.prototype["::deconstruct"]=function(e$21908){var it$0$21911;(it$0$21911=this);;return e$21908.args;});$21945($21770$21772,$21945(function(){var accum$21916;(accum$21916=({}));(accum$21916["::name"]="$21770");return accum$21916;}(),function(){var accum$21920;(accum$21920=({}));(accum$21920["::egclass"]=true);return accum$21920;}()));return $21770$21772;}();
var $21756=function(value$21758,url$21759,start$21760,end$21761){var err$21764;(err$21764=$21769(["match"]).create("Could not find a match for value",({"value":value$21758})));;if(url$21759){(err$21764["location"]=["location",url$21759,start$21760,end$21761]);}throw err$21764;};
var $21957=function(type$21959){return function(value$21962){var f$21965;(f$21965=type$21959[":::project"]);;if((f$21965===(void 0))){var f$21970;(f$21970=type$21959["::project"]);;if((f$21970===(void 0))){return [true,type$21959(value$21962)];}else{var rval$21975;(rval$21975=false);;try{(rval$21975=[true,f$21970(value$21962)]);}catch(excv$21981){var e$21987;(e$21987=excv$21981);(rval$21975=[false,null]);}return rval$21975;}}else{return f$21965.call(type$21959,value$21962);}};};
var $21989=function($21990$21992,key$21993){var ph$21997;(ph$21997=$21990$21992);;var $21995$22002;($21995$22002=ph$21997);;var bridge$21996$22007;(bridge$21996$22007=$21995$22002);if(((bridge$21996$22007===null)||(bridge$21996$22007===(void 0)))){return false;}else{var x$22015;if((typeof($21995$22002)==="string")){(x$22015=$21995$22002);return (key$21993 in String.prototype);}else{var x$22020;if((typeof($21995$22002)==="number")){(x$22020=$21995$22002);return (key$21993 in Number.prototype);}else{var x$22025;(x$22025=$21995$22002);return (key$21993 in x$22025);}}}};var accum$21732;var accum$21736;var $20334$20336;var items$20337;var gensym$20338;var $20335$20339;var __lt____gt__$20340;var js_op_table2$20341;var js_op_table$20342;var Translator$20343;var translate$20344;($20334$20336=require("./util"));;(items$20337=$20334$20336.items);;(gensym$20338=$20334$20336.gensym);;($20335$20339=require("./pp"));;(__lt____gt__$20340=$20335$20339["<>"]);;(js_op_table2$20341=({"+":"+","-":"-","*":"*","/":"/","mod":"%","&.":"&","|.":"|","^.":"^","~":"~","and":"&&","or":"||","not":"!","==":"===","!=":"!==","===":"===","!==":"!==","<":"<",">":">","<=":"<=",">=":">=","<<":"<<",">>":">>",">>>":">>>","in":" in ","instanceof":" instanceof ","++":"++","--":"--"}));;(js_op_table$20342=({"___plus":"+","___minus":"-","___times":"*","___div":"/","___mod":"%","___binxor":"^","___binand":"&","___binor":"|","___binnot":"~","___and":"&&","___or":"||","___not":"!","___is":"===","___isnt":"!==","___eq":"===","___neq":"!==","___lt":"<","___gt":">","___lte":"<=","___gte":">=","___shl":"<<","___shr":">>","___shr2":">>>","___in":" in ","___instanceof":" instanceof ","___plusplus":"++","___minusminus":"--"}));;(Translator$20343=function(){var it$0$20384;var prelude$20380;var t0$20376;var $20369$20371;($20369$20371=arguments);;(t0$20376=$20369$20371.length);if(((t0$20376>=0)&&(t0$20376<=1))){(prelude$20380=function(){if((0>=t0$20376)){return null;}else{return $20369$20371[0];}}());(it$0$20384=function(){if((!$20287(Translator$20343)(this))){return Object.create(Translator$20343.prototype);}else{return this;}}());;(it$0$20384["cache"]=({}));(it$0$20384["prepend"]=[]);if(prelude$20380){it$0$20384.prepend.push(it$0$20384.translate($20303(prelude$20380),"stmt"));}return it$0$20384;}else{$21756($20369$20371);}});;(Translator$20343.prototype["register_value"]=function(v$20397,id$20398){var temp$20418;var name$20424;var $20401$20407;var it$0$20402;(it$0$20402=this);;($20401$20407=$20302(it$0$20402.cache,id$20398));;if(($20401$20407===(void 0))){(temp$20418=["symbol",gensym$20338()]);;(it$0$20402.cache[id$20398]=temp$20418);it$0$20402.prepend.push(it$0$20402.translate(["declare",temp$20418,$20303(v$20397)],"stmt"));return temp$20418;}else{(name$20424=$20401$20407);return name$20424;}});(Translator$20343.prototype["register_raw"]=function(raw$20429,id$20430){var temp$20450;var name$20456;var $20433$20439;var it$0$20434;(it$0$20434=this);;($20433$20439=$20302(it$0$20434.cache,id$20430));;if(($20433$20439===(void 0))){(temp$20450=["symbol",gensym$20338()]);;(it$0$20434.cache[id$20430]=temp$20450);it$0$20434.prepend.push(it$0$20434.translate(["declare",temp$20450,["raw",raw$20429]],"stmt"));return temp$20450;}else{(name$20456=$20433$20439);return name$20456;}});(Translator$20343.prototype["dump_store"]=function(){var rval$20468;var it$0$20463;(it$0$20463=this);;(rval$20468=it$0$20463.prepend.join("\n"));;(it$0$20463["prepend"]=[]);return rval$20468;});(Translator$20343.prototype["mangle"]=function(name$20475){var i$20493;var tr$20484;var r$20485;var it$0$20478;(it$0$20478=this);;(tr$20484=({"+":"__plus__","-":"__minus__","*":"__asterisk__","/":"__slash__","%":"__percent__","^":"__caret__","#":"__hash__","&":"__amp__","|":"__pipe__","@":"__at__","!":"__bang__","?":"__qmark__","=":"__equal__","<":"__lt__",">":"__gt__","~":"__tilde__",".":"__dot__",":":"__colon__"}));;(r$20485=[]);;(i$20493=0);;$20483:for(;(i$20493<name$20475.length);(++i$20493)){var c$20501;(c$20501=$20302(name$20475,i$20493));;r$20485.push(($20302(tr$20484,c$20501)||c$20501));}return r$20485.join("");});(Translator$20343.prototype["body"]=function(orig$20508,mode$20509){var t0$20521;var t1$20522;var t2$20523;var x$20547;var stmts$20556;var ret$20557;var other$20570;var $20517$20536;var b$20518;var trst$20519;var it$0$20512;(it$0$20512=this);;(t0$20521=$21957(["multi"])(orig$20508));if((t0$20521[0]&&((t1$20522=t0$20521[1]),((t2$20523=t1$20522.length),(t2$20523>=0))))){(b$20518=Array.prototype.slice.call(t1$20522,0));;}else{$21756(orig$20508,"/home/olivier/git/earl-grey/src/translate-js.eg",3265,3269);}(trst$20519=function(stmt$20532){return it$0$20512.translate(stmt$20532,"stmt");});;($20517$20536=mode$20509);;if(($20517$20536==="expr")){(x$20547=["send",["lambda",[],orig$20508],["array"]]);;return it$0$20512.translate(x$20547,mode$20509);}else{if(($20517$20536==="return")){(stmts$20556=b$20518.slice(0,-1));;(ret$20557=$20302(b$20518,(b$20518.length-1)));;return (stmts$20556.map(trst$20519).join("")+it$0$20512.translate(ret$20557,"return"));}else{if(($20517$20536==="stmt")){return b$20518.map(trst$20519).join("");}else{(other$20570=$20517$20536);throw $21769(["syntax","mode"]).create("Unknown mode",({"mode":mode$20509}));}}}});(Translator$20343.prototype["expr"]=function(x$20575,mode$20576){var other$20605;var $20579$20585;var it$0$20580;(it$0$20580=this);;($20579$20585=mode$20576);;if(($20579$20585==="expr")){return x$20575;}else{if(($20579$20585==="stmt")){return (x$20575+";");}else{if(($20579$20585==="return")){return (("return "+x$20575)+";");}else{(other$20605=$20579$20585);throw "OopsI";}}}});(Translator$20343.prototype["op"]=function(op$20610,a$20611,b$20612){var $20624$20637;var $20625$20638;var $20626$20639;var t0$20633;var t1$20634;var t2$20635;var $20623$20628;var e$20620;var it$0$20615;(it$0$20615=this);;(e$20620=((($20623$20628=[a$20611,b$20612])),function(){if((($20624$20637=($20623$20628 instanceof Array))&&((t0$20633=$20623$20628.length),(($20626$20639=(t0$20633===2))&&((t1$20634=$20623$20628[0]),((t1$20634 instanceof Array)&&((t2$20635=t1$20634.length),((t2$20635===1)&&(t1$20634[0]==="void"))))))))){$20623$20628[1];return (op$20610+it$0$20615.translate(b$20612,"expr"));}else{if(($20626$20639&&($20623$20628[0],((t1$20634=$20623$20628[1]),((t1$20634 instanceof Array)&&((t2$20635=t1$20634.length),((t2$20635===1)&&(t1$20634[0]==="void")))))))){return (it$0$20615.translate(a$20611,"expr")+op$20610);}else{$20623$20628;return ((it$0$20615.translate(a$20611,"expr")+op$20610)+it$0$20615.translate(b$20612,"expr"));}}}()));;return (("("+e$20620)+")");});(Translator$20343.prototype["translate"]=function(expr$20661,mode$20662){var repl$20732;var it$0$20763;var it$0$20758;var it$0$20753;var it$0$20748;var bridge$20718$20774;var bridge$20717$20771;var other$20785;var id$20779;var bridge$20716$20725;var $20715$20720;var r$20712;var t0$20804;var t0$20807;var trf$20813;var trmsg$20814;var trf$20845;var trmsg$20846;var trf$20858;var trmsg$20859;var otherwise$20855;var $20832$20834;var x$20902;var x$20896;var $20880$20891;var $20881$20892;var $20882$20893;var t0$20889;var $20879$20884;var $index$20935;var $length$20930;var temp$20925;var acc$20920;var trf$20910;var trargs$20911;var op$20876;var code$20967;var code$20975;var t0$20963;var t1$20964;var trf$20980;var trmsg$20981;var codevar$20961;var f$20998;var r$20994;var f$21016;var r$21012;var $index$21076;var $length$21071;var temp$21066;var acc$21061;var a$21050;var b$21051;var a$21125;var b$21126;var other$21122;var $21108$21110;var a$21157;var b$21158;var c$21159;var other$21154;var $21140$21142;var a$21196;var other$21193;var bridge$21178$21185;var $21177$21180;var a$21225;var b$21226;var other$21222;var bridge$21207$21214;var $21206$21209;var a$21243;var b$21244;var c$21245;var a$21262;var b$21263;var $index$21352;var $length$21347;var temp$21342;var acc$21337;var $index$21389;var $length$21384;var temp$21379;var acc$21374;var xs$21331;var $21281$21321;var $21280$21315;var isdecl$21282;var $index$21451;var $length$21446;var temp$21441;var acc$21436;var decls$21430;var f$21480;var r$21476;var other$21563;var $21549$21551;var a$21588;var b$21589;var other$21585;var $21571$21573;var a$21621;var b$21622;var c$21623;var d$21624;var other$21618;var $21604$21606;var a$21661;var b$21662;var c$21663;var other$21658;var $21644$21646;var t0$21686;var t0$21690;var a$21714;var b$21715;var other$21711;var $21697$21699;var other$21729;var x$21724;var attempt$21675;var v$21676;var body$21677;var x$21639;var y$21640;var body$21641;var x$21598;var y$21599;var z$21600;var body$21601;var test$21567;var body$21568;var label$21543;var body$21544;var value$21538;var value$21533;var value$21528;var label$21521;var label$21514;var value$21509;var args$21472;var vars$21425;var body$21426;var s$21420;var args$21415;var args$21276;var lhs$21257;var rhs$21258;var obj$21235;var msg$21236;var rhs$21237;var binding$21202;var value$21203;var binding$21171;var test$21135;var pos$21136;var neg$21137;var test$21100;var pos$21101;var bindings$21045;var body$21046;var args$21008;var args$20990;var f$20956;var msg$20957;var f$20868;var args$20869;var f$20823;var msg$20824;var s$20825;var f$20799;var msg$20800;var f$20790;var v$20708;var s$20698;var $20668$20692;var $20669$20693;var $20670$20694;var $20671$20695;var t0$20682;var t1$20683;var t2$20684;var t3$20685;var t4$20686;var bridge$20666$20687;var bridge$20667$20688;var t5$20689;var t6$20690;var $20665$20677;var it$0$20672;(it$0$20672=this);;($20665$20677=expr$20661);;if((($20668$20692=($20665$20677 instanceof Array))&&((t0$20682=$20665$20677.length),((t0$20682===2)&&($20665$20677[0]==="symbol"))))){(s$20698=$20665$20677[1]);return it$0$20672.expr(it$0$20672.mangle(s$20698),mode$20662);}else{if(($20668$20692&&((t0$20682===1)&&($20665$20677[0]==="void")))){return it$0$20672.expr("null",mode$20662);}else{if(($20668$20692&&((t0$20682===2)&&($20665$20677[0]==="value")))){(v$20708=$20665$20677[1]);(r$20712=((($20715$20720=v$20708)),function(){if((typeof($20715$20720)==="string")){(repl$20732=({"\"":"\\\"","\n":"\\n","\\":"\\\\"}));;(v$20708=v$20708.replace(RegExp("((?:(?:\"|\\\\)|\n))","g"),function(m$20737){return $20302(repl$20732,m$20737);}));return (("\""+v$20708)+"\"");}else{if(($20715$20720===(void 0))){return "(void 0)";}else{if($20287(RegExp)($20715$20720)){(it$0$20748=String(v$20708));;(it$0$20753=it$0$20748.slice(1,-1));;(it$0$20758=it$0$20753.replace(RegExp("/","g"),"\\/"));;(it$0$20763=it$0$20758.replace(RegExp("\n","g"),"\\n"));;return "/".concat(it$0$20763).concat("/");}else{(bridge$20716$20725=$20715$20720);if((((bridge$20717$20771=bridge$20716$20725),(((bridge$20718$20774=bridge$20717$20771),((typeof(bridge$20718$20774)==="number")||(bridge$20718$20774===true)))||(bridge$20717$20771===false)))||(bridge$20716$20725===null))){return String(v$20708);}else{if(($21989($20715$20720,"::id")&&((id$20779=$20715$20720["::id"]),id$20779))){return it$0$20672.translate(it$0$20672.register_value(v$20708,id$20779),mode$20662);}else{(other$20785=$20715$20720);throw $21769(["cannot_serialize"]).create("Cannot serialize value",({"value":v$20708}));}}}}}}()));;return it$0$20672.expr(r$20712,mode$20662);}else{if(($20668$20692&&(($20670$20694=(t0$20682===3))&&(($20671$20695=($20665$20677[0]==="send"))&&((t1$20683=$20665$20677[1]),((t1$20683 instanceof Array)&&((t2$20684=t1$20683.length),((t2$20684===2)&&((t1$20683[0]==="variable")&&((t1$20683[1]==="___node")&&((t3$20685=$20665$20677[2]),((t3$20685 instanceof Array)&&((t4$20686=t3$20685.length),((t4$20686===2)&&(t3$20685[0]==="value"))))))))))))))){(f$20790=t3$20685[1]);return f$20790;}else{if(($20671$20695&&((bridge$20666$20687=$20665$20677[1]),((((bridge$20666$20687 instanceof Array)&&((t0$20804=bridge$20666$20687.length),((t0$20804===2)&&((bridge$20666$20687[0]==="symbol")&&(bridge$20666$20687[1]==="___js_fetch")))))||((bridge$20666$20687 instanceof Array)&&((t0$20807=bridge$20666$20687.length),((t0$20807===2)&&((bridge$20666$20687[0]==="variable")&&(bridge$20666$20687[1]==="___js_fetch"))))))&&((t1$20683=$20665$20677[2]),((t1$20683 instanceof Array)&&((t2$20684=t1$20683.length),((t2$20684===3)&&(t1$20683[0]==="array"))))))))){(f$20799=t1$20683[1]);(msg$20800=t1$20683[2]);(trf$20813=it$0$20672.translate(f$20799,"expr"));;(trmsg$20814=it$0$20672.translate(msg$20800,"expr"));;return it$0$20672.expr((((trf$20813+"[")+trmsg$20814)+"]"),mode$20662);}else{if(($20671$20695&&((f$20823=$20665$20677[1]),((t1$20683=$20665$20677[2]),((msg$20824=t1$20683),((t1$20683 instanceof Array)&&((t2$20684=t1$20683.length),((t2$20684===2)&&(t1$20683[0]==="value"))))))))){(s$20825=t1$20683[1]);($20832$20834=null);;$20832$20834;if(((typeof(s$20825)==="string")&&s$20825.match(RegExp("(?:^(?:[a-zA-Z_$]+)$)","")))){(trf$20845=it$0$20672.translate(f$20823,"expr"));;(trmsg$20846=it$0$20672.translate(["symbol",s$20825],"expr"));;return it$0$20672.expr(((trf$20845+".")+trmsg$20846),mode$20662);}else{(otherwise$20855=$20832$20834);(trf$20858=it$0$20672.translate(f$20823,"expr"));;(trmsg$20859=it$0$20672.translate(msg$20824,"expr"));;return it$0$20672.expr((((trf$20858+"[")+trmsg$20859)+"]"),mode$20662);}}else{if(($20671$20695&&((f$20868=$20665$20677[1]),((t1$20683=$20665$20677[2]),((t1$20683 instanceof Array)&&((t2$20684=t1$20683.length),((t2$20684>=1)&&(t1$20683[0]==="array")))))))){(args$20869=Array.prototype.slice.call(t1$20683,1));(op$20876=((($20879$20884=f$20868)),function(){if((($20880$20891=($20879$20884 instanceof Array))&&((t0$20889=$20879$20884.length),(($20882$20893=(t0$20889===2))&&($20879$20884[0]==="symbol"))))){(x$20896=$20879$20884[1]);return $20302(js_op_table$20342,x$20896);}else{if(($20882$20893&&($20879$20884[0]==="variable"))){(x$20902=$20879$20884[1]);return $20302(js_op_table2$20341,x$20902);}else{$20879$20884;return null;}}}()));;if(op$20876){return it$0$20672.expr(it$0$20672.op(op$20876,args$20869[0],args$20869[1]),mode$20662);}else{(trf$20910=it$0$20672.translate(f$20868,"expr"));;(trargs$20911=(((acc$20920=[])),(((temp$20925=args$20869)),((($length$20930=temp$20925.length)),((($index$20935=0)),function(){$20917:for(;($index$20935<$length$20930);($index$20935++)){var x$20951;var m$20943;(m$20943=temp$20925[$index$20935]);;(x$20951=m$20943);acc$20920.push(it$0$20672.translate(x$20951,"expr"));}}()))),acc$20920));;return it$0$20672.expr((((trf$20910+"(")+trargs$20911.join(","))+")"),mode$20662);}}else{if($20671$20695){(f$20956=$20665$20677[1]);(msg$20957=$20665$20677[2]);(t0$20963=(((code$20967="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$20672.register_raw(code$20967,"~send")));if(((t0$20963 instanceof Array)&&((t1$20964=t0$20963.length),((t1$20964===2)&&(t0$20963[0]==="symbol"))))){(codevar$20961=t0$20963[1]);;}else{$21756((((code$20975="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$20672.register_raw(code$20975,"~send")),"/home/olivier/git/earl-grey/src/translate-js.eg",6898,7075);}(trf$20980=it$0$20672.translate(f$20956,"expr"));;(trmsg$20981=it$0$20672.translate(msg$20957,"expr"));;return it$0$20672.expr((((((codevar$20961+"(")+trf$20980)+",")+trmsg$20981)+")"),mode$20662);}else{if(($20668$20692&&(($20670$20694=(t0$20682>=1))&&($20665$20677[0]==="array")))){(args$20990=Array.prototype.slice.call($20665$20677,1));(r$20994=(((f$20998=function(x$21002){return it$0$20672.translate(x$21002,"expr");})),(("["+args$20990.map(f$20998).join(","))+"]")));;return it$0$20672.expr(r$20994,mode$20662);}else{if(($20670$20694&&($20665$20677[0]==="object"))){(args$21008=Array.prototype.slice.call($20665$20677,1));(r$21012=(((f$21016=function($21019$21021){var t0$21026;var t1$21027;var a$21033;var b$21034;var x$21023;var y$21024;(t0$21026=$21019$21021);if(((t0$21026 instanceof Array)&&((t1$21027=t0$21026.length),((t1$21027===3)&&(t0$21026[0]==="array"))))){(x$21023=t0$21026[1]);(y$21024=t0$21026[2]);;}else{$21756($21019$21021);}(a$21033=it$0$20672.translate(x$21023,"expr"));;(b$21034=it$0$20672.translate(y$21024,"expr"));;return ((a$21033+":")+b$21034);})),(("({"+args$21008.map(f$21016).join(","))+"})")));;return it$0$20672.expr(r$21012,mode$20662);}else{if(($20668$20692&&((t0$20682===3)&&($20665$20677[0]==="lambda")))){(bindings$21045=$20665$20677[1]);(body$21046=$20665$20677[2]);(a$21050=(((acc$21061=[])),(((temp$21066=bindings$21045)),((($length$21071=temp$21066.length)),((($index$21076=0)),function(){$21058:for(;($index$21076<$length$21071);($index$21076++)){var x$21092;var m$21084;(m$21084=temp$21066[$index$21076]);;(x$21092=m$21084);acc$21061.push(it$0$20672.translate(x$21092,"expr"));}}()))),acc$21061).join(","));;(b$21051=it$0$20672.body(body$21046,"return"));;return it$0$20672.expr((((("function("+a$21050)+"){")+b$21051)+"}"),mode$20662);}else{if(($20668$20692&&(($20670$20694=(t0$20682===4))&&(($20671$20695=($20665$20677[0]==="if"))&&((test$21100=$20665$20677[1]),((pos$21101=$20665$20677[2]),((t1$20683=$20665$20677[3]),((t1$20683 instanceof Array)&&((t2$20684=t1$20683.length),((t2$20684===2)&&((t1$20683[0]==="value")&&(t1$20683[1]===(void 0))))))))))))){($21108$21110=mode$20662);;if(($21108$21110==="expr")){return it$0$20672.body(expr$20661,"expr");}else{(other$21122=$21108$21110);(a$21125=it$0$20672.translate(test$21100,"expr"));;(b$21126=it$0$20672.translate(pos$21101,mode$20662));;return (((("if("+a$21125)+"){")+b$21126)+"}");}}else{if($20671$20695){(test$21135=$20665$20677[1]);(pos$21136=$20665$20677[2]);(neg$21137=$20665$20677[3]);($21140$21142=mode$20662);;if(($21140$21142==="expr")){return it$0$20672.body(expr$20661,"expr");}else{(other$21154=$21140$21142);(a$21157=it$0$20672.translate(test$21135,"expr"));;(b$21158=it$0$20672.translate(pos$21136,mode$20662));;(c$21159=it$0$20672.translate(neg$21137,mode$20662));;return (((((("if("+a$21157)+"){")+b$21158)+"}else{")+c$21159)+"}");}}else{if(($20668$20692&&(($20670$20694=(t0$20682===3))&&(($20671$20695=($20665$20677[0]==="declare"))&&((binding$21171=$20665$20677[1]),((t1$20683=$20665$20677[2]),((t1$20683 instanceof Array)&&((t2$20684=t1$20683.length),((t2$20684===2)&&((t1$20683[0]==="value")&&(t1$20683[1]===(void 0)))))))))))){($21177$21180=mode$20662);;(bridge$21178$21185=$21177$21180);if(((bridge$21178$21185==="expr")||(bridge$21178$21185==="return"))){throw "Invalid in expr ctx";}else{(other$21193=$21177$21180);(a$21196=it$0$20672.translate(binding$21171,"expr"));;return (("var "+a$21196)+";");}}else{if($20671$20695){(binding$21202=$20665$20677[1]);(value$21203=$20665$20677[2]);($21206$21209=mode$20662);;(bridge$21207$21214=$21206$21209);if(((bridge$21207$21214==="expr")||(bridge$21207$21214==="return"))){throw "Invalid in expr ctx";}else{(other$21222=$21206$21209);(a$21225=it$0$20672.translate(binding$21202,"expr"));;(b$21226=it$0$20672.translate(value$21203,"expr"));;return (((("var "+a$21225)+"=")+b$21226)+";");}}else{if(($20670$20694&&(($20671$20695=($20665$20677[0]==="assign"))&&((t1$20683=$20665$20677[1]),((t1$20683 instanceof Array)&&((t2$20684=t1$20683.length),((t2$20684===3)&&(t1$20683[0]==="send")))))))){(obj$21235=t1$20683[1]);(msg$21236=t1$20683[2]);(rhs$21237=$20665$20677[2]);(a$21243=it$0$20672.translate(obj$21235,"expr"));;(b$21244=it$0$20672.translate(msg$21236,"expr"));;(c$21245=it$0$20672.translate(rhs$21237,"expr"));;return it$0$20672.expr((((((("("+a$21243)+"[")+b$21244)+"]=")+c$21245)+")"),mode$20662);}else{if($20671$20695){(lhs$21257=$20665$20677[1]);(rhs$21258=$20665$20677[2]);(a$21262=it$0$20672.translate(lhs$21257,"expr"));;(b$21263=it$0$20672.translate(rhs$21258,"expr"));;return it$0$20672.expr((((("("+a$21262)+"=")+b$21263)+")"),mode$20662);}else{if(($20668$20692&&((t0$20682===1)&&($20665$20677[0]==="multi")))){if((mode$20662==="stmt")){return ";";}else{return "";}}else{if(($20668$20692&&(($20670$20694=(t0$20682>=1))&&($20665$20677[0]==="multi")))){(args$21276=Array.prototype.slice.call($20665$20677,1));(isdecl$21282=function($21285$21287){var other$21311;var variable$21304;var value$21305;var t0$21300;var $21289$21295;var ph$21290;(ph$21290=$21285$21287);;($21289$21295=ph$21290);;if((($21289$21295 instanceof Array)&&((t0$21300=$21289$21295.length),((t0$21300===3)&&($21289$21295[0]==="declare"))))){(variable$21304=$21289$21295[1]);(value$21305=$21289$21295[2]);return true;}else{(other$21311=$21289$21295);return false;}});;($21280$21315=null);;$21280$21315;if((args$21276.length===1)){return it$0$20672.translate(args$21276[0],mode$20662);}else{if(((mode$20662==="expr")&&(!args$21276.some(isdecl$21282)))){(xs$21331=(((acc$21337=[])),(((temp$21342=args$21276)),((($length$21347=temp$21342.length)),((($index$21352=0)),function(){$21334:for(;($index$21352<$length$21347);($index$21352++)){var x$21368;var m$21360;(m$21360=temp$21342[$index$21352]);;(x$21368=m$21360);acc$21337.push(it$0$20672.translate(x$21368,"expr"));}}()))),acc$21337));;(xs$21331=(((acc$21374=[])),(((temp$21379=xs$21331)),((($length$21384=temp$21379.length)),((($index$21389=0)),function(){$21371:for(;($index$21389<$length$21384);($index$21389++)){var x$21405;var m$21397;(m$21397=temp$21379[$index$21389]);;(x$21405=m$21397);if((x$21405!=="")){acc$21374.push(x$21405);}else{false;;}}}()))),acc$21374));return (("("+xs$21331.join(","))+")");}else{return it$0$20672.body(expr$20661,mode$20662);}}}else{if(($20670$20694&&($20665$20677[0]==="splice"))){(args$21415=Array.prototype.slice.call($20665$20677,1));return it$0$20672.translate(["multi"].concat(args$21415),mode$20662);}else{if(($20668$20692&&((t0$20682===2)&&($20665$20677[0]==="variable")))){(s$21420=$20665$20677[1]);return it$0$20672.expr(it$0$20672.mangle(s$21420),mode$20662);}else{if(($20668$20692&&((t0$20682===3)&&($20665$20677[0]==="scope")))){(vars$21425=$20665$20677[1]);(body$21426=$20665$20677[2]);(decls$21430=(((acc$21436=[])),(((temp$21441=vars$21425)),((($length$21446=temp$21441.length)),((($index$21451=0)),function(){$21433:for(;($index$21451<$length$21446);($index$21451++)){var v$21467;var m$21459;(m$21459=temp$21441[$index$21451]);;(v$21467=m$21459);acc$21436.push(["declare",v$21467,["value",(void 0)]]);}}()))),acc$21436));;return it$0$20672.translate(["multi"].concat(decls$21430).concat([body$21426]),mode$20662);}else{if(($20668$20692&&((t0$20682>=1)&&($20665$20677[0]==="object2")))){(args$21472=Array.prototype.slice.call($20665$20677,1));(r$21476=(((f$21480=function($21483$21485){var t0$21490;var t1$21491;var a$21497;var b$21498;var x$21487;var y$21488;(t0$21490=$21483$21485);if(((t0$21490 instanceof Array)&&((t1$21491=t0$21490.length),(t1$21491===2)))){(x$21487=t0$21490[0]);(y$21488=t0$21490[1]);;}else{$21756($21483$21485);}(a$21497=it$0$20672.translate(x$21487,"expr"));;(b$21498=it$0$20672.translate(y$21488,"expr"));;return ((a$21497+":")+b$21498);})),(("({"+args$21472.map(f$21480).join(","))+"})")));;return it$0$20672.expr(r$21476,mode$20662);}else{if(($20668$20692&&((t0$20682===2)&&($20665$20677[0]==="js_new")))){(value$21509=$20665$20677[1]);return it$0$20672.expr((("(new "+it$0$20672.translate(value$21509,"expr"))+")"),mode$20662);}else{if(($20668$20692&&(($20670$20694=((t0$20682>=1)&&(t0$20682<=2)))&&(($20665$20677[0]==="js_break")&&((t1$20683=function(){if((1>=t0$20682)){return ["value",null];}else{return $20665$20677[1];}}()),((t1$20683 instanceof Array)&&((t2$20684=t1$20683.length),((t2$20684===2)&&(t1$20683[0]==="value"))))))))){(label$21514=t1$20683[1]);if((mode$20662==="expr")){throw "Invalid break in ctx";}else{return (("break"+function(){if(label$21514){return (" "+label$21514);}else{return "";}}())+";");}}else{if(($20670$20694&&(($20665$20677[0]==="js_continue")&&((t1$20683=function(){if((1>=t0$20682)){return ["value",null];}else{return $20665$20677[1];}}()),((t1$20683 instanceof Array)&&((t2$20684=t1$20683.length),((t2$20684===2)&&(t1$20683[0]==="value")))))))){(label$21521=t1$20683[1]);if((mode$20662==="expr")){throw "Invalid continue in ctx";}else{return (("continue"+function(){if(label$21521){return (" "+label$21521);}else{return "";}}())+";");}}else{if(($20668$20692&&(($20670$20694=(t0$20682===2))&&($20665$20677[0]==="js_return")))){(value$21528=$20665$20677[1]);if((mode$20662==="expr")){throw "Invalid return in ctx";}else{return (("return "+it$0$20672.translate(value$21528,"expr"))+";");}}else{if(($20670$20694&&($20665$20677[0]==="js_delete"))){(value$21533=$20665$20677[1]);if((mode$20662==="expr")){throw "Invalid delete in ctx";}else{return (("delete "+it$0$20672.translate(value$21533,"expr"))+";");}}else{if(($20670$20694&&($20665$20677[0]==="js_throw"))){(value$21538=$20665$20677[1]);if((mode$20662==="expr")){return (("function(){throw "+it$0$20672.translate(value$21538,"expr"))+";}()");}else{return (("throw "+it$0$20672.translate(value$21538,"expr"))+";");}}else{if(($20668$20692&&(($20670$20694=(t0$20682===3))&&(($20665$20677[0]==="js_label")&&((t1$20683=$20665$20677[1]),((t1$20683 instanceof Array)&&((t2$20684=t1$20683.length),((t2$20684===2)&&(t1$20683[0]==="value"))))))))){(label$21543=t1$20683[1]);(body$21544=$20665$20677[2]);($21549$21551=mode$20662);;if(($21549$21551==="expr")){return it$0$20672.body(expr$20661,"expr");}else{(other$21563=$21549$21551);return ((label$21543+":")+it$0$20672.translate(body$21544,other$21563));}}else{if(($20670$20694&&($20665$20677[0]==="js_while"))){(test$21567=$20665$20677[1]);(body$21568=$20665$20677[2]);($21571$21573=mode$20662);;if(($21571$21573==="expr")){return it$0$20672.body(expr$20661,"expr");}else{(other$21585=$21571$21573);(a$21588=it$0$20672.translate(test$21567,"expr"));;(b$21589=it$0$20672.translate(body$21568,"stmt"));;return (((("while("+a$21588)+"){")+b$21589)+"}");}}else{if(($20668$20692&&((t0$20682===5)&&($20665$20677[0]==="js_for")))){(x$21598=$20665$20677[1]);(y$21599=$20665$20677[2]);(z$21600=$20665$20677[3]);(body$21601=$20665$20677[4]);($21604$21606=mode$20662);;if(($21604$21606==="expr")){return it$0$20672.body(expr$20661,"expr");}else{(other$21618=$21604$21606);(a$21621=it$0$20672.translate(x$21598,"stmt"));;(b$21622=it$0$20672.translate(y$21599,"stmt"));;(c$21623=it$0$20672.translate(z$21600,"expr"));;(d$21624=it$0$20672.translate(body$21601,"stmt"));;return (((((("for("+a$21621)+b$21622)+c$21623)+"){")+d$21624)+"}");}}else{if(($20668$20692&&(($20670$20694=(t0$20682===4))&&($20665$20677[0]==="js_for_in")))){(x$21639=$20665$20677[1]);(y$21640=$20665$20677[2]);(body$21641=$20665$20677[3]);($21644$21646=mode$20662);;if(($21644$21646==="expr")){return it$0$20672.body(expr$20661,"expr");}else{(other$21658=$21644$21646);(a$21661=it$0$20672.translate(x$21639,"expr"));;(b$21662=it$0$20672.translate(y$21640,"expr"));;(c$21663=it$0$20672.translate(body$21641,"stmt"));;return (((((("for("+a$21661)+" in ")+b$21662)+"){")+c$21663)+"}");}}else{if(($20670$20694&&(($20665$20677[0]==="js_try")&&((attempt$21675=$20665$20677[1]),((t1$20683=$20665$20677[2]),((t1$20683 instanceof Array)&&((t2$20684=t1$20683.length),((t2$20684===3)&&((t1$20683[0]==="lambda")&&((t3$20685=t1$20683[1]),((t3$20685 instanceof Array)&&((t4$20686=t3$20685.length),((t4$20686===1)&&((bridge$20667$20688=t3$20685[0]),((((bridge$20667$20688 instanceof Array)&&((t0$21686=bridge$20667$20688.length),((t0$21686===2)&&((bridge$20667$20688[0]==="symbol")&&((v$21676=bridge$20667$20688[1]),true)))))||((bridge$20667$20688 instanceof Array)&&((t0$21690=bridge$20667$20688.length),((t0$21690===2)&&((bridge$20667$20688[0]==="variable")&&((v$21676=bridge$20667$20688[1]),true))))))&&((body$21677=t1$20683[2]),((t5$20689=$20665$20677[3]),((t5$20689 instanceof Array)&&((t6$20690=t5$20689.length),((t6$20690===1)&&(t5$20689[0]==="void"))))))))))))))))))))){($21697$21699=mode$20662);;if(($21697$21699==="expr")){return it$0$20672.body(expr$20661,"expr");}else{(other$21711=$21697$21699);(a$21714=it$0$20672.translate(attempt$21675,"stmt"));;(b$21715=it$0$20672.translate(body$21677,"stmt"));;return (((((("try{"+a$21714)+"}catch(")+v$21676)+"){")+b$21715)+"}");}}else{if(($20668$20692&&((t0$20682===2)&&($20665$20677[0]==="raw")))){(x$21724=$20665$20677[1]);return x$21724;}else{(other$21729=$20665$20677);throw other$21729;}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}});$21945(Translator$20343,$21945(((accum$21732=({})),((accum$21732["::name"]="Translator"),accum$21732)),((accum$21736=({})),((accum$21736["::egclass"]=true),accum$21736))));Translator$20343;(translate$20344=function(expr$21742,mode$21743){var tr$21746;var t$21747;(tr$21746=Translator$20343());;(t$21747=tr$21746.translate(expr$21742,mode$21743));;return (tr$21746.dump_store()+t$21747);});;(exports["Translator"]=Translator$20343);(exports["translate"]=translate$20344);

},{"./pp":11,"./util":14}],14:[function(require,module,exports){
var $22144=function(type$22146){var f$22149;(f$22149=type$22146["::check"]);;if((f$22149===(void 0))){return function(value$22154){return (value$22154 instanceof type$22146);};}else{return function(value$22157){return f$22149.call(type$22146,value$22157);};}};
var $22159=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $22160=function($22161$22163){var ph$22167;(ph$22167=$22161$22163);;var $22165$22172;($22165$22172=ph$22167);;var bridge$22166$22177;var x$22181;(bridge$22166$22177=$22165$22172);if((((typeof(bridge$22166$22177)==="string")&&((x$22181=bridge$22166$22177),true))||((typeof(bridge$22166$22177)==="number")&&((x$22181=bridge$22166$22177),true)))){return ["value",x$22181];}else{var other$22188;(other$22188=$22165$22172);return other$22188["::serialize_ast"]();}};
var send$22028;(send$22028=function(obj$22033,$22031$22034){var ph$22038;var msg$22039;var t0$22041;(t0$22041=$22031$22034);(msg$22039=t0$22041);(ph$22038=t0$22041);;var $22036$22045;($22036$22045=ph$22038);;var bridge$22037$22050;(bridge$22037$22050=$22036$22045);if(((typeof(bridge$22037$22050)==="string")||(typeof(bridge$22037$22050)==="number"))){return obj$22033[msg$22039];}else{var other$22058;(other$22058=$22036$22045);return obj$22033["::send"](msg$22039);}});;(Array[":::project"]=function($22061$22063){var ph$22066;var value$22067;var t0$22069;(t0$22069=$22061$22063);(value$22067=t0$22069);(ph$22066=t0$22069);;var $22065$22073;($22065$22073=ph$22066);;if($22144(Array)($22065$22073)){return [true,value$22067];}else{$22065$22073;return [true,[value$22067]];}});(Array.prototype["::check"]=function(value$22087){if((value$22087 instanceof Array)){var i$22092;(i$22092=0);;$22090:for(;(i$22092<this.length);(i$22092++)){if(($22159(this,i$22092)!==$22159(value$22087,i$22092))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$22103){if((value$22103 instanceof Array)){var i$22108;(i$22108=0);;$22106:for(;(i$22108<this.length);(i$22108++)){if(($22159(this,i$22108)!==$22159(value$22103,i$22108))){return [true,[value$22103]];}}return [true,value$22103.slice(this.length)];}else{return [true,[value$22103]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($22160));});(RegExp.prototype["::check"]=function(value$22119){return value$22119.match(this);});(RegExp.prototype[":::project"]=function(value$22122){var $22124$22126;($22124$22126=value$22122.match(this));;var m$22134;if(($22124$22126===null)){(m$22134=$22124$22126);return [false,null];}else{var m$22139;(m$22139=$22124$22126);return [true,m$22139];}});(Function.prototype["::send"]=function(args$22142){return this.apply(this,args$22142);});
var $23014=function(arr$23016){var results$23020;var l$23021;(results$23020=[]);;(l$23021=arr$23016.length);;var i$23029;(i$23029=0);;$23019:for(;(i$23029<l$23021);(i$23029++)){results$23020.push([i$23029,$22159(arr$23016,i$23029)]);}return results$23020;};
var $23036=function(dest$23038,values$23039){var k$23044;(k$23044=null);$23042:for(k$23044 in values$23039){if(values$23039.hasOwnProperty(k$23044)){(dest$23038[k$23044]=values$23039[k$23044]);}}return dest$23038;};
var $22860=function(){var $22861$22863;($22861$22863=function(tags$22867){var it$0$22870;(it$0$22870=function(){if((!$22144($22861$22863)(this))){return Object.create($22861$22863.prototype);}else{return this;}}());;(it$0$22870["tags"]=tags$22867);return it$0$22870;});;($22861$22863.prototype["create"]=function(){var $22879$22881;($22879$22881=arguments);;var t0$22886;var message$22890;var args$22891;(t0$22886=$22879$22881.length);if((t0$22886>=0)){(message$22890=function(){if((0>=t0$22886)){return "";}else{return $22879$22881[0];}}());(args$22891=Array.prototype.slice.call($22879$22881,1));var it$0$22895;(it$0$22895=this);;var e$22900;(e$22900=Error(message$22890));;(e$22900["::tags"]=it$0$22895.tags);(e$22900["args"]=args$22891);var temp$22908;(temp$22908=$23014(args$22891));;var $length$22913;($length$22913=temp$22908.length);;var $index$22918;($index$22918=0);;$22901:for(;($index$22918<$length$22913);($index$22918++)){var m$22926;(m$22926=temp$22908[$index$22918]);;var t0$22931;var t1$22932;var i$22936;var arg$22937;(t0$22931=m$22926);if(((t0$22931 instanceof Array)&&((t1$22932=t0$22931.length),(t1$22932===2)))){(i$22936=t0$22931[0]);(arg$22937=t0$22931[1]);(e$22900[i$22936]=arg$22937);}else{$22847(m$22926);;}}(e$22900["length"]=args$22891.length);(e$22900["name"]=["E"].concat(it$0$22895.tags).join("."));return e$22900;}else{$22847($22879$22881);}});($22861$22863.prototype["::check"]=function(e$22948){var it$0$22951;(it$0$22951=this);;var tags$22956;if(((!e$22948)||(!$22144(Error)(e$22948)))){return false;}(tags$22956=(e$22948["::tags"]||[]));;var temp$22965;(temp$22965=it$0$22951.tags);;var $length$22970;($length$22970=temp$22965.length);;var $index$22975;($index$22975=0);;$22957:for(;($index$22975<$length$22970);($index$22975++)){var m$22983;(m$22983=temp$22965[$index$22975]);;var tag$22991;(tag$22991=m$22983);if((tags$22956.indexOf(tag$22991)===-1)){return false;}else{false;;}}return true;});($22861$22863.prototype["::deconstruct"]=function(e$22999){var it$0$23002;(it$0$23002=this);;return e$22999.args;});$23036($22861$22863,$23036(function(){var accum$23007;(accum$23007=({}));(accum$23007["::name"]="$22861");return accum$23007;}(),function(){var accum$23011;(accum$23011=({}));(accum$23011["::egclass"]=true);return accum$23011;}()));return $22861$22863;}();
var $22847=function(value$22849,url$22850,start$22851,end$22852){var err$22855;(err$22855=$22860(["match"]).create("Could not find a match for value",({"value":value$22849})));;if(url$22850){(err$22855["location"]=["location",url$22850,start$22851,end$22852]);}throw err$22855;};var GenSym$22191;var gensym$22192;var uuid$22193;var identity$22194;var items$22195;var keys$22196;var enumerate$22197;var binsearch$22198;var __classify$22199;var classify$22200;var classify_contiguous$22201;var neighbours$22202;var zip$22203;var partition$22204;var construct$22205;var set$22206;var make_object$22207;(GenSym$22191=function(prefix$22211){var id$22214;(id$22214=0);;return function(){var r$22234;var pfx$22230;var t0$22226;var $22219$22221;($22219$22221=arguments);;(t0$22226=$22219$22221.length);if(((t0$22226>=0)&&(t0$22226<=1))){(pfx$22230=function(){if((0>=t0$22226)){return null;}else{return $22219$22221[0];}}());(r$22234=(((pfx$22230||"")+prefix$22211)+[true,String(id$22214)][1]));;(id$22214++);return r$22234;}else{$22847($22219$22221);}};});;(gensym$22192=GenSym$22191("$"));;(uuid$22193=function(){return gensym$22192("#");});;(identity$22194=function(x$22252){return x$22252;});;(items$22195=function(obj$22258){var k$22267;var results$22262;(results$22262=[]);;(k$22267=null);$22261:for(k$22267 in obj$22258){if(Object.prototype.hasOwnProperty.call(obj$22258,k$22267)){results$22262.push([k$22267,$22159(obj$22258,k$22267)]);}}return results$22262;});;(keys$22196=function(obj$22275){var k$22284;var results$22279;(results$22279=[]);;(k$22284=null);$22278:for(k$22284 in obj$22275){if(Object.prototype.hasOwnProperty.call(obj$22275,k$22284)){results$22279.push(k$22284);}}return results$22279;});;(enumerate$22197=function(arr$22292){var i$22305;var results$22296;var l$22297;(results$22296=[]);;(l$22297=arr$22292.length);;(i$22305=0);;$22295:for(;(i$22305<l$22297);(i$22305++)){results$22296.push([i$22305,$22159(arr$22292,i$22305)]);}return results$22296;});;(binsearch$22198=function(xs$22316,x$22317){var lo$22320;var hi$22321;(lo$22320=0);;(hi$22321=(xs$22316.length-1));;$22328:while((lo$22320<=hi$22321)){var $22332$22342;var mid$22333;var v$22334;(mid$22333=(lo$22320+((hi$22321-lo$22320)>>1)));;(v$22334=$22159(xs$22316,mid$22333));;($22332$22342=$22159(xs$22316,mid$22333));;if(($22332$22342<x$22317)){(lo$22320=(mid$22333+1));}else{if(($22332$22342>x$22317)){(hi$22321=(mid$22333-1));}else{$22332$22342;return (mid$22333+1);}}}return lo$22320;});;(__classify$22199=function(xs$22363){var results$22366;(results$22366=({}));;$22370:while(xs$22363.length){var cls$22396;var x$22397;var newxs$22390;var $22374$22385;var $22375$22386;var $22376$22387;var t0$22383;var $22373$22378;($22373$22378=xs$22363.shift());;if((($22374$22385=($22373$22378 instanceof Array))&&((t0$22383=$22373$22378.length),(($22376$22387=(t0$22383===2))&&($22373$22378[0]==="splice"))))){(newxs$22390=$22373$22378[1]);(xs$22363=newxs$22390.concat(xs$22363));}else{if($22376$22387){(cls$22396=$22373$22378[0]);(x$22397=$22373$22378[1]);if((!$22159(results$22366,cls$22396))){(results$22366[cls$22396]=[]);}$22159(results$22366,cls$22396).push(x$22397);}else{$22847($22373$22378);;}}}return results$22366;});;(classify$22200=function(){var $index$22442;var $length$22437;var temp$22432;var results$22424;var classes$22419;var xs$22420;var t0$22415;var $22408$22410;($22408$22410=arguments);;(t0$22415=$22408$22410.length);if((t0$22415>=1)){(classes$22419=Array.prototype.slice.call($22408$22410,0,-1));(xs$22420=$22408$22410[(t0$22415-1)]);(results$22424=({"rest":[]}));;(temp$22432=classes$22419);;($length$22437=temp$22432.length);;($index$22442=0);;$22425:for(;($index$22442<$length$22437);($index$22442++)){var cls$22458;var m$22450;(m$22450=temp$22432[$index$22442]);;(cls$22458=m$22450);(results$22424[cls$22458]=[]);}$22460:while(xs$22420.length){var x$22482;var other$22498;var cls$22489;var x$22490;var newxs$22474;var t0$22470;var $22463$22465;($22463$22465=xs$22420.shift());;if((($22463$22465 instanceof Array)&&((t0$22470=$22463$22465.length),((t0$22470>=1)&&($22463$22465[0]==="splice"))))){(newxs$22474=Array.prototype.slice.call($22463$22465,1));(xs$22420=newxs$22474.concat(xs$22420));}else{if((((x$22482=$22463$22465)),((x$22482 instanceof Array)&&(x$22482[0]==="ignore")))){null;}else{if((($22463$22465 instanceof Array)&&((t0$22470=$22463$22465.length),((t0$22470===2)&&((cls$22489=$22463$22465[0]),((x$22490=$22463$22465[1]),$22159(results$22424,cls$22489))))))){$22159(results$22424,cls$22489).push(x$22490);}else{(other$22498=$22463$22465);results$22424.rest.push(other$22498);}}}}return results$22424;}else{$22847($22408$22410);}});;(classify_contiguous$22201=function(xs$22506,classifier$22507){var $index$22536;var $length$22531;var temp$22526;var groups$22510;var currcls$22511;var curr$22512;(groups$22510=[]);;(currcls$22511=null);;(curr$22512=null);;(temp$22526=xs$22506);;($length$22531=temp$22526.length);;($index$22536=0);;$22513:for(;($index$22536<$length$22531);($index$22536++)){var cls$22555;var x$22552;var m$22544;(m$22544=temp$22526[$index$22536]);;(x$22552=m$22544);(cls$22555=classifier$22507(x$22552));;if((cls$22555===currcls$22511)){curr$22512.push(x$22552);}else{if(curr$22512){groups$22510.push(curr$22512);}(curr$22512=[cls$22555,x$22552]);(currcls$22511=cls$22555);}}if(curr$22512){groups$22510.push(curr$22512);}return groups$22510;});;(neighbours$22202=function($22565$22567){var x$22598;var y$22599;var rest$22600;var x$22593;var $22570$22584;var $22571$22585;var t0$22582;var $22569$22577;var ph$22572;(ph$22572=$22565$22567);;($22569$22577=ph$22572);;if((($22570$22584=($22569$22577 instanceof Array))&&((t0$22582=$22569$22577.length),(t0$22582===0)))){return [];}else{if(($22570$22584&&(t0$22582===1))){(x$22593=$22569$22577[0]);return [];}else{if(($22570$22584&&(t0$22582>=2))){(x$22598=$22569$22577[0]);(y$22599=$22569$22577[1]);(rest$22600=Array.prototype.slice.call($22569$22577,2));return [[x$22598,y$22599]].concat(neighbours$22202([y$22599].concat(rest$22600)));}else{$22847($22569$22577);}}}});;(zip$22203=function(xs$22609,ys$22610){var $index$22630;var $length$22625;var temp$22620;var acc$22615;(acc$22615=[]);;(temp$22620=enumerate$22197(xs$22609));;($length$22625=temp$22620.length);;($index$22630=0);;$22612:for(;($index$22630<$length$22625);($index$22630++)){var i$22648;var x$22649;var t0$22643;var t1$22644;var m$22638;(m$22638=temp$22620[$index$22630]);;(t0$22643=m$22638);if(((t0$22643 instanceof Array)&&((t1$22644=t0$22643.length),(t1$22644===2)))){(i$22648=t0$22643[0]);(x$22649=t0$22643[1]);acc$22615.push([x$22649,$22159(ys$22610,i$22648)]);}else{$22847(m$22638,"/home/olivier/git/earl-grey/src/util.eg",2248,2300);;}}return acc$22615;});;(partition$22204=function(xs$22659,predicate$22660){var $index$22685;var $length$22680;var temp$22675;var t$22663;var f$22664;(t$22663=[]);;(f$22664=[]);;(temp$22675=xs$22659);;($length$22680=temp$22675.length);;($index$22685=0);;$22665:for(;($index$22685<$length$22680);($index$22685++)){var x$22706;var x$22701;var m$22693;(m$22693=temp$22675[$index$22685]);;(x$22701=m$22693);if(predicate$22660(x$22701)){t$22663.push(x$22701);}else{(x$22706=m$22693);f$22664.push(x$22706);}}return [t$22663,f$22664];});;(construct$22205=function($22711$22713,fn$22714,zero$22715){var x$22746;var rest$22747;var x$22741;var $22718$22732;var $22719$22733;var t0$22730;var $22717$22725;var ph$22720;(ph$22720=$22711$22713);;($22717$22725=ph$22720);;if((($22718$22732=($22717$22725 instanceof Array))&&((t0$22730=$22717$22725.length),(t0$22730===0)))){return zero$22715;}else{if(($22718$22732&&(t0$22730===1))){(x$22741=$22717$22725[0]);return x$22741;}else{if(($22718$22732&&(t0$22730>=1))){(x$22746=$22717$22725[0]);(rest$22747=Array.prototype.slice.call($22717$22725,1));return fn$22714(x$22746,construct$22205(rest$22747,fn$22714,zero$22715));}else{$22847($22717$22725);}}}});;(set$22206=function(xs$22756){var $index$22777;var $length$22772;var temp$22767;var rval$22759;(rval$22759=({}));;(temp$22767=xs$22756);;($length$22772=temp$22767.length);;($index$22777=0);;$22760:for(;($index$22777<$length$22772);($index$22777++)){var x$22793;var m$22785;(m$22785=temp$22767[$index$22777]);;(x$22793=m$22785);(rval$22759[x$22793]=true);}return rval$22759;});;(make_object$22207=function(pairs$22799){var $index$22820;var $length$22815;var temp$22810;var rval$22802;(rval$22802=({}));;(temp$22810=pairs$22799);;($length$22815=temp$22810.length);;($index$22820=0);;$22803:for(;($index$22820<$length$22815);($index$22820++)){var k$22838;var v$22839;var t0$22833;var t1$22834;var m$22828;(m$22828=temp$22810[$index$22820]);;(t0$22833=m$22828);if(((t0$22833 instanceof Array)&&((t1$22834=t0$22833.length),(t1$22834===2)))){(k$22838=t0$22833[0]);(v$22839=t0$22833[1]);(rval$22802[k$22838]=v$22839);}else{$22847(m$22828,"/home/olivier/git/earl-grey/src/util.eg",2652,2695);;}}return rval$22802;});;(exports["GenSym"]=GenSym$22191);(exports["gensym"]=gensym$22192);(exports["uuid"]=uuid$22193);(exports["identity"]=identity$22194);(exports["items"]=items$22195);(exports["keys"]=keys$22196);(exports["enumerate"]=enumerate$22197);(exports["binsearch"]=binsearch$22198);(exports["classify"]=classify$22200);(exports["classify_contiguous"]=classify_contiguous$22201);(exports["neighbours"]=neighbours$22202);(exports["zip"]=zip$22203);(exports["partition"]=partition$22204);(exports["construct"]=construct$22205);(exports["set"]=set$22206);(exports["make_object"]=make_object$22207);

},{}],15:[function(require,module,exports){

},{}]},{},[])