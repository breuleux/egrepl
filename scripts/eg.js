require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var $185=function(type$187){var f$190;(f$190=type$187["::check"]);;if((f$190===(void 0))){return function(value$195){return (value$195 instanceof type$187);};}else{return function(value$198){return f$190.call(type$187,value$198);};}};
var $200=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $201=function(dest$203,values$204){var k$209;(k$209=null);$207:for(k$209 in values$204){if(values$204.hasOwnProperty(k$209)){(dest$203[k$209]=values$204[k$209]);}}return dest$203;};
var $213=function($214$216){var ph$220;(ph$220=$214$216);;var $218$225;($218$225=ph$220);;var bridge$219$230;var x$234;(bridge$219$230=$218$225);if((((typeof(bridge$219$230)==="string")&&((x$234=bridge$219$230),true))||((typeof(bridge$219$230)==="number")&&((x$234=bridge$219$230),true)))){return ["value",x$234];}else{var other$241;(other$241=$218$225);return other$241["::serialize_ast"]();}};
var send$25;(send$25=function(obj$30,$28$31){var ph$35;var msg$36;var t0$38;(t0$38=$28$31);(msg$36=t0$38);(ph$35=t0$38);;var $33$42;($33$42=ph$35);;var bridge$34$47;(bridge$34$47=$33$42);if(((typeof(bridge$34$47)==="string")||(typeof(bridge$34$47)==="number"))){return obj$30[msg$36];}else{var other$55;(other$55=$33$42);return obj$30["::send"](msg$36);}});;(Array[":::project"]=function($58$60){var ph$63;var value$64;var t0$66;(t0$66=$58$60);(value$64=t0$66);(ph$63=t0$66);;var $62$70;($62$70=ph$63);;if($185(Array)($62$70)){return [true,value$64];}else{$62$70;return [true,[value$64]];}});(Array.prototype["::check"]=function(value$84){if((value$84 instanceof Array)){var i$89;(i$89=0);;$87:for(;(i$89<this.length);(i$89++)){if(($200(this,i$89)!==$200(value$84,i$89))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $201(this.slice(0),this);});(Array.prototype[":::project"]=function(value$100){if((value$100 instanceof Array)){var i$105;(i$105=0);;$103:for(;(i$105<this.length);(i$105++)){if(($200(this,i$105)!==$200(value$100,i$105))){return [true,[value$100]];}}return [true,value$100.slice(this.length)];}else{return [true,[value$100]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($213));});(RegExp.prototype["::check"]=function($115$117){var ph$120;(ph$120=$115$117);;var $119$125;($119$125=ph$120);;var value$133;if((typeof($119$125)==="string")){(value$133=$119$125);if(value$133.match(this)){return true;}else{return false;}}else{var other$138;(other$138=$119$125);return false;}});(RegExp.prototype[":::project"]=function($140$142){var ph$145;(ph$145=$140$142);;var $144$150;($144$150=ph$145);;var value$158;if((typeof($144$150)==="string")){(value$158=$144$150);var $161$163;($161$163=value$158.match(this));;var m$171;if(($161$163===null)){(m$171=$161$163);return [false,null];}else{var m$176;(m$176=$161$163);return [true,m$176];}}else{var other$180;(other$180=$144$150);return [false,null];}});(Function.prototype["::send"]=function(args$183){return this.apply(this,args$183);});
var $796=Object.keys;
var $797=function($798$800,key$801){var ph$805;(ph$805=$798$800);;var $803$810;($803$810=ph$805);;var bridge$804$815;(bridge$804$815=$803$810);if(((bridge$804$815===null)||(bridge$804$815===(void 0)))){return false;}else{var x$823;if((typeof($803$810)==="string")){(x$823=$803$810);return (key$801 in String.prototype);}else{var x$828;if((typeof($803$810)==="number")){(x$828=$803$810);return (key$801 in Number.prototype);}else{var x$833;(x$833=$803$810);return (key$801 in x$833);}}}};
var $675=function($676$678,b$679){var ph$685;var a$686;var t0$688;(t0$688=$676$678);(a$686=t0$688);(ph$685=t0$688);;var $681$692;($681$692=ph$685);;var bridge$682$697;if(($681$692===b$679)){return true;}else{(bridge$682$697=$681$692);if((function(){var bridge$683$707;(bridge$683$707=bridge$682$697);return (function(){var bridge$684$710;(bridge$684$710=bridge$683$707);return ((typeof(bridge$684$710)==="number")||(typeof(bridge$684$710)==="string"));}()||(bridge$683$707===null));}()||(bridge$682$697===(void 0)))){return false;}else{if($185(Array)($681$692)){if(((!$185(Array)(b$679))||(a$686.length!==b$679.length))){return false;}var i$721;(i$721=0);;$718:for(;(i$721<a$686.length);(i$721++)){if((!$675(a$686[i$721],b$679[i$721]))){return false;}}return true;}else{$681$692;if(((Object.getPrototypeOf(a$686)===Object.prototype)&&(Object.getPrototypeOf(b$679)===Object.prototype))){var ka$734;(ka$734=$796(a$686));;if((!$675(ka$734.sort(),$796(b$679).sort()))){return false;}var temp$743;(temp$743=ka$734);;var $length$748;($length$748=temp$743.length);;var $index$753;($index$753=0);;$735:for(;($index$753<$length$748);($index$753++)){var m$761;(m$761=temp$743[$index$753]);;var k$769;(k$769=m$761);if((!$675(a$686[k$769],b$679[k$769]))){return false;}}return true;}else{if($797($681$692,"::serialize")){$681$692["::serialize"];var $776$778;($776$778=b$679);;if($797($776$778,"::serialize")){$776$778["::serialize"];return $675(a$686["::serialize"](),b$679["::serialize"]());}else{var otherwise$790;(otherwise$790=$776$778);return false;}}else{var otherwise$794;(otherwise$794=$681$692);return false;}}}}}};
var $670=function(x$672,y$673){return (!$675(x$672,y$673));};var accum$662;var accum$666;var keynames$245;var prevent$246;var Interactor$247;(keynames$245=({8:"Backspace",9:"Tab",13:"Enter",16:"S-",17:"C-",18:"A-",27:"Esc",32:"Space",33:"PgUp",34:"PgDn",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12"}));;(prevent$246=function(event$254){event$254.preventDefault();return event$254.stopPropagation();});;(Interactor$247=function(target$261){var accum$271;var accum$277;var accum$283;var accum$289;var it$0$264;(it$0$264=function(){if((!$185(Interactor$247)(this))){return Object.create(Interactor$247.prototype);}else{return this;}}());;(it$0$264["functions"]=(target$261.interactor_functions||target$261));(it$0$264["more_functions"]=$201(((accum$271=({})),((accum$271["default"]=function(){return "default";}),accum$271)),$201(((accum$277=({})),((accum$277["stick"]=function(){return "stick";}),accum$277)),$201(((accum$283=({})),((accum$283["break"]=function(){return "break";}),accum$283)),((accum$289=({})),((accum$289["none"]=function(){return (void 0);}),accum$289))))));(it$0$264["current_bindings"]=null);(it$0$264["global_bindings"]=null);return it$0$264;});;(Interactor$247.prototype["set_bindings"]=function(new_bindings$298){var self$306;var it$0$301;(it$0$301=this);;(self$306=this);;(it$0$301["current_bindings"]=null);return (it$0$301["global_bindings"]=new_bindings$298);});(Interactor$247.prototype["execute"]=function(c$314,e$315){var f$341;var $index$374;var $length$369;var temp$364;var result$356;var cmd$420;var cmds$352;var f$347;var cmd$337;var $323$329;var self$324;var it$0$318;(it$0$318=this);;(self$324=this);;($323$329=c$314);;if((typeof($323$329)==="string")){(cmd$337=$323$329);(f$341=($200(it$0$318.functions,cmd$337)||$200(it$0$318.more_functions,cmd$337)));;return f$341(e$315);}else{if($185(Function)($323$329)){(f$347=$323$329);return f$347(it$0$318.target,e$315);}else{if($185(Array)($323$329)){(cmds$352=$323$329);(result$356=null);;(temp$364=cmds$352);;($length$369=temp$364.length);;($index$374=0);;$357:for(;($index$374<$length$369);($index$374++)){var other$416;var $393$395;var cmd$390;var m$382;(m$382=temp$364[$index$374]);;(cmd$390=m$382);(result$356=it$0$318.execute(cmd$390,e$315));($393$395=result$356);;if(($393$395==="break")){prevent$246(e$315);break $357;}else{if(($393$395==="default")){break $357;}else{if(($393$395==="ignore")){continue $357;}else{(other$416=$393$395);prevent$246(e$315);}}}}return result$356;}else{(cmd$420=$323$329);(it$0$318["current_bindings"]=cmd$420);return "break stick";}}}});(Interactor$247.prototype["process_codes"]=function(codes$426,e$427){var $index$467;var $length$462;var temp$457;var otherwise$533;var $506$514;var $505$508;var result$539;var t0$498;var $440$493;var bindings$441;var just_modifiers$442;var commands$443;var self$435;var it$0$430;(it$0$430=this);;(self$435=this);;(bindings$441=(it$0$430.current_bindings||it$0$430.global_bindings));;(just_modifiers$442=null);;(commands$443=[]);;(temp$457=codes$426);;($length$462=temp$457.length);;($index$467=0);;$444:for(;($index$467<$length$462);($index$467++)){var command$486;var code$483;var m$475;(m$475=temp$457[$index$467]);;(code$483=m$475);if($185(RegExp("^([ACS]-)+$",""))(code$483)){(just_modifiers$442=true);}(command$486=$200(bindings$441,code$483));;if($670(command$486,(void 0))){commands$443.push(command$486);}}($440$493=commands$443);;if((($440$493 instanceof Array)&&((t0$498=$440$493.length),(t0$498===0)))){($505$508=null);;$505$508;if((it$0$430.current_bindings&&it$0$430.current_bindings._eat)){if((!just_modifiers$442)){(it$0$430["current_bindings"]=null);}return prevent$246(e$427);}else{if((it$0$430.current_bindings&&it$0$430.current_bindings._browser)){if((!just_modifiers$442)){return (it$0$430["current_bindings"]=null);}}else{if((it$0$430.current_bindings&&(!just_modifiers$442))){(it$0$430["current_bindings"]=null);return it$0$430.process_codes(codes$426,e$427);}else{(otherwise$533=$505$508);return null;}}}}else{$440$493;(result$539=it$0$430.execute(commands$443,e$427));;if(($675(result$539,(void 0))||(result$539.match&&result$539.match("break")))){prevent$246(e$427);}if((((!((result$539&&result$539.match)&&result$539.match("stick")))&&it$0$430.current_bindings)&&(!it$0$430.current_bindings._stick))){return (it$0$430["current_bindings"]=null);}}});(Interactor$247.prototype["getcode"]=function(e$548){var otherwise$589;var $562$574;var $561$568;var code$563;var self$556;var it$0$551;(it$0$551=this);;(self$556=this);;(code$563=($200(keynames$245,e$548.which)||(("<"+e$548.which)+">")));;($561$568=null);;$561$568;if((e$548.shiftKey&&$670(code$563,"S-"))){return ("S-"+code$563);}else{if((e$548.altKey&&$670(code$563,"A-"))){return ("A-"+code$563);}else{if(((e$548.ctrlKey||e$548.metaKey)&&$670(code$563,"C-"))){return ("C-"+code$563);}else{(otherwise$589=$561$568);return code$563;}}}});(Interactor$247.prototype["keyup"]=function(e$594){var self$602;var it$0$597;(it$0$597=this);;(self$602=this);;return it$0$597.process_codes(["!^All",("^"+it$0$597.getcode(e$594)),"^All"],e$594);});(Interactor$247.prototype["keydown"]=function(e$609){var self$617;var it$0$612;(it$0$612=this);;(self$617=this);;return it$0$612.process_codes(["!All",it$0$612.getcode(e$609),"All"],e$609);});(Interactor$247.prototype["keypress"]=function(e$624){var key$637;var code$638;var self$632;var it$0$627;(it$0$627=this);;(self$632=this);;(key$637=e$624.which);;(code$638=("="+String.fromCharCode(key$637)));;return it$0$627.process_codes(["!=All",code$638,"=All"],e$624);});(Interactor$247.prototype["install"]=function(element$648){var self$656;var it$0$651;(it$0$651=this);;(self$656=this);;(element$648["onkeydown"]=it$0$651.keydown.bind(it$0$651));(element$648["onkeyup"]=it$0$651.keyup.bind(it$0$651));return (element$648["onkeypress"]=it$0$651.keypress.bind(it$0$651));});$201(Interactor$247,$201(((accum$662=({})),((accum$662["::name"]="Interactor"),accum$662)),((accum$666=({})),((accum$666["::egclass"]=true),accum$666))));Interactor$247;(exports["Interactor"]=Interactor$247);

},{}],"eXk3/i":[function(require,module,exports){
var $996=function(type$998){var f$1001;(f$1001=type$998["::check"]);;if((f$1001===(void 0))){return function(value$1006){return (value$1006 instanceof type$998);};}else{return function(value$1009){return f$1001.call(type$998,value$1009);};}};
var $1011=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $1012=function(dest$1014,values$1015){var k$1020;(k$1020=null);$1018:for(k$1020 in values$1015){if(values$1015.hasOwnProperty(k$1020)){(dest$1014[k$1020]=values$1015[k$1020]);}}return dest$1014;};
var $1024=function($1025$1027){var ph$1031;(ph$1031=$1025$1027);;var $1029$1036;($1029$1036=ph$1031);;var bridge$1030$1041;var x$1045;(bridge$1030$1041=$1029$1036);if((((typeof(bridge$1030$1041)==="string")&&((x$1045=bridge$1030$1041),true))||((typeof(bridge$1030$1041)==="number")&&((x$1045=bridge$1030$1041),true)))){return ["value",x$1045];}else{var other$1052;(other$1052=$1029$1036);return other$1052["::serialize_ast"]();}};
var send$836;(send$836=function(obj$841,$839$842){var ph$846;var msg$847;var t0$849;(t0$849=$839$842);(msg$847=t0$849);(ph$846=t0$849);;var $844$853;($844$853=ph$846);;var bridge$845$858;(bridge$845$858=$844$853);if(((typeof(bridge$845$858)==="string")||(typeof(bridge$845$858)==="number"))){return obj$841[msg$847];}else{var other$866;(other$866=$844$853);return obj$841["::send"](msg$847);}});;(Array[":::project"]=function($869$871){var ph$874;var value$875;var t0$877;(t0$877=$869$871);(value$875=t0$877);(ph$874=t0$877);;var $873$881;($873$881=ph$874);;if($996(Array)($873$881)){return [true,value$875];}else{$873$881;return [true,[value$875]];}});(Array.prototype["::check"]=function(value$895){if((value$895 instanceof Array)){var i$900;(i$900=0);;$898:for(;(i$900<this.length);(i$900++)){if(($1011(this,i$900)!==$1011(value$895,i$900))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $1012(this.slice(0),this);});(Array.prototype[":::project"]=function(value$911){if((value$911 instanceof Array)){var i$916;(i$916=0);;$914:for(;(i$916<this.length);(i$916++)){if(($1011(this,i$916)!==$1011(value$911,i$916))){return [true,[value$911]];}}return [true,value$911.slice(this.length)];}else{return [true,[value$911]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($1024));});(RegExp.prototype["::check"]=function($926$928){var ph$931;(ph$931=$926$928);;var $930$936;($930$936=ph$931);;var value$944;if((typeof($930$936)==="string")){(value$944=$930$936);if(value$944.match(this)){return true;}else{return false;}}else{var other$949;(other$949=$930$936);return false;}});(RegExp.prototype[":::project"]=function($951$953){var ph$956;(ph$956=$951$953);;var $955$961;($955$961=ph$956);;var value$969;if((typeof($955$961)==="string")){(value$969=$955$961);var $972$974;($972$974=value$969.match(this));;var m$982;if(($972$974===null)){(m$982=$972$974);return [false,null];}else{var m$987;(m$987=$972$974);return [true,m$987];}}else{var other$991;(other$991=$955$961);return [false,null];}});(Function.prototype["::send"]=function(args$994){return this.apply(this,args$994);});
var $2381=function(obj$2383){var results$2387;(results$2387=[]);;var k$2392;(k$2392=null);$2386:for(k$2392 in obj$2383){if(Object.prototype.hasOwnProperty.call(obj$2383,k$2392)){results$2387.push([k$2392,$1011(obj$2383,k$2392)]);}}return results$2387;};
var $2578=function(arr$2580){var results$2584;var l$2585;(results$2584=[]);;(l$2585=arr$2580.length);;var i$2593;(i$2593=0);;$2583:for(;(i$2593<l$2585);(i$2593++)){results$2584.push([i$2593,$1011(arr$2580,i$2593)]);}return results$2584;};
var $2409=function(){var $2410$2412;($2410$2412=function(tags$2416){var it$0$2419;(it$0$2419=function(){if((!$996($2410$2412)(this))){return Object.create($2410$2412.prototype);}else{return this;}}());;(it$0$2419["tags"]=tags$2416);return it$0$2419;});;($2410$2412.prototype["create"]=function(){var $2428$2430;($2428$2430=arguments);;var t0$2435;var message$2439;var args$2440;(t0$2435=$2428$2430.length);if((t0$2435>=0)){(message$2439=function(){if((0>=t0$2435)){return "";}else{return $2428$2430[0];}}());(args$2440=Array.prototype.slice.call($2428$2430,1));var it$0$2444;(it$0$2444=this);;var self$2449;(self$2449=this);;var e$2454;(e$2454=Error(message$2439));;(e$2454["::tags"]=it$0$2444.tags);(e$2454["args"]=args$2440);var temp$2462;(temp$2462=$2578(args$2440));;var $length$2467;($length$2467=temp$2462.length);;var $index$2472;($index$2472=0);;$2455:for(;($index$2472<$length$2467);($index$2472++)){var m$2480;(m$2480=temp$2462[$index$2472]);;var t0$2485;var t1$2486;var i$2490;var arg$2491;(t0$2485=m$2480);if(((t0$2485 instanceof Array)&&((t1$2486=t0$2485.length),(t1$2486===2)))){(i$2490=t0$2485[0]);(arg$2491=t0$2485[1]);(e$2454[i$2490]=arg$2491);}else{$2396(m$2480);;}}(e$2454["length"]=args$2440.length);(e$2454["name"]=["E"].concat(it$0$2444.tags).join("."));return e$2454;}else{$2396($2428$2430);}});($2410$2412.prototype["::check"]=function(e$2502){var it$0$2505;(it$0$2505=this);;var self$2510;(self$2510=this);;var tags$2515;if(((!e$2502)||(!$996(Error)(e$2502)))){return false;}(tags$2515=(e$2502["::tags"]||[]));;var temp$2524;(temp$2524=it$0$2505.tags);;var $length$2529;($length$2529=temp$2524.length);;var $index$2534;($index$2534=0);;$2516:for(;($index$2534<$length$2529);($index$2534++)){var m$2542;(m$2542=temp$2524[$index$2534]);;var tag$2550;(tag$2550=m$2542);if((tags$2515.indexOf(tag$2550)===-1)){return false;}else{false;;}}return true;});($2410$2412.prototype["::deconstruct"]=function(e$2558){var it$0$2561;(it$0$2561=this);;var self$2566;(self$2566=this);;return e$2558.args;});$1012($2410$2412,$1012(function(){var accum$2571;(accum$2571=({}));(accum$2571["::name"]="$2410");return accum$2571;}(),function(){var accum$2575;(accum$2575=({}));(accum$2575["::egclass"]=true);return accum$2575;}()));return $2410$2412;}();
var $2396=function(value$2398,url$2399,start$2400,end$2401){var err$2404;(err$2404=$2409(["match"]).create("Could not find a match for value",({"value":value$2398})));;if(url$2399){(err$2404["location"]=["location",url$2399,start$2400,end$2401]);}throw err$2404;};
var $2600=function(type$2602){return function(value$2605){var f$2608;(f$2608=type$2602[":::project"]);;if((f$2608===(void 0))){(f$2608=type$2602["::project"]);if((f$2608===(void 0))){return [true,type$2602(value$2605)];}else{var rval$2614;(rval$2614=false);;try{(rval$2614=[true,f$2608(value$2605)]);}catch(excv$2620){var e$2626;(e$2626=excv$2620);(rval$2614=[false,null]);}return rval$2614;}}else{return f$2608.call(type$2602,value$2605);}};};
var $2628=function(){var $2629$2631;($2629$2631=function($2634$2637,$2635$2638){var classes$2640;var children$2641;var t0$2643;(t0$2643=$2600(Array)($2634$2637));if(t0$2643[0]){(classes$2640=t0$2643[1]);;}else{$2396($2634$2637);}var t0$2648;(t0$2648=$2600(Array)($2635$2638));if(t0$2648[0]){(children$2641=t0$2648[1]);;}else{$2396($2635$2638);}var it$0$2653;(it$0$2653=function(){if((!$996($2629$2631)(this))){return Object.create($2629$2631.prototype);}else{return this;}}());;(it$0$2653["classes"]=classes$2640.sort());(it$0$2653["children"]=children$2641);return it$0$2653;});;$1012(function(){var accum$2661;(accum$2661=({}));(accum$2661["::check"]=function(x$2665){return ((x$2665&&x$2665.classes)&&x$2665.children);});return accum$2661;}(),$1012(function(){var accum$2668;(accum$2668=({}));(accum$2668["::deconstruct"]=function(x$2672){return [x$2672.classes,x$2672.children];});return accum$2668;}(),$1012(function(){var accum$2675;(accum$2675=({}));(accum$2675["::name"]="$2629");return accum$2675;}(),function(){var accum$2679;(accum$2679=({}));(accum$2679["::egclass"]=true);return accum$2679;}())));($2629$2631.prototype["::check"]=function(n$2685){var it$0$2688;(it$0$2688=this);;var self$2693;(self$2693=this);;var temp$2702;(temp$2702=it$0$2688.classes);;var $length$2707;($length$2707=temp$2702.length);;var $index$2712;($index$2712=0);;$2698:for(;($index$2712<$length$2707);($index$2712++)){var m$2720;(m$2720=temp$2702[$index$2712]);;var c$2728;(c$2728=m$2720);if((n$2685.classes.indexOf(c$2728)===-1)){return false;}else{false;;}}return true;});$1012($2629$2631,$1012(function(){var accum$2734;(accum$2734=({}));(accum$2734["::check"]=function(x$2738){return ((x$2738&&x$2738.classes)&&x$2738.children);});return accum$2734;}(),$1012(function(){var accum$2741;(accum$2741=({}));(accum$2741["::deconstruct"]=function(x$2745){return [x$2745.classes,x$2745.children];});return accum$2741;}(),$1012(function(){var accum$2748;(accum$2748=({}));(accum$2748["::name"]="$2629");return accum$2748;}(),function(){var accum$2752;(accum$2752=({}));(accum$2752["::egclass"]=true);return accum$2752;}()))));return $2629$2631;}();
var $2755=function($2756$2758,key$2759){var ph$2763;(ph$2763=$2756$2758);;var $2761$2768;($2761$2768=ph$2763);;var bridge$2762$2773;(bridge$2762$2773=$2761$2768);if(((bridge$2762$2773===null)||(bridge$2762$2773===(void 0)))){return false;}else{var x$2781;if((typeof($2761$2768)==="string")){(x$2781=$2761$2768);return (key$2759 in String.prototype);}else{var x$2786;if((typeof($2761$2768)==="number")){(x$2786=$2761$2768);return (key$2759 in Number.prototype);}else{var x$2791;(x$2791=$2761$2768);return (key$2759 in x$2791);}}}};
var $2914=Object.keys;
var $2793=function($2794$2796,b$2797){var ph$2803;var a$2804;var t0$2806;(t0$2806=$2794$2796);(a$2804=t0$2806);(ph$2803=t0$2806);;var $2799$2810;($2799$2810=ph$2803);;var bridge$2800$2815;if(($2799$2810===b$2797)){return true;}else{(bridge$2800$2815=$2799$2810);if((function(){var bridge$2801$2825;(bridge$2801$2825=bridge$2800$2815);return (function(){var bridge$2802$2828;(bridge$2802$2828=bridge$2801$2825);return ((typeof(bridge$2802$2828)==="number")||(typeof(bridge$2802$2828)==="string"));}()||(bridge$2801$2825===null));}()||(bridge$2800$2815===(void 0)))){return false;}else{if($996(Array)($2799$2810)){if(((!$996(Array)(b$2797))||(a$2804.length!==b$2797.length))){return false;}var i$2839;(i$2839=0);;$2836:for(;(i$2839<a$2804.length);(i$2839++)){if((!$2793(a$2804[i$2839],b$2797[i$2839]))){return false;}}return true;}else{$2799$2810;if(((Object.getPrototypeOf(a$2804)===Object.prototype)&&(Object.getPrototypeOf(b$2797)===Object.prototype))){var ka$2852;(ka$2852=$2914(a$2804));;if((!$2793(ka$2852.sort(),$2914(b$2797).sort()))){return false;}var temp$2861;(temp$2861=ka$2852);;var $length$2866;($length$2866=temp$2861.length);;var $index$2871;($index$2871=0);;$2853:for(;($index$2871<$length$2866);($index$2871++)){var m$2879;(m$2879=temp$2861[$index$2871]);;var k$2887;(k$2887=m$2879);if((!$2793(a$2804[k$2887],b$2797[k$2887]))){return false;}}return true;}else{if($2755($2799$2810,"::serialize")){$2799$2810["::serialize"];var $2894$2896;($2894$2896=b$2797);;if($2755($2894$2896,"::serialize")){$2894$2896["::serialize"];return $2793(a$2804["::serialize"](),b$2797["::serialize"]());}else{var otherwise$2908;(otherwise$2908=$2894$2896);return false;}}else{var otherwise$2912;(otherwise$2912=$2799$2810);return false;}}}}}};
var $2931=function($2932$2934){var ph$2940;var x$2941;var t0$2943;(t0$2943=$2932$2934);(x$2941=t0$2943);(ph$2940=t0$2943);;var $2936$2947;($2936$2947=ph$2940);;var bridge$2937$2952;(bridge$2937$2952=$2936$2947);if((function(){var bridge$2938$2958;(bridge$2938$2958=bridge$2937$2952);return (function(){var bridge$2939$2961;(bridge$2939$2961=bridge$2938$2958);return ((bridge$2939$2961===(void 0))||(bridge$2939$2961===null));}()||(typeof(bridge$2938$2958)==="string"));}()||(typeof(bridge$2937$2952)==="number"))){return x$2941;}else{if($2755($2936$2947,"::clone")){$2936$2947["::clone"];return x$2941["::clone"]();}else{$2936$2947;if((Object.getPrototypeOf(x$2941)===Object.prototype)){var dest$2974;(dest$2974=({}));;var k$2979;(k$2979=null);$2973:for(k$2979 in x$2941){if(Object.prototype.hasOwnProperty.call(x$2941,k$2979)){(dest$2974[k$2979]=x$2941[k$2979]);}}return dest$2974;}else{var other$2985;(other$2985=$2936$2947);throw $2409(["clone"]).create("Object cannot be cloned",({"obj":x$2941}));}}}};
var $2915=function(a$2917,b$2918){var dest$2922;(dest$2922=$2931(a$2917));;var k$2927;(k$2927=null);$2921:for(k$2927 in b$2918){if(Object.prototype.hasOwnProperty.call(b$2918,k$2927)){(dest$2922[k$2927]=b$2918[k$2927]);}}return dest$2922;};var accum$2288;var accum$2292;var kb$1062;var eg$1063;var $1058$1064;var GenSym$1065;var $1059$1066;var Location$1067;var highlight_locations$1068;var format_error$1069;var $1060$1070;var tokenize$1071;var $1061$1072;var parse$1073;var gensym$1074;var create_node$1075;var make_dom$1076;var mktable$1077;var mktable2$1078;var repr$1079;var goto_end$1080;var insert_before_caret$1081;var Repl$1082;var make_cards$1083;(kb$1062=require("./kb"));;(eg$1063=require("../lib/earl-grey"));;($1058$1064=require("../lib/util"));;(GenSym$1065=$1058$1064.GenSym);;($1059$1066=require("../lib/location"));;(Location$1067=$1059$1066.Location);;(highlight_locations$1068=$1059$1066.highlight_locations);;(format_error$1069=$1059$1066.format_error);;($1060$1070=require("../lib/lex"));;(tokenize$1071=$1060$1070.tokenize);;($1061$1072=require("../lib/parse"));;(parse$1073=$1061$1072.parse);;(gensym$1074=GenSym$1065("io_"));;(create_node$1075=function(tag$1126,kv$1127,contents$1128){var $index$1151;var $length$1146;var temp$1141;var $index$1188;var $length$1183;var temp$1178;var node$1131;(node$1131=document.createElement(tag$1126));;(temp$1141=$2381(kv$1127));;($length$1146=temp$1141.length);;($index$1151=0);;$1132:for(;($index$1151<$length$1146);($index$1151++)){var k$1169;var v$1170;var t0$1164;var t1$1165;var m$1159;(m$1159=temp$1141[$index$1151]);;(t0$1164=m$1159);if(((t0$1164 instanceof Array)&&((t1$1165=t0$1164.length),(t1$1165===2)))){(k$1169=t0$1164[0]);(v$1170=t0$1164[1]);(node$1131[k$1169]=v$1170);}else{$2396(m$1159,"/home/olivier/git/egrepl/src/repl.eg",1782,1829);;}}(temp$1178=$2600(Array)(contents$1128)[1]);;($length$1183=temp$1178.length);;($index$1188=0);;$1134:for(;($index$1188<$length$1183);($index$1188++)){var other$1210;var s$1205;var t0$1201;var m$1196;(m$1196=temp$1178[$index$1188]);;(t0$1201=m$1196);if((typeof(t0$1201)==="string")){(s$1205=t0$1201);node$1131.appendChild(document.createTextNode(s$1205));}else{(other$1210=m$1196);node$1131.appendChild(other$1210);}}return node$1131;});;(make_dom$1076=function(){var $index$1266;var $length$1261;var temp$1256;var node$1248;var $index$1333;var $length$1328;var temp$1323;var $index$1403;var $length$1398;var temp$1393;var $index$1457;var $length$1452;var temp$1447;var acc$1442;var $index$1501;var $length$1496;var temp$1491;var acc$1486;var other$1481;var $1292$1429;var tag$1293;var _classes$1294;var id$1295;var kv$1296;var sub$1297;var node$1298;var other$1521;var classes$1286;var children$1287;var args$1244;var s$1239;var $1218$1236;var t0$1234;var default_tag$1229;var $1217$1230;var t0$1225;var $1216$1220;($1216$1220=arguments);;(t0$1225=$1216$1220.length);if(((t0$1225>=1)&&(t0$1225<=2))){($1217$1230=$1216$1220[0]);(default_tag$1229=function(){if((1>=t0$1225)){return "div";}else{return $1216$1220[1];}}());(t0$1234=$1217$1230);if((typeof(t0$1234)==="string")){(s$1239=t0$1234);return document.createTextNode(s$1239);}else{if($996(Array)(t0$1234)){(args$1244=t0$1234);(node$1248=document.createElement("span"));;(temp$1256=args$1244);;($length$1261=temp$1256.length);;($index$1266=0);;$1249:for(;($index$1266<$length$1261);($index$1266++)){var arg$1282;var m$1274;(m$1274=temp$1256[$index$1266]);;(arg$1282=m$1274);node$1248.appendChild(make_dom$1076(arg$1282,default_tag$1229));}return node$1248;}else{if(($996($2628)(t0$1234)&&($2755(t0$1234,"classes")&&((classes$1286=t0$1234.classes),$2755(t0$1234,"children"))))){(children$1287=t0$1234.children);(tag$1293=default_tag$1229);;(_classes$1294=[]);;(id$1295=null);;(kv$1296=[]);;(sub$1297=[]);;(temp$1323=classes$1286);;($length$1328=temp$1323.length);;($index$1333=0);;$1299:for(;($index$1333<$length$1328);($index$1333++)){var s$1381;var m$1374;var m$1367;var k$1362;var k$1355;var v$1356;var $1301$1350;var $1302$1351;var $1303$1352;var t0$1346;var t1$1347;var t2$1348;var m$1341;(m$1341=temp$1323[$index$1333]);;(t0$1346=m$1341);if((($1302$1351=(t0$1346 instanceof Array))&&((t1$1347=t0$1346.length),((t1$1347===3)&&(t0$1346[0]==="assoc"))))){(k$1355=t0$1346[1]);(v$1356=t0$1346[2]);kv$1296.push([k$1355,v$1356]);}else{if(($1302$1351&&((t1$1347===2)&&(t0$1346[0]==="assoc")))){(k$1362=t0$1346[1]);kv$1296.push([k$1362,(void 0)]);}else{(t0$1346=$2600(RegExp("(?:^\\+((?:.*)))",""))(m$1341));if((t0$1346[0]&&((t1$1347=t0$1346[1]),((t2$1348=t1$1347.length),(t2$1348===2))))){t1$1347[0];(m$1367=t1$1347[1]);(tag$1293=m$1367);}else{(t0$1346=$2600(RegExp("(?:^#((?:.*)))",""))(m$1341));if((t0$1346[0]&&((t1$1347=t0$1346[1]),((t2$1348=t1$1347.length),(t2$1348===2))))){t1$1347[0];(m$1374=t1$1347[1]);(id$1295=m$1374);}else{(t0$1346=m$1341);if((typeof(t0$1346)==="string")){(s$1381=t0$1346);_classes$1294.push(s$1381);}else{$2396(m$1341,"/home/olivier/git/egrepl/src/repl.eg",2357,2678);;}}}}}}(node$1298=document.createElement(tag$1293));;if(id$1295){(node$1298["id"]=id$1295);}if(_classes$1294.length){(node$1298["className"]=_classes$1294.join(" "));}(temp$1393=kv$1296);;($length$1398=temp$1393.length);;($index$1403=0);;$1304:for(;($index$1403<$length$1398);($index$1403++)){var k$1421;var v$1422;var t0$1416;var t1$1417;var m$1411;(m$1411=temp$1393[$index$1403]);;(t0$1416=m$1411);if(((t0$1416 instanceof Array)&&((t1$1417=t0$1416.length),(t1$1417===2)))){(k$1421=t0$1416[0]);(v$1422=t0$1416[1]);(node$1298[k$1421]=v$1422);}else{$2396(m$1411,"/home/olivier/git/egrepl/src/repl.eg",2827,2874);;}}($1292$1429=tag$1293);;if(($1292$1429==="raw")){(acc$1442=[]);;(temp$1447=children$1287);;($length$1452=temp$1447.length);;($index$1457=0);;$1439:for(;($index$1457<$length$1452);($index$1457++)){var s$1474;var t0$1470;var m$1465;(m$1465=temp$1447[$index$1457]);;(t0$1470=m$1465);if((typeof(t0$1470)==="string")){(s$1474=t0$1470);acc$1442.push((node$1298["innerHTML"]=s$1474));}else{$2396(m$1465,"/home/olivier/git/egrepl/src/repl.eg",2901,3003);;}}acc$1442;}else{(other$1481=$1292$1429);(acc$1486=[]);;(temp$1491=children$1287);;($length$1496=temp$1491.length);;($index$1501=0);;$1483:for(;($index$1501<$length$1496);($index$1501++)){var c$1517;var m$1509;(m$1509=temp$1491[$index$1501]);;(c$1517=m$1509);acc$1486.push(node$1298.appendChild(make_dom$1076(c$1517,default_tag$1229)));}acc$1486;}return node$1298;}else{(other$1521=$1217$1230);return make_dom$1076([true,String(other$1521)][1]);}}}}else{$2396($1216$1220);}});;(mktable$1077=function(){var other$1562;var $1548$1550;var $index$1583;var $length$1578;var temp$1573;var acc$1568;var its$1545;var x$1540;var recur$1541;var t0$1536;var $1529$1531;($1529$1531=arguments);;(t0$1536=$1529$1531.length);if(((t0$1536>=1)&&(t0$1536<=2))){(x$1540=$1529$1531[0]);(recur$1541=function(){if((1>=t0$1536)){return repr$1079;}else{return $1529$1531[1];}}());(its$1545=((($1548$1550=x$1540)),function(){if($996(Array)($1548$1550)){return x$1540;}else{(other$1562=$1548$1550);return $2381(x$1540);}}()));;if(its$1545.length){return $2628(["+table","object"],(((acc$1568=[])),(((temp$1573=its$1545)),((($length$1578=temp$1573.length)),((($index$1583=0)),function(){$1565:for(;($index$1583<$length$1578);($index$1583++)){var k$1601;var v$1602;var t0$1596;var t1$1597;var m$1591;(m$1591=temp$1573[$index$1583]);;(t0$1596=m$1591);if(((t0$1596 instanceof Array)&&((t1$1597=t0$1596.length),(t1$1597===2)))){(k$1601=t0$1596[0]);(v$1602=t0$1596[1]);acc$1568.push($2628(["+tr"],[$2628(["+th"],recur$1541(k$1601,repr$1079)),$2628(["+td"],recur$1541(v$1602,repr$1079))]));}else{$2396(m$1591,"/home/olivier/git/egrepl/src/repl.eg",3297,3431);;}}}()))),acc$1568));}else{return $2628(["object","empty"],[]);}}else{$2396($1529$1531);}});;(mktable2$1078=function(){var other$1647;var $1633$1635;var $index$1668;var $length$1663;var temp$1658;var acc$1653;var its$1630;var x$1625;var recur$1626;var t0$1621;var $1614$1616;($1614$1616=arguments);;(t0$1621=$1614$1616.length);if(((t0$1621>=1)&&(t0$1621<=2))){(x$1625=$1614$1616[0]);(recur$1626=function(){if((1>=t0$1621)){return repr$1079;}else{return $1614$1616[1];}}());(its$1630=((($1633$1635=x$1625)),function(){if($996(Array)($1633$1635)){return x$1625;}else{(other$1647=$1633$1635);return $2381(x$1625);}}()));;return $2628(["+table"],(((acc$1653=[])),(((temp$1658=its$1630)),((($length$1663=temp$1658.length)),((($index$1668=0)),function(){$1650:for(;($index$1668<$length$1663);($index$1668++)){var k$1686;var v$1687;var t0$1681;var t1$1682;var m$1676;(m$1676=temp$1658[$index$1668]);;(t0$1681=m$1676);if(((t0$1681 instanceof Array)&&((t1$1682=t0$1681.length),(t1$1682===2)))){(k$1686=t0$1681[0]);(v$1687=t0$1681[1]);acc$1653.push($2628(["+tr"],[$2628(["+th"],recur$1626(k$1686,repr$1079)),$2628(["+td"],recur$1626(v$1687,repr$1079))]));}else{$2396(m$1676,"/home/olivier/git/egrepl/src/repl.eg",3561,3666);;}}}()))),acc$1653));}else{$2396($1614$1616);}});;(repr$1079=function(){var $index$1786;var $length$1781;var temp$1776;var acc$1771;var other$1832;var f$1827;var n$1806;var entries$1765;var $1701$1728;var $1702$1729;var t0$1725;var t1$1726;var x$1715;var recur$1716;var $1700$1717;var t0$1709;var t1$1710;var t2$1711;var $1699$1704;($1699$1704=arguments);;(t0$1709=$1699$1704.length);if((((t0$1709>=1)&&(t0$1709<=2))&&((t1$1710=$1699$1704[0]),((x$1715=t1$1710),(($1700$1717=t1$1710),((t2$1711=function(){if((1>=t0$1709)){return repr$1079;}else{return $1699$1704[1];}}()),$996(Function)(t2$1711))))))){(recur$1716=t2$1711);if(($1700$1717===true)){return $2628(["special","true"],"true");}else{if(($1700$1717===false)){return $2628(["special","false"],"false");}else{if(($1700$1717===null)){return $2628(["special","nil"],"null");}else{if(($1700$1717===(void 0))){return $2628(["special","nil"],"undefined");}else{if((typeof($1700$1717)==="number")){return $2628(["num"],String(x$1715));}else{if(($1700$1717==="")){return $2628(["str","empty"],[]);}else{if((typeof($1700$1717)==="string")){return $2628(["str"],x$1715);}else{(t0$1725=$1700$1717);if((($1702$1729=$996(Array)(t0$1725))&&((t1$1726=t0$1725.length),(t1$1726===0)))){return $2628(["sequence","empty"],[]);}else{if($1702$1729){(entries$1765=t0$1725);return $2628(["sequence"],(((acc$1771=[])),(((temp$1776=entries$1765)),((($length$1781=temp$1776.length)),((($index$1786=0)),function(){$1768:for(;($index$1786<$length$1781);($index$1786++)){var x$1802;var m$1794;(m$1794=temp$1776[$index$1786]);;(x$1802=m$1794);acc$1771.push(recur$1716(x$1802,repr$1079));}}()))),acc$1771));}else{if($996($2628)(t0$1725)){(n$1806=t0$1725);return n$1806;}else{$1700$1717;if(x$1715["::repr"]){return x$1715["::repr"](recur$1716);}else{if((Object.getPrototypeOf(x$1715)===Object.prototype)){return mktable$1077(x$1715);}else{if((x$1715.constructor&&x$1715.constructor["::egclass"])){return $2628(["instance"],[$2628(["classname"],x$1715.constructor["::name"]),mktable$1077(x$1715)]);}else{if(x$1715["::egclass"]){return $2628(["class"],[$2628(["classname"],("Class "+x$1715["::name"])),mktable$1077(x$1715.prototype)]);}else{(t0$1725=$1700$1717);if($996(Function)(t0$1725)){(f$1827=t0$1725);return $2628(["function"],function(){if(f$1827.name){return f$1827.name;}else{return "<anonymous>";}}());}else{(other$1832=$1700$1717);return $2628(["unknown"],other$1832.toString());}}}}}}}}}}}}}}}}else{$2396($1699$1704);}});;(goto_end$1080=function(elem$1840){var range$1843;var selection$1844;(range$1843=document.createRange());;range$1843.selectNodeContents(elem$1840);range$1843.collapse(false);(selection$1844=window.getSelection());;selection$1844.removeAllRanges();return selection$1844.addRange(range$1843);});;(insert_before_caret$1081=function(text$1855){var other$1876;var $1862$1864;var it$0$1888;var it$0$1894;var range$1883;var node$1858;var sel$1859;(node$1858=((($1862$1864=text$1855)),function(){if((typeof($1862$1864)==="string")){return document.createTextNode(text$1855);}else{(other$1876=$1862$1864);return other$1876;}}()));;(sel$1859=window.getSelection());;if(sel$1859.rangeCount){(range$1883=sel$1859.getRangeAt(0));;(it$0$1888=range$1883);;it$0$1888.collapse(false);it$0$1888.insertNode(node$1858);(range$1883=range$1883.cloneRange());(it$0$1894=range$1883);;it$0$1894.selectNodeContents(node$1858);it$0$1894.collapse(false);sel$1859.removeAllRanges();return sel$1859.addRange(range$1883);}});;(Error.prototype["::repr"]=function(){return format_error$1069(this);});(Repl$1082=function(box$1905,target$1906,input$1907,evaluator$1908){var it$0$1911;(it$0$1911=function(){if((!$996(Repl$1082)(this))){return Object.create(Repl$1082.prototype);}else{return this;}}());;(it$0$1911["url"]="<repl>");(it$0$1911["gen"]=eg$1063.Generator(true));(it$0$1911["evaluator"]=evaluator$1908);(it$0$1911["box"]=box$1905);(it$0$1911["target"]=target$1906);(it$0$1911["input"]=input$1907);(it$0$1911["multiline"]=false);(it$0$1911["interactor"]=kb$1062.Interactor(({})));it$0$1911.set_multiline(false);it$0$1911.interactor.install(it$0$1911.input);(it$0$1911["cursor"]=0);(it$0$1911["history"]=[""]);return it$0$1911;});;(Repl$1082.prototype["sink"]=function(){var self$1928;var it$0$1923;(it$0$1923=this);;(self$1928=this);;return jQuery(it$0$1923.box).scrollTop(it$0$1923.box.scrollHeight);});(Repl$1082.prototype["add_to_history"]=function(text$1935){var hl$1948;var self$1943;var it$0$1938;(it$0$1938=this);;(self$1943=this);;(hl$1948=it$0$1938.history.length);;if(((text$1935!=="")&&(!((hl$1948>1)&&$2793($1011(it$0$1938.history,(hl$1948-2)),text$1935))))){(it$0$1938.history[(hl$1948-1)]=text$1935);it$0$1938.history.push("");}return (it$0$1938["cursor"]=(it$0$1938.history.length-1));});(Repl$1082.prototype["submit"]=function(){var text$1968;var self$1963;var it$0$1958;(it$0$1958=this);;(self$1963=this);;it$0$1958.set_multiline(false);(text$1968=it$0$1958.input.textContent);;it$0$1958.process(text$1968);(it$0$1958.input["innerHTML"]="");return it$0$1958.sink();});(Repl$1082.prototype["begin_multiline"]=function(){var self$1982;var it$0$1977;(it$0$1977=this);;(self$1982=this);;it$0$1977.set_multiline(true);goto_end$1080(it$0$1977.input);insert_before_caret$1081("\n   ");return it$0$1977.sink();});(Repl$1082.prototype["set_multiline"]=function(x$1990){var accum$2029;var accum$2035;var accum$2047;var accum$2054;var accum$2061;var accum$2088;var accum$2095;var accum$2101;var accum$2108;var previous$2011;var next$2012;var common$2013;var $1998$2004;var self$1999;var it$0$1993;(it$0$1993=this);;(self$1999=this);;($1998$2004=x$1990);;(previous$2011=function(){if((it$0$1993.cursor>0)){(it$0$1993.input["textContent"]=$1011(it$0$1993.history,(--it$0$1993.cursor)));goto_end$1080(it$0$1993.input);return it$0$1993.sink();}});;(next$2012=function(){if((it$0$1993.cursor<(it$0$1993.history.length-1))){(it$0$1993.input["textContent"]=$1011(it$0$1993.history,(++it$0$1993.cursor)));goto_end$1080(it$0$1993.input);return it$0$1993.sink();}});;(common$2013=$1012(((accum$2029=({})),((accum$2029["C-l"]=function(){return jQuery(it$0$1993.target).empty();}),accum$2029)),((accum$2035=({})),((accum$2035["S-Enter"]=function(){return it$0$1993.submit();}),accum$2035))));;if(($1998$2004===false)){jQuery(it$0$1993.input).removeClass("multiline");return it$0$1993.interactor.set_bindings($2915(common$2013,$1012(((accum$2047=({})),((accum$2047["C-m"]=function(){it$0$1993.set_multiline(true);return "break";}),accum$2047)),$1012(((accum$2054=({})),((accum$2054["C-Enter"]=function(){it$0$1993.begin_multiline();return "break";}),accum$2054)),$1012(((accum$2061=({})),((accum$2061["Enter"]=function(){var other$2080;var $2066$2068;($2066$2068=it$0$1993.input.textContent);;if($996(RegExp("(=|->|%|:|with|where|each)$",""))($2066$2068)){return it$0$1993.begin_multiline();}else{(other$2080=$2066$2068);return it$0$1993.submit();}}),accum$2061)),({"Up":previous$2011,"Down":next$2012}))))));}else{if(($1998$2004===true)){jQuery(it$0$1993.input).addClass("multiline");return it$0$1993.interactor.set_bindings($2915(common$2013,$1012(((accum$2088=({})),((accum$2088["C-m"]=function(){it$0$1993.set_multiline(false);return "break";}),accum$2088)),$1012(((accum$2095=({})),((accum$2095["C-Enter"]=function(){return it$0$1993.submit();}),accum$2095)),$1012(((accum$2101=({})),((accum$2101["Enter"]=function(){insert_before_caret$1081("\n");return it$0$1993.sink();}),accum$2101)),((accum$2108=({})),((accum$2108["Tab"]=function(){return insert_before_caret$1081("   ");}),accum$2108)))))));}else{$2396($1998$2004);}}});(Repl$1082.prototype["generate"]=function(text$2118){var self$2126;var it$0$2121;(it$0$2121=this);;(self$2126=this);;return it$0$2121.gen.generate(eg$1063.Source(text$2118,it$0$2121.url));});(Repl$1082.prototype["eval"]=function(text$2133){var rval$2165;var gen$2146;var handle$2147;var self$2141;var it$0$2136;(it$0$2136=this);;(self$2141=this);;(gen$2146=function(){var g$2153;(g$2153=it$0$2136.generate(text$2133));;return ["success",it$0$2136.evaluator(g$2153)];});;(handle$2147=function(e$2161){return ["failure",e$2161];});;(rval$2165=false);;try{(rval$2165=gen$2146());}catch(excv$2171){var e$2177;(e$2177=excv$2171);(rval$2165=handle$2147(e$2177));}return rval$2165;});(Repl$1082.prototype["process"]=function(){var error$2258;var value$2253;var n$2247;var $2219$2232;var $2220$2233;var $2221$2234;var $2222$2235;var t0$2229;var t1$2230;var $2218$2224;var real_text$2208;var node$2209;var name$2210;var collapse$2211;var on$2212;var self$2203;var it$0$2198;var text$2193;var display_in$2194;var t0$2189;var $2182$2184;($2182$2184=arguments);;(t0$2189=$2182$2184.length);if(((t0$2189>=1)&&(t0$2189<=2))){(text$2193=$2182$2184[0]);(display_in$2194=function(){if((1>=t0$2189)){return true;}else{return $2182$2184[1];}}());(it$0$2198=this);;(self$2203=this);;it$0$2198.add_to_history(text$2193);(real_text$2208=text$2193);;(node$2209=make_dom$1076($2628(["io"],[function(){if(display_in$2194){return $2628(["in"],[$2628(["inbanner"],[]),$2628(["entry"],(text$2193||" "))]);}else{return "";}}(),((($2218$2224=it$0$2198.eval(real_text$2208))),($2218$2224,function(){if((text$2193.trim()==="")){return "";}else{if((($2219$2232=($2218$2224 instanceof Array))&&((t0$2229=$2218$2224.length),(($2221$2234=(t0$2229===2))&&(($2222$2235=($2218$2224[0]==="success"))&&($2218$2224[1]===(void 0))))))){return "";}else{if(($2222$2235&&((t1$2230=$2218$2224[1]),$996($2628)(t1$2230)))){(n$2247=t1$2230);return $2628(["display"],[$2628(["displaybanner"],[]),$2628(["result"],n$2247)]);}else{if($2222$2235){(value$2253=$2218$2224[1]);return $2628(["out"],[$2628(["outbanner"],[]),$2628(["result"],$2628(["eg"],repr$1079(value$2253)))]);}else{if(($2221$2234&&($2218$2224[0]==="failure"))){(error$2258=$2218$2224[1]);return $2628(["err"],[$2628(["errbanner"],[]),$2628(["result"],$2628(["eg"],repr$1079(error$2258)))]);}else{$2396($2218$2224);}}}}}}()))])));;(name$2210=gensym$1074());;(node$2209["id"]=name$2210);it$0$2198.target.appendChild(node$2209);(collapse$2211=function(e$2270){var at_top$2273;e$2270.stopPropagation();(at_top$2273=$2793((it$0$2198.box.scrollTop+jQuery(it$0$2198.box).height()),it$0$2198.box.scrollHeight));;jQuery(this).toggleClass("collapsed");if(at_top$2273){return jQuery(it$0$2198.box).scrollTop(it$0$2198.box.scrollHeight);}});;(on$2212=function(sel$2282){return jQuery(((("#"+name$2210)+" ")+sel$2282));});;on$2212(".sequence").addClass("complex");on$2212(".object").addClass("complex");on$2212(".complex").click(collapse$2211);on$2212(".complex .complex .complex").addClass("collapsed");on$2212(".error_args.syntax").addClass("collapsed").click(collapse$2211);return on$2212(".traceback").addClass("collapsed").click(collapse$2211);}else{$2396($2182$2184);}});$1012(Repl$1082,$1012(((accum$2288=({})),((accum$2288["::name"]="Repl"),accum$2288)),((accum$2292=({})),((accum$2292["::egclass"]=true),accum$2292))));Repl$1082;(make_cards$1083=function(repl$2298){var clickable$2301;var clickable_row$2302;(clickable$2301=function(text$2306){var click$2309;(click$2309=function(e$2313){e$2313.preventDefault();repl$2298.process(text$2306);repl$2298.sink();return jQuery(repl$2298.input).focus();});;return $2628(["clickable",["assoc","onclick",click$2309]],text$2306);});;(clickable_row$2302=function(){var $index$2353;var $length$2348;var temp$2343;var acc$2338;var items$2332;var t0$2328;var $2321$2323;($2321$2323=arguments);;(t0$2328=$2321$2323.length);if((t0$2328>=0)){(items$2332=Array.prototype.slice.call($2321$2323,0));return $2628(["+span"],(((acc$2338=[])),(((temp$2343=items$2332)),((($length$2348=temp$2343.length)),((($index$2353=0)),function(){$2335:for(;($index$2353<$length$2348);($index$2353++)){var item$2374;var item$2369;var m$2361;(m$2361=temp$2343[$index$2353]);;(item$2369=m$2361);if(($index$2353===0)){acc$2338.push(clickable$2301(item$2369));}else{(item$2374=m$2361);acc$2338.push($2628(["+span"],[$2628(["+span","separator"],""),clickable$2301(item$2374)]));}}}()))),acc$2338));}else{$2396($2321$2323);}});;return [$2628(["card"],[$2628(["+h3"],"Keyboard controls"),mktable2$1078([[$2628(["+code"],"Up/Down"),"Navigate history"],[$2628(["+code"],"Enter/Shift-Enter"),"Evaluate an expression"],[$2628(["+code"],"Control-l"),"Clear the screen"],[$2628(["+code"],"Control-m"),"Toggle mulitline mode"]]),"Type ",clickable$2301("next")," to continue with the tutorial"]),$2628(["card"],[$2628(["+h3"],"Basics"),$2628([],["Click on boxes like ",clickable$2301("this")," to evaluate their contents."]),$2628(["+h4"],"Strings"),$2628(["+span"],clickable_row$2302("\"hello world\"",".word","\"My name is \\\"Olivier\\\"\"")),$2628(["+h4"],"Numbers"),mktable2$1078([[$2628([],"Decimal"),clickable_row$2302("1","1.4","4.93e51")],[$2628([],"Hex"),clickable_row$2302("16rFF","16r100","16rDEADBEEF","16r0.8")],[$2628([],"Binary etc."),clickable_row$2302("2r1110","3r20","36rZAZZ")]]),$2628(["+h4"],"Function calls"),mktable2$1078([[$2628([],"Call"),clickable_row$2302("alert{\"Hello!\"}","alert with \"Hello!\"")],[$2628([],"Methods"),clickable_row$2302("\"hello\".substring{1}")]]),clickable$2301("next")," => variables"]),$2628(["card"],[$2628(["+h3"],"Variables"),$2628(["+table"],[$2628(["+tr"],$2628(["+td",["assoc","colspan",2]],[$2628(["+b"],"Declare")," a variable"])),$2628(["+tr"],[$2628(["+td"],"Read-only"),$2628(["+td"],clickable$2301("let x = 1234"))]),$2628(["+tr"],[$2628(["+td"],"Mutable"),$2628(["+td"],clickable$2301("var x = 1234"))]),$2628(["+tr"],[$2628(["+td"],[$2628(["+b"],"Set")," a variable"]),$2628(["+td"],clickable$2301("x = 1234"))])]),$2628([],["Attempting to set a variable that has not been declared"," will create a ",$2628(["+b"],"read-only")," variable in the local scope."]),$2628([],[$2628(["+b"],"Note:")," as a convenience, all variables declared interactively"," in the top scope are in fact mutable."]),$2628([],["You can create blocks with their own local variables using ",$2628(["+code"],"[]"),", ",$2628(["+code"],"let")," or ",$2628(["+code"],"where")]),$2628([],clickable$2301("[let a = 10, let b = 90, a + b]")),$2628([],clickable$2301("let [a = 10, b = 90]: a + b")),$2628([],clickable$2301("a + b where\n   a = 10\n   b = 90")),$2628([],["Be aware that ",$2628(["+code"],"[]")," only creates a block"," when it encloses more than one expression."]),$2628([],["An indented block is completely equivalent to ","wrapping it in ",$2628(["+code"],"[]"),"s"]),clickable$2301("next")," => data structures"]),$2628(["card"],[$2628(["+h3"],"Data structures"),$2628([],["Earl Grey uses curly braces ",$2628(["+code"],"{}")," to define all data structures."]),mktable2$1078([[$2628([],"Arrays"),clickable_row$2302("{1, 2, 3}","{1, {2, 3}}","{\"hello\"}")],[$2628([],"Objects"),clickable_row$2302("{name = .Peter, age = 20}","{\"a\" => 123}")]]),$2628([],["The empty array is ",clickable$2301("{}")," and the empty object is ",clickable$2301("{=}")]),$2628(["+h4"],"Deconstruction"),$2628([],"You can extract array elements and object fields into variables directly."),$2628([],clickable$2301("{x, y} = {11, 22}")),$2628([],clickable$2301("{x, *rest, y} = {111, 222, 333, 444}")),$2628([],clickable$2301("{=> name} = {name = .Peter, age = 20}")),$2628(["+h4"],"Operations"),mktable2$1078([[$2628([],"Concatenation"),clickable$2301("{1, 2} ++ {3, 4, 5}")],[$2628([],"Object fusion"),clickable$2301("{name = .Kim} & {age = 39}")]]),clickable$2301("next")," => control structures"]),$2628(["card"],[$2628(["+h3"],"Control structures"),$2628([],[$2628(["+code"],"if")," and ",$2628(["+code"],"while")," are available."]),$2628([],clickable$2301("if [13 > 0]:\n   then: \"This number is positive!\"\n   else: \"This number is negative!\"\n")),$2628([],clickable$2301("i = 3\nwhile [i > 0]:\n   alert{i}\n   i--\n")),$2628([],["Notice that both branches of ",$2628(["+code"],"if")," must be nested."," The expression form of ",$2628(["+code"],"if")," is simply ",clickable$2301("if{1, .yes, .no}")]),clickable$2301("next")," => control structures [2]"]),$2628(["card"],[$2628(["+h3"],"Control structures [2]"),$2628([],["Earl Grey's ",$2628(["+code"],"if")," nests poorly, so if you want to ","write many clauses use ",$2628(["+code"],"match")]),$2628([],clickable$2301("x = 13\nmatch:\n   when x > 0 -> .positive\n   when x < 0 -> .negative\n   when x == 0 -> .zero\n")),$2628([],"You can also match on the variable directly!"),$2628([],clickable$2301("x = 13\nmatch x:\n   > 0 -> .positive\n   < 0 -> .negative\n   0 -> .zero\n")),$2628([],["The left hand side of the arrow is a special pattern matching"," language, whereas ",$2628(["+code"],"when")," takes a standard expression."]),clickable$2301("next")," => each"]),$2628(["card"],[$2628(["+h3"],"each"),$2628([],["A single operator serves both looping over data structures"," and list comprehensions."]),$2628([],clickable$2301("{1, 2, 3} each i -> -i")),$2628([],clickable$2301("1..10 each i -> i * i")),$2628([],clickable$2301("1..10 each i when i mod 2 == 0 -> i")),$2628([],"You can have more than one clause"),$2628([],clickable$2301("{1, 2, .hello, 4, 72, 99, {}} each\n   String? s -> {s, .string}\n   Number? i when i mod 2 == 0 -> {i, .even}\n   Number? i when i mod 2 == 1 -> {i, .odd}\n   x -> {x, .dunno}\n")),$2628([],[$2628(["+code"],"first")," and ",$2628(["+code"],"last")," are special patterns"]),$2628([],clickable$2301("acc = \"\"\n{.a, .b, .c, .d} each\n   first x -> acc += \"[\" + x\n   last x -> acc += \", \" + x + \"]\"\n   x -> acc += \", \" + x\nacc\n")),$2628([],"Be careful to put the catchall clause last."),clickable$2301("next")," => functions"]),$2628(["card"],[$2628(["+h3"],"Functions"),$2628([],["Functions are declared with ",$2628(["+code"],"=")," or ",$2628(["+code"],"->"),". For instance the following are equivalent"]),$2628([],clickable$2301("f{x, y} = [x * x + y * y] ** 0.5")),$2628([],clickable$2301("f = {x, y} -> [x * x + y * y] ** 0.5")),$2628([],"It works inside object definitions as well, of course"),$2628([],clickable$2301("{add1{x} = x + 1, add2{x} = x + 2}")),$2628([],["Pattern matching is deeply integrated in Earl Grey. ","For instance:"]),$2628([],clickable$2301("fact{match} =\n   0 or 1 -> 1\n   n -> n * fact{n - 1}\n")),clickable$2301("next")," => type checking and coercion"]),$2628(["card"],[$2628(["+h3"],"Type checking and coercion"),mktable2$1078([[$2628([],"Type checking"),clickable_row$2302("String? .hello","Number? 1","Array? .nope","R\"x$\"? .simplex")],[$2628([],"Coercion"),clickable_row$2302("String! {1, 2}","Number! \"3.14\"","Array! .yep")]]),$2628([],["Both type checking and coercion can be used in patterns."," Observe the difference in behavior of the following functions "," (try on ",clickable$2301("f{1, \"2\"}"),")"]),$2628([],clickable$2301("f{x, y} = x + y")),$2628([],clickable$2301("f{Number? x, Number? y} = x + y")),$2628([],clickable$2301("f{Number! x, Number! y} = x + y")),$2628([],["Functions naturally act as coercers: ",clickable$2301("parseInt! x = \"99\"")]),$2628(["+h4"],"Predicates"),$2628([],["You can create your own predicates with the ",$2628(["+code"],"predicate")," builtin"]),$2628([],clickable$2301("predicate! even{x} = x mod 2 == 0")),$2628([],clickable_row$2302("even? x = 1","even? x = 2")),clickable$2301("next")," => classes"]),$2628(["card"],[$2628(["+h3"],"Classes"),$2628([],["Classes are declared with the ",$2628(["+code"],"class")," macro. As a convenience, @ can be used to"," refer to fields and members of the instance."]),$2628([],clickable$2301("class Person:\n   constructor{name, age, job} =\n      @name = name\n      @age = age\n      @job = job\n   hello{} =\n      \"Hello, I am \" + @name + \", \" + @age + \", and I am a \" + @job\n")),$2628([],["The ",$2628(["+code"],"new")," keyword is optional."," I prefer to avoid it."]),$2628([],clickable$2301("Person{.Sonia, 25, .baker}")),$2628([],clickable$2301("Person{.Jack, 56, \"serial murderer\"}.hello{}")),clickable$2301("next")," => HTML generation"]),$2628(["card"],[$2628(["+h3"],"Here, let's have some fun"),$2628([],["The ",$2628(["+code"],"%")," operator creates structured data"," which is directly translated as HTML."]),$2628([],clickable_row$2302("b % .hello","i % .hello")),$2628([],"We can print out a multiplication table!"),$2628([],clickable_row$2302("table % 1..10 each i ->\n   tr % 1..10 each j ->\n      td % i * j\n"))]),$2628(["card"],[$2628(["+h3"],"The end"),$2628([],["This is the end of this humble tutorial,"," but you can keep messing around with the language,"," it's a lot of fun :)"])])];});;(exports["Repl"]=Repl$1082);(exports["Interactor"]=kb$1062.Interactor);(exports["parse"]=parse$1073);(exports["tokenize"]=tokenize$1071);(exports["Source"]=eg$1063.Source);(exports["make_cards"]=make_cards$1083);

},{"../lib/earl-grey":4,"../lib/lex":6,"../lib/location":7,"../lib/parse":9,"../lib/util":14,"./kb":1}],"repl":[function(require,module,exports){
module.exports=require('eXk3/i');
},{}],4:[function(require,module,exports){
var $185=function(type$187){var f$190;(f$190=type$187["::check"]);;if((f$190===(void 0))){return function(value$195){return (value$195 instanceof type$187);};}else{return function(value$198){return f$190.call(type$187,value$198);};}};
var $200=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $201=function(dest$203,values$204){var k$209;(k$209=null);$207:for(k$209 in values$204){if(values$204.hasOwnProperty(k$209)){(dest$203[k$209]=values$204[k$209]);}}return dest$203;};
var $213=function($214$216){var ph$220;(ph$220=$214$216);;var $218$225;($218$225=ph$220);;var bridge$219$230;var x$234;(bridge$219$230=$218$225);if((((typeof(bridge$219$230)==="string")&&((x$234=bridge$219$230),true))||((typeof(bridge$219$230)==="number")&&((x$234=bridge$219$230),true)))){return ["value",x$234];}else{var other$241;(other$241=$218$225);return other$241["::serialize_ast"]();}};
var send$25;(send$25=function(obj$30,$28$31){var ph$35;var msg$36;var t0$38;(t0$38=$28$31);(msg$36=t0$38);(ph$35=t0$38);;var $33$42;($33$42=ph$35);;var bridge$34$47;(bridge$34$47=$33$42);if(((typeof(bridge$34$47)==="string")||(typeof(bridge$34$47)==="number"))){return obj$30[msg$36];}else{var other$55;(other$55=$33$42);return obj$30["::send"](msg$36);}});;(Array[":::project"]=function($58$60){var ph$63;var value$64;var t0$66;(t0$66=$58$60);(value$64=t0$66);(ph$63=t0$66);;var $62$70;($62$70=ph$63);;if($185(Array)($62$70)){return [true,value$64];}else{$62$70;return [true,[value$64]];}});(Array.prototype["::check"]=function(value$84){if((value$84 instanceof Array)){var i$89;(i$89=0);;$87:for(;(i$89<this.length);(i$89++)){if(($200(this,i$89)!==$200(value$84,i$89))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $201(this.slice(0),this);});(Array.prototype[":::project"]=function(value$100){if((value$100 instanceof Array)){var i$105;(i$105=0);;$103:for(;(i$105<this.length);(i$105++)){if(($200(this,i$105)!==$200(value$100,i$105))){return [true,[value$100]];}}return [true,value$100.slice(this.length)];}else{return [true,[value$100]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($213));});(RegExp.prototype["::check"]=function($115$117){var ph$120;(ph$120=$115$117);;var $119$125;($119$125=ph$120);;var value$133;if((typeof($119$125)==="string")){(value$133=$119$125);if(value$133.match(this)){return true;}else{return false;}}else{var other$138;(other$138=$119$125);return false;}});(RegExp.prototype[":::project"]=function($140$142){var ph$145;(ph$145=$140$142);;var $144$150;($144$150=ph$145);;var value$158;if((typeof($144$150)==="string")){(value$158=$144$150);var $161$163;($161$163=value$158.match(this));;var m$171;if(($161$163===null)){(m$171=$161$163);return [false,null];}else{var m$176;(m$176=$161$163);return [true,m$176];}}else{var other$180;(other$180=$144$150);return [false,null];}});(Function.prototype["::send"]=function(args$183){return this.apply(this,args$183);});
var $744=function(arr$746){var results$750;var l$751;(results$750=[]);;(l$751=arr$746.length);;var i$759;(i$759=0);;$749:for(;(i$759<l$751);(i$759++)){results$750.push([i$759,$200(arr$746,i$759)]);}return results$750;};
var $575=function(){var $576$578;($576$578=function(tags$582){var it$0$585;(it$0$585=function(){if((!$185($576$578)(this))){return Object.create($576$578.prototype);}else{return this;}}());;(it$0$585["tags"]=tags$582);return it$0$585;});;($576$578.prototype["create"]=function(){var $594$596;($594$596=arguments);;var t0$601;var message$605;var args$606;(t0$601=$594$596.length);if((t0$601>=0)){(message$605=function(){if((0>=t0$601)){return "";}else{return $594$596[0];}}());(args$606=Array.prototype.slice.call($594$596,1));var it$0$610;(it$0$610=this);;var self$615;(self$615=this);;var e$620;(e$620=Error(message$605));;(e$620["::tags"]=it$0$610.tags);(e$620["args"]=args$606);var temp$628;(temp$628=$744(args$606));;var $length$633;($length$633=temp$628.length);;var $index$638;($index$638=0);;$621:for(;($index$638<$length$633);($index$638++)){var m$646;(m$646=temp$628[$index$638]);;var t0$651;var t1$652;var i$656;var arg$657;(t0$651=m$646);if(((t0$651 instanceof Array)&&((t1$652=t0$651.length),(t1$652===2)))){(i$656=t0$651[0]);(arg$657=t0$651[1]);(e$620[i$656]=arg$657);}else{$562(m$646);;}}(e$620["length"]=args$606.length);(e$620["name"]=["E"].concat(it$0$610.tags).join("."));return e$620;}else{$562($594$596);}});($576$578.prototype["::check"]=function(e$668){var it$0$671;(it$0$671=this);;var self$676;(self$676=this);;var tags$681;if(((!e$668)||(!$185(Error)(e$668)))){return false;}(tags$681=(e$668["::tags"]||[]));;var temp$690;(temp$690=it$0$671.tags);;var $length$695;($length$695=temp$690.length);;var $index$700;($index$700=0);;$682:for(;($index$700<$length$695);($index$700++)){var m$708;(m$708=temp$690[$index$700]);;var tag$716;(tag$716=m$708);if((tags$681.indexOf(tag$716)===-1)){return false;}else{false;;}}return true;});($576$578.prototype["::deconstruct"]=function(e$724){var it$0$727;(it$0$727=this);;var self$732;(self$732=this);;return e$724.args;});$201($576$578,$201(function(){var accum$737;(accum$737=({}));(accum$737["::name"]="$576");return accum$737;}(),function(){var accum$741;(accum$741=({}));(accum$741["::egclass"]=true);return accum$741;}()));return $576$578;}();
var $562=function(value$564,url$565,start$566,end$567){var err$570;(err$570=$575(["match"]).create("Could not find a match for value",({"value":value$564})));;if(url$565){(err$570["location"]=["location",url$565,start$566,end$567]);}throw err$570;};
var $766=function($767$769,key$770){var ph$774;(ph$774=$767$769);;var $772$779;($772$779=ph$774);;var bridge$773$784;(bridge$773$784=$772$779);if(((bridge$773$784===null)||(bridge$773$784===(void 0)))){return false;}else{var x$792;if((typeof($772$779)==="string")){(x$792=$772$779);return (key$770 in String.prototype);}else{var x$797;if((typeof($772$779)==="number")){(x$797=$772$779);return (key$770 in Number.prototype);}else{var x$802;(x$802=$772$779);return (key$770 in x$802);}}}};
var $804=function(obj$806){var results$810;(results$810=[]);;var k$815;(k$815=null);$809:for(k$815 in obj$806){if(Object.prototype.hasOwnProperty.call(obj$806,k$815)){results$810.push([k$815,$200(obj$806,k$815)]);}}return results$810;};var accum$554;var accum$558;var $245$252;var Source$253;var Location$254;var highlight_locations$255;var $246$256;var tokenize$257;var $247$258;var parse$259;var $248$260;var translate$261;var Translator$262;var std$263;var exp$264;var opt$265;var generate_from_ast$266;var generate$267;var Generator$268;($245$252=require("./location"));;(Source$253=$245$252.Source);;(Location$254=$245$252.Location);;(highlight_locations$255=$245$252.highlight_locations);;($246$256=require("./lex"));;(tokenize$257=$246$256.tokenize);;($247$258=require("./parse"));;(parse$259=$247$258.parse);;($248$260=require("./translate-js"));;(translate$261=$248$260.translate);;(Translator$262=$248$260.Translator);;(std$263=require("./stdenv"));;(exp$264=require("./expand"));;(opt$265=require("./opt"));;(generate_from_ast$266=function(ast$314){var ex$317;var tr$318;var rval$319;(ex$317=std$263.expand(["top"],std$263.topscope,std$263.stdenv.fork().convert(["multi",ast$314])));;(ex$317=opt$265.hoist(ex$317));(tr$318=Translator$262());;(rval$319=tr$318.translate(ex$317,"expr"));;return [tr$318.dump_store(),rval$319];});;std$263.stdenv.bind(std$263.topscope,"macro",["macro",function(context$332,scope$333,form$334,$330$335){var t0$374;var t1$375;var prep$369;var code$370;var mac$371;var mac2$372;var name$356;var sym$357;var arguments$358;var ast$359;var t0$348;var t1$349;var t2$350;var t3$351;var t4$352;var $337$343;var ph$338;(ph$338=$330$335);;($337$343=ph$338);;if((($337$343 instanceof Array)&&((t0$348=$337$343.length),((t0$348===3)&&(($337$343[0]==="data")&&((t1$349=$337$343[1]),((t1$349 instanceof Array)&&((t2$350=t1$349.length),((t2$350===3)&&((t1$349[0]==="send")&&((t3$351=t1$349[1]),((name$356=t3$351),((t3$351 instanceof Array)&&((t4$352=t3$351.length),((t4$352===2)&&(t3$351[0]==="symbol")))))))))))))))){(sym$357=t3$351[1]);(arguments$358=t1$349[2]);(ast$359=$337$343[2]);(t0$374=generate_from_ast$266(["send",["symbol","->"],["data",arguments$358,ast$359]]));if(((t0$374 instanceof Array)&&((t1$375=t0$374.length),(t1$375===2)))){(prep$369=t0$374[0]);(code$370=t0$374[1]);;}else{$562(generate_from_ast$266(["send",["symbol","->"],["data",arguments$358,ast$359]]),"/home/olivier/git/earl-grey/src/earl-grey.eg",798,848);}(mac$371=eval((prep$369+((";("+code$370)+")"))));;(mac2$372=function(c$386,s$387,f$388,e$389){var env$392;var r$393;(env$392=scope$333.expander.mkenv());;env$392.bind(scope$333,sym$357,["macro",mac2$372]);(r$393=mac$371(c$386,s$387,f$388,e$389));;return env$392.convert(r$393);});;return ["declare_raw",name$356,["macro",mac2$372]];}else{$562($337$343);}}]);std$263.stdenv.bind(std$263.topscope,"macros",["macro",function(context$406,scope$407,$403$408,$404$409){var t0$414;var t0$419;var t1$420;var t0$430;var t1$431;var $index$458;var $length$453;var temp$448;var acc$443;var prep$426;var code$427;var the_macros$428;var env$411;var body$412;(t0$414=$403$408);if($766(t0$414,"env")){(env$411=t0$414.env);;}else{$562($403$408);}(t0$419=$404$409);if(((t0$419 instanceof Array)&&((t1$420=t0$419.length),((t1$420===2)&&(t0$419[0]==="data"))))){(body$412=t0$419[1]);;}else{$562($404$409);}(t0$430=generate_from_ast$266(body$412));if(((t0$430 instanceof Array)&&((t1$431=t0$430.length),(t1$431===2)))){(prep$426=t0$430[0]);(code$427=t0$430[1]);;}else{$562(generate_from_ast$266(body$412),"/home/olivier/git/earl-grey/src/earl-grey.eg",1358,1388);}(the_macros$428=eval((((prep$426+";(")+code$427)+")")));;return ["splice"].concat((((acc$443=[])),(((temp$448=$804(the_macros$428))),((($length$453=temp$448.length)),((($index$458=0)),function(){$440:for(;($index$458<$length$453);($index$458++)){var k$476;var v$477;var t0$471;var t1$472;var m$466;(m$466=temp$448[$index$458]);;(t0$471=m$466);if(((t0$471 instanceof Array)&&((t1$472=t0$471.length),(t1$472===2)))){(k$476=t0$471[0]);(v$477=t0$471[1]);acc$443.push(["declare_raw",$201(["symbol",k$476],({"env":env$411})),["macro",v$477]]);}else{$562(m$466,"/home/olivier/git/earl-grey/src/earl-grey.eg",1458,1565);;}}}()))),acc$443));}]);(generate$267=function(source$486){return Generator$268().generate(source$486);});;(Generator$268=function(){var it$0$507;var interactive$503;var t0$499;var $492$494;($492$494=arguments);;(t0$499=$492$494.length);if(((t0$499>=0)&&(t0$499<=1))){(interactive$503=function(){if((0>=t0$499)){return false;}else{return $492$494[0];}}());(it$0$507=function(){if((!$185(Generator$268)(this))){return Object.create(Generator$268.prototype);}else{return this;}}());;(it$0$507["tr"]=Translator$262(std$263.stdprelude));(it$0$507["env"]=std$263.stdenv.fork());(it$0$507["interactive"]=interactive$503);return it$0$507;}else{$562($492$494);}});;(Generator$268.prototype["generate"]=function(source$519){var stmt$545;var t$532;var p$533;var ex$534;var rval$535;var self$527;var it$0$522;(it$0$522=this);;(self$527=this);;(t$532=tokenize$257(source$519));;(p$533=parse$259(t$532));;(ex$534=(((stmt$545=function(){if(it$0$522.interactive){return ["interactive",p$533];}else{return ["multi",p$533];}}())),std$263.expand(["top"],std$263.topscope,it$0$522.env.convert(stmt$545))));;(ex$534=opt$265.hoist(ex$534));(rval$535=it$0$522.tr.translate(ex$534,"stmt"));;return (it$0$522.tr.dump_store()+rval$535);});$201(Generator$268,$201(((accum$554=({})),((accum$554["::name"]="Generator"),accum$554)),((accum$558=({})),((accum$558["::egclass"]=true),accum$558))));Generator$268;(exports["Source"]=Source$253);(exports["Location"]=Location$254);(exports["highlight_locations"]=highlight_locations$255);(exports["tokenize"]=tokenize$257);(exports["parse"]=parse$259);(exports["Generator"]=Generator$268);(exports["generate"]=generate$267);

},{"./expand":5,"./lex":6,"./location":7,"./opt":8,"./parse":9,"./stdenv":12,"./translate-js":13}],5:[function(require,module,exports){
var $980=function(type$982){var f$985;(f$985=type$982["::check"]);;if((f$985===(void 0))){return function(value$990){return (value$990 instanceof type$982);};}else{return function(value$993){return f$985.call(type$982,value$993);};}};
var $995=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $996=function(dest$998,values$999){var k$1004;(k$1004=null);$1002:for(k$1004 in values$999){if(values$999.hasOwnProperty(k$1004)){(dest$998[k$1004]=values$999[k$1004]);}}return dest$998;};
var $1008=function($1009$1011){var ph$1015;(ph$1015=$1009$1011);;var $1013$1020;($1013$1020=ph$1015);;var bridge$1014$1025;var x$1029;(bridge$1014$1025=$1013$1020);if((((typeof(bridge$1014$1025)==="string")&&((x$1029=bridge$1014$1025),true))||((typeof(bridge$1014$1025)==="number")&&((x$1029=bridge$1014$1025),true)))){return ["value",x$1029];}else{var other$1036;(other$1036=$1013$1020);return other$1036["::serialize_ast"]();}};
var send$820;(send$820=function(obj$825,$823$826){var ph$830;var msg$831;var t0$833;(t0$833=$823$826);(msg$831=t0$833);(ph$830=t0$833);;var $828$837;($828$837=ph$830);;var bridge$829$842;(bridge$829$842=$828$837);if(((typeof(bridge$829$842)==="string")||(typeof(bridge$829$842)==="number"))){return obj$825[msg$831];}else{var other$850;(other$850=$828$837);return obj$825["::send"](msg$831);}});;(Array[":::project"]=function($853$855){var ph$858;var value$859;var t0$861;(t0$861=$853$855);(value$859=t0$861);(ph$858=t0$861);;var $857$865;($857$865=ph$858);;if($980(Array)($857$865)){return [true,value$859];}else{$857$865;return [true,[value$859]];}});(Array.prototype["::check"]=function(value$879){if((value$879 instanceof Array)){var i$884;(i$884=0);;$882:for(;(i$884<this.length);(i$884++)){if(($995(this,i$884)!==$995(value$879,i$884))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $996(this.slice(0),this);});(Array.prototype[":::project"]=function(value$895){if((value$895 instanceof Array)){var i$900;(i$900=0);;$898:for(;(i$900<this.length);(i$900++)){if(($995(this,i$900)!==$995(value$895,i$900))){return [true,[value$895]];}}return [true,value$895.slice(this.length)];}else{return [true,[value$895]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($1008));});(RegExp.prototype["::check"]=function($910$912){var ph$915;(ph$915=$910$912);;var $914$920;($914$920=ph$915);;var value$928;if((typeof($914$920)==="string")){(value$928=$914$920);if(value$928.match(this)){return true;}else{return false;}}else{var other$933;(other$933=$914$920);return false;}});(RegExp.prototype[":::project"]=function($935$937){var ph$940;(ph$940=$935$937);;var $939$945;($939$945=ph$940);;var value$953;if((typeof($939$945)==="string")){(value$953=$939$945);var $956$958;($956$958=value$953.match(this));;var m$966;if(($956$958===null)){(m$966=$956$958);return [false,null];}else{var m$971;(m$971=$956$958);return [true,m$971];}}else{var other$975;(other$975=$939$945);return [false,null];}});(Function.prototype["::send"]=function(args$978){return this.apply(this,args$978);});
var $3254=function(arr$3256){var results$3260;var l$3261;(results$3260=[]);;(l$3261=arr$3256.length);;var i$3269;(i$3269=0);;$3259:for(;(i$3269<l$3261);(i$3269++)){results$3260.push([i$3269,$995(arr$3256,i$3269)]);}return results$3260;};
var $3085=function(){var $3086$3088;($3086$3088=function(tags$3092){var it$0$3095;(it$0$3095=function(){if((!$980($3086$3088)(this))){return Object.create($3086$3088.prototype);}else{return this;}}());;(it$0$3095["tags"]=tags$3092);return it$0$3095;});;($3086$3088.prototype["create"]=function(){var $3104$3106;($3104$3106=arguments);;var t0$3111;var message$3115;var args$3116;(t0$3111=$3104$3106.length);if((t0$3111>=0)){(message$3115=function(){if((0>=t0$3111)){return "";}else{return $3104$3106[0];}}());(args$3116=Array.prototype.slice.call($3104$3106,1));var it$0$3120;(it$0$3120=this);;var self$3125;(self$3125=this);;var e$3130;(e$3130=Error(message$3115));;(e$3130["::tags"]=it$0$3120.tags);(e$3130["args"]=args$3116);var temp$3138;(temp$3138=$3254(args$3116));;var $length$3143;($length$3143=temp$3138.length);;var $index$3148;($index$3148=0);;$3131:for(;($index$3148<$length$3143);($index$3148++)){var m$3156;(m$3156=temp$3138[$index$3148]);;var t0$3161;var t1$3162;var i$3166;var arg$3167;(t0$3161=m$3156);if(((t0$3161 instanceof Array)&&((t1$3162=t0$3161.length),(t1$3162===2)))){(i$3166=t0$3161[0]);(arg$3167=t0$3161[1]);(e$3130[i$3166]=arg$3167);}else{$3072(m$3156);;}}(e$3130["length"]=args$3116.length);(e$3130["name"]=["E"].concat(it$0$3120.tags).join("."));return e$3130;}else{$3072($3104$3106);}});($3086$3088.prototype["::check"]=function(e$3178){var it$0$3181;(it$0$3181=this);;var self$3186;(self$3186=this);;var tags$3191;if(((!e$3178)||(!$980(Error)(e$3178)))){return false;}(tags$3191=(e$3178["::tags"]||[]));;var temp$3200;(temp$3200=it$0$3181.tags);;var $length$3205;($length$3205=temp$3200.length);;var $index$3210;($index$3210=0);;$3192:for(;($index$3210<$length$3205);($index$3210++)){var m$3218;(m$3218=temp$3200[$index$3210]);;var tag$3226;(tag$3226=m$3218);if((tags$3191.indexOf(tag$3226)===-1)){return false;}else{false;;}}return true;});($3086$3088.prototype["::deconstruct"]=function(e$3234){var it$0$3237;(it$0$3237=this);;var self$3242;(self$3242=this);;return e$3234.args;});$996($3086$3088,$996(function(){var accum$3247;(accum$3247=({}));(accum$3247["::name"]="$3086");return accum$3247;}(),function(){var accum$3251;(accum$3251=({}));(accum$3251["::egclass"]=true);return accum$3251;}()));return $3086$3088;}();
var $3072=function(value$3074,url$3075,start$3076,end$3077){var err$3080;(err$3080=$3085(["match"]).create("Could not find a match for value",({"value":value$3074})));;if(url$3075){(err$3080["location"]=["location",url$3075,start$3076,end$3077]);}throw err$3080;};
var $3276=function($3277$3279,key$3280){var ph$3284;(ph$3284=$3277$3279);;var $3282$3289;($3282$3289=ph$3284);;var bridge$3283$3294;(bridge$3283$3294=$3282$3289);if(((bridge$3283$3294===null)||(bridge$3283$3294===(void 0)))){return false;}else{var x$3302;if((typeof($3282$3289)==="string")){(x$3302=$3282$3289);return (key$3280 in String.prototype);}else{var x$3307;if((typeof($3282$3289)==="number")){(x$3307=$3282$3289);return (key$3280 in Number.prototype);}else{var x$3312;(x$3312=$3282$3289);return (key$3280 in x$3312);}}}};
var $3314=function(obj$3316){var results$3320;(results$3320=[]);;var k$3325;(k$3325=null);$3319:for(k$3325 in obj$3316){if(Object.prototype.hasOwnProperty.call(obj$3316,k$3325)){results$3320.push([k$3325,$995(obj$3316,k$3325)]);}}return results$3320;};
var $3329=function(type$3331){return function(value$3334){var f$3337;(f$3337=type$3331[":::project"]);;if((f$3337===(void 0))){(f$3337=type$3331["::project"]);if((f$3337===(void 0))){return [true,type$3331(value$3334)];}else{var rval$3343;(rval$3343=false);;try{(rval$3343=[true,f$3337(value$3334)]);}catch(excv$3349){var e$3355;(e$3355=excv$3349);(rval$3343=[false,null]);}return rval$3343;}}else{return f$3337.call(type$3331,value$3334);}};};var accum$1263;var accum$1267;var accum$1556;var accum$1560;var accum$2953;var accum$2957;var $1040$1044;var __lt____gt__$1045;var $1041$1046;var __lt____lt____colon__$1047;var util$1048;var classify$1049;var neighbours$1050;var GenSym$1051;var gensym$1052;var uuid$1053;var $1043$1054;var PatternParser$1055;var PatternProcessor$1056;var Scope$1057;var Env$1058;var track_location$1059;var Expander$1060;var mac1$1061;var __chk_ncache$1062;var __chk_scache$1063;var checker_db$1064;($1040$1044=require("./pp"));;(__lt____gt__$1045=$1040$1044["<>"]);;($1041$1046=require("./location"));;(__lt____lt____colon__$1047=$1041$1046["<<:"]);;(util$1048=require("./util"));;(classify$1049=util$1048.classify);;(neighbours$1050=util$1048.neighbours);;(GenSym$1051=util$1048.GenSym);;(gensym$1052=util$1048.gensym);;(uuid$1053=util$1048.uuid);;($1043$1054=require("./pattern"));;(PatternParser$1055=$1043$1054.PatternParser);;(PatternProcessor$1056=$1043$1054.PatternProcessor);;(Scope$1057=function(){var it$0$1124;var parent$1118;var name$1119;var expander$1120;var t0$1114;var $1107$1109;($1107$1109=arguments);;(t0$1114=$1107$1109.length);if(((t0$1114>=0)&&(t0$1114<=3))){(parent$1118=function(){if((0>=t0$1114)){return null;}else{return $1107$1109[0];}}());(name$1119=function(){if((1>=t0$1114)){return null;}else{return $1107$1109[1];}}());(expander$1120=function(){if((2>=t0$1114)){return null;}else{return $1107$1109[2];}}());(it$0$1124=function(){if((!$980(Scope$1057)(this))){return Object.create(Scope$1057.prototype);}else{return this;}}());;(it$0$1124["name"]=(name$1119||gensym$1052("scope")));(it$0$1124["parent"]=parent$1118);(it$0$1124["options"]=({}));(it$0$1124["expander"]=(expander$1120||parent$1118.expander));return it$0$1124;}else{$3072($1107$1109);}});;(Scope$1057.prototype["getopt"]=function(opt$1136){var otherwise$1168;var $1145$1157;var $1144$1151;var self$1146;var it$0$1139;(it$0$1139=this);;(self$1146=this);;($1144$1151=null);;$1144$1151;if(Object.prototype.hasOwnProperty.call(it$0$1139.options,opt$1136)){return $995(it$0$1139.options,opt$1136);}else{if((it$0$1139.parent===null)){return (void 0);}else{(otherwise$1168=$1144$1151);return it$0$1139.parent.getopt(opt$1136);}}});(Scope$1057.prototype["setopt"]=function(opt$1173,value$1174){var self$1182;var it$0$1177;(it$0$1177=this);;(self$1182=this);;return (it$0$1177.options[opt$1173]=value$1174);});(Scope$1057.prototype["gensym"]=function(){var self$1196;var it$0$1191;(it$0$1191=this);;(self$1196=this);;return it$0$1191.expander.gensym();});(Scope$1057.prototype["step"]=function(context$1203,expr$1204){var self$1212;var it$0$1207;(it$0$1207=this);;(self$1212=this);;return it$0$1207.expander.step(context$1203,it$0$1207,expr$1204);});(Scope$1057.prototype["step_all"]=function(context$1219,exprs$1220){var self$1228;var it$0$1223;(it$0$1223=this);;(self$1228=this);;return it$0$1223.expander.step_all(context$1219,it$0$1223,exprs$1220);});(Scope$1057.prototype["expand"]=function(context$1235,expr$1236){var self$1244;var it$0$1239;(it$0$1239=this);;(self$1244=this);;return it$0$1239.expander.expand(context$1235,it$0$1239,expr$1236);});(Scope$1057.prototype["toString"]=function(){var self$1258;var it$0$1253;(it$0$1253=this);;(self$1258=this);;return (("Scope{"+it$0$1253.name)+"}");});$996(Scope$1057,$996(((accum$1263=({})),((accum$1263["::name"]="Scope"),accum$1263)),((accum$1267=({})),((accum$1267["::egclass"]=true),accum$1267))));Scope$1057;(Env$1058=function(){var it$0$1275;(it$0$1275=function(){if((!$980(Env$1058)(this))){return Object.create(Env$1058.prototype);}else{return this;}}());;(it$0$1275["scopes"]=({}));return it$0$1275;});;(Env$1058.prototype["resolve"]=function(scope$1284,name$1285){var scope_data$1298;var self$1293;var it$0$1288;(it$0$1288=this);;(self$1293=this);;if((scope$1284===null)){return (void 0);}(scope_data$1298=$995(it$0$1288.scopes,scope$1284.name));;if((scope_data$1298&&Object.prototype.hasOwnProperty.call(scope_data$1298,name$1285))){return $995(scope_data$1298,name$1285);}else{return it$0$1288.resolve(scope$1284.parent,name$1285);}});(Env$1058.prototype["bind"]=function(scope$1306,name$1307,value$1308){var self$1316;var it$0$1311;(it$0$1311=this);;(self$1316=this);;if((!$995(it$0$1311.scopes,scope$1306.name))){(it$0$1311.scopes[scope$1306.name]=({}));}return ($995(it$0$1311.scopes,scope$1306.name)[name$1307]=value$1308);});(Env$1058.prototype["convert"]=function(expr$1325){var x$1369;var x$1374;var bridge$1337$1366;var x$1379;var bridge$1336$1363;var x$1384;var bridge$1335$1360;var x$1389;var $index$1416;var $length$1411;var temp$1406;var other$1436;var type$1396;var args$1397;var e$1353;var bridge$1334$1348;var t0$1349;var $1333$1343;var self$1338;var it$0$1328;(it$0$1328=this);;(self$1338=this);;($1333$1343=expr$1325);;if($3276($1333$1343,"env")){(e$1353=$1333$1343.env);return expr$1325;}else{(bridge$1334$1348=$1333$1343);if((((bridge$1335$1360=bridge$1334$1348),(((bridge$1336$1363=bridge$1335$1360),(((bridge$1337$1366=bridge$1336$1363),((((x$1369=bridge$1337$1366)),((x$1369 instanceof Array)&&(x$1369[0]==="symbol")))||(((x$1374=bridge$1337$1366)),((x$1374 instanceof Array)&&(x$1374[0]==="value")))))||(((x$1379=bridge$1336$1363)),((x$1379 instanceof Array)&&(x$1379[0]==="variable")))))||(((x$1384=bridge$1335$1360)),((x$1384 instanceof Array)&&(x$1384[0]==="macro")))))||(((x$1389=bridge$1334$1348)),((x$1389 instanceof Array)&&(x$1389[0]==="void"))))){return $996(expr$1325,({"env":it$0$1328}));}else{if((($1333$1343 instanceof Array)&&((t0$1349=$1333$1343.length),(t0$1349>=1)))){(type$1396=$1333$1343[0]);(args$1397=Array.prototype.slice.call($1333$1343,1));(temp$1406=args$1397);;($length$1411=temp$1406.length);;($index$1416=0);;$1402:for(;($index$1416<$length$1411);($index$1416++)){var arg$1432;var m$1424;(m$1424=temp$1406[$index$1416]);;(arg$1432=m$1424);it$0$1328.convert(arg$1432);}return $996(expr$1325,({"env":it$0$1328}));}else{(other$1436=$1333$1343);return $996(expr$1325,({"env":it$0$1328}));}}}});(Env$1058.prototype["fork"]=function(){var $index$1471;var $length$1466;var temp$1461;var e$1453;var self$1448;var it$0$1443;(it$0$1443=this);;(self$1448=this);;(e$1453=Env$1058());;(temp$1461=$3314(it$0$1443.scopes));;($length$1466=temp$1461.length);;($index$1471=0);;$1454:for(;($index$1471<$length$1466);($index$1471++)){var $index$1512;var $length$1507;var temp$1502;var acc$1497;var scope$1489;var bindings$1490;var t0$1484;var t1$1485;var m$1479;(m$1479=temp$1461[$index$1471]);;(t0$1484=m$1479);if(((t0$1484 instanceof Array)&&((t1$1485=t0$1484.length),(t1$1485===2)))){(scope$1489=t0$1484[0]);(bindings$1490=t0$1484[1]);(acc$1497=[]);;(temp$1502=$3314(bindings$1490));;($length$1507=temp$1502.length);;($index$1512=0);;$1494:for(;($index$1512<$length$1507);($index$1512++)){var k$1530;var v$1531;var t0$1525;var t1$1526;var m$1520;(m$1520=temp$1502[$index$1512]);;(t0$1525=m$1520);if(((t0$1525 instanceof Array)&&((t1$1526=t0$1525.length),(t1$1526===2)))){(k$1530=t0$1525[0]);(v$1531=t0$1525[1]);acc$1497.push((function(){if((!$995(e$1453.scopes,scope$1489))){return (e$1453.scopes[scope$1489]=({}));}}(),($995(e$1453.scopes,scope$1489)[k$1530]=v$1531)));}else{$3072(m$1520,"/home/olivier/git/earl-grey/src/expand.eg",2010,2169);;}}acc$1497;}else{$3072(m$1479,"/home/olivier/git/earl-grey/src/expand.eg",1970,2169);;}}return e$1453;});(Env$1058.prototype["toString"]=function(){var self$1551;var it$0$1546;(it$0$1546=this);;(self$1551=this);;return "Env{...}";});$996(Env$1058,$996(((accum$1556=({})),((accum$1556["::name"]="Env"),accum$1556)),((accum$1560=({})),((accum$1560["::egclass"]=true),accum$1560))));Env$1058;(track_location$1059=function(f$1566){var f2$1569;(f2$1569=function(context$1573,scope$1574,expr$1575){var rval$1583;var other$1615;var v$1609;var t0$1605;var $1578$1600;var rval$1579;(rval$1579=(((rval$1583=false)),(function(){try{(rval$1583=f$1566(context$1573,scope$1574,expr$1575));}catch(excv$1589){var e$1595;(e$1595=excv$1589);(rval$1583=(__lt____lt____colon__$1047(e$1595,expr$1575),function(){throw e$1595;}()));}}(),rval$1583)));;($1578$1600=rval$1579);;if((($1578$1600 instanceof Array)&&((t0$1605=$1578$1600.length),((t0$1605===2)&&($1578$1600[0]==="bounce"))))){(v$1609=$1578$1600[1]);return f2$1569(context$1573,scope$1574,__lt____lt____colon__$1047(v$1609,expr$1575));}else{(other$1615=$1578$1600);return __lt____lt____colon__$1047(other$1615,expr$1575);}});;return f2$1569;});;(Expander$1060=function(env_factory$1622,generic_nodes$1623){var it$0$1626;(it$0$1626=function(){if((!$980(Expander$1060)(this))){return Object.create(Expander$1060.prototype);}else{return this;}}());;(it$0$1626["gensym"]=gensym$1052);(it$0$1626["mkenv"]=env_factory$1622);(it$0$1626["generic_nodes"]=generic_nodes$1623);return it$0$1626;});;(Expander$1060.prototype["run_macro"]=function(m$1636,context$1637,scope$1638,form$1639,arg$1640){var rval$1657;var rval$1653;var self$1648;var it$0$1643;(it$0$1643=this);;(self$1648=this);;(rval$1653=(((rval$1657=false)),(function(){try{(rval$1657=m$1636(context$1637,scope$1638,form$1639,arg$1640));}catch(excv$1663){var msg$1696;var msg$1791;var find$1705;var err$1706;var other$1702;var $1683$1685;var e$1680;var e$1798;var value$1673;var t0$1666;var t1$1667;var t2$1668;var t3$1669;(t0$1666=excv$1663);if(($980($3085(["match"]))(t0$1666)&&($3276(t0$1666,"args")&&((t1$1667=t0$1666.args),((t1$1667 instanceof Array)&&((t2$1668=t1$1667.length),((t2$1668===1)&&((t3$1669=t1$1667[0]),$3276(t3$1669,"value"))))))))){(value$1673=t3$1669.value);(rval$1657=(((e$1680=((($1683$1685=value$1673)),function(){if(($1683$1685===context$1637)){(msg$1696="The macro cannot be found in this context.");;return $3085(["syntax","context"]).create(msg$1696,({"context":context$1637,"form":form$1639}));}else{(other$1702=$1683$1685);(find$1705=function($1709$1711){var t0$1717;var msg$1733;var $index$1759;var $length$1754;var temp$1749;var other$1784;var type$1739;var xs$1740;var t0$1726;var $1713$1721;var ph$1714;var arg$1715;(t0$1717=$1709$1711);(arg$1715=t0$1717);(ph$1714=t0$1717);;($1713$1721=ph$1714);;if(($1713$1721===value$1673)){(msg$1733="The macro could not match its argument (or part of it).");;return $3085(["syntax","argument"]).create(msg$1733,({"context":context$1637,"argument":arg$1715,"form":form$1639}));}else{if((($1713$1721 instanceof Array)&&((t0$1726=$1713$1721.length),(t0$1726>=1)))){(type$1739=$1713$1721[0]);(xs$1740=Array.prototype.slice.call($1713$1721,1));(temp$1749=xs$1740);;($length$1754=temp$1749.length);;($index$1759=0);;$1745:for(;($index$1759<$length$1754);($index$1759++)){var x$1776;var t0$1772;var m$1767;(m$1767=temp$1749[$index$1759]);;(t0$1772=$3329(find$1705)(m$1767));if(t0$1772[0]){(x$1776=t0$1772[1]);if(x$1776){return x$1776;}}else{$3072(m$1767,"/home/olivier/git/earl-grey/src/expand.eg",3447,3532);;}}return false;}else{(other$1784=$1713$1721);return false;}}});;(err$1706=find$1705(arg$1640));;if(err$1706){return err$1706;}else{(msg$1791="The macro failed because it failed to match some value, probably one that it generated itself.");;return $3085(["syntax","failure"]).create(msg$1791,({"form":form$1639,"value":value$1673}));}}}()))),function(){throw e$1680;}()));}else{(e$1798=excv$1663);(rval$1657=function(){throw e$1798;}());}}}(),rval$1657)));;return it$0$1643.mkenv().convert(rval$1653);});(Expander$1060.prototype["step"]=function(context$1804,scope$1805,expr$1806){var helper$1819;var self$1814;var it$0$1809;(it$0$1809=this);;(self$1814=this);;(helper$1819=track_location$1059(function(context$1824,scope$1825,$1822$1826){var t0$1835;var other$1875;var env$1870;var $1860$1862;var other$1908;var t0$1899;var $1892$1894;var other$1912;var m$1888;var t0$1884;var $1856$1879;var env$1857;var other$1935;var t0$1926;var $1919$1921;var other$1960;var m$1954;var t0$1950;var $1943$1945;var other$1969;var x$1964;var f$1939;var arg$1940;var m$1916;var s$1851;var $1829$1846;var $1830$1847;var $1831$1848;var t0$1844;var $1828$1839;var ph$1832;var expr$1833;(t0$1835=$1822$1826);(expr$1833=t0$1835);(ph$1832=t0$1835);;($1828$1839=ph$1832);;if((($1829$1846=($1828$1839 instanceof Array))&&((t0$1844=$1828$1839.length),(($1831$1848=(t0$1844===2))&&($1828$1839[0]==="symbol"))))){(s$1851=$1828$1839[1]);(env$1857=((($1860$1862=expr$1833)),function(){if($3276($1860$1862,"env")){(env$1870=$1860$1862.env);return expr$1833.env;}else{(other$1875=$1860$1862);throw $3085(["syntax","no_env"]).create("No environment was found to resolve",({"symbol":expr$1833}));}}()));;($1856$1879=env$1857.resolve(scope$1825,s$1851));;if((($1856$1879 instanceof Array)&&((t0$1884=$1856$1879.length),((t0$1884===2)&&($1856$1879[0]==="macro"))))){(m$1888=$1856$1879[1]);($1892$1894=context$1824);;if((($1892$1894 instanceof Array)&&((t0$1899=$1892$1894.length),((t0$1899===2)&&(($1892$1894[0]==="expr")&&($1892$1894[1]==="head")))))){return ["macro",m$1888];}else{(other$1908=$1892$1894);return ["bounce",it$0$1809.run_macro(m$1888,context$1824,scope$1825,expr$1833,__lt____lt____colon__$1047(["void"],expr$1833))];}}else{(other$1912=$1856$1879);return expr$1833;}}else{if(($1831$1848&&($1828$1839[0]==="macro"))){(m$1916=$1828$1839[1]);($1919$1921=context$1824);;if((($1919$1921 instanceof Array)&&((t0$1926=$1919$1921.length),((t0$1926===2)&&(($1919$1921[0]==="expr")&&($1919$1921[1]==="head")))))){return expr$1833;}else{(other$1935=$1919$1921);return ["bounce",it$0$1809.run_macro(m$1916,context$1824,scope$1825,expr$1833,__lt____lt____colon__$1047(["void"],expr$1833))];}}else{if(($1829$1846&&((t0$1844===3)&&($1828$1839[0]==="send")))){(f$1939=$1828$1839[1]);(arg$1940=$1828$1839[2]);($1943$1945=helper$1819(["expr","head"],scope$1825,f$1939));;if((($1943$1945 instanceof Array)&&((t0$1950=$1943$1945.length),((t0$1950===2)&&($1943$1945[0]==="macro"))))){(m$1954=$1943$1945[1]);return ["bounce",it$0$1809.run_macro(m$1954,context$1824,scope$1825,expr$1833,arg$1940)];}else{(other$1960=$1943$1945);return expr$1833;}}else{if(($1829$1846&&((t0$1844===2)&&($1828$1839[0]==="nostep")))){(x$1964=$1828$1839[1]);return x$1964;}else{(other$1969=$1828$1839);return expr$1833;}}}}}));;return helper$1819(context$1804,scope$1805,expr$1806);});(Expander$1060.prototype["step_all"]=function(context$1976,scope$1977,$1974$1978){var t0$1982;var t1$1983;var pre$1999;var bulk$2000;var post$2001;var self$1994;var it$0$1989;var stmts$1980;(t0$1982=$1974$1978);if(((t0$1982 instanceof Array)&&((t1$1983=t0$1982.length),(t1$1983>=0)))){(stmts$1980=Array.prototype.slice.call(t0$1982,0));;}else{$3072($1974$1978);}(it$0$1989=this);;(self$1994=this);;(pre$1999=[]);;(bulk$2000=[]);;(post$2001=[]);;$2011:while(stmts$1980.length){var x$2057;var m$2052;var stmt$2047;var stmt$2042;var prepend$2036;var $2016$2031;var $2017$2032;var $2018$2033;var t0$2029;var $2015$2024;var current$2019;(current$2019=stmts$1980.shift());;($2015$2024=it$0$1989.step(context$1976,scope$1977,current$2019));;if((($2016$2031=($2015$2024 instanceof Array))&&((t0$2029=$2015$2024.length),((t0$2029>=1)&&($2015$2024[0]==="splice"))))){(prepend$2036=Array.prototype.slice.call($2015$2024,1));(stmts$1980=prepend$2036.concat(stmts$1980));}else{if(($2016$2031&&(($2018$2033=(t0$2029===2))&&($2015$2024[0]==="float")))){(stmt$2042=$2015$2024[1]);(pre$1999=pre$1999.concat(it$0$1989.step_all(context$1976,scope$1977,[stmt$2042])));}else{if(($2018$2033&&($2015$2024[0]==="sink"))){(stmt$2047=$2015$2024[1]);(post$2001=post$2001.concat(it$0$1989.step_all(context$1976,scope$1977,[stmt$2047])));}else{if(($2018$2033&&($2015$2024[0]==="multimacro"))){(m$2052=$2015$2024[1]);(stmts$1980=m$2052(context$1976,scope$1977,current$2019,stmts$1980));}else{(x$2057=$2015$2024);bulk$2000.push(x$2057);}}}}}return pre$1999.concat(bulk$2000).concat(post$2001);});(Expander$1060.prototype["expand"]=function(context$2062,scope$2063,expr$2064){var helper$2077;var self$2072;var it$0$2067;(it$0$2067=this);;(self$2072=this);;(helper$2077=track_location$1059(function(context$2081,scope$2082,expr$2083){var t0$2114;var other$2131;var $2111$2119;var env$2112;var $index$2178;var $length$2173;var temp$2168;var acc$2163;var newargs$2157;var $index$2224;var $length$2219;var temp$2214;var acc$2209;var newargs$2203;var t0$2268;var newscope$2262;var env$2263;var $index$2330;var $length$2325;var temp$2320;var acc$2315;var $index$2440;var $length$2435;var temp$2430;var acc$2425;var t0$2304;var newscope$2288;var stepscope$2289;var changes$2290;var newargs$2291;var vars$2292;var exp$2293;var $index$2708;var $length$2703;var temp$2698;var other$2782;var t0$2765;var $2758$2760;var is_obj$2619;var obj$2620;var arr$2621;var arr_parts$2622;var obj_parts$2623;var new_arr_part$2624;var new_obj_part$2625;var r$2626;var $index$2825;var $length$2820;var temp$2815;var acc$2810;var newscope$2802;var s$2885;var newscope$2894;var name$2881;var t0$2877;var $index$2929;var $length$2924;var temp$2919;var acc$2914;var other$2949;var type$2905;var args$2906;var tag$2898;var body$2899;var x$2872;var $2087$2873;var bindings$2797;var body$2798;var target$2791;var value$2792;var args$2615;var args$2284;var args$2279;var args$2274;var variable$2252;var s$2253;var value$2254;var body$2255;var args$2199;var args$2153;var f$2147;var arg$2148;var s$2106;var $2088$2101;var $2089$2102;var $2090$2103;var t0$2097;var t1$2098;var t2$2099;var $2086$2092;(expr$2083=it$0$2067.step(context$2081,scope$2082,expr$2083));($2086$2092=expr$2083);;if((($2088$2101=($2086$2092 instanceof Array))&&((t0$2097=$2086$2092.length),(($2090$2103=(t0$2097===2))&&($2086$2092[0]==="symbol"))))){(s$2106=$2086$2092[1]);(t0$2114=expr$2083);if($3276(t0$2114,"env")){(env$2112=t0$2114.env);;}else{$3072(expr$2083,"/home/olivier/git/earl-grey/src/expand.eg",7765,7769);}($2111$2119=env$2112.resolve(scope$2082,s$2106));;if(($2111$2119===(void 0))){throw $3085(["syntax","undeclared"]).create(("Undeclared variable: "+s$2106),({"node":expr$2083}));}else{(other$2131=$2111$2119);return ["bounce",other$2131];}}else{if(($2090$2103&&($2086$2092[0]==="value"))){$2086$2092[1];return expr$2083;}else{if(($2090$2103&&($2086$2092[0]==="variable"))){$2086$2092[1];return expr$2083;}else{if(($2088$2101&&((t0$2097===1)&&($2086$2092[0]==="void")))){return expr$2083;}else{if(($2088$2101&&((t0$2097===3)&&($2086$2092[0]==="send")))){(f$2147=$2086$2092[1]);(arg$2148=$2086$2092[2]);return ["send",helper$2077(["expr","head"],scope$2082,f$2147),helper$2077(["expr","tail"],scope$2082,arg$2148)];}else{if(($2088$2101&&(($2090$2103=(t0$2097>=1))&&($2086$2092[0]==="array")))){(args$2153=Array.prototype.slice.call($2086$2092,1));(newargs$2157=(((acc$2163=[])),(((temp$2168=it$0$2067.step_all(["expr","array"],scope$2082,args$2153))),((($length$2173=temp$2168.length)),((($index$2178=0)),function(){$2160:for(;($index$2178<$length$2173);($index$2178++)){var arg$2194;var m$2186;(m$2186=temp$2168[$index$2178]);;(arg$2194=m$2186);acc$2163.push(helper$2077(["expr","expr"],scope$2082,arg$2194));}}()))),acc$2163));;return ["array"].concat(newargs$2157);}else{if(($2090$2103&&($2086$2092[0]==="object"))){(args$2199=Array.prototype.slice.call($2086$2092,1));(newargs$2203=(((acc$2209=[])),(((temp$2214=it$0$2067.step_all(["expr","object"],scope$2082,args$2199))),((($length$2219=temp$2214.length)),((($index$2224=0)),function(){$2206:for(;($index$2224<$length$2219);($index$2224++)){var k$2242;var v$2243;var t0$2237;var t1$2238;var m$2232;(m$2232=temp$2214[$index$2224]);;(t0$2237=m$2232);if(((t0$2237 instanceof Array)&&((t1$2238=t0$2237.length),((t1$2238===3)&&(t0$2237[0]==="array"))))){(k$2242=t0$2237[1]);(v$2243=t0$2237[2]);acc$2209.push(["array",helper$2077(["expr","expr"],scope$2082,k$2242),helper$2077(["expr","expr"],scope$2082,v$2243)]);}else{$3072(m$2232,"/home/olivier/git/earl-grey/src/expand.eg",8608,8797);;}}}()))),acc$2209));;return ["object"].concat(newargs$2203);}else{if(($2088$2101&&((t0$2097===4)&&(($2086$2092[0]==="bind")&&((t1$2098=$2086$2092[1]),((variable$2252=t1$2098),((t1$2098 instanceof Array)&&((t2$2099=t1$2098.length),((t2$2099===2)&&(t1$2098[0]==="symbol")))))))))){(s$2253=t1$2098[1]);(value$2254=$2086$2092[2]);(body$2255=$2086$2092[3]);(newscope$2262=Scope$1057(scope$2082));;(t0$2268=variable$2252);if($3276(t0$2268,"env")){(env$2263=t0$2268.env);;}else{$3072(variable$2252,"/home/olivier/git/earl-grey/src/expand.eg",8940,8948);}env$2263.bind(newscope$2262,s$2253,value$2254);return helper$2077(context$2081,newscope$2262,body$2255);}else{if(($2088$2101&&(($2090$2103=(t0$2097>=1))&&($2086$2092[0]==="splice")))){(args$2274=Array.prototype.slice.call($2086$2092,1));return ["bounce",$996(["multi"].concat(args$2274),({"override_scope":true}))];}else{if(($2090$2103&&($2086$2092[0]==="interactive"))){(args$2279=Array.prototype.slice.call($2086$2092,1));return ["bounce",$996(["multi"].concat(args$2279),({"override_scope":true,"all_mutable":true}))];}else{if(($2090$2103&&($2086$2092[0]==="multi"))){(args$2284=Array.prototype.slice.call($2086$2092,1));(newscope$2288=function(){if(expr$2083.override_scope){return scope$2082;}else{return Scope$1057(scope$2082);}}());;(stepscope$2289=function(){if(expr$2083.nonrecursive){return scope$2082;}else{return newscope$2288;}}());;(changes$2290=false);;(t0$2304=classify$1049("newargs","vars",(((acc$2315=[])),(((temp$2320=it$0$2067.step_all(["expr","multi"],stepscope$2289,args$2284))),((($length$2325=temp$2320.length)),((($index$2330=0)),function(){$2306:for(;($index$2330<$length$2325);($index$2330++)){var t0$2375;var env$2373;var t0$2393;var env$2390;var v$2391;var other$2411;var v$2402;var value$2403;var variable$2381;var s$2382;var value$2383;var variable$2364;var s$2365;var value$2366;var opt$2356;var value$2357;var $2308$2348;var $2309$2349;var $2310$2350;var $2311$2351;var $2312$2352;var $2313$2353;var t0$2343;var t1$2344;var t2$2345;var t3$2346;var m$2338;(m$2338=temp$2320[$index$2330]);;(t0$2343=m$2338);if((($2309$2349=(t0$2343 instanceof Array))&&((t1$2344=t0$2343.length),(($2311$2351=(t1$2344===3))&&(t0$2343[0]==="option"))))){(opt$2356=t0$2343[1]);(value$2357=t0$2343[2]);acc$2315.push((newscope$2288.setopt(opt$2356,value$2357),["ignore"]));}else{if(($2311$2351&&((t0$2343[0]==="declare_raw")&&((t2$2345=t0$2343[1]),((variable$2364=t2$2345),((t2$2345 instanceof Array)&&((t3$2346=t2$2345.length),((t3$2346===2)&&(t2$2345[0]==="symbol"))))))))){(s$2365=t2$2345[1]);(value$2366=t0$2343[2]);acc$2315.push((((t0$2375=variable$2364),function(){if($3276(t0$2375,"env")){(env$2373=t0$2375.env);}else{return $3072(variable$2364,"/home/olivier/git/earl-grey/src/expand.eg",9890,9898);}}()),env$2373.bind(newscope$2288,s$2365,value$2366),(changes$2290=true),["ignore"]));}else{if(($2309$2349&&(($2311$2351=((t1$2344>=2)&&(t1$2344<=3)))&&(($2312$2352=(t0$2343[0]==="declare"))&&((t2$2345=t0$2343[1]),((variable$2381=t2$2345),((t2$2345 instanceof Array)&&((t3$2346=t2$2345.length),((t3$2346===2)&&(t2$2345[0]==="symbol")))))))))){(s$2382=t2$2345[1]);(value$2383=function(){if((2>=t1$2344)){return null;}else{return t0$2343[2];}}());acc$2315.push((((t0$2393=variable$2381),function(){if($3276(t0$2393,"env")){(env$2390=t0$2393.env);}else{return $3072(variable$2381,"/home/olivier/git/earl-grey/src/expand.eg",10135,10143);}}()),((v$2391=__lt____lt____colon__$1047(["variable",it$0$2067.gensym(s$2382)],variable$2381))),$996(v$2391,({"mutable":(expr$2083.all_mutable||variable$2381.mutable)})),env$2390.bind(newscope$2288,s$2382,v$2391),(changes$2290=true),function(){if(value$2383){return ["splice",["newargs",["assign",v$2391,value$2383]],["vars",v$2391]];}else{return ["vars",v$2391];}}()));}else{if(($2312$2352&&((v$2402=t2$2345),((t2$2345 instanceof Array)&&((t3$2346=t2$2345.length),((t3$2346===2)&&(t2$2345[0]==="variable"))))))){t2$2345[1];(value$2403=function(){if((2>=t1$2344)){return null;}else{return t0$2343[2];}}());acc$2315.push(((changes$2290=true),function(){if(value$2403){return ["splice",["newargs",["assign",v$2402,value$2403]],["vars",v$2402]];}else{return ["vars",v$2402];}}()));}else{(other$2411=m$2338);acc$2315.push(["newargs",other$2411]);}}}}}}()))),acc$2315)));if(($3276(t0$2304,"newargs")&&((newargs$2291=t0$2304.newargs),$3276(t0$2304,"vars")))){(vars$2292=t0$2304.vars);;}else{$3072(classify$1049("newargs","vars",(((acc$2425=[])),(((temp$2430=it$0$2067.step_all(["expr","multi"],stepscope$2289,args$2284))),((($length$2435=temp$2430.length)),((($index$2440=0)),function(){$2416:for(;($index$2440<$length$2435);($index$2440++)){var t0$2485;var env$2483;var t0$2503;var env$2500;var v$2501;var other$2521;var v$2512;var value$2513;var variable$2491;var s$2492;var value$2493;var variable$2474;var s$2475;var value$2476;var opt$2466;var value$2467;var $2418$2458;var $2419$2459;var $2420$2460;var $2421$2461;var $2422$2462;var $2423$2463;var t0$2453;var t1$2454;var t2$2455;var t3$2456;var m$2448;(m$2448=temp$2430[$index$2440]);;(t0$2453=m$2448);if((($2419$2459=(t0$2453 instanceof Array))&&((t1$2454=t0$2453.length),(($2421$2461=(t1$2454===3))&&(t0$2453[0]==="option"))))){(opt$2466=t0$2453[1]);(value$2467=t0$2453[2]);acc$2425.push((newscope$2288.setopt(opt$2466,value$2467),["ignore"]));}else{if(($2421$2461&&((t0$2453[0]==="declare_raw")&&((t2$2455=t0$2453[1]),((variable$2474=t2$2455),((t2$2455 instanceof Array)&&((t3$2456=t2$2455.length),((t3$2456===2)&&(t2$2455[0]==="symbol"))))))))){(s$2475=t2$2455[1]);(value$2476=t0$2453[2]);acc$2425.push((((t0$2485=variable$2474),function(){if($3276(t0$2485,"env")){(env$2483=t0$2485.env);}else{return $3072(variable$2474,"/home/olivier/git/earl-grey/src/expand.eg",9890,9898);}}()),env$2483.bind(newscope$2288,s$2475,value$2476),(changes$2290=true),["ignore"]));}else{if(($2419$2459&&(($2421$2461=((t1$2454>=2)&&(t1$2454<=3)))&&(($2422$2462=(t0$2453[0]==="declare"))&&((t2$2455=t0$2453[1]),((variable$2491=t2$2455),((t2$2455 instanceof Array)&&((t3$2456=t2$2455.length),((t3$2456===2)&&(t2$2455[0]==="symbol")))))))))){(s$2492=t2$2455[1]);(value$2493=function(){if((2>=t1$2454)){return null;}else{return t0$2453[2];}}());acc$2425.push((((t0$2503=variable$2491),function(){if($3276(t0$2503,"env")){(env$2500=t0$2503.env);}else{return $3072(variable$2491,"/home/olivier/git/earl-grey/src/expand.eg",10135,10143);}}()),((v$2501=__lt____lt____colon__$1047(["variable",it$0$2067.gensym(s$2492)],variable$2491))),$996(v$2501,({"mutable":(expr$2083.all_mutable||variable$2491.mutable)})),env$2500.bind(newscope$2288,s$2492,v$2501),(changes$2290=true),function(){if(value$2493){return ["splice",["newargs",["assign",v$2501,value$2493]],["vars",v$2501]];}else{return ["vars",v$2501];}}()));}else{if(($2422$2462&&((v$2512=t2$2455),((t2$2455 instanceof Array)&&((t3$2456=t2$2455.length),((t3$2456===2)&&(t2$2455[0]==="variable"))))))){t2$2455[1];(value$2513=function(){if((2>=t1$2454)){return null;}else{return t0$2453[2];}}());acc$2425.push(((changes$2290=true),function(){if(value$2513){return ["splice",["newargs",["assign",v$2512,value$2513]],["vars",v$2512]];}else{return ["vars",v$2512];}}()));}else{(other$2521=m$2448);acc$2425.push(["newargs",other$2521]);}}}}}}()))),acc$2425)),"/home/olivier/git/earl-grey/src/expand.eg",9562,11161);}(exp$2293=function(s$2526){var $index$2552;var $length$2547;var temp$2542;var acc$2537;var $index$2594;var $length$2589;var temp$2584;var acc$2579;var stepped$2529;(stepped$2529=(((acc$2537=[])),(((temp$2542=$3254(newargs$2291))),((($length$2547=temp$2542.length)),((($index$2552=0)),function(){$2534:for(;($index$2552<$length$2547);($index$2552++)){var i$2570;var arg$2571;var t0$2565;var t1$2566;var m$2560;(m$2560=temp$2542[$index$2552]);;(t0$2565=m$2560);if(((t0$2565 instanceof Array)&&((t1$2566=t0$2565.length),(t1$2566===2)))){(i$2570=t0$2565[0]);(arg$2571=t0$2565[1]);acc$2537.push(it$0$2067.step(["expr",function(){if((i$2570===(newargs$2291.length-1))){return "expr";}else{return "ignore";}}()],s$2526,arg$2571));}else{$3072(m$2560,"/home/olivier/git/earl-grey/src/expand.eg",11383,11560);;}}}()))),acc$2537));;(acc$2579=[]);;(temp$2584=stepped$2529);;($length$2589=temp$2584.length);;($index$2594=0);;$2530:for(;($index$2594<$length$2589);($index$2594++)){var arg$2610;var m$2602;(m$2602=temp$2584[$index$2594]);;(arg$2610=m$2602);acc$2579.push(helper$2077(["expr","expr"],s$2526,arg$2610));}return acc$2579;});;if(changes$2290){return ["scope",vars$2292,["multi"].concat(exp$2293(newscope$2288))];}else{return ["multi"].concat(exp$2293(scope$2082));}}else{if(($2090$2103&&($2086$2092[0]==="data"))){(args$2615=Array.prototype.slice.call($2086$2092,1));(is_obj$2619=false);;(obj$2620=["object"]);;(arr$2621=["array"]);;(arr_parts$2622=[]);;(obj_parts$2623=[]);;(new_arr_part$2624=function(){var other$2668;var t0$2659;var $2652$2654;($2652$2654=arr$2621);;if((($2652$2654 instanceof Array)&&((t0$2659=$2652$2654.length),((t0$2659===1)&&($2652$2654[0]==="array"))))){return false;}else{(other$2668=$2652$2654);arr_parts$2622.push(arr$2621);return (arr$2621=["array"]);}});;(new_obj_part$2625=function(){var other$2692;var t0$2683;var $2676$2678;($2676$2678=obj$2620);;if((($2676$2678 instanceof Array)&&((t0$2683=$2676$2678.length),((t0$2683===1)&&($2676$2678[0]==="object"))))){return false;}else{(other$2692=$2676$2678);obj_parts$2623.push(obj$2620);return (obj$2620=["object"]);}});;(temp$2698=it$0$2067.step_all(["expr","data"],scope$2082,args$2615));;($length$2703=temp$2698.length);;($index$2708=0);;$2627:for(;($index$2708<$length$2703);($index$2708++)){var other$2754;var expr$2748;var expr$2742;var k$2735;var v$2736;var $2629$2724;var $2630$2725;var $2631$2726;var $2632$2727;var t0$2721;var t1$2722;var m$2716;(m$2716=temp$2698[$index$2708]);;(t0$2721=m$2716);if((($2630$2725=(t0$2721 instanceof Array))&&((t1$2722=t0$2721.length),((t1$2722===1)&&(t0$2721[0]==="assoc"))))){(is_obj$2619=true);}else{if(($2630$2725&&((t1$2722===3)&&(t0$2721[0]==="assoc")))){(k$2735=t0$2721[1]);(v$2736=t0$2721[2]);(is_obj$2619=true);obj$2620.push(["array",k$2735,v$2736]);}else{if(($2630$2725&&(($2632$2727=(t1$2722===2))&&(t0$2721[0]==="dynsplice")))){(expr$2742=t0$2721[1]);new_arr_part$2624();arr_parts$2622.push(expr$2742);}else{if(($2632$2727&&(t0$2721[0]==="objsplice"))){(expr$2748=t0$2721[1]);(is_obj$2619=true);new_obj_part$2625();obj_parts$2623.push(expr$2748);}else{(other$2754=m$2716);arr$2621.push(other$2754);}}}}}new_arr_part$2624();new_obj_part$2625();(r$2626=((($2758$2760=arr_parts$2622)),function(){if((($2758$2760 instanceof Array)&&((t0$2765=$2758$2760.length),((t0$2765===0)&&is_obj$2619)))){return util$1048.construct(obj_parts$2623,function(x$2773,rest$2774){return ["send",["symbol","&:"],["data",x$2773,rest$2774]];},["object"]);}else{$2758$2760;if(is_obj$2619){throw $3085(["syntax","array","object"]).create("Cannot mix array and object notations.");}else{(other$2782=$2758$2760);return util$1048.construct(arr_parts$2622.reverse(),function(x$2785,rest$2786){return ["send",["send",rest$2786,["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",x$2785]];},["array"]);}}}()));;return helper$2077(context$2081,scope$2082,it$0$2067.mkenv().convert(r$2626));}else{if(($2088$2101&&(($2090$2103=(t0$2097===3))&&($2086$2092[0]==="assign")))){(target$2791=$2086$2092[1]);(value$2792=$2086$2092[2]);return ["assign",helper$2077(["expr","expr"],scope$2082,target$2791),helper$2077(["expr","expr"],scope$2082,value$2792)];}else{if(($2090$2103&&($2086$2092[0]==="lambda"))){(bindings$2797=$2086$2092[1]);(body$2798=$2086$2092[2]);(newscope$2802=Scope$1057(scope$2082));;return ["lambda",(((acc$2810=[])),(((temp$2815=bindings$2797)),((($length$2820=temp$2815.length)),((($index$2825=0)),function(){$2806:for(;($index$2825<$length$2820);($index$2825++)){var v$2851;var x$2861;var other$2868;var v$2858;var b$2844;var env$2845;var $2808$2841;var t0$2838;var t1$2839;var m$2833;(m$2833=temp$2815[$index$2825]);;(t0$2838=m$2833);if(((t0$2838 instanceof Array)&&((t1$2839=t0$2838.length),((t1$2839===2)&&((t0$2838[0]==="symbol")&&((b$2844=t0$2838[1]),$3276(t0$2838,"env"))))))){(env$2845=t0$2838.env);acc$2810.push((((v$2851=["variable",it$0$2067.gensym(b$2844)])),(env$2845.bind(newscope$2802,b$2844,v$2851),v$2851)));}else{if((((x$2861=t0$2838)),((x$2861 instanceof Array)&&(x$2861[0]==="variable")))){(v$2858=t0$2838);acc$2810.push(v$2858);}else{(other$2868=m$2833);acc$2810.push(function(){throw $3085(["syntax","lambda","binding"]).create("Not a valid binding.",({"node":other$2868}));}());}}}}()))),acc$2810),helper$2077(["expr","expr"],newscope$2802,body$2798)];}else{if(($2090$2103&&($2086$2092[0]==="use"))){($2087$2873=$2086$2092[1]);(x$2872=$2086$2092[2]);(t0$2877=$2087$2873);if((typeof(t0$2877)==="string")){(name$2881=t0$2877);(s$2885=scope$2082);;$2889:while(s$2885){if((s$2885.name.slice(0,(name$2881.length+1))===(name$2881+"/"))){break $2889;}else{(s$2885=s$2885.parent);}}if(s$2885){return helper$2077(context$2081,s$2885,x$2872);}else{throw $3085(["syntax","noscope"]).create(("Could not find a scope tagged: "+name$2881));}}else{(newscope$2894=$2087$2873);return helper$2077(context$2081,newscope$2894,x$2872);}}else{if(($2090$2103&&(($2086$2092[0]==="tagscope")&&((t1$2098=$2086$2092[1]),(typeof(t1$2098)==="string"))))){(tag$2898=t1$2098);(body$2899=$2086$2092[2]);return helper$2077(context$2081,Scope$1057(scope$2082,it$0$2067.gensym((tag$2898+"/"))),body$2899);}else{if(($2088$2101&&((t0$2097>=1)&&((type$2905=$2086$2092[0]),((args$2906=Array.prototype.slice.call($2086$2092,1)),(it$0$2067.generic_nodes.indexOf(type$2905)!==-1)))))){return [type$2905].concat((((acc$2914=[])),(((temp$2919=args$2906)),((($length$2924=temp$2919.length)),((($index$2929=0)),function(){$2911:for(;($index$2929<$length$2924);($index$2929++)){var arg$2945;var m$2937;(m$2937=temp$2919[$index$2929]);;(arg$2945=m$2937);acc$2914.push(helper$2077(["expr","expr"],scope$2082,arg$2945));}}()))),acc$2914));}else{(other$2949=$2086$2092);throw $3085(["syntax","illegal_node"]).create("An illegal node was found.",({"node":other$2949,"context":context$2081}));}}}}}}}}}}}}}}}}}}));;return helper$2077(context$2062,scope$2063,expr$2064);});$996(Expander$1060,$996(((accum$2953=({})),((accum$2953["::name"]="Expander"),accum$2953)),((accum$2957=({})),((accum$2957["::egclass"]=true),accum$2957))));Expander$1060;(mac1$1061=function(f$2963){return ["macro",function(context$2967,scope$2968,form$2969,$2965$2970){var t0$2974;var t1$2975;var expr$2972;(t0$2974=$2965$2970);if(((t0$2974 instanceof Array)&&((t1$2975=t0$2974.length),((t1$2975===2)&&(t0$2974[0]==="data"))))){(expr$2972=t0$2974[1]);;}else{$3072($2965$2970);}return f$2963(expr$2972);}];});;(__chk_ncache$1062=({}));;(__chk_scache$1063=({}));;(checker_db$1064=function($2989$2991){var v$3027;var v$3040;var s$3036;var n$3023;var $2993$2999;var ph$2994;(ph$2994=$2989$2991);;($2993$2999=ph$2994);;if(($2993$2999===null)){return checker_db$1064.null;}else{if(($2993$2999===(void 0))){return checker_db$1064.undefined;}else{if(($2993$2999===true)){return checker_db$1064.true;}else{if(($2993$2999===false)){return checker_db$1064.false;}else{if((typeof($2993$2999)==="number")){(n$3023=$2993$2999);if($995(__chk_ncache$1062,n$3023)){return $995(__chk_ncache$1062,n$3023);}else{(v$3027=mac1$1061(function(x$3031){return ["send",["symbol","==="],["data",x$3031,["value",n$3023]]];}));;(__chk_ncache$1062[n$3023]=v$3027);return v$3027;}}else{if((typeof($2993$2999)==="string")){(s$3036=$2993$2999);if(Object.prototype.hasOwnProperty.call(__chk_scache$1063,s$3036)){return $995(__chk_scache$1063,s$3036);}else{(v$3040=mac1$1061(function(x$3044){return ["send",["symbol","==="],["data",x$3044,["value",s$3036]]];}));;(__chk_scache$1063[s$3036]=v$3040);return v$3040;}}else{$3072($2993$2999);}}}}}}});;$996(checker_db$1064,({"String":mac1$1061(function(x$3051){return ["send",["symbol","==="],["data",["send",["symbol","typeof"],["data",x$3051]],["value","string"]]];}),"Number":mac1$1061(function(x$3054){return ["send",["symbol","==="],["data",["send",["symbol","typeof"],["data",x$3054]],["value","number"]]];}),"Array":mac1$1061(function(x$3057){return ["send",["symbol","instanceof"],["data",x$3057,["symbol","Array"]]];}),"true":mac1$1061(function(x$3060){return x$3060;}),"false":mac1$1061(function(x$3063){return ["send",["symbol","not"],["data",["void"],x$3063]];}),"null":mac1$1061(function(x$3066){return ["send",["symbol","==="],["data",x$3066,["value",null]]];}),"undefined":mac1$1061(function(x$3069){return ["send",["symbol","==="],["data",x$3069,["value",(void 0)]]];})}));(exports["Env"]=Env$1058);(exports["Scope"]=Scope$1057);(exports["track_location"]=track_location$1059);(exports["Expander"]=Expander$1060);(exports["GenSym"]=GenSym$1051);(exports["gensym"]=gensym$1052);(exports["mac1"]=mac1$1061);(exports["checker_db"]=checker_db$1064);

},{"./location":7,"./pattern":10,"./pp":11,"./util":14}],6:[function(require,module,exports){
var $3518=function(type$3520){var f$3523;(f$3523=type$3520["::check"]);;if((f$3523===(void 0))){return function(value$3528){return (value$3528 instanceof type$3520);};}else{return function(value$3531){return f$3523.call(type$3520,value$3531);};}};
var $3533=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $3534=function(dest$3536,values$3537){var k$3542;(k$3542=null);$3540:for(k$3542 in values$3537){if(values$3537.hasOwnProperty(k$3542)){(dest$3536[k$3542]=values$3537[k$3542]);}}return dest$3536;};
var $3546=function($3547$3549){var ph$3553;(ph$3553=$3547$3549);;var $3551$3558;($3551$3558=ph$3553);;var bridge$3552$3563;var x$3567;(bridge$3552$3563=$3551$3558);if((((typeof(bridge$3552$3563)==="string")&&((x$3567=bridge$3552$3563),true))||((typeof(bridge$3552$3563)==="number")&&((x$3567=bridge$3552$3563),true)))){return ["value",x$3567];}else{var other$3574;(other$3574=$3551$3558);return other$3574["::serialize_ast"]();}};
var send$3358;(send$3358=function(obj$3363,$3361$3364){var ph$3368;var msg$3369;var t0$3371;(t0$3371=$3361$3364);(msg$3369=t0$3371);(ph$3368=t0$3371);;var $3366$3375;($3366$3375=ph$3368);;var bridge$3367$3380;(bridge$3367$3380=$3366$3375);if(((typeof(bridge$3367$3380)==="string")||(typeof(bridge$3367$3380)==="number"))){return obj$3363[msg$3369];}else{var other$3388;(other$3388=$3366$3375);return obj$3363["::send"](msg$3369);}});;(Array[":::project"]=function($3391$3393){var ph$3396;var value$3397;var t0$3399;(t0$3399=$3391$3393);(value$3397=t0$3399);(ph$3396=t0$3399);;var $3395$3403;($3395$3403=ph$3396);;if($3518(Array)($3395$3403)){return [true,value$3397];}else{$3395$3403;return [true,[value$3397]];}});(Array.prototype["::check"]=function(value$3417){if((value$3417 instanceof Array)){var i$3422;(i$3422=0);;$3420:for(;(i$3422<this.length);(i$3422++)){if(($3533(this,i$3422)!==$3533(value$3417,i$3422))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $3534(this.slice(0),this);});(Array.prototype[":::project"]=function(value$3433){if((value$3433 instanceof Array)){var i$3438;(i$3438=0);;$3436:for(;(i$3438<this.length);(i$3438++)){if(($3533(this,i$3438)!==$3533(value$3433,i$3438))){return [true,[value$3433]];}}return [true,value$3433.slice(this.length)];}else{return [true,[value$3433]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($3546));});(RegExp.prototype["::check"]=function($3448$3450){var ph$3453;(ph$3453=$3448$3450);;var $3452$3458;($3452$3458=ph$3453);;var value$3466;if((typeof($3452$3458)==="string")){(value$3466=$3452$3458);if(value$3466.match(this)){return true;}else{return false;}}else{var other$3471;(other$3471=$3452$3458);return false;}});(RegExp.prototype[":::project"]=function($3473$3475){var ph$3478;(ph$3478=$3473$3475);;var $3477$3483;($3477$3483=ph$3478);;var value$3491;if((typeof($3477$3483)==="string")){(value$3491=$3477$3483);var $3494$3496;($3494$3496=value$3491.match(this));;var m$3504;if(($3494$3496===null)){(m$3504=$3494$3496);return [false,null];}else{var m$3509;(m$3509=$3494$3496);return [true,m$3509];}}else{var other$3513;(other$3513=$3477$3483);return [false,null];}});(Function.prototype["::send"]=function(args$3516){return this.apply(this,args$3516);});
var $4935=function(arr$4937){var results$4941;var l$4942;(results$4941=[]);;(l$4942=arr$4937.length);;var i$4950;(i$4950=0);;$4940:for(;(i$4950<l$4942);(i$4950++)){results$4941.push([i$4950,$3533(arr$4937,i$4950)]);}return results$4941;};
var $4766=function(){var $4767$4769;($4767$4769=function(tags$4773){var it$0$4776;(it$0$4776=function(){if((!$3518($4767$4769)(this))){return Object.create($4767$4769.prototype);}else{return this;}}());;(it$0$4776["tags"]=tags$4773);return it$0$4776;});;($4767$4769.prototype["create"]=function(){var $4785$4787;($4785$4787=arguments);;var t0$4792;var message$4796;var args$4797;(t0$4792=$4785$4787.length);if((t0$4792>=0)){(message$4796=function(){if((0>=t0$4792)){return "";}else{return $4785$4787[0];}}());(args$4797=Array.prototype.slice.call($4785$4787,1));var it$0$4801;(it$0$4801=this);;var self$4806;(self$4806=this);;var e$4811;(e$4811=Error(message$4796));;(e$4811["::tags"]=it$0$4801.tags);(e$4811["args"]=args$4797);var temp$4819;(temp$4819=$4935(args$4797));;var $length$4824;($length$4824=temp$4819.length);;var $index$4829;($index$4829=0);;$4812:for(;($index$4829<$length$4824);($index$4829++)){var m$4837;(m$4837=temp$4819[$index$4829]);;var t0$4842;var t1$4843;var i$4847;var arg$4848;(t0$4842=m$4837);if(((t0$4842 instanceof Array)&&((t1$4843=t0$4842.length),(t1$4843===2)))){(i$4847=t0$4842[0]);(arg$4848=t0$4842[1]);(e$4811[i$4847]=arg$4848);}else{$4753(m$4837);;}}(e$4811["length"]=args$4797.length);(e$4811["name"]=["E"].concat(it$0$4801.tags).join("."));return e$4811;}else{$4753($4785$4787);}});($4767$4769.prototype["::check"]=function(e$4859){var it$0$4862;(it$0$4862=this);;var self$4867;(self$4867=this);;var tags$4872;if(((!e$4859)||(!$3518(Error)(e$4859)))){return false;}(tags$4872=(e$4859["::tags"]||[]));;var temp$4881;(temp$4881=it$0$4862.tags);;var $length$4886;($length$4886=temp$4881.length);;var $index$4891;($index$4891=0);;$4873:for(;($index$4891<$length$4886);($index$4891++)){var m$4899;(m$4899=temp$4881[$index$4891]);;var tag$4907;(tag$4907=m$4899);if((tags$4872.indexOf(tag$4907)===-1)){return false;}else{false;;}}return true;});($4767$4769.prototype["::deconstruct"]=function(e$4915){var it$0$4918;(it$0$4918=this);;var self$4923;(self$4923=this);;return e$4915.args;});$3534($4767$4769,$3534(function(){var accum$4928;(accum$4928=({}));(accum$4928["::name"]="$4767");return accum$4928;}(),function(){var accum$4932;(accum$4932=({}));(accum$4932["::egclass"]=true);return accum$4932;}()));return $4767$4769;}();
var $4753=function(value$4755,url$4756,start$4757,end$4758){var err$4761;(err$4761=$4766(["match"]).create("Could not find a match for value",({"value":value$4755})));;if(url$4756){(err$4761["location"]=["location",url$4756,start$4757,end$4758]);}throw err$4761;};
var $5029=function($5030$5032,key$5033){var ph$5037;(ph$5037=$5030$5032);;var $5035$5042;($5035$5042=ph$5037);;var bridge$5036$5047;(bridge$5036$5047=$5035$5042);if(((bridge$5036$5047===null)||(bridge$5036$5047===(void 0)))){return false;}else{var x$5055;if((typeof($5035$5042)==="string")){(x$5055=$5035$5042);return (key$5033 in String.prototype);}else{var x$5060;if((typeof($5035$5042)==="number")){(x$5060=$5035$5042);return (key$5033 in Number.prototype);}else{var x$5065;(x$5065=$5035$5042);return (key$5033 in x$5065);}}}};
var $4973=function($4974$4976){var ph$4982;var x$4983;var t0$4985;(t0$4985=$4974$4976);(x$4983=t0$4985);(ph$4982=t0$4985);;var $4978$4989;($4978$4989=ph$4982);;var bridge$4979$4994;(bridge$4979$4994=$4978$4989);if((function(){var bridge$4980$5000;(bridge$4980$5000=bridge$4979$4994);return (function(){var bridge$4981$5003;(bridge$4981$5003=bridge$4980$5000);return ((bridge$4981$5003===(void 0))||(bridge$4981$5003===null));}()||(typeof(bridge$4980$5000)==="string"));}()||(typeof(bridge$4979$4994)==="number"))){return x$4983;}else{if($5029($4978$4989,"::clone")){$4978$4989["::clone"];return x$4983["::clone"]();}else{$4978$4989;if((Object.getPrototypeOf(x$4983)===Object.prototype)){var dest$5016;(dest$5016=({}));;var k$5021;(k$5021=null);$5015:for(k$5021 in x$4983){if(Object.prototype.hasOwnProperty.call(x$4983,k$5021)){(dest$5016[k$5021]=x$4983[k$5021]);}}return dest$5016;}else{var other$5027;(other$5027=$4978$4989);throw $4766(["clone"]).create("Object cannot be cloned",({"obj":x$4983}));}}}};
var $4957=function(a$4959,b$4960){var dest$4964;(dest$4964=$4973(a$4959));;var k$4969;(k$4969=null);$4963:for(k$4969 in b$4960){if(Object.prototype.hasOwnProperty.call(b$4960,k$4969)){(dest$4964[k$4969]=b$4960[k$4969]);}}return dest$4964;};var id$3608;var id_f$3609;var numr$3610;var numr_f$3611;var num$3612;var num_f$3613;var str$3614;var str_f$3615;var op$3616;var op2$3617;var op3$3618;var op4$3619;var op_f$3620;var indent$3621;var indent_f$3622;var cmnt$3623;var cmnt_f$3624;var unkn$3625;var unkn_f$3626;var $3578$3579;var Location$3580;var __lt____lt____colon__$3581;var special_ops$3582;var regexps$3583;var ws_re$3584;var eol_re$3585;var produce$3586;var indent_tracker$3587;var process_indent$3588;var disambiguate_fixity$3589;var alternate_operators$3590;var fill_locations$3591;var tokenize$3592;($3578$3579=require("./location"));;(Location$3580=$3578$3579.Location);;(__lt____lt____colon__$3581=$3578$3579["<<:"]);;(special_ops$3582=({"(":"PFX","[":"PFX","{":"PFX",")":"SFX","]":"SFX","}":"SFX",",":"IFX",".":"PFX","'":"PFX","not":"PFX"}));;(regexps$3583=(((id$3608=RegExp("(?:^[a-zA-Z$_](?:[a-zA-Z$_0-9]*))",""))),((id_f$3609=function(m$3633){return ["ID",m$3633[0]];})),((numr$3610=RegExp("(?:^((?:\\d+))[rR]((?:[A-Za-z0-9_]+))(?:(?:\\.((?:[A-Za-z0-9_]+)))?))",""))),((numr_f$3611=function(m$3642){var t0$3650;var t1$3651;var radix$3645;var intp$3646;var frac$3647;var value$3648;(t0$3650=m$3642);if(((t0$3650 instanceof Array)&&((t1$3651=t0$3650.length),(t1$3651===4)))){t0$3650[0];(radix$3645=t0$3650[1]);(intp$3646=t0$3650[2]);(frac$3647=t0$3650[3]);;}else{$4753(m$3642,"/home/olivier/git/earl-grey/src/lex.eg",993,994);}(value$3648=parseInt(intp$3646.replace(RegExp("_","g"),""),radix$3645));;if(frac$3647){(frac$3647=frac$3647.replace(RegExp("_","g"),""));(value$3648=(value$3648+(parseInt(frac$3647,radix$3645)/Math.pow(radix$3645,frac$3647.length))));}return ["ID","NUM",value$3648];})),((num$3612=RegExp("(?:^((?:[0-9_]+))(?:(?:\\.((?:\\d+)))?)(?:(?:[eE]((?:[+-]?)(?:[0-9_]+)))?))",""))),((num_f$3613=function(m$3667){return ["NUM",parseFloat(m$3667[0].replace(RegExp("_","g"),""))];})),((str$3614=RegExp("(?:^\"((?:(?:(?:\\\\\\\\|\\\\\")|[^\"])*))\")",""))),((str_f$3615=function(m$3676){var repl$3679;var r$3680;(repl$3679=({"\\\"":"\"","\\\\":"\\","\\n":"\n"}));;(r$3680=m$3676[1].replace(RegExp("((?:(?:\\\\\"|\\\\\\\\)|\\\\n))","g"),function(m$3687){return $3533(repl$3679,m$3687);}));;return ["STR",r$3680];})),((op$3616=RegExp("(?:^(?:[+\\-*/~\\^<>=%&|?!@#.:']+))",""))),((op2$3617=RegExp("(?:^[\\[\\{\\}\\],])",""))),((op3$3618=RegExp("(?:^(?:(?:(?:(?:(?:(?:(?:(?:(?:with|where)|when)|and)|not)|or)|in)|mod)|each)|as)(?:(?:[+\\-*/~\\^<>=%&|?!@#.:']+)|\\b))",""))),((op4$3619=RegExp("(?:^`((?:[A-Za-z0-9_]+))`)",""))),((op_f$3620=function(m$3706,column$3707){var fixity$3733;var otherwise$3739;var $3711$3723;var $3710$3717;var op$3712;(op$3712=(m$3706[1]||m$3706[0]));;($3710$3717=null);;$3710$3717;if((op$3712==="|")){return ["INDENT",(column$3707-1)];}else{if((op$3712 in special_ops$3582)){(fixity$3733=$3533(special_ops$3582,op$3712));;return ["OP",fixity$3733,op$3712];}else{(otherwise$3739=$3710$3717);return ["OP","?FX",op$3712];}}})),((indent$3621=RegExp("(?:^(?:(?:\n \\*;(?:[^\n]*))*)(?:(?:\n((?: *)))+))",""))),((indent_f$3622=function(m$3748){var ilen$3751;(ilen$3751=m$3748[1].length);;return ["INDENT",ilen$3751];})),((cmnt$3623=RegExp("(?:^;(?:[^\n]*))",""))),((cmnt_f$3624=function(m$3762){return ["IGNORE"];})),((unkn$3625=RegExp("(?:^.)",""))),((unkn_f$3626=function(m$3771){return ["ILLEGAL",m$3771[0]];})),[[op3$3618,op_f$3620],[id$3608,id_f$3609],[numr$3610,numr_f$3611],[num$3612,num_f$3613],[str$3614,str_f$3615],[op$3616,op_f$3620],[op2$3617,op_f$3620],[op4$3619,op_f$3620],[indent$3621,indent_f$3622],[cmnt$3623,cmnt_f$3624],[unkn$3625,unkn_f$3626]]));;(ws_re$3584=RegExp("(?:^(?: *)(?:(?:\n(?: *)\\\\(?: *))*))",""));;(eol_re$3585=RegExp("(?:^(?: *)(?:\n|$))",""));;(produce$3586=function(src$3784){var text$3787;var results$3788;var wsb$3789;var pos$3790;var column$3791;(text$3787=src$3784.text);;(results$3788=[]);;(wsb$3789=text$3787.match(ws_re$3584)[0].length);;(text$3787=text$3787.slice(wsb$3789));(pos$3790=wsb$3789);;(column$3791=0);;$3807:while(text$3787){var i$3812;(i$3812=0);;$3810:for(;(i$3812<regexps$3583.length);(++i$3812)){var t0$3824;var t1$3825;var splits$3848;var skip$3834;var endpos$3835;var wsa$3836;var eol$3837;var bwsb$3838;var bwsa$3839;var token$3840;var re$3820;var fn$3821;var m$3822;(t0$3824=$3533(regexps$3583,i$3812));if(((t0$3824 instanceof Array)&&((t1$3825=t0$3824.length),(t1$3825===2)))){(re$3820=t0$3824[0]);(fn$3821=t0$3824[1]);;}else{$4753($3533(regexps$3583,i$3812),"/home/olivier/git/earl-grey/src/lex.eg",3333,3353);}(m$3822=text$3787.match(re$3820));;if(m$3822){(skip$3834=m$3822[0].length);;(endpos$3835=(pos$3790+skip$3834));;(column$3791=(((splits$3848=m$3822[0].split("\n"))),function(){if((splits$3848.length>1)){return $3533(splits$3848,(splits$3848.length-1)).length;}else{return (column$3791+skip$3834);}}()));(text$3787=text$3787.slice(skip$3834));(wsa$3836=text$3787.match(ws_re$3584)[0].length);;(eol$3837=(text$3787.match(eol_re$3585)&&true));;(bwsb$3838=(wsb$3789>0));;(bwsa$3839=function(){if(eol$3837){return bwsb$3838;}else{return (wsa$3836>0);}}());;(token$3840=fn$3821(m$3822,column$3791));;(token$3840["wsb"]=bwsb$3838);(token$3840["wsa"]=bwsa$3839);(token$3840["location"]=Location$3580(src$3784,pos$3790,endpos$3835));results$3788.push(token$3840);(text$3787=text$3787.slice(wsa$3836));(column$3791=(column$3791+wsa$3836));(wsb$3789=wsa$3836);(pos$3790=(endpos$3835+wsa$3836));break $3810;}}}return results$3788;});;(indent_tracker$3587=function(){var curr$3874;var stack$3875;var stacks$3876;(curr$3874=0);;(stack$3875=[]);;(stacks$3876=[stack$3875]);;return function($3873$3887){var t0$3900;var rval$3946;var $index$3998;var $length$3993;var temp$3988;var acc$3983;var rval$3977;var x$4020;var $index$4043;var $length$4038;var temp$4033;var acc$4028;var other$4062;var fixity$3971;var fixity$3963;var stuff$3958;var new_indent$3920;var $3890$3921;var $3893$3914;var $3894$3915;var $3895$3916;var $3896$3917;var t0$3909;var t1$3910;var bridge$3891$3911;var bridge$3892$3912;var $3889$3904;var ph$3897;var token$3898;(t0$3900=$3873$3887);(token$3898=t0$3900);(ph$3897=t0$3900);;($3889$3904=ph$3897);;if((($3893$3914=($3889$3904 instanceof Array))&&((t0$3909=$3889$3904.length),((t0$3909===2)&&($3889$3904[0]==="INDENT"))))){(t1$3910=$3889$3904[1]);(new_indent$3920=t1$3910);($3890$3921=t1$3910);$3890$3921;if((curr$3874===false)){(curr$3874=new_indent$3920);return [$4957(["OP","IFX",","],({"wsb":true,"wsa":true}))];}else{if(($3890$3921>curr$3874)){$3533(stack$3875.push(curr$3874),(curr$3874=new_indent$3920));return [$4957(["OP","PFX","["],({"wsb":true,"wsa":true}))];}else{if(($3890$3921===curr$3874)){return [$4957(["OP","IFX",","],({"wsb":true,"wsa":true}))];}else{if(($3890$3921<curr$3874)){(rval$3946=[]);;$3950:while(((stack$3875.length>0)&&(new_indent$3920<curr$3874))){(curr$3874=stack$3875.pop());rval$3946.push($4957(["OP","SFX","]"],({"wsb":true,"wsa":true})));}rval$3946.push($4957(["OP","IFX",","],({"wsb":true,"wsa":true})));return rval$3946;}else{$4753($3890$3921,"/home/olivier/git/earl-grey/src/lex.eg",4686,4702);}}}}}else{if(($3893$3914&&((t0$3909>=1)&&($3889$3904[0]==="ID")))){(stuff$3958=Array.prototype.slice.call($3889$3904,1));return [token$3898];}else{if(($3893$3914&&(($3895$3916=(t0$3909===3))&&(($3896$3917=($3889$3904[0]==="OP"))&&((fixity$3963=$3889$3904[1]),((bridge$3891$3911=$3889$3904[2]),((bridge$3891$3911==="[")||(bridge$3891$3911==="{")))))))){stack$3875.push(curr$3874);stacks$3876.push(stack$3875);(stack$3875=[]);(curr$3874=false);return [token$3898];}else{if(($3896$3917&&((fixity$3971=$3889$3904[1]),((bridge$3892$3912=$3889$3904[2]),((bridge$3892$3912==="]")||(bridge$3892$3912==="}")))))){(rval$3977=(((acc$3983=[])),(((temp$3988=stack$3875)),((($length$3993=temp$3988.length)),((($index$3998=0)),function(){$3980:for(;($index$3998<$length$3993);($index$3998++)){var m$4006;(m$4006=temp$3988[$index$3998]);;m$4006;acc$3983.push($4957(["OP","SFX","]"],({"wsb":true,"wsa":true})));}}()))),acc$3983));;(stack$3875=stacks$3876.pop());(curr$3874=stack$3875.pop());rval$3977.push(token$3898);return rval$3977;}else{if((((x$4020=$3889$3904)),((x$4020 instanceof Array)&&(x$4020[0]==="EOF")))){(acc$4028=[]);;(temp$4033=stack$3875);;($length$4038=temp$4033.length);;($index$4043=0);;$4025:for(;($index$4043<$length$4038);($index$4043++)){var m$4051;(m$4051=temp$4033[$index$4043]);;m$4051;acc$4028.push($4957(["OP","SFX","]"],({"wsb":true,"wsa":true})));}return acc$4028;}else{(other$4062=$3889$3904);return [token$3898];}}}}}};});;(process_indent$3588=function(stream$4068){var $index$4093;var $length$4088;var temp$4083;var tracker$4071;var results$4072;(tracker$4071=indent_tracker$3587());;(results$4072=[]);;(temp$4083=stream$4068);;($length$4088=temp$4083.length);;($index$4093=0);;$4073:for(;($index$4093<$length$4088);($index$4093++)){var token$4109;var m$4101;(m$4101=temp$4083[$index$4093]);;(token$4109=m$4101);(results$4072=results$4072.concat(tracker$4071(token$4109)));}return results$4072.concat(tracker$4071(["EOF"]));});;(disambiguate_fixity$3589=function(stream$4115){var $index$4439;var $length$4434;var temp$4429;var __lt____lt____lt____colon__$4118;var collapse_operators$4119;var buffer$4120;var pfx$4121;var collapse$4122;var results$4123;(__lt____lt____lt____colon__$4118=function(a$4131,b$4132){(a$4131["wsb"]=b$4132.wsb);(a$4131["wsa"]=b$4132.wsa);return __lt____lt____colon__$3581(a$4131,b$4132);});;(collapse_operators$4119=function(){var msg$4207;var longer$4204;var token$4193;var fixity$4194;var name$4195;var t0$4187;var t1$4188;var t2$4189;var $4180$4182;var $index$4233;var $length$4228;var temp$4223;var acc$4218;var $index$4281;var $length$4276;var temp$4271;var acc$4266;var t0$4320;var t1$4321;var t2$4322;var t3$4323;var t0$4347;var t0$4350;var t0$4386;var t0$4389;var t1$4390;var t2$4391;var bridge$4373$4380;var $4372$4375;var t$4369;var results$4364;var $4312$4340;var $4313$4341;var $4314$4342;var bridge$4311$4337;var t0$4338;var $4310$4332;var first$4315;var fixity$4316;var name$4317;var rest$4318;var n$4168;var $4141$4163;var $4142$4164;var $4143$4165;var $4144$4166;var t0$4160;var t1$4161;var buffer$4155;var $4140$4156;var t0$4151;var $4139$4146;($4139$4146=arguments);;(t0$4151=$4139$4146.length);if((t0$4151>=1)){(buffer$4155=$4139$4146[0]);($4140$4156=Array.prototype.slice.call($4139$4146,1));(n$4168=buffer$4155.length);;$4140$4156;if((!buffer$4155.length)){return [];}else{(t0$4160=$4140$4156);(t1$4161=t0$4160.length);if((($4143$4165=(t1$4161===2))&&(($4144$4166=t0$4160[0])&&t0$4160[1]))){($4180$4182=buffer$4155);;if((($4180$4182 instanceof Array)&&((t0$4187=$4180$4182.length),((t0$4187===1)&&((t1$4188=$4180$4182[0]),((token$4193=t1$4188),((t1$4188 instanceof Array)&&((t2$4189=t1$4188.length),((t2$4189===3)&&(t1$4188[0]==="OP")))))))))){(fixity$4194=t1$4188[1]);(name$4195=t1$4188[2]);return [__lt____lt____lt____colon__$4118(["ID",name$4195],token$4193)];}else{(longer$4204=$4180$4182);(msg$4207="Too many consecutive operators were found here.");;throw $4766(["syntax","nullary"]).create(msg$4207,({"operators":buffer$4155}));}}else{if($4144$4166){t0$4160[1];(acc$4218=[]);;(temp$4223=buffer$4155);;($length$4228=temp$4223.length);;($index$4233=0);;$4215:for(;($index$4233<$length$4228);($index$4233++)){var token$4251;var name$4252;var t0$4246;var t1$4247;var m$4241;(m$4241=temp$4223[$index$4233]);;(t0$4246=m$4241);(token$4251=t0$4246);if(((t0$4246 instanceof Array)&&((t1$4247=t0$4246.length),((t1$4247===3)&&(t0$4246[0]==="OP"))))){t0$4246[1];(name$4252=t0$4246[2]);acc$4218.push(__lt____lt____lt____colon__$4118(["OP","PFX",name$4252],token$4251));}else{$4753(m$4241,"/home/olivier/git/earl-grey/src/lex.eg",7025,7119);;}}return acc$4218;}else{if(($4143$4165&&(t0$4160[0],t0$4160[1]))){(acc$4266=[]);;(temp$4271=buffer$4155);;($length$4276=temp$4271.length);;($index$4281=0);;$4263:for(;($index$4281<$length$4276);($index$4281++)){var token$4299;var name$4300;var t0$4294;var t1$4295;var m$4289;(m$4289=temp$4271[$index$4281]);;(t0$4294=m$4289);(token$4299=t0$4294);if(((t0$4294 instanceof Array)&&((t1$4295=t0$4294.length),((t1$4295===3)&&(t0$4294[0]==="OP"))))){t0$4294[1];(name$4300=t0$4294[2]);acc$4266.push(__lt____lt____lt____colon__$4118(["OP","SFX",name$4300],token$4299));}else{$4753(m$4289,"/home/olivier/git/earl-grey/src/lex.eg",7132,7226);;}}return acc$4266;}else{$4140$4156;(t0$4320=buffer$4155);if(((t0$4320 instanceof Array)&&((t1$4321=t0$4320.length),((t1$4321>=1)&&((t2$4322=t0$4320[0]),((first$4315=t2$4322),((t2$4322 instanceof Array)&&((t3$4323=t2$4322.length),((t3$4323===3)&&(t2$4322[0]==="OP")))))))))){(fixity$4316=t2$4322[1]);(name$4317=t2$4322[2]);(rest$4318=Array.prototype.slice.call(t0$4320,1));;}else{$4753(buffer$4155,"/home/olivier/git/earl-grey/src/lex.eg",7279,7285);}($4310$4332=[first$4315.wsb,first$4315.wsa]);;(bridge$4311$4337=$4310$4332);if((((bridge$4311$4337 instanceof Array)&&((t0$4347=bridge$4311$4337.length),((t0$4347===2)&&((!bridge$4311$4337[0])&&(!bridge$4311$4337[1])))))||((bridge$4311$4337 instanceof Array)&&((t0$4350=bridge$4311$4337.length),((t0$4350===2)&&(bridge$4311$4337[0]&&bridge$4311$4337[1])))))){return [__lt____lt____lt____colon__$4118(["OP","IFX",name$4317],first$4315)].concat(collapse_operators$4119(rest$4318,true,false));}else{if((($4312$4340=($4310$4332 instanceof Array))&&((t0$4338=$4310$4332.length),(($4314$4342=(t0$4338===2))&&$4310$4332[0])))){$4310$4332[1];return [__lt____lt____lt____colon__$4118(["OP","PFX",name$4317],first$4315)].concat(collapse_operators$4119(rest$4318,true,false));}else{if(($4314$4342&&($4310$4332[0],$4310$4332[1]))){(results$4364=collapse_operators$4119(rest$4318,false,false));;(t$4369=((($4372$4375=results$4364)),((bridge$4373$4380=$4372$4375),function(){if((((bridge$4373$4380 instanceof Array)&&((t0$4386=bridge$4373$4380.length),(t0$4386===0)))||((bridge$4373$4380 instanceof Array)&&((t0$4389=bridge$4373$4380.length),((t0$4389>=1)&&((t1$4390=bridge$4373$4380[0]),((t1$4390 instanceof Array)&&((t2$4391=t1$4390.length),((t2$4391>=2)&&((t1$4390[0]==="OP")&&((t1$4390[1]==="PFX")&&(Array.prototype.slice.call(t1$4390,2),(Array.prototype.slice.call(bridge$4373$4380,1),true))))))))))))){return ["OP","IFX",name$4317];}else{$4372$4375;return ["OP","SFX",name$4317];}}())));;return [__lt____lt____lt____colon__$4118(t$4369,first$4315)].concat(results$4364);}else{$4753($4310$4332);}}}}}}}}else{$4753($4139$4146);}});;(buffer$4120=[]);;(pfx$4121=true);;(collapse$4122=function(sfx$4416){var rval$4419;(rval$4419=collapse_operators$4119(buffer$4120,pfx$4121,sfx$4416));;(buffer$4120=[]);return rval$4419;});;(results$4123=[]);;(temp$4429=stream$4115);;($length$4434=temp$4429.length);;($index$4439=0);;$4124:for(;($index$4439<$length$4434);($index$4439++)){var other$4495;var name$4465;var $4127$4466;var t0$4460;var t1$4461;var token$4456;var $4126$4457;var t0$4452;var m$4447;(m$4447=temp$4429[$index$4439]);;(t0$4452=m$4447);(token$4456=t0$4452);($4126$4457=t0$4452);(t0$4460=$4126$4457);if(((t0$4460 instanceof Array)&&((t1$4461=t0$4460.length),((t1$4461===3)&&(t0$4460[0]==="OP"))))){($4127$4466=t0$4460[1]);(name$4465=t0$4460[2]);if(($4127$4466==="?FX")){buffer$4120.push(token$4456);}else{if(($4127$4466==="IFX")){(results$4123=results$4123.concat(collapse$4122(true)));results$4123.push(token$4456);(pfx$4121=true);}else{if(($4127$4466==="PFX")){(results$4123=results$4123.concat(collapse$4122(false)));results$4123.push(token$4456);(pfx$4121=true);}else{if(($4127$4466==="SFX")){(results$4123=results$4123.concat(collapse$4122(true)));results$4123.push(token$4456);(pfx$4121=false);}else{$4753($4127$4466,"/home/olivier/git/earl-grey/src/lex.eg",8080,8085);;}}}}}else{(other$4495=$4126$4457);(results$4123=results$4123.concat(collapse$4122(false)));results$4123.push(token$4456);(pfx$4121=false);}}return results$4123.concat(collapse$4122(true));});;(alternate_operators$3590=function(stream$4502){var $index$4535;var $length$4530;var temp$4525;var W$4505;var last_op$4506;var results$4507;(W$4505=function(x$4514){if(x$4514){return "wide";}else{return "short";}});;(last_op$4506=true);;(results$4507=[]);;(temp$4525=stream$4502);;($length$4530=temp$4525.length);;($index$4535=0);;$4508:for(;($index$4535<$length$4530);($index$4535++)){var x$4563;var $4576$4579;var x$4607;var token$4614;var fixity$4570;var name$4571;var t0$4556;var t1$4557;var token$4552;var $4510$4553;var t0$4548;var m$4543;(m$4543=temp$4525[$index$4535]);;(t0$4548=m$4543);(token$4552=t0$4548);($4510$4553=t0$4548);if((((x$4563=$4510$4553)),((x$4563 instanceof Array)&&(x$4563[0]==="IGNORE")))){null;}else{(t0$4556=$4510$4553);if(((t0$4556 instanceof Array)&&((t1$4557=t0$4556.length),((t1$4557===3)&&(t0$4556[0]==="OP"))))){(fixity$4570=t0$4556[1]);(name$4571=t0$4556[2]);if(last_op$4506){results$4507.push(["VOID"]);}($4576$4579=fixity$4570);;if(($4576$4579==="IFX")){results$4507.push(__lt____lt____colon__$3581(["IFX",W$4505((token$4552.wsa||token$4552.wsb)),name$4571],token$4552));(last_op$4506=true);}else{if(($4576$4579==="PFX")){if((!last_op$4506)){results$4507.push(["IFX",W$4505(token$4552.wsb),"WHITE"],["VOID"]);}results$4507.push(__lt____lt____colon__$3581(["PFX",W$4505(token$4552.wsa),name$4571],token$4552));(last_op$4506=true);}else{if(($4576$4579==="SFX")){results$4507.push(__lt____lt____colon__$3581(["SFX",W$4505(token$4552.wsb),name$4571],token$4552),["VOID"]);(last_op$4506=false);}else{$4753($4576$4579);;}}}}else{if((((x$4607=$4510$4553)),((x$4607 instanceof Array)&&(x$4607[0]==="ILLEGAL")))){throw $4766(["syntax","illegal"]).create("unknown character",({"chr":token$4552}));}else{(token$4614=$4510$4553);if((!last_op$4506)){results$4507.push(["IFX",W$4505(token$4614.wsb),"WHITE"]);}results$4507.push(token$4614);(last_op$4506=false);}}}}if(last_op$4506){results$4507.push(["VOID"]);}return results$4507;});;(fill_locations$3591=function(source$4623,stream$4624){var $index$4694;var $length$4689;var temp$4684;var to_fill$4627;var start$4628;var fill$4629;(to_fill$4627=[]);;(start$4628=0);;(fill$4629=function(end$4641){var $index$4658;var $length$4653;var temp$4648;(temp$4648=to_fill$4627);;($length$4653=temp$4648.length);;($index$4658=0);;$4644:for(;($index$4658<$length$4653);($index$4658++)){var token$4679;var token$4674;var m$4666;(m$4666=temp$4648[$index$4658]);;(token$4674=m$4666);if(($index$4658===0)){(token$4674["location"]=Location$3580(source$4623,start$4628,end$4641));}else{(token$4679=m$4666);(token$4679["location"]=Location$3580(source$4623,end$4641,end$4641));}}return (to_fill$4627=[]);});;(temp$4684=stream$4624);;($length$4689=temp$4684.length);;($index$4694=0);;$4630:for(;($index$4694<$length$4689);($index$4694++)){var other$4718;var location$4711;var t0$4707;var m$4702;(m$4702=temp$4684[$index$4694]);;(t0$4707=m$4702);if(($5029(t0$4707,"location")&&((location$4711=t0$4707.location),location$4711))){fill$4629(location$4711.start);(start$4628=location$4711.end);}else{(other$4718=m$4702);to_fill$4627.push(other$4718);}}fill$4629(source$4623.text.length);return stream$4624;});;(tokenize$3592=function(src$4724){var it$0$4747;var it$0$4742;var it$0$4737;var it$0$4732;var it$0$4727;(it$0$4727=src$4724);;(it$0$4732=produce$3586(it$0$4727));;(it$0$4737=process_indent$3588(it$0$4732));;(it$0$4742=disambiguate_fixity$3589(it$0$4737));;(it$0$4747=alternate_operators$3590(it$0$4742));;return fill_locations$3591(src$4724,it$0$4747);});;(exports["tokenize"]=tokenize$3592);

},{"./location":7}],7:[function(require,module,exports){
var $5228=function(type$5230){var f$5233;(f$5233=type$5230["::check"]);;if((f$5233===(void 0))){return function(value$5238){return (value$5238 instanceof type$5230);};}else{return function(value$5241){return f$5233.call(type$5230,value$5241);};}};
var $5243=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $5244=function(dest$5246,values$5247){var k$5252;(k$5252=null);$5250:for(k$5252 in values$5247){if(values$5247.hasOwnProperty(k$5252)){(dest$5246[k$5252]=values$5247[k$5252]);}}return dest$5246;};
var $5256=function($5257$5259){var ph$5263;(ph$5263=$5257$5259);;var $5261$5268;($5261$5268=ph$5263);;var bridge$5262$5273;var x$5277;(bridge$5262$5273=$5261$5268);if((((typeof(bridge$5262$5273)==="string")&&((x$5277=bridge$5262$5273),true))||((typeof(bridge$5262$5273)==="number")&&((x$5277=bridge$5262$5273),true)))){return ["value",x$5277];}else{var other$5284;(other$5284=$5261$5268);return other$5284["::serialize_ast"]();}};
var send$5068;(send$5068=function(obj$5073,$5071$5074){var ph$5078;var msg$5079;var t0$5081;(t0$5081=$5071$5074);(msg$5079=t0$5081);(ph$5078=t0$5081);;var $5076$5085;($5076$5085=ph$5078);;var bridge$5077$5090;(bridge$5077$5090=$5076$5085);if(((typeof(bridge$5077$5090)==="string")||(typeof(bridge$5077$5090)==="number"))){return obj$5073[msg$5079];}else{var other$5098;(other$5098=$5076$5085);return obj$5073["::send"](msg$5079);}});;(Array[":::project"]=function($5101$5103){var ph$5106;var value$5107;var t0$5109;(t0$5109=$5101$5103);(value$5107=t0$5109);(ph$5106=t0$5109);;var $5105$5113;($5105$5113=ph$5106);;if($5228(Array)($5105$5113)){return [true,value$5107];}else{$5105$5113;return [true,[value$5107]];}});(Array.prototype["::check"]=function(value$5127){if((value$5127 instanceof Array)){var i$5132;(i$5132=0);;$5130:for(;(i$5132<this.length);(i$5132++)){if(($5243(this,i$5132)!==$5243(value$5127,i$5132))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $5244(this.slice(0),this);});(Array.prototype[":::project"]=function(value$5143){if((value$5143 instanceof Array)){var i$5148;(i$5148=0);;$5146:for(;(i$5148<this.length);(i$5148++)){if(($5243(this,i$5148)!==$5243(value$5143,i$5148))){return [true,[value$5143]];}}return [true,value$5143.slice(this.length)];}else{return [true,[value$5143]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($5256));});(RegExp.prototype["::check"]=function($5158$5160){var ph$5163;(ph$5163=$5158$5160);;var $5162$5168;($5162$5168=ph$5163);;var value$5176;if((typeof($5162$5168)==="string")){(value$5176=$5162$5168);if(value$5176.match(this)){return true;}else{return false;}}else{var other$5181;(other$5181=$5162$5168);return false;}});(RegExp.prototype[":::project"]=function($5183$5185){var ph$5188;(ph$5188=$5183$5185);;var $5187$5193;($5187$5193=ph$5188);;var value$5201;if((typeof($5187$5193)==="string")){(value$5201=$5187$5193);var $5204$5206;($5204$5206=value$5201.match(this));;var m$5214;if(($5204$5206===null)){(m$5214=$5204$5206);return [false,null];}else{var m$5219;(m$5219=$5204$5206);return [true,m$5219];}}else{var other$5223;(other$5223=$5187$5193);return [false,null];}});(Function.prototype["::send"]=function(args$5226){return this.apply(this,args$5226);});
var $7000=function(arr$7002){var results$7006;var l$7007;(results$7006=[]);;(l$7007=arr$7002.length);;var i$7015;(i$7015=0);;$7005:for(;(i$7015<l$7007);(i$7015++)){results$7006.push([i$7015,$5243(arr$7002,i$7015)]);}return results$7006;};
var $6831=function(){var $6832$6834;($6832$6834=function(tags$6838){var it$0$6841;(it$0$6841=function(){if((!$5228($6832$6834)(this))){return Object.create($6832$6834.prototype);}else{return this;}}());;(it$0$6841["tags"]=tags$6838);return it$0$6841;});;($6832$6834.prototype["create"]=function(){var $6850$6852;($6850$6852=arguments);;var t0$6857;var message$6861;var args$6862;(t0$6857=$6850$6852.length);if((t0$6857>=0)){(message$6861=function(){if((0>=t0$6857)){return "";}else{return $6850$6852[0];}}());(args$6862=Array.prototype.slice.call($6850$6852,1));var it$0$6866;(it$0$6866=this);;var self$6871;(self$6871=this);;var e$6876;(e$6876=Error(message$6861));;(e$6876["::tags"]=it$0$6866.tags);(e$6876["args"]=args$6862);var temp$6884;(temp$6884=$7000(args$6862));;var $length$6889;($length$6889=temp$6884.length);;var $index$6894;($index$6894=0);;$6877:for(;($index$6894<$length$6889);($index$6894++)){var m$6902;(m$6902=temp$6884[$index$6894]);;var t0$6907;var t1$6908;var i$6912;var arg$6913;(t0$6907=m$6902);if(((t0$6907 instanceof Array)&&((t1$6908=t0$6907.length),(t1$6908===2)))){(i$6912=t0$6907[0]);(arg$6913=t0$6907[1]);(e$6876[i$6912]=arg$6913);}else{$6818(m$6902);;}}(e$6876["length"]=args$6862.length);(e$6876["name"]=["E"].concat(it$0$6866.tags).join("."));return e$6876;}else{$6818($6850$6852);}});($6832$6834.prototype["::check"]=function(e$6924){var it$0$6927;(it$0$6927=this);;var self$6932;(self$6932=this);;var tags$6937;if(((!e$6924)||(!$5228(Error)(e$6924)))){return false;}(tags$6937=(e$6924["::tags"]||[]));;var temp$6946;(temp$6946=it$0$6927.tags);;var $length$6951;($length$6951=temp$6946.length);;var $index$6956;($index$6956=0);;$6938:for(;($index$6956<$length$6951);($index$6956++)){var m$6964;(m$6964=temp$6946[$index$6956]);;var tag$6972;(tag$6972=m$6964);if((tags$6937.indexOf(tag$6972)===-1)){return false;}else{false;;}}return true;});($6832$6834.prototype["::deconstruct"]=function(e$6980){var it$0$6983;(it$0$6983=this);;var self$6988;(self$6988=this);;return e$6980.args;});$5244($6832$6834,$5244(function(){var accum$6993;(accum$6993=({}));(accum$6993["::name"]="$6832");return accum$6993;}(),function(){var accum$6997;(accum$6997=({}));(accum$6997["::egclass"]=true);return accum$6997;}()));return $6832$6834;}();
var $6818=function(value$6820,url$6821,start$6822,end$6823){var err$6826;(err$6826=$6831(["match"]).create("Could not find a match for value",({"value":value$6820})));;if(url$6821){(err$6826["location"]=["location",url$6821,start$6822,end$6823]);}throw err$6826;};
var $7149=function(type$7151){return function(value$7154){var f$7157;(f$7157=type$7151[":::project"]);;if((f$7157===(void 0))){(f$7157=type$7151["::project"]);if((f$7157===(void 0))){return [true,type$7151(value$7154)];}else{var rval$7163;(rval$7163=false);;try{(rval$7163=[true,f$7157(value$7154)]);}catch(excv$7169){var e$7175;(e$7175=excv$7169);(rval$7163=[false,null]);}return rval$7163;}}else{return f$7157.call(type$7151,value$7154);}};};
var $7022=function(){var $7023$7025;($7023$7025=function($7028$7031,$7029$7032){var classes$7034;var children$7035;var t0$7037;(t0$7037=$7149(Array)($7028$7031));if(t0$7037[0]){(classes$7034=t0$7037[1]);;}else{$6818($7028$7031);}var t0$7042;(t0$7042=$7149(Array)($7029$7032));if(t0$7042[0]){(children$7035=t0$7042[1]);;}else{$6818($7029$7032);}var it$0$7047;(it$0$7047=function(){if((!$5228($7023$7025)(this))){return Object.create($7023$7025.prototype);}else{return this;}}());;(it$0$7047["classes"]=classes$7034.sort());(it$0$7047["children"]=children$7035);return it$0$7047;});;$5244(function(){var accum$7055;(accum$7055=({}));(accum$7055["::check"]=function(x$7059){return ((x$7059&&x$7059.classes)&&x$7059.children);});return accum$7055;}(),$5244(function(){var accum$7062;(accum$7062=({}));(accum$7062["::deconstruct"]=function(x$7066){return [x$7066.classes,x$7066.children];});return accum$7062;}(),$5244(function(){var accum$7069;(accum$7069=({}));(accum$7069["::name"]="$7023");return accum$7069;}(),function(){var accum$7073;(accum$7073=({}));(accum$7073["::egclass"]=true);return accum$7073;}())));($7023$7025.prototype["::check"]=function(n$7079){var it$0$7082;(it$0$7082=this);;var self$7087;(self$7087=this);;var temp$7096;(temp$7096=it$0$7082.classes);;var $length$7101;($length$7101=temp$7096.length);;var $index$7106;($index$7106=0);;$7092:for(;($index$7106<$length$7101);($index$7106++)){var m$7114;(m$7114=temp$7096[$index$7106]);;var c$7122;(c$7122=m$7114);if((n$7079.classes.indexOf(c$7122)===-1)){return false;}else{false;;}}return true;});$5244($7023$7025,$5244(function(){var accum$7128;(accum$7128=({}));(accum$7128["::check"]=function(x$7132){return ((x$7132&&x$7132.classes)&&x$7132.children);});return accum$7128;}(),$5244(function(){var accum$7135;(accum$7135=({}));(accum$7135["::deconstruct"]=function(x$7139){return [x$7139.classes,x$7139.children];});return accum$7135;}(),$5244(function(){var accum$7142;(accum$7142=({}));(accum$7142["::name"]="$7023");return accum$7142;}(),function(){var accum$7146;(accum$7146=({}));(accum$7146["::egclass"]=true);return accum$7146;}()))));return $7023$7025;}();
var $7177=function(from$7179,to$7180){var rval$7184;(rval$7184=[]);;var i$7189;(i$7189=from$7179);;$7183:for(;(i$7189<=to$7180);(i$7189++)){rval$7184.push(i$7189);}return rval$7184;};
var $7196=function(obj$7198){var results$7202;(results$7202=[]);;var k$7207;(k$7207=null);$7201:for(k$7207 in obj$7198){if(Object.prototype.hasOwnProperty.call(obj$7198,k$7207)){results$7202.push([k$7207,$5243(obj$7198,k$7207)]);}}return results$7202;};
var $7211=function($7212$7214,key$7215){var ph$7219;(ph$7219=$7212$7214);;var $7217$7224;($7217$7224=ph$7219);;var bridge$7218$7229;(bridge$7218$7229=$7217$7224);if(((bridge$7218$7229===null)||(bridge$7218$7229===(void 0)))){return false;}else{var x$7237;if((typeof($7217$7224)==="string")){(x$7237=$7217$7224);return (key$7215 in String.prototype);}else{var x$7242;if((typeof($7217$7224)==="number")){(x$7242=$7217$7224);return (key$7215 in Number.prototype);}else{var x$7247;(x$7247=$7217$7224);return (key$7215 in x$7247);}}}};var accum$5434;var accum$5438;var accum$5664;var accum$5668;var $5288$5290;var binsearch$5291;var $5289$5292;var __lt____gt__$5293;var repr$5294;var fs$5295;var Source$5296;var Location$5297;var highlight$5298;var highlight_lines$5299;var clamp$5300;var morsel$5301;var highlight_locations$5302;var highlight_locations_same_source$5303;var merge_locations$5304;var __lt____lt____colon__$5305;var __plus____plus____colon__$5306;var format_error$5307;var display_error$5308;($5288$5290=require("./util"));;(binsearch$5291=$5288$5290.binsearch);;($5289$5292=require("./pp"));;(__lt____gt__$5293=$5289$5292["<>"]);;(repr$5294=$5289$5292.repr);;(fs$5295=require("fs"));;(Source$5296=function(){var $index$5370;var $length$5365;var temp$5360;var curr$5352;var it$0$5346;var text$5341;var url$5342;var t0$5337;var $5330$5332;($5330$5332=arguments);;(t0$5337=$5330$5332.length);if(((t0$5337>=1)&&(t0$5337<=2))){(text$5341=$5330$5332[0]);(url$5342=function(){if((1>=t0$5337)){return false;}else{return $5330$5332[1];}}());(it$0$5346=function(){if((!$5228(Source$5296)(this))){return Object.create(Source$5296.prototype);}else{return this;}}());;(it$0$5346["text"]=text$5341);(it$0$5346["url"]=url$5342);(it$0$5346["counts"]=[]);(curr$5352=0);;(temp$5360=text$5341.split("\n"));;($length$5365=temp$5360.length);;($index$5370=0);;$5353:for(;($index$5370<$length$5365);($index$5370++)){var line$5386;var m$5378;(m$5378=temp$5360[$index$5370]);;(line$5386=m$5378);it$0$5346.counts.push(curr$5352);(curr$5352=(curr$5352+(line$5386.length+1)));}it$0$5346.counts.push(curr$5352);(it$0$5346["nlines"]=(it$0$5346.counts.length-1));return it$0$5346;}else{$6818($5330$5332);}});;(Source$5296.prototype["linecol"]=function(pos$5395){var line$5408;var col$5409;var self$5403;var it$0$5398;(it$0$5398=this);;(self$5403=this);;(line$5408=binsearch$5291(it$0$5398.counts,pos$5395));;(col$5409=(pos$5395-$5243(it$0$5398.counts,(line$5408-1))));;return [line$5408,col$5409];});(Source$5296.prototype["highlight_lines"]=function(l1$5419,l2$5420,spans$5421){var self$5429;var it$0$5424;(it$0$5424=this);;(self$5429=this);;return highlight_lines$5299(it$0$5424.text,it$0$5424.counts,[(l1$5419-1),(l2$5420-1)],spans$5421);});$5244(Source$5296,$5244(((accum$5434=({})),((accum$5434["::name"]="Source"),accum$5434)),((accum$5438=({})),((accum$5438["::egclass"]=true),accum$5438))));Source$5296;(Location$5297=function(source$5444,start$5445,end$5446){var it$0$5449;(it$0$5449=function(){if((!$5228(Location$5297)(this))){return Object.create(Location$5297.prototype);}else{return this;}}());;(it$0$5449["source"]=(source$5444||Source$5296("",null)));(it$0$5449["start"]=start$5445);(it$0$5449["end"]=end$5446);return it$0$5449;});;(Location$5297.prototype["text"]=function(){var self$5466;var it$0$5461;(it$0$5461=this);;(self$5466=this);;return it$0$5461.source.text.slice(it$0$5461.start,it$0$5461.end);});(Location$5297.prototype["linerange"]=function(){var l2$5515;var t0$5506;var t1$5507;var l1$5498;var $5481$5499;var t0$5492;var t1$5493;var t2$5494;var $5480$5487;var self$5482;var it$0$5475;(it$0$5475=this);;(self$5482=this);;($5480$5487=it$0$5475.linecol());;if((($5480$5487 instanceof Array)&&((t0$5492=$5480$5487.length),((t0$5492===2)&&((t1$5493=$5480$5487[0]),((t1$5493 instanceof Array)&&((t2$5494=t1$5493.length),(t2$5494===2)))))))){(l1$5498=t1$5493[0]);t1$5493[1];($5481$5499=$5480$5487[1]);if(($5481$5499===null)){return [l1$5498,l1$5498];}else{(t0$5506=$5481$5499);if(((t0$5506 instanceof Array)&&((t1$5507=t0$5506.length),(t1$5507===2)))){(l2$5515=t0$5506[0]);t0$5506[1];return [l1$5498,l2$5515];}else{$6818($5481$5499,"/home/olivier/git/earl-grey/src/location.eg",975,980);}}}else{$6818($5480$5487);}});(Location$5297.prototype["linecol"]=function(){var start$5538;var end$5539;var self$5533;var it$0$5528;(it$0$5528=this);;(self$5533=this);;(start$5538=it$0$5528.source.linecol(it$0$5528.start));;(end$5539=function(){if((it$0$5528.start===it$0$5528.end)){return null;}else{return it$0$5528.source.linecol((it$0$5528.end-1));}}());;return [start$5538,end$5539];});(Location$5297.prototype["ref"]=function(){var otherwise$5627;var $5608$5616;var $5607$5610;var l2$5599;var c2$5600;var t0$5588;var t1$5589;var t2$5590;var t3$5591;var l1$5576;var c1$5577;var $5557$5578;var t0$5568;var t1$5569;var t2$5570;var t3$5571;var t4$5572;var $5556$5563;var self$5558;var it$0$5551;(it$0$5551=this);;(self$5558=this);;($5556$5563=it$0$5551.linecol());;if((($5556$5563 instanceof Array)&&((t0$5568=$5556$5563.length),((t0$5568===2)&&((t1$5569=$5556$5563[0]),((t1$5569 instanceof Array)&&((t2$5570=t1$5569.length),((t2$5570===2)&&((t3$5571=[true,String(t1$5569[0])]),(t3$5571[0]&&((l1$5576=t3$5571[1]),((t4$5572=[true,String(t1$5569[1])]),t4$5572[0])))))))))))){(c1$5577=t4$5572[1]);($5557$5578=$5556$5563[1]);if(($5557$5578===null)){return ((l1$5576+":")+c1$5577);}else{(t0$5588=$5557$5578);if(((t0$5588 instanceof Array)&&((t1$5589=t0$5588.length),((t1$5589===2)&&((t2$5590=[true,String(t0$5588[0])]),(t2$5590[0]&&((l2$5599=t2$5590[1]),((t3$5591=[true,String(t0$5588[1])]),t3$5591[0])))))))){(c2$5600=t3$5591[1]);($5607$5610=null);;$5607$5610;if(((l1$5576===l2$5599)&&(c1$5577===c2$5600))){return ((l1$5576+":")+c1$5577);}else{if((l1$5576===l2$5599)){return ((((l1$5576+":")+c1$5577)+"-")+c2$5600);}else{(otherwise$5627=$5607$5610);return ((((((l1$5576+":")+c1$5577)+"-")+l1$5576)+":")+c2$5600);}}}else{$6818($5557$5578,"/home/olivier/git/earl-grey/src/location.eg",1317,1322);}}}else{$6818($5556$5563);}});(Location$5297.prototype["highlight"]=function(){var self$5657;var it$0$5652;var cls$5647;var context$5648;var t0$5643;var $5636$5638;($5636$5638=arguments);;(t0$5643=$5636$5638.length);if(((t0$5643>=0)&&(t0$5643<=2))){(cls$5647=function(){if((0>=t0$5643)){return "hl1";}else{return $5636$5638[0];}}());(context$5648=function(){if((1>=t0$5643)){return 0;}else{return $5636$5638[1];}}());(it$0$5652=this);;(self$5657=this);;return highlight_locations$5302([[it$0$5652,cls$5647]],context$5648);}else{$6818($5636$5638);}});$5244(Location$5297,$5244(((accum$5664=({})),((accum$5664["::name"]="Location"),accum$5664)),((accum$5668=({})),((accum$5668["::egclass"]=true),accum$5668))));Location$5297;(highlight$5298=function(){var $index$5708;var $length$5703;var temp$5698;var acc$5693;var text$5685;var spans$5686;var offset$5687;var t0$5681;var $5674$5676;($5674$5676=arguments);;(t0$5681=$5674$5676.length);if(((t0$5681>=2)&&(t0$5681<=3))){(text$5685=$5674$5676[0]);(spans$5686=$5674$5676[1]);(offset$5687=function(){if((2>=t0$5681)){return 0;}else{return $5674$5676[2];}}());return $7022([],(((acc$5693=[])),(((temp$5698=morsel$5301(spans$5686))),((($length$5703=temp$5698.length)),((($index$5708=0)),function(){$5690:for(;($index$5708<$length$5703);($index$5708++)){var xstart$5733;var xend$5734;var start$5726;var end$5727;var attributes$5728;var t0$5721;var t1$5722;var m$5716;(m$5716=temp$5698[$index$5708]);;(t0$5721=m$5716);if(((t0$5721 instanceof Array)&&((t1$5722=t0$5721.length),(t1$5722===3)))){(start$5726=t0$5721[0]);(end$5727=t0$5721[1]);(attributes$5728=t0$5721[2]);acc$5693.push((((xstart$5733=Math.max((start$5726-offset$5687),0))),((xend$5734=Math.min((end$5727-offset$5687),text$5685.length))),$7022(attributes$5728.slice(0,1),[text$5685.slice(xstart$5733,xend$5734)])));}else{$6818(m$5716,"/home/olivier/git/earl-grey/src/location.eg",1864,2076);;}}}()))),acc$5693));}else{$6818($5674$5676);}});;(highlight_lines$5299=function(text$5750,linelocs$5751,$5748$5752,spans$5753){var t0$5758;var t1$5759;var $index$5782;var $length$5777;var temp$5772;var acc$5767;var l1$5755;var l2$5756;(t0$5758=$5748$5752);if(((t0$5758 instanceof Array)&&((t1$5759=t0$5758.length),(t1$5759===2)))){(l1$5755=t0$5758[0]);(l2$5756=t0$5758[1]);;}else{$6818($5748$5752);}return $7022(["+span"],(((acc$5767=[])),(((temp$5772=$7177(l1$5755,l2$5756))),((($length$5777=temp$5772.length)),((($index$5782=0)),function(){$5764:for(;($index$5782<$length$5777);($index$5782++)){var start$5801;var end$5802;var lineno$5798;var m$5790;(m$5790=temp$5772[$index$5782]);;(lineno$5798=m$5790);acc$5767.push((((start$5801=$5243(linelocs$5751,lineno$5798))),((end$5802=$5243(linelocs$5751,(lineno$5798+1)))),$7022(["+span"],[$7022(["lineno"],(lineno$5798+1)),$7022(["source"],highlight$5298(text$5750,[[start$5801,end$5802,[]]].concat(clamp$5300(spans$5753,start$5801,end$5802))))])));}}()))),acc$5767));});;(clamp$5300=function(spans$5813,bot$5814,top$5815){var $index$5835;var $length$5830;var temp$5825;var acc$5820;(acc$5820=[]);;(temp$5825=spans$5813);;($length$5830=temp$5825.length);;($index$5835=0);;$5817:for(;($index$5835<$length$5830);($index$5835++)){var start$5853;var end$5854;var attr$5855;var t0$5848;var t1$5849;var m$5843;(m$5843=temp$5825[$index$5835]);;(t0$5848=m$5843);if(((t0$5848 instanceof Array)&&((t1$5849=t0$5848.length),((t1$5849===3)&&((start$5853=t0$5848[0]),((end$5854=t0$5848[1]),((attr$5855=t0$5848[2]),((end$5854>=bot$5814)&&(start$5853<=top$5815))))))))){acc$5820.push([Math.max(start$5853,bot$5814),Math.min(end$5854,top$5815),attr$5855]);}else{false;;}}return acc$5820;});;(morsel$5301=function(spans$5868){var jump$5871;var jumptill$5872;var process_elements$5873;var thespans$5874;(jump$5871=function(active$5878,bot$5879,top$5880){var $index$5908;var $length$5903;var temp$5898;var acc$5893;var $index$5948;var $length$5943;var temp$5938;var e$5883;var attributes$5884;(e$5883=$5243(Math.min,[top$5880].concat((((acc$5893=[])),(((temp$5898=active$5878)),((($length$5903=temp$5898.length)),((($index$5908=0)),function(){$5890:for(;($index$5908<$length$5903);($index$5908++)){var x$5926;var t0$5921;var t1$5922;var m$5916;(m$5916=temp$5898[$index$5908]);;(t0$5921=m$5916);if(((t0$5921 instanceof Array)&&((t1$5922=t0$5921.length),(t1$5922===3)))){t0$5921[0];(x$5926=t0$5921[1]);t0$5921[2];acc$5893.push(x$5926);}else{$6818(m$5916,"/home/olivier/git/earl-grey/src/location.eg",3399,3442);;}}}()))),acc$5893))));;(attributes$5884=[]);;(temp$5938=active$5878);;($length$5943=temp$5938.length);;($index$5948=0);;$5885:for(;($index$5948<$length$5943);($index$5948++)){var X$5966;var t0$5961;var t1$5962;var m$5956;(m$5956=temp$5938[$index$5948]);;(t0$5961=m$5956);if(((t0$5961 instanceof Array)&&((t1$5962=t0$5961.length),(t1$5962===3)))){t0$5961[0];t0$5961[1];(X$5966=t0$5961[2]);(attributes$5884=attributes$5884.concat(X$5966));}else{$6818(m$5956,"/home/olivier/git/earl-grey/src/location.eg",3464,3505);;}}return [e$5883,[bot$5879,e$5883,attributes$5884]];});;(jumptill$5872=function(active$5976,bot$5977,top$5978){var t0$5987;var t1$5988;var $index$6013;var $length$6008;var temp$6003;var acc$5998;var t0$6044;var t1$6045;var newbot$5981;var span$5982;var newactive$5983;var spans$5984;var remainder$5985;if((bot$5977===top$5978)){return [[],active$5976];}else{(t0$5987=jump$5871(active$5976,bot$5977,top$5978));if(((t0$5987 instanceof Array)&&((t1$5988=t0$5987.length),(t1$5988===2)))){(newbot$5981=t0$5987[0]);(span$5982=t0$5987[1]);;}else{$6818(jump$5871(active$5976,bot$5977,top$5978),"/home/olivier/git/earl-grey/src/location.eg",3741,3775);}(newactive$5983=(((acc$5998=[])),(((temp$6003=active$5976)),((($length$6008=temp$6003.length)),((($index$6013=0)),function(){$5995:for(;($index$6013<$length$6008);($index$6013++)){var x$6031;var e$6032;var attr$6033;var t0$6026;var t1$6027;var m$6021;(m$6021=temp$6003[$index$6013]);;(t0$6026=m$6021);(x$6031=t0$6026);if(((t0$6026 instanceof Array)&&((t1$6027=t0$6026.length),((t1$6027===3)&&(t0$6026[0],((e$6032=t0$6026[1]),((attr$6033=t0$6026[2]),(e$6032>newbot$5981)))))))){acc$5998.push(x$6031);}else{false;;}}}()))),acc$5998));;(t0$6044=jumptill$5872(newactive$5983,newbot$5981,top$5978));if(((t0$6044 instanceof Array)&&((t1$6045=t0$6044.length),(t1$6045===2)))){(spans$5984=t0$6044[0]);(remainder$5985=t0$6044[1]);;}else{$6818(jumptill$5872(newactive$5983,newbot$5981,top$5978),"/home/olivier/git/earl-grey/src/location.eg",3890,3934);}return [[span$5982].concat(spans$5984),remainder$5985];}});;(process_elements$5873=function(start$6054,active$6055,rem$6056){var $index$6121;var $length$6116;var temp$6111;var acc$6106;var t0$6150;var t1$6151;var top$6098;var bot$6099;var spans$6100;var t0$6178;var t1$6179;var spans$6175;var newactive$6176;var start$6158;var active$6159;var next$6160;var target$6161;var end$6162;var attr$6163;var rest$6164;var start$6089;var active$6090;var $6059$6074;var $6060$6075;var $6061$6076;var t0$6068;var t1$6069;var t2$6070;var t3$6071;var t4$6072;var $6058$6063;($6058$6063=[start$6054,active$6055,rem$6056]);;if((($6059$6074=($6058$6063 instanceof Array))&&((t0$6068=$6058$6063.length),(($6061$6076=(t0$6068===3))&&($6058$6063[0],((t1$6069=$6058$6063[1]),((t1$6069 instanceof Array)&&((t2$6070=t1$6069.length),((t2$6070===0)&&((t3$6071=$6058$6063[2]),((t3$6071 instanceof Array)&&((t4$6072=t3$6071.length),(t4$6072===0))))))))))))){return [];}else{if(($6061$6076&&((start$6089=$6058$6063[0]),((active$6090=$6058$6063[1]),((t1$6069=$6058$6063[2]),((t1$6069 instanceof Array)&&((t2$6070=t1$6069.length),(t2$6070===0)))))))){(top$6098=$5243(Math.max,(((acc$6106=[])),(((temp$6111=active$6090)),((($length$6116=temp$6111.length)),((($index$6121=0)),function(){$6103:for(;($index$6121<$length$6116);($index$6121++)){var e$6139;var t0$6134;var t1$6135;var m$6129;(m$6129=temp$6111[$index$6121]);;(t0$6134=m$6129);if(((t0$6134 instanceof Array)&&((t1$6135=t0$6134.length),(t1$6135===3)))){t0$6134[0];(e$6139=t0$6134[1]);t0$6134[2];acc$6106.push(e$6139);}else{$6818(m$6129,"/home/olivier/git/earl-grey/src/location.eg",4119,4157);;}}}()))),acc$6106)));;(bot$6099=Math.min(start$6089,top$6098));;(t0$6150=jumptill$5872(active$6090,start$6089,top$6098));if(((t0$6150 instanceof Array)&&((t1$6151=t0$6150.length),(t1$6151===2)))){(spans$6100=t0$6150[0]);t0$6150[1];;}else{$6818(jumptill$5872(active$6090,start$6089,top$6098),"/home/olivier/git/earl-grey/src/location.eg",4210,4248);}return spans$6100;}else{if(($6061$6076&&((start$6158=$6058$6063[0]),((active$6159=$6058$6063[1]),((t1$6069=$6058$6063[2]),((t1$6069 instanceof Array)&&((t2$6070=t1$6069.length),((t2$6070>=1)&&((t3$6071=t1$6069[0]),((next$6160=t3$6071),((t3$6071 instanceof Array)&&((t4$6072=t3$6071.length),(t4$6072===3))))))))))))){(target$6161=t3$6071[0]);(end$6162=t3$6071[1]);(attr$6163=t3$6071[2]);(rest$6164=Array.prototype.slice.call(t1$6069,1));(t0$6178=jumptill$5872(active$6159,start$6158,target$6161));if(((t0$6178 instanceof Array)&&((t1$6179=t0$6178.length),(t1$6179===2)))){(spans$6175=t0$6178[0]);(newactive$6176=t0$6178[1]);;}else{$6818(jumptill$5872(active$6159,start$6158,target$6161),"/home/olivier/git/earl-grey/src/location.eg",4352,4393);}return spans$6175.concat(process_elements$5873(target$6161,[next$6160].concat(newactive$6176),rest$6164));}else{$6818($6058$6063);}}}});;(thespans$5874=spans$5868.sort(function($6189$6192,$6190$6193){var t0$6200;var t1$6201;var t0$6207;var t1$6208;var s1$6195;var e1$6196;var s2$6197;var e2$6198;(t0$6200=$6189$6192);if(((t0$6200 instanceof Array)&&((t1$6201=t0$6200.length),(t1$6201===3)))){(s1$6195=t0$6200[0]);(e1$6196=t0$6200[1]);t0$6200[2];;}else{$6818($6189$6192);}(t0$6207=$6190$6193);if(((t0$6207 instanceof Array)&&((t1$6208=t0$6207.length),(t1$6208===3)))){(s2$6197=t0$6207[0]);(e2$6198=t0$6207[1]);t0$6207[2];;}else{$6818($6190$6193);}if((s1$6195===s2$6197)){return (e1$6196-e2$6198);}else{return (s1$6195-s2$6197);}}));;return process_elements$5873(thespans$5874[0][0],[],thespans$5874);});;(highlight_locations$5302=function(){var $index$6252;var $length$6247;var temp$6242;var $index$6301;var $length$6296;var temp$6291;var acc$6286;var srcs$6234;var locations$6229;var context$6230;var t0$6225;var $6218$6220;($6218$6220=arguments);;(t0$6225=$6218$6220.length);if(((t0$6225>=1)&&(t0$6225<=2))){(locations$6229=$6218$6220[0]);(context$6230=function(){if((1>=t0$6225)){return 0;}else{return $6218$6220[1];}}());(srcs$6234=({}));;(temp$6242=locations$6229);;($length$6247=temp$6242.length);;($index$6252=0);;$6235:for(;($index$6252<$length$6247);($index$6252++)){var key$6276;var loc$6270;var cls$6271;var t0$6265;var t1$6266;var m$6260;(m$6260=temp$6242[$index$6252]);;(t0$6265=m$6260);if(((t0$6265 instanceof Array)&&((t1$6266=t0$6265.length),(t1$6266===2)))){(loc$6270=t0$6265[0]);(cls$6271=t0$6265[1]);(key$6276=String((loc$6270.source&&loc$6270.source.url)));;if((!$5243(srcs$6234,key$6276))){(srcs$6234[key$6276]=[]);}$5243(srcs$6234,key$6276).push([loc$6270,cls$6271]);}else{$6818(m$6260,"/home/olivier/git/earl-grey/src/location.eg",4739,4909);;}}return $7022(["+div"],(((acc$6286=[])),(((temp$6291=$7196(srcs$6234))),((($length$6296=temp$6291.length)),((($index$6301=0)),function(){$6283:for(;($index$6301<$length$6296);($index$6301++)){var locs$6319;var t0$6314;var t1$6315;var m$6309;(m$6309=temp$6291[$index$6301]);;(t0$6314=m$6309);if(((t0$6314 instanceof Array)&&((t1$6315=t0$6314.length),(t1$6315===2)))){t0$6314[0];(locs$6319=t0$6314[1]);acc$6286.push(highlight_locations_same_source$5303(locs$6319,context$6230));}else{$6818(m$6309,"/home/olivier/git/earl-grey/src/location.eg",4914,5008);;}}}()))),acc$6286));}else{$6818($6218$6220);}});;(highlight_locations_same_source$5303=function(){var $index$6373;var $length$6368;var temp$6363;var acc$6358;var t0$6403;var t1$6404;var $index$6433;var $length$6428;var temp$6423;var acc$6418;var $index$6476;var $length$6471;var temp$6466;var acc$6461;var loc$6347;var src$6348;var l1$6349;var l2$6350;var first$6351;var last$6352;var locations$6342;var context$6343;var t0$6338;var $6331$6333;($6331$6333=arguments);;(t0$6338=$6331$6333.length);if(((t0$6338>=1)&&(t0$6338<=2))){(locations$6342=$6331$6333[0]);(context$6343=function(){if((1>=t0$6338)){return 0;}else{return $6331$6333[1];}}());(loc$6347=merge_locations$5304((((acc$6358=[])),(((temp$6363=locations$6342)),((($length$6368=temp$6363.length)),((($index$6373=0)),function(){$6355:for(;($index$6373<$length$6368);($index$6373++)){var x$6391;var cls$6392;var t0$6386;var t1$6387;var m$6381;(m$6381=temp$6363[$index$6373]);;(t0$6386=m$6381);if(((t0$6386 instanceof Array)&&((t1$6387=t0$6386.length),(t1$6387===2)))){(x$6391=t0$6386[0]);(cls$6392=t0$6386[1]);acc$6358.push(x$6391);}else{$6818(m$6381,"/home/olivier/git/earl-grey/src/location.eg",5091,5119);;}}}()))),acc$6358)));;(src$6348=loc$6347.source);;(t0$6403=loc$6347.linerange());if(((t0$6403 instanceof Array)&&((t1$6404=t0$6403.length),(t1$6404===2)))){(l1$6349=t0$6403[0]);(l2$6350=t0$6403[1]);;}else{$6818(loc$6347.linerange(),"/home/olivier/git/earl-grey/src/location.eg",5155,5174);}(first$6351=Math.max(1,(l1$6349-context$6343)));;(last$6352=Math.min(src$6348.nlines,(l2$6350+context$6343)));;return $7022(["+div","location"],[$7022(["+div","source"],[$7022(["sourcefile"],(src$6348.url||"???")),(((acc$6418=[])),(((temp$6423=locations$6342)),((($length$6428=temp$6423.length)),((($index$6433=0)),function(){$6415:for(;($index$6433<$length$6428);($index$6433++)){var loc$6451;var cls$6452;var t0$6446;var t1$6447;var m$6441;(m$6441=temp$6423[$index$6433]);;(t0$6446=m$6441);if(((t0$6446 instanceof Array)&&((t1$6447=t0$6446.length),(t1$6447===2)))){(loc$6451=t0$6446[0]);(cls$6452=t0$6446[1]);acc$6418.push($7022([cls$6452,"sourcepos"],loc$6451.ref()));}else{$6818(m$6441,"/home/olivier/git/earl-grey/src/location.eg",5339,5409);;}}}()))),acc$6418)]),src$6348.highlight_lines(first$6351,last$6352,(((acc$6461=[])),(((temp$6466=locations$6342)),((($length$6471=temp$6466.length)),((($index$6476=0)),function(){$6458:for(;($index$6476<$length$6471);($index$6476++)){var loc$6494;var cls$6495;var t0$6489;var t1$6490;var m$6484;(m$6484=temp$6466[$index$6476]);;(t0$6489=m$6484);if(((t0$6489 instanceof Array)&&((t1$6490=t0$6489.length),(t1$6490===2)))){(loc$6494=t0$6489[0]);(cls$6495=t0$6489[1]);acc$6461.push([loc$6494.start,loc$6494.end,[cls$6495]]);}else{$6818(m$6484,"/home/olivier/git/earl-grey/src/location.eg",5464,5522);;}}}()))),acc$6461))]);}else{$6818($6331$6333);}});;(merge_locations$5304=function($6506$6508){var $index$6565;var $length$6560;var temp$6555;var acc$6550;var $index$6604;var $length$6599;var temp$6594;var acc$6589;var start$6543;var end$6544;var locs$6539;var loc$6534;var $6511$6525;var $6512$6526;var t0$6523;var $6510$6518;var ph$6513;(ph$6513=$6506$6508);;($6510$6518=ph$6513);;if((($6511$6525=($6510$6518 instanceof Array))&&((t0$6523=$6510$6518.length),(t0$6523===0)))){return Location$5297(null,0,0);}else{if(($6511$6525&&(t0$6523===1))){(loc$6534=$6510$6518[0]);return loc$6534;}else{if(($6511$6525&&(t0$6523>=0))){(locs$6539=Array.prototype.slice.call($6510$6518,0));(start$6543=$5243(Math.min,(((acc$6550=[])),(((temp$6555=locs$6539)),((($length$6560=temp$6555.length)),((($index$6565=0)),function(){$6547:for(;($index$6565<$length$6560);($index$6565++)){var loc$6581;var m$6573;(m$6573=temp$6555[$index$6565]);;(loc$6581=m$6573);acc$6550.push(loc$6581.start);}}()))),acc$6550)));;(end$6544=$5243(Math.max,(((acc$6589=[])),(((temp$6594=locs$6539)),((($length$6599=temp$6594.length)),((($index$6604=0)),function(){$6586:for(;($index$6604<$length$6599);($index$6604++)){var loc$6620;var m$6612;(m$6612=temp$6594[$index$6604]);;(loc$6620=m$6612);acc$6589.push(loc$6620.end);}}()))),acc$6589)));;return Location$5297(locs$6539[0].source,start$6543,end$6544);}else{$6818($6510$6518);}}}});;(__lt____lt____colon__$5305=function(x$6629,y$6630){if((!$5228(Location$5297)(x$6629.location))){(x$6629["location"]=function(){if(((!y$6630)||$5228(Location$5297)(y$6630))){return y$6630;}else{return y$6630.location;}}());}return x$6629;});;(__plus____plus____colon__$5306=function(x$6638,y$6639){var rval$6643;(x$6638=function(){if(((!x$6638)||$5228(Location$5297)(x$6638))){return x$6638;}else{return x$6638.location;}}());(y$6639=function(){if(((!y$6639)||$5228(Location$5297)(y$6639))){return y$6639;}else{return y$6639.location;}}());(rval$6643=false);;try{(rval$6643=merge_locations$5304([x$6638,y$6639]));}catch(excv$6649){var e$6655;(e$6655=excv$6649);(rval$6643=(void 0));}return rval$6643;});;(format_error$5307=function(){var $index$6731;var $length$6726;var temp$6721;var acc$6716;var hls$6706;var locs$6707;var rval$6784;var loc$6800;var data$6780;var other$6806;var url$6773;var start$6774;var end$6775;var loc$6767;var args$6700;var fmt_args$6691;var $6663$6687;var $6664$6688;var $6665$6689;var t0$6683;var t1$6684;var t2$6685;var e$6677;var context$6678;var $6662$6679;var t0$6672;var t1$6673;var $6661$6667;($6661$6667=arguments);;(t0$6672=$6661$6667.length);if(((t0$6672>=1)&&(t0$6672<=2))){(t1$6673=$6661$6667[0]);(e$6677=t1$6673);($6662$6679=t1$6673);(context$6678=function(){if((1>=t0$6672)){return 0;}else{return $6661$6667[1];}}());(fmt_args$6691=function(e$6695){if((e$6695.args&&e$6695.args.length)){return $7022(["error_args"],repr$5294(e$6695.args));}else{return "";}});;(t0$6683=$6662$6679);if(($5228($6831(["syntax"]))(t0$6683)&&($7211(t0$6683,"args")&&((t1$6684=t0$6683.args),((t1$6684 instanceof Array)&&((t2$6685=t1$6684.length),(t2$6685===1))))))){(args$6700=t1$6684[0]);(hls$6706=["hl1","hl2","hl3","hl4"]);;(locs$6707=(((acc$6716=[])),(((temp$6721=$7000($7196(args$6700)))),((($length$6726=temp$6721.length)),((($index$6731=0)),function(){$6713:for(;($index$6731<$length$6726);($index$6731++)){var i$6751;var key$6752;var arg$6753;var t0$6744;var t1$6745;var t2$6746;var t3$6747;var m$6739;(m$6739=temp$6721[$index$6731]);;(t0$6744=m$6739);if(((t0$6744 instanceof Array)&&((t1$6745=t0$6744.length),((t1$6745===2)&&((i$6751=t0$6744[0]),((t2$6746=t0$6744[1]),((t2$6746 instanceof Array)&&((t3$6747=t2$6746.length),((t3$6747===2)&&((key$6752=t2$6746[0]),((arg$6753=t2$6746[1]),(arg$6753&&arg$6753.location)))))))))))){acc$6716.push([arg$6753.location,$5243(hls$6706,(i$6751%4))]);}else{false;;}}}()))),acc$6716));;return $7022(["+div"],[$7022(["error"],[$7022(["error_type"],e$6677.name),$7022(["error_message"],e$6677.message)]),$7022(["error_args","syntax"],repr$5294(args$6700)),highlight_locations$5302(locs$6707,context$6678)]);}else{if((($6664$6688=$7211(t0$6683,"location"))&&((t1$6684=t0$6683.location),$5228(Location$5297)(t1$6684)))){(loc$6767=t1$6684);return $7022(["+div"],[$7022(["error"],[$7022(["error_type"],e$6677.name),$7022(["error_message"],e$6677.message)]),fmt_args$6691(e$6677),highlight_locations$5302([[loc$6767,"hl1"]],context$6678),$7022(["traceback"],(e$6677.stack||""))]);}else{if(($6664$6688&&((t1$6684 instanceof Array)&&((t2$6685=t1$6684.length),((t2$6685===4)&&(t1$6684[0]==="location")))))){(url$6773=t1$6684[1]);(start$6774=t1$6684[2]);(end$6775=t1$6684[3]);(data$6780=(((rval$6784=false)),(function(){try{(rval$6784=fs$5295.readFileSync(url$6773,"utf8"));}catch(excv$6790){var e$6796;(e$6796=excv$6790);(rval$6784=null);}}(),rval$6784)));;if(data$6780){(loc$6800=Location$5297(Source$5296(data$6780,url$6773),start$6774,end$6775));;return $7022(["+div"],[$7022(["error"],[$7022(["error_type"],e$6677.name),$7022(["error_message"],e$6677.message)]),fmt_args$6691(e$6677),highlight_locations$5302([[loc$6800,"hl1"]],context$6678),$7022(["traceback"],($7022([],e$6677.stack)||""))]);}else{return $7022(["+div"],[$7022(["error"],[$7022(["error_type"],e$6677.name),$7022(["error_message"],e$6677.message)]),fmt_args$6691(e$6677),$7022(["traceback"],($7022([],e$6677.stack)||e$6677))]);}}else{(other$6806=$6662$6679);return $7022(["+div"],[$7022(["error"],[$7022(["error_type"],e$6677.name),$7022(["error_message"],e$6677.message)]),fmt_args$6691(e$6677),$7022(["traceback"],$7022([],e$6677.stack))]);}}}}else{$6818($6661$6667);}});;(display_error$5308=function(e$6814){return __lt____gt__$5293(null,format_error$5307(e$6814));});;(exports["Source"]=Source$5296);(exports["Location"]=Location$5297);(exports["highlight"]=highlight$5298);(exports["highlight_locations"]=highlight_locations$5302);(exports["merge_locations"]=merge_locations$5304);(exports["<<:"]=__lt____lt____colon__$5305);(exports["++:"]=__plus____plus____colon__$5306);(exports["format_error"]=format_error$5307);(exports["display_error"]=display_error$5308);

},{"./pp":11,"./util":14,"fs":15}],8:[function(require,module,exports){
var $7410=function(type$7412){var f$7415;(f$7415=type$7412["::check"]);;if((f$7415===(void 0))){return function(value$7420){return (value$7420 instanceof type$7412);};}else{return function(value$7423){return f$7415.call(type$7412,value$7423);};}};
var $7425=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $7426=function(dest$7428,values$7429){var k$7434;(k$7434=null);$7432:for(k$7434 in values$7429){if(values$7429.hasOwnProperty(k$7434)){(dest$7428[k$7434]=values$7429[k$7434]);}}return dest$7428;};
var $7438=function($7439$7441){var ph$7445;(ph$7445=$7439$7441);;var $7443$7450;($7443$7450=ph$7445);;var bridge$7444$7455;var x$7459;(bridge$7444$7455=$7443$7450);if((((typeof(bridge$7444$7455)==="string")&&((x$7459=bridge$7444$7455),true))||((typeof(bridge$7444$7455)==="number")&&((x$7459=bridge$7444$7455),true)))){return ["value",x$7459];}else{var other$7466;(other$7466=$7443$7450);return other$7466["::serialize_ast"]();}};
var send$7250;(send$7250=function(obj$7255,$7253$7256){var ph$7260;var msg$7261;var t0$7263;(t0$7263=$7253$7256);(msg$7261=t0$7263);(ph$7260=t0$7263);;var $7258$7267;($7258$7267=ph$7260);;var bridge$7259$7272;(bridge$7259$7272=$7258$7267);if(((typeof(bridge$7259$7272)==="string")||(typeof(bridge$7259$7272)==="number"))){return obj$7255[msg$7261];}else{var other$7280;(other$7280=$7258$7267);return obj$7255["::send"](msg$7261);}});;(Array[":::project"]=function($7283$7285){var ph$7288;var value$7289;var t0$7291;(t0$7291=$7283$7285);(value$7289=t0$7291);(ph$7288=t0$7291);;var $7287$7295;($7287$7295=ph$7288);;if($7410(Array)($7287$7295)){return [true,value$7289];}else{$7287$7295;return [true,[value$7289]];}});(Array.prototype["::check"]=function(value$7309){if((value$7309 instanceof Array)){var i$7314;(i$7314=0);;$7312:for(;(i$7314<this.length);(i$7314++)){if(($7425(this,i$7314)!==$7425(value$7309,i$7314))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $7426(this.slice(0),this);});(Array.prototype[":::project"]=function(value$7325){if((value$7325 instanceof Array)){var i$7330;(i$7330=0);;$7328:for(;(i$7330<this.length);(i$7330++)){if(($7425(this,i$7330)!==$7425(value$7325,i$7330))){return [true,[value$7325]];}}return [true,value$7325.slice(this.length)];}else{return [true,[value$7325]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($7438));});(RegExp.prototype["::check"]=function($7340$7342){var ph$7345;(ph$7345=$7340$7342);;var $7344$7350;($7344$7350=ph$7345);;var value$7358;if((typeof($7344$7350)==="string")){(value$7358=$7344$7350);if(value$7358.match(this)){return true;}else{return false;}}else{var other$7363;(other$7363=$7344$7350);return false;}});(RegExp.prototype[":::project"]=function($7365$7367){var ph$7370;(ph$7370=$7365$7367);;var $7369$7375;($7369$7375=ph$7370);;var value$7383;if((typeof($7369$7375)==="string")){(value$7383=$7369$7375);var $7386$7388;($7386$7388=value$7383.match(this));;var m$7396;if(($7386$7388===null)){(m$7396=$7386$7388);return [false,null];}else{var m$7401;(m$7401=$7386$7388);return [true,m$7401];}}else{var other$7405;(other$7405=$7369$7375);return [false,null];}});(Function.prototype["::send"]=function(args$7408){return this.apply(this,args$7408);});
var $7909=function(arr$7911){var results$7915;var l$7916;(results$7915=[]);;(l$7916=arr$7911.length);;var i$7924;(i$7924=0);;$7914:for(;(i$7924<l$7916);(i$7924++)){results$7915.push([i$7924,$7425(arr$7911,i$7924)]);}return results$7915;};
var $7740=function(){var $7741$7743;($7741$7743=function(tags$7747){var it$0$7750;(it$0$7750=function(){if((!$7410($7741$7743)(this))){return Object.create($7741$7743.prototype);}else{return this;}}());;(it$0$7750["tags"]=tags$7747);return it$0$7750;});;($7741$7743.prototype["create"]=function(){var $7759$7761;($7759$7761=arguments);;var t0$7766;var message$7770;var args$7771;(t0$7766=$7759$7761.length);if((t0$7766>=0)){(message$7770=function(){if((0>=t0$7766)){return "";}else{return $7759$7761[0];}}());(args$7771=Array.prototype.slice.call($7759$7761,1));var it$0$7775;(it$0$7775=this);;var self$7780;(self$7780=this);;var e$7785;(e$7785=Error(message$7770));;(e$7785["::tags"]=it$0$7775.tags);(e$7785["args"]=args$7771);var temp$7793;(temp$7793=$7909(args$7771));;var $length$7798;($length$7798=temp$7793.length);;var $index$7803;($index$7803=0);;$7786:for(;($index$7803<$length$7798);($index$7803++)){var m$7811;(m$7811=temp$7793[$index$7803]);;var t0$7816;var t1$7817;var i$7821;var arg$7822;(t0$7816=m$7811);if(((t0$7816 instanceof Array)&&((t1$7817=t0$7816.length),(t1$7817===2)))){(i$7821=t0$7816[0]);(arg$7822=t0$7816[1]);(e$7785[i$7821]=arg$7822);}else{$7727(m$7811);;}}(e$7785["length"]=args$7771.length);(e$7785["name"]=["E"].concat(it$0$7775.tags).join("."));return e$7785;}else{$7727($7759$7761);}});($7741$7743.prototype["::check"]=function(e$7833){var it$0$7836;(it$0$7836=this);;var self$7841;(self$7841=this);;var tags$7846;if(((!e$7833)||(!$7410(Error)(e$7833)))){return false;}(tags$7846=(e$7833["::tags"]||[]));;var temp$7855;(temp$7855=it$0$7836.tags);;var $length$7860;($length$7860=temp$7855.length);;var $index$7865;($index$7865=0);;$7847:for(;($index$7865<$length$7860);($index$7865++)){var m$7873;(m$7873=temp$7855[$index$7865]);;var tag$7881;(tag$7881=m$7873);if((tags$7846.indexOf(tag$7881)===-1)){return false;}else{false;;}}return true;});($7741$7743.prototype["::deconstruct"]=function(e$7889){var it$0$7892;(it$0$7892=this);;var self$7897;(self$7897=this);;return e$7889.args;});$7426($7741$7743,$7426(function(){var accum$7902;(accum$7902=({}));(accum$7902["::name"]="$7741");return accum$7902;}(),function(){var accum$7906;(accum$7906=({}));(accum$7906["::egclass"]=true);return accum$7906;}()));return $7741$7743;}();
var $7727=function(value$7729,url$7730,start$7731,end$7732){var err$7735;(err$7735=$7740(["match"]).create("Could not find a match for value",({"value":value$7729})));;if(url$7730){(err$7735["location"]=["location",url$7730,start$7731,end$7732]);}throw err$7735;};var hoist$7470;var hoistable$7471;var not_hoistable$7472;var hoist_helper$7473;(hoist$7470=function(expr$7477){var t0$7483;var t1$7484;var b$7480;var inner$7481;(t0$7483=hoist_helper$7473(expr$7477));if(((t0$7483 instanceof Array)&&((t1$7484=t0$7483.length),(t1$7484===2)))){(b$7480=t0$7483[0]);(inner$7481=t0$7483[1]);;}else{$7727(hoist_helper$7473(expr$7477),"/home/olivier/git/earl-grey/src/opt.eg",50,72);}return ["scope",inner$7481,b$7480];});;(hoistable$7471=["send","array","object","multi","if","assign","js_break","js_continue","js_return","js_delete","js_throw","js_try","js_new"]);;(not_hoistable$7472=["void","js_while","js_for","js_for_in","js_label"]);;(hoist_helper$7473=function($7498$7500){var t0$7511;var x$7533;var x$7538;var bridge$7504$7530;var x$7543;var t0$7559;var t1$7560;var newbody$7556;var inner$7557;var t0$7575;var t1$7576;var newbody$7572;var inner$7573;var $index$7615;var $length$7610;var temp$7605;var acc$7600;var accum$7590;var newargs$7591;var $index$7674;var $length$7669;var temp$7664;var acc$7659;var newargs$7653;var other$7723;var type$7646;var args$7647;var type$7583;var args$7584;var vars$7567;var body$7568;var vars$7550;var body$7551;var $7505$7523;var $7506$7524;var $7507$7525;var bridge$7503$7520;var t0$7521;var $7502$7515;var ph$7508;var expr$7509;(t0$7511=$7498$7500);(expr$7509=t0$7511);(ph$7508=t0$7511);;($7502$7515=ph$7508);;(bridge$7503$7520=$7502$7515);if((((bridge$7504$7530=bridge$7503$7520),((((x$7533=bridge$7504$7530)),((x$7533 instanceof Array)&&(x$7533[0]==="symbol")))||(((x$7538=bridge$7504$7530)),((x$7538 instanceof Array)&&(x$7538[0]==="value")))))||(((x$7543=bridge$7503$7520)),((x$7543 instanceof Array)&&(x$7543[0]==="variable"))))){return [expr$7509,[]];}else{if((($7505$7523=($7502$7515 instanceof Array))&&((t0$7521=$7502$7515.length),(($7507$7525=(t0$7521===3))&&($7502$7515[0]==="scope"))))){(vars$7550=$7502$7515[1]);(body$7551=$7502$7515[2]);(t0$7559=hoist_helper$7473(body$7551));if(((t0$7559 instanceof Array)&&((t1$7560=t0$7559.length),(t1$7560===2)))){(newbody$7556=t0$7559[0]);(inner$7557=t0$7559[1]);;}else{$7727(hoist_helper$7473(body$7551),"/home/olivier/git/earl-grey/src/opt.eg",447,472);}return [newbody$7556,inner$7557.concat(vars$7550)];}else{if(($7507$7525&&($7502$7515[0]==="lambda"))){(vars$7567=$7502$7515[1]);(body$7568=$7502$7515[2]);(t0$7575=hoist_helper$7473(body$7568));if(((t0$7575 instanceof Array)&&((t1$7576=t0$7575.length),(t1$7576===2)))){(newbody$7572=t0$7575[0]);(inner$7573=t0$7575[1]);;}else{$7727(hoist_helper$7473(body$7568),"/home/olivier/git/earl-grey/src/opt.eg",581,606);}return [["lambda",vars$7567,["scope",inner$7573,newbody$7572]],[]];}else{if(($7505$7523&&(($7507$7525=(t0$7521>=1))&&((type$7583=$7502$7515[0]),((args$7584=Array.prototype.slice.call($7502$7515,1)),(hoistable$7471.indexOf(type$7583)!==-1)))))){(accum$7590=[]);;(newargs$7591=(((acc$7600=[])),(((temp$7605=args$7584)),((($length$7610=temp$7605.length)),((($index$7615=0)),function(){$7597:for(;($index$7615<$length$7610);($index$7615++)){var t0$7637;var t1$7638;var b$7634;var inner$7635;var arg$7631;var m$7623;(m$7623=temp$7605[$index$7615]);;(arg$7631=m$7623);acc$7600.push((((t0$7637=hoist_helper$7473(arg$7631)),function(){if(((t0$7637 instanceof Array)&&((t1$7638=t0$7637.length),(t1$7638===2)))){(b$7634=t0$7637[0]);(inner$7635=t0$7637[1]);}else{return $7727(hoist_helper$7473(arg$7631),"/home/olivier/git/earl-grey/src/opt.eg",779,806);}}()),(accum$7590=accum$7590.concat(inner$7635)),b$7634));}}()))),acc$7600));;return [[type$7583].concat(newargs$7591),accum$7590];}else{if(($7507$7525&&((type$7646=$7502$7515[0]),((args$7647=Array.prototype.slice.call($7502$7515,1)),(not_hoistable$7472.indexOf(type$7646)!==-1))))){(newargs$7653=(((acc$7659=[])),(((temp$7664=args$7647)),((($length$7669=temp$7664.length)),((($index$7674=0)),function(){$7656:for(;($index$7674<$length$7669);($index$7674++)){var t0$7697;var t1$7698;var other$7718;var t0$7709;var $7693$7704;var b$7694;var inner$7695;var arg$7690;var m$7682;(m$7682=temp$7664[$index$7674]);;(arg$7690=m$7682);acc$7659.push((((t0$7697=hoist_helper$7473(arg$7690)),function(){if(((t0$7697 instanceof Array)&&((t1$7698=t0$7697.length),(t1$7698===2)))){(b$7694=t0$7697[0]);(inner$7695=t0$7697[1]);}else{return $7727(hoist_helper$7473(arg$7690),"/home/olivier/git/earl-grey/src/opt.eg",981,1008);}}()),((($7693$7704=inner$7695)),function(){if((($7693$7704 instanceof Array)&&((t0$7709=$7693$7704.length),(t0$7709===0)))){return b$7694;}else{(other$7718=$7693$7704);return ["scope",inner$7695,b$7694];}}())));}}()))),acc$7659));;return [[type$7646].concat(newargs$7653),[]];}else{(other$7723=$7502$7515);throw $7740(["syntax","illegal"]).create("Illegal node -- this should not happen.",({"node":other$7723}));}}}}}});;(exports["hoist"]=hoist$7470);

},{}],9:[function(require,module,exports){
var $8092=function(type$8094){var f$8097;(f$8097=type$8094["::check"]);;if((f$8097===(void 0))){return function(value$8102){return (value$8102 instanceof type$8094);};}else{return function(value$8105){return f$8097.call(type$8094,value$8105);};}};
var $8107=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $8108=function(dest$8110,values$8111){var k$8116;(k$8116=null);$8114:for(k$8116 in values$8111){if(values$8111.hasOwnProperty(k$8116)){(dest$8110[k$8116]=values$8111[k$8116]);}}return dest$8110;};
var $8120=function($8121$8123){var ph$8127;(ph$8127=$8121$8123);;var $8125$8132;($8125$8132=ph$8127);;var bridge$8126$8137;var x$8141;(bridge$8126$8137=$8125$8132);if((((typeof(bridge$8126$8137)==="string")&&((x$8141=bridge$8126$8137),true))||((typeof(bridge$8126$8137)==="number")&&((x$8141=bridge$8126$8137),true)))){return ["value",x$8141];}else{var other$8148;(other$8148=$8125$8132);return other$8148["::serialize_ast"]();}};
var send$7932;(send$7932=function(obj$7937,$7935$7938){var ph$7942;var msg$7943;var t0$7945;(t0$7945=$7935$7938);(msg$7943=t0$7945);(ph$7942=t0$7945);;var $7940$7949;($7940$7949=ph$7942);;var bridge$7941$7954;(bridge$7941$7954=$7940$7949);if(((typeof(bridge$7941$7954)==="string")||(typeof(bridge$7941$7954)==="number"))){return obj$7937[msg$7943];}else{var other$7962;(other$7962=$7940$7949);return obj$7937["::send"](msg$7943);}});;(Array[":::project"]=function($7965$7967){var ph$7970;var value$7971;var t0$7973;(t0$7973=$7965$7967);(value$7971=t0$7973);(ph$7970=t0$7973);;var $7969$7977;($7969$7977=ph$7970);;if($8092(Array)($7969$7977)){return [true,value$7971];}else{$7969$7977;return [true,[value$7971]];}});(Array.prototype["::check"]=function(value$7991){if((value$7991 instanceof Array)){var i$7996;(i$7996=0);;$7994:for(;(i$7996<this.length);(i$7996++)){if(($8107(this,i$7996)!==$8107(value$7991,i$7996))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $8108(this.slice(0),this);});(Array.prototype[":::project"]=function(value$8007){if((value$8007 instanceof Array)){var i$8012;(i$8012=0);;$8010:for(;(i$8012<this.length);(i$8012++)){if(($8107(this,i$8012)!==$8107(value$8007,i$8012))){return [true,[value$8007]];}}return [true,value$8007.slice(this.length)];}else{return [true,[value$8007]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($8120));});(RegExp.prototype["::check"]=function($8022$8024){var ph$8027;(ph$8027=$8022$8024);;var $8026$8032;($8026$8032=ph$8027);;var value$8040;if((typeof($8026$8032)==="string")){(value$8040=$8026$8032);if(value$8040.match(this)){return true;}else{return false;}}else{var other$8045;(other$8045=$8026$8032);return false;}});(RegExp.prototype[":::project"]=function($8047$8049){var ph$8052;(ph$8052=$8047$8049);;var $8051$8057;($8051$8057=ph$8052);;var value$8065;if((typeof($8051$8057)==="string")){(value$8065=$8051$8057);var $8068$8070;($8068$8070=value$8065.match(this));;var m$8078;if(($8068$8070===null)){(m$8078=$8068$8070);return [false,null];}else{var m$8083;(m$8083=$8068$8070);return [true,m$8083];}}else{var other$8087;(other$8087=$8051$8057);return [false,null];}});(Function.prototype["::send"]=function(args$8090){return this.apply(this,args$8090);});
var $10155=function(arr$10157){var results$10161;var l$10162;(results$10161=[]);;(l$10162=arr$10157.length);;var i$10170;(i$10170=0);;$10160:for(;(i$10170<l$10162);(i$10170++)){results$10161.push([i$10170,$8107(arr$10157,i$10170)]);}return results$10161;};
var $9986=function(){var $9987$9989;($9987$9989=function(tags$9993){var it$0$9996;(it$0$9996=function(){if((!$8092($9987$9989)(this))){return Object.create($9987$9989.prototype);}else{return this;}}());;(it$0$9996["tags"]=tags$9993);return it$0$9996;});;($9987$9989.prototype["create"]=function(){var $10005$10007;($10005$10007=arguments);;var t0$10012;var message$10016;var args$10017;(t0$10012=$10005$10007.length);if((t0$10012>=0)){(message$10016=function(){if((0>=t0$10012)){return "";}else{return $10005$10007[0];}}());(args$10017=Array.prototype.slice.call($10005$10007,1));var it$0$10021;(it$0$10021=this);;var self$10026;(self$10026=this);;var e$10031;(e$10031=Error(message$10016));;(e$10031["::tags"]=it$0$10021.tags);(e$10031["args"]=args$10017);var temp$10039;(temp$10039=$10155(args$10017));;var $length$10044;($length$10044=temp$10039.length);;var $index$10049;($index$10049=0);;$10032:for(;($index$10049<$length$10044);($index$10049++)){var m$10057;(m$10057=temp$10039[$index$10049]);;var t0$10062;var t1$10063;var i$10067;var arg$10068;(t0$10062=m$10057);if(((t0$10062 instanceof Array)&&((t1$10063=t0$10062.length),(t1$10063===2)))){(i$10067=t0$10062[0]);(arg$10068=t0$10062[1]);(e$10031[i$10067]=arg$10068);}else{$9973(m$10057);;}}(e$10031["length"]=args$10017.length);(e$10031["name"]=["E"].concat(it$0$10021.tags).join("."));return e$10031;}else{$9973($10005$10007);}});($9987$9989.prototype["::check"]=function(e$10079){var it$0$10082;(it$0$10082=this);;var self$10087;(self$10087=this);;var tags$10092;if(((!e$10079)||(!$8092(Error)(e$10079)))){return false;}(tags$10092=(e$10079["::tags"]||[]));;var temp$10101;(temp$10101=it$0$10082.tags);;var $length$10106;($length$10106=temp$10101.length);;var $index$10111;($index$10111=0);;$10093:for(;($index$10111<$length$10106);($index$10111++)){var m$10119;(m$10119=temp$10101[$index$10111]);;var tag$10127;(tag$10127=m$10119);if((tags$10092.indexOf(tag$10127)===-1)){return false;}else{false;;}}return true;});($9987$9989.prototype["::deconstruct"]=function(e$10135){var it$0$10138;(it$0$10138=this);;var self$10143;(self$10143=this);;return e$10135.args;});$8108($9987$9989,$8108(function(){var accum$10148;(accum$10148=({}));(accum$10148["::name"]="$9987");return accum$10148;}(),function(){var accum$10152;(accum$10152=({}));(accum$10152["::egclass"]=true);return accum$10152;}()));return $9987$9989;}();
var $9973=function(value$9975,url$9976,start$9977,end$9978){var err$9981;(err$9981=$9986(["match"]).create("Could not find a match for value",({"value":value$9975})));;if(url$9976){(err$9981["location"]=["location",url$9976,start$9977,end$9978]);}throw err$9981;};
var $10177=function(obj$10179){var results$10183;(results$10183=[]);;var k$10188;(k$10188=null);$10182:for(k$10188 in obj$10179){if(Object.prototype.hasOwnProperty.call(obj$10179,k$10188)){results$10183.push([k$10188,$8107(obj$10179,k$10188)]);}}return results$10183;};
var $10192=function(arrays$10194){var results$10197;(results$10197=[]);;var temp$10205;(temp$10205=arrays$10194);;var $length$10210;($length$10210=temp$10205.length);;var $index$10215;($index$10215=0);;$10198:for(;($index$10215<$length$10210);($index$10215++)){var m$10223;(m$10223=temp$10205[$index$10215]);;var a$10231;(a$10231=m$10223);(results$10197=results$10197.concat(a$10231));}return results$10197;};
var $10233=function(type$10235){return function(value$10238){var f$10241;(f$10241=type$10235[":::project"]);;if((f$10241===(void 0))){(f$10241=type$10235["::project"]);if((f$10241===(void 0))){return [true,type$10235(value$10238)];}else{var rval$10247;(rval$10247=false);;try{(rval$10247=[true,f$10241(value$10238)]);}catch(excv$10253){var e$10259;(e$10259=excv$10253);(rval$10247=[false,null]);}return rval$10247;}}else{return f$10241.call(type$10235,value$10238);}};};var accum$8568;var accum$8572;var accum$8754;var accum$9101;var accum$9105;var accum$9269;var accum$9273;var accum$9277;var accum$9281;var accum$9285;var accum$9292;var accum$9296;var accum$9300;var accum$9304;var accum$9308;var eg_groups$9114;var eg_prio$9115;var $8152$8153;var __lt____lt____colon__$8154;var __plus____plus____colon__$8155;var transform$8156;var OperatorGroups$8157;var parse_op_description$8158;var eg_groups$8159;var SimplePriority$8160;var MAX$8161;var eg_order$8162;var DONE$8163;var NONE$8164;var LEFT$8165;var RIGHT$8166;var BOTH$8167;var oparse$8168;var finalize$8169;var parse$8170;($8152$8153=require("./location"));;(__lt____lt____colon__$8154=$8152$8153["<<:"]);;(__plus____plus____colon__$8155=$8152$8153["++:"]);;(transform$8156=function(expr$8183,cb$8184){var rval$8198;var tr$8187;var result$8188;(tr$8187=function(x$8192){return transform$8156(x$8192,cb$8184);});;(result$8188=(((rval$8198=false)),(function(){try{(rval$8198=cb$8184.call(tr$8187,expr$8183));}catch(excv$8204){var name$8244;var args$8245;var v$8239;var s$8234;var $8213$8224;var $8214$8225;var $8215$8226;var t0$8222;var $8212$8217;var e$8210;(e$8210=excv$8204);(rval$8198=((($8212$8217=expr$8183)),function(){if((($8213$8224=($8212$8217 instanceof Array))&&((t0$8222=$8212$8217.length),((t0$8222===1)&&($8212$8217[0]==="void"))))){return ["void"];}else{if(($8213$8224&&(($8215$8226=(t0$8222===2))&&($8212$8217[0]==="symbol")))){(s$8234=$8212$8217[1]);return expr$8183;}else{if(($8215$8226&&($8212$8217[0]==="value"))){(v$8239=$8212$8217[1]);return expr$8183;}else{if(($8213$8224&&(t0$8222>=1))){(name$8244=$8212$8217[0]);(args$8245=Array.prototype.slice.call($8212$8217,1));return [name$8244].concat(args$8245.map(tr$8187));}else{$9973($8212$8217);}}}}}()));}}(),rval$8198)));;return __lt____lt____colon__$8154(result$8188,expr$8183);});;(OperatorGroups$8157=function(groups$8255){var $index$8288;var $length$8283;var temp$8278;var acc$8273;var $index$8330;var $length$8325;var temp$8320;var acc$8315;var $index$8407;var $length$8402;var temp$8397;var acc$8392;var itg$8264;var it$0$8258;(it$0$8258=function(){if((!$8092(OperatorGroups$8157)(this))){return Object.create(OperatorGroups$8157.prototype);}else{return this;}}());;(itg$8264=$10177(groups$8255));;(it$0$8258["gnames"]=(((acc$8273=[])),(((temp$8278=itg$8264)),((($length$8283=temp$8278.length)),((($index$8288=0)),function(){$8270:for(;($index$8288<$length$8283);($index$8288++)){var name$8306;var t0$8301;var t1$8302;var m$8296;(m$8296=temp$8278[$index$8288]);;(t0$8301=m$8296);if(((t0$8301 instanceof Array)&&((t1$8302=t0$8301.length),(t1$8302===2)))){(name$8306=t0$8301[0]);t0$8301[1];acc$8273.push(name$8306);}else{$9973(m$8296,"/home/olivier/git/earl-grey/src/parse.eg",504,530);;}}}()))),acc$8273));(it$0$8258["groups"]=(((acc$8315=[])),(((temp$8320=itg$8264)),((($length$8325=temp$8320.length)),((($index$8330=0)),function(){$8312:for(;($index$8330<$length$8325);($index$8330++)){var $index$8371;var $length$8366;var temp$8361;var acc$8356;var name$8348;var descrs$8349;var t0$8343;var t1$8344;var m$8338;(m$8338=temp$8320[$index$8330]);;(t0$8343=m$8338);if(((t0$8343 instanceof Array)&&((t1$8344=t0$8343.length),(t1$8344===2)))){(name$8348=t0$8343[0]);(descrs$8349=t0$8343[1]);acc$8315.push($10192((((acc$8356=[])),(((temp$8361=descrs$8349)),((($length$8366=temp$8361.length)),((($index$8371=0)),function(){$8353:for(;($index$8371<$length$8366);($index$8371++)){var descr$8387;var m$8379;(m$8379=temp$8361[$index$8371]);;(descr$8387=m$8379);acc$8356.push(parse_op_description$8158(descr$8387));}}()))),acc$8356)));}else{$9973(m$8338,"/home/olivier/git/earl-grey/src/parse.eg",548,645);;}}}()))),acc$8315));(it$0$8258["fns"]=[]);(it$0$8258["to_gid"]=({"IFX":({"wide":({}),"short":({})}),"PFX":({"wide":({}),"short":({})}),"SFX":({"wide":({}),"short":({})})}));(acc$8392=[]);;(temp$8397=$10155(it$0$8258.groups));;($length$8402=temp$8397.length);;($index$8407=0);;$8265:for(;($index$8407<$length$8402);($index$8407++)){var $index$8448;var $length$8443;var temp$8438;var acc$8433;var i$8425;var group$8426;var t0$8420;var t1$8421;var m$8415;(m$8415=temp$8397[$index$8407]);;(t0$8420=m$8415);if(((t0$8420 instanceof Array)&&((t1$8421=t0$8420.length),(t1$8421===2)))){(i$8425=t0$8420[0]);(group$8426=t0$8420[1]);acc$8392.push((((acc$8433=[])),(((temp$8438=group$8426)),((($length$8443=temp$8438.length)),((($index$8448=0)),function(){$8430:for(;($index$8448<$length$8443);($index$8448++)){var f$8474;var fixity$8466;var width$8467;var name$8468;var t0$8461;var t1$8462;var m$8456;(m$8456=temp$8438[$index$8448]);;(t0$8461=m$8456);if(((t0$8461 instanceof Array)&&((t1$8462=t0$8461.length),(t1$8462===3)))){(fixity$8466=t0$8461[0]);(width$8467=t0$8461[1]);(name$8468=t0$8461[2]);acc$8433.push(($8107($8107(it$0$8258.to_gid,fixity$8466),width$8467)[name$8468]=i$8425));}else{(f$8474=m$8456);acc$8433.push(it$0$8258.fns.push([f$8474,i$8425]));}}}()))),acc$8433));}else{$9973(m$8415,"/home/olivier/git/earl-grey/src/parse.eg",812,1014);;}}acc$8392;return it$0$8258;});;(OperatorGroups$8157.prototype["get_name"]=function(o$8482){var self$8490;var it$0$8485;(it$0$8485=this);;(self$8490=this);;return $8107(it$0$8485.gnames,it$0$8485.get(o$8482));});(OperatorGroups$8157.prototype["get"]=function($8496$8498){var t0$8505;var t1$8506;var $index$8541;var $length$8536;var temp$8531;var attempt$8522;var self$8517;var it$0$8512;var o$8500;var fixity$8501;var width$8502;var name$8503;(t0$8505=$8496$8498);(o$8500=t0$8505);if(((t0$8505 instanceof Array)&&((t1$8506=t0$8505.length),(t1$8506===3)))){(fixity$8501=t0$8505[0]);(width$8502=t0$8505[1]);(name$8503=t0$8505[2]);;}else{$9973($8496$8498);}(it$0$8512=this);;(self$8517=this);;(attempt$8522=$8107($8107($8107(it$0$8512.to_gid,fixity$8501),width$8502),name$8503));;if((attempt$8522===(void 0))){(temp$8531=it$0$8512.fns);;($length$8536=temp$8531.length);;($index$8541=0);;$8527:for(;($index$8541<$length$8536);($index$8541++)){var f$8559;var i$8560;var t0$8554;var t1$8555;var m$8549;(m$8549=temp$8531[$index$8541]);;(t0$8554=m$8549);if(((t0$8554 instanceof Array)&&((t1$8555=t0$8554.length),(t1$8555===2)))){(f$8559=t0$8554[0]);(i$8560=t0$8554[1]);if(f$8559(o$8500)){return i$8560;}}else{$9973(m$8549,"/home/olivier/git/earl-grey/src/parse.eg",1193,1276);;}}throw $9986(["syntax","unknown_operator"]).create(("Unknown operator: "+[true,String(o$8500)][1]),({"operator":o$8500}));}else{return attempt$8522;}});$8108(OperatorGroups$8157,$8108(((accum$8568=({})),((accum$8568["::name"]="OperatorGroups"),accum$8568)),((accum$8572=({})),((accum$8572["::egclass"]=true),accum$8572))));OperatorGroups$8157;(parse_op_description$8158=function($8577$8579){var otherwise$8644;var $8625$8633;var $8624$8627;var otherwise$8669;var $8650$8658;var $8649$8652;var t0$8621;var t1$8622;var fixity$8618;var short$8619;var other$8673;var x$8608;var w1$8609;var op$8610;var w2$8611;var y$8612;var f$8603;var rx$8597;var t0$8592;var t1$8593;var t2$8594;var $8581$8587;var ph$8582;(ph$8582=$8577$8579);;($8581$8587=ph$8582);;(rx$8597=RegExp("(?:^((?:X?))((?:[ _]?))((?:[^ _Y]*))((?:[ _]?))((?:Y?))$)",""));;if($8092(Function)($8581$8587)){(f$8603=$8581$8587);return f$8603;}else{(t0$8592=$10233(rx$8597)($8581$8587));if((t0$8592[0]&&((t1$8593=t0$8592[1]),((t2$8594=t1$8593.length),(t2$8594===6))))){t1$8593[0];(x$8608=t1$8593[1]);(w1$8609=t1$8593[2]);(op$8610=t1$8593[3]);(w2$8611=t1$8593[4]);(y$8612=t1$8593[5]);(t0$8621=((($8624$8627=null)),($8624$8627,function(){if((x$8608==="")){return ["PFX",(w2$8611==="")];}else{if((y$8612==="")){return ["SFX",(w1$8609==="")];}else{(otherwise$8644=$8624$8627);return ["IFX",((w1$8609==="")||(w2$8611===""))];}}}())));if(((t0$8621 instanceof Array)&&((t1$8622=t0$8621.length),(t1$8622===2)))){(fixity$8618=t0$8621[0]);(short$8619=t0$8621[1]);;}else{$9973(((($8649$8652=null)),($8649$8652,function(){if((x$8608==="")){return ["PFX",(w2$8611==="")];}else{if((y$8612==="")){return ["SFX",(w1$8609==="")];}else{(otherwise$8669=$8649$8652);return ["IFX",((w1$8609==="")||(w2$8611===""))];}}}())),"/home/olivier/git/earl-grey/src/parse.eg",1647,1865);}if(((w1$8609==="_")||(w2$8611==="_"))){return [[fixity$8618,"short",op$8610],[fixity$8618,"wide",op$8610]];}else{return [[fixity$8618,function(){if(short$8619){return "short";}else{return "wide";}}(),op$8610]];}}else{(other$8673=$8581$8587);throw $9986(["invalid_op_description"]).create(("Invalid operator description: "+other$8673));}}});;(eg_groups$8159=OperatorGroups$8157($8108(({"tokenpfx":[".Y","#Y","@Y"],"sjuxt":["XWHITEY"],"ifx":[function($8678$8680){var t0$8693;var $8682$8688;var ph$8683;(ph$8683=$8678$8680);;($8682$8688=ph$8683);;if((($8682$8688 instanceof Array)&&((t0$8693=$8682$8688.length),((t0$8693===3)&&(($8682$8688[0]==="IFX")&&($8682$8688[1]==="short")))))){$8682$8688[2];return true;}else{$8682$8688;return false;}}],"pfx":[function($8703$8705){var t0$8718;var $8707$8713;var ph$8708;(ph$8708=$8703$8705);;($8707$8713=ph$8708);;if((($8707$8713 instanceof Array)&&((t0$8718=$8707$8713.length),((t0$8718===3)&&(($8707$8713[0]==="PFX")&&($8707$8713[1]==="short")))))){$8707$8713[2];return true;}else{$8707$8713;return false;}}],"sfx":[function($8728$8730){var t0$8743;var $8732$8738;var ph$8733;(ph$8733=$8728$8730);;($8732$8738=ph$8733);;if((($8732$8738 instanceof Array)&&((t0$8743=$8732$8738.length),((t0$8743===3)&&(($8732$8738[0]==="SFX")&&($8732$8738[1]==="short")))))){$8732$8738[2];return true;}else{$8732$8738;return false;}}],"pow":["X ** Y"],"mul":["X * Y","X / Y","X // Y","X mod Y","+ Y","- Y"],"add":["X + Y","X - Y"],"cmp":["X < Y","X <= Y","X == Y","X > Y","X >= Y","X != Y"],"cat":["X ++ Y"],"union":["X & Y"],"range":["X .. Y","X ..",".. Y"],"in":["X in Y"],"wjuxt":["X WHITE Y"],"colon":["X_:_Y"],"and":"X and Y","or":"X or Y","not":"not Y"}),$8108(((accum$8754=({})),((accum$8754["with"]=["X with Y"]),accum$8754)),({"decl":["X -> Y","X = Y","X := Y","X => Y","X where Y","X when Y","X each Y"],"brack":["X_,_Y","(_Y","[_Y","{_Y","X_)","X_]","X_}"],"custom":[function(x$8758){return true;}]})))));;(SimplePriority$8160=function(groups$8764,priorities$8765){var $index$8800;var $length$8795;var temp$8790;var acc$8785;var _i$8774;var tracks$8775;var it$0$8768;(it$0$8768=function(){if((!$8092(SimplePriority$8160)(this))){return Object.create(SimplePriority$8160.prototype);}else{return this;}}());;(it$0$8768["groups"]=groups$8764);(_i$8774=0);;(tracks$8775=({}));;(it$0$8768["prio"]=(((acc$8785=[])),(((temp$8790=groups$8764.gnames)),((($length$8795=temp$8790.length)),((($index$8800=0)),function(){$8782:for(;($index$8800<$length$8795);($index$8800++)){var t0$8826;var t1$8827;var t2$8828;var t3$8829;var t4$8830;var t5$8831;var t6$8832;var t7$8833;var $index$8868;var $length$8863;var temp$8858;var acc$8853;var $index$8954;var $length$8949;var temp$8944;var acc$8939;var t0$8847;var t1$8848;var ltracks$8819;var lp$8820;var rtracks$8821;var rp$8822;var lt$8823;var rt$8824;var name$8816;var m$8808;(m$8808=temp$8790[$index$8800]);;(name$8816=m$8808);acc$8785.push((((t0$8826=$8107(priorities$8765,name$8816)),function(){if(((t0$8826 instanceof Array)&&((t1$8827=t0$8826.length),((t1$8827===2)&&((t2$8828=t0$8826[0]),((t2$8828 instanceof Array)&&((t3$8829=t2$8828.length),((t3$8829===2)&&((t4$8830=$10233(Array)(t2$8828[0])),(t4$8830[0]&&((ltracks$8819=t4$8830[1]),((lp$8820=t2$8828[1]),((t5$8831=t0$8826[1]),((t5$8831 instanceof Array)&&((t6$8832=t5$8831.length),((t6$8832===2)&&((t7$8833=$10233(Array)(t5$8831[0])),t7$8833[0]))))))))))))))))){(rtracks$8821=t7$8833[1]);(rp$8822=t5$8831[1]);}else{return $9973($8107(priorities$8765,name$8816),"/home/olivier/git/earl-grey/src/parse.eg",3552,3578);}}()),((t0$8847=(((acc$8853=[])),(((temp$8858=[ltracks$8819,rtracks$8821])),((($length$8863=temp$8858.length)),((($index$8868=0)),function(){$8850:for(;($index$8868<$length$8863);($index$8868++)){var $index$8905;var $length$8900;var temp$8895;var rval$8887;var tr$8884;var m$8876;(m$8876=temp$8858[$index$8868]);;(tr$8884=m$8876);acc$8853.push((((rval$8887=0)),(((temp$8895=tr$8884)),((($length$8900=temp$8895.length)),((($index$8905=0)),function(){$8888:for(;($index$8905<$length$8900);($index$8905++)){var t$8931;var t$8925;var m$8913;(m$8913=temp$8895[$index$8905]);;if((m$8913==="all")){(rval$8887=(Math.pow(2,31)-1));}else{(t$8925=m$8913);if((!$8107(tracks$8775,t$8925))){(rval$8887=(rval$8887|Math.pow(2,_i$8774)));(tracks$8775[t$8925]=(_i$8774++));}else{(t$8931=m$8913);(rval$8887=(rval$8887|Math.pow(2,$8107(tracks$8775,t$8931))));}}}}()))),rval$8887));}}()))),acc$8853)),function(){if(((t0$8847 instanceof Array)&&((t1$8848=t0$8847.length),(t1$8848===2)))){(lt$8823=t0$8847[0]);(rt$8824=t0$8847[1]);}else{return $9973((((acc$8939=[])),(((temp$8944=[ltracks$8819,rtracks$8821])),((($length$8949=temp$8944.length)),((($index$8954=0)),function(){$8936:for(;($index$8954<$length$8949);($index$8954++)){var $index$8991;var $length$8986;var temp$8981;var rval$8973;var tr$8970;var m$8962;(m$8962=temp$8944[$index$8954]);;(tr$8970=m$8962);acc$8939.push((((rval$8973=0)),(((temp$8981=tr$8970)),((($length$8986=temp$8981.length)),((($index$8991=0)),function(){$8974:for(;($index$8991<$length$8986);($index$8991++)){var t$9017;var t$9011;var m$8999;(m$8999=temp$8981[$index$8991]);;if((m$8999==="all")){(rval$8973=(Math.pow(2,31)-1));}else{(t$9011=m$8999);if((!$8107(tracks$8775,t$9011))){(rval$8973=(rval$8973|Math.pow(2,_i$8774)));(tracks$8775[t$9011]=(_i$8774++));}else{(t$9017=m$8999);(rval$8973=(rval$8973|Math.pow(2,$8107(tracks$8775,t$9017))));}}}}()))),rval$8973));}}()))),acc$8939),"/home/olivier/git/earl-grey/src/parse.eg",3588,3909);}}()),[[lt$8823,lp$8820],[rt$8824,rp$8822]]));}}()))),acc$8785));return it$0$8768;});;(SimplePriority$8160.prototype["compare"]=function(op1$9023,op2$9024){var t0$9052;var t1$9053;var t2$9054;var t3$9055;var t0$9064;var t1$9065;var t2$9066;var t3$9067;var $9038$9081;var $9037$9075;var i1$9039;var i2$9040;var code1$9041;var ord1$9042;var code2$9043;var ord2$9044;var self$9032;var it$0$9027;(it$0$9027=this);;(self$9032=this);;(i1$9039=it$0$9027.groups.get(op1$9023));;(i2$9040=it$0$9027.groups.get(op2$9024));;(t0$9052=$8107(it$0$9027.prio,i1$9039));if(((t0$9052 instanceof Array)&&((t1$9053=t0$9052.length),((t1$9053===2)&&(t0$9052[0],((t2$9054=t0$9052[1]),((t2$9054 instanceof Array)&&((t3$9055=t2$9054.length),(t3$9055===2))))))))){(code1$9041=t2$9054[0]);(ord1$9042=t2$9054[1]);;}else{$9973($8107(it$0$9027.prio,i1$9039),"/home/olivier/git/earl-grey/src/parse.eg",4036,4053);}(t0$9064=$8107(it$0$9027.prio,i2$9040));if(((t0$9064 instanceof Array)&&((t1$9065=t0$9064.length),((t1$9065===2)&&((t2$9066=t0$9064[0]),((t2$9066 instanceof Array)&&((t3$9067=t2$9066.length),(t3$9067===2)))))))){(code2$9043=t2$9066[0]);(ord2$9044=t2$9066[1]);t0$9064[1];;}else{$9973($8107(it$0$9027.prio,i2$9040),"/home/olivier/git/earl-grey/src/parse.eg",4073,4090);}($9037$9075=null);;$9037$9075;if(((code1$9041&code2$9043)===0)){throw $9986(["syntax","order"]).create("Cannot mix operators in the given order",({"left":op1$9023,"right":op2$9024}));}else{if((ord1$9042>ord2$9044)){return LEFT$8165;}else{if((ord1$9042<ord2$9044)){return RIGHT$8166;}else{if((ord1$9042===ord2$9044)){return BOTH$8167;}else{$9973($9037$9075);}}}}});$8108(SimplePriority$8160,$8108(((accum$9101=({})),((accum$9101["::name"]="SimplePriority"),accum$9101)),((accum$9105=({})),((accum$9105["::egclass"]=true),accum$9105))));SimplePriority$8160;(MAX$8161=(1/0));;(eg_order$8162=(((eg_groups$9114=OperatorGroups$8157($8108(({"sh_ifx":[function($9118$9120){var t0$9133;var $9122$9128;var ph$9123;(ph$9123=$9118$9120);;($9122$9128=ph$9123);;if((($9122$9128 instanceof Array)&&((t0$9133=$9122$9128.length),((t0$9133===3)&&(($9122$9128[0]==="IFX")&&($9122$9128[1]==="short")))))){$9122$9128[2];return true;}else{$9122$9128;return false;}}],"sh_pfx":[function($9143$9145){var t0$9158;var $9147$9153;var ph$9148;(ph$9148=$9143$9145);;($9147$9153=ph$9148);;if((($9147$9153 instanceof Array)&&((t0$9158=$9147$9153.length),((t0$9158===3)&&(($9147$9153[0]==="PFX")&&($9147$9153[1]==="short")))))){$9147$9153[2];return true;}else{$9147$9153;return false;}}],"sh_sfx":[function($9168$9170){var t0$9183;var $9172$9178;var ph$9173;(ph$9173=$9168$9170);;($9172$9178=ph$9173);;if((($9172$9178 instanceof Array)&&((t0$9183=$9172$9178.length),((t0$9183===3)&&(($9172$9178[0]==="SFX")&&($9172$9178[1]==="short")))))){$9172$9178[2];return true;}else{$9172$9178;return false;}}],"wi_ifx":[function($9193$9195){var t0$9208;var $9197$9203;var ph$9198;(ph$9198=$9193$9195);;($9197$9203=ph$9198);;if((($9197$9203 instanceof Array)&&((t0$9208=$9197$9203.length),((t0$9208===3)&&(($9197$9203[0]==="IFX")&&($9197$9203[1]==="wide")))))){$9197$9203[2];return true;}else{$9197$9203;return false;}}],"wi_pfx":[function($9218$9220){var t0$9233;var $9222$9228;var ph$9223;(ph$9223=$9218$9220);;($9222$9228=ph$9223);;if((($9222$9228 instanceof Array)&&((t0$9233=$9222$9228.length),((t0$9233===3)&&(($9222$9228[0]==="PFX")&&($9222$9228[1]==="wide")))))){$9222$9228[2];return true;}else{$9222$9228;return false;}}],"wi_sfx":[function($9243$9245){var t0$9258;var $9247$9253;var ph$9248;(ph$9248=$9243$9245);;($9247$9253=ph$9248);;if((($9247$9253 instanceof Array)&&((t0$9258=$9247$9253.length),((t0$9258===3)&&(($9247$9253[0]==="SFX")&&($9247$9253[1]==="wide")))))){$9247$9253[2];return true;}else{$9247$9253;return false;}}],"comma":["X_,_Y"],"obrack":["(_Y","[_Y","{_Y"],"cbrack":["X_)","X_]","X_}"]}),$8108(((accum$9269=({})),((accum$9269["with"]=["X with Y"]),accum$9269)),$8108(({"lowprio":["X each Y","X each? Y","X where Y","X !! Y","X -> Y","X => Y","X = Y","X := Y","X += Y","X -= Y","X *= Y","X /= Y","X <<= Y","X >>= Y","X >>>= Y","X ++= Y","X ?= Y","X or= Y","X and= Y","X each= Y","X % Y"]}),$8108(((accum$9273=({})),((accum$9273["when"]=["X when Y"]),accum$9273)),$8108(((accum$9277=({})),((accum$9277["or"]=["X or Y"]),accum$9277)),$8108(((accum$9281=({})),((accum$9281["and"]=["X and Y"]),accum$9281)),$8108(((accum$9285=({})),((accum$9285["not"]=["not Y"]),accum$9285)),({"cmp":["X == Y","X != Y","X >= Y","X <= Y","X > Y","X < Y"],"binxor":["X ^. Y"],"binor":["X |. Y"],"binand":["X &. Y"],"shift":["X << Y","X >> Y","X >>> Y"],"add":["X + Y","X - Y"],"mul":["X * Y","X / Y","X // Y","X mod Y"],"exp":["X ** Y"],"sjuxt":["XWHITEY"],"wjuxt":["X WHITE Y"],"colon":["X_:_Y"],"pfx":["._Y","#_Y","@_Y"],"when2":["when Y"],"pp":["<> Y"],"pipe":["X |> Y"]}))))))))))),((eg_prio$9115=$8108(({"comma":[["all",1],["all",1]],"obrack":[["all",MAX$8161],["all",1]],"cbrack":[["all",1],["all",MAX$8161]]}),$8108(((accum$9292=({})),((accum$9292["with"]=[["all",1999],["all",10]]),accum$9292)),$8108(({"lowprio":[["all",11],["all",10]]}),$8108(((accum$9296=({})),((accum$9296["when"]=[["all",100],["all",101]]),accum$9296)),$8108(((accum$9300=({})),((accum$9300["or"]=[["all",110],["all",111]]),accum$9300)),$8108(((accum$9304=({})),((accum$9304["and"]=[["all",120],["all",121]]),accum$9304)),$8108(((accum$9308=({})),((accum$9308["not"]=[["all",MAX$8161],["all",131]]),accum$9308)),({"cmp":[["all",200],["all",201]],"binxor":[["all",400],["all",401]],"binor":[["all",410],["all",411]],"binand":[["all",420],["all",421]],"shift":[["arith",500],["arith",501]],"add":[["arith",550],["arith",551]],"mul":[["arith",560],["arith",561]],"exp":[["arith",571],["arith",570]],"wjuxt":[["all",13],["all",12]],"colon":[["all",12],["all",10]],"sjuxt":[["all",2000],["all",2001]],"pfx":[["all",MAX$8161],["all",3000]],"pp":[["all",MAX$8161],["all",5]],"when2":[["all",MAX$8161],["all",101]],"pipe":[["pipe",550],["pipe",551]],"sh_ifx":[["all",1800],["all",1801]],"sh_pfx":[["all",MAX$8161],["all",1901]],"sh_sfx":[["all",1900],["all",MAX$8161]],"wi_ifx":[["customl",900],["customr",901]],"wi_pfx":[["all",MAX$8161],["all",901]],"wi_sfx":[["all",900],["all",MAX$8161]]})))))))))),SimplePriority$8160(eg_groups$9114,eg_prio$9115)));;(DONE$8163=-1);;(NONE$8164=0);;(LEFT$8165=1);;(RIGHT$8166=2);;(BOTH$8167=3);;(oparse$8168=function(next$9331,order$9332,finalize$9333){var between$9336;var right_op$9337;var stack$9338;var left_op$9339;var current$9340;(between$9336=finalize$9333(next$9331()));;(right_op$9337=next$9331());;(stack$9338=[]);;(left_op$9339=null);;(current$9340=null);;$9341:while(true){var v$9381;var other$9397;var $9360$9366;var o$9361;(o$9361=function(){if(((!left_op$9339)&&(!right_op$9337))){return DONE$8163;}else{return ((((!left_op$9339)&&RIGHT$8166)||((!right_op$9337)&&LEFT$8165))||order$9332(left_op$9339,right_op$9337));}}());;($9360$9366=o$9361);;if(($9360$9366===DONE$8163)){return between$9336;}else{if(($9360$9366===LEFT$8165)){current$9340.push(between$9336);(between$9336=finalize$9333(current$9340));(v$9381=stack$9338.pop());;(left_op$9339=v$9381[0]);(current$9340=v$9381[1]);}else{if(($9360$9366===RIGHT$8166)){stack$9338.push([left_op$9339,current$9340]);(left_op$9339=right_op$9337);(current$9340=[[right_op$9337],between$9336]);(between$9336=finalize$9333(next$9331()));(right_op$9337=next$9331());}else{if(($9360$9366===BOTH$8167)){current$9340[0].push(right_op$9337);current$9340.push(between$9336);(left_op$9339=right_op$9337);(between$9336=finalize$9333(next$9331()));(right_op$9337=next$9331());}else{(other$9397=$9360$9366);throw $9986(["should_never_happen"]).create("undefined priority",({"left":left_op$9339,"right":right_op$9337}));}}}}}});;(finalize$8169=function($9402$9404){var t0$9413;var $index$9490;var $length$9485;var temp$9480;var $index$9520;var $length$9515;var temp$9510;var $index$9559;var $length$9554;var temp$9549;var acc$9544;var other$9787;var args$9782;var f$9770;var orig_args$9771;var args$9772;var $9745$9757;var $9746$9758;var t0$9753;var t1$9754;var t2$9755;var $9744$9748;var inserted$9640;var result$9641;var f$9798;var other$9857;var x$9850;var $9831$9841;var $9832$9842;var t0$9839;var $9830$9834;var result$9795;var f$9865;var oloc$9932;var abloc$9933;var oabloc$9934;var rval$9935;var a$9927;var b$9928;var $9457$9912;var $9458$9913;var $9459$9914;var $9460$9915;var t0$9905;var t1$9906;var t2$9907;var t3$9908;var t4$9909;var t5$9910;var other$9952;var $9456$9901;var target$9626;var _b$9627;var body$9628;var f$9618;var body$9619;var f$9606;var arg$9607;var body$9608;var $9461$9597;var $9462$9598;var $9463$9599;var $9464$9600;var $9465$9601;var $9466$9602;var $9467$9603;var t0$9586;var t1$9587;var t2$9588;var t3$9589;var t4$9590;var t5$9591;var t6$9592;var t7$9593;var t8$9594;var bridge$9455$9595;var $9454$9581;var sumloc$9468;var orig_ops$9469;var op$9470;var other$9956;var ops$9449;var args$9450;var value$9440;var value$9435;var value$9429;var $9407$9424;var $9408$9425;var $9409$9426;var t0$9422;var $9406$9417;var ph$9410;var token$9411;(t0$9413=$9402$9404);(token$9411=t0$9413);(ph$9410=t0$9413);;($9406$9417=ph$9410);;if((($9407$9424=($9406$9417 instanceof Array))&&((t0$9422=$9406$9417.length),(($9409$9426=(t0$9422===2))&&($9406$9417[0]==="ID"))))){(value$9429=$9406$9417[1]);return __lt____lt____colon__$8154(["symbol",value$9429],token$9411);}else{if(($9409$9426&&($9406$9417[0]==="NUM"))){(value$9435=$9406$9417[1]);return __lt____lt____colon__$8154(["value",value$9435],token$9411);}else{if(($9409$9426&&($9406$9417[0]==="STR"))){(value$9440=$9406$9417[1]);return __lt____lt____colon__$8154(["value",value$9440],token$9411);}else{if(($9407$9424&&((t0$9422===1)&&($9406$9417[0]==="VOID")))){return __lt____lt____colon__$8154(["void"],token$9411);}else{if(($9407$9424&&(t0$9422>=1))){(ops$9449=$9406$9417[0]);(args$9450=Array.prototype.slice.call($9406$9417,1));(sumloc$9468=ops$9449[0].location);;(temp$9480=ops$9449.slice(1));;($length$9485=temp$9480.length);;($index$9490=0);;$9471:for(;($index$9490<$length$9485);($index$9490++)){var op$9506;var m$9498;(m$9498=temp$9480[$index$9490]);;(op$9506=m$9498);(sumloc$9468=__plus____plus____colon__$8155(sumloc$9468,op$9506));}(temp$9510=args$9450);;($length$9515=temp$9510.length);;($index$9520=0);;$9473:for(;($index$9520<$length$9515);($index$9520++)){var arg$9536;var m$9528;(m$9528=temp$9510[$index$9520]);;(arg$9536=m$9528);(sumloc$9468=__plus____plus____colon__$8155(sumloc$9468,arg$9536));}(orig_ops$9469=ops$9449);;(ops$9449=(((acc$9544=[])),(((temp$9549=ops$9449)),((($length$9554=temp$9549.length)),((($index$9559=0)),function(){$9541:for(;($index$9559<$length$9554);($index$9559++)){var o$9575;var m$9567;(m$9567=temp$9549[$index$9559]);;(o$9575=m$9567);acc$9544.push(o$9575[2]);}}()))),acc$9544));(op$9470=ops$9449[0]);;($9454$9581=[ops$9449,args$9450]);;if((($9461$9597=($9454$9581 instanceof Array))&&((t0$9586=$9454$9581.length),(($9463$9599=(t0$9586===2))&&((t1$9587=$9454$9581[0]),(($9465$9601=(t1$9587 instanceof Array))&&((t2$9588=t1$9587.length),((t2$9588===2)&&((t1$9587[0]==="WHITE")&&((t1$9587[1]===":")&&((t3$9589=$9454$9581[1]),((t3$9589 instanceof Array)&&((t4$9590=t3$9589.length),(t4$9590===3)))))))))))))){(f$9606=t3$9589[0]);(arg$9607=t3$9589[1]);(body$9608=t3$9589[2]);return __lt____lt____colon__$8154(["send",f$9606,__lt____lt____colon__$8154(["data",arg$9607,body$9608],__plus____plus____colon__$8155(arg$9607,body$9608))],sumloc$9468);}else{if(($9465$9601&&(($9467$9603=(t2$9588===1))&&((t1$9587[0]===":")&&((t3$9589=$9454$9581[1]),((t3$9589 instanceof Array)&&((t4$9590=t3$9589.length),(t4$9590===2)))))))){(f$9618=t3$9589[0]);(body$9619=t3$9589[1]);return __lt____lt____colon__$8154(["send",f$9618,__lt____lt____colon__$8154(["data",body$9619],body$9619)],sumloc$9468);}else{if(($9467$9603&&((t1$9587[0]==="with")&&((t3$9589=$9454$9581[1]),((t3$9589 instanceof Array)&&((t4$9590=t3$9589.length),((t4$9590===2)&&((target$9626=t3$9589[0]),((t5$9591=t3$9589[1]),((_b$9627=t5$9591),((t6$9592=$10233(["multi"])(t5$9591)),(t6$9592[0]&&((t7$9593=t6$9592[1]),((t8$9594=t7$9593.length),(t8$9594>=0))))))))))))))){(body$9628=Array.prototype.slice.call(t7$9593,0));(inserted$9640=false);;(result$9641=transform$8156(target$9626,function($9647$9649){var t0$9655;var $index$9715;var $length$9710;var temp$9705;var tr$9693;var res$9694;var args$9688;var x$9676;var f$9677;var a$9678;var b$9679;var t0$9664;var t1$9665;var t2$9666;var $9651$9659;var ph$9652;var expr$9653;(t0$9655=$9647$9649);(expr$9653=t0$9655);(ph$9652=t0$9655);;($9651$9659=ph$9652);;if((($9651$9659 instanceof Array)&&((t0$9664=$9651$9659.length),((t0$9664===2)&&(($9651$9659[0]==="symbol")&&($9651$9659[1]==="...")))))){(inserted$9640=true);return __lt____lt____colon__$8154(["multi"].concat(body$9628),_b$9627);}else{(x$9676=$9651$9659);if((x$9676.fromop&&(($9651$9659 instanceof Array)&&((t0$9664=$9651$9659.length),((t0$9664===3)&&(($9651$9659[0]==="send")&&((f$9677=$9651$9659[1]),((t1$9665=$9651$9659[2]),((t1$9665 instanceof Array)&&((t2$9666=t1$9665.length),((t2$9666===3)&&(t1$9665[0]==="data")))))))))))){(a$9678=t1$9665[1]);(b$9679=t1$9665[2]);return ["send",this(f$9677),__lt____lt____colon__$8154(["data",this(a$9678),this(b$9679)],__plus____plus____colon__$8155(a$9678,b$9679))];}else{if((($9651$9659 instanceof Array)&&((t0$9664=$9651$9659.length),((t0$9664>=1)&&($9651$9659[0]==="data"))))){(args$9688=Array.prototype.slice.call($9651$9659,1));(tr$9693=this);;(res$9694=["data"]);;(temp$9705=args$9688);;($length$9710=temp$9705.length);;($index$9715=0);;$9695:for(;($index$9715<$length$9710);($index$9715++)){var other$9739;var t0$9728;var t1$9729;var m$9723;(m$9723=temp$9705[$index$9715]);;(t0$9728=m$9723);if(((t0$9728 instanceof Array)&&((t1$9729=t0$9728.length),((t1$9729===2)&&((t0$9728[0]==="symbol")&&(t0$9728[1]==="...")))))){(inserted$9640=true);(res$9694=res$9694.concat(body$9628));}else{(other$9739=m$9723);res$9694.push(__lt____lt____colon__$8154(tr$9693(other$9739),other$9739));}}return __lt____lt____colon__$8154(res$9694,expr$9653);}else{$9973($9651$9659);}}}}));;if((!inserted$9640)){($9744$9748=target$9626);;if((($9744$9748 instanceof Array)&&((t0$9753=$9744$9748.length),((t0$9753===1)&&($9744$9748[0]==="void"))))){return __lt____lt____colon__$8154(["data"].concat(body$9628),sumloc$9468);}else{$9744$9748;if(target$9626.fromop){return __lt____lt____colon__$8154(["send",target$9626,__lt____lt____colon__$8154(["data"].concat(body$9628),_b$9627)],sumloc$9468);}else{if((($9745$9757=($9744$9748 instanceof Array))&&((t0$9753=$9744$9748.length),((t0$9753===3)&&(($9744$9748[0]==="send")&&((f$9770=$9744$9748[1]),((t1$9754=$9744$9748[2]),((orig_args$9771=t1$9754),((t1$9754 instanceof Array)&&((t2$9755=t1$9754.length),((t2$9755>=1)&&(t1$9754[0]==="data")))))))))))){(args$9772=Array.prototype.slice.call(t1$9754,1));return __lt____lt____colon__$8154(["send",f$9770,__lt____lt____colon__$8154(["data"].concat(args$9772).concat(body$9628),__plus____plus____colon__$8155(orig_args$9771,_b$9627))],sumloc$9468);}else{if(($9745$9757&&((t0$9753>=1)&&($9744$9748[0]==="data")))){(args$9782=Array.prototype.slice.call($9744$9748,1));return __lt____lt____colon__$8154(target$9626.concat(body$9628),sumloc$9468);}else{(other$9787=$9744$9748);return __lt____lt____colon__$8154(["send",target$9626,__lt____lt____colon__$8154(["data"].concat(body$9628),_b$9627)],sumloc$9468);}}}}}else{return __lt____lt____colon__$8154(result$9641,sumloc$9468);}}else{if(($9465$9601&&(($9467$9603=(t2$9588>=1))&&((bridge$9455$9595=t1$9587[0]),((bridge$9455$9595==="[")||(bridge$9455$9595===",")))))){Array.prototype.slice.call(t1$9587,1);$9454$9581[1];if((op$9470==="[")){(args$9450=args$9450.slice(1,-1));}(args$9450=(((f$9798=function($9801$9803){var other$9825;var t0$9816;var $9805$9811;var ph$9806;(ph$9806=$9801$9803);;($9805$9811=ph$9806);;if((($9805$9811 instanceof Array)&&((t0$9816=$9805$9811.length),((t0$9816===1)&&($9805$9811[0]==="void"))))){return false;}else{(other$9825=$9805$9811);return true;}})),args$9450.filter(f$9798)));(result$9795=((($9830$9834=args$9450)),function(){if((($9831$9841=($9830$9834 instanceof Array))&&((t0$9839=$9830$9834.length),(t0$9839===0)))){return ["value",(void 0)];}else{if(($9831$9841&&(t0$9839===1))){(x$9850=$9830$9834[0]);if(((!isNaN(sumloc$9468.start))&&(!isNaN(sumloc$9468.end)))){(x$9850["location"]=sumloc$9468);}return x$9850;}else{(other$9857=$9830$9834);return ["multi"].concat(args$9450);}}}()));;return __lt____lt____colon__$8154(result$9795,sumloc$9468);}else{if(($9467$9603&&(t1$9587[0]==="{"))){Array.prototype.slice.call(t1$9587,1);$9454$9581[1];(f$9865=function($9868$9870){var other$9892;var t0$9883;var $9872$9878;var ph$9873;(ph$9873=$9868$9870);;($9872$9878=ph$9873);;if((($9872$9878 instanceof Array)&&((t0$9883=$9872$9878.length),((t0$9883===1)&&($9872$9878[0]==="void"))))){return false;}else{(other$9892=$9872$9878);return true;}});;return __lt____lt____colon__$8154(["data"].concat(args$9450.slice(1,-1).filter(f$9865)),sumloc$9468);}else{if(($9465$9601&&(($9467$9603=(t2$9588===1))&&(t1$9587[0]==="WHITE")))){$9454$9581[1];return __lt____lt____colon__$8154(["send"].concat(args$9450),sumloc$9468);}else{if($9467$9603){t1$9587[0];($9456$9901=$9454$9581[1]);(t0$9905=$9456$9901);if((($9458$9913=(t0$9905 instanceof Array))&&((t1$9906=t0$9905.length),(($9460$9915=(t1$9906===2))&&((t2$9907=t0$9905[0]),((t2$9907 instanceof Array)&&((t3$9908=t2$9907.length),((t3$9908===1)&&((t2$9907[0]==="void")&&((t4$9909=t0$9905[1]),((t4$9909 instanceof Array)&&((t5$9910=t4$9909.length),((t5$9910===1)&&(t4$9909[0]==="void")))))))))))))){return __lt____lt____colon__$8154(["symbol",op$9470],orig_ops$9469[0]);}else{if($9460$9915){(a$9927=t0$9905[0]);(b$9928=t0$9905[1]);(oloc$9932=orig_ops$9469[0].location);;(abloc$9933=__plus____plus____colon__$8155(a$9927,b$9928));;(oabloc$9934=__plus____plus____colon__$8155(orig_ops$9469[0],abloc$9933));;(rval$9935=__lt____lt____colon__$8154(["send",__lt____lt____colon__$8154(["symbol",op$9470],oloc$9932),__lt____lt____colon__$8154(["data",a$9927,b$9928],abloc$9933)],__plus____plus____colon__$8155(oloc$9932,abloc$9933)));;(rval$9935["fromop"]=true);return rval$9935;}else{$9973($9456$9901,"/home/olivier/git/earl-grey/src/parse.eg",17040,17045);}}}else{(other$9952=$9454$9581);throw $9986(["should_never_happen"]).create("unknown node",({"node":token$9411}));}}}}}}}}else{(other$9956=$9406$9417);throw $9986(["should_never_happen"]).create("unknown node (B)",({"node":token$9411}));}}}}}});;(parse$8170=function(tokens$9962){var next$9965;(next$9965=function(){return tokens$9962.shift();});;return oparse$8168(next$9965,eg_order$8162.compare.bind(eg_order$8162),finalize$8169);});;(exports["parse"]=parse$8170);(exports["oparse"]=oparse$8168);(exports["finalize"]=finalize$8169);(exports["DONE"]=DONE$8163);(exports["NONE"]=NONE$8164);(exports["LEFT"]=LEFT$8165);(exports["RIGHT"]=RIGHT$8166);(exports["BOTH"]=BOTH$8167);

},{"./location":7}],10:[function(require,module,exports){
var $10422=function(type$10424){var f$10427;(f$10427=type$10424["::check"]);;if((f$10427===(void 0))){return function(value$10432){return (value$10432 instanceof type$10424);};}else{return function(value$10435){return f$10427.call(type$10424,value$10435);};}};
var $10437=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $10438=function(dest$10440,values$10441){var k$10446;(k$10446=null);$10444:for(k$10446 in values$10441){if(values$10441.hasOwnProperty(k$10446)){(dest$10440[k$10446]=values$10441[k$10446]);}}return dest$10440;};
var $10450=function($10451$10453){var ph$10457;(ph$10457=$10451$10453);;var $10455$10462;($10455$10462=ph$10457);;var bridge$10456$10467;var x$10471;(bridge$10456$10467=$10455$10462);if((((typeof(bridge$10456$10467)==="string")&&((x$10471=bridge$10456$10467),true))||((typeof(bridge$10456$10467)==="number")&&((x$10471=bridge$10456$10467),true)))){return ["value",x$10471];}else{var other$10478;(other$10478=$10455$10462);return other$10478["::serialize_ast"]();}};
var send$10262;(send$10262=function(obj$10267,$10265$10268){var ph$10272;var msg$10273;var t0$10275;(t0$10275=$10265$10268);(msg$10273=t0$10275);(ph$10272=t0$10275);;var $10270$10279;($10270$10279=ph$10272);;var bridge$10271$10284;(bridge$10271$10284=$10270$10279);if(((typeof(bridge$10271$10284)==="string")||(typeof(bridge$10271$10284)==="number"))){return obj$10267[msg$10273];}else{var other$10292;(other$10292=$10270$10279);return obj$10267["::send"](msg$10273);}});;(Array[":::project"]=function($10295$10297){var ph$10300;var value$10301;var t0$10303;(t0$10303=$10295$10297);(value$10301=t0$10303);(ph$10300=t0$10303);;var $10299$10307;($10299$10307=ph$10300);;if($10422(Array)($10299$10307)){return [true,value$10301];}else{$10299$10307;return [true,[value$10301]];}});(Array.prototype["::check"]=function(value$10321){if((value$10321 instanceof Array)){var i$10326;(i$10326=0);;$10324:for(;(i$10326<this.length);(i$10326++)){if(($10437(this,i$10326)!==$10437(value$10321,i$10326))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $10438(this.slice(0),this);});(Array.prototype[":::project"]=function(value$10337){if((value$10337 instanceof Array)){var i$10342;(i$10342=0);;$10340:for(;(i$10342<this.length);(i$10342++)){if(($10437(this,i$10342)!==$10437(value$10337,i$10342))){return [true,[value$10337]];}}return [true,value$10337.slice(this.length)];}else{return [true,[value$10337]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($10450));});(RegExp.prototype["::check"]=function($10352$10354){var ph$10357;(ph$10357=$10352$10354);;var $10356$10362;($10356$10362=ph$10357);;var value$10370;if((typeof($10356$10362)==="string")){(value$10370=$10356$10362);if(value$10370.match(this)){return true;}else{return false;}}else{var other$10375;(other$10375=$10356$10362);return false;}});(RegExp.prototype[":::project"]=function($10377$10379){var ph$10382;(ph$10382=$10377$10379);;var $10381$10387;($10381$10387=ph$10382);;var value$10395;if((typeof($10381$10387)==="string")){(value$10395=$10381$10387);var $10398$10400;($10398$10400=value$10395.match(this));;var m$10408;if(($10398$10400===null)){(m$10408=$10398$10400);return [false,null];}else{var m$10413;(m$10413=$10398$10400);return [true,m$10413];}}else{var other$10417;(other$10417=$10381$10387);return [false,null];}});(Function.prototype["::send"]=function(args$10420){return this.apply(this,args$10420);});
var $13426=function(arr$13428){var results$13432;var l$13433;(results$13432=[]);;(l$13433=arr$13428.length);;var i$13441;(i$13441=0);;$13431:for(;(i$13441<l$13433);(i$13441++)){results$13432.push([i$13441,$10437(arr$13428,i$13441)]);}return results$13432;};
var $13448=function(value$13450,url$13451,start$13452,end$13453){var err$13456;(err$13456=$13257(["match"]).create("Could not find a match for value",({"value":value$13450})));;if(url$13451){(err$13456["location"]=["location",url$13451,start$13452,end$13453]);}throw err$13456;};
var $13257=function(){var $13258$13260;($13258$13260=function(tags$13264){var it$0$13267;(it$0$13267=function(){if((!$10422($13258$13260)(this))){return Object.create($13258$13260.prototype);}else{return this;}}());;(it$0$13267["tags"]=tags$13264);return it$0$13267;});;($13258$13260.prototype["create"]=function(){var $13276$13278;($13276$13278=arguments);;var t0$13283;var message$13287;var args$13288;(t0$13283=$13276$13278.length);if((t0$13283>=0)){(message$13287=function(){if((0>=t0$13283)){return "";}else{return $13276$13278[0];}}());(args$13288=Array.prototype.slice.call($13276$13278,1));var it$0$13292;(it$0$13292=this);;var self$13297;(self$13297=this);;var e$13302;(e$13302=Error(message$13287));;(e$13302["::tags"]=it$0$13292.tags);(e$13302["args"]=args$13288);var temp$13310;(temp$13310=$13426(args$13288));;var $length$13315;($length$13315=temp$13310.length);;var $index$13320;($index$13320=0);;$13303:for(;($index$13320<$length$13315);($index$13320++)){var m$13328;(m$13328=temp$13310[$index$13320]);;var t0$13333;var t1$13334;var i$13338;var arg$13339;(t0$13333=m$13328);if(((t0$13333 instanceof Array)&&((t1$13334=t0$13333.length),(t1$13334===2)))){(i$13338=t0$13333[0]);(arg$13339=t0$13333[1]);(e$13302[i$13338]=arg$13339);}else{$13448(m$13328);;}}(e$13302["length"]=args$13288.length);(e$13302["name"]=["E"].concat(it$0$13292.tags).join("."));return e$13302;}else{$13448($13276$13278);}});($13258$13260.prototype["::check"]=function(e$13350){var it$0$13353;(it$0$13353=this);;var self$13358;(self$13358=this);;var tags$13363;if(((!e$13350)||(!$10422(Error)(e$13350)))){return false;}(tags$13363=(e$13350["::tags"]||[]));;var temp$13372;(temp$13372=it$0$13353.tags);;var $length$13377;($length$13377=temp$13372.length);;var $index$13382;($index$13382=0);;$13364:for(;($index$13382<$length$13377);($index$13382++)){var m$13390;(m$13390=temp$13372[$index$13382]);;var tag$13398;(tag$13398=m$13390);if((tags$13363.indexOf(tag$13398)===-1)){return false;}else{false;;}}return true;});($13258$13260.prototype["::deconstruct"]=function(e$13406){var it$0$13409;(it$0$13409=this);;var self$13414;(self$13414=this);;return e$13406.args;});$10438($13258$13260,$10438(function(){var accum$13419;(accum$13419=({}));(accum$13419["::name"]="$13258");return accum$13419;}(),function(){var accum$13423;(accum$13423=({}));(accum$13423["::egclass"]=true);return accum$13423;}()));return $13258$13260;}();
var $13533=function($13534$13536,key$13537){var ph$13541;(ph$13541=$13534$13536);;var $13539$13546;($13539$13546=ph$13541);;var bridge$13540$13551;(bridge$13540$13551=$13539$13546);if(((bridge$13540$13551===null)||(bridge$13540$13551===(void 0)))){return false;}else{var x$13559;if((typeof($13539$13546)==="string")){(x$13559=$13539$13546);return (key$13537 in String.prototype);}else{var x$13564;if((typeof($13539$13546)==="number")){(x$13564=$13539$13546);return (key$13537 in Number.prototype);}else{var x$13569;(x$13569=$13539$13546);return (key$13537 in x$13569);}}}};
var $13477=function($13478$13480){var ph$13486;var x$13487;var t0$13489;(t0$13489=$13478$13480);(x$13487=t0$13489);(ph$13486=t0$13489);;var $13482$13493;($13482$13493=ph$13486);;var bridge$13483$13498;(bridge$13483$13498=$13482$13493);if((function(){var bridge$13484$13504;(bridge$13484$13504=bridge$13483$13498);return (function(){var bridge$13485$13507;(bridge$13485$13507=bridge$13484$13504);return ((bridge$13485$13507===(void 0))||(bridge$13485$13507===null));}()||(typeof(bridge$13484$13504)==="string"));}()||(typeof(bridge$13483$13498)==="number"))){return x$13487;}else{if($13533($13482$13493,"::clone")){$13482$13493["::clone"];return x$13487["::clone"]();}else{$13482$13493;if((Object.getPrototypeOf(x$13487)===Object.prototype)){var dest$13520;(dest$13520=({}));;var k$13525;(k$13525=null);$13519:for(k$13525 in x$13487){if(Object.prototype.hasOwnProperty.call(x$13487,k$13525)){(dest$13520[k$13525]=x$13487[k$13525]);}}return dest$13520;}else{var other$13531;(other$13531=$13482$13493);throw $13257(["clone"]).create("Object cannot be cloned",({"obj":x$13487}));}}}};
var $13461=function(a$13463,b$13464){var dest$13468;(dest$13468=$13477(a$13463));;var k$13473;(k$13473=null);$13467:for(k$13473 in b$13464){if(Object.prototype.hasOwnProperty.call(b$13464,k$13473)){(dest$13468[k$13473]=b$13464[k$13473]);}}return dest$13468;};
var $13571=Object.keys;
var $13572=function(type$13574){return function(value$13577){var f$13580;(f$13580=type$13574[":::project"]);;if((f$13580===(void 0))){(f$13580=type$13574["::project"]);if((f$13580===(void 0))){return [true,type$13574(value$13577)];}else{var rval$13586;(rval$13586=false);;try{(rval$13586=[true,f$13580(value$13577)]);}catch(excv$13592){var e$13598;(e$13598=excv$13592);(rval$13586=[false,null]);}return rval$13586;}}else{return f$13580.call(type$13574,value$13577);}};};
var $13600=function(xs$13602,ys$13603){var acc$13608;(acc$13608=[]);;var temp$13613;(temp$13613=$13426(xs$13602));;var $length$13618;($length$13618=temp$13613.length);;var $index$13623;($index$13623=0);;$13605:for(;($index$13623<$length$13618);($index$13623++)){var m$13631;(m$13631=temp$13613[$index$13623]);;var t0$13636;var t1$13637;var i$13641;var x$13642;(t0$13636=m$13631);if(((t0$13636 instanceof Array)&&((t1$13637=t0$13636.length),(t1$13637===2)))){(i$13641=t0$13636[0]);(x$13642=t0$13636[1]);acc$13608.push([x$13642,$10437(ys$13603,i$13641)]);}else{$13448(m$13631);;}}return acc$13608;};
var $13648=function(from$13650,to$13651){var rval$13655;(rval$13655=[]);;var i$13660;(i$13660=from$13650);;$13654:for(;(i$13660<=to$13651);(i$13660++)){rval$13655.push(i$13660);}return rval$13655;};var accum$11195;var accum$11199;var accum$11801;var accum$11805;var $10482$10486;var __lt____gt__$10487;var $10483$10488;var __lt____lt____colon__$10489;var util$10490;var GenSym$10491;var gensym$10492;var neighbours$10493;var classify$10494;var classify_contiguous$10495;var identity$10496;var $10485$10497;var checker_db$10498;var PatternParser$10499;var PatternProcessor$10500;var assemble_conditions$10501;var assemble_pattern$10502;var inject_below_uses$10503;var parse_pattern$10504;var checkall$10505;var same_block$10506;var parse_clauses$10507;var opt_clauses$10508;var weave_clauses$10509;($10482$10486=require("./pp"));;(__lt____gt__$10487=$10482$10486["<>"]);;($10483$10488=require("./location"));;(__lt____lt____colon__$10489=$10483$10488["<<:"]);;(util$10490=require("./util"));;(GenSym$10491=util$10490.GenSym);;(gensym$10492=util$10490.gensym);;(neighbours$10493=util$10490.neighbours);;(classify$10494=util$10490.classify);;(classify_contiguous$10495=util$10490.classify_contiguous);;(identity$10496=util$10490.identity);;($10485$10497=require("./expand"));;(checker_db$10498=$10485$10497.checker_db);;(PatternParser$10499=function(scope$10552,pattern$10553,opt$10554){var it$0$10557;(it$0$10557=function(){if((!$10422(PatternParser$10499)(this))){return Object.create(PatternParser$10499.prototype);}else{return this;}}());;(it$0$10557["opt"]=opt$10554);(it$0$10557["arguments"]=[]);(it$0$10557["vars"]=[]);(it$0$10557["specials"]=({}));(it$0$10557["pattern"]=it$0$10557.expand(scope$10552,pattern$10553,(opt$10554.tags||({})),true,it$0$10557.opt.indexable));return it$0$10557;});;(PatternParser$10499.prototype["parse_specs"]=function(scope$10567,specs$10568,tags$10569){var $index$10615;var $length$10610;var temp$10605;var acc$10600;var rest$10582;var has_defaults$10583;var rval$10584;var self$10577;var it$0$10572;(it$0$10572=this);;(self$10577=this);;(rest$10582=(void 0));;(has_defaults$10583=false);;(rval$10584=classify$10494("fw","bw","keys","defaults",(((acc$10600=[])),(((temp$10605=scope$10567.step_all(["pattern"],specs$10568))),((($length$10610=temp$10605.length)),((($index$10615=0)),function(){$10593:for(;($index$10615<$length$10610);($index$10615++)){var v$10667;var v$10662;var variable$10655;var value$10656;var key$10649;var subp$10650;var key$10644;var variable$10637;var $10595$10631;var $10596$10632;var $10597$10633;var $10598$10634;var t0$10628;var t1$10629;var m$10623;(m$10623=temp$10605[$index$10615]);;(t0$10628=m$10623);if((($10596$10632=(t0$10628 instanceof Array))&&((t1$10629=t0$10628.length),(($10598$10634=(t1$10629===2))&&(t0$10628[0]==="dynsplice"))))){(variable$10637=t0$10628[1]);acc$10600.push(((rest$10582=it$0$10572.expand(scope$10567,variable$10637,tags$10569)),["ignore"]));}else{if(($10598$10634&&(t0$10628[0]==="assoc"))){(key$10644=t0$10628[1]);acc$10600.push(["keys",[key$10644,it$0$10572.expand(scope$10567,key$10644,tags$10569)]]);}else{if(($10596$10632&&(($10598$10634=(t1$10629===3))&&(t0$10628[0]==="assoc")))){(key$10649=t0$10628[1]);(subp$10650=t0$10628[2]);acc$10600.push(["keys",[key$10649,it$0$10572.expand(scope$10567,subp$10650,tags$10569)]]);}else{if(($10598$10634&&(t0$10628[0]==="default"))){(variable$10655=t0$10628[1]);(value$10656=t0$10628[2]);acc$10600.push(((has_defaults$10583=true),function(){if(rest$10582){throw $13257(["syntax","pattern"]).create("No default arguments after rest arg.");}else{return ["defaults",[it$0$10572.expand(scope$10567,variable$10655,tags$10569),value$10656]];}}()));}else{(v$10662=m$10623);if(((rest$10582===(void 0))&&(!has_defaults$10583))){acc$10600.push(["fw",it$0$10572.expand(scope$10567,v$10662,tags$10569)]);}else{(v$10667=m$10623);acc$10600.push(["bw",it$0$10572.expand(scope$10567,v$10667,tags$10569)]);}}}}}}}()))),acc$10600)));;(rval$10584["rest"]=rest$10582);return rval$10584;});(PatternParser$10499.prototype["expand"]=function(){var x$10733;var x$10742;var x$10758;var x$10763;var variable$10769;var variable$10781;var x$10816;var msg$10823;var msg$10838;var $index$10871;var $length$10866;var temp$10861;var acc$10856;var $index$10975;var $length$10970;var temp$10965;var acc$10960;var $index$11006;var $length$11001;var temp$10996;var t0$11067;var t1$11068;var t2$11069;var $index$11097;var $length$11092;var temp$11087;var acc$11082;var patts$11076;var canon$10895;var normalize$10896;var pps$10897;var vars$10898;var patt$11156;var msg$11177;var other$11174;var keys$11162;var fw$11144;var bw$11145;var defaults$11146;var rest$11147;var $11123$11141;var t0$11134;var t1$11135;var t2$11136;var t3$11137;var t4$11138;var t5$11139;var $11122$11129;var specs$11124;var other$11189;var mode$11183;var subp$11184;var args$11118;var xs$10891;var xs$10850;var x$10844;var f$10829;var arg$10830;var f$10810;var arguments$10811;var checker$10804;var subp$10805;var projector$10798;var subp$10799;var condition$10792;var subp$10793;var v$10787;var v$10775;var type$10749;var $10711$10725;var $10712$10726;var $10713$10727;var $10714$10728;var t0$10721;var bridge$10710$10722;var t1$10723;var $10709$10716;var expr$10702;var rval$10703;var self$10697;var it$0$10692;var scope$10684;var pattern$10685;var tags$10686;var toplevel$10687;var checked$10688;var t0$10680;var $10673$10675;($10673$10675=arguments);;(t0$10680=$10673$10675.length);if(((t0$10680>=3)&&(t0$10680<=5))){(scope$10684=$10673$10675[0]);(pattern$10685=$10673$10675[1]);(tags$10686=$10673$10675[2]);(toplevel$10687=function(){if((3>=t0$10680)){return false;}else{return $10673$10675[3];}}());(checked$10688=function(){if((4>=t0$10680)){return false;}else{return $10673$10675[4];}}());(it$0$10692=this);;(self$10697=this);;(expr$10702=scope$10684.step(["pattern"],pattern$10685));;(rval$10703=((($10709$10716=expr$10702)),function(){if((((x$10733=$10709$10716)),((x$10733 instanceof Array)&&(x$10733[0]==="void")))){return ["check",checker_db$10498.null,["ignore"]];}else{if((((x$10742=$10709$10716)),((x$10742 instanceof Array)&&(x$10742[0]==="ignore")))){return expr$10702;}else{if((($10709$10716 instanceof Array)&&((t0$10721=$10709$10716.length),((t0$10721===2)&&($10709$10716[0]==="special"))))){(type$10749=$10709$10716[1]);(it$0$10692.specials[type$10749]=true);return expr$10702;}else{(bridge$10710$10722=$10709$10716);if(((((x$10758=bridge$10710$10722)),((x$10758 instanceof Array)&&(x$10758[0]==="symbol")))||(((x$10763=bridge$10710$10722)),((x$10763 instanceof Array)&&(x$10763[0]==="variable"))))){(variable$10769=$13461(expr$10702,tags$10686));;it$0$10692.vars.push(variable$10769);return ["assign",variable$10769];}else{if((($10711$10725=($10709$10716 instanceof Array))&&((t0$10721=$10709$10716.length),(($10713$10727=(t0$10721===2))&&(($10714$10728=($10709$10716[0]==="value"))&&((v$10775=$10709$10716[1]),it$0$10692.opt.strings_as_variables)))))){(variable$10781=__lt____lt____colon__$10489($13461(["symbol",v$10775],tags$10686),expr$10702));;it$0$10692.vars.push(variable$10781);return ["assign",variable$10781];}else{if($10714$10728){(v$10787=$10709$10716[1]);return ["check",checker_db$10498(v$10787),["ignore"]];}else{if(($10711$10725&&(($10713$10727=(t0$10721===3))&&($10709$10716[0]==="test")))){(condition$10792=$10709$10716[1]);(subp$10793=$10709$10716[2]);return ["test",condition$10792,it$0$10692.expand(scope$10684,subp$10793,tags$10686,toplevel$10687,false)];}else{if(($10713$10727&&($10709$10716[0]==="project"))){(projector$10798=$10709$10716[1]);(subp$10799=$10709$10716[2]);return ["project",projector$10798,it$0$10692.expand(scope$10684,subp$10799,tags$10686,toplevel$10687,true)];}else{if(($10713$10727&&($10709$10716[0]==="check"))){(checker$10804=$10709$10716[1]);(subp$10805=$10709$10716[2]);return ["check",checker$10804,it$0$10692.expand(scope$10684,subp$10805,tags$10686,toplevel$10687,true)];}else{if(($10713$10727&&(($10714$10728=($10709$10716[0]==="send"))&&((f$10810=$10709$10716[1]),((t1$10723=$10709$10716[2]),(((x$10816=t1$10723)),((x$10816 instanceof Array)&&(x$10816[0]==="data")))))))){(arguments$10811=t1$10723);if(toplevel$10687){it$0$10692.arguments.unshift(arguments$10811);return it$0$10692.expand(scope$10684,f$10810,tags$10686,true,false);}else{(msg$10823="Function arguments can only be declared as a top level pattern.");;throw $13257(["syntax","pattern"]).create(msg$10823,({"node":expr$10702,"arg":arguments$10811}));}}else{if($10714$10728){(f$10829=$10709$10716[1]);(arg$10830=$10709$10716[2]);return ["assign",expr$10702];}else{$10709$10716;if((!it$0$10692.opt.allow_nested)){(msg$10838="Nested patterns are not allowed here.");;throw $13257(["syntax","pattern"]).create(msg$10838,({"node":expr$10702}));}else{if((($10711$10725=($10709$10716 instanceof Array))&&((t0$10721=$10709$10716.length),((t0$10721===2)&&($10709$10716[0]==="neg"))))){(x$10844=$10709$10716[1]);return ["neg",it$0$10692.expand(scope$10684,x$10844,tags$10686)];}else{if(($10711$10725&&(($10713$10727=(t0$10721>=1))&&($10709$10716[0]==="all")))){(xs$10850=Array.prototype.slice.call($10709$10716,1));return ["all"].concat((((acc$10856=[])),(((temp$10861=xs$10850)),((($length$10866=temp$10861.length)),((($index$10871=0)),function(){$10853:for(;($index$10871<$length$10866);($index$10871++)){var x$10887;var m$10879;(m$10879=temp$10861[$index$10871]);;(x$10887=m$10879);acc$10856.push(it$0$10692.expand(scope$10684,x$10887,tags$10686));}}()))),acc$10856));}else{if(($10713$10727&&($10709$10716[0]==="any"))){(xs$10891=Array.prototype.slice.call($10709$10716,1));(canon$10895=function(all$10904){return all$10904.sort().join(",");});;(normalize$10896=function(vars$10910){var $index$10930;var $length$10925;var temp$10920;var acc$10915;return canon$10895((((acc$10915=[])),(((temp$10920=vars$10910)),((($length$10925=temp$10920.length)),((($index$10930=0)),function(){$10912:for(;($index$10930<$length$10925);($index$10930++)){var v$10948;var t0$10943;var t1$10944;var m$10938;(m$10938=temp$10920[$index$10930]);;(t0$10943=m$10938);if(((t0$10943 instanceof Array)&&((t1$10944=t0$10943.length),((t1$10944===2)&&(t0$10943[0]==="symbol"))))){(v$10948=t0$10943[1]);acc$10915.push(v$10948);}else{$13448(m$10938,"/home/olivier/git/earl-grey/src/pattern.eg",3853,3910);;}}}()))),acc$10915));});;(pps$10897=(((acc$10960=[])),(((temp$10965=xs$10891)),((($length$10970=temp$10965.length)),((($index$10975=0)),function(){$10957:for(;($index$10975<$length$10970);($index$10975++)){var x$10991;var m$10983;(m$10983=temp$10965[$index$10975]);;(x$10991=m$10983);acc$10960.push(PatternParser$10499(scope$10684,x$10991,$13461(it$0$10692.opt,({"tags":tags$10686}))));}}()))),acc$10960));;(temp$10996=neighbours$10493(pps$10897));;($length$11001=temp$10996.length);;($index$11006=0);;$10899:for(;($index$11006<$length$11001);($index$11006++)){var $index$11044;var $length$11039;var temp$11034;var pp1$11024;var pp2$11025;var t0$11019;var t1$11020;var m$11014;(m$11014=temp$10996[$index$11006]);;(t0$11019=m$11014);if(((t0$11019 instanceof Array)&&((t1$11020=t0$11019.length),(t1$11020===2)))){(pp1$11024=t0$11019[0]);(pp2$11025=t0$11019[1]);(temp$11034=pps$10897);;($length$11039=temp$11034.length);;($index$11044=0);;$11030:for(;($index$11044<$length$11039);($index$11044++)){var pp$11060;var m$11052;(m$11052=temp$11034[$index$11044]);;(pp$11060=m$11052);normalize$10896(pp$11060.vars);}if((normalize$10896(pp1$11024.vars)!==normalize$10896(pp2$11025.vars))){throw $13257(["syntax","pattern"]).create("Both branches of 'or' must contain the same variables",({"vars1":__lt____lt____colon__$10489(pp1$11024.vars.sort(),pp1$11024.pattern),"vars2":__lt____lt____colon__$10489(pp2$11025.vars.sort(),pp2$11025.pattern)}));}if((canon$10895($13571(pp1$11024.specials))!==canon$10895($13571(pp2$11025.specials)))){throw $13257(["syntax","pattern"]).create("Both branches of 'or' must contain the same special tokens",({"special1":__lt____lt____colon__$10489($13571(pp1$11024.specials).sort(),pp1$11024.pattern),"special2":__lt____lt____colon__$10489($13571(pp2$11025.specials).sort(),pp2$11025.pattern)}));}}else{$13448(m$11014,"/home/olivier/git/earl-grey/src/pattern.eg",4002,4799);;}}(t0$11067=pps$10897);if(((t0$11067 instanceof Array)&&((t1$11068=t0$11067.length),((t1$11068>=1)&&((t2$11069=t0$11067[0]),$13533(t2$11069,"vars")))))){(vars$10898=t2$11069.vars);Array.prototype.slice.call(t0$11067,1);;}else{$13448(pps$10897,"/home/olivier/git/earl-grey/src/pattern.eg",4816,4819);}(it$0$10692["vars"]=it$0$10692.vars.concat(vars$10898));(patts$11076=(((acc$11082=[])),(((temp$11087=pps$10897)),((($length$11092=temp$11087.length)),((($index$11097=0)),function(){$11079:for(;($index$11097<$length$11092);($index$11097++)){var pp$11113;var m$11105;(m$11105=temp$11087[$index$11097]);;(pp$11113=m$11105);acc$11082.push(pp$11113.pattern);}}()))),acc$11082));;return ["any"].concat(patts$11076);}else{if(($10713$10727&&($10709$10716[0]==="data"))){(args$11118=Array.prototype.slice.call($10709$10716,1));(specs$11124=it$0$10692.parse_specs(scope$10684,args$11118,tags$10686));;($11122$11129=specs$11124);;if((($11123$11141=$13533($11122$11129,"keys"))&&((t0$11134=$11122$11129.keys),((t0$11134 instanceof Array)&&((t1$11135=t0$11134.length),((t1$11135===0)&&($13533($11122$11129,"fw")&&((fw$11144=$11122$11129.fw),($13533($11122$11129,"bw")&&((bw$11145=$11122$11129.bw),($13533($11122$11129,"defaults")&&((defaults$11146=$11122$11129.defaults),$13533($11122$11129,"rest"))))))))))))){(rest$11147=$11122$11129.rest);(patt$11156=__lt____lt____colon__$10489(["array_pattern",fw$11144,bw$11145,defaults$11146,rest$11147],pattern$10685));;if(checked$10688){return patt$11156;}else{return ["check",checker_db$10498.Array,patt$11156];}}else{if(($11123$11141&&((keys$11162=$11122$11129.keys),($13533($11122$11129,"fw")&&((t0$11134=$11122$11129.fw),((t0$11134 instanceof Array)&&((t1$11135=t0$11134.length),((t1$11135===0)&&($13533($11122$11129,"bw")&&((t2$11136=$11122$11129.bw),((t2$11136 instanceof Array)&&((t3$11137=t2$11136.length),((t3$11137===0)&&($13533($11122$11129,"defaults")&&((t4$11138=$11122$11129.defaults),((t4$11138 instanceof Array)&&((t5$11139=t4$11138.length),((t5$11139===0)&&($13533($11122$11129,"rest")&&($11122$11129.rest===(void 0))))))))))))))))))))){return ["object_pattern"].concat(keys$11162);}else{(other$11174=$11122$11129);(msg$11177="Pattern must be an array or an object.");;throw $13257(["syntax","pattern"]).create(msg$11177,({"node":expr$10702,"specs":specs$11124}));}}}else{if(($10711$10725&&((t0$10721===3)&&($10709$10716[0]==="mode")))){(mode$11183=$10709$10716[1]);(subp$11184=$10709$10716[2]);return it$0$10692.expand(scope$10684,subp$11184,$13461(tags$10686,({"declare_mode":mode$11183})),toplevel$10687,checked$10688);}else{(other$11189=$10709$10716);throw $13257(["syntax","pattern"]).create("Illegal pattern",({"node":other$11189}));}}}}}}}}}}}}}}}}}}()));;return (it$0$10692.opt.wrap_pattern||identity$10496)(__lt____lt____colon__$10489(rval$10703,pattern$10685),toplevel$10687);}else{$13448($10673$10675);}});$10438(PatternParser$10499,$10438(((accum$11195=({})),((accum$11195["::name"]="PatternParser"),accum$11195)),((accum$11199=({})),((accum$11199["::egclass"]=true),accum$11199))));PatternParser$10499;(PatternProcessor$10500=function(){var it$0$11207;(it$0$11207=function(){if((!$10422(PatternProcessor$10500)(this))){return Object.create(PatternProcessor$10500.prototype);}else{return this;}}());;(it$0$11207["temps"]=[]);(it$0$11207["parts"]=[]);(it$0$11207["gen"]=GenSym$10491("t"));return it$0$11207;});;(PatternProcessor$10500.prototype["do"]=function(part$11217){var self$11225;var it$0$11220;(it$0$11220=this);;(self$11225=this);;return it$0$11220.parts.push(["do",part$11217]);});(PatternProcessor$10500.prototype["check"]=function(){var self$11253;var it$0$11248;var part$11243;var tags$11244;var t0$11239;var $11232$11234;($11232$11234=arguments);;(t0$11239=$11232$11234.length);if(((t0$11239>=1)&&(t0$11239<=2))){(part$11243=$11232$11234[0]);(tags$11244=function(){if((1>=t0$11239)){return ({});}else{return $11232$11234[1];}}());(it$0$11248=this);;(self$11253=this);;return it$0$11248.parts.push($13461(["check",part$11243],tags$11244));}else{$13448($11232$11234);}});(PatternProcessor$10500.prototype["temp"]=function(){var x$11301;var x$11306;var init$11313;var bridge$11284$11295;var $11283$11290;var self$11285;var it$0$11278;var x$11273;var v$11274;var t0$11269;var $11262$11264;($11262$11264=arguments);;(t0$11269=$11262$11264.length);if(((t0$11269>=1)&&(t0$11269<=2))){(x$11273=$11262$11264[0]);(v$11274=function(){if((1>=t0$11269)){return null;}else{return $11262$11264[1];}}());(it$0$11278=this);;(self$11285=this);;($11283$11290=x$11273);;(bridge$11284$11295=$11283$11290);if((((((x$11301=bridge$11284$11295)),((x$11301 instanceof Array)&&(x$11301[0]==="variable")))||(((x$11306=bridge$11284$11295)),((x$11306 instanceof Array)&&(x$11306[0]==="symbol"))))&&($13533($11283$11290,"single_assignment")&&($11283$11290.single_assignment&&(!v$11274))))){return x$11273;}else{(init$11313=$11283$11290);(v$11274=(v$11274||["symbol",it$0$11278.gen()]));(v$11274["single_assignment"]=true);it$0$11278.temps.push(v$11274);it$0$11278.do(["send",["symbol",":="],["data",v$11274,init$11313]]);return v$11274;}}else{$13448($11262$11264);}});(PatternProcessor$10500.prototype["process"]=function(pattern$11321,rhs$11322,fns$11323){var x$11360;var x$11389;var t$11401;var t$11412;var pp$11422;var $index$11450;var $length$11445;var temp$11440;var t$11432;var $index$11508;var $length$11503;var temp$11498;var acc$11493;var fn$11479;var parts$11480;var t$11474;var $index$11560;var $length$11555;var temp$11550;var acc$11545;var t$11538;var otherwise$11659;var $11641$11643;var $index$11673;var $length$11668;var temp$11663;var $index$11710;var $length$11705;var temp$11700;var end$11752;var pos$11747;var $index$11772;var $length$11767;var temp$11762;var acc$11757;var nfw$11599;var nbw$11600;var ndflt$11601;var extract_length$11602;var check_length$11603;var lo$11604;var hi$11605;var t$11606;var len$11607;var fw$11592;var bw$11593;var dflt$11594;var rest$11595;var subp$11534;var xs$11470;var xs$11428;var patt$11418;var projector$11407;var subp$11408;var checker$11396;var subp$11397;var checker$11385;var condition$11378;var subp$11379;var kind$11373;var sym$11367;var $11340$11352;var $11341$11353;var $11342$11354;var $11343$11355;var t0$11350;var $11339$11345;var rval$11336;var self$11331;var it$0$11326;(it$0$11326=this);;(self$11331=this);;(rval$11336=((($11339$11345=pattern$11321)),function(){if((((x$11360=$11339$11345)),((x$11360 instanceof Array)&&(x$11360[0]==="ignore")))){return it$0$11326.do(rhs$11322);}else{if((($11340$11352=($11339$11345 instanceof Array))&&((t0$11350=$11339$11345.length),(($11342$11354=(t0$11350===2))&&($11339$11345[0]==="assign"))))){(sym$11367=$11339$11345[1]);return it$0$11326.parts.push(fns$11323.assign(sym$11367,rhs$11322));}else{if(($11342$11354&&($11339$11345[0]==="special"))){(kind$11373=$11339$11345[1]);return it$0$11326.process(fns$11323.special(pattern$11321,rhs$11322),rhs$11322,fns$11323);}else{if(($11340$11352&&(($11342$11354=(t0$11350===3))&&($11339$11345[0]==="test")))){(condition$11378=$11339$11345[1]);(subp$11379=$11339$11345[2]);it$0$11326.process(subp$11379,rhs$11322,fns$11323);return it$0$11326.check(condition$11378,({"test":true}));}else{if(($11342$11354&&(($11343$11355=($11339$11345[0]==="check"))&&((checker$11385=$11339$11345[1]),(((x$11389=$11339$11345[2])),((x$11389 instanceof Array)&&(x$11389[0]==="ignore"))))))){return it$0$11326.check(["send",checker$11385,["data",rhs$11322]]);}else{if($11343$11355){(checker$11396=$11339$11345[1]);(subp$11397=$11339$11345[2]);(t$11401=it$0$11326.temp(rhs$11322));;it$0$11326.check(["send",checker$11396,["data",t$11401]]);return it$0$11326.process(subp$11397,t$11401,fns$11323);}else{if(($11342$11354&&($11339$11345[0]==="project"))){(projector$11407=$11339$11345[1]);(subp$11408=$11339$11345[2]);(t$11412=it$0$11326.temp(["send",projector$11407,["data",rhs$11322]]));;it$0$11326.check(["send",t$11412,["value",0]]);return it$0$11326.process(subp$11408,["send",t$11412,["value",1]],fns$11323);}else{if(($11340$11352&&((t0$11350===2)&&($11339$11345[0]==="neg")))){(patt$11418=$11339$11345[1]);return it$0$11326.check(["send",["symbol","not"],["data",["void"],(((pp$11422=PatternProcessor$10500())),pp$11422.process(patt$11418,rhs$11322,fns$11323),assemble_conditions$10501(pp$11422))]]);}else{if(($11340$11352&&(($11342$11354=(t0$11350>=1))&&($11339$11345[0]==="all")))){(xs$11428=Array.prototype.slice.call($11339$11345,1));(t$11432=it$0$11326.temp(rhs$11322));;(temp$11440=xs$11428);;($length$11445=temp$11440.length);;($index$11450=0);;$11433:for(;($index$11450<$length$11445);($index$11450++)){var x$11466;var m$11458;(m$11458=temp$11440[$index$11450]);;(x$11466=m$11458);it$0$11326.process(x$11466,t$11432,fns$11323);}return null;}else{if(($11342$11354&&($11339$11345[0]==="any"))){(xs$11470=Array.prototype.slice.call($11339$11345,1));(t$11474=it$0$11326.temp(rhs$11322,["symbol",gensym$10492("bridge")]));;return it$0$11326.check((((fn$11479=function(x$11484,rest$11485){return ["send",["symbol","or"],["data",x$11484,rest$11485]];})),((parts$11480=(((acc$11493=[])),(((temp$11498=xs$11470)),((($length$11503=temp$11498.length)),((($index$11508=0)),function(){$11490:for(;($index$11508<$length$11503);($index$11508++)){var pp$11527;var x$11524;var m$11516;(m$11516=temp$11498[$index$11508]);;(x$11524=m$11516);acc$11493.push((((pp$11527=PatternProcessor$10500())),pp$11527.process(x$11524,t$11474,fns$11323),assemble_conditions$10501(pp$11527)));}}()))),acc$11493))),util$10490.construct(parts$11480,fn$11479,["symbol","false"])));}else{if(($11342$11354&&($11339$11345[0]==="object_pattern"))){(subp$11534=Array.prototype.slice.call($11339$11345,1));(t$11538=it$0$11326.temp(rhs$11322));;(acc$11545=[]);;(temp$11550=subp$11534);;($length$11555=temp$11550.length);;($index$11560=0);;$11539:for(;($index$11560<$length$11555);($index$11560++)){var k$11580;var v$11581;var t0$11573;var t1$11574;var t2$11575;var t3$11576;var m$11568;(m$11568=temp$11550[$index$11560]);;(t0$11573=m$11568);if(((t0$11573 instanceof Array)&&((t1$11574=t0$11573.length),((t1$11574===2)&&((t2$11575=t0$11573[0]),((t2$11575 instanceof Array)&&((t3$11576=t2$11575.length),((t3$11576===2)&&(t2$11575[0]==="value"))))))))){(k$11580=t2$11575[1]);(v$11581=t0$11573[1]);acc$11545.push((it$0$11326.check(["send",["symbol","___hasprop"],["data",t$11538,["value",k$11580]]]),it$0$11326.process(v$11581,["send",t$11538,["value",k$11580]],fns$11323)));}else{$13448(m$11568,"/home/olivier/git/earl-grey/src/pattern.eg",8142,8274);;}}return acc$11545;}else{if(($11340$11352&&((t0$11350===5)&&($11339$11345[0]==="array_pattern")))){(fw$11592=$11339$11345[1]);(bw$11593=$11339$11345[2]);(dflt$11594=$11339$11345[3]);(rest$11595=$11339$11345[4]);(nfw$11599=fw$11592.length);;(nbw$11600=bw$11593.length);;(ndflt$11601=dflt$11594.length);;(extract_length$11602=true);;(check_length$11603=true);;(lo$11604=(nfw$11599+nbw$11600));;(hi$11605=(lo$11604+ndflt$11601));;(t$11606=it$0$11326.temp(rhs$11322));;(len$11607=it$0$11326.temp(["send",t$11606,["send",["symbol","."],["data",["void"],["symbol","length"]]]]));;it$0$11326.check(((($11641$11643=rest$11595)),function(){if($11641$11643){return ["send",["symbol",">="],["data",len$11607,["value",lo$11604]]];}else{$11641$11643;if((lo$11604===hi$11605)){return ["send",["symbol","==="],["data",len$11607,["value",lo$11604]]];}else{(otherwise$11659=$11641$11643);return ["send",["symbol","and"],["data",["send",["symbol",">="],["data",len$11607,["value",lo$11604]]],["send",["symbol","<="],["data",len$11607,["value",hi$11605]]]]];}}}()));(temp$11663=$13426(fw$11592));;($length$11668=temp$11663.length);;($index$11673=0);;$11608:for(;($index$11673<$length$11668);($index$11673++)){var i$11691;var m$11692;var t0$11686;var t1$11687;var m$11681;(m$11681=temp$11663[$index$11673]);;(t0$11686=m$11681);if(((t0$11686 instanceof Array)&&((t1$11687=t0$11686.length),(t1$11687===2)))){(i$11691=t0$11686[0]);(m$11692=t0$11686[1]);it$0$11326.process(m$11692,["send",t$11606,["value",i$11691]],fns$11323);}else{$13448(m$11681,"/home/olivier/git/earl-grey/src/pattern.eg",9006,9092);;}}(temp$11700=$13426(dflt$11594));;($length$11705=temp$11700.length);;($index$11710=0);;$11610:for(;($index$11710<$length$11705);($index$11710++)){var idx$11740;var i$11730;var patt$11731;var value$11732;var t0$11723;var t1$11724;var t2$11725;var t3$11726;var m$11718;(m$11718=temp$11700[$index$11710]);;(t0$11723=m$11718);if(((t0$11723 instanceof Array)&&((t1$11724=t0$11723.length),((t1$11724===2)&&((i$11730=t0$11723[0]),((t2$11725=t0$11723[1]),((t2$11725 instanceof Array)&&((t3$11726=t2$11725.length),(t3$11726===2))))))))){(patt$11731=t2$11725[0]);(value$11732=t2$11725[1]);(idx$11740=(i$11730+nfw$11599));;it$0$11326.process(patt$11731,["send",["symbol","if"],["data",["send",["symbol",">="],["data",["value",(idx$11740+nbw$11600)],len$11607]],value$11732,["send",t$11606,["value",idx$11740]]]],fns$11323);}else{$13448(m$11718,"/home/olivier/git/earl-grey/src/pattern.eg",9092,9261);;}}if((rest$11595!==(void 0))){(pos$11747=(nfw$11599+ndflt$11601));;(end$11752=function(){if((nbw$11600>0)){return [["value",(-nbw$11600)]];}else{return [];}}());;it$0$11326.process(rest$11595,["send",["send",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","slice"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",t$11606,["value",pos$11747]].concat(end$11752)],fns$11323);}else{[];}(acc$11757=[]);;(temp$11762=$13426(bw$11593));;($length$11767=temp$11762.length);;($index$11772=0);;$11612:for(;($index$11772<$length$11767);($index$11772++)){var i$11790;var m$11791;var t0$11785;var t1$11786;var m$11780;(m$11780=temp$11762[$index$11772]);;(t0$11785=m$11780);if(((t0$11785 instanceof Array)&&((t1$11786=t0$11785.length),(t1$11786===2)))){(i$11790=t0$11785[0]);(m$11791=t0$11785[1]);acc$11757.push(it$0$11326.process(m$11791,["send",["symbol","___js_fetch"],["data",t$11606,["send",["symbol","-"],["data",len$11607,["value",(nbw$11600-i$11790)]]]]],fns$11323));}else{$13448(m$11780,"/home/olivier/git/earl-grey/src/pattern.eg",9712,9863);;}}return acc$11757;}else{$13448($11339$11345);}}}}}}}}}}}}}()));;return rval$11336;});$10438(PatternProcessor$10500,$10438(((accum$11801=({})),((accum$11801["::name"]="PatternProcessor"),accum$11801)),((accum$11805=({})),((accum$11805["::egclass"]=true),accum$11805))));PatternProcessor$10500;(assemble_conditions$10501=function(pp$11811){var $index$11893;var $length$11888;var temp$11883;var acc$11878;var decls$11872;var construct$11814;(construct$11814=function($11817$11819){var x$11862;var rest$11863;var x$11855;var x$11847;var rest$11848;var $11822$11838;var $11823$11839;var t0$11834;var t1$11835;var t2$11836;var $11821$11829;var ph$11824;(ph$11824=$11817$11819);;($11821$11829=ph$11824);;if((($11822$11838=($11821$11829 instanceof Array))&&((t0$11834=$11821$11829.length),(t0$11834===0)))){return ["value",true];}else{if(($11822$11838&&((t0$11834>=1)&&((t1$11835=$11821$11829[0]),((t1$11835 instanceof Array)&&((t2$11836=t1$11835.length),((t2$11836===2)&&(t1$11835[0]==="do")))))))){(x$11847=t1$11835[1]);(rest$11848=Array.prototype.slice.call($11821$11829,1));return ["multi",x$11847,construct$11814(rest$11848)];}else{if(($11822$11838&&((t0$11834===1)&&((t1$11835=$11821$11829[0]),((t1$11835 instanceof Array)&&((t2$11836=t1$11835.length),((t2$11836===2)&&(t1$11835[0]==="check")))))))){(x$11855=t1$11835[1]);return x$11855;}else{if(($11822$11838&&((t0$11834>=1)&&((t1$11835=$11821$11829[0]),((t1$11835 instanceof Array)&&((t2$11836=t1$11835.length),((t2$11836===2)&&(t1$11835[0]==="check")))))))){(x$11862=t1$11835[1]);(rest$11863=Array.prototype.slice.call($11821$11829,1));return ["send",["symbol","and"],["data",x$11862,construct$11814(rest$11863)]];}else{$13448($11821$11829);}}}}});;if(pp$11811.temps.length){(decls$11872=(((acc$11878=[])),(((temp$11883=pp$11811.temps)),((($length$11888=temp$11883.length)),((($index$11893=0)),function(){$11875:for(;($index$11893<$length$11888);($index$11893++)){var t$11909;var m$11901;(m$11901=temp$11883[$index$11893]);;(t$11909=m$11901);acc$11878.push(["declare",t$11909]);}}()))),acc$11878));;return ["multi"].concat(decls$11872).concat([construct$11814(pp$11811.parts)]);}else{return construct$11814(pp$11811.parts);}});;(assemble_pattern$10502=function(){var $index$11963;var $length$11958;var temp$11953;var $index$12012;var $length$12007;var temp$12002;var test$12105;var lead$11933;var trail$11934;var construct$11935;var parts$11927;var t$11928;var f$11929;var t0$11923;var $11916$11918;($11916$11918=arguments);;(t0$11923=$11916$11918.length);if(((t0$11923>=2)&&(t0$11923<=3))){(parts$11927=$11916$11918[0]);(t$11928=$11916$11918[1]);(f$11929=function(){if((2>=t0$11923)){return null;}else{return $11916$11918[2];}}());(lead$11933=[]);;(temp$11953=parts$11927.slice(0));;($length$11958=temp$11953.length);;($index$11963=0);;$11936:for(;($index$11963<$length$11958);($index$11963++)){var x$11992;var x$11985;var $11938$11979;var $11939$11980;var $11940$11981;var $11941$11982;var t0$11976;var t1$11977;var m$11971;(m$11971=temp$11953[$index$11963]);;(t0$11976=m$11971);if((($11939$11980=(t0$11976 instanceof Array))&&((t1$11977=t0$11976.length),(($11941$11982=(t1$11977===2))&&(t0$11976[0]==="do"))))){(x$11985=t0$11976[1]);lead$11933.push(x$11985);parts$11927.shift();}else{if(($11941$11982&&(t0$11976[0]==="check"))){(x$11992=t0$11976[1]);break $11936;}else{$13448(m$11971,"/home/olivier/git/earl-grey/src/pattern.eg",10324,10434);;}}}(trail$11934=[]);;(temp$12002=parts$11927.slice(0).reverse());;($length$12007=temp$12002.length);;($index$12012=0);;$11942:for(;($index$12012<$length$12007);($index$12012++)){var x$12041;var x$12034;var $11944$12028;var $11945$12029;var $11946$12030;var $11947$12031;var t0$12025;var t1$12026;var m$12020;(m$12020=temp$12002[$index$12012]);;(t0$12025=m$12020);if((($11945$12029=(t0$12025 instanceof Array))&&((t1$12026=t0$12025.length),(($11947$12031=(t1$12026===2))&&(t0$12025[0]==="do"))))){(x$12034=t0$12025[1]);trail$11934.unshift(x$12034);parts$11927.pop();}else{if(($11947$12031&&(t0$12025[0]==="check"))){(x$12041=t0$12025[1]);break $11942;}else{$13448(m$12020,"/home/olivier/git/earl-grey/src/pattern.eg",10448,10570);;}}}(construct$11935=function($12048$12050){var other$12101;var x$12093;var rest$12094;var x$12086;var x$12078;var rest$12079;var $12053$12069;var $12054$12070;var t0$12065;var t1$12066;var t2$12067;var $12052$12060;var ph$12055;(ph$12055=$12048$12050);;($12052$12060=ph$12055);;if((($12053$12069=($12052$12060 instanceof Array))&&((t0$12065=$12052$12060.length),(t0$12065===0)))){return ["value",true];}else{if(($12053$12069&&((t0$12065>=1)&&((t1$12066=$12052$12060[0]),((t1$12066 instanceof Array)&&((t2$12067=t1$12066.length),((t2$12067===2)&&(t1$12066[0]==="do")))))))){(x$12078=t1$12066[1]);(rest$12079=Array.prototype.slice.call($12052$12060,1));return ["multi",x$12078,construct$11935(rest$12079)];}else{if(($12053$12069&&((t0$12065===1)&&((t1$12066=$12052$12060[0]),((t1$12066 instanceof Array)&&((t2$12067=t1$12066.length),((t2$12067===2)&&(t1$12066[0]==="check")))))))){(x$12086=t1$12066[1]);return x$12086;}else{if(($12053$12069&&((t0$12065>=1)&&((t1$12066=$12052$12060[0]),((t1$12066 instanceof Array)&&((t2$12067=t1$12066.length),((t2$12067===2)&&(t1$12066[0]==="check")))))))){(x$12093=t1$12066[1]);(rest$12094=Array.prototype.slice.call($12052$12060,1));return ["send",["symbol","and"],["data",x$12093,construct$11935(rest$12094)]];}else{(other$12101=$12052$12060);throw $13257(["oops"]).create("?!?",other$12101);}}}}});;if(parts$11927.length){(test$12105=construct$11935(parts$11927));;return ["multi"].concat(lead$11933).concat([function(){if(f$11929){return ["send",["symbol","if"],["data",test$12105,["multi"].concat(trail$11934).concat([t$11928]),f$11929]];}else{return ["send",["symbol","if"],["data",test$12105,["multi"].concat(trail$11934).concat([t$11928])]];}}()]);}else{return ["multi"].concat(lead$11933).concat(trail$11934).concat([t$11928]);}}else{$13448($11916$11918);}});;(inject_below_uses$10503=function($12114$12116,fn$12117){var other$12141;var scope$12134;var x$12135;var t0$12130;var $12119$12125;var ph$12120;(ph$12120=$12114$12116);;($12119$12125=ph$12120);;if((($12119$12125 instanceof Array)&&((t0$12130=$12119$12125.length),((t0$12130===3)&&($12119$12125[0]==="use"))))){(scope$12134=$12119$12125[1]);(x$12135=$12119$12125[2]);return ["use",scope$12134,inject_below_uses$10503(x$12135,fn$12117)];}else{(other$12141=$12119$12125);return fn$12117(other$12141);}});;(parse_pattern$10504=function(scope$12147,pattern$12148,rhs$12149,opt$12150){var t0$12161;var $index$12200;var $length$12195;var temp$12190;var acc$12185;var parse$12153;var target$12154;var proc$12155;(parse$12153=PatternParser$10499(scope$12147,pattern$12148,opt$12150));;if(((!opt$12150.allow_arguments)&&parse$12153.arguments.length)){throw $13257(["syntax","pattern","arguments"]).create("Arguments cannot be declared in this pattern",({"args":parse$12153.arguments[0]}));}(t0$12161=$13572((opt$12150.wrap_target||identity$10496))(function(){if(parse$12153.arguments.length){return inject_below_uses$10503(rhs$12149,function(x$12164){return util$10490.construct(parse$12153.arguments.concat([x$12164]),function(args$12167,rest$12168){return ["send",["symbol","->"],["data",args$12167,rest$12168]];});});}else{return rhs$12149;}}()));if(t0$12161[0]){(target$12154=t0$12161[1]);;}else{$13448(function(){if(parse$12153.arguments.length){return inject_below_uses$10503(rhs$12149,function(x$12173){return util$10490.construct(parse$12153.arguments.concat([x$12173]),function(args$12176,rest$12177){return ["send",["symbol","->"],["data",args$12176,rest$12177]];});});}else{return rhs$12149;}}(),"/home/olivier/git/earl-grey/src/pattern.eg",11963,12396);}(proc$12155=PatternProcessor$10500());;proc$12155.process(parse$12153.pattern,target$12154,opt$12150);if(opt$12150.finalize){return ["splice"].concat(opt$12150.declare(scope$12147,parse$12153.vars)).concat([["multi"].concat((((acc$12185=[])),(((temp$12190=proc$12155.temps)),((($length$12195=temp$12190.length)),((($index$12200=0)),function(){$12182:for(;($index$12200<$length$12195);($index$12200++)){var t$12216;var m$12208;(m$12208=temp$12190[$index$12200]);;(t$12216=m$12208);acc$12185.push(["declare",t$12216]);}}()))),acc$12185)).concat([assemble_pattern$10502(proc$12155.parts,opt$12150.success(target$12154),opt$12150.failure(target$12154))])]);}else{return [parse$12153.vars,proc$12155.temps,proc$12155.parts];}});;(checkall$10505=["send","data","multi","assign","void","check","do"]);;(same_block$10506=function($12224$12226,ban1$12227,ban2$12228){var $index$12329;var $length$12324;var temp$12319;var other$12350;var type1$12302;var args1$12303;var type2$12304;var args2$12305;var m1$12293;var m2$12294;var v1$12284;var v2$12285;var s1$12275;var s2$12276;var v1$12263;var v2$12264;var $12231$12254;var $12232$12255;var $12233$12256;var $12234$12257;var $12235$12258;var $12236$12259;var $12237$12260;var t0$12248;var t1$12249;var t2$12250;var t3$12251;var t4$12252;var $12230$12243;var ph$12238;(ph$12238=$12224$12226);;($12230$12243=ph$12238);;if((($12231$12254=($12230$12243 instanceof Array))&&((t0$12248=$12230$12243.length),(($12233$12256=(t0$12248===2))&&((t1$12249=$12230$12243[0]),(($12235$12258=(t1$12249 instanceof Array))&&((t2$12250=t1$12249.length),(($12237$12260=(t2$12250===2))&&((t1$12249[0]==="variable")&&((v1$12263=t1$12249[1]),((t3$12251=$12230$12243[1]),((t3$12251 instanceof Array)&&((t4$12252=t3$12251.length),((t4$12252===2)&&(t3$12251[0]==="variable"))))))))))))))){(v2$12264=t3$12251[1]);return (v1$12263===v2$12264);}else{if(($12237$12260&&((t1$12249[0]==="symbol")&&((s1$12275=t1$12249[1]),((t3$12251=$12230$12243[1]),((t3$12251 instanceof Array)&&((t4$12252=t3$12251.length),((t4$12252===2)&&(t3$12251[0]==="symbol"))))))))){(s2$12276=t3$12251[1]);return (((!$10437(ban1$12227,s1$12275))&&(!$10437(ban2$12228,s2$12276)))&&(s1$12275===s2$12276));}else{if(($12237$12260&&((t1$12249[0]==="value")&&((v1$12284=t1$12249[1]),((t3$12251=$12230$12243[1]),((t3$12251 instanceof Array)&&((t4$12252=t3$12251.length),((t4$12252===2)&&(t3$12251[0]==="value"))))))))){(v2$12285=t3$12251[1]);return (v1$12284===v2$12285);}else{if(($12237$12260&&((t1$12249[0]==="macro")&&((m1$12293=t1$12249[1]),((t3$12251=$12230$12243[1]),((t3$12251 instanceof Array)&&((t4$12252=t3$12251.length),((t4$12252===2)&&(t3$12251[0]==="macro"))))))))){(m2$12294=t3$12251[1]);return (m1$12293===m2$12294);}else{if(($12235$12258&&((t2$12250>=1)&&((type1$12302=t1$12249[0]),((args1$12303=Array.prototype.slice.call(t1$12249,1)),((t3$12251=$12230$12243[1]),((t3$12251 instanceof Array)&&((t4$12252=t3$12251.length),((t4$12252>=1)&&((type2$12304=t3$12251[0]),((args2$12305=Array.prototype.slice.call(t3$12251,1)),(checkall$10505.indexOf(type1$12302)!==-1)))))))))))){if(((type1$12302===type2$12304)&&(args1$12303.length===args2$12305.length))){(temp$12319=$13600(args1$12303,args2$12305));;($length$12324=temp$12319.length);;($index$12329=0);;$12315:for(;($index$12329<$length$12324);($index$12329++)){var pair$12345;var m$12337;(m$12337=temp$12319[$index$12329]);;(pair$12345=m$12337);if((!same_block$10506(pair$12345,ban1$12227,ban2$12228))){return false;}}return true;}else{return false;}}else{(other$12350=$12230$12243);return false;}}}}}});;(parse_clauses$10507=function(scope$12356,target$12357,stmts$12358,opt$12359){var $index$12389;var $length$12384;var temp$12379;var acc$12374;var $index$12565;var $length$12560;var temp$12555;var acc$12550;var $index$12612;var $length$12607;var temp$12602;var acc$12597;var decls$12591;var all_temps$12362;var the_parts$12363;var unique_temps$12364;(all_temps$12362=[]);;(the_parts$12363=(((acc$12374=[])),(((temp$12379=scope$12356.step_all(["clause"],stmts$12358))),((($length$12384=temp$12379.length)),((($index$12389=0)),function(){$12370:for(;($index$12389<$length$12384);($index$12389++)){var accum$12464;var accum$12475;var t0$12460;var t1$12461;var $index$12498;var $length$12493;var temp$12488;var bod$12525;var placeholder$12414;var special_fn$12415;var vars$12416;var temps$12417;var blocks$12418;var vars2$12419;var x$12534;var other$12541;var b$12531;var pattern$12408;var body$12409;var $12372$12405;var t0$12402;var t1$12403;var m$12397;(m$12397=temp$12379[$index$12389]);;(t0$12402=m$12397);if(((t0$12402 instanceof Array)&&((t1$12403=t0$12402.length),((t1$12403===3)&&(t0$12402[0]==="clause"))))){(pattern$12408=t0$12402[1]);(body$12409=t0$12402[2]);acc$12374.push((((placeholder$12414=(void 0))),((special_fn$12415=function($12427$12429,value$12430){var t0$12436;var t1$12437;var other$12456;var $12432$12443;var ph$12433;var expr$12434;(t0$12436=$12427$12429);if(((t0$12436 instanceof Array)&&((t1$12437=t0$12436.length),((t1$12437===2)&&(t0$12436[0]==="special"))))){(ph$12433=t0$12436[1]);(expr$12434=t0$12436);;}else{$13448($12427$12429);}($12432$12443=ph$12433);;if(($12432$12443==="match")){(placeholder$12414=__lt____lt____colon__$10489(["symbol",scope$12356.gensym("ph")],expr$12434));return ["assign",placeholder$12414];}else{(other$12456=$12432$12443);throw $13257(["syntax","pattern","special"]).create("Special token cannot be used here",({"special":expr$12434}));}})),((t0$12460=parse_pattern$10504(scope$12356,pattern$12408,target$12357,$13461(opt$12359,$10438(({"allow_arguments":false,"allow_nested":true,"special":special_fn$12415}),$10438(((accum$12464=({})),((accum$12464["assign"]=function(v$12468,value$12469){return ["do",__lt____lt____colon__$10489(["assign",v$12468,value$12469],v$12468)];}),accum$12464)),({"finalize":false})))))),function(){if(((t0$12460 instanceof Array)&&((t1$12461=t0$12460.length),(t1$12461===3)))){(vars$12416=t0$12460[0]);(temps$12417=t0$12460[1]);(blocks$12418=t0$12460[2]);}else{return $13448(parse_pattern$10504(scope$12356,pattern$12408,target$12357,$13461(opt$12359,$10438(({"allow_arguments":false,"allow_nested":true,"special":special_fn$12415}),$10438(((accum$12475=({})),((accum$12475["assign"]=function(v$12479,value$12480){return ["do",__lt____lt____colon__$10489(["assign",v$12479,value$12480],v$12479)];}),accum$12475)),({"finalize":false}))))),"/home/olivier/git/earl-grey/src/pattern.eg",14023,14370);}}()),(all_temps$12362=all_temps$12362.concat(temps$12417)),function(){if(placeholder$12414){return vars$12416.push(placeholder$12414);}}(),((vars2$12419=({}))),(((temp$12488=vars$12416)),((($length$12493=temp$12488.length)),((($index$12498=0)),function(){$12420:for(;($index$12498<$length$12493);($index$12498++)){var other$12522;var xxx$12516;var t0$12511;var t1$12512;var m$12506;(m$12506=temp$12488[$index$12498]);;(t0$12511=m$12506);if(((t0$12511 instanceof Array)&&((t1$12512=t0$12511.length),((t1$12512===2)&&(t0$12511[0]==="symbol"))))){(xxx$12516=t0$12511[1]);(vars2$12419[xxx$12516]=true);}else{(other$12522=m$12506);throw $13257(["syntax","unexpected"]).create();}}}()))),(((bod$12525=function(){if(placeholder$12414){return parse_clauses$10507(scope$12356,placeholder$12414,$13572(["multi"])(body$12409)[1],opt$12359);}else{if(opt$12359.wrap){return opt$12359.wrap(body$12409);}else{return body$12409;}}}())),["clause",vars$12416,vars2$12419,blocks$12418,bod$12525])));}else{if((((x$12534=t0$12402)),((x$12534 instanceof Array)&&(x$12534[0]==="block")))){(b$12531=t0$12402);acc$12374.push(b$12531);}else{(other$12541=m$12397);acc$12374.push(function(){throw $13257(["syntax","clause"]).create("Illegal clause",({"clause":other$12541}));}());}}}}()))),acc$12374));;if(opt$12359.fallback){the_parts$12363.push(["block",opt$12359.fallback(target$12357)]);}(unique_temps$12364=$13571(util$10490.mkset((((acc$12550=[])),(((temp$12555=all_temps$12362)),((($length$12560=temp$12555.length)),((($index$12565=0)),function(){$12547:for(;($index$12565<$length$12560);($index$12565++)){var t$12583;var t0$12578;var t1$12579;var m$12573;(m$12573=temp$12555[$index$12565]);;(t0$12578=m$12573);if(((t0$12578 instanceof Array)&&((t1$12579=t0$12578.length),((t1$12579===2)&&(t0$12578[0]==="symbol"))))){(t$12583=t0$12578[1]);acc$12550.push(t$12583);}else{$13448(m$12573,"/home/olivier/git/earl-grey/src/pattern.eg",15180,15210);;}}}()))),acc$12550))));;(decls$12591=(((acc$12597=[])),(((temp$12602=unique_temps$12364)),((($length$12607=temp$12602.length)),((($index$12612=0)),function(){$12594:for(;($index$12612<$length$12607);($index$12612++)){var t$12628;var m$12620;(m$12620=temp$12602[$index$12612]);;(t$12628=m$12620);acc$12597.push(["declare",["symbol",t$12628]]);}}()))),acc$12597));;return ["multi"].concat(decls$12591).concat([weave_clauses$10509(the_parts$12363)]);});;(opt_clauses$10508=function(clauses$12635){var $index$12664;var $length$12659;var temp$12654;var acc$12649;var $index$12799;var $length$12794;var temp$12789;var acc$12784;var $index$12844;var $length$12839;var temp$12834;var acc$12829;var $index$12888;var $length$12883;var temp$12878;var acc$12873;var shares$12638;var max$12639;var temps$12640;var shared_last$12641;var idx_last$12642;var new_clauses$12643;(shares$12638=(((acc$12649=[])),(((temp$12654=$13426(clauses$12635.slice(1)))),((($length$12659=temp$12654.length)),((($index$12664=0)),function(){$12646:for(;($index$12664<$length$12659);($index$12664++)){var t0$12703;var t1$12704;var $index$12727;var $length$12722;var temp$12717;var varsd0$12696;var blocks0$12697;var share$12698;var idx$12699;var i$12684;var vars$12685;var varsd$12686;var blocks$12687;var body$12688;var t0$12677;var t1$12678;var t2$12679;var t3$12680;var m$12672;(m$12672=temp$12654[$index$12664]);;(t0$12677=m$12672);if(((t0$12677 instanceof Array)&&((t1$12678=t0$12677.length),((t1$12678===2)&&((i$12684=t0$12677[0]),((t2$12679=t0$12677[1]),((t2$12679 instanceof Array)&&((t3$12680=t2$12679.length),((t3$12680===5)&&(t2$12679[0]==="clause")))))))))){(vars$12685=t2$12679[1]);(varsd$12686=t2$12679[2]);(blocks$12687=t2$12679[3]);(body$12688=t2$12679[4]);acc$12649.push((((t0$12703=$10437(clauses$12635,i$12684)),function(){if(((t0$12703 instanceof Array)&&((t1$12704=t0$12703.length),((t1$12704===5)&&(t0$12703[0]==="clause"))))){t0$12703[1];(varsd0$12696=t0$12703[2]);(blocks0$12697=t0$12703[3]);t0$12703[4];}else{return $13448($10437(clauses$12635,i$12684),"/home/olivier/git/earl-grey/src/pattern.eg",15483,15503);}}()),((share$12698=0)),((idx$12699=0)),(((temp$12717=blocks$12687)),((($length$12722=temp$12717.length)),((($index$12727=0)),function(){$12700:for(;($index$12727<$length$12722);($index$12727++)){var x$12758;var x$12767;var other$12774;var $12746$12748;var b$12743;var m$12735;(m$12735=temp$12717[$index$12727]);;(b$12743=m$12735);if(same_block$10506([$10437(blocks0$12697,share$12698),b$12743],varsd0$12696,varsd$12686)){(share$12698++);($12746$12748=b$12743);;if((((x$12758=$12746$12748)),((x$12758 instanceof Array)&&(x$12758[0]==="do")))){null;}else{if((((x$12767=$12746$12748)),((x$12767 instanceof Array)&&(x$12767[0]==="check")))){(idx$12699=share$12698);}else{(other$12774=$12746$12748);__lt____gt__$10487(null,other$12774);}}}else{break $12700;}}}()))),[share$12698,idx$12699]));}else{$13448(m$12672,"/home/olivier/git/earl-grey/src/pattern.eg",15359,15880);;}}}()))),acc$12649));;(max$12639=$10437(Math.max,(((acc$12784=[])),(((temp$12789=shares$12638)),((($length$12794=temp$12789.length)),((($index$12799=0)),function(){$12781:for(;($index$12799<$length$12794);($index$12799++)){var x$12817;var t0$12812;var t1$12813;var m$12807;(m$12807=temp$12789[$index$12799]);;(t0$12812=m$12807);if(((t0$12812 instanceof Array)&&((t1$12813=t0$12812.length),(t1$12813===2)))){(x$12817=t0$12812[0]);t0$12812[1];acc$12784.push(x$12817);}else{$13448(m$12807,"/home/olivier/git/earl-grey/src/pattern.eg",15894,15923);;}}}()))),acc$12784)));;shares$12638.push([0,0]);(temps$12640=(((acc$12829=[])),(((temp$12834=$13648(1,max$12639))),((($length$12839=temp$12834.length)),((($index$12844=0)),function(){$12826:for(;($index$12844<$length$12839);($index$12844++)){var m$12852;(m$12852=temp$12834[$index$12844]);;m$12852;acc$12829.push(["symbol",gensym$10492()]);}}()))),acc$12829));;(shared_last$12641=0);;(idx_last$12642=0);;(new_clauses$12643=(((acc$12873=[])),(((temp$12878=$13426(clauses$12635))),((($length$12883=temp$12878.length)),((($index$12888=0)),function(){$12870:for(;($index$12888<$length$12883);($index$12888++)){var t0$12926;var t1$12927;var $index$12962;var $length$12957;var temp$12952;var acc$12947;var rest$13011;var newblocks$13007;var share$12920;var idx$12921;var shared$12922;var n_to_share$12923;var to_share$12924;var other$13018;var i$12908;var vars$12909;var varsd$12910;var blocks$12911;var body$12912;var t0$12901;var t1$12902;var t2$12903;var t3$12904;var m$12896;(m$12896=temp$12878[$index$12888]);;(t0$12901=m$12896);if(((t0$12901 instanceof Array)&&((t1$12902=t0$12901.length),((t1$12902===2)&&((i$12908=t0$12901[0]),((t2$12903=t0$12901[1]),((t2$12903 instanceof Array)&&((t3$12904=t2$12903.length),((t3$12904===5)&&(t2$12903[0]==="clause")))))))))){(vars$12909=t2$12903[1]);(varsd$12910=t2$12903[2]);(blocks$12911=t2$12903[3]);(body$12912=t2$12903[4]);acc$12873.push((((t0$12926=$10437(shares$12638,i$12908)),function(){if(((t0$12926 instanceof Array)&&((t1$12927=t0$12926.length),(t1$12927===2)))){(share$12920=t0$12926[0]);(idx$12921=t0$12926[1]);}else{return $13448($10437(shares$12638,i$12908),"/home/olivier/git/earl-grey/src/pattern.eg",16144,16163);}}()),((shared$12922=function(){if(idx_last$12642){return [["check",$10437(temps$12640,(idx_last$12642-1))]];}else{return [];}}())),((n_to_share$12923=Math.max(shared_last$12641,share$12920))),((to_share$12924=(((acc$12947=[])),(((temp$12952=$13426(blocks$12911.slice(shared_last$12641,n_to_share$12923)))),((($length$12957=temp$12952.length)),((($index$12962=0)),function(){$12940:for(;($index$12962<$length$12957);($index$12962++)){var j$12996;var x$12997;var j$12986;var x$12987;var $12942$12980;var $12943$12981;var $12944$12982;var $12945$12983;var t0$12975;var t1$12976;var t2$12977;var t3$12978;var m$12970;(m$12970=temp$12952[$index$12962]);;(t0$12975=m$12970);if((($12943$12981=(t0$12975 instanceof Array))&&((t1$12976=t0$12975.length),(($12945$12983=(t1$12976===2))&&((j$12986=t0$12975[0]),((t2$12977=t0$12975[1]),((t2$12977 instanceof Array)&&((t3$12978=t2$12977.length),((t3$12978===2)&&(t2$12977[0]==="check")))))))))){(x$12987=t2$12977[1]);acc$12947.push(["check",["assign",$10437(temps$12640,(shared_last$12641+j$12986)),x$12987]]);}else{if(($12945$12983&&((j$12996=t0$12975[0]),((t2$12977=t0$12975[1]),((t2$12977 instanceof Array)&&((t3$12978=t2$12977.length),((t3$12978===2)&&(t2$12977[0]==="do")))))))){(x$12997=t2$12977[1]);acc$12947.push(["do",x$12997]);}else{$13448(m$12970,"/home/olivier/git/earl-grey/src/pattern.eg",16292,16463);;}}}}()))),acc$12947))),(shared_last$12641=share$12920),(idx_last$12642=idx$12921),(((newblocks$13007=(((rest$13011=blocks$12911.slice(n_to_share$12923))),shared$12922.concat(to_share$12924).concat(rest$13011)))),["clause",vars$12909,varsd$12910,newblocks$13007,body$12912])));}else{(other$13018=m$12896);acc$12873.push(function(){throw $13257(["oops"]).create("what",({"value":other$13018}));}());}}}()))),acc$12873));;return [temps$12640,new_clauses$12643];});;(weave_clauses$10509=function(parts$13025){var $index$13071;var $length$13066;var temp$13061;var $index$13237;var $length$13232;var temp$13227;var acc$13222;var groups$13028;var reassemble$13029;var new_temps$13030;var helper$13031;(groups$13028=classify_contiguous$10495(parts$13025,function($13040$13042){var t0$13046;var t1$13047;var cls$13044;(t0$13046=$13040$13042);if(((t0$13046 instanceof Array)&&((t1$13047=t0$13046.length),(t1$13047>=1)))){(cls$13044=t0$13046[0]);Array.prototype.slice.call(t0$13046,1);;}else{$13448($13040$13042);}return cls$13044;}));;(reassemble$13029=[]);;(new_temps$13030=[]);;(temp$13061=groups$13028);;($length$13066=temp$13061.length);;($index$13071=0);;$13032:for(;($index$13071<$length$13066);($index$13071++)){var t0$13101;var t1$13102;var ts$13098;var new_clauses$13099;var elems$13109;var elems$13093;var $13034$13087;var $13035$13088;var $13036$13089;var $13037$13090;var t0$13084;var t1$13085;var m$13079;(m$13079=temp$13061[$index$13071]);;(t0$13084=m$13079);if((($13035$13088=(t0$13084 instanceof Array))&&((t1$13085=t0$13084.length),(($13037$13090=(t1$13085>=1))&&(t0$13084[0]==="clause"))))){(elems$13093=Array.prototype.slice.call(t0$13084,1));(t0$13101=opt_clauses$10508(elems$13093));if(((t0$13101 instanceof Array)&&((t1$13102=t0$13101.length),(t1$13102===2)))){(ts$13098=t0$13101[0]);(new_clauses$13099=t0$13101[1]);;}else{$13448(opt_clauses$10508(elems$13093),"/home/olivier/git/earl-grey/src/pattern.eg",16958,16986);}(new_temps$13030=new_temps$13030.concat(ts$13098));(reassemble$13029=reassemble$13029.concat(new_clauses$13099));}else{if(($13037$13090&&(t0$13084[0]==="block"))){(elems$13109=Array.prototype.slice.call(t0$13084,1));(reassemble$13029=reassemble$13029.concat(elems$13109));}else{$13448(m$13079,"/home/olivier/git/earl-grey/src/pattern.eg",16892,17097);;}}}(helper$13031=function($13116$13118){var $index$13197;var $length$13192;var temp$13187;var acc$13182;var decls$13176;var vars$13168;var varsd$13169;var blocks$13170;var body$13171;var rest$13172;var body$13157;var rest$13158;var $13121$13144;var $13122$13145;var $13123$13146;var $13124$13147;var $13125$13148;var $13126$13149;var t0$13137;var t1$13138;var t2$13139;var t3$13140;var t4$13141;var t5$13142;var $13120$13132;var ph$13127;(ph$13127=$13116$13118);;($13120$13132=ph$13127);;if((($13121$13144=($13120$13132 instanceof Array))&&((t0$13137=$13120$13132.length),(t0$13137===0)))){return ["multi"];}else{if(($13121$13144&&(($13123$13146=(t0$13137>=1))&&((t1$13138=$13120$13132[0]),(($13125$13148=(t1$13138 instanceof Array))&&((t2$13139=t1$13138.length),((t2$13139===2)&&((t1$13138[0]==="block")&&((t3$13140=$13572(["multi"])(t1$13138[1])),(t3$13140[0]&&((t4$13141=t3$13140[1]),((t5$13142=t4$13141.length),(t5$13142>=0))))))))))))){(body$13157=Array.prototype.slice.call(t4$13141,0));(rest$13158=Array.prototype.slice.call($13120$13132,1));return ["multi"].concat(body$13157).concat([helper$13031(rest$13158)]);}else{if(($13125$13148&&((t2$13139===5)&&(t1$13138[0]==="clause")))){(vars$13168=t1$13138[1]);(varsd$13169=t1$13138[2]);(blocks$13170=t1$13138[3]);(body$13171=t1$13138[4]);(rest$13172=Array.prototype.slice.call($13120$13132,1));(decls$13176=(((acc$13182=[])),(((temp$13187=vars$13168)),((($length$13192=temp$13187.length)),((($index$13197=0)),function(){$13179:for(;($index$13197<$length$13192);($index$13197++)){var v$13213;var m$13205;(m$13205=temp$13187[$index$13197]);;(v$13213=m$13205);acc$13182.push(["declare",v$13213]);}}()))),acc$13182));;return ["tagscope","back",["multi"].concat(decls$13176).concat([assemble_pattern$10502(blocks$13170,body$13171,["use","back",helper$13031(rest$13172)])])];}else{$13448($13120$13132);}}}});;return ["multi"].concat((((acc$13222=[])),(((temp$13227=new_temps$13030)),((($length$13232=temp$13227.length)),((($index$13237=0)),function(){$13219:for(;($index$13237<$length$13232);($index$13237++)){var t$13253;var m$13245;(m$13245=temp$13227[$index$13237]);;(t$13253=m$13245);acc$13222.push(["declare",t$13253]);}}()))),acc$13222)).concat([helper$13031(reassemble$13029)]);});;(exports["PatternParser"]=PatternParser$10499);(exports["PatternProcessor"]=PatternProcessor$10500);(exports["parse_clauses"]=parse_clauses$10507);(exports["parse_pattern"]=parse_pattern$10504);

},{"./expand":5,"./location":7,"./pp":11,"./util":14}],11:[function(require,module,exports){
var $13828=function(type$13830){var f$13833;(f$13833=type$13830["::check"]);;if((f$13833===(void 0))){return function(value$13838){return (value$13838 instanceof type$13830);};}else{return function(value$13841){return f$13833.call(type$13830,value$13841);};}};
var $13843=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $13844=function(dest$13846,values$13847){var k$13852;(k$13852=null);$13850:for(k$13852 in values$13847){if(values$13847.hasOwnProperty(k$13852)){(dest$13846[k$13852]=values$13847[k$13852]);}}return dest$13846;};
var $13856=function($13857$13859){var ph$13863;(ph$13863=$13857$13859);;var $13861$13868;($13861$13868=ph$13863);;var bridge$13862$13873;var x$13877;(bridge$13862$13873=$13861$13868);if((((typeof(bridge$13862$13873)==="string")&&((x$13877=bridge$13862$13873),true))||((typeof(bridge$13862$13873)==="number")&&((x$13877=bridge$13862$13873),true)))){return ["value",x$13877];}else{var other$13884;(other$13884=$13861$13868);return other$13884["::serialize_ast"]();}};
var send$13668;(send$13668=function(obj$13673,$13671$13674){var ph$13678;var msg$13679;var t0$13681;(t0$13681=$13671$13674);(msg$13679=t0$13681);(ph$13678=t0$13681);;var $13676$13685;($13676$13685=ph$13678);;var bridge$13677$13690;(bridge$13677$13690=$13676$13685);if(((typeof(bridge$13677$13690)==="string")||(typeof(bridge$13677$13690)==="number"))){return obj$13673[msg$13679];}else{var other$13698;(other$13698=$13676$13685);return obj$13673["::send"](msg$13679);}});;(Array[":::project"]=function($13701$13703){var ph$13706;var value$13707;var t0$13709;(t0$13709=$13701$13703);(value$13707=t0$13709);(ph$13706=t0$13709);;var $13705$13713;($13705$13713=ph$13706);;if($13828(Array)($13705$13713)){return [true,value$13707];}else{$13705$13713;return [true,[value$13707]];}});(Array.prototype["::check"]=function(value$13727){if((value$13727 instanceof Array)){var i$13732;(i$13732=0);;$13730:for(;(i$13732<this.length);(i$13732++)){if(($13843(this,i$13732)!==$13843(value$13727,i$13732))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $13844(this.slice(0),this);});(Array.prototype[":::project"]=function(value$13743){if((value$13743 instanceof Array)){var i$13748;(i$13748=0);;$13746:for(;(i$13748<this.length);(i$13748++)){if(($13843(this,i$13748)!==$13843(value$13743,i$13748))){return [true,[value$13743]];}}return [true,value$13743.slice(this.length)];}else{return [true,[value$13743]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($13856));});(RegExp.prototype["::check"]=function($13758$13760){var ph$13763;(ph$13763=$13758$13760);;var $13762$13768;($13762$13768=ph$13763);;var value$13776;if((typeof($13762$13768)==="string")){(value$13776=$13762$13768);if(value$13776.match(this)){return true;}else{return false;}}else{var other$13781;(other$13781=$13762$13768);return false;}});(RegExp.prototype[":::project"]=function($13783$13785){var ph$13788;(ph$13788=$13783$13785);;var $13787$13793;($13787$13793=ph$13788);;var value$13801;if((typeof($13787$13793)==="string")){(value$13801=$13787$13793);var $13804$13806;($13804$13806=value$13801.match(this));;var m$13814;if(($13804$13806===null)){(m$13814=$13804$13806);return [false,null];}else{var m$13819;(m$13819=$13804$13806);return [true,m$13819];}}else{var other$13823;(other$13823=$13787$13793);return [false,null];}});(Function.prototype["::send"]=function(args$13826){return this.apply(this,args$13826);});
var $14608=function(type$14610){return function(value$14613){var f$14616;(f$14616=type$14610[":::project"]);;if((f$14616===(void 0))){(f$14616=type$14610["::project"]);if((f$14616===(void 0))){return [true,type$14610(value$14613)];}else{var rval$14622;(rval$14622=false);;try{(rval$14622=[true,f$14616(value$14613)]);}catch(excv$14628){var e$14634;(e$14634=excv$14628);(rval$14622=[false,null]);}return rval$14622;}}else{return f$14616.call(type$14610,value$14613);}};};
var $14818=function(arr$14820){var results$14824;var l$14825;(results$14824=[]);;(l$14825=arr$14820.length);;var i$14833;(i$14833=0);;$14823:for(;(i$14833<l$14825);(i$14833++)){results$14824.push([i$14833,$13843(arr$14820,i$14833)]);}return results$14824;};
var $14649=function(){var $14650$14652;($14650$14652=function(tags$14656){var it$0$14659;(it$0$14659=function(){if((!$13828($14650$14652)(this))){return Object.create($14650$14652.prototype);}else{return this;}}());;(it$0$14659["tags"]=tags$14656);return it$0$14659;});;($14650$14652.prototype["create"]=function(){var $14668$14670;($14668$14670=arguments);;var t0$14675;var message$14679;var args$14680;(t0$14675=$14668$14670.length);if((t0$14675>=0)){(message$14679=function(){if((0>=t0$14675)){return "";}else{return $14668$14670[0];}}());(args$14680=Array.prototype.slice.call($14668$14670,1));var it$0$14684;(it$0$14684=this);;var self$14689;(self$14689=this);;var e$14694;(e$14694=Error(message$14679));;(e$14694["::tags"]=it$0$14684.tags);(e$14694["args"]=args$14680);var temp$14702;(temp$14702=$14818(args$14680));;var $length$14707;($length$14707=temp$14702.length);;var $index$14712;($index$14712=0);;$14695:for(;($index$14712<$length$14707);($index$14712++)){var m$14720;(m$14720=temp$14702[$index$14712]);;var t0$14725;var t1$14726;var i$14730;var arg$14731;(t0$14725=m$14720);if(((t0$14725 instanceof Array)&&((t1$14726=t0$14725.length),(t1$14726===2)))){(i$14730=t0$14725[0]);(arg$14731=t0$14725[1]);(e$14694[i$14730]=arg$14731);}else{$14636(m$14720);;}}(e$14694["length"]=args$14680.length);(e$14694["name"]=["E"].concat(it$0$14684.tags).join("."));return e$14694;}else{$14636($14668$14670);}});($14650$14652.prototype["::check"]=function(e$14742){var it$0$14745;(it$0$14745=this);;var self$14750;(self$14750=this);;var tags$14755;if(((!e$14742)||(!$13828(Error)(e$14742)))){return false;}(tags$14755=(e$14742["::tags"]||[]));;var temp$14764;(temp$14764=it$0$14745.tags);;var $length$14769;($length$14769=temp$14764.length);;var $index$14774;($index$14774=0);;$14756:for(;($index$14774<$length$14769);($index$14774++)){var m$14782;(m$14782=temp$14764[$index$14774]);;var tag$14790;(tag$14790=m$14782);if((tags$14755.indexOf(tag$14790)===-1)){return false;}else{false;;}}return true;});($14650$14652.prototype["::deconstruct"]=function(e$14798){var it$0$14801;(it$0$14801=this);;var self$14806;(self$14806=this);;return e$14798.args;});$13844($14650$14652,$13844(function(){var accum$14811;(accum$14811=({}));(accum$14811["::name"]="$14650");return accum$14811;}(),function(){var accum$14815;(accum$14815=({}));(accum$14815["::egclass"]=true);return accum$14815;}()));return $14650$14652;}();
var $14636=function(value$14638,url$14639,start$14640,end$14641){var err$14644;(err$14644=$14649(["match"]).create("Could not find a match for value",({"value":value$14638})));;if(url$14639){(err$14644["location"]=["location",url$14639,start$14640,end$14641]);}throw err$14644;};
var $14481=function(){var $14482$14484;($14482$14484=function($14487$14490,$14488$14491){var classes$14493;var children$14494;var t0$14496;(t0$14496=$14608(Array)($14487$14490));if(t0$14496[0]){(classes$14493=t0$14496[1]);;}else{$14636($14487$14490);}var t0$14501;(t0$14501=$14608(Array)($14488$14491));if(t0$14501[0]){(children$14494=t0$14501[1]);;}else{$14636($14488$14491);}var it$0$14506;(it$0$14506=function(){if((!$13828($14482$14484)(this))){return Object.create($14482$14484.prototype);}else{return this;}}());;(it$0$14506["classes"]=classes$14493.sort());(it$0$14506["children"]=children$14494);return it$0$14506;});;$13844(function(){var accum$14514;(accum$14514=({}));(accum$14514["::check"]=function(x$14518){return ((x$14518&&x$14518.classes)&&x$14518.children);});return accum$14514;}(),$13844(function(){var accum$14521;(accum$14521=({}));(accum$14521["::deconstruct"]=function(x$14525){return [x$14525.classes,x$14525.children];});return accum$14521;}(),$13844(function(){var accum$14528;(accum$14528=({}));(accum$14528["::name"]="$14482");return accum$14528;}(),function(){var accum$14532;(accum$14532=({}));(accum$14532["::egclass"]=true);return accum$14532;}())));($14482$14484.prototype["::check"]=function(n$14538){var it$0$14541;(it$0$14541=this);;var self$14546;(self$14546=this);;var temp$14555;(temp$14555=it$0$14541.classes);;var $length$14560;($length$14560=temp$14555.length);;var $index$14565;($index$14565=0);;$14551:for(;($index$14565<$length$14560);($index$14565++)){var m$14573;(m$14573=temp$14555[$index$14565]);;var c$14581;(c$14581=m$14573);if((n$14538.classes.indexOf(c$14581)===-1)){return false;}else{false;;}}return true;});$13844($14482$14484,$13844(function(){var accum$14587;(accum$14587=({}));(accum$14587["::check"]=function(x$14591){return ((x$14591&&x$14591.classes)&&x$14591.children);});return accum$14587;}(),$13844(function(){var accum$14594;(accum$14594=({}));(accum$14594["::deconstruct"]=function(x$14598){return [x$14598.classes,x$14598.children];});return accum$14594;}(),$13844(function(){var accum$14601;(accum$14601=({}));(accum$14601["::name"]="$14482");return accum$14601;}(),function(){var accum$14605;(accum$14605=({}));(accum$14605["::egclass"]=true);return accum$14605;}()))));return $14482$14484;}();
var $14840=function(obj$14842){var results$14846;(results$14846=[]);;var k$14851;(k$14851=null);$14845:for(k$14851 in obj$14842){if(Object.prototype.hasOwnProperty.call(obj$14842,k$14851)){results$14846.push([k$14851,$13843(obj$14842,k$14851)]);}}return results$14846;};
var $14855=function($14856$14858,key$14859){var ph$14863;(ph$14863=$14856$14858);;var $14861$14868;($14861$14868=ph$14863);;var bridge$14862$14873;(bridge$14862$14873=$14861$14868);if(((bridge$14862$14873===null)||(bridge$14862$14873===(void 0)))){return false;}else{var x$14881;if((typeof($14861$14868)==="string")){(x$14881=$14861$14868);return (key$14859 in String.prototype);}else{var x$14886;if((typeof($14861$14868)==="number")){(x$14886=$14861$14868);return (key$14859 in Number.prototype);}else{var x$14891;(x$14891=$14861$14868);return (key$14859 in x$14891);}}}};var pr_terminus$13888;var pr$13889;var __lt____gt__$13890;var repr$13891;var escape_html$13892;var quotify$13893;var HTML$13894;(pr_terminus$13888=function(node$13898){var r$13901;var pre$13902;var post$13903;(r$13901=HTML$13894(node$13898,"span"));;(pre$13902=(String.fromCharCode(27)+"[?0;7y+h <div class=\"ug\">"));;(post$13903=("</div>"+String.fromCharCode(7)));;return console.log(((pre$13902+r$13901)+post$13903));});;(pr$13889=function($13916$13918,r$13919){var x$13940;var n$13935;var $13921$13927;var ph$13922;(ph$13922=$13916$13918);;($13921$13927=ph$13922);;if($13828($14481)($13921$13927)){(n$13935=$13921$13927);return pr_terminus$13888(n$13935);}else{(x$13940=$13921$13927);return pr_terminus$13888((r$13919||repr$13891)(x$13940));}});;(__lt____gt__$13890=function($13945$13947,x$13948){if(($13945$13947===null)){;}else{$14636($13945$13947);}return pr$13889(x$13948);});;(repr$13891=function(){var $index$14033;var $length$14028;var temp$14023;var acc$14018;var $index$14077;var $length$14072;var temp$14067;var acc$14062;var other$14104;var entries$14012;var $13960$13985;var t0$13983;var x$13973;var recur$13974;var $13959$13975;var t0$13967;var t1$13968;var t2$13969;var $13958$13962;($13958$13962=arguments);;(t0$13967=$13958$13962.length);if((((t0$13967>=1)&&(t0$13967<=2))&&((t1$13968=$13958$13962[0]),((x$13973=t1$13968),(($13959$13975=t1$13968),((t2$13969=function(){if((1>=t0$13967)){return repr$13891;}else{return $13958$13962[1];}}()),$13828(Function)(t2$13969))))))){(recur$13974=t2$13969);if(($13959$13975===true)){return $14481(["special","true"],"true");}else{if(($13959$13975===false)){return $14481(["special","false"],"false");}else{if(($13959$13975===null)){return $14481(["special","nil"],"null");}else{if(($13959$13975===(void 0))){return $14481(["special","nil"],"undefined");}else{if((typeof($13959$13975)==="number")){return $14481(["num"],String(x$13973));}else{if((typeof($13959$13975)==="string")){return $14481(["str"],x$13973);}else{(t0$13983=$13959$13975);if($13828(Array)(t0$13983)){(entries$14012=t0$13983);return $14481(["sequence"],(((acc$14018=[])),(((temp$14023=entries$14012)),((($length$14028=temp$14023.length)),((($index$14033=0)),function(){$14015:for(;($index$14033<$length$14028);($index$14033++)){var x$14049;var m$14041;(m$14041=temp$14023[$index$14033]);;(x$14049=m$14041);acc$14018.push(recur$13974(x$14049,repr$13891));}}()))),acc$14018));}else{$13959$13975;if(x$13973["::repr"]){return x$13973["::repr"](recur$13974);}else{if((Object.getPrototypeOf(x$13973)===Object.prototype)){return $14481(["+table","object"],(((acc$14062=[])),(((temp$14067=$14840(x$13973))),((($length$14072=temp$14067.length)),((($index$14077=0)),function(){$14059:for(;($index$14077<$length$14072);($index$14077++)){var k$14095;var v$14096;var t0$14090;var t1$14091;var m$14085;(m$14085=temp$14067[$index$14077]);;(t0$14090=m$14085);if(((t0$14090 instanceof Array)&&((t1$14091=t0$14090.length),(t1$14091===2)))){(k$14095=t0$14090[0]);(v$14096=t0$14090[1]);acc$14062.push($14481(["+tr"],[$14481(["+th"],recur$13974(k$14095,repr$13891)),$14481(["+td"],recur$13974(v$14096,repr$13891))]));}else{$14636(m$14085,"/home/olivier/git/earl-grey/src/pp.eg",959,1289);;}}}()))),acc$14062));}else{(other$14104=$13959$13975);return $14481(["unknown"],other$14104.toString());}}}}}}}}}}else{$14636($13958$13962);}});;(escape_html$13892=function($14111$14113){var t0$14117;var repl$14122;var s$14115;(t0$14117=[true,String($14111$14113)]);if(t0$14117[0]){(s$14115=t0$14117[1]);;}else{$14636($14111$14113);}(repl$14122=({"&":"&amp;","<":"&lt;",">":"&gt;"}));;return s$14115.replace(RegExp("[&<>]","g"),function(x$14127){return $13843(repl$14122,x$14127);});});;(quotify$13893=function($14132$14134){var t0$14138;var s$14136;(t0$14138=[true,String($14132$14134)]);if(t0$14138[0]){(s$14136=t0$14138[1]);;}else{$14636($14132$14134);}return s$14136.replace(RegExp("[\"\\\\]","g"),function(x$14143){return ("\\"+x$14143);});});;(HTML$13894=function($14148$14150,default_tag$14151){var $index$14194;var $length$14189;var temp$14184;var acc$14179;var $index$14259;var $length$14254;var temp$14249;var $index$14336;var $length$14331;var temp$14326;var acc$14321;var $index$14391;var $length$14386;var temp$14381;var acc$14376;var $index$14437;var $length$14432;var temp$14427;var acc$14422;var other$14417;var $14361$14363;var x$14471;var other$14468;var $14220$14456;var tag$14221;var _classes$14222;var id$14223;var kv$14224;var sub$14225;var accum$14226;var other$14477;var classes$14214;var children$14215;var children$14172;var s$14167;var $14153$14159;var ph$14154;(ph$14154=$14148$14150);;($14153$14159=ph$14154);;if((typeof($14153$14159)==="string")){(s$14167=$14153$14159);return escape_html$13892(s$14167);}else{if($13828(Array)($14153$14159)){(children$14172=$14153$14159);return (((acc$14179=[])),(((temp$14184=children$14172)),((($length$14189=temp$14184.length)),((($index$14194=0)),function(){$14176:for(;($index$14194<$length$14189);($index$14194++)){var child$14210;var m$14202;(m$14202=temp$14184[$index$14194]);;(child$14210=m$14202);acc$14179.push(HTML$13894(child$14210,default_tag$14151));}}()))),acc$14179).join("");}else{if(($13828($14481)($14153$14159)&&($14855($14153$14159,"classes")&&((classes$14214=$14153$14159.classes),$14855($14153$14159,"children"))))){(children$14215=$14153$14159.children);(tag$14221=(default_tag$14151||"span"));;(_classes$14222=[]);;(id$14223=null);;(kv$14224=[]);;(sub$14225=[]);;(temp$14249=classes$14214);;($length$14254=temp$14249.length);;($index$14259=0);;$14227:for(;($index$14259<$length$14254);($index$14259++)){var s$14307;var m$14300;var m$14293;var k$14288;var k$14281;var v$14282;var $14229$14276;var $14230$14277;var $14231$14278;var t0$14272;var t1$14273;var t2$14274;var m$14267;(m$14267=temp$14249[$index$14259]);;(t0$14272=m$14267);if((($14230$14277=(t0$14272 instanceof Array))&&((t1$14273=t0$14272.length),((t1$14273===3)&&(t0$14272[0]==="assoc"))))){(k$14281=t0$14272[1]);(v$14282=t0$14272[2]);kv$14224.push([k$14281,v$14282]);}else{if(($14230$14277&&((t1$14273===2)&&(t0$14272[0]==="assoc")))){(k$14288=t0$14272[1]);kv$14224.push([k$14288,(void 0)]);}else{(t0$14272=$14608(RegExp("(?:^\\+((?:.*)))",""))(m$14267));if((t0$14272[0]&&((t1$14273=t0$14272[1]),((t2$14274=t1$14273.length),(t2$14274===2))))){t1$14273[0];(m$14293=t1$14273[1]);(tag$14221=m$14293);}else{(t0$14272=$14608(RegExp("(?:^#((?:.*)))",""))(m$14267));if((t0$14272[0]&&((t1$14273=t0$14272[1]),((t2$14274=t1$14273.length),(t2$14274===2))))){t1$14273[0];(m$14300=t1$14273[1]);(id$14223=m$14300);}else{(t0$14272=m$14267);if((typeof(t0$14272)==="string")){(s$14307=t0$14272);_classes$14222.push(s$14307);}else{$14636(m$14267,"/home/olivier/git/earl-grey/src/pp.eg",1860,2181);;}}}}}}(accum$14226=function(){if((tag$14221==="raw")){return [];}else{return ["<",tag$14221];}}());;if(id$14223){(accum$14226=accum$14226.concat(" id=\"",id$14223,"\""));}if(_classes$14222.length){(accum$14226=accum$14226.concat(" class=\"",quotify$13893(_classes$14222.join(" ")),"\""));}if(kv$14224){(acc$14321=[]);;(temp$14326=kv$14224);;($length$14331=temp$14326.length);;($index$14336=0);;$14318:for(;($index$14336<$length$14331);($index$14336++)){var k$14354;var v$14355;var t0$14349;var t1$14350;var m$14344;(m$14344=temp$14326[$index$14336]);;(t0$14349=m$14344);if(((t0$14349 instanceof Array)&&((t1$14350=t0$14349.length),(t1$14350===2)))){(k$14354=t0$14349[0]);(v$14355=t0$14349[1]);acc$14321.push((accum$14226=accum$14226.concat(function(){if((v$14355!==null)){return [" ",k$14354,"=\"",quotify$13893(v$14355),"\""];}else{return [" ",k$14354];}}())));}else{$14636(m$14344,"/home/olivier/git/earl-grey/src/pp.eg",2435,2632);;}}acc$14321;}(children$14215=((($14361$14363=tag$14221)),function(){if(($14361$14363==="raw")){(acc$14376=[]);;(temp$14381=children$14215);;($length$14386=temp$14381.length);;($index$14391=0);;$14373:for(;($index$14391<$length$14386);($index$14391++)){var c$14413;var s$14408;var t0$14404;var m$14399;(m$14399=temp$14381[$index$14391]);;(t0$14404=m$14399);if((typeof(t0$14404)==="string")){(s$14408=t0$14404);acc$14376.push(s$14408);}else{(c$14413=m$14399);acc$14376.push(HTML$13894(c$14413,default_tag$14151));}}return acc$14376;}else{(other$14417=$14361$14363);(acc$14422=[]);;(temp$14427=children$14215);;($length$14432=temp$14427.length);;($index$14437=0);;$14419:for(;($index$14437<$length$14432);($index$14437++)){var c$14453;var m$14445;(m$14445=temp$14427[$index$14437]);;(c$14453=m$14445);acc$14422.push(HTML$13894(c$14453,default_tag$14151));}return acc$14422;}}()));($14220$14456=tag$14221);;if(($14220$14456==="raw")){return accum$14226.concat(children$14215).join("");}else{(other$14468=$14220$14456);(x$14471=[">"].concat(children$14215).concat(["</",tag$14221,">"]));;return accum$14226.concat(x$14471).join("");}}else{(other$14477=$14153$14159);return HTML$13894([true,String(other$14477)][1],default_tag$14151);}}}});;(exports["pr_terminus"]=pr_terminus$13888);(exports["pr"]=pr$13889);(exports["<>"]=__lt____gt__$13890);(exports["repr"]=repr$13891);

},{}],12:[function(require,module,exports){
var $16118=function(type$16120){var f$16123;(f$16123=type$16120["::check"]);;if((f$16123===(void 0))){return function(value$16128){return (value$16128 instanceof type$16120);};}else{return function(value$16131){return f$16123.call(type$16120,value$16131);};}};
var $16133=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $16134=function(dest$16136,values$16137){var k$16142;(k$16142=null);$16140:for(k$16142 in values$16137){if(values$16137.hasOwnProperty(k$16142)){(dest$16136[k$16142]=values$16137[k$16142]);}}return dest$16136;};
var $16146=function($16147$16149){var ph$16153;(ph$16153=$16147$16149);;var $16151$16158;($16151$16158=ph$16153);;var bridge$16152$16163;var x$16167;(bridge$16152$16163=$16151$16158);if((((typeof(bridge$16152$16163)==="string")&&((x$16167=bridge$16152$16163),true))||((typeof(bridge$16152$16163)==="number")&&((x$16167=bridge$16152$16163),true)))){return ["value",x$16167];}else{var other$16174;(other$16174=$16151$16158);return other$16174["::serialize_ast"]();}};
var send$15958;(send$15958=function(obj$15963,$15961$15964){var ph$15968;var msg$15969;var t0$15971;(t0$15971=$15961$15964);(msg$15969=t0$15971);(ph$15968=t0$15971);;var $15966$15975;($15966$15975=ph$15968);;var bridge$15967$15980;(bridge$15967$15980=$15966$15975);if(((typeof(bridge$15967$15980)==="string")||(typeof(bridge$15967$15980)==="number"))){return obj$15963[msg$15969];}else{var other$15988;(other$15988=$15966$15975);return obj$15963["::send"](msg$15969);}});;(Array[":::project"]=function($15991$15993){var ph$15996;var value$15997;var t0$15999;(t0$15999=$15991$15993);(value$15997=t0$15999);(ph$15996=t0$15999);;var $15995$16003;($15995$16003=ph$15996);;if($16118(Array)($15995$16003)){return [true,value$15997];}else{$15995$16003;return [true,[value$15997]];}});(Array.prototype["::check"]=function(value$16017){if((value$16017 instanceof Array)){var i$16022;(i$16022=0);;$16020:for(;(i$16022<this.length);(i$16022++)){if(($16133(this,i$16022)!==$16133(value$16017,i$16022))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $16134(this.slice(0),this);});(Array.prototype[":::project"]=function(value$16033){if((value$16033 instanceof Array)){var i$16038;(i$16038=0);;$16036:for(;(i$16038<this.length);(i$16038++)){if(($16133(this,i$16038)!==$16133(value$16033,i$16038))){return [true,[value$16033]];}}return [true,value$16033.slice(this.length)];}else{return [true,[value$16033]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($16146));});(RegExp.prototype["::check"]=function($16048$16050){var ph$16053;(ph$16053=$16048$16050);;var $16052$16058;($16052$16058=ph$16053);;var value$16066;if((typeof($16052$16058)==="string")){(value$16066=$16052$16058);if(value$16066.match(this)){return true;}else{return false;}}else{var other$16071;(other$16071=$16052$16058);return false;}});(RegExp.prototype[":::project"]=function($16073$16075){var ph$16078;(ph$16078=$16073$16075);;var $16077$16083;($16077$16083=ph$16078);;var value$16091;if((typeof($16077$16083)==="string")){(value$16091=$16077$16083);var $16094$16096;($16094$16096=value$16091.match(this));;var m$16104;if(($16094$16096===null)){(m$16104=$16094$16096);return [false,null];}else{var m$16109;(m$16109=$16094$16096);return [true,m$16109];}}else{var other$16113;(other$16113=$16077$16083);return [false,null];}});(Function.prototype["::send"]=function(args$16116){return this.apply(this,args$16116);});
var $22747=function($22748$22750,key$22751){var ph$22755;(ph$22755=$22748$22750);;var $22753$22760;($22753$22760=ph$22755);;var bridge$22754$22765;(bridge$22754$22765=$22753$22760);if(((bridge$22754$22765===null)||(bridge$22754$22765===(void 0)))){return false;}else{var x$22773;if((typeof($22753$22760)==="string")){(x$22773=$22753$22760);return (key$22751 in String.prototype);}else{var x$22778;if((typeof($22753$22760)==="number")){(x$22778=$22753$22760);return (key$22751 in Number.prototype);}else{var x$22783;(x$22783=$22753$22760);return (key$22751 in x$22783);}}}};
var $22954=function(arr$22956){var results$22960;var l$22961;(results$22960=[]);;(l$22961=arr$22956.length);;var i$22969;(i$22969=0);;$22959:for(;(i$22969<l$22961);(i$22969++)){results$22960.push([i$22969,$16133(arr$22956,i$22969)]);}return results$22960;};
var $22976=function(value$22978,url$22979,start$22980,end$22981){var err$22984;(err$22984=$22785(["match"]).create("Could not find a match for value",({"value":value$22978})));;if(url$22979){(err$22984["location"]=["location",url$22979,start$22980,end$22981]);}throw err$22984;};
var $22785=function(){var $22786$22788;($22786$22788=function(tags$22792){var it$0$22795;(it$0$22795=function(){if((!$16118($22786$22788)(this))){return Object.create($22786$22788.prototype);}else{return this;}}());;(it$0$22795["tags"]=tags$22792);return it$0$22795;});;($22786$22788.prototype["create"]=function(){var $22804$22806;($22804$22806=arguments);;var t0$22811;var message$22815;var args$22816;(t0$22811=$22804$22806.length);if((t0$22811>=0)){(message$22815=function(){if((0>=t0$22811)){return "";}else{return $22804$22806[0];}}());(args$22816=Array.prototype.slice.call($22804$22806,1));var it$0$22820;(it$0$22820=this);;var self$22825;(self$22825=this);;var e$22830;(e$22830=Error(message$22815));;(e$22830["::tags"]=it$0$22820.tags);(e$22830["args"]=args$22816);var temp$22838;(temp$22838=$22954(args$22816));;var $length$22843;($length$22843=temp$22838.length);;var $index$22848;($index$22848=0);;$22831:for(;($index$22848<$length$22843);($index$22848++)){var m$22856;(m$22856=temp$22838[$index$22848]);;var t0$22861;var t1$22862;var i$22866;var arg$22867;(t0$22861=m$22856);if(((t0$22861 instanceof Array)&&((t1$22862=t0$22861.length),(t1$22862===2)))){(i$22866=t0$22861[0]);(arg$22867=t0$22861[1]);(e$22830[i$22866]=arg$22867);}else{$22976(m$22856);;}}(e$22830["length"]=args$22816.length);(e$22830["name"]=["E"].concat(it$0$22820.tags).join("."));return e$22830;}else{$22976($22804$22806);}});($22786$22788.prototype["::check"]=function(e$22878){var it$0$22881;(it$0$22881=this);;var self$22886;(self$22886=this);;var tags$22891;if(((!e$22878)||(!$16118(Error)(e$22878)))){return false;}(tags$22891=(e$22878["::tags"]||[]));;var temp$22900;(temp$22900=it$0$22881.tags);;var $length$22905;($length$22905=temp$22900.length);;var $index$22910;($index$22910=0);;$22892:for(;($index$22910<$length$22905);($index$22910++)){var m$22918;(m$22918=temp$22900[$index$22910]);;var tag$22926;(tag$22926=m$22918);if((tags$22891.indexOf(tag$22926)===-1)){return false;}else{false;;}}return true;});($22786$22788.prototype["::deconstruct"]=function(e$22934){var it$0$22937;(it$0$22937=this);;var self$22942;(self$22942=this);;return e$22934.args;});$16134($22786$22788,$16134(function(){var accum$22947;(accum$22947=({}));(accum$22947["::name"]="$22786");return accum$22947;}(),function(){var accum$22951;(accum$22951=({}));(accum$22951["::egclass"]=true);return accum$22951;}()));return $22786$22788;}();
var $23005=function($23006$23008){var ph$23014;var x$23015;var t0$23017;(t0$23017=$23006$23008);(x$23015=t0$23017);(ph$23014=t0$23017);;var $23010$23021;($23010$23021=ph$23014);;var bridge$23011$23026;(bridge$23011$23026=$23010$23021);if((function(){var bridge$23012$23032;(bridge$23012$23032=bridge$23011$23026);return (function(){var bridge$23013$23035;(bridge$23013$23035=bridge$23012$23032);return ((bridge$23013$23035===(void 0))||(bridge$23013$23035===null));}()||(typeof(bridge$23012$23032)==="string"));}()||(typeof(bridge$23011$23026)==="number"))){return x$23015;}else{if($22747($23010$23021,"::clone")){$23010$23021["::clone"];return x$23015["::clone"]();}else{$23010$23021;if((Object.getPrototypeOf(x$23015)===Object.prototype)){var dest$23048;(dest$23048=({}));;var k$23053;(k$23053=null);$23047:for(k$23053 in x$23015){if(Object.prototype.hasOwnProperty.call(x$23015,k$23053)){(dest$23048[k$23053]=x$23015[k$23053]);}}return dest$23048;}else{var other$23059;(other$23059=$23010$23021);throw $22785(["clone"]).create("Object cannot be cloned",({"obj":x$23015}));}}}};
var $22989=function(a$22991,b$22992){var dest$22996;(dest$22996=$23005(a$22991));;var k$23001;(k$23001=null);$22995:for(k$23001 in b$22992){if(Object.prototype.hasOwnProperty.call(b$22992,k$23001)){(dest$22996[k$23001]=b$22992[k$23001]);}}return dest$22996;};
var $23061=function(type$23063){return function(value$23066){var f$23069;(f$23069=type$23063[":::project"]);;if((f$23069===(void 0))){(f$23069=type$23063["::project"]);if((f$23069===(void 0))){return [true,type$23063(value$23066)];}else{var rval$23075;(rval$23075=false);;try{(rval$23075=[true,f$23069(value$23066)]);}catch(excv$23081){var e$23087;(e$23087=excv$23081);(rval$23075=[false,null]);}return rval$23075;}}else{return f$23069.call(type$23063,value$23066);}};};
var $23089=function(obj$23091){var results$23095;(results$23095=[]);;var k$23100;(k$23100=null);$23094:for(k$23100 in obj$23091){if(Object.prototype.hasOwnProperty.call(obj$23091,k$23100)){results$23095.push([k$23100,$16133(obj$23091,k$23100)]);}}return results$23095;};
var $23104=function(xs$23106,ys$23107){var acc$23112;(acc$23112=[]);;var temp$23117;(temp$23117=$22954(xs$23106));;var $length$23122;($length$23122=temp$23117.length);;var $index$23127;($index$23127=0);;$23109:for(;($index$23127<$length$23122);($index$23127++)){var m$23135;(m$23135=temp$23117[$index$23127]);;var t0$23140;var t1$23141;var i$23145;var x$23146;(t0$23140=m$23135);if(((t0$23140 instanceof Array)&&((t1$23141=t0$23140.length),(t1$23141===2)))){(i$23145=t0$23140[0]);(x$23146=t0$23140[1]);acc$23112.push([x$23146,$16133(ys$23107,i$23145)]);}else{$22976(m$23135);;}}return acc$23112;};var accum$16329;var accum$16333;var $index$16370;var $length$16365;var temp$16360;var accum$16954;var accum$16963;var accum$17058;var accum$17069;var accum$17076;var accum$17105;var accum$17113;var accum$17124;var accum$17370;var accum$17424;var accum$17488;var accum$17550;var accum$17570;var accum$17642;var accum$17726;var accum$17754;var accum$17804;var accum$17851;var accum$17898;var accum$17936;var accum$18042;var accum$18149;var accum$18278;var accum$18298;var accum$18702;var accum$18838;var accum$18929;var t0$19001;var accum$18999;var t0$19147;var accum$19145;var t0$19201;var accum$19199;var t0$19343;var accum$19341;var t0$19583;var accum$19581;var accum$19743;var accum$19878;var accum$19898;var accum$19918;var t0$20032;var accum$20030;var accum$20190;var t0$20212;var accum$20210;var t0$20228;var accum$20226;var t0$20244;var accum$20242;var t0$20260;var accum$20258;var accum$20274;var accum$20299;var accum$20541;var accum$20763;var accum$20901;var accum$21094;var accum$21193;var accum$21542;var accum$21741;var $index$21816;var $length$21811;var temp$17366;var accum$22593;var accum$22597;var mac$22607;var $index$22718;var $length$22713;var temp$22708;var $16178$16183;var __lt____gt__$16184;var $16179$16185;var __lt____lt____colon__$16186;var util$16187;var neighbours$16188;var uuid$16189;var $16181$16190;var PatternParser$16191;var PatternProcessor$16192;var parse_pattern$16193;var parse_clauses$16194;var mt$16195;var Expander$16196;var Scope$16197;var Env$16198;var nullenv$16199;var mac1$16200;var checker_db$16201;var generic_nodes$16202;var Embedded$16203;var stdenv$16204;var mkstdenv$16205;var expander$16206;var expand$16207;var topscope$16208;var embed_location$16209;var error_embed_location$16210;var match_error$16211;var drop_ctx$16212;var expr_mac$16213;var overridable$16214;var protected_value$16215;var setup_label$16216;var break_mac$16217;var continue_mac$16218;var var_operator$16219;var accum_flags$16220;var pattern_constructors$16221;var disregard_specials$16222;var pattern_handlers$16223;var build_loop$16224;var partial_pattern$16225;var make_assigner$16226;var blocktest_wrap$16227;var blocktest_mac$16228;var qqstruct$16229;var qq$16230;var RegexBuilder$16231;var build_regexp$16232;var errf_macro$16233;var stdprelude$16234;($16178$16183=require("./pp"));;(__lt____gt__$16184=$16178$16183["<>"]);;($16179$16185=require("./location"));;(__lt____lt____colon__$16186=$16179$16185["<<:"]);;(util$16187=require("./util"));;(neighbours$16188=util$16187.neighbours);;(uuid$16189=util$16187.uuid);;($16181$16190=require("./pattern"));;(PatternParser$16191=$16181$16190.PatternParser);;(PatternProcessor$16192=$16181$16190.PatternProcessor);;(parse_pattern$16193=$16181$16190.parse_pattern);;(parse_clauses$16194=$16181$16190.parse_clauses);;(mt$16195=require("./expand"));;(Expander$16196=mt$16195.Expander);;(Scope$16197=mt$16195.Scope);;(Env$16198=mt$16195.Env);;(nullenv$16199=mt$16195.nullenv);;(mac1$16200=mt$16195["mac1"]);;(checker_db$16201=mt$16195.checker_db);;(generic_nodes$16202=["if","js_while","js_for","js_for_in","js_label","js_break","js_continue","js_return","js_delete","js_throw","js_try","js_new"]);;(Embedded$16203=function(code$16304){var it$0$16307;(it$0$16307=function(){if((!$16118(Embedded$16203)(this))){return Object.create(Embedded$16203.prototype);}else{return this;}}());;(it$0$16307["code"]=mkstdenv$16205().convert(code$16304));(it$0$16307["::id"]=uuid$16189());return it$0$16307;});;(Embedded$16203.prototype["::serialize_ast"]=function(){var self$16324;var it$0$16319;(it$0$16319=this);;(self$16324=this);;return expand$16207(["top"],topscope$16208,it$0$16319.code);});$16134(Embedded$16203,$16134(((accum$16329=({})),((accum$16329["::name"]="Embedded"),accum$16329)),((accum$16333=({})),((accum$16333["::egclass"]=true),accum$16333))));Embedded$16203;(stdenv$16204=Env$16198());;(mkstdenv$16205=function(){var e$16344;(e$16344=Env$16198());;(e$16344.scopes["top"]=stdenv$16204.scopes.top);return e$16344;});;(expander$16206=Expander$16196(mkstdenv$16205,generic_nodes$16202));;(expand$16207=expander$16206.expand.bind(expander$16206));;(topscope$16208=Scope$16197(null,"top",expander$16206));;(temp$16360=["+","-","*","/","mod","&.","|.","^.","and","or","not","===","!==","<",">","<=",">=","<<",">>",">>>","in","instanceof","--","++","true","false","null","undefined","typeof","String","Array","Number","Boolean","Object","RegExp","Function","Date","parseInt","parseFloat","Math","Error","TypeError","ReferenceError","console","process","eval","setTimeout","clearTimeout","___js_fetch","___node","arguments","this","exports"]);;($length$16365=temp$16360.length);;($index$16370=0);;$16235:for(;($index$16370<$length$16365);($index$16370++)){var k$16386;var m$16378;(m$16378=temp$16360[$index$16370]);;(k$16386=m$16378);stdenv$16204.bind(topscope$16208,k$16386,["variable",k$16386]);}(embed_location$16209=function($16390$16392){var other$16421;var url$16410;var start$16411;var end$16412;var t0$16405;var t1$16406;var $16394$16400;var ph$16395;(ph$16395=$16390$16392);;($16394$16400=ph$16395);;if(($22747($16394$16400,"location")&&((t0$16405=$16394$16400.location),($22747(t0$16405,"source")&&((t1$16406=t0$16405.source),($22747(t1$16406,"url")&&((url$16410=t1$16406.url),($22747(t0$16405,"start")&&((start$16411=t0$16405.start),$22747(t0$16405,"end")))))))))){(end$16412=t0$16405.end);return ["send",["send",["symbol","#"],["data",["void"],["symbol","location"]]],["data",["value",url$16410],["value",start$16411],["value",end$16412]]];}else{(other$16421=$16394$16400);return ["send",["send",["symbol","#"],["data",["void"],["symbol","location"]]],["data",["symbol","null"],["value",0],["value",0]]];}});;(error_embed_location$16210=function(error$16427,target$16428){return ["send",["symbol","throw"],["send",["symbol","&:"],["data",error$16427,["data",["send",["symbol","="],["data",["symbol","location"],embed_location$16209(target$16428)]]]]]];});;(match_error$16211=function($16433$16435){var t0$16441;var other$16466;var url$16455;var start$16456;var end$16457;var t0$16450;var t1$16451;var $16437$16445;var ph$16438;var target$16439;(t0$16441=$16433$16435);(target$16439=t0$16441);(ph$16438=t0$16441);;($16437$16445=ph$16438);;if(($22747($16437$16445,"location")&&((t0$16450=$16437$16445.location),($22747(t0$16450,"source")&&((t1$16451=t0$16450.source),($22747(t1$16451,"url")&&((url$16455=t1$16451.url),($22747(t0$16450,"start")&&((start$16456=t0$16450.start),$22747(t0$16450,"end")))))))))){(end$16457=t0$16450.end);return ["send",["symbol","___match_error"],["data",target$16439,["value",url$16455],["value",start$16456],["value",end$16457]]];}else{(other$16466=$16437$16445);return ["send",["symbol","___match_error"],["data",other$16466]];}});;(drop_ctx$16212=function(f$16472){return function(context$16475,scope$16476,form$16477,arg$16478){var rval$16481;(rval$16481=false);;try{(rval$16481=f$16472(context$16475,scope$16476,form$16477,arg$16478));}catch(excv$16487){var t0$16504;var e$16509;var t0$16490;var t1$16491;var t2$16492;var t3$16493;var t4$16494;(t0$16490=excv$16487);if(($16118($22785(["match"]))(t0$16490)&&($22747(t0$16490,"args")&&((t1$16491=t0$16490.args),((t1$16491 instanceof Array)&&((t2$16492=t1$16491.length),((t2$16492===1)&&((t3$16493=t1$16491[0]),($22747(t3$16493,"value")&&((t4$16494=t3$16493.value),((t4$16494===context$16475)&&(!((t4$16494 instanceof Array)&&((t0$16504=t4$16494.length),((t0$16504===2)&&((t4$16494[0]==="expr")&&(t4$16494[1]==="expr"))))))))))))))))){(rval$16481=["nostep",form$16477]);}else{(e$16509=excv$16487);(rval$16481=function(){throw e$16509;}());}}return rval$16481;};});;(expr_mac$16213=function(f$16515){return function($16517$16519,scope$16520,form$16521,arg$16522){var t0$16542;var t0$16545;var otherwise$16550;var bridge$16525$16536;var $16524$16531;var ph$16526;(ph$16526=$16517$16519);;($16524$16531=ph$16526);;(bridge$16525$16536=$16524$16531);if((((bridge$16525$16536 instanceof Array)&&((t0$16542=bridge$16525$16536.length),((t0$16542===2)&&((bridge$16525$16536[0]==="expr")&&(bridge$16525$16536[1]==="expr")))))||((bridge$16525$16536 instanceof Array)&&((t0$16545=bridge$16525$16536.length),((t0$16545===2)&&((bridge$16525$16536[0]==="expr")&&(bridge$16525$16536[1]==="head"))))))){return f$16515(scope$16520,form$16521,arg$16522);}else{(otherwise$16550=$16524$16531);return ["nostep",form$16521];}};});;(overridable$16214=function(f$16556){return function($16558$16560,scope$16561,form$16562,arg$16563){var t0$16569;var x$16584;var other$16596;var t0$16578;var $16565$16573;var ph$16566;var context$16567;(t0$16569=$16558$16560);(context$16567=t0$16569);(ph$16566=t0$16569);;($16565$16573=ph$16566);;if((((x$16584=$16565$16573)),((x$16584 instanceof Array)&&(x$16584[0]==="pattern")))){return ["nostep",form$16562];}else{if((($16565$16573 instanceof Array)&&((t0$16578=$16565$16573.length),((t0$16578===2)&&(($16565$16573[0]==="expr")&&($16565$16573[1]==="multi")))))){return ["nostep",form$16562];}else{(other$16596=$16565$16573);return f$16556(context$16567,scope$16561,form$16562,arg$16563);}}};});;(protected_value$16215=function(name$16602,value$16603){return function($16605$16607,scope$16608,form$16609,arg$16610){var x$16628;var other$16653;var t0$16644;var $16637$16639;var other$16635;var $16612$16618;var ph$16613;(ph$16613=$16605$16607);;($16612$16618=ph$16613);;if((((x$16628=$16612$16618)),((x$16628 instanceof Array)&&(x$16628[0]==="pattern")))){throw $22785(["syntax","pattern"]).create((("'"+name$16602)+"' is not a valid pattern and cannot be redeclared"));}else{(other$16635=$16612$16618);($16637$16639=arg$16610);;if((($16637$16639 instanceof Array)&&((t0$16644=$16637$16639.length),((t0$16644===1)&&($16637$16639[0]==="void"))))){return ["value",value$16603];}else{(other$16653=$16637$16639);return ["send",["value",value$16603],arg$16610];}}};});;(setup_label$16216=function(label$16659,env$16660,body$16661){return ["bind",$22989(["symbol","break"],({"env":env$16660})),["macro",break_mac$16217(label$16659)],["bind",$22989(["symbol","continue"],({"env":env$16660})),["macro",continue_mac$16218(label$16659)],["js_label",["value",label$16659],body$16661]]];});;(break_mac$16217=function(default_label$16667){return overridable$16214(function(context$16671,scope$16672,form$16673,$16669$16674){var t0$16684;var v$16715;var v$16710;var $16677$16695;var $16678$16696;var $16679$16697;var $16680$16698;var t0$16693;var $16676$16688;var ph$16681;var expr$16682;(t0$16684=$16669$16674);(expr$16682=t0$16684);(ph$16681=t0$16684);;($16676$16688=ph$16681);;if((($16677$16695=($16676$16688 instanceof Array))&&((t0$16693=$16676$16688.length),(($16679$16697=(t0$16693===1))&&(($16680$16698=($16676$16688[0]==="void"))&&default_label$16667))))){return ["js_break",["value",default_label$16667]];}else{if($16680$16698){return ["js_break"];}else{if(($16677$16695&&(($16679$16697=(t0$16693===2))&&($16676$16688[0]==="value")))){(v$16710=$16676$16688[1]);return ["js_break",expr$16682];}else{if(($16679$16697&&($16676$16688[0]==="symbol"))){(v$16715=$16676$16688[1]);return ["js_break",["value",v$16715]];}else{$22976($16676$16688);}}}}});});;(continue_mac$16218=function(default_label$16724){return overridable$16214(function(context$16728,scope$16729,form$16730,$16726$16731){var t0$16741;var v$16772;var v$16767;var $16734$16752;var $16735$16753;var $16736$16754;var $16737$16755;var t0$16750;var $16733$16745;var ph$16738;var expr$16739;(t0$16741=$16726$16731);(expr$16739=t0$16741);(ph$16738=t0$16741);;($16733$16745=ph$16738);;if((($16734$16752=($16733$16745 instanceof Array))&&((t0$16750=$16733$16745.length),(($16736$16754=(t0$16750===1))&&(($16737$16755=($16733$16745[0]==="void"))&&default_label$16724))))){return ["js_continue",["value",default_label$16724]];}else{if($16737$16755){return ["js_continue"];}else{if(($16734$16752&&(($16736$16754=(t0$16750===2))&&($16733$16745[0]==="value")))){(v$16767=$16733$16745[1]);return ["js_continue",expr$16739];}else{if(($16736$16754&&($16733$16745[0]==="symbol"))){(v$16772=$16733$16745[1]);return ["js_continue",["value",v$16772]];}else{$22976($16733$16745);}}}}});});;(var_operator$16219=function(name$16781){return function(context$16784,scope$16785,form$16786,expr$16787){var t0$16797;var x$16824;var other$16841;var s$16835;var t0$16830;var t1$16831;var $16791$16821;var $16792$16812;var $16793$16813;var t0$16810;var $16790$16805;var env$16794;var sym$16795;(t0$16797=form$16786);if($22747(t0$16797,"env")){(env$16794=t0$16797.env);;}else{$22976(form$16786,"/home/olivier/git/earl-grey/src/stdenv.eg",3522,3526);}(sym$16795=$22989(["symbol",name$16781],({"env":env$16794})));;($16790$16805=expr$16787);;if((($16792$16812=($16790$16805 instanceof Array))&&((t0$16810=$16790$16805.length),((t0$16810===1)&&($16790$16805[0]==="void"))))){return sym$16795;}else{if(($16792$16812&&((t0$16810===3)&&(($16790$16805[0]==="data")&&(((x$16824=$16790$16805[1])),((x$16824 instanceof Array)&&(x$16824[0]==="void"))))))){($16791$16821=$16790$16805[2]);(t0$16830=$16791$16821);if(((t0$16830 instanceof Array)&&((t1$16831=t0$16830.length),((t1$16831===2)&&(t0$16830[0]==="symbol"))))){(s$16835=t0$16830[1]);return ["send",sym$16795,["value",s$16835]];}else{(other$16841=$16791$16821);return ["send",sym$16795,other$16841];}}else{$22976($16790$16805);}}};});;(accum_flags$16220=function(){var make$16865;var mac$16860;var also_values$16861;var t0$16856;var $16849$16851;($16849$16851=arguments);;(t0$16856=$16849$16851.length);if(((t0$16856>=1)&&(t0$16856<=2))){(mac$16860=$16849$16851[0]);(also_values$16861=function(){if((1>=t0$16856)){return true;}else{return $16849$16851[1];}}());(make$16865=function(flags$16869){return function(context$16873,scope$16874,form$16875,$16871$16876){var other$16925;var flag$16912;var flag$16905;var $16879$16901;var $16880$16902;var t0$16891;var t1$16892;var t2$16893;var t3$16894;var t4$16895;var t5$16896;var t6$16897;var t7$16898;var t8$16899;var $16878$16886;var ph$16881;(ph$16881=$16871$16876);;($16878$16886=ph$16881);;if((($16879$16901=($16878$16886 instanceof Array))&&((t0$16891=$16878$16886.length),((t0$16891===2)&&(($16878$16886[0]==="value")&&((flag$16905=$16878$16886[1]),also_values$16861)))))){return ["macro",make$16865(flags$16869.concat([flag$16905]))];}else{if(($16879$16901&&((t0$16891===3)&&(($16878$16886[0]==="send")&&((t1$16892=$16878$16886[1]),((t1$16892 instanceof Array)&&((t2$16893=t1$16892.length),((t2$16893===2)&&((t1$16892[0]==="symbol")&&((t1$16892[1]===".")&&((t3$16894=$16878$16886[2]),((t3$16894 instanceof Array)&&((t4$16895=t3$16894.length),((t4$16895===3)&&((t3$16894[0]==="data")&&((t5$16896=t3$16894[1]),((t5$16896 instanceof Array)&&((t6$16897=t5$16896.length),((t6$16897===1)&&((t5$16896[0]==="void")&&((t7$16898=t3$16894[2]),((t7$16898 instanceof Array)&&((t8$16899=t7$16898.length),((t8$16899===2)&&(t7$16898[0]==="symbol"))))))))))))))))))))))))){(flag$16912=t7$16898[1]);return ["macro",make$16865(flags$16869.concat([flag$16912]))];}else{(other$16925=$16878$16886);return mac$16860(context$16873,scope$16874,form$16875,other$16925,flags$16869);}}};});;return make$16865([]);}else{$22976($16849$16851);}});;(pattern_constructors$16221=({}));;(disregard_specials$16222=function($16936$16938,value$16939){var t0$16944;var t1$16945;var kind$16941;var expr$16942;(t0$16944=$16936$16938);if(((t0$16944 instanceof Array)&&((t1$16945=t0$16944.length),((t1$16945===2)&&(t0$16944[0]==="special"))))){(kind$16941=t0$16944[1]);(expr$16942=t0$16944);;}else{$22976($16936$16938);}throw $22785(["syntax","pattern","special"]).create("Special token cannot be used here",({"special":expr$16942}));});;(pattern_handlers$16223=({"declare_variables":$16134(({"allow_nested":true,"allow_arguments":true,"special":disregard_specials$16222}),$16134(((accum$16954=({})),((accum$16954["assign"]=function(v$16958,value$16959,tags$16960){return ["do",__lt____lt____colon__$16186(["assign",v$16958,value$16959],v$16958)];}),accum$16954)),$16134(({"finalize":true,"tags":({"declare_mode":"unqualified"})}),$16134(((accum$16963=({})),((accum$16963["declare"]=function(scope$16967,vars$16968){var $index$16988;var $length$16983;var temp$16978;var acc$16973;(acc$16973=[]);;(temp$16978=vars$16968);;($length$16983=temp$16978.length);;($index$16988=0);;$16970:for(;($index$16988<$length$16983);($index$16988++)){var msg$17051;var other$17048;var $17030$17032;var $17006$17008;var v$17004;var m$16996;(m$16996=temp$16978[$index$16988]);;(v$17004=m$16996);acc$16973.push(((($17006$17008=v$17004.declare_mode)),function(){if(($17006$17008==="set")){return ["splice"];}else{if(($17006$17008==="let")){return ["declare",$22989(v$17004,({"mutable":false}))];}else{if(($17006$17008==="var")){return ["declare",$22989(v$17004,({"mutable":true}))];}else{if(($17006$17008==="unqualified")){($17030$17032=v$17004.env.resolve(scope$16967,v$17004[1]));;if(($17030$17032===(void 0))){return ["declare",$22989(v$17004,({"mutable":false}))];}else{if(($22747($17030$17032,"mutable")&&$17030$17032.mutable)){return ["splice"];}else{(other$17048=$17030$17032);(msg$17051="Variable was declared read-only. Declare with 'var' to make it mutable.");;throw $22785(["syntax","redeclaring"]).create(msg$17051,({"variable":v$17004}));}}}else{$22976($17006$17008);}}}}}()));}return acc$16973;}),accum$16963)),$16134(((accum$17058=({})),((accum$17058["success"]=function($17061$17063){$17061$17063;;return ["multi"];}),accum$17058)),((accum$17069=({})),((accum$17069["failure"]=function(target$17073){return match_error$16211(target$17073);}),accum$17069))))))),"build_object":$16134(({"strings_as_variables":true,"allow_nested":true,"allow_arguments":true,"special":disregard_specials$16222}),$16134(((accum$17076=({})),((accum$17076["assign"]=function($17079$17083,value$17084,$17081$17085){var t0$17092;var t0$17096;var bridge$17080$17089;var v$17087;(bridge$17080$17089=$17079$17083);if((((bridge$17080$17089 instanceof Array)&&((t0$17092=bridge$17080$17089.length),((t0$17092===2)&&((bridge$17080$17089[0]==="symbol")&&((v$17087=bridge$17080$17089[1]),true)))))||((bridge$17080$17089 instanceof Array)&&((t0$17096=bridge$17080$17089.length),((t0$17096===2)&&((bridge$17080$17089[0]==="value")&&((v$17087=bridge$17080$17089[1]),true))))))){;}else{$22976($17079$17083);}$17081$17085;;return ["do",__lt____lt____colon__$16186(["assign",["send",["symbol","accum"],["value",v$17087]],value$17084],v$17087)];}),accum$17076)),$16134(({"finalize":true}),$16134(((accum$17105=({})),((accum$17105["declare"]=function(scope$17109,vars$17110){return [["declare",["symbol","accum"],["data",["symbol","="]]]];}),accum$17105)),$16134(((accum$17113=({})),((accum$17113["success"]=function($17116$17118){$17116$17118;;return ["symbol","accum"];}),accum$17113)),((accum$17124=({})),((accum$17124["failure"]=function(target$17128){return match_error$16211(target$17128);}),accum$17124)))))))}));;(build_loop$16224=function(scope$17134,env$17135,form$17136,li$17137,clauses$17138,wrap$17139,pre$17140,post$17141,opt$17142){var t0$17162;var t0$17199;var accum$17242;var lbl$17145;var i$17146;var len$17147;var first_mac$17148;var last_mac$17149;var newscope$17150;var m$17151;(lbl$17145=function(){if(env$17135){return $22989(["value",scope$17134.gensym()],({"env":env$17135}));}else{return ["value",scope$17134.gensym()];}}());;(i$17146=$22989(["symbol","$index"],({"env":env$17135})));;(len$17147=$22989(["symbol","$length"],({"env":env$17135})));;(t0$17162=$23061(drop_ctx$16212)(function($17164$17166,scope$17167,form$17168,subp$17169){var x$17174;if((((x$17174=$17164$17166)),((x$17174 instanceof Array)&&(x$17174[0]==="pattern")))){;}else{$22976($17164$17166);}return ["test",["send",["symbol","==="],["data",i$17146,["value",0]]],subp$17169];}));if(t0$17162[0]){(first_mac$17148=t0$17162[1]);;}else{$22976(function($17182$17184,scope$17185,form$17186,subp$17187){var x$17192;if((((x$17192=$17182$17184)),((x$17192 instanceof Array)&&(x$17192[0]==="pattern")))){;}else{$22976($17182$17184);}return ["test",["send",["symbol","==="],["data",i$17146,["value",0]]],subp$17187];});}(t0$17199=$23061(drop_ctx$16212)(function($17201$17203,scope$17204,form$17205,subp$17206){var x$17211;if((((x$17211=$17201$17203)),((x$17211 instanceof Array)&&(x$17211[0]==="pattern")))){;}else{$22976($17201$17203);}return ["test",["send",["symbol","==="],["data",i$17146,["send",["symbol","-"],["data",len$17147,["value",1]]]]],subp$17206];}));if(t0$17199[0]){(last_mac$17149=t0$17199[1]);;}else{$22976(function($17219$17221,scope$17222,form$17223,subp$17224){var x$17229;if((((x$17229=$17219$17221)),((x$17229 instanceof Array)&&(x$17229[0]==="pattern")))){;}else{$22976($17219$17221);}return ["test",["send",["symbol","==="],["data",i$17146,["send",["symbol","-"],["data",len$17147,["value",1]]]]],subp$17224];});}(newscope$17150=Scope$16197(scope$17134));;env$17135.bind(newscope$17150,"first",["macro",first_mac$17148]);env$17135.bind(newscope$17150,"last",["macro",last_mac$17149]);(m$17151=__lt____lt____colon__$16186(["symbol","m"],form$17136));;return ["multi",pre$17140,["send",["symbol","let"],["data",["multi",["send",["symbol","="],["data",["symbol","temp"],li$17137]],["send",["symbol","="],["data",len$17147,["send",["symbol","temp"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]]],["send",["send",["symbol","for"],lbl$17145],["data",["multi",["send",["symbol","="],["data",["send",["symbol","let"],i$17146],["value",0]]],["send",["symbol","<"],["data",i$17146,len$17147]],["send",["symbol","++"],["data",i$17146,["void"]]]],["multi",["send",["symbol","="],["data",m$17151,["send",["symbol","___js_fetch"],["data",["symbol","temp"],i$17146]]]],parse_clauses$16194(newscope$17150,m$17151,clauses$17138,$22989(opt$17142,((accum$17242=({})),((accum$17242["wrap"]=function(x$17246){return wrap$17139(x$17246,i$17146);}),accum$17242))))]]]]],post$17141];});;(partial_pattern$16225=function(operator$17252){var x$17270;var $17258$17260;var op$17255;(op$17255=((($17258$17260=operator$17252)),function(){if((((x$17270=$17258$17260)),((x$17270 instanceof Array)&&(x$17270[0]==="symbol")))){return operator$17252;}else{if((typeof($17258$17260)==="string")){return ["variable",operator$17252];}else{$22976($17258$17260);}}}()));;return function(context$17283,scope$17284,form$17285,expr$17286){var x$17313;var m$17323;var other$17339;var val$17309;var $17289$17304;var $17290$17305;var $17291$17306;var t0$17298;var t1$17299;var t2$17300;var t3$17301;var t4$17302;var $17288$17293;($17288$17293=[context$17283,expr$17286]);;if((($17289$17304=($17288$17293 instanceof Array))&&((t0$17298=$17288$17293.length),(($17291$17306=(t0$17298===2))&&((((x$17313=$17288$17293[0])),((x$17313 instanceof Array)&&(x$17313[0]==="pattern")))&&((t1$17299=$17288$17293[1]),((t1$17299 instanceof Array)&&((t2$17300=t1$17299.length),((t2$17300===3)&&((t1$17299[0]==="data")&&((t3$17301=t1$17299[1]),((t3$17301 instanceof Array)&&((t4$17302=t3$17301.length),((t4$17302===1)&&(t3$17301[0]==="void"))))))))))))))){(val$17309=t1$17299[2]);(m$17323=mac1$16200(function(x$17327){return ["send",op$17255,["data",x$17327,val$17309]];}));;return ["check",m$17323,["ignore"]];}else{if(($17291$17306&&($17288$17293[0],((t1$17299=$17288$17293[1]),((t1$17299 instanceof Array)&&((t2$17300=t1$17299.length),((t2$17300===1)&&(t1$17299[0]==="void")))))))){return op$17255;}else{(other$17339=$17288$17293);return ["send",op$17255,expr$17286];}}};});;(make_assigner$16226=function(op$17345){return function(context$17349,scope$17350,form$17351,$17347$17352){var t0$17357;var t1$17358;var a$17354;var b$17355;(t0$17357=$17347$17352);if(((t0$17357 instanceof Array)&&((t1$17358=t0$17357.length),((t1$17358===3)&&(t0$17357[0]==="data"))))){(a$17354=t0$17357[1]);(b$17355=t0$17357[2]);;}else{$22976($17347$17352);}return ["assign",a$17354,["send",["symbol",op$17345],["data",a$17354,b$17355]]];};});;(temp$17366=$23089($16134(({"true":protected_value$16215("true",true),"false":protected_value$16215("false",false),"null":protected_value$16215("null",null),"undefined":protected_value$16215("undefined",(void 0)),"===":partial_pattern$16225("==="),"!==":partial_pattern$16225("!=="),"==":partial_pattern$16225(["symbol","___equal"]),"!=":partial_pattern$16225(["symbol","___nequal"]),"<=":partial_pattern$16225("<="),">=":partial_pattern$16225(">="),"<":partial_pattern$16225("<"),">":partial_pattern$16225(">")}),$16134(((accum$17370=({})),((accum$17370["-"]=function(context$17375,scope$17376,form$17377,$17373$17378){var t0$17386;var other$17421;var n$17406;var $17381$17402;var $17382$17403;var t0$17395;var t1$17396;var t2$17397;var t3$17398;var t4$17399;var t5$17400;var $17380$17390;var ph$17383;var expr$17384;(t0$17386=$17373$17378);(expr$17384=t0$17386);(ph$17383=t0$17386);;($17380$17390=ph$17383);;if((($17381$17402=($17380$17390 instanceof Array))&&((t0$17395=$17380$17390.length),((t0$17395===3)&&(($17380$17390[0]==="data")&&((t1$17396=$17380$17390[1]),((t1$17396 instanceof Array)&&((t2$17397=t1$17396.length),((t2$17397===1)&&((t1$17396[0]==="void")&&((t3$17398=$17380$17390[2]),((t3$17398 instanceof Array)&&((t4$17399=t3$17398.length),((t4$17399===2)&&((t3$17398[0]==="value")&&((t5$17400=t3$17398[1]),(typeof(t5$17400)==="number"))))))))))))))))){(n$17406=t5$17400);return ["value",(-n$17406)];}else{if(($17381$17402&&((t0$17395===1)&&($17380$17390[0]==="void")))){return ["variable","-"];}else{(other$17421=$17380$17390);return ["send",["variable","-"],expr$17384];}}}),accum$17370)),$16134(((accum$17424=({})),((accum$17424["++"]=function(context$17429,scope$17430,form$17431,$17427$17432){var other$17485;var x$17475;var y$17476;var x$17467;var x$17459;var $17435$17453;var $17436$17454;var $17437$17455;var $17438$17456;var t0$17449;var t1$17450;var t2$17451;var $17434$17444;var ph$17439;(ph$17439=$17427$17432);;($17434$17444=ph$17439);;if((($17435$17453=($17434$17444 instanceof Array))&&((t0$17449=$17434$17444.length),(($17437$17455=(t0$17449===3))&&(($17438$17456=($17434$17444[0]==="data"))&&((t1$17450=$17434$17444[1]),((t1$17450 instanceof Array)&&((t2$17451=t1$17450.length),((t2$17451===1)&&(t1$17450[0]==="void")))))))))){(x$17459=$17434$17444[2]);return ["send",["variable","++"],["data",["void"],x$17459]];}else{if(($17438$17456&&((x$17467=$17434$17444[1]),((t1$17450=$17434$17444[2]),((t1$17450 instanceof Array)&&((t2$17451=t1$17450.length),((t2$17451===1)&&(t1$17450[0]==="void")))))))){return ["send",["variable","++"],["data",x$17467,["void"]]];}else{if($17438$17456){(x$17475=$17434$17444[1]);(y$17476=$17434$17444[2]);return ["send",["send",x$17475,["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",y$17476]];}else{if(($17435$17453&&((t0$17449===1)&&($17434$17444[0]==="void")))){return ["send",["symbol","->"],["data",["data",["symbol","x"],["symbol","y"]],["send",["send",["symbol","x"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",["symbol","y"]]]]];}else{(other$17485=$17434$17444);return ["send",["symbol","___build_array"],["data",other$17485]];}}}}}),accum$17424)),$16134(((accum$17488=({})),((accum$17488[".."]=function(context$17493,scope$17494,form$17495,$17491$17496){var x$17539;var y$17540;var x$17531;var x$17523;var $17499$17517;var $17500$17518;var $17501$17519;var $17502$17520;var t0$17513;var t1$17514;var t2$17515;var $17498$17508;var ph$17503;(ph$17503=$17491$17496);;($17498$17508=ph$17503);;if((($17499$17517=($17498$17508 instanceof Array))&&((t0$17513=$17498$17508.length),(($17501$17519=(t0$17513===3))&&(($17502$17520=($17498$17508[0]==="data"))&&((t1$17514=$17498$17508[1]),((t1$17514 instanceof Array)&&((t2$17515=t1$17514.length),((t2$17515===1)&&(t1$17514[0]==="void")))))))))){(x$17523=$17498$17508[2]);return ["send",["symbol","range"],["data",["value",1],x$17523]];}else{if(($17502$17520&&((x$17531=$17498$17508[1]),((t1$17514=$17498$17508[2]),((t1$17514 instanceof Array)&&((t2$17515=t1$17514.length),((t2$17515===1)&&(t1$17514[0]==="void")))))))){return ["send",["symbol","range"],["data",x$17531]];}else{if($17502$17520){(x$17539=$17498$17508[1]);(y$17540=$17498$17508[2]);return ["send",["symbol","range"],["data",x$17539,y$17540]];}else{if(($17499$17517&&((t0$17513===1)&&($17498$17508[0]==="void")))){return ["symbol","range"];}else{$22976($17498$17508);}}}}}),accum$17488)),$16134(((accum$17550=({})),((accum$17550["//"]=function(context$17555,scope$17556,form$17557,$17553$17558){var t0$17563;var t1$17564;var a$17560;var b$17561;(t0$17563=$17553$17558);if(((t0$17563 instanceof Array)&&((t1$17564=t0$17563.length),((t1$17564===3)&&(t0$17563[0]==="data"))))){(a$17560=t0$17563[1]);(b$17561=t0$17563[2]);;}else{$22976($17553$17558);}return ["send",["send",["symbol","Math"],["send",["symbol","."],["data",["void"],["symbol","floor"]]]],["data",["send",["symbol","/"],["data",a$17560,b$17561]]]];}),accum$17550)),$16134(((accum$17570=({})),((accum$17570["*"]=function(context$17574,scope$17575,form$17576,expr$17577){var x$17605;var x$17618;var t0$17623;var other$17639;var val$17614;var $17581$17597;var $17582$17598;var $17583$17599;var t0$17590;var t1$17591;var t2$17592;var bridge$17580$17593;var t3$17594;var t4$17595;var $17579$17585;($17579$17585=[context$17574,expr$17577]);;if((($17581$17597=($17579$17585 instanceof Array))&&((t0$17590=$17579$17585.length),(($17583$17599=(t0$17590===2))&&((((x$17605=$17579$17585[0])),((x$17605 instanceof Array)&&(x$17605[0]==="pattern")))&&((t1$17591=$17579$17585[1]),((t1$17591 instanceof Array)&&((t2$17592=t1$17591.length),((t2$17592===1)&&(t1$17591[0]==="void")))))))))){return ["dynsplice",["ignore"]];}else{if(($17583$17599&&((bridge$17580$17593=$17579$17585[0]),(((((x$17618=bridge$17580$17593)),((x$17618 instanceof Array)&&(x$17618[0]==="pattern")))||((bridge$17580$17593 instanceof Array)&&((t0$17623=bridge$17580$17593.length),((t0$17623===2)&&((bridge$17580$17593[0]==="expr")&&(bridge$17580$17593[1]==="data"))))))&&((t1$17591=$17579$17585[1]),((t1$17591 instanceof Array)&&((t2$17592=t1$17591.length),((t2$17592===3)&&((t1$17591[0]==="data")&&((t3$17594=t1$17591[1]),((t3$17594 instanceof Array)&&((t4$17595=t3$17594.length),((t4$17595===1)&&(t3$17594[0]==="void")))))))))))))){(val$17614=t1$17591[2]);return ["dynsplice",val$17614];}else{if(($17583$17599&&($17579$17585[0],((t1$17591=$17579$17585[1]),((t1$17591 instanceof Array)&&((t2$17592=t1$17591.length),((t2$17592===1)&&(t1$17591[0]==="void")))))))){return ["variable","*"];}else{(other$17639=$17579$17585);return ["send",["variable","*"],expr$17577];}}}}),accum$17570)),$16134(((accum$17642=({})),((accum$17642["**"]=function(context$17646,scope$17647,form$17648,expr$17649){var x$17685;var x$17698;var t0$17703;var a$17719;var b$17720;var val$17694;var $17653$17673;var $17654$17674;var $17655$17675;var $17656$17676;var $17657$17677;var $17658$17678;var $17659$17679;var t0$17666;var t1$17667;var t2$17668;var bridge$17652$17669;var t3$17670;var t4$17671;var $17651$17661;($17651$17661=[context$17646,expr$17649]);;if((($17653$17673=($17651$17661 instanceof Array))&&((t0$17666=$17651$17661.length),(($17655$17675=(t0$17666===2))&&((((x$17685=$17651$17661[0])),((x$17685 instanceof Array)&&(x$17685[0]==="pattern")))&&((t1$17667=$17651$17661[1]),((t1$17667 instanceof Array)&&((t2$17668=t1$17667.length),((t2$17668===1)&&(t1$17667[0]==="void")))))))))){return ["objsplice",["ignore"]];}else{if(($17655$17675&&((bridge$17652$17669=$17651$17661[0]),(((((x$17698=bridge$17652$17669)),((x$17698 instanceof Array)&&(x$17698[0]==="pattern")))||((bridge$17652$17669 instanceof Array)&&((t0$17703=bridge$17652$17669.length),((t0$17703===2)&&((bridge$17652$17669[0]==="expr")&&(bridge$17652$17669[1]==="data"))))))&&((t1$17667=$17651$17661[1]),((t1$17667 instanceof Array)&&((t2$17668=t1$17667.length),((t2$17668===3)&&((t1$17667[0]==="data")&&((t3$17670=t1$17667[1]),((t3$17670 instanceof Array)&&((t4$17671=t3$17670.length),((t4$17671===1)&&(t3$17670[0]==="void")))))))))))))){(val$17694=t1$17667[2]);return ["objsplice",val$17694];}else{if(($17655$17675&&($17651$17661[0],((t1$17667=$17651$17661[1]),(($17658$17678=(t1$17667 instanceof Array))&&((t2$17668=t1$17667.length),((t2$17668===1)&&(t1$17667[0]==="void")))))))){return ["send",["symbol","Math"],["send",["symbol","."],["data",["void"],["symbol","pow"]]]];}else{if(($17658$17678&&((t2$17668===3)&&(t1$17667[0]==="data")))){(a$17719=t1$17667[1]);(b$17720=t1$17667[2]);return ["send",["send",["symbol","Math"],["send",["symbol","."],["data",["void"],["symbol","pow"]]]],["data",a$17719,b$17720]];}else{$22976($17651$17661);}}}}}),accum$17642)),$16134(((accum$17726=({})),((accum$17726["_"]=function($17729$17732,scope$17733,form$17734,$17730$17735){var x$17740;var t0$17747;var t1$17748;if((((x$17740=$17729$17732)),((x$17740 instanceof Array)&&(x$17740[0]==="pattern")))){;}else{$22976($17729$17732);}(t0$17747=$17730$17735);if(((t0$17747 instanceof Array)&&((t1$17748=t0$17747.length),((t1$17748===1)&&(t0$17747[0]==="void"))))){;}else{$22976($17730$17735);}return ["ignore"];}),accum$17726)),$16134(((accum$17754=({})),((accum$17754["not"]=function($17757$17760,scope$17761,form$17762,$17758$17763){var t0$17773;var t1$17774;var t2$17775;var t3$17776;var x$17794;var other$17801;var $17765$17784;var ph$17766;var rhs$17767;var arg$17768;(ph$17766=$17757$17760);;(t0$17773=$17758$17763);if(((t0$17773 instanceof Array)&&((t1$17774=t0$17773.length),((t1$17774===3)&&((t0$17773[0]==="data")&&((t2$17775=t0$17773[1]),((t2$17775 instanceof Array)&&((t3$17776=t2$17775.length),((t3$17776===1)&&(t2$17775[0]==="void")))))))))){(rhs$17767=t0$17773[2]);(arg$17768=t0$17773);;}else{$22976($17758$17763);}($17765$17784=ph$17766);;if((((x$17794=$17765$17784)),((x$17794 instanceof Array)&&(x$17794[0]==="pattern")))){return ["neg",rhs$17767];}else{(other$17801=$17765$17784);return ["send",["variable","not"],arg$17768];}}),accum$17754)),$16134(((accum$17804=({})),((accum$17804["and"]=function($17807$17810,scope$17811,form$17812,$17808$17813){var t0$17824;var t1$17825;var x$17841;var other$17848;var $17815$17831;var ph$17816;var lhs$17817;var rhs$17818;var arg$17819;(ph$17816=$17807$17810);;(t0$17824=$17808$17813);if(((t0$17824 instanceof Array)&&((t1$17825=t0$17824.length),((t1$17825===3)&&(t0$17824[0]==="data"))))){(lhs$17817=t0$17824[1]);(rhs$17818=t0$17824[2]);(arg$17819=t0$17824);;}else{$22976($17808$17813);}($17815$17831=ph$17816);;if((((x$17841=$17815$17831)),((x$17841 instanceof Array)&&(x$17841[0]==="pattern")))){return ["all",lhs$17817,rhs$17818];}else{(other$17848=$17815$17831);return ["send",["variable","and"],arg$17819];}}),accum$17804)),$16134(((accum$17851=({})),((accum$17851["or"]=function($17854$17857,scope$17858,form$17859,$17855$17860){var t0$17871;var t1$17872;var x$17888;var other$17895;var $17862$17878;var ph$17863;var lhs$17864;var rhs$17865;var arg$17866;(ph$17863=$17854$17857);;(t0$17871=$17855$17860);if(((t0$17871 instanceof Array)&&((t1$17872=t0$17871.length),((t1$17872===3)&&(t0$17871[0]==="data"))))){(lhs$17864=t0$17871[1]);(rhs$17865=t0$17871[2]);(arg$17866=t0$17871);;}else{$22976($17855$17860);}($17862$17878=ph$17863);;if((((x$17888=$17862$17878)),((x$17888 instanceof Array)&&(x$17888[0]==="pattern")))){return ["any",lhs$17864,rhs$17865];}else{(other$17895=$17862$17878);return ["send",["variable","or"],arg$17866];}}),accum$17851)),$16134(((accum$17898=({})),((accum$17898["when"]=function(context$17903,scope$17904,form$17905,$17901$17906){var t0$17912;var t1$17913;var other$17933;var t0$17924;var $17908$17919;var ph$17909;var condition$17910;(t0$17912=$17901$17906);if(((t0$17912 instanceof Array)&&((t1$17913=t0$17912.length),((t1$17913===3)&&(t0$17912[0]==="data"))))){(ph$17909=t0$17912[1]);(condition$17910=t0$17912[2]);;}else{$22976($17901$17906);}($17908$17919=ph$17909);;if((($17908$17919 instanceof Array)&&((t0$17924=$17908$17919.length),((t0$17924===1)&&($17908$17919[0]==="void"))))){return ["test",condition$17910,["ignore"]];}else{(other$17933=$17908$17919);return ["test",condition$17910,other$17933];}}),accum$17898)),$16134(((accum$17936=({})),((accum$17936["."]=function(context$17941,scope$17942,form$17943,$17939$17944){var t0$17948;var t1$17949;var t2$17950;var t3$17951;var f$17959;var expr$17946;(t0$17948=$17939$17944);if(((t0$17948 instanceof Array)&&((t1$17949=t0$17948.length),((t1$17949===3)&&((t0$17948[0]==="data")&&((t2$17950=t0$17948[1]),((t2$17950 instanceof Array)&&((t3$17951=t2$17950.length),((t3$17951===1)&&(t2$17950[0]==="void")))))))))){(expr$17946=t0$17948[2]);;}else{$22976($17939$17944);}(f$17959=function($17962$17964){var t0$17986;var t0$17990;var $index$18018;var $length$18013;var temp$18008;var acc$18003;var other$18038;var args$17996;var x$17983;var bridge$17967$17978;var t0$17979;var $17966$17973;var ph$17968;(ph$17968=$17962$17964);;($17966$17973=ph$17968);;(bridge$17967$17978=$17966$17973);if((((bridge$17967$17978 instanceof Array)&&((t0$17986=bridge$17967$17978.length),((t0$17986===2)&&((bridge$17967$17978[0]==="symbol")&&((x$17983=bridge$17967$17978[1]),true)))))||((bridge$17967$17978 instanceof Array)&&((t0$17990=bridge$17967$17978.length),((t0$17990===2)&&((bridge$17967$17978[0]==="value")&&((x$17983=bridge$17967$17978[1]),true))))))){return ["value",x$17983];}else{if((($17966$17973 instanceof Array)&&((t0$17979=$17966$17973.length),((t0$17979>=1)&&($17966$17973[0]==="data"))))){(args$17996=Array.prototype.slice.call($17966$17973,1));return ["data"].concat((((acc$18003=[])),(((temp$18008=args$17996)),((($length$18013=temp$18008.length)),((($index$18018=0)),function(){$18000:for(;($index$18018<$length$18013);($index$18018++)){var arg$18034;var m$18026;(m$18026=temp$18008[$index$18018]);;(arg$18034=m$18026);acc$18003.push(f$17959(arg$18034));}}()))),acc$18003));}else{(other$18038=$17966$17973);throw $22785(["syntax","dot"]).create("Argument to '.' must be a symbol or an array",({"argument":other$18038}));}}});;return f$17959(expr$17946);}),accum$17936)),$16134(((accum$18042=({})),((accum$18042["="]=function(context$18046,scope$18047,form$18048,expr$18049){var t0$18077;var t1$18078;var lhs$18074;var rhs$18075;var lhs$18121;var rhs$18122;var s$18113;var rhs$18114;var $18088$18102;var $18089$18103;var $18090$18104;var $18091$18105;var t0$18098;var t1$18099;var t2$18100;var $18087$18093;var x$18131;var t0$18140;var t1$18141;var lhs$18137;var rhs$18138;var $18052$18064;var $18053$18065;var $18054$18066;var $18055$18067;var t0$18062;var $18051$18057;($18051$18057=context$18046);;if((($18052$18064=($18051$18057 instanceof Array))&&((t0$18062=$18051$18057.length),(($18054$18066=(t0$18062===2))&&(($18055$18067=($18051$18057[0]==="expr"))&&($18051$18057[1]==="multi")))))){(t0$18077=expr$18049);if(((t0$18077 instanceof Array)&&((t1$18078=t0$18077.length),((t1$18078===3)&&(t0$18077[0]==="data"))))){(lhs$18074=t0$18077[1]);(rhs$18075=t0$18077[2]);;}else{$22976(expr$18049,"/home/olivier/git/earl-grey/src/stdenv.eg",11197,11201);}return parse_pattern$16193(scope$18047,lhs$18074,__lt____lt____colon__$16186(["use",scope$18047,rhs$18075],rhs$18075),pattern_handlers$16223.declare_variables);}else{if(($18055$18067&&($18051$18057[1]==="data"))){($18087$18093=expr$18049);;if((($18088$18102=($18087$18093 instanceof Array))&&((t0$18098=$18087$18093.length),((t0$18098===1)&&($18087$18093[0]==="void"))))){return ["assoc"];}else{if(($18088$18102&&(($18090$18104=(t0$18098===3))&&(($18091$18105=($18087$18093[0]==="data"))&&((t1$18099=$18087$18093[1]),((t1$18099 instanceof Array)&&((t2$18100=t1$18099.length),((t2$18100===2)&&(t1$18099[0]==="symbol"))))))))){(s$18113=t1$18099[1]);(rhs$18114=$18087$18093[2]);return ["assoc",["value",s$18113],rhs$18114];}else{if($18091$18105){(lhs$18121=$18087$18093[1]);(rhs$18122=$18087$18093[2]);return ["objsplice",["multi",parse_pattern$16193(scope$18047,lhs$18121,__lt____lt____colon__$16186(["use",scope$18047,rhs$18122],rhs$18122),pattern_handlers$16223.build_object)]];}else{$22976($18087$18093);}}}}else{if((((x$18131=$18051$18057)),((x$18131 instanceof Array)&&(x$18131[0]==="pattern")))){(t0$18140=expr$18049);if(((t0$18140 instanceof Array)&&((t1$18141=t0$18140.length),((t1$18141===3)&&(t0$18140[0]==="data"))))){(lhs$18137=t0$18140[1]);(rhs$18138=t0$18140[2]);;}else{$22976(expr$18049,"/home/olivier/git/earl-grey/src/stdenv.eg",11834,11838);}return ["default",lhs$18137,rhs$18138];}else{$22976($18051$18057);}}}}),accum$18042)),$16134(((accum$18149=({})),((accum$18149["=>"]=function($18152$18156,scope$18157,$18153$18158,$18154$18159){var t0$18170;var t0$18175;var t1$18176;var x$18192;var x$18222;var t0$18228;var t0$18232;var t0$18243;var t0$18247;var k$18238;var rhs$18239;var k$18218;var $18200$18213;var $18201$18214;var $18202$18215;var t0$18209;var bridge$18198$18210;var bridge$18199$18211;var $18197$18204;var x$18257;var t0$18265;var t1$18266;var t2$18267;var stmts$18263;var other$18275;var $18161$18182;var ph$18162;var env$18163;var lhs$18164;var rhs$18165;(ph$18162=$18152$18156);;(t0$18170=$18153$18158);if($22747(t0$18170,"env")){(env$18163=t0$18170.env);;}else{$22976($18153$18158);}(t0$18175=$18154$18159);if(((t0$18175 instanceof Array)&&((t1$18176=t0$18175.length),((t1$18176===3)&&(t0$18175[0]==="data"))))){(lhs$18164=t0$18175[1]);(rhs$18165=t0$18175[2]);;}else{$22976($18154$18159);}($18161$18182=ph$18162);;if((((x$18192=$18161$18182)),((x$18192 instanceof Array)&&(x$18192[0]==="pattern")))){($18197$18204=[lhs$18164,rhs$18165]);;if((($18200$18213=($18197$18204 instanceof Array))&&((t0$18209=$18197$18204.length),(($18202$18215=(t0$18209===2))&&((((x$18222=$18197$18204[0])),((x$18222 instanceof Array)&&(x$18222[0]==="void")))&&((bridge$18198$18210=$18197$18204[1]),(((bridge$18198$18210 instanceof Array)&&((t0$18228=bridge$18198$18210.length),((t0$18228===2)&&((bridge$18198$18210[0]==="symbol")&&((k$18218=bridge$18198$18210[1]),true)))))||((bridge$18198$18210 instanceof Array)&&((t0$18232=bridge$18198$18210.length),((t0$18232===2)&&((bridge$18198$18210[0]==="value")&&((k$18218=bridge$18198$18210[1]),true)))))))))))){return ["assoc",["value",k$18218],$22989(__lt____lt____colon__$16186(["symbol",k$18218],rhs$18165),({"env":env$18163}))];}else{if(($18202$18215&&((bridge$18199$18211=$18197$18204[0]),(((bridge$18199$18211 instanceof Array)&&((t0$18243=bridge$18199$18211.length),((t0$18243===2)&&((bridge$18199$18211[0]==="symbol")&&((k$18238=bridge$18199$18211[1]),true)))))||((bridge$18199$18211 instanceof Array)&&((t0$18247=bridge$18199$18211.length),((t0$18247===2)&&((bridge$18199$18211[0]==="value")&&((k$18238=bridge$18199$18211[1]),true))))))))){(rhs$18239=$18197$18204[1]);return ["assoc",["value",k$18238],rhs$18239];}else{$22976($18197$18204);}}}else{if((((x$18257=$18161$18182)),((x$18257 instanceof Array)&&(x$18257[0]==="test")))){(t0$18265=$23061(["multi"])(rhs$18165));if((t0$18265[0]&&((t1$18266=t0$18265[1]),((t2$18267=t1$18266.length),(t2$18267>=0))))){(stmts$18263=Array.prototype.slice.call(t1$18266,0));;}else{$22976(rhs$18165,"/home/olivier/git/earl-grey/src/stdenv.eg",12321,12324);}return ["blocktest",lhs$18164,stmts$18263];}else{(other$18275=$18161$18182);return ["assoc",lhs$18164,rhs$18165];}}}),accum$18149)),$16134(((accum$18278=({})),((accum$18278[":="]=function(context$18283,scope$18284,form$18285,$18281$18286){var t0$18291;var t1$18292;var lhs$18288;var rhs$18289;(t0$18291=$18281$18286);if(((t0$18291 instanceof Array)&&((t1$18292=t0$18291.length),((t1$18292===3)&&(t0$18291[0]==="data"))))){(lhs$18288=t0$18291[1]);(rhs$18289=t0$18291[2]);;}else{$22976($18281$18286);}return ["assign",lhs$18288,rhs$18289];}),accum$18278)),$16134(({"+=":make_assigner$16226("+"),"-=":make_assigner$16226("-"),"*=":make_assigner$16226("*"),"/=":make_assigner$16226("/"),"<<=":make_assigner$16226("<<"),">>=":make_assigner$16226(">>"),">>>=":make_assigner$16226(">>>"),"++=":make_assigner$16226("++"),"?=":make_assigner$16226("match"),"or=":make_assigner$16226("or"),"and=":make_assigner$16226("and"),"each=":make_assigner$16226("each")}),$16134(((accum$18298=({})),((accum$18298["->"]=function($18301$18303,scope$18304,form$18305,expr$18306){var x$18324;var t0$18333;var t1$18334;var lhs$18330;var rhs$18331;var $index$18438;var $length$18433;var temp$18428;var acc$18423;var decls$18412;var newargs$18413;var body$18529;var a$18524;var other$18521;var fw$18402;var t0$18394;var t1$18395;var t2$18396;var t3$18397;var t4$18398;var $18383$18389;var pp$18384;var other$18541;var args$18535;var rhs$18536;var args$18374;var arg$18375;var rhs$18376;var $18344$18363;var $18345$18364;var $18346$18365;var $18347$18366;var $18348$18367;var $18349$18368;var $18350$18369;var $18351$18370;var $18352$18371;var t0$18359;var t1$18360;var t2$18361;var $18343$18354;var other$18341;var $18308$18314;var ph$18309;(ph$18309=$18301$18303);;($18308$18314=ph$18309);;if((((x$18324=$18308$18314)),((x$18324 instanceof Array)&&(x$18324[0]==="clause")))){(t0$18333=expr$18306);if(((t0$18333 instanceof Array)&&((t1$18334=t0$18333.length),((t1$18334===3)&&(t0$18333[0]==="data"))))){(lhs$18330=t0$18333[1]);(rhs$18331=t0$18333[2]);;}else{$22976(expr$18306,"/home/olivier/git/earl-grey/src/stdenv.eg",12941,12945);}return ["clause",lhs$18330,rhs$18331];}else{(other$18341=$18308$18314);($18343$18354=expr$18306);;if((($18344$18363=($18343$18354 instanceof Array))&&((t0$18359=$18343$18354.length),(($18346$18365=(t0$18359===3))&&(($18347$18366=($18343$18354[0]==="data"))&&((t1$18360=$18343$18354[1]),(($18349$18368=(t1$18360 instanceof Array))&&((t2$18361=t1$18360.length),(($18351$18370=(t2$18361>=1))&&($18352$18371=(t1$18360[0]==="data"))))))))))){(args$18374=Array.prototype.slice.call(t1$18360,1));(arg$18375=t1$18360);(rhs$18376=$18343$18354[2]);(pp$18384=PatternParser$16191(scope$18304,arg$18375,({"indexable":true,"allow_nested":true})));;($18383$18389=pp$18384.pattern);;if((($18383$18389 instanceof Array)&&((t0$18394=$18383$18389.length),((t0$18394===5)&&(($18383$18389[0]==="array_pattern")&&((fw$18402=$18383$18389[1]),((t1$18395=$18383$18389[2]),((t1$18395 instanceof Array)&&((t2$18396=t1$18395.length),((t2$18396===0)&&((t3$18397=$18383$18389[3]),((t3$18397 instanceof Array)&&((t4$18398=t3$18397.length),((t4$18398===0)&&($18383$18389[4]===(void 0)))))))))))))))){(decls$18412=function(){if(pp$18384.specials.match){return [["declare",["symbol","ph"]]];}else{return [];}}());;(newargs$18413=(((acc$18423=[])),(((temp$18428=$23104(fw$18402,args$18374))),((($length$18433=temp$18428.length)),((($index$18438=0)),function(){$18419:for(;($index$18438<$length$18433);($index$18438++)){var newv$18482;var other$18479;var expr$18469;var v$18470;var t0$18462;var t1$18463;var t2$18464;var t3$18465;var arg$18456;var $18421$18457;var t0$18451;var t1$18452;var m$18446;(m$18446=temp$18428[$index$18438]);;(t0$18451=m$18446);if(((t0$18451 instanceof Array)&&((t1$18452=t0$18451.length),(t1$18452===2)))){($18421$18457=t0$18451[0]);(arg$18456=t0$18451[1]);(t0$18462=$18421$18457);if(((t0$18462 instanceof Array)&&((t1$18463=t0$18462.length),((t1$18463===2)&&((t0$18462[0]==="assign")&&((t2$18464=t0$18462[1]),((expr$18469=t2$18464),((t2$18464 instanceof Array)&&((t3$18465=t2$18464.length),((t3$18465===2)&&(t2$18464[0]==="symbol"))))))))))){(v$18470=t2$18464[1]);acc$18423.push(expr$18469);}else{(other$18479=$18421$18457);acc$18423.push((((newv$18482=$22989(["symbol",scope$18304.gensym("temp")],({"env":stdenv$16204})))),decls$18412.push(parse_pattern$16193(scope$18304,arg$18456,newv$18482,$22989(pattern_handlers$16223.declare_variables,({"tags":({"declare_mode":"let"}),"special":function($18486$18488,value$18489){var t0$18495;var t1$18496;var other$18514;var $18491$18502;var ph$18492;var expr$18493;(t0$18495=$18486$18488);if(((t0$18495 instanceof Array)&&((t1$18496=t0$18495.length),((t1$18496===2)&&(t0$18495[0]==="special"))))){(ph$18492=t0$18495[1]);(expr$18493=t0$18495);;}else{$22976($18486$18488);}($18491$18502=ph$18492);;if(($18491$18502==="match")){return ["assign",["symbol","ph"]];}else{(other$18514=$18491$18502);throw $22785(["syntax","pattern","special"]).create("Special token cannot be used here",({"special":expr$18493}));}}})))),newv$18482));}}else{$22976(m$18446,"/home/olivier/git/earl-grey/src/stdenv.eg",13417,14444);;}}}()))),acc$18423));;return ["lambda",newargs$18413,["multi"].concat(decls$18412).concat([function(){if(pp$18384.specials.match){return ["send",["symbol","match"],["data",["symbol","ph"],rhs$18376]];}else{return rhs$18376;}}()])];}else{(other$18521=$18383$18389);(a$18524=__lt____lt____colon__$16186(["symbol","arguments"],arg$18375));;(body$18529=["send",["send",["symbol","match"],["send",["symbol","."],["data",["void"],["symbol","indexable"]]]],["data",a$18524,["send",["symbol","->"],["data",arg$18375,rhs$18376]]]]);;return ["lambda",[],body$18529];}}else{if($18352$18371){(args$18535=Array.prototype.slice.call(t1$18360,1));(rhs$18536=$18343$18354[2]);return ["lambda",args$18535,rhs$18536];}else{(other$18541=$18343$18354);throw $22785(["syntax","lambda"]).create("Bad lambda syntax",({"node":other$18541}));}}}}),accum$18298)),$16134(({"match":accum_flags$16220(function($18543$18545,scope$18546,form$18547,expr$18548,flags$18549){var x$18567;var other$18588;var t0$18579;var $18572$18574;var v$18636;var b$18637;var b$18627;var $18610$18623;var $18611$18624;var t0$18618;var t1$18619;var t2$18620;var t3$18621;var $18609$18613;var v$18676;var b$18677;var b$18667;var $18650$18663;var $18651$18664;var t0$18658;var t1$18659;var t2$18660;var t3$18661;var $18649$18653;var t0$18606;var t1$18607;var accum$18691;var mbody$18687;var opt$18595;var to_match$18596;var value$18597;var body$18598;var other$18592;var $18551$18557;var ph$18552;(ph$18552=$18543$18545);;($18551$18557=ph$18552);;if((((x$18567=$18551$18557)),((x$18567 instanceof Array)&&(x$18567[0]==="pattern")))){($18572$18574=expr$18548);;if((($18572$18574 instanceof Array)&&((t0$18579=$18572$18574.length),((t0$18579===1)&&($18572$18574[0]==="void"))))){return ["special","match"];}else{(other$18588=$18572$18574);return ["all",__lt____lt____colon__$16186(other$18588,expr$18548),__lt____lt____colon__$16186(["special","match"],form$18547)];}}else{(other$18592=$18551$18557);(opt$18595=util$16187.mkset(flags$18549));;(to_match$18596=$22989(["symbol",scope$18546.gensym("m")],({"single_assignment":true})));;(t0$18606=((($18609$18613=expr$18548)),function(){if((($18610$18623=($18609$18613 instanceof Array))&&((t0$18618=$18609$18613.length),((t0$18618===2)&&(($18609$18613[0]==="data")&&((t1$18619=$23061(["multi"])($18609$18613[1])),(t1$18619[0]&&((t2$18620=t1$18619[1]),((t3$18621=t2$18620.length),(t3$18621>=0)))))))))){(b$18627=Array.prototype.slice.call(t2$18620,0));return [["value",null],b$18627];}else{if(($18610$18623&&((t0$18618===3)&&(($18609$18613[0]==="data")&&((v$18636=$18609$18613[1]),((t1$18619=$23061(["multi"])($18609$18613[2])),(t1$18619[0]&&((t2$18620=t1$18619[1]),((t3$18621=t2$18620.length),(t3$18621>=0)))))))))){(b$18637=Array.prototype.slice.call(t2$18620,0));return [v$18636,b$18637];}else{$22976($18609$18613);}}}()));if(((t0$18606 instanceof Array)&&((t1$18607=t0$18606.length),(t1$18607===2)))){(value$18597=t0$18606[0]);(body$18598=t0$18606[1]);;}else{$22976(((($18649$18653=expr$18548)),function(){if((($18650$18663=($18649$18653 instanceof Array))&&((t0$18658=$18649$18653.length),((t0$18658===2)&&(($18649$18653[0]==="data")&&((t1$18659=$23061(["multi"])($18649$18653[1])),(t1$18659[0]&&((t2$18660=t1$18659[1]),((t3$18661=t2$18660.length),(t3$18661>=0)))))))))){(b$18667=Array.prototype.slice.call(t2$18660,0));return [["value",null],b$18667];}else{if(($18650$18663&&((t0$18658===3)&&(($18649$18653[0]==="data")&&((v$18676=$18649$18653[1]),((t1$18659=$23061(["multi"])($18649$18653[2])),(t1$18659[0]&&((t2$18660=t1$18659[1]),((t3$18661=t2$18660.length),(t3$18661>=0)))))))))){(b$18677=Array.prototype.slice.call(t2$18660,0));return [v$18676,b$18677];}else{$22976($18649$18653);}}}()),"/home/olivier/git/earl-grey/src/stdenv.eg",15379,15498);}(mbody$18687=parse_clauses$16194(scope$18546,to_match$18596,body$18598,$22989(opt$18595,$16134(((accum$18691=({})),((accum$18691["fallback"]=function(target$18695){return match_error$16211(target$18695);}),accum$18691)),({"wrap":function(x$18698){return x$18698;}})))));;return ["send",["symbol","let"],["data",["send",["symbol","="],["data",to_match$18596,value$18597]],mbody$18687]];}})}),$16134(((accum$18702=({})),((accum$18702["each"]=function($18705$18709,scope$18710,$18706$18711,$18707$18712){var t0$18728;var t0$18733;var t1$18734;var t2$18735;var t3$18736;var t4$18737;var x$18813;var other$18832;var ends_with_test$18759;var _build_loop$18760;var $18715$18754;var $18716$18755;var $18717$18756;var $18718$18757;var t0$18752;var $18714$18747;var ph$18719;var form$18720;var env$18721;var li$18722;var clauses$18723;(ph$18719=$18705$18709);;(t0$18728=$18706$18711);(form$18720=t0$18728);if($22747(t0$18728,"env")){(env$18721=t0$18728.env);;}else{$22976($18706$18711);}(t0$18733=$18707$18712);if(((t0$18733 instanceof Array)&&((t1$18734=t0$18733.length),((t1$18734===3)&&((t0$18733[0]==="data")&&((li$18722=t0$18733[1]),((t2$18735=$23061(["multi"])(t0$18733[2])),(t2$18735[0]&&((t3$18736=t2$18735[1]),((t4$18737=t3$18736.length),(t4$18737>=0))))))))))){(clauses$18723=Array.prototype.slice.call(t3$18736,0));;}else{$22976($18707$18712);}($18714$18747=ph$18719);;(ends_with_test$18759=false);;(_build_loop$18760=function(wrap$18767,pre$18768,post$18769){var accum$18772;var accum$18802;return build_loop$16224(scope$18710,env$18721,form$18720,li$18722,clauses$18723,wrap$18767,pre$18768,post$18769,$16134(((accum$18772=({})),((accum$18772["wrap_pattern"]=function(x$18776,toplevel$18777){var x$18792;var other$18799;var $18780$18782;(ends_with_test$18759=((($18780$18782=x$18776)),function(){if((((x$18792=$18780$18782)),((x$18792 instanceof Array)&&(x$18792[0]==="test")))){return toplevel$18777;}else{(other$18799=$18780$18782);return false;}}()));return x$18776;}),accum$18772)),((accum$18802=({})),((accum$18802["fallback"]=function(target$18806){if(ends_with_test$18759){return ["symbol","false"];}else{return match_error$16211(target$18806);}}),accum$18802))));});;if((((x$18813=$18714$18747)),((x$18813 instanceof Array)&&(x$18813[0]==="test")))){return $22989(["test_factory",li$18722,clauses$18723],({"env":env$18721}));}else{if((($18715$18754=($18714$18747 instanceof Array))&&((t0$18752=$18714$18747.length),(($18717$18756=(t0$18752===2))&&(($18718$18757=($18714$18747[0]==="expr"))&&($18714$18747[1]==="multi")))))){return ["nostep",form$18720];}else{if(($18718$18757&&($18714$18747[1]==="ignore"))){return _build_loop$18760(function(x$18828){return x$18828;},["splice"],["splice"]);}else{(other$18832=$18714$18747);return _build_loop$18760(function(x$18835){return ["send",["send",["symbol","acc"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",x$18835]];},["send",["symbol","="],["data",["symbol","acc"],["data"]]],["symbol","acc"]);}}}}),accum$18702)),$16134(((accum$18838=({})),((accum$18838["each?"]=function($18841$18845,scope$18846,$18842$18847,$18843$18848){var t0$18864;var t0$18869;var t1$18870;var t2$18871;var t3$18872;var t4$18873;var x$18898;var other$18920;var $18851$18890;var $18852$18891;var $18853$18892;var $18854$18893;var t0$18888;var $18850$18883;var ph$18855;var form$18856;var env$18857;var li$18858;var clauses$18859;(ph$18855=$18841$18845);;(t0$18864=$18842$18847);(form$18856=t0$18864);if($22747(t0$18864,"env")){(env$18857=t0$18864.env);;}else{$22976($18842$18847);}(t0$18869=$18843$18848);if(((t0$18869 instanceof Array)&&((t1$18870=t0$18869.length),((t1$18870===3)&&((t0$18869[0]==="data")&&((li$18858=t0$18869[1]),((t2$18871=$23061(["multi"])(t0$18869[2])),(t2$18871[0]&&((t3$18872=t2$18871[1]),((t4$18873=t3$18872.length),(t4$18873>=0))))))))))){(clauses$18859=Array.prototype.slice.call(t3$18872,0));;}else{$22976($18843$18848);}($18850$18883=ph$18855);;if((((x$18898=$18850$18883)),((x$18898 instanceof Array)&&(x$18898[0]==="test")))){return $22989(["test_factory",li$18858,clauses$18859],({"env":env$18857}));}else{if((($18851$18890=($18850$18883 instanceof Array))&&((t0$18888=$18850$18883.length),(($18853$18892=(t0$18888===2))&&(($18854$18893=($18850$18883[0]==="expr"))&&($18850$18883[1]==="multi")))))){return ["nostep",form$18856];}else{if(($18854$18893&&($18850$18883[1]==="ignore"))){return build_loop$16224(scope$18846,env$18857,form$18856,li$18858,clauses$18859,function(x$18913){return x$18913;},["splice"],["splice"],({"fallback":function(target$18916){return ["symbol","false"];}}));}else{(other$18920=$18850$18883);return build_loop$16224(scope$18846,env$18857,form$18856,li$18858,clauses$18859,function(x$18923){return ["send",["send",["symbol","acc"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",x$18923]];},["send",["symbol","="],["data",["symbol","acc"],["data"]]],["symbol","acc"],({"fallback":function(target$18926){return ["symbol","false"];}}));}}}}),accum$18838)),$16134(((accum$18929=({})),((accum$18929["!!"]=function($18932$18935,scope$18936,form$18937,$18933$18938){var t0$18952;var t1$18953;var t2$18954;var t3$18955;var t4$18956;var other$18992;var $18941$18973;var $18942$18974;var $18943$18975;var $18944$18976;var t0$18971;var $18940$18966;var ph$18945;var expr$18946;var clauses$18947;(ph$18945=$18932$18935);;(t0$18952=$18933$18938);if(((t0$18952 instanceof Array)&&((t1$18953=t0$18952.length),((t1$18953===3)&&((t0$18952[0]==="data")&&((expr$18946=t0$18952[1]),((t2$18954=$23061(["multi"])(t0$18952[2])),(t2$18954[0]&&((t3$18955=t2$18954[1]),((t4$18956=t3$18955.length),(t4$18956>=0))))))))))){(clauses$18947=Array.prototype.slice.call(t3$18955,0));;}else{$22976($18933$18938);}($18940$18966=ph$18945);;if((($18941$18973=($18940$18966 instanceof Array))&&((t0$18971=$18940$18966.length),(($18943$18975=(t0$18971===2))&&(($18944$18976=($18940$18966[0]==="expr"))&&($18940$18966[1]==="multi")))))){return ["nostep",form$18937];}else{if(($18944$18976&&($18940$18966[1]==="ignore"))){clauses$18947.push(mkstdenv$16205().convert(["send",["symbol","->"],["data",["symbol","e"],["send",["symbol","throw"],["symbol","e"]]]]));return ["js_try",expr$18946,["send",["symbol","->"],["data",["data",["symbol","excv"]],parse_clauses$16194(scope$18936,["symbol","excv"],clauses$18947,({"wrap":function(x$18988){return x$18988;}}))]],["void"]];}else{(other$18992=$18940$18966);clauses$18947.push(mkstdenv$16205().convert(["send",["symbol","->"],["data",["symbol","e"],["send",["symbol","throw"],["symbol","e"]]]]));return ["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","rval"],["symbol","false"]]],["multi",["js_try",["send",["symbol",":="],["data",["symbol","rval"],expr$18946]],["send",["symbol","->"],["data",["data",["symbol","excv"]],parse_clauses$16194(scope$18936,["symbol","excv"],clauses$18947,({"wrap":function(x$18996){return ["send",["symbol",":="],["data",["symbol","rval"],x$18996]];}}))]],["void"]],["symbol","rval"]]]];}}}),accum$18929)),$16134(({"@":var_operator$16219(expander$16206.gensym("it"))}),$16134(((accum$18999=({})),((t0$19001=$23061(expr_mac$16213)(function(scope$19005,form$19006,$19003$19007){var t0$19013;var t1$19014;var t2$19015;var t3$19016;var t4$19017;var t5$19018;var it$19030;var construct$19031;var defn$19009;var env$19010;var body$19011;(t0$19013=$19003$19007);if(((t0$19013 instanceof Array)&&((t1$19014=t0$19013.length),((t1$19014===3)&&((t0$19013[0]==="data")&&((t2$19015=t0$19013[1]),((defn$19009=t2$19015),($22747(t2$19015,"env")&&((env$19010=t2$19015.env),((t3$19016=$23061(["multi"])(t0$19013[2])),(t3$19016[0]&&((t4$19017=t3$19016[1]),((t5$19018=t4$19017.length),(t5$19018>=0)))))))))))))){(body$19011=Array.prototype.slice.call(t4$19017,0));;}else{$22976($19003$19007);}(it$19030=$22989(["symbol","@"],({"env":env$19010})));;(construct$19031=function($19037$19039){var x$19066;var rest$19067;var x$19060;var $19042$19056;var $19043$19057;var t0$19054;var $19041$19049;var ph$19044;(ph$19044=$19037$19039);;($19041$19049=ph$19044);;if((($19042$19056=($19041$19049 instanceof Array))&&((t0$19054=$19041$19049.length),(t0$19054===1)))){(x$19060=$19041$19049[0]);return x$19060;}else{if(($19042$19056&&(t0$19054>=1))){(x$19066=$19041$19049[0]);(rest$19067=Array.prototype.slice.call($19041$19049,1));return ["send",["symbol","let"],["data",["send",["symbol","="],["data",it$19030,x$19066]],construct$19031(rest$19067)]];}else{$22976($19041$19049);}}});;return construct$19031([defn$19009].concat(body$19011));})),function(){if(t0$19001[0]){(accum$18999["chain"]=t0$19001[1]);return accum$18999;}else{return $22976(function(scope$19076,form$19077,$19074$19078){var t0$19084;var t1$19085;var t2$19086;var t3$19087;var t4$19088;var t5$19089;var it$19101;var construct$19102;var defn$19080;var env$19081;var body$19082;(t0$19084=$19074$19078);if(((t0$19084 instanceof Array)&&((t1$19085=t0$19084.length),((t1$19085===3)&&((t0$19084[0]==="data")&&((t2$19086=t0$19084[1]),((defn$19080=t2$19086),($22747(t2$19086,"env")&&((env$19081=t2$19086.env),((t3$19087=$23061(["multi"])(t0$19084[2])),(t3$19087[0]&&((t4$19088=t3$19087[1]),((t5$19089=t4$19088.length),(t5$19089>=0)))))))))))))){(body$19082=Array.prototype.slice.call(t4$19088,0));;}else{$22976($19074$19078);}(it$19101=$22989(["symbol","@"],({"env":env$19081})));;(construct$19102=function($19108$19110){var x$19137;var rest$19138;var x$19131;var $19113$19127;var $19114$19128;var t0$19125;var $19112$19120;var ph$19115;(ph$19115=$19108$19110);;($19112$19120=ph$19115);;if((($19113$19127=($19112$19120 instanceof Array))&&((t0$19125=$19112$19120.length),(t0$19125===1)))){(x$19131=$19112$19120[0]);return x$19131;}else{if(($19113$19127&&(t0$19125>=1))){(x$19137=$19112$19120[0]);(rest$19138=Array.prototype.slice.call($19112$19120,1));return ["send",["symbol","let"],["data",["send",["symbol","="],["data",it$19101,x$19137]],construct$19102(rest$19138)]];}else{$22976($19112$19120);}}});;return construct$19102([defn$19080].concat(body$19082));});}}())),$16134(((accum$19145=({})),((t0$19147=$23061(expr_mac$16213)(function(scope$19151,form$19152,$19149$19153){var t0$19159;var t1$19160;var t2$19161;var it$19169;var defn$19155;var env$19156;var body$19157;(t0$19159=$19149$19153);if(((t0$19159 instanceof Array)&&((t1$19160=t0$19159.length),((t1$19160===3)&&((t0$19159[0]==="data")&&((t2$19161=t0$19159[1]),((defn$19155=t2$19161),$22747(t2$19161,"env")))))))){(env$19156=t2$19161.env);(body$19157=t0$19159[2]);;}else{$22976($19149$19153);}(it$19169=$22989(["symbol","@"],({"env":env$19156})));;return ["send",["symbol","let"],["data",["send",["symbol","="],["data",it$19169,defn$19155]],body$19157]];})),function(){if(t0$19147[0]){(accum$19145["using"]=t0$19147[1]);return accum$19145;}else{return $22976(function(scope$19176,form$19177,$19174$19178){var t0$19184;var t1$19185;var t2$19186;var it$19194;var defn$19180;var env$19181;var body$19182;(t0$19184=$19174$19178);if(((t0$19184 instanceof Array)&&((t1$19185=t0$19184.length),((t1$19185===3)&&((t0$19184[0]==="data")&&((t2$19186=t0$19184[1]),((defn$19180=t2$19186),$22747(t2$19186,"env")))))))){(env$19181=t2$19186.env);(body$19182=t0$19184[2]);;}else{$22976($19174$19178);}(it$19194=$22989(["symbol","@"],({"env":env$19181})));;return ["send",["symbol","let"],["data",["send",["symbol","="],["data",it$19194,defn$19180]],body$19182]];});}}())),$16134(((accum$19199=({})),((t0$19201=$23061(overridable$16214)(function($19203$19206,scope$19207,form$19208,$19204$19209){var t0$19218;var t1$19219;var x$19235;var x$19244;var t0$19252;var t1$19253;var t2$19254;var stmts$19250;var x$19264;var $19211$19225;var ph$19212;var body$19213;(ph$19212=$19203$19206);;(t0$19218=$19204$19209);if(((t0$19218 instanceof Array)&&((t1$19219=t0$19218.length),((t1$19219===2)&&(t0$19218[0]==="data"))))){(body$19213=t0$19218[1]);;}else{$22976($19204$19209);}($19211$19225=ph$19212);;if((((x$19235=$19211$19225)),((x$19235 instanceof Array)&&(x$19235[0]==="clause")))){return ["block",body$19213];}else{if((((x$19244=$19211$19225)),((x$19244 instanceof Array)&&(x$19244[0]==="test")))){(t0$19252=$23061(["multi"])(body$19213));if((t0$19252[0]&&((t1$19253=t0$19252[1]),((t2$19254=t1$19253.length),(t2$19254>=0))))){(stmts$19250=Array.prototype.slice.call(t1$19253,0));;}else{$22976(body$19213,"/home/olivier/git/earl-grey/src/stdenv.eg",19851,19855);}return ["do",["splice"].concat(stmts$19250)];}else{if((((x$19264=$19211$19225)),((x$19264 instanceof Array)&&(x$19264[0]==="expr")))){return ["multi",body$19213];}else{$22976($19211$19225);}}}})),function(){if(t0$19201[0]){(accum$19199["do"]=t0$19201[1]);return accum$19199;}else{return $22976(function($19272$19275,scope$19276,form$19277,$19273$19278){var t0$19287;var t1$19288;var x$19304;var x$19313;var t0$19321;var t1$19322;var t2$19323;var stmts$19319;var x$19333;var $19280$19294;var ph$19281;var body$19282;(ph$19281=$19272$19275);;(t0$19287=$19273$19278);if(((t0$19287 instanceof Array)&&((t1$19288=t0$19287.length),((t1$19288===2)&&(t0$19287[0]==="data"))))){(body$19282=t0$19287[1]);;}else{$22976($19273$19278);}($19280$19294=ph$19281);;if((((x$19304=$19280$19294)),((x$19304 instanceof Array)&&(x$19304[0]==="clause")))){return ["block",body$19282];}else{if((((x$19313=$19280$19294)),((x$19313 instanceof Array)&&(x$19313[0]==="test")))){(t0$19321=$23061(["multi"])(body$19282));if((t0$19321[0]&&((t1$19322=t0$19321[1]),((t2$19323=t1$19322.length),(t2$19323>=0))))){(stmts$19319=Array.prototype.slice.call(t1$19322,0));;}else{$22976(body$19282,"/home/olivier/git/earl-grey/src/stdenv.eg",19851,19855);}return ["do",["splice"].concat(stmts$19319)];}else{if((((x$19333=$19280$19294)),((x$19333 instanceof Array)&&(x$19333[0]==="expr")))){return ["multi",body$19282];}else{$22976($19280$19294);}}}});}}())),$16134(((accum$19341=({})),((t0$19343=$23061(expr_mac$16213)(function(scope$19347,form$19348,$19345$19349){var other$19458;var s1$19445;var b$19446;var a$19426;var b$19427;var a$19414;var $19353$19409;var $19354$19410;var $19355$19411;var t0$19394;var t1$19395;var t2$19396;var t3$19397;var t4$19398;var t5$19399;var t6$19400;var t7$19401;var t8$19402;var t9$19403;var t10$19404;var t11$19405;var t12$19406;var t13$19407;var test$19385;var $19352$19386;var test$19377;var a$19378;var b$19379;var $19356$19373;var $19357$19374;var t0$19368;var t1$19369;var t2$19370;var t3$19371;var $19351$19363;var ph$19358;(ph$19358=$19345$19349);;($19351$19363=ph$19358);;if((($19356$19373=($19351$19363 instanceof Array))&&((t0$19368=$19351$19363.length),((t0$19368===4)&&($19351$19363[0]==="data"))))){(test$19377=$19351$19363[1]);(a$19378=$19351$19363[2]);(b$19379=$19351$19363[3]);return ["if",test$19377,a$19378,b$19379];}else{if(($19356$19373&&((t0$19368===3)&&(($19351$19363[0]==="data")&&((test$19385=$19351$19363[1]),((t1$19369=$23061(["multi"])($19351$19363[2])),(t1$19369[0]&&((t2$19370=t1$19369[1]),((t3$19371=t2$19370.length),(t3$19371>=0)))))))))){($19352$19386=Array.prototype.slice.call(t2$19370,0));(t0$19394=$19352$19386);if((($19354$19410=(t0$19394 instanceof Array))&&((t1$19395=t0$19394.length),((t1$19395===1)&&((t2$19396=t0$19394[0]),((t2$19396 instanceof Array)&&((t3$19397=t2$19396.length),((t3$19397===3)&&((t2$19396[0]==="send")&&((t4$19398=t2$19396[1]),((t4$19398 instanceof Array)&&((t5$19399=t4$19398.length),((t5$19399===2)&&((t4$19398[0]==="symbol")&&((t4$19398[1]==="then")&&((t6$19400=t2$19396[2]),((t6$19400 instanceof Array)&&((t7$19401=t6$19400.length),((t7$19401===2)&&(t6$19400[0]==="data")))))))))))))))))))){(a$19414=t6$19400[1]);return ["if",test$19385,a$19414,["value",(void 0)]];}else{if(($19354$19410&&((t1$19395===2)&&((t2$19396=t0$19394[0]),((t2$19396 instanceof Array)&&((t3$19397=t2$19396.length),((t3$19397===3)&&((t2$19396[0]==="send")&&((t4$19398=t2$19396[1]),((t4$19398 instanceof Array)&&((t5$19399=t4$19398.length),((t5$19399===2)&&((t4$19398[0]==="symbol")&&((t4$19398[1]==="then")&&((t6$19400=t2$19396[2]),((t6$19400 instanceof Array)&&((t7$19401=t6$19400.length),((t7$19401===2)&&((t6$19400[0]==="data")&&((a$19426=t6$19400[1]),((t8$19402=t0$19394[1]),((t8$19402 instanceof Array)&&((t9$19403=t8$19402.length),((t9$19403===3)&&((t8$19402[0]==="send")&&((t10$19404=t8$19402[1]),((t10$19404 instanceof Array)&&((t11$19405=t10$19404.length),((t11$19405===2)&&((t10$19404[0]==="symbol")&&((t10$19404[1]==="else")&&((t12$19406=t8$19402[2]),((t12$19406 instanceof Array)&&((t13$19407=t12$19406.length),((t13$19407===2)&&(t12$19406[0]==="data")))))))))))))))))))))))))))))))))))){(b$19427=t12$19406[1]);return ["if",test$19385,a$19426,b$19427];}else{if(($19354$19410&&((t1$19395>=1)&&((s1$19445=Array.prototype.slice.call(t0$19394,0,-1)),((t2$19396=t0$19394[(t1$19395-1)]),((t2$19396 instanceof Array)&&((t3$19397=t2$19396.length),((t3$19397===3)&&((t2$19396[0]==="send")&&((t4$19398=t2$19396[1]),((t4$19398 instanceof Array)&&((t5$19399=t4$19398.length),((t5$19399===2)&&((t4$19398[0]==="symbol")&&((t4$19398[1]==="else")&&((t6$19400=t2$19396[2]),((t6$19400 instanceof Array)&&((t7$19401=t6$19400.length),((t7$19401===2)&&(t6$19400[0]==="data")))))))))))))))))))){(b$19446=t6$19400[1]);return ["if",test$19385,["multi"].concat(s1$19445),b$19446];}else{(other$19458=$19352$19386);return ["if",test$19385,["multi"].concat(other$19458),["value",(void 0)]];}}}}else{$22976($19351$19363);}}})),function(){if(t0$19343[0]){(accum$19341["if"]=t0$19343[1]);return accum$19341;}else{return $22976(function(scope$19465,form$19466,$19463$19467){var other$19576;var s1$19563;var b$19564;var a$19544;var b$19545;var a$19532;var $19471$19527;var $19472$19528;var $19473$19529;var t0$19512;var t1$19513;var t2$19514;var t3$19515;var t4$19516;var t5$19517;var t6$19518;var t7$19519;var t8$19520;var t9$19521;var t10$19522;var t11$19523;var t12$19524;var t13$19525;var test$19503;var $19470$19504;var test$19495;var a$19496;var b$19497;var $19474$19491;var $19475$19492;var t0$19486;var t1$19487;var t2$19488;var t3$19489;var $19469$19481;var ph$19476;(ph$19476=$19463$19467);;($19469$19481=ph$19476);;if((($19474$19491=($19469$19481 instanceof Array))&&((t0$19486=$19469$19481.length),((t0$19486===4)&&($19469$19481[0]==="data"))))){(test$19495=$19469$19481[1]);(a$19496=$19469$19481[2]);(b$19497=$19469$19481[3]);return ["if",test$19495,a$19496,b$19497];}else{if(($19474$19491&&((t0$19486===3)&&(($19469$19481[0]==="data")&&((test$19503=$19469$19481[1]),((t1$19487=$23061(["multi"])($19469$19481[2])),(t1$19487[0]&&((t2$19488=t1$19487[1]),((t3$19489=t2$19488.length),(t3$19489>=0)))))))))){($19470$19504=Array.prototype.slice.call(t2$19488,0));(t0$19512=$19470$19504);if((($19472$19528=(t0$19512 instanceof Array))&&((t1$19513=t0$19512.length),((t1$19513===1)&&((t2$19514=t0$19512[0]),((t2$19514 instanceof Array)&&((t3$19515=t2$19514.length),((t3$19515===3)&&((t2$19514[0]==="send")&&((t4$19516=t2$19514[1]),((t4$19516 instanceof Array)&&((t5$19517=t4$19516.length),((t5$19517===2)&&((t4$19516[0]==="symbol")&&((t4$19516[1]==="then")&&((t6$19518=t2$19514[2]),((t6$19518 instanceof Array)&&((t7$19519=t6$19518.length),((t7$19519===2)&&(t6$19518[0]==="data")))))))))))))))))))){(a$19532=t6$19518[1]);return ["if",test$19503,a$19532,["value",(void 0)]];}else{if(($19472$19528&&((t1$19513===2)&&((t2$19514=t0$19512[0]),((t2$19514 instanceof Array)&&((t3$19515=t2$19514.length),((t3$19515===3)&&((t2$19514[0]==="send")&&((t4$19516=t2$19514[1]),((t4$19516 instanceof Array)&&((t5$19517=t4$19516.length),((t5$19517===2)&&((t4$19516[0]==="symbol")&&((t4$19516[1]==="then")&&((t6$19518=t2$19514[2]),((t6$19518 instanceof Array)&&((t7$19519=t6$19518.length),((t7$19519===2)&&((t6$19518[0]==="data")&&((a$19544=t6$19518[1]),((t8$19520=t0$19512[1]),((t8$19520 instanceof Array)&&((t9$19521=t8$19520.length),((t9$19521===3)&&((t8$19520[0]==="send")&&((t10$19522=t8$19520[1]),((t10$19522 instanceof Array)&&((t11$19523=t10$19522.length),((t11$19523===2)&&((t10$19522[0]==="symbol")&&((t10$19522[1]==="else")&&((t12$19524=t8$19520[2]),((t12$19524 instanceof Array)&&((t13$19525=t12$19524.length),((t13$19525===2)&&(t12$19524[0]==="data")))))))))))))))))))))))))))))))))))){(b$19545=t12$19524[1]);return ["if",test$19503,a$19544,b$19545];}else{if(($19472$19528&&((t1$19513>=1)&&((s1$19563=Array.prototype.slice.call(t0$19512,0,-1)),((t2$19514=t0$19512[(t1$19513-1)]),((t2$19514 instanceof Array)&&((t3$19515=t2$19514.length),((t3$19515===3)&&((t2$19514[0]==="send")&&((t4$19516=t2$19514[1]),((t4$19516 instanceof Array)&&((t5$19517=t4$19516.length),((t5$19517===2)&&((t4$19516[0]==="symbol")&&((t4$19516[1]==="else")&&((t6$19518=t2$19514[2]),((t6$19518 instanceof Array)&&((t7$19519=t6$19518.length),((t7$19519===2)&&(t6$19518[0]==="data")))))))))))))))))))){(b$19564=t6$19518[1]);return ["if",test$19503,["multi"].concat(s1$19563),b$19564];}else{(other$19576=$19470$19504);return ["if",test$19503,["multi"].concat(other$19576),["value",(void 0)]];}}}}else{$22976($19469$19481);}}});}}())),$16134(((accum$19581=({})),((t0$19583=$23061(expr_mac$16213)(function(scope$19587,form$19588,$19585$19589){var t0$19596;var t0$19614;var t1$19615;var t2$19616;var t3$19617;var t4$19618;var t5$19619;var t6$19620;var t7$19621;var t8$19622;var t0$19634;var test$19656;var body$19657;var label$19611;var bridge$19592$19606;var t0$19607;var $19591$19601;var ph$19593;var env$19594;(t0$19596=$19585$19589);if($22747(t0$19596,"env")){(env$19594=t0$19596.env);(ph$19593=t0$19596);;}else{$22976($19585$19589);}($19591$19601=ph$19593);;(bridge$19592$19606=$19591$19601);if((((bridge$19592$19606 instanceof Array)&&((t0$19614=bridge$19592$19606.length),((t0$19614===3)&&((bridge$19592$19606[0]==="send")&&((t1$19615=bridge$19592$19606[1]),((t1$19615 instanceof Array)&&((t2$19616=t1$19615.length),((t2$19616===2)&&((t1$19615[0]==="symbol")&&((t1$19615[1]===".")&&((t3$19617=bridge$19592$19606[2]),((t3$19617 instanceof Array)&&((t4$19618=t3$19617.length),((t4$19618===3)&&((t3$19617[0]==="data")&&((t5$19619=t3$19617[1]),((t5$19619 instanceof Array)&&((t6$19620=t5$19619.length),((t6$19620===1)&&((t5$19619[0]==="void")&&((t7$19621=t3$19617[2]),((t7$19621 instanceof Array)&&((t8$19622=t7$19621.length),((t8$19622===2)&&((t7$19621[0]==="symbol")&&((label$19611=t7$19621[1]),true))))))))))))))))))))))))))||((bridge$19592$19606 instanceof Array)&&((t0$19634=bridge$19592$19606.length),((t0$19634===2)&&((bridge$19592$19606[0]==="value")&&((label$19611=bridge$19592$19606[1]),true))))))){return ["macro",function(context$19640,scope$19641,form$19642,$19638$19643){var t0$19648;var t1$19649;var test$19645;var body$19646;(t0$19648=$19638$19643);if(((t0$19648 instanceof Array)&&((t1$19649=t0$19648.length),((t1$19649===3)&&(t0$19648[0]==="data"))))){(test$19645=t0$19648[1]);(body$19646=t0$19648[2]);;}else{$22976($19638$19643);}return setup_label$16216(label$19611,env$19594,["js_while",test$19645,body$19646]);}];}else{if((($19591$19601 instanceof Array)&&((t0$19607=$19591$19601.length),((t0$19607===3)&&($19591$19601[0]==="data"))))){(test$19656=$19591$19601[1]);(body$19657=$19591$19601[2]);return setup_label$16216(scope$19587.gensym(),env$19594,["js_while",test$19656,body$19657]);}else{$22976($19591$19601);}}})),function(){if(t0$19583[0]){(accum$19581["while"]=t0$19583[1]);return accum$19581;}else{return $22976(function(scope$19666,form$19667,$19664$19668){var t0$19675;var t0$19693;var t1$19694;var t2$19695;var t3$19696;var t4$19697;var t5$19698;var t6$19699;var t7$19700;var t8$19701;var t0$19713;var test$19735;var body$19736;var label$19690;var bridge$19671$19685;var t0$19686;var $19670$19680;var ph$19672;var env$19673;(t0$19675=$19664$19668);if($22747(t0$19675,"env")){(env$19673=t0$19675.env);(ph$19672=t0$19675);;}else{$22976($19664$19668);}($19670$19680=ph$19672);;(bridge$19671$19685=$19670$19680);if((((bridge$19671$19685 instanceof Array)&&((t0$19693=bridge$19671$19685.length),((t0$19693===3)&&((bridge$19671$19685[0]==="send")&&((t1$19694=bridge$19671$19685[1]),((t1$19694 instanceof Array)&&((t2$19695=t1$19694.length),((t2$19695===2)&&((t1$19694[0]==="symbol")&&((t1$19694[1]===".")&&((t3$19696=bridge$19671$19685[2]),((t3$19696 instanceof Array)&&((t4$19697=t3$19696.length),((t4$19697===3)&&((t3$19696[0]==="data")&&((t5$19698=t3$19696[1]),((t5$19698 instanceof Array)&&((t6$19699=t5$19698.length),((t6$19699===1)&&((t5$19698[0]==="void")&&((t7$19700=t3$19696[2]),((t7$19700 instanceof Array)&&((t8$19701=t7$19700.length),((t8$19701===2)&&((t7$19700[0]==="symbol")&&((label$19690=t7$19700[1]),true))))))))))))))))))))))))))||((bridge$19671$19685 instanceof Array)&&((t0$19713=bridge$19671$19685.length),((t0$19713===2)&&((bridge$19671$19685[0]==="value")&&((label$19690=bridge$19671$19685[1]),true))))))){return ["macro",function(context$19719,scope$19720,form$19721,$19717$19722){var t0$19727;var t1$19728;var test$19724;var body$19725;(t0$19727=$19717$19722);if(((t0$19727 instanceof Array)&&((t1$19728=t0$19727.length),((t1$19728===3)&&(t0$19727[0]==="data"))))){(test$19724=t0$19727[1]);(body$19725=t0$19727[2]);;}else{$22976($19717$19722);}return setup_label$16216(label$19690,env$19673,["js_while",test$19724,body$19725]);}];}else{if((($19670$19680 instanceof Array)&&((t0$19686=$19670$19680.length),((t0$19686===3)&&($19670$19680[0]==="data"))))){(test$19735=$19670$19680[1]);(body$19736=$19670$19680[2]);return setup_label$16216(scope$19666.gensym(),env$19673,["js_while",test$19735,body$19736]);}else{$22976($19670$19680);}}});}}())),$16134(((accum$19743=({})),((accum$19743["for"]=function(context$19748,scope$19749,form$19750,$19746$19751){var t0$19758;var t0$19828;var t1$19829;var t2$19830;var t3$19831;var t4$19832;var t5$19833;var t6$19834;var t7$19835;var t8$19836;var t0$19848;var spec$19870;var body$19871;var label$19825;var setup_for$19771;var bridge$19754$19767;var t0$19768;var $19753$19762;var ph$19755;var expr$19756;(t0$19758=$19746$19751);(expr$19756=t0$19758);(ph$19755=t0$19758);;($19753$19762=ph$19755);;(setup_for$19771=function(label$19776,env$19777,$19774$19778,body$19779){var a$19812;var b$19813;var a$19804;var b$19805;var c$19806;var $19782$19800;var $19783$19801;var t0$19794;var t1$19795;var t2$19796;var t3$19797;var t4$19798;var $19781$19789;var ph$19784;(ph$19784=$19774$19778);;($19781$19789=ph$19784);;if((($19782$19800=($19781$19789 instanceof Array))&&((t0$19794=$19781$19789.length),((t0$19794===4)&&($19781$19789[0]==="multi"))))){(a$19804=$19781$19789[1]);(b$19805=$19781$19789[2]);(c$19806=$19781$19789[3]);return ["multi",a$19804,setup_label$16216(label$19776,env$19777,["js_for",["multi"],b$19805,c$19806,body$19779])];}else{if(($19782$19800&&((t0$19794===3)&&(($19781$19789[0]==="send")&&((t1$19795=$19781$19789[1]),((t1$19795 instanceof Array)&&((t2$19796=t1$19795.length),((t2$19796===2)&&((t1$19795[0]==="symbol")&&((t1$19795[1]==="in")&&((t3$19797=$19781$19789[2]),((t3$19797 instanceof Array)&&((t4$19798=t3$19797.length),((t4$19798===3)&&(t3$19797[0]==="data"))))))))))))))){(a$19812=t3$19797[1]);(b$19813=t3$19797[2]);return ["multi",["declare",a$19812,["value",null]],setup_label$16216(label$19776,env$19777,["js_for_in",a$19812,b$19813,body$19779])];}else{$22976($19781$19789);}}});;(bridge$19754$19767=$19753$19762);if((((bridge$19754$19767 instanceof Array)&&((t0$19828=bridge$19754$19767.length),((t0$19828===3)&&((bridge$19754$19767[0]==="send")&&((t1$19829=bridge$19754$19767[1]),((t1$19829 instanceof Array)&&((t2$19830=t1$19829.length),((t2$19830===2)&&((t1$19829[0]==="symbol")&&((t1$19829[1]===".")&&((t3$19831=bridge$19754$19767[2]),((t3$19831 instanceof Array)&&((t4$19832=t3$19831.length),((t4$19832===3)&&((t3$19831[0]==="data")&&((t5$19833=t3$19831[1]),((t5$19833 instanceof Array)&&((t6$19834=t5$19833.length),((t6$19834===1)&&((t5$19833[0]==="void")&&((t7$19835=t3$19831[2]),((t7$19835 instanceof Array)&&((t8$19836=t7$19835.length),((t8$19836===2)&&((t7$19835[0]==="symbol")&&((label$19825=t7$19835[1]),true))))))))))))))))))))))))))||((bridge$19754$19767 instanceof Array)&&((t0$19848=bridge$19754$19767.length),((t0$19848===2)&&((bridge$19754$19767[0]==="value")&&((label$19825=bridge$19754$19767[1]),true))))))){return ["macro",function(context$19854,scope$19855,form$19856,$19852$19857){var t0$19862;var t1$19863;var spec$19859;var body$19860;(t0$19862=$19852$19857);if(((t0$19862 instanceof Array)&&((t1$19863=t0$19862.length),((t1$19863===3)&&(t0$19862[0]==="data"))))){(spec$19859=t0$19862[1]);(body$19860=t0$19862[2]);;}else{$22976($19852$19857);}return setup_for$19771(label$19825,expr$19756.env,spec$19859,body$19860);}];}else{if((($19753$19762 instanceof Array)&&((t0$19768=$19753$19762.length),((t0$19768===3)&&($19753$19762[0]==="data"))))){(spec$19870=$19753$19762[1]);(body$19871=$19753$19762[2]);return setup_for$19771(scope$19749.gensym(),form$19750.env,spec$19870,body$19871);}else{$22976($19753$19762);}}}),accum$19743)),$16134(((accum$19878=({})),((accum$19878["var"]=function($19881$19883,scope$19884,form$19885,argument$19886){var x$19891;if((((x$19891=$19881$19883)),((x$19891 instanceof Array)&&(x$19891[0]==="pattern")))){;}else{$22976($19881$19883);}return ["mode","var",argument$19886];}),accum$19878)),$16134(((accum$19898=({})),((accum$19898["set"]=function($19901$19903,scope$19904,form$19905,argument$19906){var x$19911;if((((x$19911=$19901$19903)),((x$19911 instanceof Array)&&(x$19911[0]==="pattern")))){;}else{$22976($19901$19903);}return ["mode","set",argument$19906];}),accum$19898)),$16134(((accum$19918=({})),((accum$19918["let"]=function($19921$19923,scope$19924,form$19925,argument$19926){var x$19944;var construct$19976;var bindings$19967;var body$19968;var t0$19960;var t1$19961;var t2$19962;var t3$19963;var $19953$19955;var other$19951;var $19928$19934;var ph$19929;(ph$19929=$19921$19923);;($19928$19934=ph$19929);;if((((x$19944=$19928$19934)),((x$19944 instanceof Array)&&(x$19944[0]==="pattern")))){return ["mode","let",argument$19926];}else{(other$19951=$19928$19934);($19953$19955=argument$19926);;if((($19953$19955 instanceof Array)&&((t0$19960=$19953$19955.length),((t0$19960===3)&&(($19953$19955[0]==="data")&&((t1$19961=$23061(["multi"])($19953$19955[1])),(t1$19961[0]&&((t2$19962=t1$19961[1]),((t3$19963=t2$19962.length),(t3$19963>=0)))))))))){(bindings$19967=Array.prototype.slice.call(t2$19962,0));(body$19968=$19953$19955[2]);(construct$19976=function($19979$19981){var bind$20013;var val$20014;var xs$20015;var $19984$20004;var $19985$20005;var t0$19996;var t1$19997;var t2$19998;var t3$19999;var t4$20000;var t5$20001;var t6$20002;var $19983$19991;var ph$19986;(ph$19986=$19979$19981);;($19983$19991=ph$19986);;if((($19984$20004=($19983$19991 instanceof Array))&&((t0$19996=$19983$19991.length),(t0$19996===0)))){return body$19968;}else{if(($19984$20004&&((t0$19996>=1)&&((t1$19997=$19983$19991[0]),((t1$19997 instanceof Array)&&((t2$19998=t1$19997.length),((t2$19998===3)&&((t1$19997[0]==="send")&&((t3$19999=t1$19997[1]),((t3$19999 instanceof Array)&&((t4$20000=t3$19999.length),((t4$20000===2)&&((t3$19999[0]==="symbol")&&((t3$19999[1]==="=")&&((t5$20001=t1$19997[2]),((t5$20001 instanceof Array)&&((t6$20002=t5$20001.length),((t6$20002===3)&&(t5$20001[0]==="data"))))))))))))))))))){(bind$20013=t5$20001[1]);(val$20014=t5$20001[2]);(xs$20015=Array.prototype.slice.call($19983$19991,1));return $22989(["multi",["send",["symbol","="],["data",["send",["symbol","let"],bind$20013],val$20014]],construct$19976(xs$20015)],({"nonrecursive":true}));}else{$22976($19983$19991);}}});;return construct$19976(bindings$19967);}else{$22976($19953$19955);}}}),accum$19918)),$16134(((accum$20030=({})),((t0$20032=$23061(expr_mac$16213)(function(scope$20036,form$20037,$20034$20038){var t0$20043;var t1$20044;var t2$20045;var t3$20046;var t4$20047;var $index$20077;var $length$20072;var temp$20067;var acc$20062;var let_bindings$20056;var bindings$20040;var body$20041;(t0$20043=$20034$20038);if(((t0$20043 instanceof Array)&&((t1$20044=t0$20043.length),((t1$20044===3)&&((t0$20043[0]==="data")&&((t2$20045=$23061(["multi"])(t0$20043[1])),(t2$20045[0]&&((t3$20046=t2$20045[1]),((t4$20047=t3$20046.length),(t4$20047>=0)))))))))){(bindings$20040=Array.prototype.slice.call(t3$20046,0));(body$20041=t0$20043[2]);;}else{$22976($20034$20038);}(let_bindings$20056=(((acc$20062=[])),(((temp$20067=bindings$20040)),((($length$20072=temp$20067.length)),((($index$20077=0)),function(){$20059:for(;($index$20077<$length$20072);($index$20077++)){var b$20099;var v$20100;var t0$20090;var t1$20091;var t2$20092;var t3$20093;var t4$20094;var t5$20095;var m$20085;(m$20085=temp$20067[$index$20077]);;(t0$20090=m$20085);if(((t0$20090 instanceof Array)&&((t1$20091=t0$20090.length),((t1$20091===3)&&((t0$20090[0]==="send")&&((t2$20092=t0$20090[1]),((t2$20092 instanceof Array)&&((t3$20093=t2$20092.length),((t3$20093===2)&&((t2$20092[0]==="symbol")&&((t2$20092[1]==="=")&&((t4$20094=t0$20090[2]),((t4$20094 instanceof Array)&&((t5$20095=t4$20094.length),((t5$20095===3)&&(t4$20094[0]==="data")))))))))))))))){(b$20099=t4$20094[1]);(v$20100=t4$20094[2]);acc$20062.push(["send",["symbol","="],["data",["send",["symbol","let"],b$20099],v$20100]]);}else{$22976(m$20085,"/home/olivier/git/earl-grey/src/stdenv.eg",22463,22510);;}}}()))),acc$20062));;return ["multi"].concat(let_bindings$20056).concat([body$20041]);})),function(){if(t0$20032[0]){(accum$20030["letrec"]=t0$20032[1]);return accum$20030;}else{return $22976(function(scope$20114,form$20115,$20112$20116){var t0$20121;var t1$20122;var t2$20123;var t3$20124;var t4$20125;var $index$20155;var $length$20150;var temp$20145;var acc$20140;var let_bindings$20134;var bindings$20118;var body$20119;(t0$20121=$20112$20116);if(((t0$20121 instanceof Array)&&((t1$20122=t0$20121.length),((t1$20122===3)&&((t0$20121[0]==="data")&&((t2$20123=$23061(["multi"])(t0$20121[1])),(t2$20123[0]&&((t3$20124=t2$20123[1]),((t4$20125=t3$20124.length),(t4$20125>=0)))))))))){(bindings$20118=Array.prototype.slice.call(t3$20124,0));(body$20119=t0$20121[2]);;}else{$22976($20112$20116);}(let_bindings$20134=(((acc$20140=[])),(((temp$20145=bindings$20118)),((($length$20150=temp$20145.length)),((($index$20155=0)),function(){$20137:for(;($index$20155<$length$20150);($index$20155++)){var b$20177;var v$20178;var t0$20168;var t1$20169;var t2$20170;var t3$20171;var t4$20172;var t5$20173;var m$20163;(m$20163=temp$20145[$index$20155]);;(t0$20168=m$20163);if(((t0$20168 instanceof Array)&&((t1$20169=t0$20168.length),((t1$20169===3)&&((t0$20168[0]==="send")&&((t2$20170=t0$20168[1]),((t2$20170 instanceof Array)&&((t3$20171=t2$20170.length),((t3$20171===2)&&((t2$20170[0]==="symbol")&&((t2$20170[1]==="=")&&((t4$20172=t0$20168[2]),((t4$20172 instanceof Array)&&((t5$20173=t4$20172.length),((t5$20173===3)&&(t4$20172[0]==="data")))))))))))))))){(b$20177=t4$20172[1]);(v$20178=t4$20172[2]);acc$20140.push(["send",["symbol","="],["data",["send",["symbol","let"],b$20177],v$20178]]);}else{$22976(m$20163,"/home/olivier/git/earl-grey/src/stdenv.eg",22463,22510);;}}}()))),acc$20140));;return ["multi"].concat(let_bindings$20134).concat([body$20119]);});}}())),$16134(((accum$20190=({})),((accum$20190["where"]=function(context$20195,scope$20196,form$20197,$20193$20198){var t0$20203;var t1$20204;var body$20200;var bindings$20201;(t0$20203=$20193$20198);if(((t0$20203 instanceof Array)&&((t1$20204=t0$20203.length),((t1$20204===3)&&(t0$20203[0]==="data"))))){(body$20200=t0$20203[1]);(bindings$20201=t0$20203[2]);;}else{$22976($20193$20198);}return ["send",["symbol","letrec"],["data",bindings$20201,body$20200]];}),accum$20190)),$16134(({"break":break_mac$16217(null),"continue":continue_mac$16218(null)}),$16134(((accum$20210=({})),((t0$20212=$23061(expr_mac$16213)(function(scope$20215,form$20216,arg$20217){return ["js_throw",arg$20217];})),function(){if(t0$20212[0]){(accum$20210["throw"]=t0$20212[1]);return accum$20210;}else{return $22976(function(scope$20221,form$20222,arg$20223){return ["js_throw",arg$20223];});}}())),$16134(((accum$20226=({})),((t0$20228=$23061(expr_mac$16213)(function(scope$20231,form$20232,arg$20233){return ["js_return",arg$20233];})),function(){if(t0$20228[0]){(accum$20226["return"]=t0$20228[1]);return accum$20226;}else{return $22976(function(scope$20237,form$20238,arg$20239){return ["js_return",arg$20239];});}}())),$16134(((accum$20242=({})),((t0$20244=$23061(expr_mac$16213)(function(scope$20247,form$20248,arg$20249){return ["js_new",arg$20249];})),function(){if(t0$20244[0]){(accum$20242["new"]=t0$20244[1]);return accum$20242;}else{return $22976(function(scope$20253,form$20254,arg$20255){return ["js_new",arg$20255];});}}())),$16134(((accum$20258=({})),((t0$20260=$23061(expr_mac$16213)(function(scope$20263,form$20264,arg$20265){return ["js_delete",arg$20265];})),function(){if(t0$20260[0]){(accum$20258["delete"]=t0$20260[1]);return accum$20258;}else{return $22976(function(scope$20269,form$20270,arg$20271){return ["js_delete",arg$20271];});}}())),$16134(((accum$20274=({})),((accum$20274["splice"]=function(context$20279,scope$20280,form$20281,$20277$20282){var t0$20286;var t1$20287;var t2$20288;var t3$20289;var t4$20290;var stmts$20284;(t0$20286=$20277$20282);if(((t0$20286 instanceof Array)&&((t1$20287=t0$20286.length),((t1$20287===2)&&((t0$20286[0]==="data")&&((t2$20288=$23061(["multi"])(t0$20286[1])),(t2$20288[0]&&((t3$20289=t2$20288[1]),((t4$20290=t3$20289.length),(t4$20290>=0)))))))))){(stmts$20284=Array.prototype.slice.call(t3$20289,0));;}else{$22976($20277$20282);}return ["splice"].concat(stmts$20284);}),accum$20274)),$16134(((accum$20299=({})),((accum$20299["?"]=function(context$20304,scope$20305,form$20306,$20302$20307){var other$20389;var $20346$20358;var $20347$20359;var $20348$20360;var $20349$20361;var t0$20356;var $20345$20351;var checker$20342;var other$20497;var $20454$20466;var $20455$20467;var $20456$20468;var $20457$20469;var t0$20464;var $20453$20459;var x$20511;var other$20532;var t0$20523;var $20516$20518;var other$20536;var $20449$20501;var checker$20450;var chk$20444;var target$20445;var expr$20334;var $20310$20328;var $20311$20329;var $20312$20330;var $20313$20331;var t0$20324;var t1$20325;var t2$20326;var $20309$20319;var ph$20314;(ph$20314=$20302$20307);;($20309$20319=ph$20314);;if((($20310$20328=($20309$20319 instanceof Array))&&((t0$20324=$20309$20319.length),(($20312$20330=(t0$20324===3))&&(($20313$20331=($20309$20319[0]==="data"))&&((expr$20334=$20309$20319[1]),((t1$20325=$20309$20319[2]),((t1$20325 instanceof Array)&&((t2$20326=t1$20325.length),((t2$20326===1)&&(t1$20325[0]==="void"))))))))))){(checker$20342=((($20345$20351=expr$20334)),function(){if((($20346$20358=($20345$20351 instanceof Array))&&((t0$20356=$20345$20351.length),(($20348$20360=(t0$20356===2))&&(($20349$20361=($20345$20351[0]==="symbol"))&&($20345$20351[1]==="String")))))){return checker_db$16201.String;}else{if(($20349$20361&&($20345$20351[1]==="Number"))){return checker_db$16201.Number;}else{if(($20349$20361&&($20345$20351[1]==="true"))){return checker_db$16201.true;}else{if(($20349$20361&&($20345$20351[1]==="false"))){return checker_db$16201.false;}else{if(($20349$20361&&($20345$20351[1]==="null"))){return checker_db$16201.null;}else{if(($20349$20361&&($20345$20351[1]==="undefined"))){return checker_db$16201.undefined;}else{(other$20389=$20345$20351);return ["send",["symbol","___checker"],["data",expr$20334]];}}}}}}}()));;return ["macro",function($20392$20394,env$20395,form$20396,expr$20397){var x$20415;var other$20436;var t0$20427;var $20420$20422;var other$20440;var $20399$20405;var ph$20400;(ph$20400=$20392$20394);;($20399$20405=ph$20400);;if((((x$20415=$20399$20405)),((x$20415 instanceof Array)&&(x$20415[0]==="pattern")))){($20420$20422=expr$20397);;if((($20420$20422 instanceof Array)&&((t0$20427=$20420$20422.length),((t0$20427===1)&&($20420$20422[0]==="void"))))){return ["check",checker$20342,["ignore"]];}else{(other$20436=$20420$20422);return ["check",checker$20342,expr$20397];}}else{(other$20440=$20399$20405);return ["send",checker$20342,["data",expr$20397]];}}];}else{if($20313$20331){(chk$20444=$20309$20319[1]);(target$20445=$20309$20319[2]);(checker$20450=((($20453$20459=chk$20444)),function(){if((($20454$20466=($20453$20459 instanceof Array))&&((t0$20464=$20453$20459.length),(($20456$20468=(t0$20464===2))&&(($20457$20469=($20453$20459[0]==="symbol"))&&($20453$20459[1]==="String")))))){return checker_db$16201.String;}else{if(($20457$20469&&($20453$20459[1]==="Number"))){return checker_db$16201.Number;}else{if(($20457$20469&&($20453$20459[1]==="true"))){return checker_db$16201.true;}else{if(($20457$20469&&($20453$20459[1]==="false"))){return checker_db$16201.false;}else{if(($20457$20469&&($20453$20459[1]==="null"))){return checker_db$16201.null;}else{if(($20457$20469&&($20453$20459[1]==="undefined"))){return checker_db$16201.undefined;}else{(other$20497=$20453$20459);return ["send",["symbol","___checker"],["data",chk$20444]];}}}}}}}()));;($20449$20501=context$20304);;if((((x$20511=$20449$20501)),((x$20511 instanceof Array)&&(x$20511[0]==="pattern")))){($20516$20518=target$20445);;if((($20516$20518 instanceof Array)&&((t0$20523=$20516$20518.length),((t0$20523===1)&&($20516$20518[0]==="void"))))){return ["check",checker$20450,["ignore"]];}else{(other$20532=$20516$20518);return ["check",checker$20450,target$20445];}}else{(other$20536=$20449$20501);return ["send",checker$20450,["data",target$20445]];}}else{$22976($20309$20319);}}}),accum$20299)),$16134(((accum$20541=({})),((accum$20541["!"]=function(context$20546,scope$20547,form$20548,$20544$20549){var other$20621;var $20588$20600;var $20589$20601;var $20590$20602;var $20591$20603;var t0$20598;var $20587$20593;var projector$20584;var other$20719;var $20686$20698;var $20687$20699;var $20688$20700;var $20689$20701;var t0$20696;var $20685$20691;var x$20733;var other$20754;var t0$20745;var $20738$20740;var other$20758;var $20681$20723;var projector$20682;var prj$20676;var target$20677;var expr$20576;var $20552$20570;var $20553$20571;var $20554$20572;var $20555$20573;var t0$20566;var t1$20567;var t2$20568;var $20551$20561;var ph$20556;(ph$20556=$20544$20549);;($20551$20561=ph$20556);;if((($20552$20570=($20551$20561 instanceof Array))&&((t0$20566=$20551$20561.length),(($20554$20572=(t0$20566===3))&&(($20555$20573=($20551$20561[0]==="data"))&&((expr$20576=$20551$20561[1]),((t1$20567=$20551$20561[2]),((t1$20567 instanceof Array)&&((t2$20568=t1$20567.length),((t2$20568===1)&&(t1$20567[0]==="void"))))))))))){(projector$20584=((($20587$20593=expr$20576)),function(){if((($20588$20600=($20587$20593 instanceof Array))&&((t0$20598=$20587$20593.length),(($20590$20602=(t0$20598===2))&&(($20591$20603=($20587$20593[0]==="symbol"))&&($20587$20593[1]==="String")))))){return mac1$16200(function(x$20610){return ["data",["symbol","true"],["send",["symbol","String"],["data",x$20610]]];});}else{if(($20591$20603&&($20587$20593[1]==="Number"))){return mac1$16200(function(x$20617){return ["data",["symbol","true"],["send",["symbol","parseFloat"],["data",x$20617]]];});}else{(other$20621=$20587$20593);return ["send",["symbol","___projector"],["data",expr$20576]];}}}()));;return ["macro",function($20624$20626,env$20627,form$20628,expr$20629){var x$20647;var other$20668;var t0$20659;var $20652$20654;var other$20672;var $20631$20637;var ph$20632;(ph$20632=$20624$20626);;($20631$20637=ph$20632);;if((((x$20647=$20631$20637)),((x$20647 instanceof Array)&&(x$20647[0]==="pattern")))){($20652$20654=expr$20629);;if((($20652$20654 instanceof Array)&&((t0$20659=$20652$20654.length),((t0$20659===1)&&($20652$20654[0]==="void"))))){return ["project",projector$20584,["ignore"]];}else{(other$20668=$20652$20654);return ["project",projector$20584,expr$20629];}}else{(other$20672=$20631$20637);return ["send",["send",projector$20584,["data",expr$20629]],["value",1]];}}];}else{if($20555$20573){(prj$20676=$20551$20561[1]);(target$20677=$20551$20561[2]);(projector$20682=((($20685$20691=prj$20676)),function(){if((($20686$20698=($20685$20691 instanceof Array))&&((t0$20696=$20685$20691.length),(($20688$20700=(t0$20696===2))&&(($20689$20701=($20685$20691[0]==="symbol"))&&($20685$20691[1]==="String")))))){return mac1$16200(function(x$20708){return ["data",["symbol","true"],["send",["symbol","String"],["data",x$20708]]];});}else{if(($20689$20701&&($20685$20691[1]==="Number"))){return mac1$16200(function(x$20715){return ["data",["symbol","true"],["send",["symbol","parseFloat"],["data",x$20715]]];});}else{(other$20719=$20685$20691);return ["send",["symbol","___projector"],["data",prj$20676]];}}}()));;($20681$20723=context$20546);;if((((x$20733=$20681$20723)),((x$20733 instanceof Array)&&(x$20733[0]==="pattern")))){($20738$20740=target$20677);;if((($20738$20740 instanceof Array)&&((t0$20745=$20738$20740.length),((t0$20745===1)&&($20738$20740[0]==="void"))))){return ["project",projector$20682,["ignore"]];}else{(other$20754=$20738$20740);return ["project",projector$20682,target$20677];}}else{(other$20758=$20681$20723);return ["send",["send",projector$20682,["data",target$20677]],["value",1]];}}else{$22976($20551$20561);}}}),accum$20541)),$16134(((accum$20763=({})),((accum$20763["#"]=function(context$20768,scope$20769,form$20770,$20766$20771){var t0$20775;var t1$20776;var t2$20777;var t3$20778;var t4$20779;var t5$20780;var f$20791;var tag$20773;(t0$20775=$20766$20771);if(((t0$20775 instanceof Array)&&((t1$20776=t0$20775.length),((t1$20776===3)&&((t0$20775[0]==="data")&&((t2$20777=t0$20775[1]),((t2$20777 instanceof Array)&&((t3$20778=t2$20777.length),((t3$20778===1)&&((t2$20777[0]==="void")&&((t4$20779=t0$20775[2]),((t4$20779 instanceof Array)&&((t5$20780=t4$20779.length),((t5$20780===2)&&(t4$20779[0]==="symbol"))))))))))))))){(tag$20773=t4$20779[1]);;}else{$22976($20766$20771);}(tag$20773=["value",tag$20773]);(f$20791=function($20794$20796,scope$20797,form$20798,expr$20799){var x$20817;var other$20867;var subp$20857;var $20824$20853;var $20825$20854;var t0$20851;var $20823$20846;var checker_mac$20826;var other$20897;var args$20892;var $20873$20883;var $20874$20884;var t0$20881;var $20872$20876;var $20801$20807;var ph$20802;(ph$20802=$20794$20796);;($20801$20807=ph$20802);;if((((x$20817=$20801$20807)),((x$20817 instanceof Array)&&(x$20817[0]==="pattern")))){(checker_mac$20826=["macro",function(context$20831,scope$20832,form$20833,$20829$20834){var t0$20838;var t1$20839;var expr$20836;(t0$20838=$20829$20834);if(((t0$20838 instanceof Array)&&((t1$20839=t0$20838.length),((t1$20839===2)&&(t0$20838[0]==="data"))))){(expr$20836=t0$20838[1]);;}else{$22976($20829$20834);}return ["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","x"],expr$20836]],["send",["symbol","and"],["data",["send",["symbol","instanceof"],["data",["symbol","x"],["symbol","Array"]]],["send",["symbol","==="],["data",["send",["symbol","x"],["value",0]],tag$20773]]]]]];}]);;($20823$20846=expr$20799);;if((($20824$20853=($20823$20846 instanceof Array))&&((t0$20851=$20823$20846.length),((t0$20851>=1)&&($20823$20846[0]==="data"))))){(subp$20857=Array.prototype.slice.call($20823$20846,1));return ["data",tag$20773].concat(subp$20857);}else{if(($20824$20853&&((t0$20851===1)&&($20823$20846[0]==="void")))){return ["check",checker_mac$20826,["ignore"]];}else{(other$20867=$20823$20846);return ["check",checker_mac$20826,expr$20799];}}}else{$20801$20807;($20872$20876=expr$20799);;if((($20873$20883=($20872$20876 instanceof Array))&&((t0$20881=$20872$20876.length),((t0$20881===1)&&($20872$20876[0]==="void"))))){return ["data",tag$20773];}else{if(($20873$20883&&((t0$20881>=1)&&($20872$20876[0]==="data")))){(args$20892=Array.prototype.slice.call($20872$20876,1));return ["data",tag$20773].concat(args$20892);}else{(other$20897=$20872$20876);return ["send",["data",tag$20773],other$20897];}}}});;return ["macro",f$20791];}),accum$20763)),$16134(((accum$20901=({})),((accum$20901["require"]=function(context$20906,scope$20907,form$20908,$20904$20909){var t0$20913;var t1$20914;var req$20920;var stmts$20921;var topfetch$20922;var produce$20923;var expr$20911;(t0$20913=$20904$20909);if(((t0$20913 instanceof Array)&&((t1$20914=t0$20913.length),((t1$20914===2)&&(t0$20913[0]==="data"))))){(expr$20911=t0$20913[1]);;}else{$22976($20904$20909);}(req$20920=["variable","require"]);;(stmts$20921=[]);;(topfetch$20922=function(pkg$20933,v$20934){stmts$20921.push(["send",["symbol","="],["data",v$20934,["send",req$20920,["data",pkg$20933]]]]);return v$20934;});;(produce$20923=function($20940$20942,fetch$20943){var t0$20959;var t0$21003;var t0$21007;var $index$21026;var $length$21021;var temp$21016;var pkgv$21081;var pkg$21074;var subp$21075;var pkg$21058;var s$21059;var name$21046;var subp$21000;var s$20994;var s$20988;var $20947$20977;var $20948$20978;var $20949$20979;var $20950$20980;var $20951$20981;var $20952$20982;var $20953$20983;var $20954$20984;var $20955$20985;var t0$20968;var t1$20969;var bridge$20946$20970;var t2$20971;var t3$20972;var t4$20973;var t5$20974;var t6$20975;var $20945$20963;var ph$20956;var expr$20957;(t0$20959=$20940$20942);(expr$20957=t0$20959);(ph$20956=t0$20959);;($20945$20963=ph$20956);;if((($20947$20977=($20945$20963 instanceof Array))&&((t0$20968=$20945$20963.length),(($20949$20979=(t0$20968===2))&&($20945$20963[0]==="symbol"))))){(s$20988=$20945$20963[1]);return fetch$20943(["value",s$20988],expr$20957);}else{if(($20949$20979&&(($20945$20963[0]==="value")&&((t1$20969=$20945$20963[1]),(typeof(t1$20969)==="string"))))){(s$20994=t1$20969);return fetch$20943(expr$20957,["symbol",scope$20907.gensym()]);}else{(bridge$20946$20970=$20945$20963);if((((bridge$20946$20970 instanceof Array)&&((t0$21003=bridge$20946$20970.length),((t0$21003>=1)&&((bridge$20946$20970[0]==="multi")&&((subp$21000=Array.prototype.slice.call(bridge$20946$20970,1)),true)))))||((bridge$20946$20970 instanceof Array)&&((t0$21007=bridge$20946$20970.length),((t0$21007>=1)&&((bridge$20946$20970[0]==="data")&&((subp$21000=Array.prototype.slice.call(bridge$20946$20970,1)),true))))))){(temp$21016=subp$21000);;($length$21021=temp$21016.length);;($index$21026=0);;$21012:for(;($index$21026<$length$21021);($index$21026++)){var p$21042;var m$21034;(m$21034=temp$21016[$index$21026]);;(p$21042=m$21034);produce$20923(p$21042,fetch$20943);}return null;}else{if((($20947$20977=($20945$20963 instanceof Array))&&((t0$20968=$20945$20963.length),(($20949$20979=(t0$20968===3))&&(($20950$20980=($20945$20963[0]==="send"))&&((t1$20969=$20945$20963[1]),(($20952$20982=(t1$20969 instanceof Array))&&((t2$20971=t1$20969.length),(($20954$20984=(t2$20971===2))&&(($20955$20985=(t1$20969[0]==="symbol"))&&((t1$20969[1]==="^")&&((t3$20972=$20945$20963[2]),((t3$20972 instanceof Array)&&((t4$20973=t3$20972.length),((t4$20973===3)&&((t3$20972[0]==="data")&&((t5$20974=t3$20972[1]),((t5$20974 instanceof Array)&&((t6$20975=t5$20974.length),((t6$20975===1)&&(t5$20974[0]==="void"))))))))))))))))))))){(name$21046=t3$20972[2]);return fetch$20943(name$21046,["symbol",scope$20907.gensym()]);}else{if(($20955$20985&&((t1$20969[1]==="as")&&((t3$20972=$20945$20963[2]),((t3$20972 instanceof Array)&&((t4$20973=t3$20972.length),((t4$20973===3)&&(t3$20972[0]==="data")))))))){(pkg$21058=t3$20972[1]);(s$21059=t3$20972[2]);return produce$20923(pkg$21058,function(the_pkg$21066,$21064$21067){$21064$21067;;return fetch$20943(the_pkg$21066,s$21059);});}else{if(($20955$20985&&((t1$20969[1]==="->")&&((t3$20972=$20945$20963[2]),((t3$20972 instanceof Array)&&((t4$20973=t3$20972.length),((t4$20973===3)&&(t3$20972[0]==="data")))))))){(pkg$21074=t3$20972[1]);(subp$21075=t3$20972[2]);(pkgv$21081=produce$20923(pkg$21074,fetch$20943));;return produce$20923(subp$21075,function(pkg$21086,v$21087){stmts$20921.push(["send",["symbol","="],["data",v$21087,["send",pkgv$21081,pkg$21086]]]);return v$21087;});}else{$22976($20945$20963);}}}}}}});;produce$20923(expr$20911,topfetch$20922);return ["splice"].concat(stmts$20921);}),accum$20901)),$16134(((accum$21094=({})),((accum$21094["provide"]=function(context$21099,scope$21100,form$21101,$21097$21102){var t0$21106;var t1$21107;var t2$21108;var t3$21109;var t4$21110;var $index$21138;var $length$21133;var temp$21128;var acc$21123;var expr$21104;(t0$21106=$21097$21102);if(((t0$21106 instanceof Array)&&((t1$21107=t0$21106.length),((t1$21107===2)&&((t0$21106[0]==="data")&&((t2$21108=$23061(["multi"])(t0$21106[1])),(t2$21108[0]&&((t3$21109=t2$21108[1]),((t4$21110=t3$21109.length),(t4$21110>=0)))))))))){(expr$21104=Array.prototype.slice.call(t3$21109,0));;}else{$22976($21097$21102);}return ["sink",["multi"].concat((((acc$21123=[])),(((temp$21128=expr$21104)),((($length$21133=temp$21128.length)),((($index$21138=0)),function(){$21118:for(;($index$21138<$length$21133);($index$21138++)){var t0$21180;var t0$21184;var other$21190;var s$21169;var name$21170;var s$21162;var name$21163;var $21121$21159;var t0$21151;var t1$21152;var t2$21153;var t3$21154;var t4$21155;var t5$21156;var bridge$21120$21157;var m$21146;(m$21146=temp$21128[$index$21138]);;(t0$21151=m$21146);(s$21162=t0$21151);if(((t0$21151 instanceof Array)&&((t1$21152=t0$21151.length),((t1$21152===2)&&(t0$21151[0]==="symbol"))))){(name$21163=t0$21151[1]);acc$21123.push(["send",["symbol",":="],["data",["send",["symbol","exports"],["value",name$21163]],s$21162]]);}else{if(((t0$21151 instanceof Array)&&((t1$21152=t0$21151.length),((t1$21152===3)&&((t0$21151[0]==="send")&&((t2$21153=t0$21151[1]),((t2$21153 instanceof Array)&&((t3$21154=t2$21153.length),((t3$21154===2)&&((t2$21153[0]==="symbol")&&((t2$21153[1]==="as")&&((t4$21155=t0$21151[2]),((t4$21155 instanceof Array)&&((t5$21156=t4$21155.length),((t5$21156===3)&&((t4$21155[0]==="data")&&((s$21169=t4$21155[1]),((bridge$21120$21157=t4$21155[2]),(((bridge$21120$21157 instanceof Array)&&((t0$21180=bridge$21120$21157.length),((t0$21180===2)&&((bridge$21120$21157[0]==="symbol")&&((name$21170=bridge$21120$21157[1]),true)))))||((bridge$21120$21157 instanceof Array)&&((t0$21184=bridge$21120$21157.length),((t0$21184===2)&&((bridge$21120$21157[0]==="value")&&((name$21170=bridge$21120$21157[1]),true)))))))))))))))))))))))){acc$21123.push(["send",["symbol",":="],["data",["send",["symbol","exports"],["value",name$21170]],s$21169]]);}else{(other$21190=m$21146);acc$21123.push(function(){throw $22785(["syntax","provide"]).create("Each clause of provide must be 'sym' or 'sym as name'");}());}}}}()))),acc$21123))];}),accum$21094)),$16134(((accum$21193=({})),((accum$21193["class"]=function(context$21198,scope$21199,$21196$21200,expr$21201){var t0$21205;var stmts$21533;var name$21522;var stmts$21523;var $21211$21518;var $21212$21519;var t0$21513;var t1$21514;var t2$21515;var t3$21516;var $21210$21508;var helper$21213;var env$21203;(t0$21205=$21196$21200);if($22747(t0$21205,"env")){(env$21203=t0$21205.env);;}else{$22976($21196$21200);}(helper$21213=function(name$21217,stmts$21218){var $index$21256;var $length$21251;var temp$21246;var acc$21241;var t0$21462;var t1$21463;var t0$21472;var env2$21469;var it$21470;var t0$21480;var t1$21481;var other$21504;var t0$21495;var $21221$21490;var statics$21222;var ctor$21223;var new_stmts$21224;var ctor_args$21225;var ctor_body$21226;var name_str$21227;var node$21228;(statics$21222=["data",["symbol","="]]);;(ctor$21223=[["data"],$22989(["multi"],({"env":env$21203}))]);;(new_stmts$21224=(((acc$21241=[])),(((temp$21246=stmts$21218)),((($length$21251=temp$21246.length)),((($index$21256=0)),function(){$21237:for(;($index$21256<$length$21251);($index$21256++)){var t0$21299;var t1$21300;var t2$21301;var t3$21302;var t4$21303;var t5$21304;var t6$21305;var t7$21306;var t8$21307;var t0$21320;var t1$21321;var t2$21322;var t3$21323;var t4$21324;var t5$21325;var t6$21326;var t7$21327;var t8$21328;var t9$21329;var t10$21330;var t11$21331;var t12$21332;var accum$21362;var accum$21386;var accum$21393;var accum$21448;var lhs$21352;var rhs$21353;var args$21295;var body$21296;var methods$21282;var t0$21269;var t1$21270;var t2$21271;var t3$21272;var t4$21273;var t5$21274;var t6$21275;var t7$21276;var t8$21277;var bridge$21239$21278;var m$21264;(m$21264=temp$21246[$index$21256]);;(t0$21269=m$21264);if(((t0$21269 instanceof Array)&&((t1$21270=t0$21269.length),((t1$21270===3)&&((t0$21269[0]==="send")&&((t2$21271=t0$21269[1]),((t2$21271 instanceof Array)&&((t3$21272=t2$21271.length),((t3$21272===2)&&((t2$21271[0]==="symbol")&&((t2$21271[1]==="static")&&((t4$21273=t0$21269[2]),((t4$21273 instanceof Array)&&((t5$21274=t4$21273.length),((t5$21274===2)&&((t4$21273[0]==="data")&&((t6$21275=$23061(["multi"])(t4$21273[1])),(t6$21275[0]&&((t7$21276=t6$21275[1]),((t8$21277=t7$21276.length),(t8$21277>=0))))))))))))))))))))){(methods$21282=Array.prototype.slice.call(t7$21276,0));acc$21241.push((statics$21222=statics$21222.concat(methods$21282)));}else{(bridge$21239$21278=m$21264);if((((bridge$21239$21278 instanceof Array)&&((t0$21299=bridge$21239$21278.length),((t0$21299===3)&&((bridge$21239$21278[0]==="send")&&((t1$21300=bridge$21239$21278[1]),((t1$21300 instanceof Array)&&((t2$21301=t1$21300.length),((t2$21301===2)&&((t1$21300[0]==="symbol")&&((t1$21300[1]==="=")&&((t3$21302=bridge$21239$21278[2]),((t3$21302 instanceof Array)&&((t4$21303=t3$21302.length),((t4$21303===3)&&((t3$21302[0]==="data")&&((t5$21304=t3$21302[1]),((t5$21304 instanceof Array)&&((t6$21305=t5$21304.length),((t6$21305===3)&&((t5$21304[0]==="send")&&((t7$21306=t5$21304[1]),((t7$21306 instanceof Array)&&((t8$21307=t7$21306.length),((t8$21307===2)&&((t7$21306[0]==="symbol")&&((t7$21306[1]==="constructor")&&((args$21295=t5$21304[2]),((body$21296=t3$21302[2]),true))))))))))))))))))))))))))))||((bridge$21239$21278 instanceof Array)&&((t0$21320=bridge$21239$21278.length),((t0$21320===3)&&((bridge$21239$21278[0]==="send")&&((t1$21321=bridge$21239$21278[1]),((t1$21321 instanceof Array)&&((t2$21322=t1$21321.length),((t2$21322===2)&&((t1$21321[0]==="symbol")&&((t1$21321[1]==="=")&&((t3$21323=bridge$21239$21278[2]),((t3$21323 instanceof Array)&&((t4$21324=t3$21323.length),((t4$21324===3)&&((t3$21323[0]==="data")&&((t5$21325=t3$21323[1]),((t5$21325 instanceof Array)&&((t6$21326=t5$21325.length),((t6$21326===2)&&((t5$21325[0]==="symbol")&&((t5$21325[1]==="constructor")&&((t7$21327=t3$21323[2]),((t7$21327 instanceof Array)&&((t8$21328=t7$21327.length),((t8$21328===3)&&((t7$21327[0]==="send")&&((t9$21329=t7$21327[1]),((t9$21329 instanceof Array)&&((t10$21330=t9$21329.length),((t10$21330===2)&&((t9$21329[0]==="symbol")&&((t9$21329[1]==="->")&&((t11$21331=t7$21327[2]),((t11$21331 instanceof Array)&&((t12$21332=t11$21331.length),((t12$21332===3)&&((t11$21331[0]==="data")&&((args$21295=t11$21331[1]),((body$21296=t11$21331[2]),true))))))))))))))))))))))))))))))))))))))))){acc$21241.push(((ctor$21223=[args$21295,body$21296]),["splice"]));}else{(t0$21269=m$21264);if(((t0$21269 instanceof Array)&&((t1$21270=t0$21269.length),((t1$21270===3)&&((t0$21269[0]==="send")&&((t2$21271=t0$21269[1]),((t2$21271 instanceof Array)&&((t3$21272=t2$21271.length),((t3$21272===2)&&((t2$21271[0]==="symbol")&&((t2$21271[1]==="=")&&((t4$21273=t0$21269[2]),((t4$21273 instanceof Array)&&((t5$21274=t4$21273.length),((t5$21274===3)&&(t4$21273[0]==="data")))))))))))))))){(lhs$21352=t4$21273[1]);(rhs$21353=t4$21273[2]);acc$21241.push(parse_pattern$16193(scope$21199,lhs$21352,rhs$21353,$22989(pattern_handlers$16223.build_object,$16134(({"allow_nested":false}),$16134(((accum$21362=({})),((accum$21362["assign"]=function($21365$21368,value$21369){var t0$21376;var t0$21380;var bridge$21366$21373;var v$21371;(bridge$21366$21373=$21365$21368);if((((bridge$21366$21373 instanceof Array)&&((t0$21376=bridge$21366$21373.length),((t0$21376===2)&&((bridge$21366$21373[0]==="symbol")&&((v$21371=bridge$21366$21373[1]),true)))))||((bridge$21366$21373 instanceof Array)&&((t0$21380=bridge$21366$21373.length),((t0$21380===2)&&((bridge$21366$21373[0]==="value")&&((v$21371=bridge$21366$21373[1]),true))))))){;}else{$22976($21365$21368);}return ["do",__lt____lt____colon__$16186(["assign",["send",["send",name$21217,["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value",v$21371]],value$21369],v$21371)];}),accum$21362)),$16134(((accum$21386=({})),((accum$21386["declare"]=function(vars$21390){return [];}),accum$21386)),$16134(((accum$21393=({})),((accum$21393["wrap_target"]=function($21396$21398){var t0$21433;var other_env$21429;var it$21430;var it2$21431;var other$21445;var args$21419;var body$21420;var t0$21411;var t1$21412;var t2$21413;var t3$21414;var t4$21415;var $21400$21406;var ph$21401;(ph$21401=$21396$21398);;($21400$21406=ph$21401);;if((($21400$21406 instanceof Array)&&((t0$21411=$21400$21406.length),((t0$21411===3)&&(($21400$21406[0]==="send")&&((t1$21412=$21400$21406[1]),((t1$21412 instanceof Array)&&((t2$21413=t1$21412.length),((t2$21413===2)&&((t1$21412[0]==="symbol")&&((t1$21412[1]==="->")&&((t3$21414=$21400$21406[2]),((t3$21414 instanceof Array)&&((t4$21415=t3$21414.length),((t4$21415===3)&&(t3$21414[0]==="data")))))))))))))))){(args$21419=t3$21414[1]);(body$21420=t3$21414[2]);(t0$21433=body$21420);if($22747(t0$21433,"env")){(other_env$21429=t0$21433.env);;}else{$22976(body$21420,"/home/olivier/git/earl-grey/src/stdenv.eg",28579,28583);}(it$21430=$22989(["symbol","@"],({"env":other_env$21429})));;(it2$21431=$22989(["symbol","self"],({"env":other_env$21429})));;return ["send",["symbol","->"],["data",args$21419,["send",["symbol","let"],["data",["multi",["send",["symbol","="],["data",it$21430,["symbol","this"]]],["send",["symbol","="],["data",it2$21431,["symbol","this"]]]],body$21420]]]];}else{(other$21445=$21400$21406);return other$21445;}}),accum$21393)),((accum$21448=({})),((accum$21448["success"]=function($21451$21453){$21451$21453;;return ["splice"];}),accum$21448)))))))));}else{$22976(m$21264,"/home/olivier/git/earl-grey/src/stdenv.eg",27848,29002);;}}}}}()))),acc$21241));;(t0$21462=ctor$21223);if(((t0$21462 instanceof Array)&&((t1$21463=t0$21462.length),(t1$21463===2)))){(ctor_args$21225=t0$21462[0]);(ctor_body$21226=t0$21462[1]);;}else{$22976(ctor$21223,"/home/olivier/git/earl-grey/src/stdenv.eg",29027,29031);}(ctor_body$21226=(((t0$21472=ctor_body$21226),function(){if($22747(t0$21472,"env")){(env2$21469=t0$21472.env);}else{return $22976(ctor_body$21226,"/home/olivier/git/earl-grey/src/stdenv.eg",29082,29091);}}()),((it$21470=$22989(["symbol","@"],({"env":env2$21469})))),["send",["symbol","let"],["data",["send",["symbol","="],["data",it$21470,["send",["symbol","if"],["data",["send",["symbol","not"],["data",["void"],["send",["symbol","?"],["data",name$21217,["symbol","this"]]]]],["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","create"]]]],["data",["send",name$21217,["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]],["symbol","this"]]]]],["multi",ctor_body$21226,it$21470]]]));(t0$21480=name$21217);if(((t0$21480 instanceof Array)&&((t1$21481=t0$21480.length),((t1$21481===2)&&(t0$21480[0]==="symbol"))))){(name_str$21227=t0$21480[1]);;}else{$22976(name$21217,"/home/olivier/git/earl-grey/src/stdenv.eg",29307,29311);}statics$21222.push(["send",["symbol","="],["data",["value","::name"],["value",name_str$21227]]]);statics$21222.push(["send",["symbol","="],["data",["value","::egclass"],["symbol","true"]]]);(node$21228=["splice",["send",["symbol","="],["data",name$21217,["send",["symbol","->"],["data",ctor_args$21225,ctor_body$21226]]]]].concat(new_stmts$21224).concat([["send",["symbol","&:"],["data",name$21217,statics$21222]],name$21217]));;($21221$21490=context$21198);;if((($21221$21490 instanceof Array)&&((t0$21495=$21221$21490.length),((t0$21495===2)&&(($21221$21490[0]==="expr")&&($21221$21490[1]==="multi")))))){return node$21228;}else{(other$21504=$21221$21490);return ["multi",node$21228];}});;($21210$21508=expr$21201);;if((($21211$21518=($21210$21508 instanceof Array))&&((t0$21513=$21210$21508.length),((t0$21513===3)&&(($21210$21508[0]==="data")&&((name$21522=$21210$21508[1]),((t1$21514=$23061(["multi"])($21210$21508[2])),(t1$21514[0]&&((t2$21515=t1$21514[1]),((t3$21516=t2$21515.length),(t3$21516>=0))))))))))){(stmts$21523=Array.prototype.slice.call(t2$21515,0));return helper$21213(name$21522,stmts$21523);}else{if(($21211$21518&&((t0$21513===2)&&(($21210$21508[0]==="data")&&((t1$21514=$23061(["multi"])($21210$21508[1])),(t1$21514[0]&&((t2$21515=t1$21514[1]),((t3$21516=t2$21515.length),(t3$21516>=0))))))))){(stmts$21533=Array.prototype.slice.call(t2$21515,0));return helper$21213(["symbol",scope$21199.gensym()],stmts$21533);}else{$22976($21210$21508);}}}),accum$21193)),$16134(((accum$21542=({})),((accum$21542["%"]=function(context$21547,scope$21548,form$21549,$21545$21550){var t0$21555;var t1$21556;var x$21738;var args$21733;var $21714$21724;var $21715$21725;var t0$21722;var $21713$21717;var tags$21562;var parse$21563;var descr$21552;var contents$21553;(t0$21555=$21545$21550);if(((t0$21555 instanceof Array)&&((t1$21556=t0$21555.length),((t1$21556===3)&&(t0$21555[0]==="data"))))){(descr$21552=t0$21555[1]);(contents$21553=t0$21555[2]);;}else{$22976($21545$21550);}(tags$21562=["data"]);;(parse$21563=function($21569$21571){var t0$21590;var t0$21647;var t0$21651;var t0$21665;var t0$21669;var t0$21682;var t0$21686;var t0$21702;var t0$21706;var args$21699;var expr$21692;var rest$21693;var prop$21675;var value$21676;var x$21657;var x$21637;var x$21632;var s$21627;var $21578$21611;var $21579$21612;var $21580$21613;var $21581$21614;var $21582$21615;var $21583$21616;var $21584$21617;var $21585$21618;var $21586$21619;var t0$21599;var t1$21600;var t2$21601;var t3$21602;var t4$21603;var t5$21604;var t6$21605;var bridge$21574$21606;var bridge$21575$21607;var bridge$21576$21608;var bridge$21577$21609;var $21573$21594;var ph$21587;var toparse$21588;(t0$21590=$21569$21571);(toparse$21588=t0$21590);(ph$21587=t0$21590);;($21573$21594=ph$21587);;if((($21578$21611=($21573$21594 instanceof Array))&&((t0$21599=$21573$21594.length),((t0$21599===1)&&($21573$21594[0]==="void"))))){return null;}else{if(($21578$21611&&(($21580$21613=(t0$21599===2))&&($21573$21594[0]==="symbol")))){(s$21627=$21573$21594[1]);return tags$21562.push(["value",("+"+s$21627)]);}else{if(($21580$21613&&($21573$21594[0]==="value"))){(x$21632=$21573$21594[1]);return tags$21562.push(["value",("+"+x$21632)]);}else{if(($21578$21611&&(($21580$21613=(t0$21599===3))&&(($21581$21614=($21573$21594[0]==="send"))&&((t1$21600=$21573$21594[1]),(($21583$21616=(t1$21600 instanceof Array))&&((t2$21601=t1$21600.length),(($21585$21618=(t2$21601===2))&&(($21586$21619=(t1$21600[0]==="symbol"))&&((t1$21600[1]===".")&&((t3$21602=$21573$21594[2]),((t3$21602 instanceof Array)&&((t4$21603=t3$21602.length),((t4$21603===3)&&((t3$21602[0]==="data")&&((t5$21604=t3$21602[1]),((t5$21604 instanceof Array)&&((t6$21605=t5$21604.length),((t6$21605===1)&&((t5$21604[0]==="void")&&((bridge$21574$21606=t3$21602[2]),(((bridge$21574$21606 instanceof Array)&&((t0$21647=bridge$21574$21606.length),((t0$21647===2)&&((bridge$21574$21606[0]==="symbol")&&((x$21637=bridge$21574$21606[1]),true)))))||((bridge$21574$21606 instanceof Array)&&((t0$21651=bridge$21574$21606.length),((t0$21651===2)&&((bridge$21574$21606[0]==="value")&&((x$21637=bridge$21574$21606[1]),true))))))))))))))))))))))))))){return tags$21562.push(["value",x$21637]);}else{if(($21586$21619&&((t1$21600[1]==="#")&&((t3$21602=$21573$21594[2]),((t3$21602 instanceof Array)&&((t4$21603=t3$21602.length),((t4$21603===3)&&((t3$21602[0]==="data")&&((t5$21604=t3$21602[1]),((t5$21604 instanceof Array)&&((t6$21605=t5$21604.length),((t6$21605===1)&&((t5$21604[0]==="void")&&((bridge$21575$21607=t3$21602[2]),(((bridge$21575$21607 instanceof Array)&&((t0$21665=bridge$21575$21607.length),((t0$21665===2)&&((bridge$21575$21607[0]==="symbol")&&((x$21657=bridge$21575$21607[1]),true)))))||((bridge$21575$21607 instanceof Array)&&((t0$21669=bridge$21575$21607.length),((t0$21669===2)&&((bridge$21575$21607[0]==="value")&&((x$21657=bridge$21575$21607[1]),true)))))))))))))))))))){return tags$21562.push(["value",("#"+x$21657)]);}else{if(($21586$21619&&((t1$21600[1]==="=")&&((t3$21602=$21573$21594[2]),((t3$21602 instanceof Array)&&((t4$21603=t3$21602.length),((t4$21603===3)&&((t3$21602[0]==="data")&&((bridge$21576$21608=t3$21602[1]),(((bridge$21576$21608 instanceof Array)&&((t0$21682=bridge$21576$21608.length),((t0$21682===2)&&((bridge$21576$21608[0]==="symbol")&&((prop$21675=bridge$21576$21608[1]),true)))))||((bridge$21576$21608 instanceof Array)&&((t0$21686=bridge$21576$21608.length),((t0$21686===2)&&((bridge$21576$21608[0]==="value")&&((prop$21675=bridge$21576$21608[1]),true))))))))))))))){(value$21676=t3$21602[2]);return tags$21562.push(["send",["send",["symbol","#"],["data",["void"],["symbol","assoc"]]],["data",["value",prop$21675],value$21676]]);}else{if($21581$21614){(expr$21692=$21573$21594[1]);(rest$21693=$21573$21594[2]);parse$21563(expr$21692);return parse$21563(rest$21693);}else{(bridge$21577$21609=$21573$21594);if((((bridge$21577$21609 instanceof Array)&&((t0$21702=bridge$21577$21609.length),((t0$21702>=1)&&((bridge$21577$21609[0]==="multi")&&((args$21699=Array.prototype.slice.call(bridge$21577$21609,1)),true)))))||((bridge$21577$21609 instanceof Array)&&((t0$21706=bridge$21577$21609.length),((t0$21706>=1)&&((bridge$21577$21609[0]==="data")&&((args$21699=Array.prototype.slice.call(bridge$21577$21609,1)),true))))))){return args$21699.forEach(parse$21563);}else{$22976($21573$21594);}}}}}}}}});;parse$21563(descr$21552);(contents$21553=((($21713$21717=contents$21553)),function(){if((($21714$21724=($21713$21717 instanceof Array))&&((t0$21722=$21713$21717.length),((t0$21722===1)&&($21713$21717[0]==="void"))))){return ["data"];}else{if(($21714$21724&&((t0$21722>=1)&&($21713$21717[0]==="multi")))){(args$21733=Array.prototype.slice.call($21713$21717,1));return ["data"].concat(args$21733);}else{(x$21738=$21713$21717);return x$21738;}}}()));return ["send",["symbol","Node"],["data",tags$21562,contents$21553]];}),accum$21542)),((accum$21741=({})),((accum$21741["globals"]=function(context$21746,scope$21747,form$21748,$21744$21749){var t0$21753;var t1$21754;var t2$21755;var t3$21756;var t4$21757;var $index$21784;var $length$21779;var temp$21774;var acc$21769;var vars$21751;(t0$21753=$21744$21749);if(((t0$21753 instanceof Array)&&((t1$21754=t0$21753.length),((t1$21754===2)&&((t0$21753[0]==="data")&&((t2$21755=$23061(["multi"])(t0$21753[1])),(t2$21755[0]&&((t3$21756=t2$21755[1]),((t4$21757=t3$21756.length),(t4$21757>=0)))))))))){(vars$21751=Array.prototype.slice.call(t3$21756,0));;}else{$22976($21744$21749);}return ["splice"].concat((((acc$21769=[])),(((temp$21774=vars$21751)),((($length$21779=temp$21774.length)),((($index$21784=0)),function(){$21766:for(;($index$21784<$length$21779);($index$21784++)){var variable$21802;var s$21803;var t0$21797;var t1$21798;var m$21792;(m$21792=temp$21774[$index$21784]);;(t0$21797=m$21792);(variable$21802=t0$21797);if(((t0$21797 instanceof Array)&&((t1$21798=t0$21797.length),((t1$21798===2)&&(t0$21797[0]==="symbol"))))){(s$21803=t0$21797[1]);acc$21769.push(["declare_raw",variable$21802,["variable",s$21803]]);}else{$22976(m$21792,"/home/olivier/git/earl-grey/src/stdenv.eg",30951,31038);;}}}()))),acc$21769));}),accum$21741)))))))))))))))))))))))))))))))))))))))))))))))))));;($length$21811=temp$17366.length);;($index$21816=0);;$16237:for(;($index$21816<$length$21811);($index$21816++)){var k$21834;var v$21835;var t0$21829;var t1$21830;var m$21824;(m$21824=temp$17366[$index$21816]);;(t0$21829=m$21824);if(((t0$21829 instanceof Array)&&((t1$21830=t0$21829.length),(t1$21830===2)))){(k$21834=t0$21829[0]);(v$21835=t0$21829[1]);stdenv$16204.bind(topscope$16208,k$21834,["macro",v$21835]);}else{$22976(m$21824,"/home/olivier/git/earl-grey/src/stdenv.eg",8112,8178);;}}(blocktest_wrap$16227=function(expr$21844){return ["multi",["send",["symbol","="],["data",["symbol","value"],["send",["symbol","!!"],["data",["multi",["send",["symbol","match"],["data",expr$21844,["multi",["send",["symbol","->"],["data",["send",["symbol","?"],["data",["symbol","true"],["symbol","x"]]],["send",["send",["symbol","#"],["data",["void"],["symbol","success"]]],["data",["symbol","x"]]]]],["send",["symbol","->"],["data",["send",["symbol","?"],["data",["symbol","false"],["symbol","x"]]],["send",["send",["symbol","#"],["data",["void"],["symbol","failure"]]],["data",["symbol","x"]]]]]]]]],["send",["symbol","->"],["data",["symbol","e"],["send",["send",["symbol","#"],["data",["void"],["symbol","error"]]],["data",["symbol","e"]]]]]]]]],["send",["send",["symbol","acc"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",["send",["send",["symbol","#"],["data",["void"],["symbol","test_result"]]],["data",["symbol","label"],["symbol","value"]]]]]];});;(blocktest_mac$16228=function(scope$21850,tests$21851){var $index$21887;var $length$21882;var temp$21877;var acc$21872;var exptests$21854;var n$21855;var stmts$21856;(exptests$21854=$22954(scope$21850.step_all(["test"],tests$21851)));;(n$21855=exptests$21854.length);;(stmts$21856=(((acc$21872=[])),(((temp$21877=exptests$21854)),((($length$21882=temp$21877.length)),((($index$21887=0)),function(){$21865:for(;($index$21887<$length$21882);($index$21887++)){var wrap$21943;var fall$21944;var lbl$21965;var i$21960;var expr$21961;var i$21931;var elements$21932;var clauses$21933;var env$21934;var i$21921;var more_labels$21922;var more_tests$21923;var i$21911;var stmt$21912;var $21867$21905;var $21868$21906;var $21869$21907;var $21870$21908;var t0$21900;var t1$21901;var t2$21902;var t3$21903;var m$21895;(m$21895=temp$21877[$index$21887]);;(t0$21900=m$21895);if((($21868$21906=(t0$21900 instanceof Array))&&((t1$21901=t0$21900.length),(($21870$21908=(t1$21901===2))&&((i$21911=t0$21900[0]),((t2$21902=t0$21900[1]),((t2$21902 instanceof Array)&&((t3$21903=t2$21902.length),((t3$21903===2)&&(t2$21902[0]==="do")))))))))){(stmt$21912=t2$21902[1]);acc$21872.push(stmt$21912);}else{if(($21870$21908&&((i$21921=t0$21900[0]),((t2$21902=t0$21900[1]),((t2$21902 instanceof Array)&&((t3$21903=t2$21902.length),((t3$21903===3)&&(t2$21902[0]==="blocktest")))))))){(more_labels$21922=t2$21902[1]);(more_tests$21923=t2$21902[2]);acc$21872.push(["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","label"],["send",["send",["symbol","label"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",["send",["symbol","!"],["data",["symbol","Array"],more_labels$21922]]]]]],["send",["symbol",":="],["data",["symbol","acc"],["send",["send",["symbol","acc"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",blocktest_mac$16228(scope$21850,more_tests$21923)]]]]]]);}else{if(($21870$21908&&((i$21931=t0$21900[0]),((t2$21902=t0$21900[1]),((t2$21902 instanceof Array)&&((t3$21903=t2$21902.length),((t3$21903===3)&&((t2$21902[0]==="test_factory")&&((elements$21932=t2$21902[1]),((clauses$21933=t2$21902[2]),$22747(t2$21902,"env"))))))))))){(env$21934=t2$21902.env);acc$21872.push((((wrap$21943=function(expr$21948,index$21949){return ["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","label"],["send",["send",["symbol","label"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",["data",index$21949]]]]],blocktest_wrap$16227(expr$21948)]];})),((fall$21944=function(target$21955){return match_error$16211(target$21955);})),build_loop$16224(scope$21850,env$21934,["void"],elements$21932,clauses$21933,wrap$21943,["splice"],["splice"],({"fallback":fall$21944}))));}else{if($21870$21908){(i$21960=t0$21900[0]);(expr$21961=t0$21900[1]);acc$21872.push((((lbl$21965=function(){if((n$21855===1)){return ["data"];}else{return ["data",["value",i$21960]];}}())),["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","label"],["send",["send",["symbol","label"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",lbl$21965]]]],blocktest_wrap$16227(expr$21961)]]));}else{$22976(m$21895,"/home/olivier/git/earl-grey/src/stdenv.eg",31375,32181);;}}}}}}()))),acc$21872));;return ["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","acc"],["data"]]],["send",["symbol","!!"],["data",["multi"].concat(stmts$21856).concat([["symbol","acc"]]),["send",["symbol","->"],["data",["symbol","e"],["send",["send",["symbol","acc"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",["data",["send",["send",["symbol","#"],["data",["void"],["symbol","error"]]],["data",["symbol","label"],["symbol","e"]]]]]]]]]]]];});;stdenv$16204.bind(topscope$16208,"blocktest",["macro",function(context$21975,scope$21976,form$21977,$21973$21978){var t0$21985;var t1$21986;var labels$22015;var tests$22016;var tests$22006;var $21981$22002;var $21982$22003;var t0$21997;var t1$21998;var t2$21999;var t3$22000;var $21980$21992;var args$21983;(t0$21985=$21973$21978);if(((t0$21985 instanceof Array)&&((t1$21986=t0$21985.length),((t1$21986>=1)&&(t0$21985[0]==="data"))))){(args$21983=Array.prototype.slice.call(t0$21985,1));;}else{$22976($21973$21978);}($21980$21992=args$21983);;if((($21981$22002=($21980$21992 instanceof Array))&&((t0$21997=$21980$21992.length),((t0$21997===1)&&((t1$21998=$23061(["multi"])($21980$21992[0])),(t1$21998[0]&&((t2$21999=t1$21998[1]),((t3$22000=t2$21999.length),(t3$22000>=0))))))))){(tests$22006=Array.prototype.slice.call(t2$21999,0));return ["multi",["send",["symbol","="],["data",["symbol","label"],["data"]]],blocktest_mac$16228(scope$21976,tests$22006)];}else{if(($21981$22002&&((t0$21997===2)&&((labels$22015=$21980$21992[0]),((t1$21998=$23061(["multi"])($21980$21992[1])),(t1$21998[0]&&((t2$21999=t1$21998[1]),((t3$22000=t2$21999.length),(t3$22000>=0))))))))){(tests$22016=Array.prototype.slice.call(t2$21999,0));return ["multi",["send",["symbol","="],["data",["symbol","label"],["send",["symbol","!"],["data",["symbol","Array"],labels$22015]]]],blocktest_mac$16228(scope$21976,tests$22016)];}else{$22976($21980$21992);}}}]);(qqstruct$16229=function(name$22028,args$22029){return ["data",["value",name$22028]].concat(args$22029);});;(qq$16230=function($22034$22036){var t0$22051;var $index$22145;var $length$22140;var temp$22135;var acc$22130;var name$22123;var args$22124;var insert$22114;var insert$22105;var insert$22094;var v$22089;var s$22079;var $22039$22068;var $22040$22069;var $22041$22070;var $22042$22071;var $22043$22072;var $22044$22073;var $22045$22074;var $22046$22075;var $22047$22076;var t0$22060;var t1$22061;var t2$22062;var t3$22063;var t4$22064;var t5$22065;var t6$22066;var $22038$22055;var ph$22048;var expr$22049;(t0$22051=$22034$22036);(expr$22049=t0$22051);(ph$22048=t0$22051);;($22038$22055=ph$22048);;if((($22039$22068=($22038$22055 instanceof Array))&&((t0$22060=$22038$22055.length),((t0$22060===2)&&($22038$22055[0]==="symbol"))))){(s$22079=$22038$22055[1]);return qqstruct$16229("symbol",[["value",s$22079]]);}else{if(($22039$22068&&((t0$22060===1)&&($22038$22055[0]==="void")))){return qqstruct$16229("void",[]);}else{if(($22039$22068&&((t0$22060===2)&&($22038$22055[0]==="value")))){(v$22089=$22038$22055[1]);return qqstruct$16229("value",[expr$22049]);}else{if(($22039$22068&&(($22041$22070=(t0$22060===3))&&(($22042$22071=($22038$22055[0]==="send"))&&((t1$22061=$22038$22055[1]),(($22044$22073=(t1$22061 instanceof Array))&&((t2$22062=t1$22061.length),(($22046$22075=(t2$22062===2))&&(($22047$22076=(t1$22061[0]==="symbol"))&&((t1$22061[1]==="^")&&((t3$22063=$22038$22055[2]),((t3$22063 instanceof Array)&&((t4$22064=t3$22063.length),((t4$22064===3)&&((t3$22063[0]==="data")&&((t5$22065=t3$22063[1]),((t5$22065 instanceof Array)&&((t6$22066=t5$22065.length),((t6$22066===1)&&(t5$22065[0]==="void")))))))))))))))))))){(insert$22094=t3$22063[2]);return insert$22094;}else{if(($22047$22076&&((t1$22061[1]==="^=")&&((t3$22063=$22038$22055[2]),((t3$22063 instanceof Array)&&((t4$22064=t3$22063.length),((t4$22064===3)&&((t3$22063[0]==="data")&&((t5$22065=t3$22063[1]),((t5$22065 instanceof Array)&&((t6$22066=t5$22065.length),((t6$22066===1)&&(t5$22065[0]==="void"))))))))))))){(insert$22105=t3$22063[2]);return qqstruct$16229("value",[insert$22105]);}else{if(($22047$22076&&((t1$22061[1]==="^*")&&((t3$22063=$22038$22055[2]),((t3$22063 instanceof Array)&&((t4$22064=t3$22063.length),((t4$22064===3)&&((t3$22063[0]==="data")&&((t5$22065=t3$22063[1]),((t5$22065 instanceof Array)&&((t6$22066=t5$22065.length),((t6$22066===1)&&(t5$22065[0]==="void"))))))))))))){(insert$22114=t3$22063[2]);return ["send",["symbol","*"],["data",["void"],insert$22114]];}else{if(($22039$22068&&(t0$22060>=1))){(name$22123=$22038$22055[0]);(args$22124=Array.prototype.slice.call($22038$22055,1));return qqstruct$16229(name$22123,(((acc$22130=[])),(((temp$22135=args$22124)),((($length$22140=temp$22135.length)),((($index$22145=0)),function(){$22127:for(;($index$22145<$length$22140);($index$22145++)){var arg$22161;var m$22153;(m$22153=temp$22135[$index$22145]);;(arg$22161=m$22153);acc$22130.push(qq$16230(arg$22161));}}()))),acc$22130));}else{$22976($22038$22055);}}}}}}}});;stdenv$16204.bind(topscope$16208,"'",["macro",function(context$22168,scope$22169,form$22170,$22166$22171){var t0$22175;var t1$22176;var t2$22177;var t3$22178;var expr$22173;(t0$22175=$22166$22171);if(((t0$22175 instanceof Array)&&((t1$22176=t0$22175.length),((t1$22176===3)&&((t0$22175[0]==="data")&&((t2$22177=t0$22175[1]),((t2$22177 instanceof Array)&&((t3$22178=t2$22177.length),((t3$22178===1)&&(t2$22177[0]==="void")))))))))){(expr$22173=t0$22175[2]);;}else{$22976($22166$22171);}return qq$16230(expr$22173);}]);(RegexBuilder$16231=function(){var it$0$22190;(it$0$22190=function(){if((!$16118(RegexBuilder$16231)(this))){return Object.create(RegexBuilder$16231.prototype);}else{return this;}}());;;return it$0$22190;});;(RegexBuilder$16231.prototype["wrap"]=function(x$22200){var self$22208;var it$0$22203;(it$0$22203=this);;(self$22208=this);;return (("(?:"+x$22200)+")");});(RegexBuilder$16231.prototype["quote"]=function(x$22215){var self$22223;var it$0$22218;(it$0$22218=this);;(self$22223=this);;return x$22215.replace(RegExp("([.?*+\\^$\\[\\]\\(\\)\\{\\}|\\\\])","g"),"\\$1");});(RegexBuilder$16231.prototype["quote_charset"]=function(x$22230){var self$22238;var it$0$22233;(it$0$22233=this);;(self$22238=this);;return x$22230.replace(RegExp("([\\[\\]\\(\\)\\{\\}\\^])","g"),"\\$1");});(RegexBuilder$16231.prototype["build"]=function(expr$22245){var t0$22392;var t1$22393;var t0$22404;var t1$22405;var t0$22416;var t1$22417;var t0$22429;var t1$22430;var t0$22436;var t1$22437;var x$22443;var v$22427;var t0$22454;var t1$22455;var t0$22461;var t1$22462;var t2$22463;var t3$22464;var t4$22465;var t5$22466;var t6$22467;var t7$22468;var t8$22469;var t9$22470;var x$22484;var v$22452;var $index$22521;var $length$22516;var temp$22511;var acc$22506;var $index$22570;var $length$22565;var temp$22560;var acc$22555;var other$22590;var args$22541;var args$22492;var a$22368;var b$22369;var $22255$22370;var s$22359;var x$22354;var $22254$22292;var $22256$22281;var $22257$22282;var $22258$22283;var $22259$22284;var $22260$22285;var $22261$22286;var $22262$22287;var $22263$22288;var $22264$22289;var t0$22275;var t1$22276;var t2$22277;var t3$22278;var t4$22279;var $22253$22270;var self$22265;var it$0$22248;(it$0$22248=this);;(self$22265=this);;($22253$22270=expr$22245);;if((($22256$22281=($22253$22270 instanceof Array))&&((t0$22275=$22253$22270.length),(($22258$22283=(t0$22275===2))&&($22253$22270[0]==="symbol"))))){($22254$22292=$22253$22270[1]);if(($22254$22292==="any")){return ".";}else{if(($22254$22292==="start")){return "^";}else{if(($22254$22292==="end")){return "$";}else{if(($22254$22292==="alpha")){return "\\a";}else{if(($22254$22292==="digit")){return "\\d";}else{if(($22254$22292==="word")){return "\\w";}else{if(($22254$22292==="space")){return "\\s";}else{if(($22254$22292==="boundary")){return "\\b";}else{if(($22254$22292==="a")){return "\\a";}else{if(($22254$22292==="d")){return "\\d";}else{if(($22254$22292==="w")){return "\\w";}else{if(($22254$22292==="s")){return "\\s";}else{if(($22254$22292==="b")){return "\\b";}else{$22976($22254$22292,"/home/olivier/git/earl-grey/src/stdenv.eg",33475,33480);}}}}}}}}}}}}}}else{if(($22258$22283&&($22253$22270[0]==="value"))){(x$22354=$22253$22270[1]);return it$0$22248.quote(x$22354);}else{if(($22256$22281&&(($22258$22283=(t0$22275===3))&&(($22259$22284=($22253$22270[0]==="send"))&&((t1$22276=$22253$22270[1]),(($22261$22286=(t1$22276 instanceof Array))&&((t2$22277=t1$22276.length),(($22263$22288=(t2$22277===2))&&(($22264$22289=(t1$22276[0]==="symbol"))&&((t1$22276[1]==="raw")&&((t3$22278=$22253$22270[2]),((t3$22278 instanceof Array)&&((t4$22279=t3$22278.length),((t4$22279===2)&&(t3$22278[0]==="value"))))))))))))))){(s$22359=t3$22278[1]);return s$22359;}else{if(($22264$22289&&(($22255$22370=t1$22276[1]),((t3$22278=$22253$22270[2]),((t3$22278 instanceof Array)&&((t4$22279=t3$22278.length),((t4$22279===3)&&(t3$22278[0]==="data")))))))){(a$22368=t3$22278[1]);(b$22369=t3$22278[2]);if(($22255$22370==="||")){return it$0$22248.wrap(((it$0$22248.build(a$22368)+"|")+it$0$22248.build(b$22369)));}else{if(($22255$22370==="or")){return it$0$22248.wrap(((it$0$22248.build(a$22368)+"|")+it$0$22248.build(b$22369)));}else{if(($22255$22370==="*")){(t0$22392=a$22368);if(((t0$22392 instanceof Array)&&((t1$22393=t0$22392.length),((t1$22393===1)&&(t0$22392[0]==="void"))))){;}else{$22976(a$22368,"/home/olivier/git/earl-grey/src/stdenv.eg",34147,34148);}return it$0$22248.wrap((it$0$22248.build(b$22369)+"*"));}else{if(($22255$22370==="+")){(t0$22404=a$22368);if(((t0$22404 instanceof Array)&&((t1$22405=t0$22404.length),((t1$22405===1)&&(t0$22404[0]==="void"))))){;}else{$22976(a$22368,"/home/olivier/git/earl-grey/src/stdenv.eg",34231,34232);}return it$0$22248.wrap((it$0$22248.build(b$22369)+"+"));}else{if(($22255$22370==="?")){(t0$22416=a$22368);if(((t0$22416 instanceof Array)&&((t1$22417=t0$22416.length),((t1$22417===1)&&(t0$22416[0]==="void"))))){;}else{$22976(a$22368,"/home/olivier/git/earl-grey/src/stdenv.eg",34315,34316);}return it$0$22248.wrap((it$0$22248.build(b$22369)+"?"));}else{if(($22255$22370==="in")){(t0$22429=a$22368);if(((t0$22429 instanceof Array)&&((t1$22430=t0$22429.length),((t1$22430===1)&&(t0$22429[0]==="void"))))){;}else{$22976(a$22368,"/home/olivier/git/earl-grey/src/stdenv.eg",34400,34401);}(t0$22436=b$22369);if(((t0$22436 instanceof Array)&&((t1$22437=t0$22436.length),((t1$22437===2)&&(t0$22436[0]==="value"))))){(v$22427=t0$22436[1]);;}else{$22976(b$22369,"/home/olivier/git/earl-grey/src/stdenv.eg",34429,34430);}(x$22443=it$0$22248.quote_charset(v$22427));;return (("["+x$22443)+"]");}else{if(($22255$22370==="not")){(t0$22454=a$22368);if(((t0$22454 instanceof Array)&&((t1$22455=t0$22454.length),((t1$22455===1)&&(t0$22454[0]==="void"))))){;}else{$22976(a$22368,"/home/olivier/git/earl-grey/src/stdenv.eg",34554,34555);}(t0$22461=b$22369);if(((t0$22461 instanceof Array)&&((t1$22462=t0$22461.length),((t1$22462===3)&&((t0$22461[0]==="send")&&((t2$22463=t0$22461[1]),((t2$22463 instanceof Array)&&((t3$22464=t2$22463.length),((t3$22464===2)&&((t2$22463[0]==="symbol")&&((t2$22463[1]==="in")&&((t4$22465=t0$22461[2]),((t4$22465 instanceof Array)&&((t5$22466=t4$22465.length),((t5$22466===3)&&((t4$22465[0]==="data")&&((t6$22467=t4$22465[1]),((t6$22467 instanceof Array)&&((t7$22468=t6$22467.length),((t7$22468===1)&&((t6$22467[0]==="void")&&((t8$22469=t4$22465[2]),((t8$22469 instanceof Array)&&((t9$22470=t8$22469.length),((t9$22470===2)&&(t8$22469[0]==="value")))))))))))))))))))))))))){(v$22452=t8$22469[1]);;}else{$22976(b$22369,"/home/olivier/git/earl-grey/src/stdenv.eg",34621,34622);}(x$22484=it$0$22248.quote_charset(v$22452));;return (("[^"+x$22484)+"]");}else{$22976($22255$22370,"/home/olivier/git/earl-grey/src/stdenv.eg",33939,33944);}}}}}}}}else{if(($22256$22281&&(($22258$22283=(t0$22275>=1))&&($22253$22270[0]==="data")))){(args$22492=Array.prototype.slice.call($22253$22270,1));return (("("+(((acc$22506=[])),(((temp$22511=args$22492)),((($length$22516=temp$22511.length)),((($index$22521=0)),function(){$22503:for(;($index$22521<$length$22516);($index$22521++)){var arg$22537;var m$22529;(m$22529=temp$22511[$index$22521]);;(arg$22537=m$22529);acc$22506.push(it$0$22248.build(arg$22537));}}()))),acc$22506).join(""))+")");}else{if(($22258$22283&&($22253$22270[0]==="multi"))){(args$22541=Array.prototype.slice.call($22253$22270,1));return (("(?:"+(((acc$22555=[])),(((temp$22560=args$22541)),((($length$22565=temp$22560.length)),((($index$22570=0)),function(){$22552:for(;($index$22570<$length$22565);($index$22570++)){var arg$22586;var m$22578;(m$22578=temp$22560[$index$22570]);;(arg$22586=m$22578);acc$22555.push(it$0$22248.build(arg$22586));}}()))),acc$22555).join(""))+")");}else{(other$22590=$22253$22270);return $22785(["syntax","regexp"]).create("Illegal regular expression",({"expr":expr$22245}));}}}}}}});$16134(RegexBuilder$16231,$16134(((accum$22593=({})),((accum$22593["::name"]="RegexBuilder"),accum$22593)),((accum$22597=({})),((accum$22597["::egclass"]=true),accum$22597))));RegexBuilder$16231;(build_regexp$16232=function(x$22603){return RegexBuilder$16231().build(x$22603);});;(mac$22607=function(context$22612,scope$22613,form$22614,$22610$22615,flags$22616){var arg$22650;var v$22643;var $22619$22639;var $22620$22640;var t0$22631;var t1$22632;var t2$22633;var t3$22634;var t4$22635;var t5$22636;var t6$22637;var $22618$22626;var ph$22621;(ph$22621=$22610$22615);;($22618$22626=ph$22621);;if((($22619$22639=($22618$22626 instanceof Array))&&((t0$22631=$22618$22626.length),((t0$22631===2)&&(($22618$22626[0]==="value")&&((t1$22632=$22618$22626[1]),(typeof(t1$22632)==="string"))))))){(v$22643=t1$22632);return ["send",["symbol","RegExp"],["data",["value",v$22643],["value",flags$22616.join("")]]];}else{if(($22619$22639&&((t0$22631===3)&&(($22618$22626[0]==="send")&&((t1$22632=$22618$22626[1]),((t1$22632 instanceof Array)&&((t2$22633=t1$22632.length),((t2$22633===2)&&((t1$22632[0]==="symbol")&&((t1$22632[1]==="'")&&((t3$22634=$22618$22626[2]),((t3$22634 instanceof Array)&&((t4$22635=t3$22634.length),((t4$22635===3)&&((t3$22634[0]==="data")&&((t5$22636=t3$22634[1]),((t5$22636 instanceof Array)&&((t6$22637=t5$22636.length),((t6$22637===1)&&(t5$22636[0]==="void")))))))))))))))))))){(arg$22650=t3$22634[2]);return ["send",["symbol","RegExp"],["data",["value",build_regexp$16232(arg$22650)],["value",flags$22616.join("")]]];}else{$22976($22618$22626);}}});;stdenv$16204.bind(topscope$16208,"R",["macro",accum_flags$16220(mac$22607,false)]);(errf_macro$16233=function(tags$22665){return function(context$22669,scope$22670,form$22671,$22667$22672){var other$22703;var args$22698;var $22675$22689;var $22676$22690;var t0$22687;var $22674$22682;var ph$22677;(ph$22677=$22667$22672);;($22674$22682=ph$22677);;if((($22675$22689=($22674$22682 instanceof Array))&&((t0$22687=$22674$22682.length),((t0$22687===1)&&($22674$22682[0]==="void"))))){return ["send",["symbol","ErrorFactory"],["data",["data"].concat(tags$22665)]];}else{if(($22675$22689&&((t0$22687>=1)&&($22674$22682[0]==="data")))){(args$22698=Array.prototype.slice.call($22674$22682,1));return ["send",["send",["send",["symbol","ErrorFactory"],["data",["data"].concat(tags$22665)]],["send",["symbol","."],["data",["void"],["symbol","create"]]]],["data"].concat(args$22698)];}else{(other$22703=$22674$22682);return ["macro",errf_macro$16233(tags$22665.concat([other$22703]))];}}};});;stdenv$16204.bind(topscope$16208,"E",["macro",errf_macro$16233([])]);(temp$22708=$23089(({"___build_array":Embedded$16203(["send",["symbol","->"],["data",["data",["symbol","arrays"]],["multi",["send",["symbol","="],["data",["symbol","results"],["data"]]],["send",["symbol","each"],["data",["symbol","arrays"],["send",["symbol","->"],["data",["symbol","a"],["send",["symbol",":="],["data",["symbol","results"],["send",["send",["symbol","results"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",["symbol","a"]]]]]]]]],["symbol","results"]]]]),"object":Embedded$16203(["send",["symbol","->"],["data",["data",["symbol","pairs"]],["multi",["send",["symbol","="],["data",["symbol","rval"],["data",["symbol","="]]]],["send",["symbol","each"],["data",["symbol","pairs"],["send",["symbol","->"],["data",["data",["symbol","k"],["symbol","v"]],["send",["symbol",":="],["data",["send",["symbol","rval"],["symbol","k"]],["symbol","v"]]]]]]],["symbol","rval"]]]]),"items":Embedded$16203(["send",["symbol","->"],["data",["data",["symbol","obj"]],["multi",["send",["symbol","="],["data",["symbol","results"],["data"]]],["send",["symbol","for"],["data",["send",["symbol","in"],["data",["symbol","k"],["symbol","obj"]]],["send",["symbol","if"],["data",["send",["send",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","hasOwnProperty"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","obj"],["symbol","k"]]],["send",["send",["symbol","results"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",["data",["symbol","k"],["send",["symbol","obj"],["symbol","k"]]]]]]]]],["symbol","results"]]]]),"keys":Embedded$16203(["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","keys"]]]]),"enumerate":Embedded$16203(["send",["symbol","->"],["data",["data",["symbol","arr"]],["multi",["send",["symbol","="],["data",["symbol","results"],["data"]]],["send",["symbol","="],["data",["symbol","l"],["send",["symbol","arr"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]],["send",["symbol","for"],["data",["multi",["send",["symbol","="],["data",["symbol","i"],["value",0]]],["send",["symbol","<"],["data",["symbol","i"],["symbol","l"]]],["send",["symbol","++"],["data",["symbol","i"],["void"]]]],["send",["send",["symbol","results"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",["data",["symbol","i"],["send",["symbol","arr"],["symbol","i"]]]]]]],["symbol","results"]]]]),"zip":Embedded$16203(["send",["symbol","->"],["data",["data",["symbol","xs"],["symbol","ys"]],["send",["symbol","each"],["data",["send",["symbol","enumerate"],["data",["symbol","xs"]]],["send",["symbol","->"],["data",["data",["symbol","i"],["symbol","x"]],["data",["symbol","x"],["send",["symbol","ys"],["symbol","i"]]]]]]]]]),"predicate":Embedded$16203(["send",["symbol","->"],["data",["data",["symbol","f"]],["multi",["send",["symbol",":="],["data",["send",["symbol","f"],["value","::check"]],["symbol","f"]]],["symbol","f"]]]]),"___nequal":Embedded$16203(["send",["symbol","->"],["data",["data",["symbol","x"],["symbol","y"]],["send",["symbol","not"],["data",["void"],["send",["symbol","=="],["data",["symbol","x"],["symbol","y"]]]]]]]),"___equal":Embedded$16203(["send",["symbol","->"],["data",["data",["send",["symbol","match"],["symbol","a"]],["symbol","b"]],["multi",["send",["symbol","->"],["data",["send",["symbol","==="],["data",["void"],["symbol","b"]]],["symbol","true"]]],["send",["symbol","->"],["data",["send",["symbol","or"],["data",["send",["symbol","or"],["data",["send",["symbol","or"],["data",["send",["symbol","?"],["data",["symbol","Number"],["void"]]],["send",["symbol","?"],["data",["symbol","String"],["void"]]]]],["send",["symbol","?"],["data",["symbol","null"],["void"]]]]],["send",["symbol","?"],["data",["symbol","undefined"],["void"]]]]],["symbol","false"]]],["send",["symbol","->"],["data",["send",["symbol","?"],["data",["symbol","Array"],["void"]]],["multi",["send",["symbol","if"],["data",["send",["symbol","or"],["data",["send",["symbol","not"],["data",["void"],["send",["symbol","?"],["data",["symbol","Array"],["symbol","b"]]]]],["send",["symbol","!=="],["data",["send",["symbol","a"],["send",["symbol","."],["data",["void"],["symbol","length"]]]],["send",["symbol","b"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]]]],["send",["symbol","return"],["symbol","false"]]]],["send",["symbol","for"],["data",["multi",["send",["symbol","="],["data",["symbol","i"],["value",0]]],["send",["symbol","<"],["data",["symbol","i"],["send",["symbol","a"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]],["send",["symbol","++"],["data",["symbol","i"],["void"]]]],["send",["symbol","if"],["data",["send",["symbol","not"],["data",["void"],["send",["symbol","=="],["data",["send",["symbol","___js_fetch"],["data",["symbol","a"],["symbol","i"]]],["send",["symbol","___js_fetch"],["data",["symbol","b"],["symbol","i"]]]]]]],["send",["symbol","return"],["symbol","false"]]]]]],["symbol","true"]]]],["send",["symbol","->"],["data",["send",["symbol","when"],["data",["void"],["send",["symbol","and"],["data",["send",["symbol","==="],["data",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","getPrototypeOf"]]]],["data",["symbol","a"]]],["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]],["send",["symbol","==="],["data",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","getPrototypeOf"]]]],["data",["symbol","b"]]],["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]]]]]],["multi",["send",["symbol","="],["data",["symbol","ka"],["send",["symbol","keys"],["data",["symbol","a"]]]]],["send",["symbol","if"],["data",["send",["symbol","not"],["data",["void"],["send",["symbol","=="],["data",["send",["send",["symbol","ka"],["send",["symbol","."],["data",["void"],["symbol","sort"]]]],["data"]],["send",["send",["send",["symbol","keys"],["data",["symbol","b"]]],["send",["symbol","."],["data",["void"],["symbol","sort"]]]],["data"]]]]]],["send",["symbol","return"],["symbol","false"]]]],["send",["symbol","each"],["data",["symbol","ka"],["send",["symbol","->"],["data",["symbol","k"],["send",["symbol","if"],["data",["send",["symbol","not"],["data",["void"],["send",["symbol","=="],["data",["send",["symbol","___js_fetch"],["data",["symbol","a"],["symbol","k"]]],["send",["symbol","___js_fetch"],["data",["symbol","b"],["symbol","k"]]]]]]],["send",["symbol","return"],["symbol","false"]]]]]]]],["symbol","true"]]]],["send",["symbol","->"],["data",["data",["send",["symbol","=>"],["data",["value","::serialize"],["symbol","_"]]]],["send",["symbol","match"],["data",["symbol","b"],["multi",["send",["symbol","->"],["data",["data",["send",["symbol","=>"],["data",["value","::serialize"],["symbol","_"]]]],["send",["symbol","=="],["data",["send",["send",["symbol","a"],["value","::serialize"]],["data"]],["send",["send",["symbol","b"],["value","::serialize"]],["data"]]]]]],["send",["symbol","->"],["data",["symbol","otherwise"],["symbol","false"]]]]]]]],["send",["symbol","->"],["data",["symbol","otherwise"],["symbol","false"]]]]]]),"&:":Embedded$16203(["send",["symbol","->"],["data",["data",["symbol","dest"],["symbol","values"]],["multi",["send",["symbol","for"],["data",["send",["symbol","in"],["data",["symbol","k"],["symbol","values"]]],["send",["symbol","if"],["data",["send",["send",["symbol","values"],["send",["symbol","."],["data",["void"],["symbol","hasOwnProperty"]]]],["data",["symbol","k"]]],["send",["symbol",":="],["data",["send",["symbol","dest"],["symbol","k"]],["send",["symbol","___js_fetch"],["data",["symbol","values"],["symbol","k"]]]]]]]]],["symbol","dest"]]]]),"&":Embedded$16203(["send",["symbol","->"],["data",["data",["symbol","a"],["symbol","b"]],["multi",["send",["symbol","="],["data",["symbol","dest"],["send",["symbol","clone"],["data",["symbol","a"]]]]],["send",["symbol","for"],["data",["send",["symbol","in"],["data",["symbol","k"],["symbol","b"]]],["send",["symbol","if"],["data",["send",["send",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","hasOwnProperty"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","b"],["symbol","k"]]],["send",["symbol",":="],["data",["send",["symbol","dest"],["symbol","k"]],["send",["symbol","___js_fetch"],["data",["symbol","b"],["symbol","k"]]]]]]]]],["symbol","dest"]]]]),"&+":Embedded$16203(["send",["symbol","->"],["data",["data",["symbol","a"],["symbol","b"]],["multi",["send",["symbol","="],["data",["symbol","dest"],["send",["symbol","clone"],["data",["symbol","a"]]]]],["send",["symbol","for"],["data",["send",["symbol","in"],["data",["symbol","k"],["symbol","b"]]],["send",["symbol","if"],["data",["send",["send",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","hasOwnProperty"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","b"],["symbol","k"]]],["send",["symbol",":="],["data",["send",["symbol","dest"],["symbol","k"]],["send",["symbol","___js_fetch"],["data",["symbol","b"],["symbol","k"]]]]]]]]],["symbol","dest"]]]]),"|>":Embedded$16203(["send",["symbol","->"],["data",["data",["symbol","f"],["symbol","g"]],["send",["symbol","->"],["data",["data",["symbol","x"]],["send",["symbol","g"],["data",["send",["symbol","f"],["data",["symbol","x"]]]]]]]]]),"clone":Embedded$16203(["send",["symbol","->"],["data",["data",["send",["symbol","match"],["symbol","x"]]],["multi",["send",["symbol","->"],["data",["send",["symbol","or"],["data",["send",["symbol","or"],["data",["send",["symbol","or"],["data",["send",["symbol","?"],["data",["symbol","undefined"],["void"]]],["send",["symbol","?"],["data",["symbol","null"],["void"]]]]],["send",["symbol","?"],["data",["symbol","String"],["void"]]]]],["send",["symbol","?"],["data",["symbol","Number"],["void"]]]]],["symbol","x"]]],["send",["symbol","->"],["data",["data",["send",["symbol","=>"],["data",["value","::clone"],["symbol","_"]]]],["send",["send",["symbol","x"],["value","::clone"]],["data"]]]],["send",["symbol","->"],["data",["send",["symbol","when"],["data",["void"],["send",["symbol","==="],["data",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","getPrototypeOf"]]]],["data",["symbol","x"]]],["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]]]],["multi",["send",["symbol","="],["data",["symbol","dest"],["data",["symbol","="]]]],["send",["symbol","for"],["data",["send",["symbol","in"],["data",["symbol","k"],["symbol","x"]]],["send",["symbol","if"],["data",["send",["send",["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","hasOwnProperty"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","x"],["symbol","k"]]],["send",["symbol",":="],["data",["send",["symbol","dest"],["symbol","k"]],["send",["symbol","___js_fetch"],["data",["symbol","x"],["symbol","k"]]]]]]]]],["symbol","dest"]]]],["send",["symbol","->"],["data",["symbol","other"],["send",["symbol","throw"],["send",["send",["symbol","E"],["send",["symbol","."],["data",["void"],["symbol","clone"]]]],["data",["value","Object cannot be cloned"],["data",["send",["symbol","="],["data",["symbol","obj"],["symbol","x"]]]]]]]]]]]]),"___checker":Embedded$16203(["send",["symbol","->"],["data",["data",["symbol","type"]],["multi",["send",["symbol","="],["data",["symbol","f"],["send",["symbol","type"],["value","::check"]]]],["send",["symbol","if"],["data",["send",["symbol","==="],["data",["symbol","f"],["symbol","undefined"]]],["multi",["send",["symbol","then"],["data",["send",["symbol","->"],["data",["data",["symbol","value"]],["send",["symbol","instanceof"],["data",["symbol","value"],["symbol","type"]]]]]]],["send",["symbol","else"],["data",["send",["symbol","->"],["data",["data",["symbol","value"]],["send",["send",["symbol","f"],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","type"],["symbol","value"]]]]]]]]]]]]]),"___projector":Embedded$16203(["send",["symbol","->"],["data",["data",["symbol","type"]],["send",["symbol","->"],["data",["data",["symbol","value"]],["multi",["send",["symbol","="],["data",["symbol","f"],["send",["symbol","type"],["value",":::project"]]]],["send",["symbol","if"],["data",["send",["symbol","==="],["data",["symbol","f"],["symbol","undefined"]]],["multi",["send",["symbol","then"],["data",["multi",["send",["symbol",":="],["data",["symbol","f"],["send",["symbol","type"],["value","::project"]]]],["send",["symbol","if"],["data",["send",["symbol","==="],["data",["symbol","f"],["symbol","undefined"]]],["multi",["send",["symbol","then"],["data",["data",["symbol","true"],["send",["symbol","type"],["data",["symbol","value"]]]]]],["send",["symbol","else"],["data",["send",["symbol","!!"],["data",["data",["symbol","true"],["send",["symbol","f"],["data",["symbol","value"]]]],["send",["symbol","->"],["data",["symbol","e"],["data",["symbol","false"],["symbol","null"]]]]]]]]]]]]]],["send",["symbol","else"],["data",["send",["send",["symbol","f"],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","type"],["symbol","value"]]]]]]]]]]]]]),"___hasprop":Embedded$16203(["send",["symbol","->"],["data",["data",["symbol","match"],["symbol","key"]],["multi",["send",["symbol","->"],["data",["send",["symbol","or"],["data",["send",["symbol","?"],["data",["symbol","null"],["void"]]],["send",["symbol","?"],["data",["symbol","undefined"],["void"]]]]],["symbol","false"]]],["send",["symbol","->"],["data",["send",["symbol","?"],["data",["symbol","String"],["symbol","x"]]],["send",["symbol","in"],["data",["symbol","key"],["send",["symbol","String"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]]]],["send",["symbol","->"],["data",["send",["symbol","?"],["data",["symbol","Number"],["symbol","x"]]],["send",["symbol","in"],["data",["symbol","key"],["send",["symbol","Number"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]]]],["send",["symbol","->"],["data",["symbol","x"],["send",["symbol","in"],["data",["symbol","key"],["symbol","x"]]]]]]]]),"range":Embedded$16203(["send",["symbol","->"],["data",["data",["symbol","from"],["symbol","to"]],["multi",["send",["symbol","="],["data",["symbol","rval"],["data"]]],["send",["symbol","for"],["data",["multi",["send",["symbol","="],["data",["symbol","i"],["symbol","from"]]],["send",["symbol","<="],["data",["symbol","i"],["symbol","to"]]],["send",["symbol","++"],["data",["symbol","i"],["void"]]]],["send",["send",["symbol","rval"],["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",["symbol","i"]]]]],["symbol","rval"]]]]),"___serialize_ast":Embedded$16203(["send",["symbol","->"],["data",["data",["symbol","match"]],["multi",["send",["symbol","->"],["data",["send",["symbol","or"],["data",["send",["symbol","?"],["data",["symbol","String"],["symbol","x"]]],["send",["symbol","?"],["data",["symbol","Number"],["symbol","x"]]]]],["send",["send",["symbol","#"],["data",["void"],["symbol","value"]]],["data",["symbol","x"]]]]],["send",["symbol","->"],["data",["symbol","other"],["send",["send",["symbol","other"],["value","::serialize_ast"]],["data"]]]]]]]),"___match_error":Embedded$16203(["send",["symbol","->"],["data",["data",["symbol","value"],["symbol","url"],["symbol","start"],["symbol","end"]],["multi",["send",["symbol","="],["data",["symbol","err"],["send",["send",["symbol","E"],["send",["symbol","."],["data",["void"],["symbol","match"]]]],["data",["value","Could not find a match for value"],["data",["send",["symbol","="],["data",["symbol","value"],["symbol","value"]]]]]]]],["send",["symbol","if"],["data",["symbol","url"],["send",["symbol",":="],["data",["send",["symbol","err"],["send",["symbol","."],["data",["void"],["symbol","location"]]]],["send",["send",["symbol","#"],["data",["void"],["symbol","location"]]],["data",["symbol","url"],["symbol","start"],["symbol","end"]]]]]]],["send",["symbol","throw"],["symbol","err"]]]]]),"ErrorFactory":Embedded$16203(["send",["symbol","class"],["data",["multi",["send",["symbol","="],["data",["send",["symbol","constructor"],["data",["symbol","tags"]]],["send",["symbol",":="],["data",["send",["symbol","@"],["data",["void"],["symbol","tags"]]],["symbol","tags"]]]]],["send",["symbol","="],["data",["send",["symbol","create"],["data",["send",["symbol","="],["data",["symbol","message"],["value",""]]],["send",["symbol","*"],["data",["void"],["symbol","args"]]]]],["multi",["send",["symbol","="],["data",["symbol","e"],["send",["symbol","Error"],["data",["symbol","message"]]]]],["send",["symbol",":="],["data",["send",["symbol","e"],["value","::tags"]],["send",["symbol","@"],["data",["void"],["symbol","tags"]]]]],["send",["symbol",":="],["data",["send",["symbol","e"],["send",["symbol","."],["data",["void"],["symbol","args"]]]],["symbol","args"]]],["send",["symbol","each"],["data",["send",["symbol","enumerate"],["data",["symbol","args"]]],["send",["symbol","->"],["data",["data",["symbol","i"],["symbol","arg"]],["send",["symbol",":="],["data",["send",["symbol","e"],["symbol","i"]],["symbol","arg"]]]]]]],["send",["symbol",":="],["data",["send",["symbol","e"],["send",["symbol","."],["data",["void"],["symbol","length"]]]],["send",["symbol","args"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]],["send",["symbol",":="],["data",["send",["symbol","e"],["send",["symbol","."],["data",["void"],["symbol","name"]]]],["send",["send",["send",["symbol","++"],["data",["data",["send",["symbol","."],["data",["void"],["symbol","E"]]]],["send",["symbol","@"],["data",["void"],["symbol","tags"]]]]],["send",["symbol","."],["data",["void"],["symbol","join"]]]],["data",["value","."]]]]],["symbol","e"]]]],["send",["symbol","="],["data",["send",["value","::check"],["data",["symbol","e"]]],["multi",["send",["symbol","if"],["data",["send",["symbol","or"],["data",["send",["symbol","not"],["data",["void"],["symbol","e"]]],["send",["symbol","not"],["data",["void"],["send",["symbol","?"],["data",["symbol","Error"],["symbol","e"]]]]]]],["send",["symbol","return"],["symbol","false"]]]],["send",["symbol","="],["data",["symbol","tags"],["send",["symbol","or"],["data",["send",["symbol","e"],["value","::tags"]],["data"]]]]],["send",["symbol","each?"],["data",["send",["symbol","@"],["data",["void"],["symbol","tags"]]],["send",["symbol","->"],["data",["send",["symbol","when"],["data",["symbol","tag"],["send",["symbol","==="],["data",["send",["send",["symbol","tags"],["send",["symbol","."],["data",["void"],["symbol","indexOf"]]]],["data",["symbol","tag"]]],["send",["symbol","-"],["data",["void"],["value",1]]]]]]],["send",["symbol","return"],["symbol","false"]]]]]],["symbol","true"]]]],["send",["symbol","="],["data",["send",["value","::deconstruct"],["data",["symbol","e"]]],["send",["symbol","e"],["send",["symbol","."],["data",["void"],["symbol","args"]]]]]]]]]),"Node":Embedded$16203(["send",["symbol","class"],["data",["multi",["send",["symbol","static"],["data",["multi",["send",["symbol","="],["data",["send",["value","::check"],["data",["symbol","x"]]],["send",["symbol","and"],["data",["send",["symbol","and"],["data",["symbol","x"],["send",["symbol","x"],["send",["symbol","."],["data",["void"],["symbol","classes"]]]]]],["send",["symbol","x"],["send",["symbol","."],["data",["void"],["symbol","children"]]]]]]]],["send",["symbol","="],["data",["send",["value","::deconstruct"],["data",["symbol","x"]]],["data",["send",["symbol","x"],["send",["symbol","."],["data",["void"],["symbol","classes"]]]],["send",["symbol","x"],["send",["symbol","."],["data",["void"],["symbol","children"]]]]]]]]]],["send",["symbol","="],["data",["send",["symbol","constructor"],["data",["send",["symbol","!"],["data",["symbol","Array"],["symbol","classes"]]],["send",["symbol","!"],["data",["symbol","Array"],["symbol","children"]]]]],["multi",["send",["symbol",":="],["data",["send",["symbol","@"],["data",["void"],["symbol","classes"]]],["send",["send",["symbol","classes"],["send",["symbol","."],["data",["void"],["symbol","sort"]]]],["data"]]]],["send",["symbol",":="],["data",["send",["symbol","@"],["data",["void"],["symbol","children"]]],["symbol","children"]]]]]],["send",["symbol","="],["data",["send",["value","::check"],["data",["symbol","n"]]],["multi",["send",["symbol","each?"],["data",["send",["symbol","@"],["data",["void"],["symbol","classes"]]],["send",["symbol","->"],["data",["send",["symbol","when"],["data",["symbol","c"],["send",["symbol","==="],["data",["send",["send",["send",["symbol","n"],["send",["symbol","."],["data",["void"],["symbol","classes"]]]],["send",["symbol","."],["data",["void"],["symbol","indexOf"]]]],["data",["symbol","c"]]],["send",["symbol","-"],["data",["void"],["value",1]]]]]]],["send",["symbol","return"],["symbol","false"]]]]]],["symbol","true"]]]]]]])})));;($length$22713=temp$22708.length);;($index$22718=0);;$16239:for(;($index$22718<$length$22713);($index$22718++)){var k$22736;var v$22737;var t0$22731;var t1$22732;var m$22726;(m$22726=temp$22708[$index$22718]);;(t0$22731=m$22726);if(((t0$22731 instanceof Array)&&((t1$22732=t0$22731.length),(t1$22732===2)))){(k$22736=t0$22731[0]);(v$22737=t0$22731[1]);stdenv$16204.bind(topscope$16208,k$22736,["value",v$22737]);}else{$22976(m$22726,"/home/olivier/git/earl-grey/src/stdenv.eg",35706,35772);;}}(stdprelude$16234=Embedded$16203(["multi",["send",["symbol","="],["data",["send",["symbol","send"],["data",["symbol","obj"],["send",["symbol","match"],["symbol","msg"]]]],["multi",["send",["symbol","->"],["data",["send",["symbol","or"],["data",["send",["symbol","?"],["data",["symbol","String"],["void"]]],["send",["symbol","?"],["data",["symbol","Number"],["void"]]]]],["send",["symbol","___js_fetch"],["data",["symbol","obj"],["symbol","msg"]]]]],["send",["symbol","->"],["data",["symbol","other"],["send",["send",["symbol","obj"],["value","::send"]],["data",["symbol","msg"]]]]]]]],["send",["symbol",":="],["data",["send",["symbol","Array"],["value",":::project"]],["send",["symbol","->"],["data",["data",["send",["symbol","match"],["symbol","value"]]],["multi",["send",["symbol","->"],["data",["send",["symbol","?"],["data",["symbol","Array"],["void"]]],["data",["symbol","true"],["symbol","value"]]]],["send",["symbol","->"],["data",["symbol","_"],["data",["symbol","true"],["data",["symbol","value"]]]]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value","::check"]],["send",["symbol","->"],["data",["data",["symbol","value"]],["send",["symbol","if"],["data",["send",["symbol","instanceof"],["data",["symbol","value"],["symbol","Array"]]],["multi",["send",["symbol","then"],["data",["multi",["send",["symbol","for"],["data",["multi",["send",["symbol","="],["data",["symbol","i"],["value",0]]],["send",["symbol","<"],["data",["symbol","i"],["send",["symbol","this"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]],["send",["symbol","++"],["data",["symbol","i"],["void"]]]],["send",["symbol","if"],["data",["send",["symbol","!=="],["data",["send",["symbol","this"],["symbol","i"]],["send",["symbol","value"],["symbol","i"]]]],["send",["symbol","return"],["symbol","false"]]]]]],["symbol","true"]]]],["send",["symbol","else"],["data",["symbol","false"]]]]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value","::clone"]],["send",["symbol","->"],["data",["data"],["send",["symbol","&:"],["data",["send",["send",["symbol","this"],["send",["symbol","."],["data",["void"],["symbol","slice"]]]],["data",["value",0]]],["symbol","this"]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value",":::project"]],["send",["symbol","->"],["data",["data",["symbol","value"]],["send",["symbol","if"],["data",["send",["symbol","instanceof"],["data",["symbol","value"],["symbol","Array"]]],["multi",["send",["symbol","then"],["data",["multi",["send",["symbol","for"],["data",["multi",["send",["symbol","="],["data",["symbol","i"],["value",0]]],["send",["symbol","<"],["data",["symbol","i"],["send",["symbol","this"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]],["send",["symbol","++"],["data",["symbol","i"],["void"]]]],["send",["symbol","if"],["data",["send",["symbol","!=="],["data",["send",["symbol","this"],["symbol","i"]],["send",["symbol","value"],["symbol","i"]]]],["send",["symbol","return"],["data",["symbol","true"],["data",["symbol","value"]]]]]]]],["data",["symbol","true"],["send",["send",["symbol","value"],["send",["symbol","."],["data",["void"],["symbol","slice"]]]],["data",["send",["symbol","this"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]]]]]],["send",["symbol","else"],["data",["data",["symbol","true"],["data",["symbol","value"]]]]]]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value","::serialize_ast"]],["send",["symbol","->"],["data",["data"],["send",["send",["symbol","#"],["data",["void"],["symbol","array"]]],["data",["send",["symbol","*"],["data",["void"],["send",["send",["symbol","this"],["send",["symbol","."],["data",["void"],["symbol","map"]]]],["data",["symbol","___serialize_ast"]]]]]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","RegExp"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value","::check"]],["send",["symbol","->"],["data",["data",["symbol","match"]],["multi",["send",["symbol","->"],["data",["send",["symbol","?"],["data",["symbol","String"],["symbol","value"]]],["send",["symbol","if"],["data",["send",["send",["symbol","value"],["send",["symbol","."],["data",["void"],["symbol","match"]]]],["data",["symbol","this"]]],["symbol","true"],["symbol","false"]]]]],["send",["symbol","->"],["data",["symbol","other"],["symbol","false"]]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","RegExp"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value",":::project"]],["send",["symbol","->"],["data",["data",["symbol","match"]],["multi",["send",["symbol","->"],["data",["send",["symbol","?"],["data",["symbol","String"],["symbol","value"]]],["send",["symbol","match"],["data",["send",["send",["symbol","value"],["send",["symbol","."],["data",["void"],["symbol","match"]]]],["data",["symbol","this"]]],["multi",["send",["symbol","->"],["data",["send",["symbol","?"],["data",["symbol","null"],["symbol","m"]]],["data",["symbol","false"],["symbol","null"]]]],["send",["symbol","->"],["data",["symbol","m"],["data",["symbol","true"],["symbol","m"]]]]]]]]],["send",["symbol","->"],["data",["symbol","other"],["data",["symbol","false"],["symbol","null"]]]]]]]]],["send",["symbol",":="],["data",["send",["send",["symbol","Function"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["value","::send"]],["send",["symbol","->"],["data",["data",["symbol","args"]],["send",["send",["symbol","this"],["send",["symbol","."],["data",["void"],["symbol","apply"]]]],["data",["symbol","this"],["symbol","args"]]]]]]]]));;(expander$16206["utils"]=({"var_operator":var_operator$16219}));(exports["topscope"]=topscope$16208);(exports["stdenv"]=stdenv$16204);(exports["expander"]=expander$16206);(exports["expand"]=expand$16207);(exports["stdprelude"]=stdprelude$16234);

},{"./expand":5,"./location":7,"./pattern":10,"./pp":11,"./util":14}],13:[function(require,module,exports){
var $23313=function(type$23315){var f$23318;(f$23318=type$23315["::check"]);;if((f$23318===(void 0))){return function(value$23323){return (value$23323 instanceof type$23315);};}else{return function(value$23326){return f$23318.call(type$23315,value$23326);};}};
var $23328=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $23329=function(dest$23331,values$23332){var k$23337;(k$23337=null);$23335:for(k$23337 in values$23332){if(values$23332.hasOwnProperty(k$23337)){(dest$23331[k$23337]=values$23332[k$23337]);}}return dest$23331;};
var $23341=function($23342$23344){var ph$23348;(ph$23348=$23342$23344);;var $23346$23353;($23346$23353=ph$23348);;var bridge$23347$23358;var x$23362;(bridge$23347$23358=$23346$23353);if((((typeof(bridge$23347$23358)==="string")&&((x$23362=bridge$23347$23358),true))||((typeof(bridge$23347$23358)==="number")&&((x$23362=bridge$23347$23358),true)))){return ["value",x$23362];}else{var other$23369;(other$23369=$23346$23353);return other$23369["::serialize_ast"]();}};
var send$23153;(send$23153=function(obj$23158,$23156$23159){var ph$23163;var msg$23164;var t0$23166;(t0$23166=$23156$23159);(msg$23164=t0$23166);(ph$23163=t0$23166);;var $23161$23170;($23161$23170=ph$23163);;var bridge$23162$23175;(bridge$23162$23175=$23161$23170);if(((typeof(bridge$23162$23175)==="string")||(typeof(bridge$23162$23175)==="number"))){return obj$23158[msg$23164];}else{var other$23183;(other$23183=$23161$23170);return obj$23158["::send"](msg$23164);}});;(Array[":::project"]=function($23186$23188){var ph$23191;var value$23192;var t0$23194;(t0$23194=$23186$23188);(value$23192=t0$23194);(ph$23191=t0$23194);;var $23190$23198;($23190$23198=ph$23191);;if($23313(Array)($23190$23198)){return [true,value$23192];}else{$23190$23198;return [true,[value$23192]];}});(Array.prototype["::check"]=function(value$23212){if((value$23212 instanceof Array)){var i$23217;(i$23217=0);;$23215:for(;(i$23217<this.length);(i$23217++)){if(($23328(this,i$23217)!==$23328(value$23212,i$23217))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $23329(this.slice(0),this);});(Array.prototype[":::project"]=function(value$23228){if((value$23228 instanceof Array)){var i$23233;(i$23233=0);;$23231:for(;(i$23233<this.length);(i$23233++)){if(($23328(this,i$23233)!==$23328(value$23228,i$23233))){return [true,[value$23228]];}}return [true,value$23228.slice(this.length)];}else{return [true,[value$23228]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($23341));});(RegExp.prototype["::check"]=function($23243$23245){var ph$23248;(ph$23248=$23243$23245);;var $23247$23253;($23247$23253=ph$23248);;var value$23261;if((typeof($23247$23253)==="string")){(value$23261=$23247$23253);if(value$23261.match(this)){return true;}else{return false;}}else{var other$23266;(other$23266=$23247$23253);return false;}});(RegExp.prototype[":::project"]=function($23268$23270){var ph$23273;(ph$23273=$23268$23270);;var $23272$23278;($23272$23278=ph$23273);;var value$23286;if((typeof($23272$23278)==="string")){(value$23286=$23272$23278);var $23289$23291;($23289$23291=value$23286.match(this));;var m$23299;if(($23289$23291===null)){(m$23299=$23289$23291);return [false,null];}else{var m$23304;(m$23304=$23289$23291);return [true,m$23304];}}else{var other$23308;(other$23308=$23272$23278);return [false,null];}});(Function.prototype["::send"]=function(args$23311){return this.apply(this,args$23311);});
var $25081=function(arr$25083){var results$25087;var l$25088;(results$25087=[]);;(l$25088=arr$25083.length);;var i$25096;(i$25096=0);;$25086:for(;(i$25096<l$25088);(i$25096++)){results$25087.push([i$25096,$23328(arr$25083,i$25096)]);}return results$25087;};
var $24912=function(){var $24913$24915;($24913$24915=function(tags$24919){var it$0$24922;(it$0$24922=function(){if((!$23313($24913$24915)(this))){return Object.create($24913$24915.prototype);}else{return this;}}());;(it$0$24922["tags"]=tags$24919);return it$0$24922;});;($24913$24915.prototype["create"]=function(){var $24931$24933;($24931$24933=arguments);;var t0$24938;var message$24942;var args$24943;(t0$24938=$24931$24933.length);if((t0$24938>=0)){(message$24942=function(){if((0>=t0$24938)){return "";}else{return $24931$24933[0];}}());(args$24943=Array.prototype.slice.call($24931$24933,1));var it$0$24947;(it$0$24947=this);;var self$24952;(self$24952=this);;var e$24957;(e$24957=Error(message$24942));;(e$24957["::tags"]=it$0$24947.tags);(e$24957["args"]=args$24943);var temp$24965;(temp$24965=$25081(args$24943));;var $length$24970;($length$24970=temp$24965.length);;var $index$24975;($index$24975=0);;$24958:for(;($index$24975<$length$24970);($index$24975++)){var m$24983;(m$24983=temp$24965[$index$24975]);;var t0$24988;var t1$24989;var i$24993;var arg$24994;(t0$24988=m$24983);if(((t0$24988 instanceof Array)&&((t1$24989=t0$24988.length),(t1$24989===2)))){(i$24993=t0$24988[0]);(arg$24994=t0$24988[1]);(e$24957[i$24993]=arg$24994);}else{$24899(m$24983);;}}(e$24957["length"]=args$24943.length);(e$24957["name"]=["E"].concat(it$0$24947.tags).join("."));return e$24957;}else{$24899($24931$24933);}});($24913$24915.prototype["::check"]=function(e$25005){var it$0$25008;(it$0$25008=this);;var self$25013;(self$25013=this);;var tags$25018;if(((!e$25005)||(!$23313(Error)(e$25005)))){return false;}(tags$25018=(e$25005["::tags"]||[]));;var temp$25027;(temp$25027=it$0$25008.tags);;var $length$25032;($length$25032=temp$25027.length);;var $index$25037;($index$25037=0);;$25019:for(;($index$25037<$length$25032);($index$25037++)){var m$25045;(m$25045=temp$25027[$index$25037]);;var tag$25053;(tag$25053=m$25045);if((tags$25018.indexOf(tag$25053)===-1)){return false;}else{false;;}}return true;});($24913$24915.prototype["::deconstruct"]=function(e$25061){var it$0$25064;(it$0$25064=this);;var self$25069;(self$25069=this);;return e$25061.args;});$23329($24913$24915,$23329(function(){var accum$25074;(accum$25074=({}));(accum$25074["::name"]="$24913");return accum$25074;}(),function(){var accum$25078;(accum$25078=({}));(accum$25078["::egclass"]=true);return accum$25078;}()));return $24913$24915;}();
var $24899=function(value$24901,url$24902,start$24903,end$24904){var err$24907;(err$24907=$24912(["match"]).create("Could not find a match for value",({"value":value$24901})));;if(url$24902){(err$24907["location"]=["location",url$24902,start$24903,end$24904]);}throw err$24907;};
var $25103=function(type$25105){return function(value$25108){var f$25111;(f$25111=type$25105[":::project"]);;if((f$25111===(void 0))){(f$25111=type$25105["::project"]);if((f$25111===(void 0))){return [true,type$25105(value$25108)];}else{var rval$25117;(rval$25117=false);;try{(rval$25117=[true,f$25111(value$25108)]);}catch(excv$25123){var e$25129;(e$25129=excv$25123);(rval$25117=[false,null]);}return rval$25117;}}else{return f$25111.call(type$25105,value$25108);}};};
var $25131=function($25132$25134,key$25135){var ph$25139;(ph$25139=$25132$25134);;var $25137$25144;($25137$25144=ph$25139);;var bridge$25138$25149;(bridge$25138$25149=$25137$25144);if(((bridge$25138$25149===null)||(bridge$25138$25149===(void 0)))){return false;}else{var x$25157;if((typeof($25137$25144)==="string")){(x$25157=$25137$25144);return (key$25135 in String.prototype);}else{var x$25162;if((typeof($25137$25144)==="number")){(x$25162=$25137$25144);return (key$25135 in Number.prototype);}else{var x$25167;(x$25167=$25137$25144);return (key$25135 in x$25167);}}}};var accum$24875;var accum$24879;var $23373$23375;var gensym$23376;var $23374$23377;var __lt____gt__$23378;var js_op_table2$23379;var js_op_table$23380;var Translator$23381;var translate$23382;($23373$23375=require("./util"));;(gensym$23376=$23373$23375.gensym);;($23374$23377=require("./pp"));;(__lt____gt__$23378=$23374$23377["<>"]);;(js_op_table2$23379=({"+":"+","-":"-","*":"*","/":"/","mod":"%","&.":"&","|.":"|","^.":"^","~":"~","and":"&&","or":"||","not":"!","==":"===","!=":"!==","===":"===","!==":"!==","<":"<",">":">","<=":"<=",">=":">=","<<":"<<",">>":">>",">>>":">>>","in":" in ","instanceof":" instanceof ","++":"++","--":"--"}));;(js_op_table$23380=({"___plus":"+","___minus":"-","___times":"*","___div":"/","___mod":"%","___binxor":"^","___binand":"&","___binor":"|","___binnot":"~","___and":"&&","___or":"||","___not":"!","___is":"===","___isnt":"!==","___eq":"===","___neq":"!==","___lt":"<","___gt":">","___lte":"<=","___gte":">=","___shl":"<<","___shr":">>","___shr2":">>>","___in":" in ","___instanceof":" instanceof ","___plusplus":"++","___minusminus":"--"}));;(Translator$23381=function(){var it$0$23419;var prelude$23415;var t0$23411;var $23404$23406;($23404$23406=arguments);;(t0$23411=$23404$23406.length);if(((t0$23411>=0)&&(t0$23411<=1))){(prelude$23415=function(){if((0>=t0$23411)){return null;}else{return $23404$23406[0];}}());(it$0$23419=function(){if((!$23313(Translator$23381)(this))){return Object.create(Translator$23381.prototype);}else{return this;}}());;(it$0$23419["cache"]=({}));(it$0$23419["prepend"]=[]);if(prelude$23415){it$0$23419.prepend.push(it$0$23419.translate($23341(prelude$23415),"stmt"));}return it$0$23419;}else{$24899($23404$23406);}});;(Translator$23381.prototype["register_value"]=function(v$23432,id$23433){var temp$23458;var name$23464;var $23441$23447;var self$23442;var it$0$23436;(it$0$23436=this);;(self$23442=this);;($23441$23447=$23328(it$0$23436.cache,id$23433));;if(($23441$23447===(void 0))){(temp$23458=["symbol",gensym$23376()]);;(it$0$23436.cache[id$23433]=temp$23458);it$0$23436.prepend.push(it$0$23436.translate(["declare",temp$23458,$23341(v$23432)],"stmt"));return temp$23458;}else{(name$23464=$23441$23447);return name$23464;}});(Translator$23381.prototype["register_raw"]=function(raw$23469,id$23470){var temp$23495;var name$23501;var $23478$23484;var self$23479;var it$0$23473;(it$0$23473=this);;(self$23479=this);;($23478$23484=$23328(it$0$23473.cache,id$23470));;if(($23478$23484===(void 0))){(temp$23495=["symbol",gensym$23376()]);;(it$0$23473.cache[id$23470]=temp$23495);it$0$23473.prepend.push(it$0$23473.translate(["declare",temp$23495,["raw",raw$23469]],"stmt"));return temp$23495;}else{(name$23501=$23478$23484);return name$23501;}});(Translator$23381.prototype["dump_store"]=function(){var rval$23518;var self$23513;var it$0$23508;(it$0$23508=this);;(self$23513=this);;(rval$23518=it$0$23508.prepend.join("\n"));;(it$0$23508["prepend"]=[]);return rval$23518;});(Translator$23381.prototype["mangle"]=function(name$23525){var i$23548;var tr$23539;var r$23540;var self$23533;var it$0$23528;(it$0$23528=this);;(self$23533=this);;(tr$23539=({"+":"__plus__","-":"__minus__","*":"__asterisk__","/":"__slash__","%":"__percent__","^":"__caret__","#":"__hash__","&":"__amp__","|":"__pipe__","@":"__at__","!":"__bang__","?":"__qmark__","=":"__equal__","<":"__lt__",">":"__gt__","~":"__tilde__",".":"__dot__",":":"__colon__"}));;(r$23540=[]);;(i$23548=0);;$23538:for(;(i$23548<name$23525.length);(++i$23548)){var c$23556;(c$23556=$23328(name$23525,i$23548));;r$23540.push(($23328(tr$23539,c$23556)||c$23556));}return r$23540.join("");});(Translator$23381.prototype["body"]=function(orig$23563,mode$23564){var t0$23581;var t1$23582;var t2$23583;var x$23607;var stmts$23616;var ret$23617;var other$23630;var $23577$23596;var b$23578;var trst$23579;var self$23572;var it$0$23567;(it$0$23567=this);;(self$23572=this);;(t0$23581=$25103(["multi"])(orig$23563));if((t0$23581[0]&&((t1$23582=t0$23581[1]),((t2$23583=t1$23582.length),(t2$23583>=0))))){(b$23578=Array.prototype.slice.call(t1$23582,0));;}else{$24899(orig$23563,"/home/olivier/git/earl-grey/src/translate-js.eg",3258,3262);}(trst$23579=function(stmt$23592){return it$0$23567.translate(stmt$23592,"stmt");});;($23577$23596=mode$23564);;if(($23577$23596==="expr")){(x$23607=["send",["lambda",[],orig$23563],["array"]]);;return it$0$23567.translate(x$23607,mode$23564);}else{if(($23577$23596==="return")){(stmts$23616=b$23578.slice(0,-1));;(ret$23617=$23328(b$23578,(b$23578.length-1)));;return (stmts$23616.map(trst$23579).join("")+it$0$23567.translate(ret$23617,"return"));}else{if(($23577$23596==="stmt")){return b$23578.map(trst$23579).join("");}else{(other$23630=$23577$23596);throw $24912(["syntax","mode"]).create("Unknown mode",({"mode":mode$23564}));}}}});(Translator$23381.prototype["expr"]=function(x$23635,mode$23636){var other$23670;var $23644$23650;var self$23645;var it$0$23639;(it$0$23639=this);;(self$23645=this);;($23644$23650=mode$23636);;if(($23644$23650==="expr")){return x$23635;}else{if(($23644$23650==="stmt")){return (x$23635+";");}else{if(($23644$23650==="return")){return (("return "+x$23635)+";");}else{(other$23670=$23644$23650);throw "OopsI";}}}});(Translator$23381.prototype["op"]=function(op$23675,a$23676,b$23677){var $23694$23707;var $23695$23708;var $23696$23709;var t0$23703;var t1$23704;var t2$23705;var $23693$23698;var e$23690;var self$23685;var it$0$23680;(it$0$23680=this);;(self$23685=this);;(e$23690=((($23693$23698=[a$23676,b$23677])),function(){if((($23694$23707=($23693$23698 instanceof Array))&&((t0$23703=$23693$23698.length),(($23696$23709=(t0$23703===2))&&((t1$23704=$23693$23698[0]),((t1$23704 instanceof Array)&&((t2$23705=t1$23704.length),((t2$23705===1)&&(t1$23704[0]==="void"))))))))){$23693$23698[1];return (op$23675+it$0$23680.translate(b$23677,"expr"));}else{if(($23696$23709&&($23693$23698[0],((t1$23704=$23693$23698[1]),((t1$23704 instanceof Array)&&((t2$23705=t1$23704.length),((t2$23705===1)&&(t1$23704[0]==="void")))))))){return (it$0$23680.translate(a$23676,"expr")+op$23675);}else{$23693$23698;return ((it$0$23680.translate(a$23676,"expr")+op$23675)+it$0$23680.translate(b$23677,"expr"));}}}()));;return (("("+e$23690)+")");});(Translator$23381.prototype["translate"]=function(expr$23731,mode$23732){var repl$23807;var it$0$23838;var it$0$23833;var it$0$23828;var it$0$23823;var bridge$23793$23849;var bridge$23792$23846;var other$23860;var id$23854;var bridge$23791$23800;var $23790$23795;var r$23787;var t0$23879;var t0$23882;var trf$23888;var trmsg$23889;var trf$23920;var trmsg$23921;var trf$23933;var trmsg$23934;var otherwise$23930;var $23907$23909;var x$23977;var x$23971;var $23955$23966;var $23956$23967;var $23957$23968;var t0$23964;var $23954$23959;var $index$24010;var $length$24005;var temp$24000;var acc$23995;var trf$23985;var trargs$23986;var op$23951;var code$24042;var code$24050;var t0$24038;var t1$24039;var trf$24055;var trmsg$24056;var codevar$24036;var f$24073;var r$24069;var f$24127;var f$24159;var v$24154;var all_strings$24087;var r$24088;var $index$24219;var $length$24214;var temp$24209;var acc$24204;var a$24193;var b$24194;var a$24268;var b$24269;var other$24265;var $24251$24253;var a$24300;var b$24301;var c$24302;var other$24297;var $24283$24285;var a$24339;var other$24336;var bridge$24321$24328;var $24320$24323;var a$24368;var b$24369;var other$24365;var bridge$24350$24357;var $24349$24352;var a$24386;var b$24387;var c$24388;var a$24405;var b$24406;var $index$24495;var $length$24490;var temp$24485;var acc$24480;var $index$24532;var $length$24527;var temp$24522;var acc$24517;var xs$24474;var $24424$24464;var $24423$24458;var isdecl$24425;var $index$24594;var $length$24589;var temp$24584;var acc$24579;var decls$24573;var f$24623;var r$24619;var other$24706;var $24692$24694;var a$24731;var b$24732;var other$24728;var $24714$24716;var a$24764;var b$24765;var c$24766;var d$24767;var other$24761;var $24747$24749;var a$24804;var b$24805;var c$24806;var other$24801;var $24787$24789;var t0$24829;var t0$24833;var a$24857;var b$24858;var other$24854;var $24840$24842;var other$24872;var x$24867;var attempt$24818;var v$24819;var body$24820;var x$24782;var y$24783;var body$24784;var x$24741;var y$24742;var z$24743;var body$24744;var test$24710;var body$24711;var label$24686;var body$24687;var value$24681;var value$24676;var value$24671;var label$24664;var label$24657;var value$24652;var args$24615;var vars$24568;var body$24569;var s$24563;var args$24558;var args$24419;var lhs$24400;var rhs$24401;var obj$24378;var msg$24379;var rhs$24380;var binding$24345;var value$24346;var binding$24314;var test$24278;var pos$24279;var neg$24280;var test$24243;var pos$24244;var bindings$24188;var body$24189;var args$24083;var args$24065;var f$24031;var msg$24032;var f$23943;var args$23944;var f$23898;var msg$23899;var s$23900;var f$23874;var msg$23875;var f$23865;var v$23783;var s$23773;var $23743$23767;var $23744$23768;var $23745$23769;var $23746$23770;var t0$23757;var t1$23758;var t2$23759;var t3$23760;var t4$23761;var bridge$23741$23762;var bridge$23742$23763;var t5$23764;var t6$23765;var $23740$23752;var self$23747;var it$0$23735;(it$0$23735=this);;(self$23747=this);;($23740$23752=expr$23731);;if((($23743$23767=($23740$23752 instanceof Array))&&((t0$23757=$23740$23752.length),((t0$23757===2)&&($23740$23752[0]==="symbol"))))){(s$23773=$23740$23752[1]);return it$0$23735.expr(it$0$23735.mangle(s$23773),mode$23732);}else{if(($23743$23767&&((t0$23757===1)&&($23740$23752[0]==="void")))){return it$0$23735.expr("null",mode$23732);}else{if(($23743$23767&&((t0$23757===2)&&($23740$23752[0]==="value")))){(v$23783=$23740$23752[1]);(r$23787=((($23790$23795=v$23783)),function(){if((typeof($23790$23795)==="string")){(repl$23807=({"\"":"\\\"","\n":"\\n","\\":"\\\\"}));;(v$23783=v$23783.replace(RegExp("((?:(?:\"|\\\\)|\n))","g"),function(m$23812){return $23328(repl$23807,m$23812);}));return (("\""+v$23783)+"\"");}else{if(($23790$23795===(void 0))){return "(void 0)";}else{if($23313(RegExp)($23790$23795)){(it$0$23823=String(v$23783));;(it$0$23828=it$0$23823.slice(1,-1));;(it$0$23833=it$0$23828.replace(RegExp("/","g"),"\\/"));;(it$0$23838=it$0$23833.replace(RegExp("\n","g"),"\\n"));;return "/".concat(it$0$23838).concat("/");}else{(bridge$23791$23800=$23790$23795);if((((bridge$23792$23846=bridge$23791$23800),(((bridge$23793$23849=bridge$23792$23846),((typeof(bridge$23793$23849)==="number")||(bridge$23793$23849===true)))||(bridge$23792$23846===false)))||(bridge$23791$23800===null))){return String(v$23783);}else{if(($25131($23790$23795,"::id")&&((id$23854=$23790$23795["::id"]),id$23854))){return it$0$23735.translate(it$0$23735.register_value(v$23783,id$23854),mode$23732);}else{(other$23860=$23790$23795);throw $24912(["cannot_serialize"]).create("Cannot serialize value",({"value":v$23783}));}}}}}}()));;return it$0$23735.expr(r$23787,mode$23732);}else{if(($23743$23767&&(($23745$23769=(t0$23757===3))&&(($23746$23770=($23740$23752[0]==="send"))&&((t1$23758=$23740$23752[1]),((t1$23758 instanceof Array)&&((t2$23759=t1$23758.length),((t2$23759===2)&&((t1$23758[0]==="variable")&&((t1$23758[1]==="___node")&&((t3$23760=$23740$23752[2]),((t3$23760 instanceof Array)&&((t4$23761=t3$23760.length),((t4$23761===2)&&(t3$23760[0]==="value"))))))))))))))){(f$23865=t3$23760[1]);return f$23865;}else{if(($23746$23770&&((bridge$23741$23762=$23740$23752[1]),((((bridge$23741$23762 instanceof Array)&&((t0$23879=bridge$23741$23762.length),((t0$23879===2)&&((bridge$23741$23762[0]==="symbol")&&(bridge$23741$23762[1]==="___js_fetch")))))||((bridge$23741$23762 instanceof Array)&&((t0$23882=bridge$23741$23762.length),((t0$23882===2)&&((bridge$23741$23762[0]==="variable")&&(bridge$23741$23762[1]==="___js_fetch"))))))&&((t1$23758=$23740$23752[2]),((t1$23758 instanceof Array)&&((t2$23759=t1$23758.length),((t2$23759===3)&&(t1$23758[0]==="array"))))))))){(f$23874=t1$23758[1]);(msg$23875=t1$23758[2]);(trf$23888=it$0$23735.translate(f$23874,"expr"));;(trmsg$23889=it$0$23735.translate(msg$23875,"expr"));;return it$0$23735.expr((((trf$23888+"[")+trmsg$23889)+"]"),mode$23732);}else{if(($23746$23770&&((f$23898=$23740$23752[1]),((t1$23758=$23740$23752[2]),((msg$23899=t1$23758),((t1$23758 instanceof Array)&&((t2$23759=t1$23758.length),((t2$23759===2)&&(t1$23758[0]==="value"))))))))){(s$23900=t1$23758[1]);($23907$23909=null);;$23907$23909;if(((typeof(s$23900)==="string")&&s$23900.match(RegExp("(?:^(?:[a-zA-Z_$]+)$)","")))){(trf$23920=it$0$23735.translate(f$23898,"expr"));;(trmsg$23921=it$0$23735.translate(["symbol",s$23900],"expr"));;return it$0$23735.expr(((trf$23920+".")+trmsg$23921),mode$23732);}else{(otherwise$23930=$23907$23909);(trf$23933=it$0$23735.translate(f$23898,"expr"));;(trmsg$23934=it$0$23735.translate(msg$23899,"expr"));;return it$0$23735.expr((((trf$23933+"[")+trmsg$23934)+"]"),mode$23732);}}else{if(($23746$23770&&((f$23943=$23740$23752[1]),((t1$23758=$23740$23752[2]),((t1$23758 instanceof Array)&&((t2$23759=t1$23758.length),((t2$23759>=1)&&(t1$23758[0]==="array")))))))){(args$23944=Array.prototype.slice.call(t1$23758,1));(op$23951=((($23954$23959=f$23943)),function(){if((($23955$23966=($23954$23959 instanceof Array))&&((t0$23964=$23954$23959.length),(($23957$23968=(t0$23964===2))&&($23954$23959[0]==="symbol"))))){(x$23971=$23954$23959[1]);return $23328(js_op_table$23380,x$23971);}else{if(($23957$23968&&($23954$23959[0]==="variable"))){(x$23977=$23954$23959[1]);return $23328(js_op_table2$23379,x$23977);}else{$23954$23959;return null;}}}()));;if(op$23951){return it$0$23735.expr(it$0$23735.op(op$23951,args$23944[0],args$23944[1]),mode$23732);}else{(trf$23985=it$0$23735.translate(f$23943,"expr"));;(trargs$23986=(((acc$23995=[])),(((temp$24000=args$23944)),((($length$24005=temp$24000.length)),((($index$24010=0)),function(){$23992:for(;($index$24010<$length$24005);($index$24010++)){var x$24026;var m$24018;(m$24018=temp$24000[$index$24010]);;(x$24026=m$24018);acc$23995.push(it$0$23735.translate(x$24026,"expr"));}}()))),acc$23995));;return it$0$23735.expr((((trf$23985+"(")+trargs$23986.join(","))+")"),mode$23732);}}else{if($23746$23770){(f$24031=$23740$23752[1]);(msg$24032=$23740$23752[2]);(t0$24038=(((code$24042="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$23735.register_raw(code$24042,"~send")));if(((t0$24038 instanceof Array)&&((t1$24039=t0$24038.length),((t1$24039===2)&&(t0$24038[0]==="symbol"))))){(codevar$24036=t0$24038[1]);;}else{$24899((((code$24050="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$23735.register_raw(code$24050,"~send")),"/home/olivier/git/earl-grey/src/translate-js.eg",6890,7100);}(trf$24055=it$0$23735.translate(f$24031,"expr"));;(trmsg$24056=it$0$23735.translate(msg$24032,"expr"));;return it$0$23735.expr((((((codevar$24036+"(")+trf$24055)+",")+trmsg$24056)+")"),mode$23732);}else{if(($23743$23767&&(($23745$23769=(t0$23757>=1))&&($23740$23752[0]==="array")))){(args$24065=Array.prototype.slice.call($23740$23752,1));(r$24069=(((f$24073=function(x$24077){return it$0$23735.translate(x$24077,"expr");})),(("["+args$24065.map(f$24073).join(","))+"]")));;return it$0$23735.expr(r$24069,mode$23732);}else{if(($23745$23769&&($23740$23752[0]==="object"))){(args$24083=Array.prototype.slice.call($23740$23752,1));(all_strings$24087=args$24083.every(function($24091$24093){var t0$24099;var t1$24100;var other$24121;var v$24115;var t0$24111;var $24095$24106;var ph$24096;var y$24097;(t0$24099=$24091$24093);if(((t0$24099 instanceof Array)&&((t1$24100=t0$24099.length),((t1$24100===3)&&(t0$24099[0]==="array"))))){(ph$24096=t0$24099[1]);(y$24097=t0$24099[2]);;}else{$24899($24091$24093);}($24095$24106=ph$24096);;if((($24095$24106 instanceof Array)&&((t0$24111=$24095$24106.length),((t0$24111===2)&&($24095$24106[0]==="value"))))){(v$24115=$24095$24106[1]);return true;}else{(other$24121=$24095$24106);return false;}}));;(r$24088=function(){if(all_strings$24087){(f$24127=function($24130$24132){var t0$24137;var t1$24138;var a$24144;var b$24145;var x$24134;var y$24135;(t0$24137=$24130$24132);if(((t0$24137 instanceof Array)&&((t1$24138=t0$24137.length),((t1$24138===3)&&(t0$24137[0]==="array"))))){(x$24134=t0$24137[1]);(y$24135=t0$24137[2]);;}else{$24899($24130$24132);}(a$24144=it$0$23735.translate(x$24134,"expr"));;(b$24145=it$0$23735.translate(y$24135,"expr"));;return ((a$24144+":")+b$24145);});;return (("({"+args$24083.map(f$24127).join(","))+"})");}else{(v$24154=gensym$23376());;(f$24159=function($24162$24164){var t0$24169;var t1$24170;var a$24176;var b$24177;var x$24166;var y$24167;(t0$24169=$24162$24164);if(((t0$24169 instanceof Array)&&((t1$24170=t0$24169.length),((t1$24170===3)&&(t0$24169[0]==="array"))))){(x$24166=t0$24169[1]);(y$24167=t0$24169[2]);;}else{$24899($24162$24164);}(a$24176=it$0$23735.translate(x$24166,"expr"));;(b$24177=it$0$23735.translate(y$24167,"expr"));;return (((((v$24154+"[")+a$24176)+"]=")+b$24177)+";");});;return ((((((("(function(){"+"var ")+v$24154)+"={};")+args$24083.map(f$24159).join(""))+";return ")+v$24154)+";}())");}}());;return it$0$23735.expr(r$24088,mode$23732);}else{if(($23743$23767&&((t0$23757===3)&&($23740$23752[0]==="lambda")))){(bindings$24188=$23740$23752[1]);(body$24189=$23740$23752[2]);(a$24193=(((acc$24204=[])),(((temp$24209=bindings$24188)),((($length$24214=temp$24209.length)),((($index$24219=0)),function(){$24201:for(;($index$24219<$length$24214);($index$24219++)){var x$24235;var m$24227;(m$24227=temp$24209[$index$24219]);;(x$24235=m$24227);acc$24204.push(it$0$23735.translate(x$24235,"expr"));}}()))),acc$24204).join(","));;(b$24194=it$0$23735.body(body$24189,"return"));;return it$0$23735.expr((((("function("+a$24193)+"){")+b$24194)+"}"),mode$23732);}else{if(($23743$23767&&(($23745$23769=(t0$23757===4))&&(($23746$23770=($23740$23752[0]==="if"))&&((test$24243=$23740$23752[1]),((pos$24244=$23740$23752[2]),((t1$23758=$23740$23752[3]),((t1$23758 instanceof Array)&&((t2$23759=t1$23758.length),((t2$23759===2)&&((t1$23758[0]==="value")&&(t1$23758[1]===(void 0))))))))))))){($24251$24253=mode$23732);;if(($24251$24253==="expr")){return it$0$23735.body(expr$23731,"expr");}else{(other$24265=$24251$24253);(a$24268=it$0$23735.translate(test$24243,"expr"));;(b$24269=it$0$23735.translate(pos$24244,mode$23732));;return (((("if("+a$24268)+"){")+b$24269)+"}");}}else{if($23746$23770){(test$24278=$23740$23752[1]);(pos$24279=$23740$23752[2]);(neg$24280=$23740$23752[3]);($24283$24285=mode$23732);;if(($24283$24285==="expr")){return it$0$23735.body(expr$23731,"expr");}else{(other$24297=$24283$24285);(a$24300=it$0$23735.translate(test$24278,"expr"));;(b$24301=it$0$23735.translate(pos$24279,mode$23732));;(c$24302=it$0$23735.translate(neg$24280,mode$23732));;return (((((("if("+a$24300)+"){")+b$24301)+"}else{")+c$24302)+"}");}}else{if(($23743$23767&&(($23745$23769=(t0$23757===3))&&(($23746$23770=($23740$23752[0]==="declare"))&&((binding$24314=$23740$23752[1]),((t1$23758=$23740$23752[2]),((t1$23758 instanceof Array)&&((t2$23759=t1$23758.length),((t2$23759===2)&&((t1$23758[0]==="value")&&(t1$23758[1]===(void 0)))))))))))){($24320$24323=mode$23732);;(bridge$24321$24328=$24320$24323);if(((bridge$24321$24328==="expr")||(bridge$24321$24328==="return"))){throw "Invalid in expr ctx";}else{(other$24336=$24320$24323);(a$24339=it$0$23735.translate(binding$24314,"expr"));;return (("var "+a$24339)+";");}}else{if($23746$23770){(binding$24345=$23740$23752[1]);(value$24346=$23740$23752[2]);($24349$24352=mode$23732);;(bridge$24350$24357=$24349$24352);if(((bridge$24350$24357==="expr")||(bridge$24350$24357==="return"))){throw "Invalid in expr ctx";}else{(other$24365=$24349$24352);(a$24368=it$0$23735.translate(binding$24345,"expr"));;(b$24369=it$0$23735.translate(value$24346,"expr"));;return (((("var "+a$24368)+"=")+b$24369)+";");}}else{if(($23745$23769&&(($23746$23770=($23740$23752[0]==="assign"))&&((t1$23758=$23740$23752[1]),((t1$23758 instanceof Array)&&((t2$23759=t1$23758.length),((t2$23759===3)&&(t1$23758[0]==="send")))))))){(obj$24378=t1$23758[1]);(msg$24379=t1$23758[2]);(rhs$24380=$23740$23752[2]);(a$24386=it$0$23735.translate(obj$24378,"expr"));;(b$24387=it$0$23735.translate(msg$24379,"expr"));;(c$24388=it$0$23735.translate(rhs$24380,"expr"));;return it$0$23735.expr((((((("("+a$24386)+"[")+b$24387)+"]=")+c$24388)+")"),mode$23732);}else{if($23746$23770){(lhs$24400=$23740$23752[1]);(rhs$24401=$23740$23752[2]);(a$24405=it$0$23735.translate(lhs$24400,"expr"));;(b$24406=it$0$23735.translate(rhs$24401,"expr"));;return it$0$23735.expr((((("("+a$24405)+"=")+b$24406)+")"),mode$23732);}else{if(($23743$23767&&((t0$23757===1)&&($23740$23752[0]==="multi")))){if((mode$23732==="stmt")){return ";";}else{return "";}}else{if(($23743$23767&&(($23745$23769=(t0$23757>=1))&&($23740$23752[0]==="multi")))){(args$24419=Array.prototype.slice.call($23740$23752,1));(isdecl$24425=function($24428$24430){var other$24454;var variable$24447;var value$24448;var t0$24443;var $24432$24438;var ph$24433;(ph$24433=$24428$24430);;($24432$24438=ph$24433);;if((($24432$24438 instanceof Array)&&((t0$24443=$24432$24438.length),((t0$24443===3)&&($24432$24438[0]==="declare"))))){(variable$24447=$24432$24438[1]);(value$24448=$24432$24438[2]);return true;}else{(other$24454=$24432$24438);return false;}});;($24423$24458=null);;$24423$24458;if((args$24419.length===1)){return it$0$23735.translate(args$24419[0],mode$23732);}else{if(((mode$23732==="expr")&&(!args$24419.some(isdecl$24425)))){(xs$24474=(((acc$24480=[])),(((temp$24485=args$24419)),((($length$24490=temp$24485.length)),((($index$24495=0)),function(){$24477:for(;($index$24495<$length$24490);($index$24495++)){var x$24511;var m$24503;(m$24503=temp$24485[$index$24495]);;(x$24511=m$24503);acc$24480.push(it$0$23735.translate(x$24511,"expr"));}}()))),acc$24480));;(xs$24474=(((acc$24517=[])),(((temp$24522=xs$24474)),((($length$24527=temp$24522.length)),((($index$24532=0)),function(){$24514:for(;($index$24532<$length$24527);($index$24532++)){var x$24548;var m$24540;(m$24540=temp$24522[$index$24532]);;(x$24548=m$24540);if((x$24548!=="")){acc$24517.push(x$24548);}else{false;;}}}()))),acc$24517));return (("("+xs$24474.join(","))+")");}else{return it$0$23735.body(expr$23731,mode$23732);}}}else{if(($23745$23769&&($23740$23752[0]==="splice"))){(args$24558=Array.prototype.slice.call($23740$23752,1));return it$0$23735.translate(["multi"].concat(args$24558),mode$23732);}else{if(($23743$23767&&((t0$23757===2)&&($23740$23752[0]==="variable")))){(s$24563=$23740$23752[1]);return it$0$23735.expr(it$0$23735.mangle(s$24563),mode$23732);}else{if(($23743$23767&&((t0$23757===3)&&($23740$23752[0]==="scope")))){(vars$24568=$23740$23752[1]);(body$24569=$23740$23752[2]);(decls$24573=(((acc$24579=[])),(((temp$24584=vars$24568)),((($length$24589=temp$24584.length)),((($index$24594=0)),function(){$24576:for(;($index$24594<$length$24589);($index$24594++)){var v$24610;var m$24602;(m$24602=temp$24584[$index$24594]);;(v$24610=m$24602);acc$24579.push(["declare",v$24610,["value",(void 0)]]);}}()))),acc$24579));;return it$0$23735.translate(["multi"].concat(decls$24573).concat([body$24569]),mode$23732);}else{if(($23743$23767&&((t0$23757>=1)&&($23740$23752[0]==="object2")))){(args$24615=Array.prototype.slice.call($23740$23752,1));(r$24619=(((f$24623=function($24626$24628){var t0$24633;var t1$24634;var a$24640;var b$24641;var x$24630;var y$24631;(t0$24633=$24626$24628);if(((t0$24633 instanceof Array)&&((t1$24634=t0$24633.length),(t1$24634===2)))){(x$24630=t0$24633[0]);(y$24631=t0$24633[1]);;}else{$24899($24626$24628);}(a$24640=it$0$23735.translate(x$24630,"expr"));;(b$24641=it$0$23735.translate(y$24631,"expr"));;return ((a$24640+":")+b$24641);})),(("({"+args$24615.map(f$24623).join(","))+"})")));;return it$0$23735.expr(r$24619,mode$23732);}else{if(($23743$23767&&((t0$23757===2)&&($23740$23752[0]==="js_new")))){(value$24652=$23740$23752[1]);return it$0$23735.expr((("(new "+it$0$23735.translate(value$24652,"expr"))+")"),mode$23732);}else{if(($23743$23767&&(($23745$23769=((t0$23757>=1)&&(t0$23757<=2)))&&(($23740$23752[0]==="js_break")&&((t1$23758=function(){if((1>=t0$23757)){return ["value",null];}else{return $23740$23752[1];}}()),((t1$23758 instanceof Array)&&((t2$23759=t1$23758.length),((t2$23759===2)&&(t1$23758[0]==="value"))))))))){(label$24657=t1$23758[1]);if((mode$23732==="expr")){throw "Invalid break in ctx";}else{return (("break"+function(){if(label$24657){return (" "+label$24657);}else{return "";}}())+";");}}else{if(($23745$23769&&(($23740$23752[0]==="js_continue")&&((t1$23758=function(){if((1>=t0$23757)){return ["value",null];}else{return $23740$23752[1];}}()),((t1$23758 instanceof Array)&&((t2$23759=t1$23758.length),((t2$23759===2)&&(t1$23758[0]==="value")))))))){(label$24664=t1$23758[1]);if((mode$23732==="expr")){throw "Invalid continue in ctx";}else{return (("continue"+function(){if(label$24664){return (" "+label$24664);}else{return "";}}())+";");}}else{if(($23743$23767&&(($23745$23769=(t0$23757===2))&&($23740$23752[0]==="js_return")))){(value$24671=$23740$23752[1]);if((mode$23732==="expr")){throw "Invalid return in ctx";}else{return (("return "+it$0$23735.translate(value$24671,"expr"))+";");}}else{if(($23745$23769&&($23740$23752[0]==="js_delete"))){(value$24676=$23740$23752[1]);if((mode$23732==="expr")){throw "Invalid delete in ctx";}else{return (("delete "+it$0$23735.translate(value$24676,"expr"))+";");}}else{if(($23745$23769&&($23740$23752[0]==="js_throw"))){(value$24681=$23740$23752[1]);if((mode$23732==="expr")){return (("function(){throw "+it$0$23735.translate(value$24681,"expr"))+";}()");}else{return (("throw "+it$0$23735.translate(value$24681,"expr"))+";");}}else{if(($23743$23767&&(($23745$23769=(t0$23757===3))&&(($23740$23752[0]==="js_label")&&((t1$23758=$23740$23752[1]),((t1$23758 instanceof Array)&&((t2$23759=t1$23758.length),((t2$23759===2)&&(t1$23758[0]==="value"))))))))){(label$24686=t1$23758[1]);(body$24687=$23740$23752[2]);($24692$24694=mode$23732);;if(($24692$24694==="expr")){return it$0$23735.body(expr$23731,"expr");}else{(other$24706=$24692$24694);return ((label$24686+":")+it$0$23735.translate(body$24687,other$24706));}}else{if(($23745$23769&&($23740$23752[0]==="js_while"))){(test$24710=$23740$23752[1]);(body$24711=$23740$23752[2]);($24714$24716=mode$23732);;if(($24714$24716==="expr")){return it$0$23735.body(expr$23731,"expr");}else{(other$24728=$24714$24716);(a$24731=it$0$23735.translate(test$24710,"expr"));;(b$24732=it$0$23735.translate(body$24711,"stmt"));;return (((("while("+a$24731)+"){")+b$24732)+"}");}}else{if(($23743$23767&&((t0$23757===5)&&($23740$23752[0]==="js_for")))){(x$24741=$23740$23752[1]);(y$24742=$23740$23752[2]);(z$24743=$23740$23752[3]);(body$24744=$23740$23752[4]);($24747$24749=mode$23732);;if(($24747$24749==="expr")){return it$0$23735.body(expr$23731,"expr");}else{(other$24761=$24747$24749);(a$24764=it$0$23735.translate(x$24741,"stmt"));;(b$24765=it$0$23735.translate(y$24742,"stmt"));;(c$24766=it$0$23735.translate(z$24743,"expr"));;(d$24767=it$0$23735.translate(body$24744,"stmt"));;return (((((("for("+a$24764)+b$24765)+c$24766)+"){")+d$24767)+"}");}}else{if(($23743$23767&&(($23745$23769=(t0$23757===4))&&($23740$23752[0]==="js_for_in")))){(x$24782=$23740$23752[1]);(y$24783=$23740$23752[2]);(body$24784=$23740$23752[3]);($24787$24789=mode$23732);;if(($24787$24789==="expr")){return it$0$23735.body(expr$23731,"expr");}else{(other$24801=$24787$24789);(a$24804=it$0$23735.translate(x$24782,"expr"));;(b$24805=it$0$23735.translate(y$24783,"expr"));;(c$24806=it$0$23735.translate(body$24784,"stmt"));;return (((((("for("+a$24804)+" in ")+b$24805)+"){")+c$24806)+"}");}}else{if(($23745$23769&&(($23740$23752[0]==="js_try")&&((attempt$24818=$23740$23752[1]),((t1$23758=$23740$23752[2]),((t1$23758 instanceof Array)&&((t2$23759=t1$23758.length),((t2$23759===3)&&((t1$23758[0]==="lambda")&&((t3$23760=t1$23758[1]),((t3$23760 instanceof Array)&&((t4$23761=t3$23760.length),((t4$23761===1)&&((bridge$23742$23763=t3$23760[0]),((((bridge$23742$23763 instanceof Array)&&((t0$24829=bridge$23742$23763.length),((t0$24829===2)&&((bridge$23742$23763[0]==="symbol")&&((v$24819=bridge$23742$23763[1]),true)))))||((bridge$23742$23763 instanceof Array)&&((t0$24833=bridge$23742$23763.length),((t0$24833===2)&&((bridge$23742$23763[0]==="variable")&&((v$24819=bridge$23742$23763[1]),true))))))&&((body$24820=t1$23758[2]),((t5$23764=$23740$23752[3]),((t5$23764 instanceof Array)&&((t6$23765=t5$23764.length),((t6$23765===1)&&(t5$23764[0]==="void"))))))))))))))))))))){($24840$24842=mode$23732);;if(($24840$24842==="expr")){return it$0$23735.body(expr$23731,"expr");}else{(other$24854=$24840$24842);(a$24857=it$0$23735.translate(attempt$24818,"stmt"));;(b$24858=it$0$23735.translate(body$24820,"stmt"));;return (((((("try{"+a$24857)+"}catch(")+v$24819)+"){")+b$24858)+"}");}}else{if(($23743$23767&&((t0$23757===2)&&($23740$23752[0]==="raw")))){(x$24867=$23740$23752[1]);return x$24867;}else{(other$24872=$23740$23752);throw other$24872;}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}});$23329(Translator$23381,$23329(((accum$24875=({})),((accum$24875["::name"]="Translator"),accum$24875)),((accum$24879=({})),((accum$24879["::egclass"]=true),accum$24879))));Translator$23381;(translate$23382=function(expr$24885,mode$24886){var tr$24889;var t$24890;(tr$24889=Translator$23381());;(t$24890=tr$24889.translate(expr$24885,mode$24886));;return (tr$24889.dump_store()+t$24890);});;(exports["Translator"]=Translator$23381);(exports["translate"]=translate$23382);

},{"./pp":11,"./util":14}],14:[function(require,module,exports){
var $25330=function(type$25332){var f$25335;(f$25335=type$25332["::check"]);;if((f$25335===(void 0))){return function(value$25340){return (value$25340 instanceof type$25332);};}else{return function(value$25343){return f$25335.call(type$25332,value$25343);};}};
var $25345=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $25346=function(dest$25348,values$25349){var k$25354;(k$25354=null);$25352:for(k$25354 in values$25349){if(values$25349.hasOwnProperty(k$25354)){(dest$25348[k$25354]=values$25349[k$25354]);}}return dest$25348;};
var $25358=function($25359$25361){var ph$25365;(ph$25365=$25359$25361);;var $25363$25370;($25363$25370=ph$25365);;var bridge$25364$25375;var x$25379;(bridge$25364$25375=$25363$25370);if((((typeof(bridge$25364$25375)==="string")&&((x$25379=bridge$25364$25375),true))||((typeof(bridge$25364$25375)==="number")&&((x$25379=bridge$25364$25375),true)))){return ["value",x$25379];}else{var other$25386;(other$25386=$25363$25370);return other$25386["::serialize_ast"]();}};
var send$25170;(send$25170=function(obj$25175,$25173$25176){var ph$25180;var msg$25181;var t0$25183;(t0$25183=$25173$25176);(msg$25181=t0$25183);(ph$25180=t0$25183);;var $25178$25187;($25178$25187=ph$25180);;var bridge$25179$25192;(bridge$25179$25192=$25178$25187);if(((typeof(bridge$25179$25192)==="string")||(typeof(bridge$25179$25192)==="number"))){return obj$25175[msg$25181];}else{var other$25200;(other$25200=$25178$25187);return obj$25175["::send"](msg$25181);}});;(Array[":::project"]=function($25203$25205){var ph$25208;var value$25209;var t0$25211;(t0$25211=$25203$25205);(value$25209=t0$25211);(ph$25208=t0$25211);;var $25207$25215;($25207$25215=ph$25208);;if($25330(Array)($25207$25215)){return [true,value$25209];}else{$25207$25215;return [true,[value$25209]];}});(Array.prototype["::check"]=function(value$25229){if((value$25229 instanceof Array)){var i$25234;(i$25234=0);;$25232:for(;(i$25234<this.length);(i$25234++)){if(($25345(this,i$25234)!==$25345(value$25229,i$25234))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $25346(this.slice(0),this);});(Array.prototype[":::project"]=function(value$25245){if((value$25245 instanceof Array)){var i$25250;(i$25250=0);;$25248:for(;(i$25250<this.length);(i$25250++)){if(($25345(this,i$25250)!==$25345(value$25245,i$25250))){return [true,[value$25245]];}}return [true,value$25245.slice(this.length)];}else{return [true,[value$25245]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($25358));});(RegExp.prototype["::check"]=function($25260$25262){var ph$25265;(ph$25265=$25260$25262);;var $25264$25270;($25264$25270=ph$25265);;var value$25278;if((typeof($25264$25270)==="string")){(value$25278=$25264$25270);if(value$25278.match(this)){return true;}else{return false;}}else{var other$25283;(other$25283=$25264$25270);return false;}});(RegExp.prototype[":::project"]=function($25285$25287){var ph$25290;(ph$25290=$25285$25287);;var $25289$25295;($25289$25295=ph$25290);;var value$25303;if((typeof($25289$25295)==="string")){(value$25303=$25289$25295);var $25306$25308;($25306$25308=value$25303.match(this));;var m$25316;if(($25306$25308===null)){(m$25316=$25306$25308);return [false,null];}else{var m$25321;(m$25321=$25306$25308);return [true,m$25321];}}else{var other$25325;(other$25325=$25289$25295);return [false,null];}});(Function.prototype["::send"]=function(args$25328){return this.apply(this,args$25328);});
var $26197=function(arr$26199){var results$26203;var l$26204;(results$26203=[]);;(l$26204=arr$26199.length);;var i$26212;(i$26212=0);;$26202:for(;(i$26212<l$26204);(i$26212++)){results$26203.push([i$26212,$25345(arr$26199,i$26212)]);}return results$26203;};
var $26028=function(){var $26029$26031;($26029$26031=function(tags$26035){var it$0$26038;(it$0$26038=function(){if((!$25330($26029$26031)(this))){return Object.create($26029$26031.prototype);}else{return this;}}());;(it$0$26038["tags"]=tags$26035);return it$0$26038;});;($26029$26031.prototype["create"]=function(){var $26047$26049;($26047$26049=arguments);;var t0$26054;var message$26058;var args$26059;(t0$26054=$26047$26049.length);if((t0$26054>=0)){(message$26058=function(){if((0>=t0$26054)){return "";}else{return $26047$26049[0];}}());(args$26059=Array.prototype.slice.call($26047$26049,1));var it$0$26063;(it$0$26063=this);;var self$26068;(self$26068=this);;var e$26073;(e$26073=Error(message$26058));;(e$26073["::tags"]=it$0$26063.tags);(e$26073["args"]=args$26059);var temp$26081;(temp$26081=$26197(args$26059));;var $length$26086;($length$26086=temp$26081.length);;var $index$26091;($index$26091=0);;$26074:for(;($index$26091<$length$26086);($index$26091++)){var m$26099;(m$26099=temp$26081[$index$26091]);;var t0$26104;var t1$26105;var i$26109;var arg$26110;(t0$26104=m$26099);if(((t0$26104 instanceof Array)&&((t1$26105=t0$26104.length),(t1$26105===2)))){(i$26109=t0$26104[0]);(arg$26110=t0$26104[1]);(e$26073[i$26109]=arg$26110);}else{$26015(m$26099);;}}(e$26073["length"]=args$26059.length);(e$26073["name"]=["E"].concat(it$0$26063.tags).join("."));return e$26073;}else{$26015($26047$26049);}});($26029$26031.prototype["::check"]=function(e$26121){var it$0$26124;(it$0$26124=this);;var self$26129;(self$26129=this);;var tags$26134;if(((!e$26121)||(!$25330(Error)(e$26121)))){return false;}(tags$26134=(e$26121["::tags"]||[]));;var temp$26143;(temp$26143=it$0$26124.tags);;var $length$26148;($length$26148=temp$26143.length);;var $index$26153;($index$26153=0);;$26135:for(;($index$26153<$length$26148);($index$26153++)){var m$26161;(m$26161=temp$26143[$index$26153]);;var tag$26169;(tag$26169=m$26161);if((tags$26134.indexOf(tag$26169)===-1)){return false;}else{false;;}}return true;});($26029$26031.prototype["::deconstruct"]=function(e$26177){var it$0$26180;(it$0$26180=this);;var self$26185;(self$26185=this);;return e$26177.args;});$25346($26029$26031,$25346(function(){var accum$26190;(accum$26190=({}));(accum$26190["::name"]="$26029");return accum$26190;}(),function(){var accum$26194;(accum$26194=({}));(accum$26194["::egclass"]=true);return accum$26194;}()));return $26029$26031;}();
var $26015=function(value$26017,url$26018,start$26019,end$26020){var err$26023;(err$26023=$26028(["match"]).create("Could not find a match for value",({"value":value$26017})));;if(url$26018){(err$26023["location"]=["location",url$26018,start$26019,end$26020]);}throw err$26023;};var GenSym$25390;var gensym$25391;var uuid$25392;var identity$25393;var binsearch$25394;var __classify$25395;var classify$25396;var classify_contiguous$25397;var neighbours$25398;var partition$25399;var construct$25400;var mkset$25401;var make_object$25402;var product$25403;(GenSym$25390=function(prefix$25407){var id$25410;(id$25410=0);;return function(){var r$25430;var pfx$25426;var t0$25422;var $25415$25417;($25415$25417=arguments);;(t0$25422=$25415$25417.length);if(((t0$25422>=0)&&(t0$25422<=1))){(pfx$25426=function(){if((0>=t0$25422)){return null;}else{return $25415$25417[0];}}());(r$25430=(((pfx$25426||"")+prefix$25407)+[true,String(id$25410)][1]));;(id$25410++);return r$25430;}else{$26015($25415$25417);}};});;(gensym$25391=GenSym$25390("$"));;(uuid$25392=function(){return gensym$25391("#");});;(identity$25393=function(x$25448){return x$25448;});;(binsearch$25394=function(xs$25454,x$25455){var lo$25458;var hi$25459;(lo$25458=0);;(hi$25459=(xs$25454.length-1));;$25466:while((lo$25458<=hi$25459)){var $25470$25480;var mid$25471;var v$25472;(mid$25471=(lo$25458+((hi$25459-lo$25458)>>1)));;(v$25472=$25345(xs$25454,mid$25471));;($25470$25480=$25345(xs$25454,mid$25471));;if(($25470$25480<x$25455)){(lo$25458=(mid$25471+1));}else{if(($25470$25480>x$25455)){(hi$25459=(mid$25471-1));}else{$25470$25480;return (mid$25471+1);}}}return lo$25458;});;(__classify$25395=function(xs$25501){var results$25504;(results$25504=({}));;$25508:while(xs$25501.length){var cls$25534;var x$25535;var newxs$25528;var $25512$25523;var $25513$25524;var $25514$25525;var t0$25521;var $25511$25516;($25511$25516=xs$25501.shift());;if((($25512$25523=($25511$25516 instanceof Array))&&((t0$25521=$25511$25516.length),(($25514$25525=(t0$25521===2))&&($25511$25516[0]==="splice"))))){(newxs$25528=$25511$25516[1]);(xs$25501=newxs$25528.concat(xs$25501));}else{if($25514$25525){(cls$25534=$25511$25516[0]);(x$25535=$25511$25516[1]);if((!$25345(results$25504,cls$25534))){(results$25504[cls$25534]=[]);}$25345(results$25504,cls$25534).push(x$25535);}else{$26015($25511$25516);;}}}return results$25504;});;(classify$25396=function(){var $index$25580;var $length$25575;var temp$25570;var results$25562;var classes$25557;var xs$25558;var t0$25553;var $25546$25548;($25546$25548=arguments);;(t0$25553=$25546$25548.length);if((t0$25553>=1)){(classes$25557=Array.prototype.slice.call($25546$25548,0,-1));(xs$25558=$25546$25548[(t0$25553-1)]);(results$25562=({"rest":[]}));;(temp$25570=classes$25557);;($length$25575=temp$25570.length);;($index$25580=0);;$25563:for(;($index$25580<$length$25575);($index$25580++)){var cls$25596;var m$25588;(m$25588=temp$25570[$index$25580]);;(cls$25596=m$25588);(results$25562[cls$25596]=[]);}$25598:while(xs$25558.length){var x$25620;var other$25636;var cls$25627;var x$25628;var newxs$25612;var t0$25608;var $25601$25603;($25601$25603=xs$25558.shift());;if((($25601$25603 instanceof Array)&&((t0$25608=$25601$25603.length),((t0$25608>=1)&&($25601$25603[0]==="splice"))))){(newxs$25612=Array.prototype.slice.call($25601$25603,1));(xs$25558=newxs$25612.concat(xs$25558));}else{if((((x$25620=$25601$25603)),((x$25620 instanceof Array)&&(x$25620[0]==="ignore")))){null;}else{if((($25601$25603 instanceof Array)&&((t0$25608=$25601$25603.length),((t0$25608===2)&&((cls$25627=$25601$25603[0]),((x$25628=$25601$25603[1]),$25345(results$25562,cls$25627))))))){$25345(results$25562,cls$25627).push(x$25628);}else{(other$25636=$25601$25603);results$25562.rest.push(other$25636);}}}}return results$25562;}else{$26015($25546$25548);}});;(classify_contiguous$25397=function(xs$25644,classifier$25645){var $index$25674;var $length$25669;var temp$25664;var groups$25648;var currcls$25649;var curr$25650;(groups$25648=[]);;(currcls$25649=null);;(curr$25650=null);;(temp$25664=xs$25644);;($length$25669=temp$25664.length);;($index$25674=0);;$25651:for(;($index$25674<$length$25669);($index$25674++)){var cls$25693;var x$25690;var m$25682;(m$25682=temp$25664[$index$25674]);;(x$25690=m$25682);(cls$25693=classifier$25645(x$25690));;if((cls$25693===currcls$25649)){curr$25650.push(x$25690);}else{if(curr$25650){groups$25648.push(curr$25650);}(curr$25650=[cls$25693,x$25690]);(currcls$25649=cls$25693);}}if(curr$25650){groups$25648.push(curr$25650);}return groups$25648;});;(neighbours$25398=function($25703$25705){var x$25736;var y$25737;var rest$25738;var x$25731;var $25708$25722;var $25709$25723;var t0$25720;var $25707$25715;var ph$25710;(ph$25710=$25703$25705);;($25707$25715=ph$25710);;if((($25708$25722=($25707$25715 instanceof Array))&&((t0$25720=$25707$25715.length),(t0$25720===0)))){return [];}else{if(($25708$25722&&(t0$25720===1))){(x$25731=$25707$25715[0]);return [];}else{if(($25708$25722&&(t0$25720>=2))){(x$25736=$25707$25715[0]);(y$25737=$25707$25715[1]);(rest$25738=Array.prototype.slice.call($25707$25715,2));return [[x$25736,y$25737]].concat(neighbours$25398([y$25737].concat(rest$25738)));}else{$26015($25707$25715);}}}});;(partition$25399=function(xs$25747,predicate$25748){var $index$25773;var $length$25768;var temp$25763;var t$25751;var f$25752;(t$25751=[]);;(f$25752=[]);;(temp$25763=xs$25747);;($length$25768=temp$25763.length);;($index$25773=0);;$25753:for(;($index$25773<$length$25768);($index$25773++)){var x$25794;var x$25789;var m$25781;(m$25781=temp$25763[$index$25773]);;(x$25789=m$25781);if(predicate$25748(x$25789)){t$25751.push(x$25789);}else{(x$25794=m$25781);f$25752.push(x$25794);}}return [t$25751,f$25752];});;(construct$25400=function($25799$25801,fn$25802,zero$25803){var x$25834;var rest$25835;var x$25829;var $25806$25820;var $25807$25821;var t0$25818;var $25805$25813;var ph$25808;(ph$25808=$25799$25801);;($25805$25813=ph$25808);;if((($25806$25820=($25805$25813 instanceof Array))&&((t0$25818=$25805$25813.length),(t0$25818===0)))){return zero$25803;}else{if(($25806$25820&&(t0$25818===1))){(x$25829=$25805$25813[0]);return x$25829;}else{if(($25806$25820&&(t0$25818>=1))){(x$25834=$25805$25813[0]);(rest$25835=Array.prototype.slice.call($25805$25813,1));return fn$25802(x$25834,construct$25400(rest$25835,fn$25802,zero$25803));}else{$26015($25805$25813);}}}});;(mkset$25401=function(xs$25844){var $index$25865;var $length$25860;var temp$25855;var rval$25847;(rval$25847=({}));;(temp$25855=xs$25844);;($length$25860=temp$25855.length);;($index$25865=0);;$25848:for(;($index$25865<$length$25860);($index$25865++)){var x$25881;var m$25873;(m$25873=temp$25855[$index$25865]);;(x$25881=m$25873);(rval$25847[x$25881]=true);}return rval$25847;});;(make_object$25402=function(pairs$25887){var $index$25908;var $length$25903;var temp$25898;var rval$25890;(rval$25890=({}));;(temp$25898=pairs$25887);;($length$25903=temp$25898.length);;($index$25908=0);;$25891:for(;($index$25908<$length$25903);($index$25908++)){var k$25926;var v$25927;var t0$25921;var t1$25922;var m$25916;(m$25916=temp$25898[$index$25908]);;(t0$25921=m$25916);if(((t0$25921 instanceof Array)&&((t1$25922=t0$25921.length),(t1$25922===2)))){(k$25926=t0$25921[0]);(v$25927=t0$25921[1]);(rval$25890[k$25926]=v$25927);}else{$26015(m$25916,"/home/olivier/git/earl-grey/src/util.eg",2736,2779);;}}return rval$25890;});;(product$25403=function(a$25937,b$25938){var $index$25959;var $length$25954;var temp$25949;var results$25941;(results$25941=[]);;(temp$25949=a$25937);;($length$25954=temp$25949.length);;($index$25959=0);;$25942:for(;($index$25959<$length$25954);($index$25959++)){var $index$25995;var $length$25990;var temp$25985;var acc$25980;var x$25975;var m$25967;(m$25967=temp$25949[$index$25959]);;(x$25975=m$25967);(results$25941=results$25941.concat((((acc$25980=[])),(((temp$25985=b$25938)),((($length$25990=temp$25985.length)),((($index$25995=0)),function(){$25977:for(;($index$25995<$length$25990);($index$25995++)){var y$26011;var m$26003;(m$26003=temp$25985[$index$25995]);;(y$26011=m$26003);acc$25980.push([x$25975,y$26011]);}}()))),acc$25980)));}return results$25941;});;(exports["GenSym"]=GenSym$25390);(exports["gensym"]=gensym$25391);(exports["uuid"]=uuid$25392);(exports["identity"]=identity$25393);(exports["binsearch"]=binsearch$25394);(exports["classify"]=classify$25396);(exports["classify_contiguous"]=classify_contiguous$25397);(exports["neighbours"]=neighbours$25398);(exports["partition"]=partition$25399);(exports["construct"]=construct$25400);(exports["mkset"]=mkset$25401);(exports["make_object"]=make_object$25402);(exports["product"]=product$25403);

},{}],15:[function(require,module,exports){

},{}]},{},[])